function woe(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const c=Object.getOwnPropertyDescriptor(n,a);c&&Object.defineProperty(e,a,c.get?c:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function r(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(a){if(a.ep)return;a.ep=!0;const c=r(a);fetch(a.href,c)}})();var ES=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ha(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Qk={exports:{}},Rb={},eP={exports:{}},Oi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TB;function Soe(){if(TB)return Oi;TB=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),h=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),w=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),T=Symbol.iterator;function E(We){return We===null||typeof We!="object"?null:(We=T&&We[T]||We["@@iterator"],typeof We=="function"?We:null)}var D={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,I={};function V(We,tt,nt){this.props=We,this.context=tt,this.refs=I,this.updater=nt||D}V.prototype.isReactComponent={},V.prototype.setState=function(We,tt){if(typeof We!="object"&&typeof We!="function"&&We!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,We,tt,"setState")},V.prototype.forceUpdate=function(We){this.updater.enqueueForceUpdate(this,We,"forceUpdate")};function H(){}H.prototype=V.prototype;function K(We,tt,nt){this.props=We,this.context=tt,this.refs=I,this.updater=nt||D}var Q=K.prototype=new H;Q.constructor=K,U(Q,V.prototype),Q.isPureReactComponent=!0;var ae=Array.isArray,ee=Object.prototype.hasOwnProperty,se={current:null},ue={key:!0,ref:!0,__self:!0,__source:!0};function he(We,tt,nt){var Dt,nr={},ir=null,rr=null;if(tt!=null)for(Dt in tt.ref!==void 0&&(rr=tt.ref),tt.key!==void 0&&(ir=""+tt.key),tt)ee.call(tt,Dt)&&!ue.hasOwnProperty(Dt)&&(nr[Dt]=tt[Dt]);var or=arguments.length-2;if(or===1)nr.children=nt;else if(1<or){for(var Ft=Array(or),ze=0;ze<or;ze++)Ft[ze]=arguments[ze+2];nr.children=Ft}if(We&&We.defaultProps)for(Dt in or=We.defaultProps,or)nr[Dt]===void 0&&(nr[Dt]=or[Dt]);return{$$typeof:e,type:We,key:ir,ref:rr,props:nr,_owner:se.current}}function Ce(We,tt){return{$$typeof:e,type:We.type,key:tt,ref:We.ref,props:We.props,_owner:We._owner}}function Ne(We){return typeof We=="object"&&We!==null&&We.$$typeof===e}function me(We){var tt={"=":"=0",":":"=2"};return"$"+We.replace(/[=:]/g,function(nt){return tt[nt]})}var be=/\/+/g;function pe(We,tt){return typeof We=="object"&&We!==null&&We.key!=null?me(""+We.key):tt.toString(36)}function Se(We,tt,nt,Dt,nr){var ir=typeof We;(ir==="undefined"||ir==="boolean")&&(We=null);var rr=!1;if(We===null)rr=!0;else switch(ir){case"string":case"number":rr=!0;break;case"object":switch(We.$$typeof){case e:case t:rr=!0}}if(rr)return rr=We,nr=nr(rr),We=Dt===""?"."+pe(rr,0):Dt,ae(nr)?(nt="",We!=null&&(nt=We.replace(be,"$&/")+"/"),Se(nr,tt,nt,"",function(ze){return ze})):nr!=null&&(Ne(nr)&&(nr=Ce(nr,nt+(!nr.key||rr&&rr.key===nr.key?"":(""+nr.key).replace(be,"$&/")+"/")+We)),tt.push(nr)),1;if(rr=0,Dt=Dt===""?".":Dt+":",ae(We))for(var or=0;or<We.length;or++){ir=We[or];var Ft=Dt+pe(ir,or);rr+=Se(ir,tt,nt,Ft,nr)}else if(Ft=E(We),typeof Ft=="function")for(We=Ft.call(We),or=0;!(ir=We.next()).done;)ir=ir.value,Ft=Dt+pe(ir,or++),rr+=Se(ir,tt,nt,Ft,nr);else if(ir==="object")throw tt=String(We),Error("Objects are not valid as a React child (found: "+(tt==="[object Object]"?"object with keys {"+Object.keys(We).join(", ")+"}":tt)+"). If you meant to render a collection of children, use an array instead.");return rr}function Ee(We,tt,nt){if(We==null)return We;var Dt=[],nr=0;return Se(We,Dt,"","",function(ir){return tt.call(nt,ir,nr++)}),Dt}function we(We){if(We._status===-1){var tt=We._result;tt=tt(),tt.then(function(nt){(We._status===0||We._status===-1)&&(We._status=1,We._result=nt)},function(nt){(We._status===0||We._status===-1)&&(We._status=2,We._result=nt)}),We._status===-1&&(We._status=0,We._result=tt)}if(We._status===1)return We._result.default;throw We._result}var Pe={current:null},Me={transition:null},Be={ReactCurrentDispatcher:Pe,ReactCurrentBatchConfig:Me,ReactCurrentOwner:se};function Ge(){throw Error("act(...) is not supported in production builds of React.")}return Oi.Children={map:Ee,forEach:function(We,tt,nt){Ee(We,function(){tt.apply(this,arguments)},nt)},count:function(We){var tt=0;return Ee(We,function(){tt++}),tt},toArray:function(We){return Ee(We,function(tt){return tt})||[]},only:function(We){if(!Ne(We))throw Error("React.Children.only expected to receive a single React element child.");return We}},Oi.Component=V,Oi.Fragment=r,Oi.Profiler=a,Oi.PureComponent=K,Oi.StrictMode=n,Oi.Suspense=x,Oi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Be,Oi.act=Ge,Oi.cloneElement=function(We,tt,nt){if(We==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+We+".");var Dt=U({},We.props),nr=We.key,ir=We.ref,rr=We._owner;if(tt!=null){if(tt.ref!==void 0&&(ir=tt.ref,rr=se.current),tt.key!==void 0&&(nr=""+tt.key),We.type&&We.type.defaultProps)var or=We.type.defaultProps;for(Ft in tt)ee.call(tt,Ft)&&!ue.hasOwnProperty(Ft)&&(Dt[Ft]=tt[Ft]===void 0&&or!==void 0?or[Ft]:tt[Ft])}var Ft=arguments.length-2;if(Ft===1)Dt.children=nt;else if(1<Ft){or=Array(Ft);for(var ze=0;ze<Ft;ze++)or[ze]=arguments[ze+2];Dt.children=or}return{$$typeof:e,type:We.type,key:nr,ref:ir,props:Dt,_owner:rr}},Oi.createContext=function(We){return We={$$typeof:h,_currentValue:We,_currentValue2:We,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},We.Provider={$$typeof:c,_context:We},We.Consumer=We},Oi.createElement=he,Oi.createFactory=function(We){var tt=he.bind(null,We);return tt.type=We,tt},Oi.createRef=function(){return{current:null}},Oi.forwardRef=function(We){return{$$typeof:i,render:We}},Oi.isValidElement=Ne,Oi.lazy=function(We){return{$$typeof:S,_payload:{_status:-1,_result:We},_init:we}},Oi.memo=function(We,tt){return{$$typeof:w,type:We,compare:tt===void 0?null:tt}},Oi.startTransition=function(We){var tt=Me.transition;Me.transition={};try{We()}finally{Me.transition=tt}},Oi.unstable_act=Ge,Oi.useCallback=function(We,tt){return Pe.current.useCallback(We,tt)},Oi.useContext=function(We){return Pe.current.useContext(We)},Oi.useDebugValue=function(){},Oi.useDeferredValue=function(We){return Pe.current.useDeferredValue(We)},Oi.useEffect=function(We,tt){return Pe.current.useEffect(We,tt)},Oi.useId=function(){return Pe.current.useId()},Oi.useImperativeHandle=function(We,tt,nt){return Pe.current.useImperativeHandle(We,tt,nt)},Oi.useInsertionEffect=function(We,tt){return Pe.current.useInsertionEffect(We,tt)},Oi.useLayoutEffect=function(We,tt){return Pe.current.useLayoutEffect(We,tt)},Oi.useMemo=function(We,tt){return Pe.current.useMemo(We,tt)},Oi.useReducer=function(We,tt,nt){return Pe.current.useReducer(We,tt,nt)},Oi.useRef=function(We){return Pe.current.useRef(We)},Oi.useState=function(We){return Pe.current.useState(We)},Oi.useSyncExternalStore=function(We,tt,nt){return Pe.current.useSyncExternalStore(We,tt,nt)},Oi.useTransition=function(){return Pe.current.useTransition()},Oi.version="18.3.1",Oi}var jB;function G3(){return jB||(jB=1,eP.exports=Soe()),eP.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kB;function Noe(){if(kB)return Rb;kB=1;var e=G3(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function h(i,x,w){var S,T={},E=null,D=null;w!==void 0&&(E=""+w),x.key!==void 0&&(E=""+x.key),x.ref!==void 0&&(D=x.ref);for(S in x)n.call(x,S)&&!c.hasOwnProperty(S)&&(T[S]=x[S]);if(i&&i.defaultProps)for(S in x=i.defaultProps,x)T[S]===void 0&&(T[S]=x[S]);return{$$typeof:t,type:i,key:E,ref:D,props:T,_owner:a.current}}return Rb.Fragment=r,Rb.jsx=h,Rb.jsxs=h,Rb}var PB;function Aoe(){return PB||(PB=1,Qk.exports=Noe()),Qk.exports}var o=Aoe(),G=G3();const Le=ha(G),KW=woe({__proto__:null,default:Le},[G]);var Toe=(e,t,r,n,a,c,h,i)=>{let x=document.documentElement,w=["light","dark"];function S(D){(Array.isArray(e)?e:[e]).forEach(U=>{let I=U==="class",V=I&&c?a.map(H=>c[H]||H):a;I?(x.classList.remove(...V),x.classList.add(c&&c[D]?c[D]:D)):x.setAttribute(U,D)}),T(D)}function T(D){i&&w.includes(D)&&(x.style.colorScheme=D)}function E(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(n)S(n);else try{let D=localStorage.getItem(t)||r,U=h&&D==="system"?E():D;S(U)}catch{}},joe=G.createContext(void 0),koe={setTheme:e=>{},themes:[]},Poe=()=>{var e;return(e=G.useContext(joe))!=null?e:koe};G.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:c,value:h,themes:i,nonce:x,scriptProps:w})=>{let S=JSON.stringify([r,t,c,e,i,h,n,a]).slice(1,-1);return G.createElement("script",{...w,suppressHydrationWarning:!0,nonce:typeof window>"u"?x:"",dangerouslySetInnerHTML:{__html:`(${Toe.toString()})(${S})`}})});var tP={exports:{}},Hc={},rP={exports:{}},nP={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CB;function Coe(){return CB||(CB=1,function(e){function t(Me,Be){var Ge=Me.length;Me.push(Be);e:for(;0<Ge;){var We=Ge-1>>>1,tt=Me[We];if(0<a(tt,Be))Me[We]=Be,Me[Ge]=tt,Ge=We;else break e}}function r(Me){return Me.length===0?null:Me[0]}function n(Me){if(Me.length===0)return null;var Be=Me[0],Ge=Me.pop();if(Ge!==Be){Me[0]=Ge;e:for(var We=0,tt=Me.length,nt=tt>>>1;We<nt;){var Dt=2*(We+1)-1,nr=Me[Dt],ir=Dt+1,rr=Me[ir];if(0>a(nr,Ge))ir<tt&&0>a(rr,nr)?(Me[We]=rr,Me[ir]=Ge,We=ir):(Me[We]=nr,Me[Dt]=Ge,We=Dt);else if(ir<tt&&0>a(rr,Ge))Me[We]=rr,Me[ir]=Ge,We=ir;else break e}}return Be}function a(Me,Be){var Ge=Me.sortIndex-Be.sortIndex;return Ge!==0?Ge:Me.id-Be.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var h=Date,i=h.now();e.unstable_now=function(){return h.now()-i}}var x=[],w=[],S=1,T=null,E=3,D=!1,U=!1,I=!1,V=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,K=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Q(Me){for(var Be=r(w);Be!==null;){if(Be.callback===null)n(w);else if(Be.startTime<=Me)n(w),Be.sortIndex=Be.expirationTime,t(x,Be);else break;Be=r(w)}}function ae(Me){if(I=!1,Q(Me),!U)if(r(x)!==null)U=!0,we(ee);else{var Be=r(w);Be!==null&&Pe(ae,Be.startTime-Me)}}function ee(Me,Be){U=!1,I&&(I=!1,H(he),he=-1),D=!0;var Ge=E;try{for(Q(Be),T=r(x);T!==null&&(!(T.expirationTime>Be)||Me&&!me());){var We=T.callback;if(typeof We=="function"){T.callback=null,E=T.priorityLevel;var tt=We(T.expirationTime<=Be);Be=e.unstable_now(),typeof tt=="function"?T.callback=tt:T===r(x)&&n(x),Q(Be)}else n(x);T=r(x)}if(T!==null)var nt=!0;else{var Dt=r(w);Dt!==null&&Pe(ae,Dt.startTime-Be),nt=!1}return nt}finally{T=null,E=Ge,D=!1}}var se=!1,ue=null,he=-1,Ce=5,Ne=-1;function me(){return!(e.unstable_now()-Ne<Ce)}function be(){if(ue!==null){var Me=e.unstable_now();Ne=Me;var Be=!0;try{Be=ue(!0,Me)}finally{Be?pe():(se=!1,ue=null)}}else se=!1}var pe;if(typeof K=="function")pe=function(){K(be)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,Ee=Se.port2;Se.port1.onmessage=be,pe=function(){Ee.postMessage(null)}}else pe=function(){V(be,0)};function we(Me){ue=Me,se||(se=!0,pe())}function Pe(Me,Be){he=V(function(){Me(e.unstable_now())},Be)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Me){Me.callback=null},e.unstable_continueExecution=function(){U||D||(U=!0,we(ee))},e.unstable_forceFrameRate=function(Me){0>Me||125<Me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ce=0<Me?Math.floor(1e3/Me):5},e.unstable_getCurrentPriorityLevel=function(){return E},e.unstable_getFirstCallbackNode=function(){return r(x)},e.unstable_next=function(Me){switch(E){case 1:case 2:case 3:var Be=3;break;default:Be=E}var Ge=E;E=Be;try{return Me()}finally{E=Ge}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Me,Be){switch(Me){case 1:case 2:case 3:case 4:case 5:break;default:Me=3}var Ge=E;E=Me;try{return Be()}finally{E=Ge}},e.unstable_scheduleCallback=function(Me,Be,Ge){var We=e.unstable_now();switch(typeof Ge=="object"&&Ge!==null?(Ge=Ge.delay,Ge=typeof Ge=="number"&&0<Ge?We+Ge:We):Ge=We,Me){case 1:var tt=-1;break;case 2:tt=250;break;case 5:tt=1073741823;break;case 4:tt=1e4;break;default:tt=5e3}return tt=Ge+tt,Me={id:S++,callback:Be,priorityLevel:Me,startTime:Ge,expirationTime:tt,sortIndex:-1},Ge>We?(Me.sortIndex=Ge,t(w,Me),r(x)===null&&Me===r(w)&&(I?(H(he),he=-1):I=!0,Pe(ae,Ge-We))):(Me.sortIndex=tt,t(x,Me),U||D||(U=!0,we(ee))),Me},e.unstable_shouldYield=me,e.unstable_wrapCallback=function(Me){var Be=E;return function(){var Ge=E;E=Be;try{return Me.apply(this,arguments)}finally{E=Ge}}}}(nP)),nP}var EB;function Eoe(){return EB||(EB=1,rP.exports=Coe()),rP.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MB;function Moe(){if(MB)return Hc;MB=1;var e=G3(),t=Eoe();function r(b){for(var A="https://reactjs.org/docs/error-decoder.html?invariant="+b,$=1;$<arguments.length;$++)A+="&args[]="+encodeURIComponent(arguments[$]);return"Minified React error #"+b+"; visit "+A+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function c(b,A){h(b,A),h(b+"Capture",A)}function h(b,A){for(a[b]=A,b=0;b<A.length;b++)n.add(A[b])}var i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),x=Object.prototype.hasOwnProperty,w=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,S={},T={};function E(b){return x.call(T,b)?!0:x.call(S,b)?!1:w.test(b)?T[b]=!0:(S[b]=!0,!1)}function D(b,A,$,J){if($!==null&&$.type===0)return!1;switch(typeof A){case"function":case"symbol":return!0;case"boolean":return J?!1:$!==null?!$.acceptsBooleans:(b=b.toLowerCase().slice(0,5),b!=="data-"&&b!=="aria-");default:return!1}}function U(b,A,$,J){if(A===null||typeof A>"u"||D(b,A,$,J))return!0;if(J)return!1;if($!==null)switch($.type){case 3:return!A;case 4:return A===!1;case 5:return isNaN(A);case 6:return isNaN(A)||1>A}return!1}function I(b,A,$,J,de,ye,$e){this.acceptsBooleans=A===2||A===3||A===4,this.attributeName=J,this.attributeNamespace=de,this.mustUseProperty=$,this.propertyName=b,this.type=A,this.sanitizeURL=ye,this.removeEmptyString=$e}var V={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(b){V[b]=new I(b,0,!1,b,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(b){var A=b[0];V[A]=new I(A,1,!1,b[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(b){V[b]=new I(b,2,!1,b.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(b){V[b]=new I(b,2,!1,b,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(b){V[b]=new I(b,3,!1,b.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(b){V[b]=new I(b,3,!0,b,null,!1,!1)}),["capture","download"].forEach(function(b){V[b]=new I(b,4,!1,b,null,!1,!1)}),["cols","rows","size","span"].forEach(function(b){V[b]=new I(b,6,!1,b,null,!1,!1)}),["rowSpan","start"].forEach(function(b){V[b]=new I(b,5,!1,b.toLowerCase(),null,!1,!1)});var H=/[\-:]([a-z])/g;function K(b){return b[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(b){var A=b.replace(H,K);V[A]=new I(A,1,!1,b,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(b){var A=b.replace(H,K);V[A]=new I(A,1,!1,b,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(b){var A=b.replace(H,K);V[A]=new I(A,1,!1,b,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(b){V[b]=new I(b,1,!1,b.toLowerCase(),null,!1,!1)}),V.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(b){V[b]=new I(b,1,!1,b.toLowerCase(),null,!0,!0)});function Q(b,A,$,J){var de=V.hasOwnProperty(A)?V[A]:null;(de!==null?de.type!==0:J||!(2<A.length)||A[0]!=="o"&&A[0]!=="O"||A[1]!=="n"&&A[1]!=="N")&&(U(A,$,de,J)&&($=null),J||de===null?E(A)&&($===null?b.removeAttribute(A):b.setAttribute(A,""+$)):de.mustUseProperty?b[de.propertyName]=$===null?de.type===3?!1:"":$:(A=de.attributeName,J=de.attributeNamespace,$===null?b.removeAttribute(A):(de=de.type,$=de===3||de===4&&$===!0?"":""+$,J?b.setAttributeNS(J,A,$):b.setAttribute(A,$))))}var ae=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ee=Symbol.for("react.element"),se=Symbol.for("react.portal"),ue=Symbol.for("react.fragment"),he=Symbol.for("react.strict_mode"),Ce=Symbol.for("react.profiler"),Ne=Symbol.for("react.provider"),me=Symbol.for("react.context"),be=Symbol.for("react.forward_ref"),pe=Symbol.for("react.suspense"),Se=Symbol.for("react.suspense_list"),Ee=Symbol.for("react.memo"),we=Symbol.for("react.lazy"),Pe=Symbol.for("react.offscreen"),Me=Symbol.iterator;function Be(b){return b===null||typeof b!="object"?null:(b=Me&&b[Me]||b["@@iterator"],typeof b=="function"?b:null)}var Ge=Object.assign,We;function tt(b){if(We===void 0)try{throw Error()}catch($){var A=$.stack.trim().match(/\n( *(at )?)/);We=A&&A[1]||""}return`
`+We+b}var nt=!1;function Dt(b,A){if(!b||nt)return"";nt=!0;var $=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(A)if(A=function(){throw Error()},Object.defineProperty(A.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(A,[])}catch(Yt){var J=Yt}Reflect.construct(b,[],A)}else{try{A.call()}catch(Yt){J=Yt}b.call(A.prototype)}else{try{throw Error()}catch(Yt){J=Yt}b()}}catch(Yt){if(Yt&&J&&typeof Yt.stack=="string"){for(var de=Yt.stack.split(`
`),ye=J.stack.split(`
`),$e=de.length-1,yt=ye.length-1;1<=$e&&0<=yt&&de[$e]!==ye[yt];)yt--;for(;1<=$e&&0<=yt;$e--,yt--)if(de[$e]!==ye[yt]){if($e!==1||yt!==1)do if($e--,yt--,0>yt||de[$e]!==ye[yt]){var At=`
`+de[$e].replace(" at new "," at ");return b.displayName&&At.includes("<anonymous>")&&(At=At.replace("<anonymous>",b.displayName)),At}while(1<=$e&&0<=yt);break}}}finally{nt=!1,Error.prepareStackTrace=$}return(b=b?b.displayName||b.name:"")?tt(b):""}function nr(b){switch(b.tag){case 5:return tt(b.type);case 16:return tt("Lazy");case 13:return tt("Suspense");case 19:return tt("SuspenseList");case 0:case 2:case 15:return b=Dt(b.type,!1),b;case 11:return b=Dt(b.type.render,!1),b;case 1:return b=Dt(b.type,!0),b;default:return""}}function ir(b){if(b==null)return null;if(typeof b=="function")return b.displayName||b.name||null;if(typeof b=="string")return b;switch(b){case ue:return"Fragment";case se:return"Portal";case Ce:return"Profiler";case he:return"StrictMode";case pe:return"Suspense";case Se:return"SuspenseList"}if(typeof b=="object")switch(b.$$typeof){case me:return(b.displayName||"Context")+".Consumer";case Ne:return(b._context.displayName||"Context")+".Provider";case be:var A=b.render;return b=b.displayName,b||(b=A.displayName||A.name||"",b=b!==""?"ForwardRef("+b+")":"ForwardRef"),b;case Ee:return A=b.displayName||null,A!==null?A:ir(b.type)||"Memo";case we:A=b._payload,b=b._init;try{return ir(b(A))}catch{}}return null}function rr(b){var A=b.type;switch(b.tag){case 24:return"Cache";case 9:return(A.displayName||"Context")+".Consumer";case 10:return(A._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return b=A.render,b=b.displayName||b.name||"",A.displayName||(b!==""?"ForwardRef("+b+")":"ForwardRef");case 7:return"Fragment";case 5:return A;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ir(A);case 8:return A===he?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof A=="function")return A.displayName||A.name||null;if(typeof A=="string")return A}return null}function or(b){switch(typeof b){case"boolean":case"number":case"string":case"undefined":return b;case"object":return b;default:return""}}function Ft(b){var A=b.type;return(b=b.nodeName)&&b.toLowerCase()==="input"&&(A==="checkbox"||A==="radio")}function ze(b){var A=Ft(b)?"checked":"value",$=Object.getOwnPropertyDescriptor(b.constructor.prototype,A),J=""+b[A];if(!b.hasOwnProperty(A)&&typeof $<"u"&&typeof $.get=="function"&&typeof $.set=="function"){var de=$.get,ye=$.set;return Object.defineProperty(b,A,{configurable:!0,get:function(){return de.call(this)},set:function($e){J=""+$e,ye.call(this,$e)}}),Object.defineProperty(b,A,{enumerable:$.enumerable}),{getValue:function(){return J},setValue:function($e){J=""+$e},stopTracking:function(){b._valueTracker=null,delete b[A]}}}}function Pr(b){b._valueTracker||(b._valueTracker=ze(b))}function Kt(b){if(!b)return!1;var A=b._valueTracker;if(!A)return!0;var $=A.getValue(),J="";return b&&(J=Ft(b)?b.checked?"true":"false":b.value),b=J,b!==$?(A.setValue(b),!0):!1}function on(b){if(b=b||(typeof document<"u"?document:void 0),typeof b>"u")return null;try{return b.activeElement||b.body}catch{return b.body}}function Rt(b,A){var $=A.checked;return Ge({},A,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:$??b._wrapperState.initialChecked})}function En(b,A){var $=A.defaultValue==null?"":A.defaultValue,J=A.checked!=null?A.checked:A.defaultChecked;$=or(A.value!=null?A.value:$),b._wrapperState={initialChecked:J,initialValue:$,controlled:A.type==="checkbox"||A.type==="radio"?A.checked!=null:A.value!=null}}function Vn(b,A){A=A.checked,A!=null&&Q(b,"checked",A,!1)}function pi(b,A){Vn(b,A);var $=or(A.value),J=A.type;if($!=null)J==="number"?($===0&&b.value===""||b.value!=$)&&(b.value=""+$):b.value!==""+$&&(b.value=""+$);else if(J==="submit"||J==="reset"){b.removeAttribute("value");return}A.hasOwnProperty("value")?Ot(b,A.type,$):A.hasOwnProperty("defaultValue")&&Ot(b,A.type,or(A.defaultValue)),A.checked==null&&A.defaultChecked!=null&&(b.defaultChecked=!!A.defaultChecked)}function dt(b,A,$){if(A.hasOwnProperty("value")||A.hasOwnProperty("defaultValue")){var J=A.type;if(!(J!=="submit"&&J!=="reset"||A.value!==void 0&&A.value!==null))return;A=""+b._wrapperState.initialValue,$||A===b.value||(b.value=A),b.defaultValue=A}$=b.name,$!==""&&(b.name=""),b.defaultChecked=!!b._wrapperState.initialChecked,$!==""&&(b.name=$)}function Ot(b,A,$){(A!=="number"||on(b.ownerDocument)!==b)&&($==null?b.defaultValue=""+b._wrapperState.initialValue:b.defaultValue!==""+$&&(b.defaultValue=""+$))}var Zt=Array.isArray;function Cr(b,A,$,J){if(b=b.options,A){A={};for(var de=0;de<$.length;de++)A["$"+$[de]]=!0;for($=0;$<b.length;$++)de=A.hasOwnProperty("$"+b[$].value),b[$].selected!==de&&(b[$].selected=de),de&&J&&(b[$].defaultSelected=!0)}else{for($=""+or($),A=null,de=0;de<b.length;de++){if(b[de].value===$){b[de].selected=!0,J&&(b[de].defaultSelected=!0);return}A!==null||b[de].disabled||(A=b[de])}A!==null&&(A.selected=!0)}}function vr(b,A){if(A.dangerouslySetInnerHTML!=null)throw Error(r(91));return Ge({},A,{value:void 0,defaultValue:void 0,children:""+b._wrapperState.initialValue})}function Sr(b,A){var $=A.value;if($==null){if($=A.children,A=A.defaultValue,$!=null){if(A!=null)throw Error(r(92));if(Zt($)){if(1<$.length)throw Error(r(93));$=$[0]}A=$}A==null&&(A=""),$=A}b._wrapperState={initialValue:or($)}}function pr(b,A){var $=or(A.value),J=or(A.defaultValue);$!=null&&($=""+$,$!==b.value&&(b.value=$),A.defaultValue==null&&b.defaultValue!==$&&(b.defaultValue=$)),J!=null&&(b.defaultValue=""+J)}function Mn(b){var A=b.textContent;A===b._wrapperState.initialValue&&A!==""&&A!==null&&(b.value=A)}function Ai(b){switch(b){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vi(b,A){return b==null||b==="http://www.w3.org/1999/xhtml"?Ai(A):b==="http://www.w3.org/2000/svg"&&A==="foreignObject"?"http://www.w3.org/1999/xhtml":b}var Ui,xo=function(b){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(A,$,J,de){MSApp.execUnsafeLocalFunction(function(){return b(A,$,J,de)})}:b}(function(b,A){if(b.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in b)b.innerHTML=A;else{for(Ui=Ui||document.createElement("div"),Ui.innerHTML="<svg>"+A.valueOf().toString()+"</svg>",A=Ui.firstChild;b.firstChild;)b.removeChild(b.firstChild);for(;A.firstChild;)b.appendChild(A.firstChild)}});function Wa(b,A){if(A){var $=b.firstChild;if($&&$===b.lastChild&&$.nodeType===3){$.nodeValue=A;return}}b.textContent=A}var Qs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Eo=["Webkit","ms","Moz","O"];Object.keys(Qs).forEach(function(b){Eo.forEach(function(A){A=A+b.charAt(0).toUpperCase()+b.substring(1),Qs[A]=Qs[b]})});function ss(b,A,$){return A==null||typeof A=="boolean"||A===""?"":$||typeof A!="number"||A===0||Qs.hasOwnProperty(b)&&Qs[b]?(""+A).trim():A+"px"}function ac(b,A){b=b.style;for(var $ in A)if(A.hasOwnProperty($)){var J=$.indexOf("--")===0,de=ss($,A[$],J);$==="float"&&($="cssFloat"),J?b.setProperty($,de):b[$]=de}}var Il=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $s(b,A){if(A){if(Il[b]&&(A.children!=null||A.dangerouslySetInnerHTML!=null))throw Error(r(137,b));if(A.dangerouslySetInnerHTML!=null){if(A.children!=null)throw Error(r(60));if(typeof A.dangerouslySetInnerHTML!="object"||!("__html"in A.dangerouslySetInnerHTML))throw Error(r(61))}if(A.style!=null&&typeof A.style!="object")throw Error(r(62))}}function sc(b,A){if(b.indexOf("-")===-1)return typeof A.is=="string";switch(b){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ln=null;function os(b){return b=b.target||b.srcElement||window,b.correspondingUseElement&&(b=b.correspondingUseElement),b.nodeType===3?b.parentNode:b}var qu=null,Ha=null,eo=null;function Gn(b){if(b=ah(b)){if(typeof qu!="function")throw Error(r(280));var A=b.stateNode;A&&(A=_f(A),qu(b.stateNode,b.type,A))}}function va(b){Ha?eo?eo.push(b):eo=[b]:Ha=b}function Ea(){if(Ha){var b=Ha,A=eo;if(eo=Ha=null,Gn(b),A)for(b=0;b<A.length;b++)Gn(A[b])}}function Es(b,A){return b(A)}function Ll(){}var Ma=!1;function qs(b,A,$){if(Ma)return b(A,$);Ma=!0;try{return Es(b,A,$)}finally{Ma=!1,(Ha!==null||eo!==null)&&(Ll(),Ea())}}function $i(b,A){var $=b.stateNode;if($===null)return null;var J=_f($);if(J===null)return null;$=J[A];e:switch(A){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(J=!J.disabled)||(b=b.type,J=!(b==="button"||b==="input"||b==="select"||b==="textarea")),b=!J;break e;default:b=!1}if(b)return null;if($&&typeof $!="function")throw Error(r(231,A,typeof $));return $}var Ms=!1;if(i)try{var gs={};Object.defineProperty(gs,"passive",{get:function(){Ms=!0}}),window.addEventListener("test",gs,gs),window.removeEventListener("test",gs,gs)}catch{Ms=!1}function Gu(b,A,$,J,de,ye,$e,yt,At){var Yt=Array.prototype.slice.call(arguments,3);try{A.apply($,Yt)}catch(Tr){this.onError(Tr)}}var Xi=!1,Ko=null,St=!1,ve=null,ke={onError:function(b){Xi=!0,Ko=b}};function Oe(b,A,$,J,de,ye,$e,yt,At){Xi=!1,Ko=null,Gu.apply(ke,arguments)}function Ye(b,A,$,J,de,ye,$e,yt,At){if(Oe.apply(this,arguments),Xi){if(Xi){var Yt=Ko;Xi=!1,Ko=null}else throw Error(r(198));St||(St=!0,ve=Yt)}}function Je(b){var A=b,$=b;if(b.alternate)for(;A.return;)A=A.return;else{b=A;do A=b,(A.flags&4098)!==0&&($=A.return),b=A.return;while(b)}return A.tag===3?$:null}function st(b){if(b.tag===13){var A=b.memoizedState;if(A===null&&(b=b.alternate,b!==null&&(A=b.memoizedState)),A!==null)return A.dehydrated}return null}function gt(b){if(Je(b)!==b)throw Error(r(188))}function lt(b){var A=b.alternate;if(!A){if(A=Je(b),A===null)throw Error(r(188));return A!==b?null:b}for(var $=b,J=A;;){var de=$.return;if(de===null)break;var ye=de.alternate;if(ye===null){if(J=de.return,J!==null){$=J;continue}break}if(de.child===ye.child){for(ye=de.child;ye;){if(ye===$)return gt(de),b;if(ye===J)return gt(de),A;ye=ye.sibling}throw Error(r(188))}if($.return!==J.return)$=de,J=ye;else{for(var $e=!1,yt=de.child;yt;){if(yt===$){$e=!0,$=de,J=ye;break}if(yt===J){$e=!0,J=de,$=ye;break}yt=yt.sibling}if(!$e){for(yt=ye.child;yt;){if(yt===$){$e=!0,$=ye,J=de;break}if(yt===J){$e=!0,J=ye,$=de;break}yt=yt.sibling}if(!$e)throw Error(r(189))}}if($.alternate!==J)throw Error(r(190))}if($.tag!==3)throw Error(r(188));return $.stateNode.current===$?b:A}function wt(b){return b=lt(b),b!==null?bt(b):null}function bt(b){if(b.tag===5||b.tag===6)return b;for(b=b.child;b!==null;){var A=bt(b);if(A!==null)return A;b=b.sibling}return null}var Nt=t.unstable_scheduleCallback,Bt=t.unstable_cancelCallback,ar=t.unstable_shouldYield,sr=t.unstable_requestPaint,Nr=t.unstable_now,$r=t.unstable_getCurrentPriorityLevel,Ur=t.unstable_ImmediatePriority,Vr=t.unstable_UserBlockingPriority,On=t.unstable_NormalPriority,Hn=t.unstable_LowPriority,Tn=t.unstable_IdlePriority,$n=null,Rn=null;function Oa(b){if(Rn&&typeof Rn.onCommitFiberRoot=="function")try{Rn.onCommitFiberRoot($n,b,void 0,(b.current.flags&128)===128)}catch{}}var ys=Math.clz32?Math.clz32:vo,Ka=Math.log,ls=Math.LN2;function vo(b){return b>>>=0,b===0?32:31-(Ka(b)/ls|0)|0}var Wu=64,Dl=4194304;function iu(b){switch(b&-b){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return b&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return b}}function sf(b,A){var $=b.pendingLanes;if($===0)return 0;var J=0,de=b.suspendedLanes,ye=b.pingedLanes,$e=$&268435455;if($e!==0){var yt=$e&~de;yt!==0?J=iu(yt):(ye&=$e,ye!==0&&(J=iu(ye)))}else $e=$&~de,$e!==0?J=iu($e):ye!==0&&(J=iu(ye));if(J===0)return 0;if(A!==0&&A!==J&&(A&de)===0&&(de=J&-J,ye=A&-A,de>=ye||de===16&&(ye&4194240)!==0))return A;if((J&4)!==0&&(J|=$&16),A=b.entangledLanes,A!==0)for(b=b.entanglements,A&=J;0<A;)$=31-ys(A),de=1<<$,J|=b[$],A&=~de;return J}function ox(b,A){switch(b){case 1:case 2:case 4:return A+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return A+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vy(b,A){for(var $=b.suspendedLanes,J=b.pingedLanes,de=b.expirationTimes,ye=b.pendingLanes;0<ye;){var $e=31-ys(ye),yt=1<<$e,At=de[$e];At===-1?((yt&$)===0||(yt&J)!==0)&&(de[$e]=ox(yt,A)):At<=A&&(b.expiredLanes|=yt),ye&=~yt}}function _p(b){return b=b.pendingLanes&-1073741825,b!==0?b:b&1073741824?1073741824:0}function to(){var b=Wu;return Wu<<=1,(Wu&4194240)===0&&(Wu=64),b}function yl(b){for(var A=[],$=0;31>$;$++)A.push(b);return A}function xl(b,A,$){b.pendingLanes|=A,A!==536870912&&(b.suspendedLanes=0,b.pingedLanes=0),b=b.eventTimes,A=31-ys(A),b[A]=$}function kc(b,A){var $=b.pendingLanes&~A;b.pendingLanes=A,b.suspendedLanes=0,b.pingedLanes=0,b.expiredLanes&=A,b.mutableReadLanes&=A,b.entangledLanes&=A,A=b.entanglements;var J=b.eventTimes;for(b=b.expirationTimes;0<$;){var de=31-ys($),ye=1<<de;A[de]=0,J[de]=-1,b[de]=-1,$&=~ye}}function vl(b,A){var $=b.entangledLanes|=A;for(b=b.entanglements;$;){var J=31-ys($),de=1<<J;de&A|b[J]&A&&(b[J]|=A),$&=~de}}var xi=0;function bp(b){return b&=-b,1<b?4<b?(b&268435455)!==0?16:536870912:4:1}var zm,Pc,au,_y,Bm,Zo=!1,Xn=[],Cc=null,Fr=null,su=null,Hu=new Map,Ku=new Map,xn=[],Vm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zu(b,A){switch(b){case"focusin":case"focusout":Cc=null;break;case"dragenter":case"dragleave":Fr=null;break;case"mouseover":case"mouseout":su=null;break;case"pointerover":case"pointerout":Hu.delete(A.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ku.delete(A.pointerId)}}function br(b,A,$,J,de,ye){return b===null||b.nativeEvent!==ye?(b={blockedOn:A,domEventName:$,eventSystemFlags:J,nativeEvent:ye,targetContainers:[de]},A!==null&&(A=ah(A),A!==null&&Pc(A)),b):(b.eventSystemFlags|=J,A=b.targetContainers,de!==null&&A.indexOf(de)===-1&&A.push(de),b)}function mi(b,A,$,J,de){switch(A){case"focusin":return Cc=br(Cc,b,A,$,J,de),!0;case"dragenter":return Fr=br(Fr,b,A,$,J,de),!0;case"mouseover":return su=br(su,b,A,$,J,de),!0;case"pointerover":var ye=de.pointerId;return Hu.set(ye,br(Hu.get(ye)||null,b,A,$,J,de)),!0;case"gotpointercapture":return ye=de.pointerId,Ku.set(ye,br(Ku.get(ye)||null,b,A,$,J,de)),!0}return!1}function Wn(b){var A=sd(b.target);if(A!==null){var $=Je(A);if($!==null){if(A=$.tag,A===13){if(A=st($),A!==null){b.blockedOn=A,Bm(b.priority,function(){au($)});return}}else if(A===3&&$.stateNode.current.memoizedState.isDehydrated){b.blockedOn=$.tag===3?$.stateNode.containerInfo:null;return}}}b.blockedOn=null}function xs(b){if(b.blockedOn!==null)return!1;for(var A=b.targetContainers;0<A.length;){var $=Hd(b.domEventName,b.eventSystemFlags,A[0],b.nativeEvent);if($===null){$=b.nativeEvent;var J=new $.constructor($.type,$);ln=J,$.target.dispatchEvent(J),ln=null}else return A=ah($),A!==null&&Pc(A),b.blockedOn=$,!1;A.shift()}return!0}function Ec(b,A,$){xs(b)&&$.delete(A)}function ii(){Zo=!1,Cc!==null&&xs(Cc)&&(Cc=null),Fr!==null&&xs(Fr)&&(Fr=null),su!==null&&xs(su)&&(su=null),Hu.forEach(Ec),Ku.forEach(Ec)}function ou(b,A){b.blockedOn===A&&(b.blockedOn=null,Zo||(Zo=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,ii)))}function Yo(b){function A(de){return ou(de,b)}if(0<Xn.length){ou(Xn[0],b);for(var $=1;$<Xn.length;$++){var J=Xn[$];J.blockedOn===b&&(J.blockedOn=null)}}for(Cc!==null&&ou(Cc,b),Fr!==null&&ou(Fr,b),su!==null&&ou(su,b),Hu.forEach(A),Ku.forEach(A),$=0;$<xn.length;$++)J=xn[$],J.blockedOn===b&&(J.blockedOn=null);for(;0<xn.length&&($=xn[0],$.blockedOn===null);)Wn($),$.blockedOn===null&&xn.shift()}var Mc=ae.ReactCurrentBatchConfig,Za=!0;function _a(b,A,$,J){var de=xi,ye=Mc.transition;Mc.transition=null;try{xi=1,ro(b,A,$,J)}finally{xi=de,Mc.transition=ye}}function by(b,A,$,J){var de=xi,ye=Mc.transition;Mc.transition=null;try{xi=4,ro(b,A,$,J)}finally{xi=de,Mc.transition=ye}}function ro(b,A,$,J){if(Za){var de=Hd(b,A,$,J);if(de===null)th(b,A,J,Wd,$),Zu(b,J);else if(mi(de,b,A,$,J))J.stopPropagation();else if(Zu(b,J),A&4&&-1<Vm.indexOf(b)){for(;de!==null;){var ye=ah(de);if(ye!==null&&zm(ye),ye=Hd(b,A,$,J),ye===null&&th(b,A,J,Wd,$),ye===de)break;de=ye}de!==null&&J.stopPropagation()}else th(b,A,J,null,$)}}var Wd=null;function Hd(b,A,$,J){if(Wd=null,b=os(J),b=sd(b),b!==null)if(A=Je(b),A===null)b=null;else if($=A.tag,$===13){if(b=st(A),b!==null)return b;b=null}else if($===3){if(A.stateNode.current.memoizedState.isDehydrated)return A.tag===3?A.stateNode.containerInfo:null;b=null}else A!==b&&(b=null);return Wd=b,null}function wp(b){switch(b){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($r()){case Ur:return 1;case Vr:return 4;case On:case Hn:return 16;case Tn:return 536870912;default:return 16}default:return 16}}var Fl=null,Os=null,_l=null;function Rs(){if(_l)return _l;var b,A=Os,$=A.length,J,de="value"in Fl?Fl.value:Fl.textContent,ye=de.length;for(b=0;b<$&&A[b]===de[b];b++);var $e=$-b;for(J=1;J<=$e&&A[$-J]===de[ye-J];J++);return _l=de.slice(b,1<J?1-J:void 0)}function of(b){var A=b.keyCode;return"charCode"in b?(b=b.charCode,b===0&&A===13&&(b=13)):b=A,b===10&&(b=13),32<=b||b===13?b:0}function zl(){return!0}function oa(){return!1}function Ra(b){function A($,J,de,ye,$e){this._reactName=$,this._targetInst=de,this.type=J,this.nativeEvent=ye,this.target=$e,this.currentTarget=null;for(var yt in b)b.hasOwnProperty(yt)&&($=b[yt],this[yt]=$?$(ye):ye[yt]);return this.isDefaultPrevented=(ye.defaultPrevented!=null?ye.defaultPrevented:ye.returnValue===!1)?zl:oa,this.isPropagationStopped=oa,this}return Ge(A.prototype,{preventDefault:function(){this.defaultPrevented=!0;var $=this.nativeEvent;$&&($.preventDefault?$.preventDefault():typeof $.returnValue!="unknown"&&($.returnValue=!1),this.isDefaultPrevented=zl)},stopPropagation:function(){var $=this.nativeEvent;$&&($.stopPropagation?$.stopPropagation():typeof $.cancelBubble!="unknown"&&($.cancelBubble=!0),this.isPropagationStopped=zl)},persist:function(){},isPersistent:zl}),A}var Ia={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(b){return b.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ba=Ra(Ia),lu=Ge({},Ia,{view:0,detail:0}),oc=Ra(lu),cu,Kd,Mo,lf=Ge({},lu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lc,button:0,buttons:0,relatedTarget:function(b){return b.relatedTarget===void 0?b.fromElement===b.srcElement?b.toElement:b.fromElement:b.relatedTarget},movementX:function(b){return"movementX"in b?b.movementX:(b!==Mo&&(Mo&&b.type==="mousemove"?(cu=b.screenX-Mo.screenX,Kd=b.screenY-Mo.screenY):Kd=cu=0,Mo=b),cu)},movementY:function(b){return"movementY"in b?b.movementY:Kd}}),Oc=Ra(lf),U_=Ge({},lf,{dataTransfer:0}),wy=Ra(U_),Oo=Ge({},lu,{relatedTarget:0}),Sp=Ra(Oo),Um=Ge({},Ia,{animationName:0,elapsedTime:0,pseudoElement:0}),Np=Ra(Um),Ap=Ge({},Ia,{clipboardData:function(b){return"clipboardData"in b?b.clipboardData:window.clipboardData}}),$_=Ra(Ap),q_=Ge({},Ia,{data:0}),cf=Ra(q_),Tp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},G_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sy(b){var A=this.nativeEvent;return A.getModifierState?A.getModifierState(b):(b=uf[b])?!!A[b]:!1}function lc(){return Sy}var Yu=Ge({},lu,{key:function(b){if(b.key){var A=Tp[b.key]||b.key;if(A!=="Unidentified")return A}return b.type==="keypress"?(b=of(b),b===13?"Enter":String.fromCharCode(b)):b.type==="keydown"||b.type==="keyup"?G_[b.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lc,charCode:function(b){return b.type==="keypress"?of(b):0},keyCode:function(b){return b.type==="keydown"||b.type==="keyup"?b.keyCode:0},which:function(b){return b.type==="keypress"?of(b):b.type==="keydown"||b.type==="keyup"?b.keyCode:0}}),W_=Ra(Yu),Ny=Ge({},lf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lx=Ra(Ny),cx=Ge({},lu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lc}),H_=Ra(cx),Ay=Ge({},Ia,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zd=Ra(Ay),kn=Ge({},lf,{deltaX:function(b){return"deltaX"in b?b.deltaX:"wheelDeltaX"in b?-b.wheelDeltaX:0},deltaY:function(b){return"deltaY"in b?b.deltaY:"wheelDeltaY"in b?-b.wheelDeltaY:"wheelDelta"in b?-b.wheelDelta:0},deltaZ:0,deltaMode:0}),zr=Ra(kn),$m=[9,13,27,32],Wr=i&&"CompositionEvent"in window,Rc=null;i&&"documentMode"in document&&(Rc=document.documentMode);var qm=i&&"TextEvent"in window&&!Rc,Jr=i&&(!Wr||Rc&&8<Rc&&11>=Rc),Yd=" ",Xu=!1;function Gm(b,A){switch(b){case"keyup":return $m.indexOf(A.keyCode)!==-1;case"keydown":return A.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jp(b){return b=b.detail,typeof b=="object"&&"data"in b?b.data:null}var vs=!1;function Gs(b,A){switch(b){case"compositionend":return jp(A);case"keypress":return A.which!==32?null:(Xu=!0,Yd);case"textInput":return b=A.data,b===Yd&&Xu?null:b;default:return null}}function cr(b,A){if(vs)return b==="compositionend"||!Wr&&Gm(b,A)?(b=Rs(),_l=Os=Fl=null,vs=!1,b):null;switch(b){case"paste":return null;case"keypress":if(!(A.ctrlKey||A.altKey||A.metaKey)||A.ctrlKey&&A.altKey){if(A.char&&1<A.char.length)return A.char;if(A.which)return String.fromCharCode(A.which)}return null;case"compositionend":return Jr&&A.locale!=="ko"?null:A.data;default:return null}}var Ty={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kp(b){var A=b&&b.nodeName&&b.nodeName.toLowerCase();return A==="input"?!!Ty[b.type]:A==="textarea"}function df(b,A,$,J){va(J),A=Dp(A,"onChange"),0<A.length&&($=new ba("onChange","change",null,$,J),b.push({event:$,listeners:A}))}var Bl=null,Va=null;function uu(b){Xm(b,0)}function hf(b){var A=bl(b);if(Kt(A))return b}function Xd(b,A){if(b==="change")return A}var Ju=!1;if(i){var du;if(i){var Pp="oninput"in document;if(!Pp){var ux=document.createElement("div");ux.setAttribute("oninput","return;"),Pp=typeof ux.oninput=="function"}du=Pp}else du=!1;Ju=du&&(!document.documentMode||9<document.documentMode)}function Wm(){Bl&&(Bl.detachEvent("onpropertychange",dx),Va=Bl=null)}function dx(b){if(b.propertyName==="value"&&hf(Va)){var A=[];df(A,Va,b,os(b)),qs(uu,A)}}function hx(b,A,$){b==="focusin"?(Wm(),Bl=A,Va=$,Bl.attachEvent("onpropertychange",dx)):b==="focusout"&&Wm()}function jy(b){if(b==="selectionchange"||b==="keyup"||b==="keydown")return hf(Va)}function ky(b,A){if(b==="click")return hf(A)}function K_(b,A){if(b==="input"||b==="change")return hf(A)}function fx(b,A){return b===A&&(b!==0||1/b===1/A)||b!==b&&A!==A}var no=typeof Object.is=="function"?Object.is:fx;function Cp(b,A){if(no(b,A))return!0;if(typeof b!="object"||b===null||typeof A!="object"||A===null)return!1;var $=Object.keys(b),J=Object.keys(A);if($.length!==J.length)return!1;for(J=0;J<$.length;J++){var de=$[J];if(!x.call(A,de)||!no(b[de],A[de]))return!1}return!0}function Py(b){for(;b&&b.firstChild;)b=b.firstChild;return b}function Hm(b,A){var $=Py(b);b=0;for(var J;$;){if($.nodeType===3){if(J=b+$.textContent.length,b<=A&&J>=A)return{node:$,offset:A-b};b=J}e:{for(;$;){if($.nextSibling){$=$.nextSibling;break e}$=$.parentNode}$=void 0}$=Py($)}}function ff(b,A){return b&&A?b===A?!0:b&&b.nodeType===3?!1:A&&A.nodeType===3?ff(b,A.parentNode):"contains"in b?b.contains(A):b.compareDocumentPosition?!!(b.compareDocumentPosition(A)&16):!1:!1}function Cy(){for(var b=window,A=on();A instanceof b.HTMLIFrameElement;){try{var $=typeof A.contentWindow.location.href=="string"}catch{$=!1}if($)b=A.contentWindow;else break;A=on(b.document)}return A}function Xo(b){var A=b&&b.nodeName&&b.nodeName.toLowerCase();return A&&(A==="input"&&(b.type==="text"||b.type==="search"||b.type==="tel"||b.type==="url"||b.type==="password")||A==="textarea"||b.contentEditable==="true")}function Km(b){var A=Cy(),$=b.focusedElem,J=b.selectionRange;if(A!==$&&$&&$.ownerDocument&&ff($.ownerDocument.documentElement,$)){if(J!==null&&Xo($)){if(A=J.start,b=J.end,b===void 0&&(b=A),"selectionStart"in $)$.selectionStart=A,$.selectionEnd=Math.min(b,$.value.length);else if(b=(A=$.ownerDocument||document)&&A.defaultView||window,b.getSelection){b=b.getSelection();var de=$.textContent.length,ye=Math.min(J.start,de);J=J.end===void 0?ye:Math.min(J.end,de),!b.extend&&ye>J&&(de=J,J=ye,ye=de),de=Hm($,ye);var $e=Hm($,J);de&&$e&&(b.rangeCount!==1||b.anchorNode!==de.node||b.anchorOffset!==de.offset||b.focusNode!==$e.node||b.focusOffset!==$e.offset)&&(A=A.createRange(),A.setStart(de.node,de.offset),b.removeAllRanges(),ye>J?(b.addRange(A),b.extend($e.node,$e.offset)):(A.setEnd($e.node,$e.offset),b.addRange(A)))}}for(A=[],b=$;b=b.parentNode;)b.nodeType===1&&A.push({element:b,left:b.scrollLeft,top:b.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<A.length;$++)b=A[$],b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}var Ep=i&&"documentMode"in document&&11>=document.documentMode,hu=null,Ic=null,Qu=null,Mp=!1;function ed(b,A,$){var J=$.window===$?$.document:$.nodeType===9?$:$.ownerDocument;Mp||hu==null||hu!==on(J)||(J=hu,"selectionStart"in J&&Xo(J)?J={start:J.selectionStart,end:J.selectionEnd}:(J=(J.ownerDocument&&J.ownerDocument.defaultView||window).getSelection(),J={anchorNode:J.anchorNode,anchorOffset:J.anchorOffset,focusNode:J.focusNode,focusOffset:J.focusOffset}),Qu&&Cp(Qu,J)||(Qu=J,J=Dp(Ic,"onSelect"),0<J.length&&(A=new ba("onSelect","select",null,A,$),b.push({event:A,listeners:J}),A.target=hu)))}function fu(b,A){var $={};return $[b.toLowerCase()]=A.toLowerCase(),$["Webkit"+b]="webkit"+A,$["Moz"+b]="moz"+A,$}var Lc={animationend:fu("Animation","AnimationEnd"),animationiteration:fu("Animation","AnimationIteration"),animationstart:fu("Animation","AnimationStart"),transitionend:fu("Transition","TransitionEnd")},Jd={},td={};i&&(td=document.createElement("div").style,"AnimationEvent"in window||(delete Lc.animationend.animation,delete Lc.animationiteration.animation,delete Lc.animationstart.animation),"TransitionEvent"in window||delete Lc.transitionend.transition);function Dc(b){if(Jd[b])return Jd[b];if(!Lc[b])return b;var A=Lc[b],$;for($ in A)if(A.hasOwnProperty($)&&$ in td)return Jd[b]=A[$];return b}var Qd=Dc("animationend"),pf=Dc("animationiteration"),Op=Dc("animationstart"),mf=Dc("transitionend"),eh=new Map,rd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pn(b,A){eh.set(b,A),c(A,[b])}for(var Zm=0;Zm<rd.length;Zm++){var nd=rd[Zm],px=nd.toLowerCase(),mx=nd[0].toUpperCase()+nd.slice(1);Pn(px,"on"+mx)}Pn(Qd,"onAnimationEnd"),Pn(pf,"onAnimationIteration"),Pn(Op,"onAnimationStart"),Pn("dblclick","onDoubleClick"),Pn("focusin","onFocus"),Pn("focusout","onBlur"),Pn(mf,"onTransitionEnd"),h("onMouseEnter",["mouseout","mouseover"]),h("onMouseLeave",["mouseout","mouseover"]),h("onPointerEnter",["pointerout","pointerover"]),h("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Li=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rp));function Ym(b,A,$){var J=b.type||"unknown-event";b.currentTarget=$,Ye(J,A,void 0,b),b.currentTarget=null}function Xm(b,A){A=(A&4)!==0;for(var $=0;$<b.length;$++){var J=b[$],de=J.event;J=J.listeners;e:{var ye=void 0;if(A)for(var $e=J.length-1;0<=$e;$e--){var yt=J[$e],At=yt.instance,Yt=yt.currentTarget;if(yt=yt.listener,At!==ye&&de.isPropagationStopped())break e;Ym(de,yt,Yt),ye=At}else for($e=0;$e<J.length;$e++){if(yt=J[$e],At=yt.instance,Yt=yt.currentTarget,yt=yt.listener,At!==ye&&de.isPropagationStopped())break e;Ym(de,yt,Yt),ye=At}}}if(St)throw b=ve,St=!1,ve=null,b}function fa(b,A){var $=A[ad];$===void 0&&($=A[ad]=new Set);var J=b+"__bubble";$.has(J)||(gx(A,b,2,!1),$.add(J))}function Ip(b,A,$){var J=0;A&&(J|=4),gx($,b,J,A)}var Lp="_reactListening"+Math.random().toString(36).slice(2);function gf(b){if(!b[Lp]){b[Lp]=!0,n.forEach(function($){$!=="selectionchange"&&(Li.has($)||Ip($,!1,b),Ip($,!0,b))});var A=b.nodeType===9?b:b.ownerDocument;A===null||A[Lp]||(A[Lp]=!0,Ip("selectionchange",!1,A))}}function gx(b,A,$,J){switch(wp(A)){case 1:var de=_a;break;case 4:de=by;break;default:de=ro}$=de.bind(null,A,$,b),de=void 0,!Ms||A!=="touchstart"&&A!=="touchmove"&&A!=="wheel"||(de=!0),J?de!==void 0?b.addEventListener(A,$,{capture:!0,passive:de}):b.addEventListener(A,$,!0):de!==void 0?b.addEventListener(A,$,{passive:de}):b.addEventListener(A,$,!1)}function th(b,A,$,J,de){var ye=J;if((A&1)===0&&(A&2)===0&&J!==null)e:for(;;){if(J===null)return;var $e=J.tag;if($e===3||$e===4){var yt=J.stateNode.containerInfo;if(yt===de||yt.nodeType===8&&yt.parentNode===de)break;if($e===4)for($e=J.return;$e!==null;){var At=$e.tag;if((At===3||At===4)&&(At=$e.stateNode.containerInfo,At===de||At.nodeType===8&&At.parentNode===de))return;$e=$e.return}for(;yt!==null;){if($e=sd(yt),$e===null)return;if(At=$e.tag,At===5||At===6){J=ye=$e;continue e}yt=yt.parentNode}}J=J.return}qs(function(){var Yt=ye,Tr=os($),Mr=[];e:{var jr=eh.get(b);if(jr!==void 0){var tn=ba,hn=b;switch(b){case"keypress":if(of($)===0)break e;case"keydown":case"keyup":tn=W_;break;case"focusin":hn="focus",tn=Sp;break;case"focusout":hn="blur",tn=Sp;break;case"beforeblur":case"afterblur":tn=Sp;break;case"click":if($.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tn=Oc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tn=wy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tn=H_;break;case Qd:case pf:case Op:tn=Np;break;case mf:tn=Zd;break;case"scroll":tn=oc;break;case"wheel":tn=zr;break;case"copy":case"cut":case"paste":tn=$_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tn=lx}var gn=(A&4)!==0,Ss=!gn&&b==="scroll",Ut=gn?jr!==null?jr+"Capture":null:jr;gn=[];for(var Ct=Yt,Wt;Ct!==null;){Wt=Ct;var Ir=Wt.stateNode;if(Wt.tag===5&&Ir!==null&&(Wt=Ir,Ut!==null&&(Ir=$i(Ct,Ut),Ir!=null&&gn.push(pu(Ct,Ir,Wt)))),Ss)break;Ct=Ct.return}0<gn.length&&(jr=new tn(jr,hn,null,$,Tr),Mr.push({event:jr,listeners:gn}))}}if((A&7)===0){e:{if(jr=b==="mouseover"||b==="pointerover",tn=b==="mouseout"||b==="pointerout",jr&&$!==ln&&(hn=$.relatedTarget||$.fromElement)&&(sd(hn)||hn[Ul]))break e;if((tn||jr)&&(jr=Tr.window===Tr?Tr:(jr=Tr.ownerDocument)?jr.defaultView||jr.parentWindow:window,tn?(hn=$.relatedTarget||$.toElement,tn=Yt,hn=hn?sd(hn):null,hn!==null&&(Ss=Je(hn),hn!==Ss||hn.tag!==5&&hn.tag!==6)&&(hn=null)):(tn=null,hn=Yt),tn!==hn)){if(gn=Oc,Ir="onMouseLeave",Ut="onMouseEnter",Ct="mouse",(b==="pointerout"||b==="pointerover")&&(gn=lx,Ir="onPointerLeave",Ut="onPointerEnter",Ct="pointer"),Ss=tn==null?jr:bl(tn),Wt=hn==null?jr:bl(hn),jr=new gn(Ir,Ct+"leave",tn,$,Tr),jr.target=Ss,jr.relatedTarget=Wt,Ir=null,sd(Tr)===Yt&&(gn=new gn(Ut,Ct+"enter",hn,$,Tr),gn.target=Wt,gn.relatedTarget=Ss,Ir=gn),Ss=Ir,tn&&hn)t:{for(gn=tn,Ut=hn,Ct=0,Wt=gn;Wt;Wt=Is(Wt))Ct++;for(Wt=0,Ir=Ut;Ir;Ir=Is(Ir))Wt++;for(;0<Ct-Wt;)gn=Is(gn),Ct--;for(;0<Wt-Ct;)Ut=Is(Ut),Wt--;for(;Ct--;){if(gn===Ut||Ut!==null&&gn===Ut.alternate)break t;gn=Is(gn),Ut=Is(Ut)}gn=null}else gn=null;tn!==null&&Jm(Mr,jr,tn,gn,!1),hn!==null&&Ss!==null&&Jm(Mr,Ss,hn,gn,!0)}}e:{if(jr=Yt?bl(Yt):window,tn=jr.nodeName&&jr.nodeName.toLowerCase(),tn==="select"||tn==="input"&&jr.type==="file")var sn=Xd;else if(kp(jr))if(Ju)sn=K_;else{sn=jy;var zn=hx}else(tn=jr.nodeName)&&tn.toLowerCase()==="input"&&(jr.type==="checkbox"||jr.type==="radio")&&(sn=ky);if(sn&&(sn=sn(b,Yt))){df(Mr,sn,$,Tr);break e}zn&&zn(b,jr,Yt),b==="focusout"&&(zn=jr._wrapperState)&&zn.controlled&&jr.type==="number"&&Ot(jr,"number",jr.value)}switch(zn=Yt?bl(Yt):window,b){case"focusin":(kp(zn)||zn.contentEditable==="true")&&(hu=zn,Ic=Yt,Qu=null);break;case"focusout":Qu=Ic=hu=null;break;case"mousedown":Mp=!0;break;case"contextmenu":case"mouseup":case"dragend":Mp=!1,ed(Mr,$,Tr);break;case"selectionchange":if(Ep)break;case"keydown":case"keyup":ed(Mr,$,Tr)}var Un;if(Wr)e:{switch(b){case"compositionstart":var si="onCompositionStart";break e;case"compositionend":si="onCompositionEnd";break e;case"compositionupdate":si="onCompositionUpdate";break e}si=void 0}else vs?Gm(b,$)&&(si="onCompositionEnd"):b==="keydown"&&$.keyCode===229&&(si="onCompositionStart");si&&(Jr&&$.locale!=="ko"&&(vs||si!=="onCompositionStart"?si==="onCompositionEnd"&&vs&&(Un=Rs()):(Fl=Tr,Os="value"in Fl?Fl.value:Fl.textContent,vs=!0)),zn=Dp(Yt,si),0<zn.length&&(si=new cf(si,b,null,$,Tr),Mr.push({event:si,listeners:zn}),Un?si.data=Un:(Un=jp($),Un!==null&&(si.data=Un)))),(Un=qm?Gs(b,$):cr(b,$))&&(Yt=Dp(Yt,"onBeforeInput"),0<Yt.length&&(Tr=new cf("onBeforeInput","beforeinput",null,$,Tr),Mr.push({event:Tr,listeners:Yt}),Tr.data=Un))}Xm(Mr,A)})}function pu(b,A,$){return{instance:b,listener:A,currentTarget:$}}function Dp(b,A){for(var $=A+"Capture",J=[];b!==null;){var de=b,ye=de.stateNode;de.tag===5&&ye!==null&&(de=ye,ye=$i(b,$),ye!=null&&J.unshift(pu(b,ye,de)),ye=$i(b,A),ye!=null&&J.push(pu(b,ye,de))),b=b.return}return J}function Is(b){if(b===null)return null;do b=b.return;while(b&&b.tag!==5);return b||null}function Jm(b,A,$,J,de){for(var ye=A._reactName,$e=[];$!==null&&$!==J;){var yt=$,At=yt.alternate,Yt=yt.stateNode;if(At!==null&&At===J)break;yt.tag===5&&Yt!==null&&(yt=Yt,de?(At=$i($,ye),At!=null&&$e.unshift(pu($,At,yt))):de||(At=$i($,ye),At!=null&&$e.push(pu($,At,yt)))),$=$.return}$e.length!==0&&b.push({event:A,listeners:$e})}var Qm=/\r\n?/g,eg=/\u0000|\uFFFD/g;function tg(b){return(typeof b=="string"?b:""+b).replace(Qm,`
`).replace(eg,"")}function yf(b,A,$){if(A=tg(A),tg(b)!==A&&$)throw Error(r(425))}function rh(){}var Fp=null,zp=null;function xf(b,A){return b==="textarea"||b==="noscript"||typeof A.children=="string"||typeof A.children=="number"||typeof A.dangerouslySetInnerHTML=="object"&&A.dangerouslySetInnerHTML!==null&&A.dangerouslySetInnerHTML.__html!=null}var rg=typeof setTimeout=="function"?setTimeout:void 0,yx=typeof clearTimeout=="function"?clearTimeout:void 0,nh=typeof Promise=="function"?Promise:void 0,Z_=typeof queueMicrotask=="function"?queueMicrotask:typeof nh<"u"?function(b){return nh.resolve(null).then(b).catch(Y_)}:rg;function Y_(b){setTimeout(function(){throw b})}function Ey(b,A){var $=A,J=0;do{var de=$.nextSibling;if(b.removeChild($),de&&de.nodeType===8)if($=de.data,$==="/$"){if(J===0){b.removeChild(de),Yo(A);return}J--}else $!=="$"&&$!=="$?"&&$!=="$!"||J++;$=de}while($);Yo(A)}function id(b){for(;b!=null;b=b.nextSibling){var A=b.nodeType;if(A===1||A===3)break;if(A===8){if(A=b.data,A==="$"||A==="$!"||A==="$?")break;if(A==="/$")return null}}return b}function xx(b){b=b.previousSibling;for(var A=0;b;){if(b.nodeType===8){var $=b.data;if($==="$"||$==="$!"||$==="$?"){if(A===0)return b;A--}else $==="/$"&&A++}b=b.previousSibling}return null}var vf=Math.random().toString(36).slice(2),Vl="__reactFiber$"+vf,ih="__reactProps$"+vf,Ul="__reactContainer$"+vf,ad="__reactEvents$"+vf,My="__reactListeners$"+vf,vx="__reactHandles$"+vf;function sd(b){var A=b[Vl];if(A)return A;for(var $=b.parentNode;$;){if(A=$[Ul]||$[Vl]){if($=A.alternate,A.child!==null||$!==null&&$.child!==null)for(b=xx(b);b!==null;){if($=b[Vl])return $;b=xx(b)}return A}b=$,$=b.parentNode}return null}function ah(b){return b=b[Vl]||b[Ul],!b||b.tag!==5&&b.tag!==6&&b.tag!==13&&b.tag!==3?null:b}function bl(b){if(b.tag===5||b.tag===6)return b.stateNode;throw Error(r(33))}function _f(b){return b[ih]||null}var Ro=[],mu=-1;function $l(b){return{current:b}}function wa(b){0>mu||(b.current=Ro[mu],Ro[mu]=null,mu--)}function ra(b,A){mu++,Ro[mu]=b.current,b.current=A}var ql={},Ws=$l(ql),Jo=$l(!1),gu=ql;function cc(b,A){var $=b.type.contextTypes;if(!$)return ql;var J=b.stateNode;if(J&&J.__reactInternalMemoizedUnmaskedChildContext===A)return J.__reactInternalMemoizedMaskedChildContext;var de={},ye;for(ye in $)de[ye]=A[ye];return J&&(b=b.stateNode,b.__reactInternalMemoizedUnmaskedChildContext=A,b.__reactInternalMemoizedMaskedChildContext=de),de}function Qo(b){return b=b.childContextTypes,b!=null}function ng(){wa(Jo),wa(Ws)}function Oy(b,A,$){if(Ws.current!==ql)throw Error(r(168));ra(Ws,A),ra(Jo,$)}function Ry(b,A,$){var J=b.stateNode;if(A=A.childContextTypes,typeof J.getChildContext!="function")return $;J=J.getChildContext();for(var de in J)if(!(de in A))throw Error(r(108,rr(b)||"Unknown",de));return Ge({},$,J)}function sh(b){return b=(b=b.stateNode)&&b.__reactInternalMemoizedMergedChildContext||ql,gu=Ws.current,ra(Ws,b),ra(Jo,Jo.current),!0}function oh(b,A,$){var J=b.stateNode;if(!J)throw Error(r(169));$?(b=Ry(b,A,gu),J.__reactInternalMemoizedMergedChildContext=b,wa(Jo),wa(Ws),ra(Ws,b)):wa(Jo),ra(Jo,$)}var el=null,lh=!1,ch=!1;function Iy(b){el===null?el=[b]:el.push(b)}function Bp(b){lh=!0,Iy(b)}function Gl(){if(!ch&&el!==null){ch=!0;var b=0,A=xi;try{var $=el;for(xi=1;b<$.length;b++){var J=$[b];do J=J(!0);while(J!==null)}el=null,lh=!1}catch(de){throw el!==null&&(el=el.slice(b+1)),Nt(Ur,Gl),de}finally{xi=A,ch=!1}}return null}var od=[],uh=0,ig=null,Fc=0,Io=[],mr=0,yu=null,uc=1,_o="";function wl(b,A){od[uh++]=Fc,od[uh++]=ig,ig=b,Fc=A}function Er(b,A,$){Io[mr++]=uc,Io[mr++]=_o,Io[mr++]=yu,yu=b;var J=uc;b=_o;var de=32-ys(J)-1;J&=~(1<<de),$+=1;var ye=32-ys(A)+de;if(30<ye){var $e=de-de%5;ye=(J&(1<<$e)-1).toString(32),J>>=$e,de-=$e,uc=1<<32-ys(A)+de|$<<de|J,_o=ye+b}else uc=1<<ye|$<<de|J,_o=b}function Vp(b){b.return!==null&&(wl(b,1),Er(b,1,0))}function Ly(b){for(;b===ig;)ig=od[--uh],od[uh]=null,Fc=od[--uh],od[uh]=null;for(;b===yu;)yu=Io[--mr],Io[mr]=null,_o=Io[--mr],Io[mr]=null,uc=Io[--mr],Io[mr]=null}var Sl=null,bo=null,Sa=!1,Nl=null;function Dy(b,A){var $=Wc(5,null,null,0);$.elementType="DELETED",$.stateNode=A,$.return=b,A=b.deletions,A===null?(b.deletions=[$],b.flags|=16):A.push($)}function ag(b,A){switch(b.tag){case 5:var $=b.type;return A=A.nodeType!==1||$.toLowerCase()!==A.nodeName.toLowerCase()?null:A,A!==null?(b.stateNode=A,Sl=b,bo=id(A.firstChild),!0):!1;case 6:return A=b.pendingProps===""||A.nodeType!==3?null:A,A!==null?(b.stateNode=A,Sl=b,bo=null,!0):!1;case 13:return A=A.nodeType!==8?null:A,A!==null?($=yu!==null?{id:uc,overflow:_o}:null,b.memoizedState={dehydrated:A,treeContext:$,retryLane:1073741824},$=Wc(18,null,null,0),$.stateNode=A,$.return=b,b.child=$,Sl=b,bo=null,!0):!1;default:return!1}}function dh(b){return(b.mode&1)!==0&&(b.flags&128)===0}function bf(b){if(Sa){var A=bo;if(A){var $=A;if(!ag(b,A)){if(dh(b))throw Error(r(418));A=id($.nextSibling);var J=Sl;A&&ag(b,A)?Dy(J,$):(b.flags=b.flags&-4097|2,Sa=!1,Sl=b)}}else{if(dh(b))throw Error(r(418));b.flags=b.flags&-4097|2,Sa=!1,Sl=b}}}function sg(b){for(b=b.return;b!==null&&b.tag!==5&&b.tag!==3&&b.tag!==13;)b=b.return;Sl=b}function Al(b){if(b!==Sl)return!1;if(!Sa)return sg(b),Sa=!0,!1;var A;if((A=b.tag!==3)&&!(A=b.tag!==5)&&(A=b.type,A=A!=="head"&&A!=="body"&&!xf(b.type,b.memoizedProps)),A&&(A=bo)){if(dh(b))throw Lo(),Error(r(418));for(;A;)Dy(b,A),A=id(A.nextSibling)}if(sg(b),b.tag===13){if(b=b.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(r(317));e:{for(b=b.nextSibling,A=0;b;){if(b.nodeType===8){var $=b.data;if($==="/$"){if(A===0){bo=id(b.nextSibling);break e}A--}else $!=="$"&&$!=="$!"&&$!=="$?"||A++}b=b.nextSibling}bo=null}}else bo=Sl?id(b.stateNode.nextSibling):null;return!0}function Lo(){for(var b=bo;b;)b=id(b.nextSibling)}function Tl(){bo=Sl=null,Sa=!1}function Up(b){Nl===null?Nl=[b]:Nl.push(b)}var Fy=ae.ReactCurrentBatchConfig;function zc(b,A,$){if(b=$.ref,b!==null&&typeof b!="function"&&typeof b!="object"){if($._owner){if($=$._owner,$){if($.tag!==1)throw Error(r(309));var J=$.stateNode}if(!J)throw Error(r(147,b));var de=J,ye=""+b;return A!==null&&A.ref!==null&&typeof A.ref=="function"&&A.ref._stringRef===ye?A.ref:(A=function($e){var yt=de.refs;$e===null?delete yt[ye]:yt[ye]=$e},A._stringRef=ye,A)}if(typeof b!="string")throw Error(r(284));if(!$._owner)throw Error(r(290,b))}return b}function hh(b,A){throw b=Object.prototype.toString.call(A),Error(r(31,b==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":b))}function wf(b){var A=b._init;return A(b._payload)}function tl(b){function A(Ut,Ct){if(b){var Wt=Ut.deletions;Wt===null?(Ut.deletions=[Ct],Ut.flags|=16):Wt.push(Ct)}}function $(Ut,Ct){if(!b)return null;for(;Ct!==null;)A(Ut,Ct),Ct=Ct.sibling;return null}function J(Ut,Ct){for(Ut=new Map;Ct!==null;)Ct.key!==null?Ut.set(Ct.key,Ct):Ut.set(Ct.index,Ct),Ct=Ct.sibling;return Ut}function de(Ut,Ct){return Ut=jh(Ut,Ct),Ut.index=0,Ut.sibling=null,Ut}function ye(Ut,Ct,Wt){return Ut.index=Wt,b?(Wt=Ut.alternate,Wt!==null?(Wt=Wt.index,Wt<Ct?(Ut.flags|=2,Ct):Wt):(Ut.flags|=2,Ct)):(Ut.flags|=1048576,Ct)}function $e(Ut){return b&&Ut.alternate===null&&(Ut.flags|=2),Ut}function yt(Ut,Ct,Wt,Ir){return Ct===null||Ct.tag!==6?(Ct=Ax(Wt,Ut.mode,Ir),Ct.return=Ut,Ct):(Ct=de(Ct,Wt),Ct.return=Ut,Ct)}function At(Ut,Ct,Wt,Ir){var sn=Wt.type;return sn===ue?Tr(Ut,Ct,Wt.props.children,Ir,Wt.key):Ct!==null&&(Ct.elementType===sn||typeof sn=="object"&&sn!==null&&sn.$$typeof===we&&wf(sn)===Ct.type)?(Ir=de(Ct,Wt.props),Ir.ref=zc(Ut,Ct,Wt),Ir.return=Ut,Ir):(Ir=Xy(Wt.type,Wt.key,Wt.props,null,Ut.mode,Ir),Ir.ref=zc(Ut,Ct,Wt),Ir.return=Ut,Ir)}function Yt(Ut,Ct,Wt,Ir){return Ct===null||Ct.tag!==4||Ct.stateNode.containerInfo!==Wt.containerInfo||Ct.stateNode.implementation!==Wt.implementation?(Ct=Tx(Wt,Ut.mode,Ir),Ct.return=Ut,Ct):(Ct=de(Ct,Wt.children||[]),Ct.return=Ut,Ct)}function Tr(Ut,Ct,Wt,Ir,sn){return Ct===null||Ct.tag!==7?(Ct=Ff(Wt,Ut.mode,Ir,sn),Ct.return=Ut,Ct):(Ct=de(Ct,Wt),Ct.return=Ut,Ct)}function Mr(Ut,Ct,Wt){if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number")return Ct=Ax(""+Ct,Ut.mode,Wt),Ct.return=Ut,Ct;if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case ee:return Wt=Xy(Ct.type,Ct.key,Ct.props,null,Ut.mode,Wt),Wt.ref=zc(Ut,null,Ct),Wt.return=Ut,Wt;case se:return Ct=Tx(Ct,Ut.mode,Wt),Ct.return=Ut,Ct;case we:var Ir=Ct._init;return Mr(Ut,Ir(Ct._payload),Wt)}if(Zt(Ct)||Be(Ct))return Ct=Ff(Ct,Ut.mode,Wt,null),Ct.return=Ut,Ct;hh(Ut,Ct)}return null}function jr(Ut,Ct,Wt,Ir){var sn=Ct!==null?Ct.key:null;if(typeof Wt=="string"&&Wt!==""||typeof Wt=="number")return sn!==null?null:yt(Ut,Ct,""+Wt,Ir);if(typeof Wt=="object"&&Wt!==null){switch(Wt.$$typeof){case ee:return Wt.key===sn?At(Ut,Ct,Wt,Ir):null;case se:return Wt.key===sn?Yt(Ut,Ct,Wt,Ir):null;case we:return sn=Wt._init,jr(Ut,Ct,sn(Wt._payload),Ir)}if(Zt(Wt)||Be(Wt))return sn!==null?null:Tr(Ut,Ct,Wt,Ir,null);hh(Ut,Wt)}return null}function tn(Ut,Ct,Wt,Ir,sn){if(typeof Ir=="string"&&Ir!==""||typeof Ir=="number")return Ut=Ut.get(Wt)||null,yt(Ct,Ut,""+Ir,sn);if(typeof Ir=="object"&&Ir!==null){switch(Ir.$$typeof){case ee:return Ut=Ut.get(Ir.key===null?Wt:Ir.key)||null,At(Ct,Ut,Ir,sn);case se:return Ut=Ut.get(Ir.key===null?Wt:Ir.key)||null,Yt(Ct,Ut,Ir,sn);case we:var zn=Ir._init;return tn(Ut,Ct,Wt,zn(Ir._payload),sn)}if(Zt(Ir)||Be(Ir))return Ut=Ut.get(Wt)||null,Tr(Ct,Ut,Ir,sn,null);hh(Ct,Ir)}return null}function hn(Ut,Ct,Wt,Ir){for(var sn=null,zn=null,Un=Ct,si=Ct=0,Ao=null;Un!==null&&si<Wt.length;si++){Un.index>si?(Ao=Un,Un=null):Ao=Un.sibling;var Ji=jr(Ut,Un,Wt[si],Ir);if(Ji===null){Un===null&&(Un=Ao);break}b&&Un&&Ji.alternate===null&&A(Ut,Un),Ct=ye(Ji,Ct,si),zn===null?sn=Ji:zn.sibling=Ji,zn=Ji,Un=Ao}if(si===Wt.length)return $(Ut,Un),Sa&&wl(Ut,si),sn;if(Un===null){for(;si<Wt.length;si++)Un=Mr(Ut,Wt[si],Ir),Un!==null&&(Ct=ye(Un,Ct,si),zn===null?sn=Un:zn.sibling=Un,zn=Un);return Sa&&wl(Ut,si),sn}for(Un=J(Ut,Un);si<Wt.length;si++)Ao=tn(Un,Ut,si,Wt[si],Ir),Ao!==null&&(b&&Ao.alternate!==null&&Un.delete(Ao.key===null?si:Ao.key),Ct=ye(Ao,Ct,si),zn===null?sn=Ao:zn.sibling=Ao,zn=Ao);return b&&Un.forEach(function(zf){return A(Ut,zf)}),Sa&&wl(Ut,si),sn}function gn(Ut,Ct,Wt,Ir){var sn=Be(Wt);if(typeof sn!="function")throw Error(r(150));if(Wt=sn.call(Wt),Wt==null)throw Error(r(151));for(var zn=sn=null,Un=Ct,si=Ct=0,Ao=null,Ji=Wt.next();Un!==null&&!Ji.done;si++,Ji=Wt.next()){Un.index>si?(Ao=Un,Un=null):Ao=Un.sibling;var zf=jr(Ut,Un,Ji.value,Ir);if(zf===null){Un===null&&(Un=Ao);break}b&&Un&&zf.alternate===null&&A(Ut,Un),Ct=ye(zf,Ct,si),zn===null?sn=zf:zn.sibling=zf,zn=zf,Un=Ao}if(Ji.done)return $(Ut,Un),Sa&&wl(Ut,si),sn;if(Un===null){for(;!Ji.done;si++,Ji=Wt.next())Ji=Mr(Ut,Ji.value,Ir),Ji!==null&&(Ct=ye(Ji,Ct,si),zn===null?sn=Ji:zn.sibling=Ji,zn=Ji);return Sa&&wl(Ut,si),sn}for(Un=J(Ut,Un);!Ji.done;si++,Ji=Wt.next())Ji=tn(Un,Ut,si,Ji.value,Ir),Ji!==null&&(b&&Ji.alternate!==null&&Un.delete(Ji.key===null?si:Ji.key),Ct=ye(Ji,Ct,si),zn===null?sn=Ji:zn.sibling=Ji,zn=Ji);return b&&Un.forEach(function(qj){return A(Ut,qj)}),Sa&&wl(Ut,si),sn}function Ss(Ut,Ct,Wt,Ir){if(typeof Wt=="object"&&Wt!==null&&Wt.type===ue&&Wt.key===null&&(Wt=Wt.props.children),typeof Wt=="object"&&Wt!==null){switch(Wt.$$typeof){case ee:e:{for(var sn=Wt.key,zn=Ct;zn!==null;){if(zn.key===sn){if(sn=Wt.type,sn===ue){if(zn.tag===7){$(Ut,zn.sibling),Ct=de(zn,Wt.props.children),Ct.return=Ut,Ut=Ct;break e}}else if(zn.elementType===sn||typeof sn=="object"&&sn!==null&&sn.$$typeof===we&&wf(sn)===zn.type){$(Ut,zn.sibling),Ct=de(zn,Wt.props),Ct.ref=zc(Ut,zn,Wt),Ct.return=Ut,Ut=Ct;break e}$(Ut,zn);break}else A(Ut,zn);zn=zn.sibling}Wt.type===ue?(Ct=Ff(Wt.props.children,Ut.mode,Ir,Wt.key),Ct.return=Ut,Ut=Ct):(Ir=Xy(Wt.type,Wt.key,Wt.props,null,Ut.mode,Ir),Ir.ref=zc(Ut,Ct,Wt),Ir.return=Ut,Ut=Ir)}return $e(Ut);case se:e:{for(zn=Wt.key;Ct!==null;){if(Ct.key===zn)if(Ct.tag===4&&Ct.stateNode.containerInfo===Wt.containerInfo&&Ct.stateNode.implementation===Wt.implementation){$(Ut,Ct.sibling),Ct=de(Ct,Wt.children||[]),Ct.return=Ut,Ut=Ct;break e}else{$(Ut,Ct);break}else A(Ut,Ct);Ct=Ct.sibling}Ct=Tx(Wt,Ut.mode,Ir),Ct.return=Ut,Ut=Ct}return $e(Ut);case we:return zn=Wt._init,Ss(Ut,Ct,zn(Wt._payload),Ir)}if(Zt(Wt))return hn(Ut,Ct,Wt,Ir);if(Be(Wt))return gn(Ut,Ct,Wt,Ir);hh(Ut,Wt)}return typeof Wt=="string"&&Wt!==""||typeof Wt=="number"?(Wt=""+Wt,Ct!==null&&Ct.tag===6?($(Ut,Ct.sibling),Ct=de(Ct,Wt),Ct.return=Ut,Ut=Ct):($(Ut,Ct),Ct=Ax(Wt,Ut.mode,Ir),Ct.return=Ut,Ut=Ct),$e(Ut)):$(Ut,Ct)}return Ss}var vi=tl(!0),$p=tl(!1),ld=$l(null),fh=null,cd=null,ph=null;function ud(){ph=cd=fh=null}function dd(b){var A=ld.current;wa(ld),b._currentValue=A}function hd(b,A,$){for(;b!==null;){var J=b.alternate;if((b.childLanes&A)!==A?(b.childLanes|=A,J!==null&&(J.childLanes|=A)):J!==null&&(J.childLanes&A)!==A&&(J.childLanes|=A),b===$)break;b=b.return}}function Jt(b,A){fh=b,ph=cd=null,b=b.dependencies,b!==null&&b.firstContext!==null&&((b.lanes&A)!==0&&(wo=!0),b.firstContext=null)}function dr(b){var A=b._currentValue;if(ph!==b)if(b={context:b,memoizedValue:A,next:null},cd===null){if(fh===null)throw Error(r(308));cd=b,fh.dependencies={lanes:0,firstContext:b}}else cd=cd.next=b;return A}var Wl=null;function qi(b){Wl===null?Wl=[b]:Wl.push(b)}function vt(b,A,$,J){var de=A.interleaved;return de===null?($.next=$,qi(A)):($.next=de.next,de.next=$),A.interleaved=$,Bc(b,J)}function Bc(b,A){b.lanes|=A;var $=b.alternate;for($!==null&&($.lanes|=A),$=b,b=b.return;b!==null;)b.childLanes|=A,$=b.alternate,$!==null&&($.childLanes|=A),$=b,b=b.return;return $.tag===3?$.stateNode:null}var dc=!1;function qp(b){b.updateQueue={baseState:b.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zy(b,A){b=b.updateQueue,A.updateQueue===b&&(A.updateQueue={baseState:b.baseState,firstBaseUpdate:b.firstBaseUpdate,lastBaseUpdate:b.lastBaseUpdate,shared:b.shared,effects:b.effects})}function Vc(b,A){return{eventTime:b,lane:A,tag:0,payload:null,callback:null,next:null}}function xu(b,A,$){var J=b.updateQueue;if(J===null)return null;if(J=J.shared,(Xe&2)!==0){var de=J.pending;return de===null?A.next=A:(A.next=de.next,de.next=A),J.pending=A,Bc(b,$)}return de=J.interleaved,de===null?(A.next=A,qi(J)):(A.next=de.next,de.next=A),J.interleaved=A,Bc(b,$)}function vu(b,A,$){if(A=A.updateQueue,A!==null&&(A=A.shared,($&4194240)!==0)){var J=A.lanes;J&=b.pendingLanes,$|=J,A.lanes=$,vl(b,$)}}function _x(b,A){var $=b.updateQueue,J=b.alternate;if(J!==null&&(J=J.updateQueue,$===J)){var de=null,ye=null;if($=$.firstBaseUpdate,$!==null){do{var $e={eventTime:$.eventTime,lane:$.lane,tag:$.tag,payload:$.payload,callback:$.callback,next:null};ye===null?de=ye=$e:ye=ye.next=$e,$=$.next}while($!==null);ye===null?de=ye=A:ye=ye.next=A}else de=ye=A;$={baseState:J.baseState,firstBaseUpdate:de,lastBaseUpdate:ye,shared:J.shared,effects:J.effects},b.updateQueue=$;return}b=$.lastBaseUpdate,b===null?$.firstBaseUpdate=A:b.next=A,$.lastBaseUpdate=A}function og(b,A,$,J){var de=b.updateQueue;dc=!1;var ye=de.firstBaseUpdate,$e=de.lastBaseUpdate,yt=de.shared.pending;if(yt!==null){de.shared.pending=null;var At=yt,Yt=At.next;At.next=null,$e===null?ye=Yt:$e.next=Yt,$e=At;var Tr=b.alternate;Tr!==null&&(Tr=Tr.updateQueue,yt=Tr.lastBaseUpdate,yt!==$e&&(yt===null?Tr.firstBaseUpdate=Yt:yt.next=Yt,Tr.lastBaseUpdate=At))}if(ye!==null){var Mr=de.baseState;$e=0,Tr=Yt=At=null,yt=ye;do{var jr=yt.lane,tn=yt.eventTime;if((J&jr)===jr){Tr!==null&&(Tr=Tr.next={eventTime:tn,lane:0,tag:yt.tag,payload:yt.payload,callback:yt.callback,next:null});e:{var hn=b,gn=yt;switch(jr=A,tn=$,gn.tag){case 1:if(hn=gn.payload,typeof hn=="function"){Mr=hn.call(tn,Mr,jr);break e}Mr=hn;break e;case 3:hn.flags=hn.flags&-65537|128;case 0:if(hn=gn.payload,jr=typeof hn=="function"?hn.call(tn,Mr,jr):hn,jr==null)break e;Mr=Ge({},Mr,jr);break e;case 2:dc=!0}}yt.callback!==null&&yt.lane!==0&&(b.flags|=64,jr=de.effects,jr===null?de.effects=[yt]:jr.push(yt))}else tn={eventTime:tn,lane:jr,tag:yt.tag,payload:yt.payload,callback:yt.callback,next:null},Tr===null?(Yt=Tr=tn,At=Mr):Tr=Tr.next=tn,$e|=jr;if(yt=yt.next,yt===null){if(yt=de.shared.pending,yt===null)break;jr=yt,yt=jr.next,jr.next=null,de.lastBaseUpdate=jr,de.shared.pending=null}}while(!0);if(Tr===null&&(At=Mr),de.baseState=At,de.firstBaseUpdate=Yt,de.lastBaseUpdate=Tr,A=de.shared.interleaved,A!==null){de=A;do $e|=de.lane,de=de.next;while(de!==A)}else ye===null&&(de.shared.lanes=0);$t|=$e,b.lanes=$e,b.memoizedState=Mr}}function By(b,A,$){if(b=A.effects,A.effects=null,b!==null)for(A=0;A<b.length;A++){var J=b[A],de=J.callback;if(de!==null){if(J.callback=null,J=$,typeof de!="function")throw Error(r(191,de));de.call(J)}}}var fd={},io=$l(fd),mh=$l(fd),gh=$l(fd);function jl(b){if(b===fd)throw Error(r(174));return b}function Sf(b,A){switch(ra(gh,A),ra(mh,b),ra(io,fd),b=A.nodeType,b){case 9:case 11:A=(A=A.documentElement)?A.namespaceURI:Vi(null,"");break;default:b=b===8?A.parentNode:A,A=b.namespaceURI||null,b=b.tagName,A=Vi(A,b)}wa(io),ra(io,A)}function Do(){wa(io),wa(mh),wa(gh)}function Uc(b){jl(gh.current);var A=jl(io.current),$=Vi(A,b.type);A!==$&&(ra(mh,b),ra(io,$))}function lg(b){mh.current===b&&(wa(io),wa(mh))}var hi=$l(0);function cg(b){for(var A=b;A!==null;){if(A.tag===13){var $=A.memoizedState;if($!==null&&($=$.dehydrated,$===null||$.data==="$?"||$.data==="$!"))return A}else if(A.tag===19&&A.memoizedProps.revealOrder!==void 0){if((A.flags&128)!==0)return A}else if(A.child!==null){A.child.return=A,A=A.child;continue}if(A===b)break;for(;A.sibling===null;){if(A.return===null||A.return===b)return null;A=A.return}A.sibling.return=A.return,A=A.sibling}return null}var yh=[];function Pi(){for(var b=0;b<yh.length;b++)yh[b]._workInProgressVersionPrimary=null;yh.length=0}var Jn=ae.ReactCurrentDispatcher,ug=ae.ReactCurrentBatchConfig,Fo=0,la=null,pa=null,cs=null,pd=!1,rl=!1,us=0,dg=0;function _s(){throw Error(r(321))}function Gp(b,A){if(A===null)return!1;for(var $=0;$<A.length&&$<b.length;$++)if(!no(b[$],A[$]))return!1;return!0}function Wp(b,A,$,J,de,ye){if(Fo=ye,la=A,A.memoizedState=null,A.updateQueue=null,A.lanes=0,Jn.current=b===null||b.memoizedState===null?X_:Na,b=$(J,de),rl){ye=0;do{if(rl=!1,us=0,25<=ye)throw Error(r(301));ye+=1,cs=pa=null,A.updateQueue=null,Jn.current=xg,b=$(J,de)}while(rl)}if(Jn.current=yg,A=pa!==null&&pa.next!==null,Fo=0,cs=pa=la=null,pd=!1,A)throw Error(r(300));return b}function _u(){var b=us!==0;return us=0,b}function Hl(){var b={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cs===null?la.memoizedState=cs=b:cs=cs.next=b,cs}function Ls(){if(pa===null){var b=la.alternate;b=b!==null?b.memoizedState:null}else b=pa.next;var A=cs===null?la.memoizedState:cs.next;if(A!==null)cs=A,pa=b;else{if(b===null)throw Error(r(310));pa=b,b={memoizedState:pa.memoizedState,baseState:pa.baseState,baseQueue:pa.baseQueue,queue:pa.queue,next:null},cs===null?la.memoizedState=cs=b:cs=cs.next=b}return cs}function xh(b,A){return typeof A=="function"?A(b):A}function Nf(b){var A=Ls(),$=A.queue;if($===null)throw Error(r(311));$.lastRenderedReducer=b;var J=pa,de=J.baseQueue,ye=$.pending;if(ye!==null){if(de!==null){var $e=de.next;de.next=ye.next,ye.next=$e}J.baseQueue=de=ye,$.pending=null}if(de!==null){ye=de.next,J=J.baseState;var yt=$e=null,At=null,Yt=ye;do{var Tr=Yt.lane;if((Fo&Tr)===Tr)At!==null&&(At=At.next={lane:0,action:Yt.action,hasEagerState:Yt.hasEagerState,eagerState:Yt.eagerState,next:null}),J=Yt.hasEagerState?Yt.eagerState:b(J,Yt.action);else{var Mr={lane:Tr,action:Yt.action,hasEagerState:Yt.hasEagerState,eagerState:Yt.eagerState,next:null};At===null?(yt=At=Mr,$e=J):At=At.next=Mr,la.lanes|=Tr,$t|=Tr}Yt=Yt.next}while(Yt!==null&&Yt!==ye);At===null?$e=J:At.next=yt,no(J,A.memoizedState)||(wo=!0),A.memoizedState=J,A.baseState=$e,A.baseQueue=At,$.lastRenderedState=J}if(b=$.interleaved,b!==null){de=b;do ye=de.lane,la.lanes|=ye,$t|=ye,de=de.next;while(de!==b)}else de===null&&($.lanes=0);return[A.memoizedState,$.dispatch]}function Hp(b){var A=Ls(),$=A.queue;if($===null)throw Error(r(311));$.lastRenderedReducer=b;var J=$.dispatch,de=$.pending,ye=A.memoizedState;if(de!==null){$.pending=null;var $e=de=de.next;do ye=b(ye,$e.action),$e=$e.next;while($e!==de);no(ye,A.memoizedState)||(wo=!0),A.memoizedState=ye,A.baseQueue===null&&(A.baseState=ye),$.lastRenderedState=ye}return[ye,J]}function hg(){}function bs(b,A){var $=la,J=Ls(),de=A(),ye=!no(J.memoizedState,de);if(ye&&(J.memoizedState=de,wo=!0),J=J.queue,_h(Af.bind(null,$,J,b),[b]),J.getSnapshot!==A||ye||cs!==null&&cs.memoizedState.tag&1){if($.flags|=2048,md(9,pg.bind(null,$,J,de,A),void 0,null),at===null)throw Error(r(349));(Fo&30)!==0||fg($,A,de)}return de}function fg(b,A,$){b.flags|=16384,b={getSnapshot:A,value:$},A=la.updateQueue,A===null?(A={lastEffect:null,stores:null},la.updateQueue=A,A.stores=[b]):($=A.stores,$===null?A.stores=[b]:$.push(b))}function pg(b,A,$,J){A.value=$,A.getSnapshot=J,bu(A)&&Kp(b)}function Af(b,A,$){return $(function(){bu(A)&&Kp(b)})}function bu(b){var A=b.getSnapshot;b=b.value;try{var $=A();return!no(b,$)}catch{return!0}}function Kp(b){var A=Bc(b,1);A!==null&&jn(A,b,1,-1)}function hc(b){var A=Hl();return typeof b=="function"&&(b=b()),A.memoizedState=A.baseState=b,b={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xh,lastRenderedState:b},A.queue=b,b=b.dispatch=Xp.bind(null,la,b),[A.memoizedState,b]}function md(b,A,$,J){return b={tag:b,create:A,destroy:$,deps:J,next:null},A=la.updateQueue,A===null?(A={lastEffect:null,stores:null},la.updateQueue=A,A.lastEffect=b.next=b):($=A.lastEffect,$===null?A.lastEffect=b.next=b:(J=$.next,$.next=b,b.next=J,A.lastEffect=b)),b}function vh(){return Ls().memoizedState}function Tf(b,A,$,J){var de=Hl();la.flags|=b,de.memoizedState=md(1|A,$,void 0,J===void 0?null:J)}function jf(b,A,$,J){var de=Ls();J=J===void 0?null:J;var ye=void 0;if(pa!==null){var $e=pa.memoizedState;if(ye=$e.destroy,J!==null&&Gp(J,$e.deps)){de.memoizedState=md(A,$,ye,J);return}}la.flags|=b,de.memoizedState=md(1|A,$,ye,J)}function kf(b,A){return Tf(8390656,8,b,A)}function _h(b,A){return jf(2048,8,b,A)}function mg(b,A){return jf(4,2,b,A)}function Zp(b,A){return jf(4,4,b,A)}function Vy(b,A){if(typeof A=="function")return b=b(),A(b),function(){A(null)};if(A!=null)return b=b(),A.current=b,function(){A.current=null}}function gg(b,A,$){return $=$!=null?$.concat([b]):null,jf(4,4,Vy.bind(null,A,b),$)}function bh(){}function Uy(b,A){var $=Ls();A=A===void 0?null:A;var J=$.memoizedState;return J!==null&&A!==null&&Gp(A,J[1])?J[0]:($.memoizedState=[b,A],b)}function $y(b,A){var $=Ls();A=A===void 0?null:A;var J=$.memoizedState;return J!==null&&A!==null&&Gp(A,J[1])?J[0]:(b=b(),$.memoizedState=[b,A],b)}function qy(b,A,$){return(Fo&21)===0?(b.baseState&&(b.baseState=!1,wo=!0),b.memoizedState=$):(no($,A)||($=to(),la.lanes|=$,$t|=$,b.baseState=!0),A)}function bx(b,A){var $=xi;xi=$!==0&&4>$?$:4,b(!0);var J=ug.transition;ug.transition={};try{b(!1),A()}finally{xi=$,ug.transition=J}}function Gy(){return Ls().memoizedState}function Yp(b,A,$){var J=Qr(b);if($={lane:J,action:$,hasEagerState:!1,eagerState:null,next:null},zo(b))Pf(A,$);else if($=vt(b,A,$,J),$!==null){var de=Zn();jn($,b,J,de),Wy($,A,J)}}function Xp(b,A,$){var J=Qr(b),de={lane:J,action:$,hasEagerState:!1,eagerState:null,next:null};if(zo(b))Pf(A,de);else{var ye=b.alternate;if(b.lanes===0&&(ye===null||ye.lanes===0)&&(ye=A.lastRenderedReducer,ye!==null))try{var $e=A.lastRenderedState,yt=ye($e,$);if(de.hasEagerState=!0,de.eagerState=yt,no(yt,$e)){var At=A.interleaved;At===null?(de.next=de,qi(A)):(de.next=At.next,At.next=de),A.interleaved=de;return}}catch{}finally{}$=vt(b,A,de,J),$!==null&&(de=Zn(),jn($,b,J,de),Wy($,A,J))}}function zo(b){var A=b.alternate;return b===la||A!==null&&A===la}function Pf(b,A){rl=pd=!0;var $=b.pending;$===null?A.next=A:(A.next=$.next,$.next=A),b.pending=A}function Wy(b,A,$){if(($&4194240)!==0){var J=A.lanes;J&=b.pendingLanes,$|=J,A.lanes=$,vl(b,$)}}var yg={readContext:dr,useCallback:_s,useContext:_s,useEffect:_s,useImperativeHandle:_s,useInsertionEffect:_s,useLayoutEffect:_s,useMemo:_s,useReducer:_s,useRef:_s,useState:_s,useDebugValue:_s,useDeferredValue:_s,useTransition:_s,useMutableSource:_s,useSyncExternalStore:_s,useId:_s,unstable_isNewReconciler:!1},X_={readContext:dr,useCallback:function(b,A){return Hl().memoizedState=[b,A===void 0?null:A],b},useContext:dr,useEffect:kf,useImperativeHandle:function(b,A,$){return $=$!=null?$.concat([b]):null,Tf(4194308,4,Vy.bind(null,A,b),$)},useLayoutEffect:function(b,A){return Tf(4194308,4,b,A)},useInsertionEffect:function(b,A){return Tf(4,2,b,A)},useMemo:function(b,A){var $=Hl();return A=A===void 0?null:A,b=b(),$.memoizedState=[b,A],b},useReducer:function(b,A,$){var J=Hl();return A=$!==void 0?$(A):A,J.memoizedState=J.baseState=A,b={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:b,lastRenderedState:A},J.queue=b,b=b.dispatch=Yp.bind(null,la,b),[J.memoizedState,b]},useRef:function(b){var A=Hl();return b={current:b},A.memoizedState=b},useState:hc,useDebugValue:bh,useDeferredValue:function(b){return Hl().memoizedState=b},useTransition:function(){var b=hc(!1),A=b[0];return b=bx.bind(null,b[1]),Hl().memoizedState=b,[A,b]},useMutableSource:function(){},useSyncExternalStore:function(b,A,$){var J=la,de=Hl();if(Sa){if($===void 0)throw Error(r(407));$=$()}else{if($=A(),at===null)throw Error(r(349));(Fo&30)!==0||fg(J,A,$)}de.memoizedState=$;var ye={value:$,getSnapshot:A};return de.queue=ye,kf(Af.bind(null,J,ye,b),[b]),J.flags|=2048,md(9,pg.bind(null,J,ye,$,A),void 0,null),$},useId:function(){var b=Hl(),A=at.identifierPrefix;if(Sa){var $=_o,J=uc;$=(J&~(1<<32-ys(J)-1)).toString(32)+$,A=":"+A+"R"+$,$=us++,0<$&&(A+="H"+$.toString(32)),A+=":"}else $=dg++,A=":"+A+"r"+$.toString(32)+":";return b.memoizedState=A},unstable_isNewReconciler:!1},Na={readContext:dr,useCallback:Uy,useContext:dr,useEffect:_h,useImperativeHandle:gg,useInsertionEffect:mg,useLayoutEffect:Zp,useMemo:$y,useReducer:Nf,useRef:vh,useState:function(){return Nf(xh)},useDebugValue:bh,useDeferredValue:function(b){var A=Ls();return qy(A,pa.memoizedState,b)},useTransition:function(){var b=Nf(xh)[0],A=Ls().memoizedState;return[b,A]},useMutableSource:hg,useSyncExternalStore:bs,useId:Gy,unstable_isNewReconciler:!1},xg={readContext:dr,useCallback:Uy,useContext:dr,useEffect:_h,useImperativeHandle:gg,useInsertionEffect:mg,useLayoutEffect:Zp,useMemo:$y,useReducer:Hp,useRef:vh,useState:function(){return Hp(xh)},useDebugValue:bh,useDeferredValue:function(b){var A=Ls();return pa===null?A.memoizedState=b:qy(A,pa.memoizedState,b)},useTransition:function(){var b=Hp(xh)[0],A=Ls().memoizedState;return[b,A]},useMutableSource:hg,useSyncExternalStore:bs,useId:Gy,unstable_isNewReconciler:!1};function fc(b,A){if(b&&b.defaultProps){A=Ge({},A),b=b.defaultProps;for(var $ in b)A[$]===void 0&&(A[$]=b[$]);return A}return A}function Jp(b,A,$,J){A=b.memoizedState,$=$(J,A),$=$==null?A:Ge({},A,$),b.memoizedState=$,b.lanes===0&&(b.updateQueue.baseState=$)}var gd={isMounted:function(b){return(b=b._reactInternals)?Je(b)===b:!1},enqueueSetState:function(b,A,$){b=b._reactInternals;var J=Zn(),de=Qr(b),ye=Vc(J,de);ye.payload=A,$!=null&&(ye.callback=$),A=xu(b,ye,de),A!==null&&(jn(A,b,de,J),vu(A,b,de))},enqueueReplaceState:function(b,A,$){b=b._reactInternals;var J=Zn(),de=Qr(b),ye=Vc(J,de);ye.tag=1,ye.payload=A,$!=null&&(ye.callback=$),A=xu(b,ye,de),A!==null&&(jn(A,b,de,J),vu(A,b,de))},enqueueForceUpdate:function(b,A){b=b._reactInternals;var $=Zn(),J=Qr(b),de=Vc($,J);de.tag=2,A!=null&&(de.callback=A),A=xu(b,de,J),A!==null&&(jn(A,b,J,$),vu(A,b,J))}};function Hy(b,A,$,J,de,ye,$e){return b=b.stateNode,typeof b.shouldComponentUpdate=="function"?b.shouldComponentUpdate(J,ye,$e):A.prototype&&A.prototype.isPureReactComponent?!Cp($,J)||!Cp(de,ye):!0}function Cf(b,A,$){var J=!1,de=ql,ye=A.contextType;return typeof ye=="object"&&ye!==null?ye=dr(ye):(de=Qo(A)?gu:Ws.current,J=A.contextTypes,ye=(J=J!=null)?cc(b,de):ql),A=new A($,ye),b.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=gd,b.stateNode=A,A._reactInternals=b,J&&(b=b.stateNode,b.__reactInternalMemoizedUnmaskedChildContext=de,b.__reactInternalMemoizedMaskedChildContext=ye),A}function Qp(b,A,$,J){b=A.state,typeof A.componentWillReceiveProps=="function"&&A.componentWillReceiveProps($,J),typeof A.UNSAFE_componentWillReceiveProps=="function"&&A.UNSAFE_componentWillReceiveProps($,J),A.state!==b&&gd.enqueueReplaceState(A,A.state,null)}function Kl(b,A,$,J){var de=b.stateNode;de.props=$,de.state=b.memoizedState,de.refs={},qp(b);var ye=A.contextType;typeof ye=="object"&&ye!==null?de.context=dr(ye):(ye=Qo(A)?gu:Ws.current,de.context=cc(b,ye)),de.state=b.memoizedState,ye=A.getDerivedStateFromProps,typeof ye=="function"&&(Jp(b,A,ye,$),de.state=b.memoizedState),typeof A.getDerivedStateFromProps=="function"||typeof de.getSnapshotBeforeUpdate=="function"||typeof de.UNSAFE_componentWillMount!="function"&&typeof de.componentWillMount!="function"||(A=de.state,typeof de.componentWillMount=="function"&&de.componentWillMount(),typeof de.UNSAFE_componentWillMount=="function"&&de.UNSAFE_componentWillMount(),A!==de.state&&gd.enqueueReplaceState(de,de.state,null),og(b,$,de,J),de.state=b.memoizedState),typeof de.componentDidMount=="function"&&(b.flags|=4194308)}function $c(b,A){try{var $="",J=A;do $+=nr(J),J=J.return;while(J);var de=$}catch(ye){de=`
Error generating stack: `+ye.message+`
`+ye.stack}return{value:b,source:A,stack:de,digest:null}}function ma(b,A,$){return{value:b,source:null,stack:$??null,digest:A??null}}function nl(b,A){try{console.error(A.value)}catch($){setTimeout(function(){throw $})}}var Ef=typeof WeakMap=="function"?WeakMap:Map;function Mf(b,A,$){$=Vc(-1,$),$.tag=3,$.payload={element:null};var J=A.value;return $.callback=function(){tr||(tr=!0,gr=J),nl(b,A)},$}function Ky(b,A,$){$=Vc(-1,$),$.tag=3;var J=b.type.getDerivedStateFromError;if(typeof J=="function"){var de=A.value;$.payload=function(){return J(de)},$.callback=function(){nl(b,A)}}var ye=b.stateNode;return ye!==null&&typeof ye.componentDidCatch=="function"&&($.callback=function(){nl(b,A),typeof J!="function"&&(xr===null?xr=new Set([this]):xr.add(this));var $e=A.stack;this.componentDidCatch(A.value,{componentStack:$e!==null?$e:""})}),$}function Zy(b,A,$){var J=b.pingCache;if(J===null){J=b.pingCache=new Ef;var de=new Set;J.set(A,de)}else de=J.get(A),de===void 0&&(de=new Set,J.set(A,de));de.has($)||(de.add($),b=Ah.bind(null,b,A,$),A.then(b,b))}function Of(b){do{var A;if((A=b.tag===13)&&(A=b.memoizedState,A=A!==null?A.dehydrated!==null:!0),A)return b;b=b.return}while(b!==null);return null}function vg(b,A,$,J,de){return(b.mode&1)===0?(b===A?b.flags|=65536:(b.flags|=128,$.flags|=131072,$.flags&=-52805,$.tag===1&&($.alternate===null?$.tag=17:(A=Vc(-1,1),A.tag=2,xu($,A,1))),$.lanes|=1),b):(b.flags|=65536,b.lanes=de,b)}var J_=ae.ReactCurrentOwner,wo=!1;function ao(b,A,$,J){A.child=b===null?$p(A,null,$,J):vi(A,b.child,$,J)}function yd(b,A,$,J,de){$=$.render;var ye=A.ref;return Jt(A,de),J=Wp(b,A,$,J,ye,de),$=_u(),b!==null&&!wo?(A.updateQueue=b.updateQueue,A.flags&=-2053,b.lanes&=~de,al(b,A,de)):(Sa&&$&&Vp(A),A.flags|=1,ao(b,A,J,de),A.child)}function xd(b,A,$,J,de){if(b===null){var ye=$.type;return typeof ye=="function"&&!Q_(ye)&&ye.defaultProps===void 0&&$.compare===null&&$.defaultProps===void 0?(A.tag=15,A.type=ye,qc(b,A,ye,J,de)):(b=Xy($.type,null,J,A,A.mode,de),b.ref=A.ref,b.return=A,A.child=b)}if(ye=b.child,(b.lanes&de)===0){var $e=ye.memoizedProps;if($=$.compare,$=$!==null?$:Cp,$($e,J)&&b.ref===A.ref)return al(b,A,de)}return A.flags|=1,b=jh(ye,J),b.ref=A.ref,b.return=A,A.child=b}function qc(b,A,$,J,de){if(b!==null){var ye=b.memoizedProps;if(Cp(ye,J)&&b.ref===A.ref)if(wo=!1,A.pendingProps=J=ye,(b.lanes&de)!==0)(b.flags&131072)!==0&&(wo=!0);else return A.lanes=b.lanes,al(b,A,de)}return Su(b,A,$,J,de)}function Zl(b,A,$){var J=A.pendingProps,de=J.children,ye=b!==null?b.memoizedState:null;if(J.mode==="hidden")if((A.mode&1)===0)A.memoizedState={baseLanes:0,cachePool:null,transitions:null},ra(Pt,kt),kt|=$;else{if(($&1073741824)===0)return b=ye!==null?ye.baseLanes|$:$,A.lanes=A.childLanes=1073741824,A.memoizedState={baseLanes:b,cachePool:null,transitions:null},A.updateQueue=null,ra(Pt,kt),kt|=b,null;A.memoizedState={baseLanes:0,cachePool:null,transitions:null},J=ye!==null?ye.baseLanes:$,ra(Pt,kt),kt|=J}else ye!==null?(J=ye.baseLanes|$,A.memoizedState=null):J=$,ra(Pt,kt),kt|=J;return ao(b,A,de,$),A.child}function wu(b,A){var $=A.ref;(b===null&&$!==null||b!==null&&b.ref!==$)&&(A.flags|=512,A.flags|=2097152)}function Su(b,A,$,J,de){var ye=Qo($)?gu:Ws.current;return ye=cc(A,ye),Jt(A,de),$=Wp(b,A,$,J,ye,de),J=_u(),b!==null&&!wo?(A.updateQueue=b.updateQueue,A.flags&=-2053,b.lanes&=~de,al(b,A,de)):(Sa&&J&&Vp(A),A.flags|=1,ao(b,A,$,de),A.child)}function Nu(b,A,$,J,de){if(Qo($)){var ye=!0;sh(A)}else ye=!1;if(Jt(A,de),A.stateNode===null)So(b,A),Cf(A,$,J),Kl(A,$,J,de),J=!0;else if(b===null){var $e=A.stateNode,yt=A.memoizedProps;$e.props=yt;var At=$e.context,Yt=$.contextType;typeof Yt=="object"&&Yt!==null?Yt=dr(Yt):(Yt=Qo($)?gu:Ws.current,Yt=cc(A,Yt));var Tr=$.getDerivedStateFromProps,Mr=typeof Tr=="function"||typeof $e.getSnapshotBeforeUpdate=="function";Mr||typeof $e.UNSAFE_componentWillReceiveProps!="function"&&typeof $e.componentWillReceiveProps!="function"||(yt!==J||At!==Yt)&&Qp(A,$e,J,Yt),dc=!1;var jr=A.memoizedState;$e.state=jr,og(A,J,$e,de),At=A.memoizedState,yt!==J||jr!==At||Jo.current||dc?(typeof Tr=="function"&&(Jp(A,$,Tr,J),At=A.memoizedState),(yt=dc||Hy(A,$,yt,J,jr,At,Yt))?(Mr||typeof $e.UNSAFE_componentWillMount!="function"&&typeof $e.componentWillMount!="function"||(typeof $e.componentWillMount=="function"&&$e.componentWillMount(),typeof $e.UNSAFE_componentWillMount=="function"&&$e.UNSAFE_componentWillMount()),typeof $e.componentDidMount=="function"&&(A.flags|=4194308)):(typeof $e.componentDidMount=="function"&&(A.flags|=4194308),A.memoizedProps=J,A.memoizedState=At),$e.props=J,$e.state=At,$e.context=Yt,J=yt):(typeof $e.componentDidMount=="function"&&(A.flags|=4194308),J=!1)}else{$e=A.stateNode,zy(b,A),yt=A.memoizedProps,Yt=A.type===A.elementType?yt:fc(A.type,yt),$e.props=Yt,Mr=A.pendingProps,jr=$e.context,At=$.contextType,typeof At=="object"&&At!==null?At=dr(At):(At=Qo($)?gu:Ws.current,At=cc(A,At));var tn=$.getDerivedStateFromProps;(Tr=typeof tn=="function"||typeof $e.getSnapshotBeforeUpdate=="function")||typeof $e.UNSAFE_componentWillReceiveProps!="function"&&typeof $e.componentWillReceiveProps!="function"||(yt!==Mr||jr!==At)&&Qp(A,$e,J,At),dc=!1,jr=A.memoizedState,$e.state=jr,og(A,J,$e,de);var hn=A.memoizedState;yt!==Mr||jr!==hn||Jo.current||dc?(typeof tn=="function"&&(Jp(A,$,tn,J),hn=A.memoizedState),(Yt=dc||Hy(A,$,Yt,J,jr,hn,At)||!1)?(Tr||typeof $e.UNSAFE_componentWillUpdate!="function"&&typeof $e.componentWillUpdate!="function"||(typeof $e.componentWillUpdate=="function"&&$e.componentWillUpdate(J,hn,At),typeof $e.UNSAFE_componentWillUpdate=="function"&&$e.UNSAFE_componentWillUpdate(J,hn,At)),typeof $e.componentDidUpdate=="function"&&(A.flags|=4),typeof $e.getSnapshotBeforeUpdate=="function"&&(A.flags|=1024)):(typeof $e.componentDidUpdate!="function"||yt===b.memoizedProps&&jr===b.memoizedState||(A.flags|=4),typeof $e.getSnapshotBeforeUpdate!="function"||yt===b.memoizedProps&&jr===b.memoizedState||(A.flags|=1024),A.memoizedProps=J,A.memoizedState=hn),$e.props=J,$e.state=hn,$e.context=At,J=Yt):(typeof $e.componentDidUpdate!="function"||yt===b.memoizedProps&&jr===b.memoizedState||(A.flags|=4),typeof $e.getSnapshotBeforeUpdate!="function"||yt===b.memoizedProps&&jr===b.memoizedState||(A.flags|=1024),J=!1)}return Yy(b,A,$,J,ye,de)}function Yy(b,A,$,J,de,ye){wu(b,A);var $e=(A.flags&128)!==0;if(!J&&!$e)return de&&oh(A,$,!1),al(b,A,ye);J=A.stateNode,J_.current=A;var yt=$e&&typeof $.getDerivedStateFromError!="function"?null:J.render();return A.flags|=1,b!==null&&$e?(A.child=vi(A,b.child,null,ye),A.child=vi(A,null,yt,ye)):ao(b,A,yt,ye),A.memoizedState=J.state,de&&oh(A,$,!0),A.child}function wx(b){var A=b.stateNode;A.pendingContext?Oy(b,A.pendingContext,A.pendingContext!==A.context):A.context&&Oy(b,A.context,!1),Sf(b,A.containerInfo)}function Sx(b,A,$,J,de){return Tl(),Up(de),A.flags|=256,ao(b,A,$,J),A.child}var Rf={dehydrated:null,treeContext:null,retryLane:0};function _g(b){return{baseLanes:b,cachePool:null,transitions:null}}function so(b,A,$){var J=A.pendingProps,de=hi.current,ye=!1,$e=(A.flags&128)!==0,yt;if((yt=$e)||(yt=b!==null&&b.memoizedState===null?!1:(de&2)!==0),yt?(ye=!0,A.flags&=-129):(b===null||b.memoizedState!==null)&&(de|=1),ra(hi,de&1),b===null)return bf(A),b=A.memoizedState,b!==null&&(b=b.dehydrated,b!==null)?((A.mode&1)===0?A.lanes=1:b.data==="$!"?A.lanes=8:A.lanes=1073741824,null):($e=J.children,b=J.fallback,ye?(J=A.mode,ye=A.child,$e={mode:"hidden",children:$e},(J&1)===0&&ye!==null?(ye.childLanes=0,ye.pendingProps=$e):ye=Jy($e,J,0,null),b=Ff(b,J,$,null),ye.return=A,b.return=A,ye.sibling=b,A.child=ye,A.child.memoizedState=_g($),A.memoizedState=Rf,b):vd(A,$e));if(de=b.memoizedState,de!==null&&(yt=de.dehydrated,yt!==null))return Nx(b,A,$e,J,yt,de,$);if(ye){ye=J.fallback,$e=A.mode,de=b.child,yt=de.sibling;var At={mode:"hidden",children:J.children};return($e&1)===0&&A.child!==de?(J=A.child,J.childLanes=0,J.pendingProps=At,A.deletions=null):(J=jh(de,At),J.subtreeFlags=de.subtreeFlags&14680064),yt!==null?ye=jh(yt,ye):(ye=Ff(ye,$e,$,null),ye.flags|=2),ye.return=A,J.return=A,J.sibling=ye,A.child=J,J=ye,ye=A.child,$e=b.child.memoizedState,$e=$e===null?_g($):{baseLanes:$e.baseLanes|$,cachePool:null,transitions:$e.transitions},ye.memoizedState=$e,ye.childLanes=b.childLanes&~$,A.memoizedState=Rf,J}return ye=b.child,b=ye.sibling,J=jh(ye,{mode:"visible",children:J.children}),(A.mode&1)===0&&(J.lanes=$),J.return=A,J.sibling=null,b!==null&&($=A.deletions,$===null?(A.deletions=[b],A.flags|=16):$.push(b)),A.child=J,A.memoizedState=null,J}function vd(b,A){return A=Jy({mode:"visible",children:A},b.mode,0,null),A.return=b,b.child=A}function em(b,A,$,J){return J!==null&&Up(J),vi(A,b.child,null,$),b=vd(A,A.pendingProps.children),b.flags|=2,A.memoizedState=null,b}function Nx(b,A,$,J,de,ye,$e){if($)return A.flags&256?(A.flags&=-257,J=ma(Error(r(422))),em(b,A,$e,J)):A.memoizedState!==null?(A.child=b.child,A.flags|=128,null):(ye=J.fallback,de=A.mode,J=Jy({mode:"visible",children:J.children},de,0,null),ye=Ff(ye,de,$e,null),ye.flags|=2,J.return=A,ye.return=A,J.sibling=ye,A.child=J,(A.mode&1)!==0&&vi(A,b.child,null,$e),A.child.memoizedState=_g($e),A.memoizedState=Rf,ye);if((A.mode&1)===0)return em(b,A,$e,null);if(de.data==="$!"){if(J=de.nextSibling&&de.nextSibling.dataset,J)var yt=J.dgst;return J=yt,ye=Error(r(419)),J=ma(ye,J,void 0),em(b,A,$e,J)}if(yt=($e&b.childLanes)!==0,wo||yt){if(J=at,J!==null){switch($e&-$e){case 4:de=2;break;case 16:de=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:de=32;break;case 536870912:de=268435456;break;default:de=0}de=(de&(J.suspendedLanes|$e))!==0?0:de,de!==0&&de!==ye.retryLane&&(ye.retryLane=de,Bc(b,de),jn(J,b,de,-1))}return Fn(),J=ma(Error(r(421))),em(b,A,$e,J)}return de.data==="$?"?(A.flags|=128,A.child=b.child,A=Th.bind(null,b),de._reactRetry=A,null):(b=ye.treeContext,bo=id(de.nextSibling),Sl=A,Sa=!0,Nl=null,b!==null&&(Io[mr++]=uc,Io[mr++]=_o,Io[mr++]=yu,uc=b.id,_o=b.overflow,yu=A),A=vd(A,J.children),A.flags|=4096,A)}function wh(b,A,$){b.lanes|=A;var J=b.alternate;J!==null&&(J.lanes|=A),hd(b.return,A,$)}function If(b,A,$,J,de){var ye=b.memoizedState;ye===null?b.memoizedState={isBackwards:A,rendering:null,renderingStartTime:0,last:J,tail:$,tailMode:de}:(ye.isBackwards=A,ye.rendering=null,ye.renderingStartTime=0,ye.last=J,ye.tail=$,ye.tailMode=de)}function il(b,A,$){var J=A.pendingProps,de=J.revealOrder,ye=J.tail;if(ao(b,A,J.children,$),J=hi.current,(J&2)!==0)J=J&1|2,A.flags|=128;else{if(b!==null&&(b.flags&128)!==0)e:for(b=A.child;b!==null;){if(b.tag===13)b.memoizedState!==null&&wh(b,$,A);else if(b.tag===19)wh(b,$,A);else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===A)break e;for(;b.sibling===null;){if(b.return===null||b.return===A)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}J&=1}if(ra(hi,J),(A.mode&1)===0)A.memoizedState=null;else switch(de){case"forwards":for($=A.child,de=null;$!==null;)b=$.alternate,b!==null&&cg(b)===null&&(de=$),$=$.sibling;$=de,$===null?(de=A.child,A.child=null):(de=$.sibling,$.sibling=null),If(A,!1,de,$,ye);break;case"backwards":for($=null,de=A.child,A.child=null;de!==null;){if(b=de.alternate,b!==null&&cg(b)===null){A.child=de;break}b=de.sibling,de.sibling=$,$=de,de=b}If(A,!0,$,null,ye);break;case"together":If(A,!1,null,null,void 0);break;default:A.memoizedState=null}return A.child}function So(b,A){(A.mode&1)===0&&b!==null&&(b.alternate=null,A.alternate=null,A.flags|=2)}function al(b,A,$){if(b!==null&&(A.dependencies=b.dependencies),$t|=A.lanes,($&A.childLanes)===0)return null;if(b!==null&&A.child!==b.child)throw Error(r(153));if(A.child!==null){for(b=A.child,$=jh(b,b.pendingProps),A.child=$,$.return=A;b.sibling!==null;)b=b.sibling,$=$.sibling=jh(b,b.pendingProps),$.return=A;$.sibling=null}return A.child}function Sh(b,A,$){switch(A.tag){case 3:wx(A),Tl();break;case 5:Uc(A);break;case 1:Qo(A.type)&&sh(A);break;case 4:Sf(A,A.stateNode.containerInfo);break;case 10:var J=A.type._context,de=A.memoizedProps.value;ra(ld,J._currentValue),J._currentValue=de;break;case 13:if(J=A.memoizedState,J!==null)return J.dehydrated!==null?(ra(hi,hi.current&1),A.flags|=128,null):($&A.child.childLanes)!==0?so(b,A,$):(ra(hi,hi.current&1),b=al(b,A,$),b!==null?b.sibling:null);ra(hi,hi.current&1);break;case 19:if(J=($&A.childLanes)!==0,(b.flags&128)!==0){if(J)return il(b,A,$);A.flags|=128}if(de=A.memoizedState,de!==null&&(de.rendering=null,de.tail=null,de.lastEffect=null),ra(hi,hi.current),J)break;return null;case 22:case 23:return A.lanes=0,Zl(b,A,$)}return al(b,A,$)}var _d,tm,Kn,Au;_d=function(b,A){for(var $=A.child;$!==null;){if($.tag===5||$.tag===6)b.appendChild($.stateNode);else if($.tag!==4&&$.child!==null){$.child.return=$,$=$.child;continue}if($===A)break;for(;$.sibling===null;){if($.return===null||$.return===A)return;$=$.return}$.sibling.return=$.return,$=$.sibling}},tm=function(){},Kn=function(b,A,$,J){var de=b.memoizedProps;if(de!==J){b=A.stateNode,jl(io.current);var ye=null;switch($){case"input":de=Rt(b,de),J=Rt(b,J),ye=[];break;case"select":de=Ge({},de,{value:void 0}),J=Ge({},J,{value:void 0}),ye=[];break;case"textarea":de=vr(b,de),J=vr(b,J),ye=[];break;default:typeof de.onClick!="function"&&typeof J.onClick=="function"&&(b.onclick=rh)}$s($,J);var $e;$=null;for(Yt in de)if(!J.hasOwnProperty(Yt)&&de.hasOwnProperty(Yt)&&de[Yt]!=null)if(Yt==="style"){var yt=de[Yt];for($e in yt)yt.hasOwnProperty($e)&&($||($={}),$[$e]="")}else Yt!=="dangerouslySetInnerHTML"&&Yt!=="children"&&Yt!=="suppressContentEditableWarning"&&Yt!=="suppressHydrationWarning"&&Yt!=="autoFocus"&&(a.hasOwnProperty(Yt)?ye||(ye=[]):(ye=ye||[]).push(Yt,null));for(Yt in J){var At=J[Yt];if(yt=de!=null?de[Yt]:void 0,J.hasOwnProperty(Yt)&&At!==yt&&(At!=null||yt!=null))if(Yt==="style")if(yt){for($e in yt)!yt.hasOwnProperty($e)||At&&At.hasOwnProperty($e)||($||($={}),$[$e]="");for($e in At)At.hasOwnProperty($e)&&yt[$e]!==At[$e]&&($||($={}),$[$e]=At[$e])}else $||(ye||(ye=[]),ye.push(Yt,$)),$=At;else Yt==="dangerouslySetInnerHTML"?(At=At?At.__html:void 0,yt=yt?yt.__html:void 0,At!=null&&yt!==At&&(ye=ye||[]).push(Yt,At)):Yt==="children"?typeof At!="string"&&typeof At!="number"||(ye=ye||[]).push(Yt,""+At):Yt!=="suppressContentEditableWarning"&&Yt!=="suppressHydrationWarning"&&(a.hasOwnProperty(Yt)?(At!=null&&Yt==="onScroll"&&fa("scroll",b),ye||yt===At||(ye=[])):(ye=ye||[]).push(Yt,At))}$&&(ye=ye||[]).push("style",$);var Yt=ye;(A.updateQueue=Yt)&&(A.flags|=4)}},Au=function(b,A,$,J){$!==J&&(A.flags|=4)};function rm(b,A){if(!Sa)switch(b.tailMode){case"hidden":A=b.tail;for(var $=null;A!==null;)A.alternate!==null&&($=A),A=A.sibling;$===null?b.tail=null:$.sibling=null;break;case"collapsed":$=b.tail;for(var J=null;$!==null;)$.alternate!==null&&(J=$),$=$.sibling;J===null?A||b.tail===null?b.tail=null:b.tail.sibling=null:J.sibling=null}}function No(b){var A=b.alternate!==null&&b.alternate.child===b.child,$=0,J=0;if(A)for(var de=b.child;de!==null;)$|=de.lanes|de.childLanes,J|=de.subtreeFlags&14680064,J|=de.flags&14680064,de.return=b,de=de.sibling;else for(de=b.child;de!==null;)$|=de.lanes|de.childLanes,J|=de.subtreeFlags,J|=de.flags,de.return=b,de=de.sibling;return b.subtreeFlags|=J,b.childLanes=$,A}function bg(b,A,$){var J=A.pendingProps;switch(Ly(A),A.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return No(A),null;case 1:return Qo(A.type)&&ng(),No(A),null;case 3:return J=A.stateNode,Do(),wa(Jo),wa(Ws),Pi(),J.pendingContext&&(J.context=J.pendingContext,J.pendingContext=null),(b===null||b.child===null)&&(Al(A)?A.flags|=4:b===null||b.memoizedState.isDehydrated&&(A.flags&256)===0||(A.flags|=1024,Nl!==null&&(ai(Nl),Nl=null))),tm(b,A),No(A),null;case 5:lg(A);var de=jl(gh.current);if($=A.type,b!==null&&A.stateNode!=null)Kn(b,A,$,J,de),b.ref!==A.ref&&(A.flags|=512,A.flags|=2097152);else{if(!J){if(A.stateNode===null)throw Error(r(166));return No(A),null}if(b=jl(io.current),Al(A)){J=A.stateNode,$=A.type;var ye=A.memoizedProps;switch(J[Vl]=A,J[ih]=ye,b=(A.mode&1)!==0,$){case"dialog":fa("cancel",J),fa("close",J);break;case"iframe":case"object":case"embed":fa("load",J);break;case"video":case"audio":for(de=0;de<Rp.length;de++)fa(Rp[de],J);break;case"source":fa("error",J);break;case"img":case"image":case"link":fa("error",J),fa("load",J);break;case"details":fa("toggle",J);break;case"input":En(J,ye),fa("invalid",J);break;case"select":J._wrapperState={wasMultiple:!!ye.multiple},fa("invalid",J);break;case"textarea":Sr(J,ye),fa("invalid",J)}$s($,ye),de=null;for(var $e in ye)if(ye.hasOwnProperty($e)){var yt=ye[$e];$e==="children"?typeof yt=="string"?J.textContent!==yt&&(ye.suppressHydrationWarning!==!0&&yf(J.textContent,yt,b),de=["children",yt]):typeof yt=="number"&&J.textContent!==""+yt&&(ye.suppressHydrationWarning!==!0&&yf(J.textContent,yt,b),de=["children",""+yt]):a.hasOwnProperty($e)&&yt!=null&&$e==="onScroll"&&fa("scroll",J)}switch($){case"input":Pr(J),dt(J,ye,!0);break;case"textarea":Pr(J),Mn(J);break;case"select":case"option":break;default:typeof ye.onClick=="function"&&(J.onclick=rh)}J=de,A.updateQueue=J,J!==null&&(A.flags|=4)}else{$e=de.nodeType===9?de:de.ownerDocument,b==="http://www.w3.org/1999/xhtml"&&(b=Ai($)),b==="http://www.w3.org/1999/xhtml"?$==="script"?(b=$e.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild)):typeof J.is=="string"?b=$e.createElement($,{is:J.is}):(b=$e.createElement($),$==="select"&&($e=b,J.multiple?$e.multiple=!0:J.size&&($e.size=J.size))):b=$e.createElementNS(b,$),b[Vl]=A,b[ih]=J,_d(b,A,!1,!1),A.stateNode=b;e:{switch($e=sc($,J),$){case"dialog":fa("cancel",b),fa("close",b),de=J;break;case"iframe":case"object":case"embed":fa("load",b),de=J;break;case"video":case"audio":for(de=0;de<Rp.length;de++)fa(Rp[de],b);de=J;break;case"source":fa("error",b),de=J;break;case"img":case"image":case"link":fa("error",b),fa("load",b),de=J;break;case"details":fa("toggle",b),de=J;break;case"input":En(b,J),de=Rt(b,J),fa("invalid",b);break;case"option":de=J;break;case"select":b._wrapperState={wasMultiple:!!J.multiple},de=Ge({},J,{value:void 0}),fa("invalid",b);break;case"textarea":Sr(b,J),de=vr(b,J),fa("invalid",b);break;default:de=J}$s($,de),yt=de;for(ye in yt)if(yt.hasOwnProperty(ye)){var At=yt[ye];ye==="style"?ac(b,At):ye==="dangerouslySetInnerHTML"?(At=At?At.__html:void 0,At!=null&&xo(b,At)):ye==="children"?typeof At=="string"?($!=="textarea"||At!=="")&&Wa(b,At):typeof At=="number"&&Wa(b,""+At):ye!=="suppressContentEditableWarning"&&ye!=="suppressHydrationWarning"&&ye!=="autoFocus"&&(a.hasOwnProperty(ye)?At!=null&&ye==="onScroll"&&fa("scroll",b):At!=null&&Q(b,ye,At,$e))}switch($){case"input":Pr(b),dt(b,J,!1);break;case"textarea":Pr(b),Mn(b);break;case"option":J.value!=null&&b.setAttribute("value",""+or(J.value));break;case"select":b.multiple=!!J.multiple,ye=J.value,ye!=null?Cr(b,!!J.multiple,ye,!1):J.defaultValue!=null&&Cr(b,!!J.multiple,J.defaultValue,!0);break;default:typeof de.onClick=="function"&&(b.onclick=rh)}switch($){case"button":case"input":case"select":case"textarea":J=!!J.autoFocus;break e;case"img":J=!0;break e;default:J=!1}}J&&(A.flags|=4)}A.ref!==null&&(A.flags|=512,A.flags|=2097152)}return No(A),null;case 6:if(b&&A.stateNode!=null)Au(b,A,b.memoizedProps,J);else{if(typeof J!="string"&&A.stateNode===null)throw Error(r(166));if($=jl(gh.current),jl(io.current),Al(A)){if(J=A.stateNode,$=A.memoizedProps,J[Vl]=A,(ye=J.nodeValue!==$)&&(b=Sl,b!==null))switch(b.tag){case 3:yf(J.nodeValue,$,(b.mode&1)!==0);break;case 5:b.memoizedProps.suppressHydrationWarning!==!0&&yf(J.nodeValue,$,(b.mode&1)!==0)}ye&&(A.flags|=4)}else J=($.nodeType===9?$:$.ownerDocument).createTextNode(J),J[Vl]=A,A.stateNode=J}return No(A),null;case 13:if(wa(hi),J=A.memoizedState,b===null||b.memoizedState!==null&&b.memoizedState.dehydrated!==null){if(Sa&&bo!==null&&(A.mode&1)!==0&&(A.flags&128)===0)Lo(),Tl(),A.flags|=98560,ye=!1;else if(ye=Al(A),J!==null&&J.dehydrated!==null){if(b===null){if(!ye)throw Error(r(318));if(ye=A.memoizedState,ye=ye!==null?ye.dehydrated:null,!ye)throw Error(r(317));ye[Vl]=A}else Tl(),(A.flags&128)===0&&(A.memoizedState=null),A.flags|=4;No(A),ye=!1}else Nl!==null&&(ai(Nl),Nl=null),ye=!0;if(!ye)return A.flags&65536?A:null}return(A.flags&128)!==0?(A.lanes=$,A):(J=J!==null,J!==(b!==null&&b.memoizedState!==null)&&J&&(A.child.flags|=8192,(A.mode&1)!==0&&(b===null||(hi.current&1)!==0?ht===0&&(ht=3):Fn())),A.updateQueue!==null&&(A.flags|=4),No(A),null);case 4:return Do(),tm(b,A),b===null&&gf(A.stateNode.containerInfo),No(A),null;case 10:return dd(A.type._context),No(A),null;case 17:return Qo(A.type)&&ng(),No(A),null;case 19:if(wa(hi),ye=A.memoizedState,ye===null)return No(A),null;if(J=(A.flags&128)!==0,$e=ye.rendering,$e===null)if(J)rm(ye,!1);else{if(ht!==0||b!==null&&(b.flags&128)!==0)for(b=A.child;b!==null;){if($e=cg(b),$e!==null){for(A.flags|=128,rm(ye,!1),J=$e.updateQueue,J!==null&&(A.updateQueue=J,A.flags|=4),A.subtreeFlags=0,J=$,$=A.child;$!==null;)ye=$,b=J,ye.flags&=14680066,$e=ye.alternate,$e===null?(ye.childLanes=0,ye.lanes=b,ye.child=null,ye.subtreeFlags=0,ye.memoizedProps=null,ye.memoizedState=null,ye.updateQueue=null,ye.dependencies=null,ye.stateNode=null):(ye.childLanes=$e.childLanes,ye.lanes=$e.lanes,ye.child=$e.child,ye.subtreeFlags=0,ye.deletions=null,ye.memoizedProps=$e.memoizedProps,ye.memoizedState=$e.memoizedState,ye.updateQueue=$e.updateQueue,ye.type=$e.type,b=$e.dependencies,ye.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext}),$=$.sibling;return ra(hi,hi.current&1|2),A.child}b=b.sibling}ye.tail!==null&&Nr()>It&&(A.flags|=128,J=!0,rm(ye,!1),A.lanes=4194304)}else{if(!J)if(b=cg($e),b!==null){if(A.flags|=128,J=!0,$=b.updateQueue,$!==null&&(A.updateQueue=$,A.flags|=4),rm(ye,!0),ye.tail===null&&ye.tailMode==="hidden"&&!$e.alternate&&!Sa)return No(A),null}else 2*Nr()-ye.renderingStartTime>It&&$!==1073741824&&(A.flags|=128,J=!0,rm(ye,!1),A.lanes=4194304);ye.isBackwards?($e.sibling=A.child,A.child=$e):($=ye.last,$!==null?$.sibling=$e:A.child=$e,ye.last=$e)}return ye.tail!==null?(A=ye.tail,ye.rendering=A,ye.tail=A.sibling,ye.renderingStartTime=Nr(),A.sibling=null,$=hi.current,ra(hi,J?$&1|2:$&1),A):(No(A),null);case 22:case 23:return Fs(),J=A.memoizedState!==null,b!==null&&b.memoizedState!==null!==J&&(A.flags|=8192),J&&(A.mode&1)!==0?(kt&1073741824)!==0&&(No(A),A.subtreeFlags&6&&(A.flags|=8192)):No(A),null;case 24:return null;case 25:return null}throw Error(r(156,A.tag))}function Gc(b,A){switch(Ly(A),A.tag){case 1:return Qo(A.type)&&ng(),b=A.flags,b&65536?(A.flags=b&-65537|128,A):null;case 3:return Do(),wa(Jo),wa(Ws),Pi(),b=A.flags,(b&65536)!==0&&(b&128)===0?(A.flags=b&-65537|128,A):null;case 5:return lg(A),null;case 13:if(wa(hi),b=A.memoizedState,b!==null&&b.dehydrated!==null){if(A.alternate===null)throw Error(r(340));Tl()}return b=A.flags,b&65536?(A.flags=b&-65537|128,A):null;case 19:return wa(hi),null;case 4:return Do(),null;case 10:return dd(A.type._context),null;case 22:case 23:return Fs(),null;case 24:return null;default:return null}}var sl=!1,Gi=!1,ol=typeof WeakSet=="function"?WeakSet:Set,Br=null;function Nh(b,A){var $=b.ref;if($!==null)if(typeof $=="function")try{$(null)}catch(J){Mi(b,A,J)}else $.current=null}function oo(b,A,$){try{$()}catch(J){Mi(b,A,J)}}var wg=!1;function Lf(b,A){if(Fp=Za,b=Cy(),Xo(b)){if("selectionStart"in b)var $={start:b.selectionStart,end:b.selectionEnd};else e:{$=($=b.ownerDocument)&&$.defaultView||window;var J=$.getSelection&&$.getSelection();if(J&&J.rangeCount!==0){$=J.anchorNode;var de=J.anchorOffset,ye=J.focusNode;J=J.focusOffset;try{$.nodeType,ye.nodeType}catch{$=null;break e}var $e=0,yt=-1,At=-1,Yt=0,Tr=0,Mr=b,jr=null;t:for(;;){for(var tn;Mr!==$||de!==0&&Mr.nodeType!==3||(yt=$e+de),Mr!==ye||J!==0&&Mr.nodeType!==3||(At=$e+J),Mr.nodeType===3&&($e+=Mr.nodeValue.length),(tn=Mr.firstChild)!==null;)jr=Mr,Mr=tn;for(;;){if(Mr===b)break t;if(jr===$&&++Yt===de&&(yt=$e),jr===ye&&++Tr===J&&(At=$e),(tn=Mr.nextSibling)!==null)break;Mr=jr,jr=Mr.parentNode}Mr=tn}$=yt===-1||At===-1?null:{start:yt,end:At}}else $=null}$=$||{start:0,end:0}}else $=null;for(zp={focusedElem:b,selectionRange:$},Za=!1,Br=A;Br!==null;)if(A=Br,b=A.child,(A.subtreeFlags&1028)!==0&&b!==null)b.return=A,Br=b;else for(;Br!==null;){A=Br;try{var hn=A.alternate;if((A.flags&1024)!==0)switch(A.tag){case 0:case 11:case 15:break;case 1:if(hn!==null){var gn=hn.memoizedProps,Ss=hn.memoizedState,Ut=A.stateNode,Ct=Ut.getSnapshotBeforeUpdate(A.elementType===A.type?gn:fc(A.type,gn),Ss);Ut.__reactInternalSnapshotBeforeUpdate=Ct}break;case 3:var Wt=A.stateNode.containerInfo;Wt.nodeType===1?Wt.textContent="":Wt.nodeType===9&&Wt.documentElement&&Wt.removeChild(Wt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ir){Mi(A,A.return,Ir)}if(b=A.sibling,b!==null){b.return=A.return,Br=b;break}Br=A.return}return hn=wg,wg=!1,hn}function g(b,A,$){var J=A.updateQueue;if(J=J!==null?J.lastEffect:null,J!==null){var de=J=J.next;do{if((de.tag&b)===b){var ye=de.destroy;de.destroy=void 0,ye!==void 0&&oo(A,$,ye)}de=de.next}while(de!==J)}}function l(b,A){if(A=A.updateQueue,A=A!==null?A.lastEffect:null,A!==null){var $=A=A.next;do{if(($.tag&b)===b){var J=$.create;$.destroy=J()}$=$.next}while($!==A)}}function d(b){var A=b.ref;if(A!==null){var $=b.stateNode;switch(b.tag){case 5:b=$;break;default:b=$}typeof A=="function"?A(b):A.current=b}}function y(b){var A=b.alternate;A!==null&&(b.alternate=null,y(A)),b.child=null,b.deletions=null,b.sibling=null,b.tag===5&&(A=b.stateNode,A!==null&&(delete A[Vl],delete A[ih],delete A[ad],delete A[My],delete A[vx])),b.stateNode=null,b.return=null,b.dependencies=null,b.memoizedProps=null,b.memoizedState=null,b.pendingProps=null,b.stateNode=null,b.updateQueue=null}function N(b){return b.tag===5||b.tag===3||b.tag===4}function j(b){e:for(;;){for(;b.sibling===null;){if(b.return===null||N(b.return))return null;b=b.return}for(b.sibling.return=b.return,b=b.sibling;b.tag!==5&&b.tag!==6&&b.tag!==18;){if(b.flags&2||b.child===null||b.tag===4)continue e;b.child.return=b,b=b.child}if(!(b.flags&2))return b.stateNode}}function C(b,A,$){var J=b.tag;if(J===5||J===6)b=b.stateNode,A?$.nodeType===8?$.parentNode.insertBefore(b,A):$.insertBefore(b,A):($.nodeType===8?(A=$.parentNode,A.insertBefore(b,$)):(A=$,A.appendChild(b)),$=$._reactRootContainer,$!=null||A.onclick!==null||(A.onclick=rh));else if(J!==4&&(b=b.child,b!==null))for(C(b,A,$),b=b.sibling;b!==null;)C(b,A,$),b=b.sibling}function F(b,A,$){var J=b.tag;if(J===5||J===6)b=b.stateNode,A?$.insertBefore(b,A):$.appendChild(b);else if(J!==4&&(b=b.child,b!==null))for(F(b,A,$),b=b.sibling;b!==null;)F(b,A,$),b=b.sibling}var W=null,Z=!1;function Y(b,A,$){for($=$.child;$!==null;)re(b,A,$),$=$.sibling}function re(b,A,$){if(Rn&&typeof Rn.onCommitFiberUnmount=="function")try{Rn.onCommitFiberUnmount($n,$)}catch{}switch($.tag){case 5:Gi||Nh($,A);case 6:var J=W,de=Z;W=null,Y(b,A,$),W=J,Z=de,W!==null&&(Z?(b=W,$=$.stateNode,b.nodeType===8?b.parentNode.removeChild($):b.removeChild($)):W.removeChild($.stateNode));break;case 18:W!==null&&(Z?(b=W,$=$.stateNode,b.nodeType===8?Ey(b.parentNode,$):b.nodeType===1&&Ey(b,$),Yo(b)):Ey(W,$.stateNode));break;case 4:J=W,de=Z,W=$.stateNode.containerInfo,Z=!0,Y(b,A,$),W=J,Z=de;break;case 0:case 11:case 14:case 15:if(!Gi&&(J=$.updateQueue,J!==null&&(J=J.lastEffect,J!==null))){de=J=J.next;do{var ye=de,$e=ye.destroy;ye=ye.tag,$e!==void 0&&((ye&2)!==0||(ye&4)!==0)&&oo($,A,$e),de=de.next}while(de!==J)}Y(b,A,$);break;case 1:if(!Gi&&(Nh($,A),J=$.stateNode,typeof J.componentWillUnmount=="function"))try{J.props=$.memoizedProps,J.state=$.memoizedState,J.componentWillUnmount()}catch(yt){Mi($,A,yt)}Y(b,A,$);break;case 21:Y(b,A,$);break;case 22:$.mode&1?(Gi=(J=Gi)||$.memoizedState!==null,Y(b,A,$),Gi=J):Y(b,A,$);break;default:Y(b,A,$)}}function ne(b){var A=b.updateQueue;if(A!==null){b.updateQueue=null;var $=b.stateNode;$===null&&($=b.stateNode=new ol),A.forEach(function(J){var de=Df.bind(null,b,J);$.has(J)||($.add(J),J.then(de,de))})}}function oe(b,A){var $=A.deletions;if($!==null)for(var J=0;J<$.length;J++){var de=$[J];try{var ye=b,$e=A,yt=$e;e:for(;yt!==null;){switch(yt.tag){case 5:W=yt.stateNode,Z=!1;break e;case 3:W=yt.stateNode.containerInfo,Z=!0;break e;case 4:W=yt.stateNode.containerInfo,Z=!0;break e}yt=yt.return}if(W===null)throw Error(r(160));re(ye,$e,de),W=null,Z=!1;var At=de.alternate;At!==null&&(At.return=null),de.return=null}catch(Yt){Mi(de,A,Yt)}}if(A.subtreeFlags&12854)for(A=A.child;A!==null;)_e(A,b),A=A.sibling}function _e(b,A){var $=b.alternate,J=b.flags;switch(b.tag){case 0:case 11:case 14:case 15:if(oe(A,b),ge(b),J&4){try{g(3,b,b.return),l(3,b)}catch(gn){Mi(b,b.return,gn)}try{g(5,b,b.return)}catch(gn){Mi(b,b.return,gn)}}break;case 1:oe(A,b),ge(b),J&512&&$!==null&&Nh($,$.return);break;case 5:if(oe(A,b),ge(b),J&512&&$!==null&&Nh($,$.return),b.flags&32){var de=b.stateNode;try{Wa(de,"")}catch(gn){Mi(b,b.return,gn)}}if(J&4&&(de=b.stateNode,de!=null)){var ye=b.memoizedProps,$e=$!==null?$.memoizedProps:ye,yt=b.type,At=b.updateQueue;if(b.updateQueue=null,At!==null)try{yt==="input"&&ye.type==="radio"&&ye.name!=null&&Vn(de,ye),sc(yt,$e);var Yt=sc(yt,ye);for($e=0;$e<At.length;$e+=2){var Tr=At[$e],Mr=At[$e+1];Tr==="style"?ac(de,Mr):Tr==="dangerouslySetInnerHTML"?xo(de,Mr):Tr==="children"?Wa(de,Mr):Q(de,Tr,Mr,Yt)}switch(yt){case"input":pi(de,ye);break;case"textarea":pr(de,ye);break;case"select":var jr=de._wrapperState.wasMultiple;de._wrapperState.wasMultiple=!!ye.multiple;var tn=ye.value;tn!=null?Cr(de,!!ye.multiple,tn,!1):jr!==!!ye.multiple&&(ye.defaultValue!=null?Cr(de,!!ye.multiple,ye.defaultValue,!0):Cr(de,!!ye.multiple,ye.multiple?[]:"",!1))}de[ih]=ye}catch(gn){Mi(b,b.return,gn)}}break;case 6:if(oe(A,b),ge(b),J&4){if(b.stateNode===null)throw Error(r(162));de=b.stateNode,ye=b.memoizedProps;try{de.nodeValue=ye}catch(gn){Mi(b,b.return,gn)}}break;case 3:if(oe(A,b),ge(b),J&4&&$!==null&&$.memoizedState.isDehydrated)try{Yo(A.containerInfo)}catch(gn){Mi(b,b.return,gn)}break;case 4:oe(A,b),ge(b);break;case 13:oe(A,b),ge(b),de=b.child,de.flags&8192&&(ye=de.memoizedState!==null,de.stateNode.isHidden=ye,!ye||de.alternate!==null&&de.alternate.memoizedState!==null||(Vt=Nr())),J&4&&ne(b);break;case 22:if(Tr=$!==null&&$.memoizedState!==null,b.mode&1?(Gi=(Yt=Gi)||Tr,oe(A,b),Gi=Yt):oe(A,b),ge(b),J&8192){if(Yt=b.memoizedState!==null,(b.stateNode.isHidden=Yt)&&!Tr&&(b.mode&1)!==0)for(Br=b,Tr=b.child;Tr!==null;){for(Mr=Br=Tr;Br!==null;){switch(jr=Br,tn=jr.child,jr.tag){case 0:case 11:case 14:case 15:g(4,jr,jr.return);break;case 1:Nh(jr,jr.return);var hn=jr.stateNode;if(typeof hn.componentWillUnmount=="function"){J=jr,$=jr.return;try{A=J,hn.props=A.memoizedProps,hn.state=A.memoizedState,hn.componentWillUnmount()}catch(gn){Mi(J,$,gn)}}break;case 5:Nh(jr,jr.return);break;case 22:if(jr.memoizedState!==null){qe(Mr);continue}}tn!==null?(tn.return=jr,Br=tn):qe(Mr)}Tr=Tr.sibling}e:for(Tr=null,Mr=b;;){if(Mr.tag===5){if(Tr===null){Tr=Mr;try{de=Mr.stateNode,Yt?(ye=de.style,typeof ye.setProperty=="function"?ye.setProperty("display","none","important"):ye.display="none"):(yt=Mr.stateNode,At=Mr.memoizedProps.style,$e=At!=null&&At.hasOwnProperty("display")?At.display:null,yt.style.display=ss("display",$e))}catch(gn){Mi(b,b.return,gn)}}}else if(Mr.tag===6){if(Tr===null)try{Mr.stateNode.nodeValue=Yt?"":Mr.memoizedProps}catch(gn){Mi(b,b.return,gn)}}else if((Mr.tag!==22&&Mr.tag!==23||Mr.memoizedState===null||Mr===b)&&Mr.child!==null){Mr.child.return=Mr,Mr=Mr.child;continue}if(Mr===b)break e;for(;Mr.sibling===null;){if(Mr.return===null||Mr.return===b)break e;Tr===Mr&&(Tr=null),Mr=Mr.return}Tr===Mr&&(Tr=null),Mr.sibling.return=Mr.return,Mr=Mr.sibling}}break;case 19:oe(A,b),ge(b),J&4&&ne(b);break;case 21:break;default:oe(A,b),ge(b)}}function ge(b){var A=b.flags;if(A&2){try{e:{for(var $=b.return;$!==null;){if(N($)){var J=$;break e}$=$.return}throw Error(r(160))}switch(J.tag){case 5:var de=J.stateNode;J.flags&32&&(Wa(de,""),J.flags&=-33);var ye=j(b);F(b,ye,de);break;case 3:case 4:var $e=J.stateNode.containerInfo,yt=j(b);C(b,yt,$e);break;default:throw Error(r(161))}}catch(At){Mi(b,b.return,At)}b.flags&=-3}A&4096&&(b.flags&=-4097)}function Te(b,A,$){Br=b,Ae(b)}function Ae(b,A,$){for(var J=(b.mode&1)!==0;Br!==null;){var de=Br,ye=de.child;if(de.tag===22&&J){var $e=de.memoizedState!==null||sl;if(!$e){var yt=de.alternate,At=yt!==null&&yt.memoizedState!==null||Gi;yt=sl;var Yt=Gi;if(sl=$e,(Gi=At)&&!Yt)for(Br=de;Br!==null;)$e=Br,At=$e.child,$e.tag===22&&$e.memoizedState!==null?Ue(de):At!==null?(At.return=$e,Br=At):Ue(de);for(;ye!==null;)Br=ye,Ae(ye),ye=ye.sibling;Br=de,sl=yt,Gi=Yt}Re(b)}else(de.subtreeFlags&8772)!==0&&ye!==null?(ye.return=de,Br=ye):Re(b)}}function Re(b){for(;Br!==null;){var A=Br;if((A.flags&8772)!==0){var $=A.alternate;try{if((A.flags&8772)!==0)switch(A.tag){case 0:case 11:case 15:Gi||l(5,A);break;case 1:var J=A.stateNode;if(A.flags&4&&!Gi)if($===null)J.componentDidMount();else{var de=A.elementType===A.type?$.memoizedProps:fc(A.type,$.memoizedProps);J.componentDidUpdate(de,$.memoizedState,J.__reactInternalSnapshotBeforeUpdate)}var ye=A.updateQueue;ye!==null&&By(A,ye,J);break;case 3:var $e=A.updateQueue;if($e!==null){if($=null,A.child!==null)switch(A.child.tag){case 5:$=A.child.stateNode;break;case 1:$=A.child.stateNode}By(A,$e,$)}break;case 5:var yt=A.stateNode;if($===null&&A.flags&4){$=yt;var At=A.memoizedProps;switch(A.type){case"button":case"input":case"select":case"textarea":At.autoFocus&&$.focus();break;case"img":At.src&&($.src=At.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(A.memoizedState===null){var Yt=A.alternate;if(Yt!==null){var Tr=Yt.memoizedState;if(Tr!==null){var Mr=Tr.dehydrated;Mr!==null&&Yo(Mr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Gi||A.flags&512&&d(A)}catch(jr){Mi(A,A.return,jr)}}if(A===b){Br=null;break}if($=A.sibling,$!==null){$.return=A.return,Br=$;break}Br=A.return}}function qe(b){for(;Br!==null;){var A=Br;if(A===b){Br=null;break}var $=A.sibling;if($!==null){$.return=A.return,Br=$;break}Br=A.return}}function Ue(b){for(;Br!==null;){var A=Br;try{switch(A.tag){case 0:case 11:case 15:var $=A.return;try{l(4,A)}catch(At){Mi(A,$,At)}break;case 1:var J=A.stateNode;if(typeof J.componentDidMount=="function"){var de=A.return;try{J.componentDidMount()}catch(At){Mi(A,de,At)}}var ye=A.return;try{d(A)}catch(At){Mi(A,ye,At)}break;case 5:var $e=A.return;try{d(A)}catch(At){Mi(A,$e,At)}}}catch(At){Mi(A,A.return,At)}if(A===b){Br=null;break}var yt=A.sibling;if(yt!==null){yt.return=A.return,Br=yt;break}Br=A.return}}var Qe=Math.ceil,Ke=ae.ReactCurrentDispatcher,Ze=ae.ReactCurrentOwner,He=ae.ReactCurrentBatchConfig,Xe=0,at=null,_t=null,mt=0,kt=0,Pt=$l(0),ht=0,Tt=null,$t=0,pt=0,Lt=0,jt=null,Xt=null,Vt=0,It=1/0,Ht=null,tr=!1,gr=null,xr=null,qr=!1,Or=null,Lr=0,Zr=0,Ln=null,ui=-1,Wi=0;function Zn(){return(Xe&6)!==0?Nr():ui!==-1?ui:ui=Nr()}function Qr(b){return(b.mode&1)===0?1:(Xe&2)!==0&&mt!==0?mt&-mt:Fy.transition!==null?(Wi===0&&(Wi=to()),Wi):(b=xi,b!==0||(b=window.event,b=b===void 0?16:wp(b.type)),b)}function jn(b,A,$,J){if(50<Zr)throw Zr=0,Ln=null,Error(r(185));xl(b,$,J),((Xe&2)===0||b!==at)&&(b===at&&((Xe&2)===0&&(pt|=$),ht===4&&ca(b,mt)),wr(b,J),$===1&&Xe===0&&(A.mode&1)===0&&(It=Nr()+500,lh&&Gl()))}function wr(b,A){var $=b.callbackNode;vy(b,A);var J=sf(b,b===at?mt:0);if(J===0)$!==null&&Bt($),b.callbackNode=null,b.callbackPriority=0;else if(A=J&-J,b.callbackPriority!==A){if($!=null&&Bt($),A===1)b.tag===0?Bp(La.bind(null,b)):Iy(La.bind(null,b)),Z_(function(){(Xe&6)===0&&Gl()}),$=null;else{switch(bp(J)){case 1:$=Ur;break;case 4:$=Vr;break;case 16:$=On;break;case 536870912:$=Tn;break;default:$=On}$=Sg($,In.bind(null,b))}b.callbackPriority=A,b.callbackNode=$}}function In(b,A){if(ui=-1,Wi=0,(Xe&6)!==0)throw Error(r(327));var $=b.callbackNode;if(Vo()&&b.callbackNode!==$)return null;var J=sf(b,b===at?mt:0);if(J===0)return null;if((J&30)!==0||(J&b.expiredLanes)!==0||A)A=ua(b,J);else{A=J;var de=Xe;Xe|=2;var ye=_i();(at!==b||mt!==A)&&(Ht=null,It=Nr()+500,Ci(b,A));do try{ji();break}catch(yt){Ti(b,yt)}while(!0);ud(),Ke.current=ye,Xe=de,_t!==null?A=0:(at=null,mt=0,A=ht)}if(A!==0){if(A===2&&(de=_p(b),de!==0&&(J=de,A=Qn(b,de))),A===1)throw $=Tt,Ci(b,0),ca(b,J),wr(b,Nr()),$;if(A===6)ca(b,J);else{if(de=b.current.alternate,(J&30)===0&&!na(de)&&(A=ua(b,J),A===2&&(ye=_p(b),ye!==0&&(J=ye,A=Qn(b,ye))),A===1))throw $=Tt,Ci(b,0),ca(b,J),wr(b,Nr()),$;switch(b.finishedWork=de,b.finishedLanes=J,A){case 0:case 1:throw Error(r(345));case 2:ws(b,Xt,Ht);break;case 3:if(ca(b,J),(J&130023424)===J&&(A=Vt+500-Nr(),10<A)){if(sf(b,0)!==0)break;if(de=b.suspendedLanes,(de&J)!==J){Zn(),b.pingedLanes|=b.suspendedLanes&de;break}b.timeoutHandle=rg(ws.bind(null,b,Xt,Ht),A);break}ws(b,Xt,Ht);break;case 4:if(ca(b,J),(J&4194240)===J)break;for(A=b.eventTimes,de=-1;0<J;){var $e=31-ys(J);ye=1<<$e,$e=A[$e],$e>de&&(de=$e),J&=~ye}if(J=de,J=Nr()-J,J=(120>J?120:480>J?480:1080>J?1080:1920>J?1920:3e3>J?3e3:4320>J?4320:1960*Qe(J/1960))-J,10<J){b.timeoutHandle=rg(ws.bind(null,b,Xt,Ht),J);break}ws(b,Xt,Ht);break;case 5:ws(b,Xt,Ht);break;default:throw Error(r(329))}}}return wr(b,Nr()),b.callbackNode===$?In.bind(null,b):null}function Qn(b,A){var $=jt;return b.current.memoizedState.isDehydrated&&(Ci(b,A).flags|=256),b=ua(b,A),b!==2&&(A=Xt,Xt=$,A!==null&&ai(A)),b}function ai(b){Xt===null?Xt=b:Xt.push.apply(Xt,b)}function na(b){for(var A=b;;){if(A.flags&16384){var $=A.updateQueue;if($!==null&&($=$.stores,$!==null))for(var J=0;J<$.length;J++){var de=$[J],ye=de.getSnapshot;de=de.value;try{if(!no(ye(),de))return!1}catch{return!1}}}if($=A.child,A.subtreeFlags&16384&&$!==null)$.return=A,A=$;else{if(A===b)break;for(;A.sibling===null;){if(A.return===null||A.return===b)return!0;A=A.return}A.sibling.return=A.return,A=A.sibling}}return!0}function ca(b,A){for(A&=~Lt,A&=~pt,b.suspendedLanes|=A,b.pingedLanes&=~A,b=b.expirationTimes;0<A;){var $=31-ys(A),J=1<<$;b[$]=-1,A&=~J}}function La(b){if((Xe&6)!==0)throw Error(r(327));Vo();var A=sf(b,0);if((A&1)===0)return wr(b,Nr()),null;var $=ua(b,A);if(b.tag!==0&&$===2){var J=_p(b);J!==0&&(A=J,$=Qn(b,J))}if($===1)throw $=Tt,Ci(b,0),ca(b,A),wr(b,Nr()),$;if($===6)throw Error(r(345));return b.finishedWork=b.current.alternate,b.finishedLanes=A,ws(b,Xt,Ht),wr(b,Nr()),null}function ka(b,A){var $=Xe;Xe|=1;try{return b(A)}finally{Xe=$,Xe===0&&(It=Nr()+500,lh&&Gl())}}function Ds(b){Or!==null&&Or.tag===0&&(Xe&6)===0&&Vo();var A=Xe;Xe|=1;var $=He.transition,J=xi;try{if(He.transition=null,xi=1,b)return b()}finally{xi=J,He.transition=$,Xe=A,(Xe&6)===0&&Gl()}}function Fs(){kt=Pt.current,wa(Pt)}function Ci(b,A){b.finishedWork=null,b.finishedLanes=0;var $=b.timeoutHandle;if($!==-1&&(b.timeoutHandle=-1,yx($)),_t!==null)for($=_t.return;$!==null;){var J=$;switch(Ly(J),J.tag){case 1:J=J.type.childContextTypes,J!=null&&ng();break;case 3:Do(),wa(Jo),wa(Ws),Pi();break;case 5:lg(J);break;case 4:Do();break;case 13:wa(hi);break;case 19:wa(hi);break;case 10:dd(J.type._context);break;case 22:case 23:Fs()}$=$.return}if(at=b,_t=b=jh(b.current,null),mt=kt=A,ht=0,Tt=null,Lt=pt=$t=0,Xt=jt=null,Wl!==null){for(A=0;A<Wl.length;A++)if($=Wl[A],J=$.interleaved,J!==null){$.interleaved=null;var de=J.next,ye=$.pending;if(ye!==null){var $e=ye.next;ye.next=de,J.next=$e}$.pending=J}Wl=null}return b}function Ti(b,A){do{var $=_t;try{if(ud(),Jn.current=yg,pd){for(var J=la.memoizedState;J!==null;){var de=J.queue;de!==null&&(de.pending=null),J=J.next}pd=!1}if(Fo=0,cs=pa=la=null,rl=!1,us=0,Ze.current=null,$===null||$.return===null){ht=1,Tt=A,_t=null;break}e:{var ye=b,$e=$.return,yt=$,At=A;if(A=mt,yt.flags|=32768,At!==null&&typeof At=="object"&&typeof At.then=="function"){var Yt=At,Tr=yt,Mr=Tr.tag;if((Tr.mode&1)===0&&(Mr===0||Mr===11||Mr===15)){var jr=Tr.alternate;jr?(Tr.updateQueue=jr.updateQueue,Tr.memoizedState=jr.memoizedState,Tr.lanes=jr.lanes):(Tr.updateQueue=null,Tr.memoizedState=null)}var tn=Of($e);if(tn!==null){tn.flags&=-257,vg(tn,$e,yt,ye,A),tn.mode&1&&Zy(ye,Yt,A),A=tn,At=Yt;var hn=A.updateQueue;if(hn===null){var gn=new Set;gn.add(At),A.updateQueue=gn}else hn.add(At);break e}else{if((A&1)===0){Zy(ye,Yt,A),Fn();break e}At=Error(r(426))}}else if(Sa&&yt.mode&1){var Ss=Of($e);if(Ss!==null){(Ss.flags&65536)===0&&(Ss.flags|=256),vg(Ss,$e,yt,ye,A),Up($c(At,yt));break e}}ye=At=$c(At,yt),ht!==4&&(ht=2),jt===null?jt=[ye]:jt.push(ye),ye=$e;do{switch(ye.tag){case 3:ye.flags|=65536,A&=-A,ye.lanes|=A;var Ut=Mf(ye,At,A);_x(ye,Ut);break e;case 1:yt=At;var Ct=ye.type,Wt=ye.stateNode;if((ye.flags&128)===0&&(typeof Ct.getDerivedStateFromError=="function"||Wt!==null&&typeof Wt.componentDidCatch=="function"&&(xr===null||!xr.has(Wt)))){ye.flags|=65536,A&=-A,ye.lanes|=A;var Ir=Ky(ye,yt,A);_x(ye,Ir);break e}}ye=ye.return}while(ye!==null)}kl($)}catch(sn){A=sn,_t===$&&$!==null&&(_t=$=$.return);continue}break}while(!0)}function _i(){var b=Ke.current;return Ke.current=yg,b===null?yg:b}function Fn(){(ht===0||ht===3||ht===2)&&(ht=4),at===null||($t&268435455)===0&&(pt&268435455)===0||ca(at,mt)}function ua(b,A){var $=Xe;Xe|=2;var J=_i();(at!==b||mt!==A)&&(Ht=null,Ci(b,A));do try{ds();break}catch(de){Ti(b,de)}while(!0);if(ud(),Xe=$,Ke.current=J,_t!==null)throw Error(r(261));return at=null,mt=0,ht}function ds(){for(;_t!==null;)Hs(_t)}function ji(){for(;_t!==null&&!ar();)Hs(_t)}function Hs(b){var A=nm(b.alternate,b,kt);b.memoizedProps=b.pendingProps,A===null?kl(b):_t=A,Ze.current=null}function kl(b){var A=b;do{var $=A.alternate;if(b=A.return,(A.flags&32768)===0){if($=bg($,A,kt),$!==null){_t=$;return}}else{if($=Gc($,A),$!==null){$.flags&=32767,_t=$;return}if(b!==null)b.flags|=32768,b.subtreeFlags=0,b.deletions=null;else{ht=6,_t=null;return}}if(A=A.sibling,A!==null){_t=A;return}_t=A=b}while(A!==null);ht===0&&(ht=5)}function ws(b,A,$){var J=xi,de=He.transition;try{He.transition=null,xi=1,Bo(b,A,$,J)}finally{He.transition=de,xi=J}return null}function Bo(b,A,$,J){do Vo();while(Or!==null);if((Xe&6)!==0)throw Error(r(327));$=b.finishedWork;var de=b.finishedLanes;if($===null)return null;if(b.finishedWork=null,b.finishedLanes=0,$===b.current)throw Error(r(177));b.callbackNode=null,b.callbackPriority=0;var ye=$.lanes|$.childLanes;if(kc(b,ye),b===at&&(_t=at=null,mt=0),($.subtreeFlags&2064)===0&&($.flags&2064)===0||qr||(qr=!0,Sg(On,function(){return Vo(),null})),ye=($.flags&15990)!==0,($.subtreeFlags&15990)!==0||ye){ye=He.transition,He.transition=null;var $e=xi;xi=1;var yt=Xe;Xe|=4,Ze.current=null,Lf(b,$),_e($,b),Km(zp),Za=!!Fp,zp=Fp=null,b.current=$,Te($),sr(),Xe=yt,xi=$e,He.transition=ye}else b.current=$;if(qr&&(qr=!1,Or=b,Lr=de),ye=b.pendingLanes,ye===0&&(xr=null),Oa($.stateNode),wr(b,Nr()),A!==null)for(J=b.onRecoverableError,$=0;$<A.length;$++)de=A[$],J(de.value,{componentStack:de.stack,digest:de.digest});if(tr)throw tr=!1,b=gr,gr=null,b;return(Lr&1)!==0&&b.tag!==0&&Vo(),ye=b.pendingLanes,(ye&1)!==0?b===Ln?Zr++:(Zr=0,Ln=b):Zr=0,Gl(),null}function Vo(){if(Or!==null){var b=bp(Lr),A=He.transition,$=xi;try{if(He.transition=null,xi=16>b?16:b,Or===null)var J=!1;else{if(b=Or,Or=null,Lr=0,(Xe&6)!==0)throw Error(r(331));var de=Xe;for(Xe|=4,Br=b.current;Br!==null;){var ye=Br,$e=ye.child;if((Br.flags&16)!==0){var yt=ye.deletions;if(yt!==null){for(var At=0;At<yt.length;At++){var Yt=yt[At];for(Br=Yt;Br!==null;){var Tr=Br;switch(Tr.tag){case 0:case 11:case 15:g(8,Tr,ye)}var Mr=Tr.child;if(Mr!==null)Mr.return=Tr,Br=Mr;else for(;Br!==null;){Tr=Br;var jr=Tr.sibling,tn=Tr.return;if(y(Tr),Tr===Yt){Br=null;break}if(jr!==null){jr.return=tn,Br=jr;break}Br=tn}}}var hn=ye.alternate;if(hn!==null){var gn=hn.child;if(gn!==null){hn.child=null;do{var Ss=gn.sibling;gn.sibling=null,gn=Ss}while(gn!==null)}}Br=ye}}if((ye.subtreeFlags&2064)!==0&&$e!==null)$e.return=ye,Br=$e;else e:for(;Br!==null;){if(ye=Br,(ye.flags&2048)!==0)switch(ye.tag){case 0:case 11:case 15:g(9,ye,ye.return)}var Ut=ye.sibling;if(Ut!==null){Ut.return=ye.return,Br=Ut;break e}Br=ye.return}}var Ct=b.current;for(Br=Ct;Br!==null;){$e=Br;var Wt=$e.child;if(($e.subtreeFlags&2064)!==0&&Wt!==null)Wt.return=$e,Br=Wt;else e:for($e=Ct;Br!==null;){if(yt=Br,(yt.flags&2048)!==0)try{switch(yt.tag){case 0:case 11:case 15:l(9,yt)}}catch(sn){Mi(yt,yt.return,sn)}if(yt===$e){Br=null;break e}var Ir=yt.sibling;if(Ir!==null){Ir.return=yt.return,Br=Ir;break e}Br=yt.return}}if(Xe=de,Gl(),Rn&&typeof Rn.onPostCommitFiberRoot=="function")try{Rn.onPostCommitFiberRoot($n,b)}catch{}J=!0}return J}finally{xi=$,He.transition=A}}return!1}function Pl(b,A,$){A=$c($,A),A=Mf(b,A,1),b=xu(b,A,1),A=Zn(),b!==null&&(xl(b,1,A),wr(b,A))}function Mi(b,A,$){if(b.tag===3)Pl(b,b,$);else for(;A!==null;){if(A.tag===3){Pl(A,b,$);break}else if(A.tag===1){var J=A.stateNode;if(typeof A.type.getDerivedStateFromError=="function"||typeof J.componentDidCatch=="function"&&(xr===null||!xr.has(J))){b=$c($,b),b=Ky(A,b,1),A=xu(A,b,1),b=Zn(),A!==null&&(xl(A,1,b),wr(A,b));break}}A=A.return}}function Ah(b,A,$){var J=b.pingCache;J!==null&&J.delete(A),A=Zn(),b.pingedLanes|=b.suspendedLanes&$,at===b&&(mt&$)===$&&(ht===4||ht===3&&(mt&130023424)===mt&&500>Nr()-Vt?Ci(b,0):Lt|=$),wr(b,A)}function pc(b,A){A===0&&((b.mode&1)===0?A=1:(A=Dl,Dl<<=1,(Dl&130023424)===0&&(Dl=4194304)));var $=Zn();b=Bc(b,A),b!==null&&(xl(b,A,$),wr(b,$))}function Th(b){var A=b.memoizedState,$=0;A!==null&&($=A.retryLane),pc(b,$)}function Df(b,A){var $=0;switch(b.tag){case 13:var J=b.stateNode,de=b.memoizedState;de!==null&&($=de.retryLane);break;case 19:J=b.stateNode;break;default:throw Error(r(314))}J!==null&&J.delete(A),pc(b,$)}var nm;nm=function(b,A,$){if(b!==null)if(b.memoizedProps!==A.pendingProps||Jo.current)wo=!0;else{if((b.lanes&$)===0&&(A.flags&128)===0)return wo=!1,Sh(b,A,$);wo=(b.flags&131072)!==0}else wo=!1,Sa&&(A.flags&1048576)!==0&&Er(A,Fc,A.index);switch(A.lanes=0,A.tag){case 2:var J=A.type;So(b,A),b=A.pendingProps;var de=cc(A,Ws.current);Jt(A,$),de=Wp(null,A,J,b,de,$);var ye=_u();return A.flags|=1,typeof de=="object"&&de!==null&&typeof de.render=="function"&&de.$$typeof===void 0?(A.tag=1,A.memoizedState=null,A.updateQueue=null,Qo(J)?(ye=!0,sh(A)):ye=!1,A.memoizedState=de.state!==null&&de.state!==void 0?de.state:null,qp(A),de.updater=gd,A.stateNode=de,de._reactInternals=A,Kl(A,J,b,$),A=Yy(null,A,J,!0,ye,$)):(A.tag=0,Sa&&ye&&Vp(A),ao(null,A,de,$),A=A.child),A;case 16:J=A.elementType;e:{switch(So(b,A),b=A.pendingProps,de=J._init,J=de(J._payload),A.type=J,de=A.tag=q2(J),b=fc(J,b),de){case 0:A=Su(null,A,J,b,$);break e;case 1:A=Nu(null,A,J,b,$);break e;case 11:A=yd(null,A,J,b,$);break e;case 14:A=xd(null,A,J,fc(J.type,b),$);break e}throw Error(r(306,J,""))}return A;case 0:return J=A.type,de=A.pendingProps,de=A.elementType===J?de:fc(J,de),Su(b,A,J,de,$);case 1:return J=A.type,de=A.pendingProps,de=A.elementType===J?de:fc(J,de),Nu(b,A,J,de,$);case 3:e:{if(wx(A),b===null)throw Error(r(387));J=A.pendingProps,ye=A.memoizedState,de=ye.element,zy(b,A),og(A,J,null,$);var $e=A.memoizedState;if(J=$e.element,ye.isDehydrated)if(ye={element:J,isDehydrated:!1,cache:$e.cache,pendingSuspenseBoundaries:$e.pendingSuspenseBoundaries,transitions:$e.transitions},A.updateQueue.baseState=ye,A.memoizedState=ye,A.flags&256){de=$c(Error(r(423)),A),A=Sx(b,A,J,$,de);break e}else if(J!==de){de=$c(Error(r(424)),A),A=Sx(b,A,J,$,de);break e}else for(bo=id(A.stateNode.containerInfo.firstChild),Sl=A,Sa=!0,Nl=null,$=$p(A,null,J,$),A.child=$;$;)$.flags=$.flags&-3|4096,$=$.sibling;else{if(Tl(),J===de){A=al(b,A,$);break e}ao(b,A,J,$)}A=A.child}return A;case 5:return Uc(A),b===null&&bf(A),J=A.type,de=A.pendingProps,ye=b!==null?b.memoizedProps:null,$e=de.children,xf(J,de)?$e=null:ye!==null&&xf(J,ye)&&(A.flags|=32),wu(b,A),ao(b,A,$e,$),A.child;case 6:return b===null&&bf(A),null;case 13:return so(b,A,$);case 4:return Sf(A,A.stateNode.containerInfo),J=A.pendingProps,b===null?A.child=vi(A,null,J,$):ao(b,A,J,$),A.child;case 11:return J=A.type,de=A.pendingProps,de=A.elementType===J?de:fc(J,de),yd(b,A,J,de,$);case 7:return ao(b,A,A.pendingProps,$),A.child;case 8:return ao(b,A,A.pendingProps.children,$),A.child;case 12:return ao(b,A,A.pendingProps.children,$),A.child;case 10:e:{if(J=A.type._context,de=A.pendingProps,ye=A.memoizedProps,$e=de.value,ra(ld,J._currentValue),J._currentValue=$e,ye!==null)if(no(ye.value,$e)){if(ye.children===de.children&&!Jo.current){A=al(b,A,$);break e}}else for(ye=A.child,ye!==null&&(ye.return=A);ye!==null;){var yt=ye.dependencies;if(yt!==null){$e=ye.child;for(var At=yt.firstContext;At!==null;){if(At.context===J){if(ye.tag===1){At=Vc(-1,$&-$),At.tag=2;var Yt=ye.updateQueue;if(Yt!==null){Yt=Yt.shared;var Tr=Yt.pending;Tr===null?At.next=At:(At.next=Tr.next,Tr.next=At),Yt.pending=At}}ye.lanes|=$,At=ye.alternate,At!==null&&(At.lanes|=$),hd(ye.return,$,A),yt.lanes|=$;break}At=At.next}}else if(ye.tag===10)$e=ye.type===A.type?null:ye.child;else if(ye.tag===18){if($e=ye.return,$e===null)throw Error(r(341));$e.lanes|=$,yt=$e.alternate,yt!==null&&(yt.lanes|=$),hd($e,$,A),$e=ye.sibling}else $e=ye.child;if($e!==null)$e.return=ye;else for($e=ye;$e!==null;){if($e===A){$e=null;break}if(ye=$e.sibling,ye!==null){ye.return=$e.return,$e=ye;break}$e=$e.return}ye=$e}ao(b,A,de.children,$),A=A.child}return A;case 9:return de=A.type,J=A.pendingProps.children,Jt(A,$),de=dr(de),J=J(de),A.flags|=1,ao(b,A,J,$),A.child;case 14:return J=A.type,de=fc(J,A.pendingProps),de=fc(J.type,de),xd(b,A,J,de,$);case 15:return qc(b,A,A.type,A.pendingProps,$);case 17:return J=A.type,de=A.pendingProps,de=A.elementType===J?de:fc(J,de),So(b,A),A.tag=1,Qo(J)?(b=!0,sh(A)):b=!1,Jt(A,$),Cf(A,J,de),Kl(A,J,de,$),Yy(null,A,J,!0,b,$);case 19:return il(b,A,$);case 22:return Zl(b,A,$)}throw Error(r(156,A.tag))};function Sg(b,A){return Nt(b,A)}function $2(b,A,$,J){this.tag=b,this.key=$,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=A,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=J,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wc(b,A,$,J){return new $2(b,A,$,J)}function Q_(b){return b=b.prototype,!(!b||!b.isReactComponent)}function q2(b){if(typeof b=="function")return Q_(b)?1:0;if(b!=null){if(b=b.$$typeof,b===be)return 11;if(b===Ee)return 14}return 2}function jh(b,A){var $=b.alternate;return $===null?($=Wc(b.tag,A,b.key,b.mode),$.elementType=b.elementType,$.type=b.type,$.stateNode=b.stateNode,$.alternate=b,b.alternate=$):($.pendingProps=A,$.type=b.type,$.flags=0,$.subtreeFlags=0,$.deletions=null),$.flags=b.flags&14680064,$.childLanes=b.childLanes,$.lanes=b.lanes,$.child=b.child,$.memoizedProps=b.memoizedProps,$.memoizedState=b.memoizedState,$.updateQueue=b.updateQueue,A=b.dependencies,$.dependencies=A===null?null:{lanes:A.lanes,firstContext:A.firstContext},$.sibling=b.sibling,$.index=b.index,$.ref=b.ref,$}function Xy(b,A,$,J,de,ye){var $e=2;if(J=b,typeof b=="function")Q_(b)&&($e=1);else if(typeof b=="string")$e=5;else e:switch(b){case ue:return Ff($.children,de,ye,A);case he:$e=8,de|=8;break;case Ce:return b=Wc(12,$,A,de|2),b.elementType=Ce,b.lanes=ye,b;case pe:return b=Wc(13,$,A,de),b.elementType=pe,b.lanes=ye,b;case Se:return b=Wc(19,$,A,de),b.elementType=Se,b.lanes=ye,b;case Pe:return Jy($,de,ye,A);default:if(typeof b=="object"&&b!==null)switch(b.$$typeof){case Ne:$e=10;break e;case me:$e=9;break e;case be:$e=11;break e;case Ee:$e=14;break e;case we:$e=16,J=null;break e}throw Error(r(130,b==null?b:typeof b,""))}return A=Wc($e,$,A,de),A.elementType=b,A.type=J,A.lanes=ye,A}function Ff(b,A,$,J){return b=Wc(7,b,J,A),b.lanes=$,b}function Jy(b,A,$,J){return b=Wc(22,b,J,A),b.elementType=Pe,b.lanes=$,b.stateNode={isHidden:!1},b}function Ax(b,A,$){return b=Wc(6,b,null,A),b.lanes=$,b}function Tx(b,A,$){return A=Wc(4,b.children!==null?b.children:[],b.key,A),A.lanes=$,A.stateNode={containerInfo:b.containerInfo,pendingChildren:null,implementation:b.implementation},A}function eb(b,A,$,J,de){this.tag=A,this.containerInfo=b,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yl(0),this.expirationTimes=yl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yl(0),this.identifierPrefix=J,this.onRecoverableError=de,this.mutableSourceEagerHydrationData=null}function bd(b,A,$,J,de,ye,$e,yt,At){return b=new eb(b,A,$,yt,At),A===1?(A=1,ye===!0&&(A|=8)):A=0,ye=Wc(3,null,null,A),b.current=ye,ye.stateNode=b,ye.memoizedState={element:J,isDehydrated:$,cache:null,transitions:null,pendingSuspenseBoundaries:null},qp(ye),b}function Ks(b,A,$){var J=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:se,key:J==null?null:""+J,children:b,containerInfo:A,implementation:$}}function tb(b){if(!b)return ql;b=b._reactInternals;e:{if(Je(b)!==b||b.tag!==1)throw Error(r(170));var A=b;do{switch(A.tag){case 3:A=A.stateNode.context;break e;case 1:if(Qo(A.type)){A=A.stateNode.__reactInternalMemoizedMergedChildContext;break e}}A=A.return}while(A!==null);throw Error(r(171))}if(b.tag===1){var $=b.type;if(Qo($))return Ry(b,$,A)}return A}function Ng(b,A,$,J,de,ye,$e,yt,At){return b=bd($,J,!0,b,de,ye,$e,yt,At),b.context=tb(null),$=b.current,J=Zn(),de=Qr($),ye=Vc(J,de),ye.callback=A??null,xu($,ye,de),b.current.lanes=de,xl(b,de,J),wr(b,J),b}function jx(b,A,$,J){var de=A.current,ye=Zn(),$e=Qr(de);return $=tb($),A.context===null?A.context=$:A.pendingContext=$,A=Vc(ye,$e),A.payload={element:b},J=J===void 0?null:J,J!==null&&(A.callback=J),b=xu(de,A,$e),b!==null&&(jn(b,de,$e,ye),vu(b,de,$e)),$e}function kx(b){if(b=b.current,!b.child)return null;switch(b.child.tag){case 5:return b.child.stateNode;default:return b.child.stateNode}}function Ag(b,A){if(b=b.memoizedState,b!==null&&b.dehydrated!==null){var $=b.retryLane;b.retryLane=$!==0&&$<A?$:A}}function Px(b,A){Ag(b,A),(b=b.alternate)&&Ag(b,A)}function im(){return null}var Tg=typeof reportError=="function"?reportError:function(b){console.error(b)};function rb(b){this._internalRoot=b}Cx.prototype.render=rb.prototype.render=function(b){var A=this._internalRoot;if(A===null)throw Error(r(409));jx(b,A,null,null)},Cx.prototype.unmount=rb.prototype.unmount=function(){var b=this._internalRoot;if(b!==null){this._internalRoot=null;var A=b.containerInfo;Ds(function(){jx(null,b,null,null)}),A[Ul]=null}};function Cx(b){this._internalRoot=b}Cx.prototype.unstable_scheduleHydration=function(b){if(b){var A=_y();b={blockedOn:null,target:b,priority:A};for(var $=0;$<xn.length&&A!==0&&A<xn[$].priority;$++);xn.splice($,0,b),$===0&&Wn(b)}};function nb(b){return!(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11)}function Ex(b){return!(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11&&(b.nodeType!==8||b.nodeValue!==" react-mount-point-unstable "))}function G2(){}function $j(b,A,$,J,de){if(de){if(typeof J=="function"){var ye=J;J=function(){var Yt=kx($e);ye.call(Yt)}}var $e=Ng(A,J,b,0,null,!1,!1,"",G2);return b._reactRootContainer=$e,b[Ul]=$e.current,gf(b.nodeType===8?b.parentNode:b),Ds(),$e}for(;de=b.lastChild;)b.removeChild(de);if(typeof J=="function"){var yt=J;J=function(){var Yt=kx(At);yt.call(Yt)}}var At=bd(b,0,!1,null,null,!1,!1,"",G2);return b._reactRootContainer=At,b[Ul]=At.current,gf(b.nodeType===8?b.parentNode:b),Ds(function(){jx(A,At,$,J)}),At}function Mx(b,A,$,J,de){var ye=$._reactRootContainer;if(ye){var $e=ye;if(typeof de=="function"){var yt=de;de=function(){var At=kx($e);yt.call(At)}}jx(A,$e,b,de)}else $e=$j($,A,b,de,J);return kx($e)}zm=function(b){switch(b.tag){case 3:var A=b.stateNode;if(A.current.memoizedState.isDehydrated){var $=iu(A.pendingLanes);$!==0&&(vl(A,$|1),wr(A,Nr()),(Xe&6)===0&&(It=Nr()+500,Gl()))}break;case 13:Ds(function(){var J=Bc(b,1);if(J!==null){var de=Zn();jn(J,b,1,de)}}),Px(b,1)}},Pc=function(b){if(b.tag===13){var A=Bc(b,134217728);if(A!==null){var $=Zn();jn(A,b,134217728,$)}Px(b,134217728)}},au=function(b){if(b.tag===13){var A=Qr(b),$=Bc(b,A);if($!==null){var J=Zn();jn($,b,A,J)}Px(b,A)}},_y=function(){return xi},Bm=function(b,A){var $=xi;try{return xi=b,A()}finally{xi=$}},qu=function(b,A,$){switch(A){case"input":if(pi(b,$),A=$.name,$.type==="radio"&&A!=null){for($=b;$.parentNode;)$=$.parentNode;for($=$.querySelectorAll("input[name="+JSON.stringify(""+A)+'][type="radio"]'),A=0;A<$.length;A++){var J=$[A];if(J!==b&&J.form===b.form){var de=_f(J);if(!de)throw Error(r(90));Kt(J),pi(J,de)}}}break;case"textarea":pr(b,$);break;case"select":A=$.value,A!=null&&Cr(b,!!$.multiple,A,!1)}},Es=ka,Ll=Ds;var ib={usingClientEntryPoint:!1,Events:[ah,bl,_f,va,Ea,ka]},Qy={findFiberByHostInstance:sd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jg={bundleType:Qy.bundleType,version:Qy.version,rendererPackageName:Qy.rendererPackageName,rendererConfig:Qy.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ae.ReactCurrentDispatcher,findHostInstanceByFiber:function(b){return b=wt(b),b===null?null:b.stateNode},findFiberByHostInstance:Qy.findFiberByHostInstance||im,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ox=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ox.isDisabled&&Ox.supportsFiber)try{$n=Ox.inject(jg),Rn=Ox}catch{}}return Hc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ib,Hc.createPortal=function(b,A){var $=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nb(A))throw Error(r(200));return Ks(b,A,null,$)},Hc.createRoot=function(b,A){if(!nb(b))throw Error(r(299));var $=!1,J="",de=Tg;return A!=null&&(A.unstable_strictMode===!0&&($=!0),A.identifierPrefix!==void 0&&(J=A.identifierPrefix),A.onRecoverableError!==void 0&&(de=A.onRecoverableError)),A=bd(b,1,!1,null,null,$,!1,J,de),b[Ul]=A.current,gf(b.nodeType===8?b.parentNode:b),new rb(A)},Hc.findDOMNode=function(b){if(b==null)return null;if(b.nodeType===1)return b;var A=b._reactInternals;if(A===void 0)throw typeof b.render=="function"?Error(r(188)):(b=Object.keys(b).join(","),Error(r(268,b)));return b=wt(A),b=b===null?null:b.stateNode,b},Hc.flushSync=function(b){return Ds(b)},Hc.hydrate=function(b,A,$){if(!Ex(A))throw Error(r(200));return Mx(null,b,A,!0,$)},Hc.hydrateRoot=function(b,A,$){if(!nb(b))throw Error(r(405));var J=$!=null&&$.hydratedSources||null,de=!1,ye="",$e=Tg;if($!=null&&($.unstable_strictMode===!0&&(de=!0),$.identifierPrefix!==void 0&&(ye=$.identifierPrefix),$.onRecoverableError!==void 0&&($e=$.onRecoverableError)),A=Ng(A,null,b,1,$??null,de,!1,ye,$e),b[Ul]=A.current,gf(b),J)for(b=0;b<J.length;b++)$=J[b],de=$._getVersion,de=de($._source),A.mutableSourceEagerHydrationData==null?A.mutableSourceEagerHydrationData=[$,de]:A.mutableSourceEagerHydrationData.push($,de);return new Cx(A)},Hc.render=function(b,A,$){if(!Ex(A))throw Error(r(200));return Mx(null,b,A,!1,$)},Hc.unmountComponentAtNode=function(b){if(!Ex(b))throw Error(r(40));return b._reactRootContainer?(Ds(function(){Mx(null,null,b,!1,function(){b._reactRootContainer=null,b[Ul]=null})}),!0):!1},Hc.unstable_batchedUpdates=ka,Hc.unstable_renderSubtreeIntoContainer=function(b,A,$,J){if(!Ex($))throw Error(r(200));if(b==null||b._reactInternals===void 0)throw Error(r(38));return Mx(b,A,$,!1,J)},Hc.version="18.3.1-next-f1338f8080-20240426",Hc}var OB;function ZW(){if(OB)return tP.exports;OB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),tP.exports=Moe(),tP.exports}var $w=ZW();const YW=ha($w);function Ooe(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const Roe=e=>{switch(e){case"success":return Doe;case"info":return zoe;case"warning":return Foe;case"error":return Boe;default:return null}},Ioe=Array(12).fill(0),Loe=({visible:e,className:t})=>Le.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Le.createElement("div",{className:"sonner-spinner"},Ioe.map((r,n)=>Le.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),Doe=Le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Le.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Foe=Le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Le.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),zoe=Le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Le.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Boe=Le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Le.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Voe=Le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Le.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Le.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Uoe=()=>{const[e,t]=Le.useState(document.hidden);return Le.useEffect(()=>{const r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e};let iR=1;class $oe{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;const{message:n,...a}=t,c=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:iR++,h=this.toasts.find(x=>x.id===c),i=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(c)&&this.dismissedToasts.delete(c),h?this.toasts=this.toasts.map(x=>x.id===c?(this.publish({...x,...t,id:c,title:n}),{...x,...t,id:c,dismissible:i,title:n}):x):this.addToast({title:n,...a,dismissible:i,id:c}),c},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:t,dismiss:!0}))),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const a=Promise.resolve(t instanceof Function?t():t);let c=n!==void 0,h;const i=a.then(async w=>{if(h=["resolve",w],Le.isValidElement(w))c=!1,this.create({id:n,type:"default",message:w});else if(Goe(w)&&!w.ok){c=!1;const T=typeof r.error=="function"?await r.error(`HTTP error! status: ${w.status}`):r.error,E=typeof r.description=="function"?await r.description(`HTTP error! status: ${w.status}`):r.description,D=typeof T=="object"?T:{message:T};this.create({id:n,type:"error",description:E,...D})}else if(w instanceof Error){c=!1;const T=typeof r.error=="function"?await r.error(w):r.error,E=typeof r.description=="function"?await r.description(w):r.description,D=typeof T=="object"?T:{message:T};this.create({id:n,type:"error",description:E,...D})}else if(r.success!==void 0){c=!1;const T=typeof r.success=="function"?await r.success(w):r.success,E=typeof r.description=="function"?await r.description(w):r.description,D=typeof T=="object"?T:{message:T};this.create({id:n,type:"success",description:E,...D})}}).catch(async w=>{if(h=["reject",w],r.error!==void 0){c=!1;const S=typeof r.error=="function"?await r.error(w):r.error,T=typeof r.description=="function"?await r.description(w):r.description,E=typeof S=="object"?S:{message:S};this.create({id:n,type:"error",description:T,...E})}}).finally(()=>{c&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),x=()=>new Promise((w,S)=>i.then(()=>h[0]==="reject"?S(h[1]):w(h[1])).catch(S));return typeof n!="string"&&typeof n!="number"?{unwrap:x}:Object.assign(n,{unwrap:x})},this.custom=(t,r)=>{const n=(r==null?void 0:r.id)||iR++;return this.create({jsx:t(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Yc=new $oe,qoe=(e,t)=>{const r=(t==null?void 0:t.id)||iR++;return Yc.addToast({title:e,...t,id:r}),r},Goe=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Woe=qoe,Hoe=()=>Yc.toasts,Koe=()=>Yc.getActiveToasts(),Xr=Object.assign(Woe,{success:Yc.success,info:Yc.info,warning:Yc.warning,error:Yc.error,custom:Yc.custom,message:Yc.message,promise:Yc.promise,dismiss:Yc.dismiss,loading:Yc.loading},{getHistory:Hoe,getToasts:Koe});Ooe("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function MS(e){return e.label!==void 0}const Zoe=3,Yoe="24px",Xoe="16px",RB=4e3,Joe=356,Qoe=14,ele=45,tle=200;function Vf(...e){return e.filter(Boolean).join(" ")}function rle(e){const[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}const nle=e=>{var t,r,n,a,c,h,i,x,w;const{invert:S,toast:T,unstyled:E,interacting:D,setHeights:U,visibleToasts:I,heights:V,index:H,toasts:K,expanded:Q,removeToast:ae,defaultRichColors:ee,closeButton:se,style:ue,cancelButtonStyle:he,actionButtonStyle:Ce,className:Ne="",descriptionClassName:me="",duration:be,position:pe,gap:Se,expandByDefault:Ee,classNames:we,icons:Pe,closeButtonAriaLabel:Me="Close toast"}=e,[Be,Ge]=Le.useState(null),[We,tt]=Le.useState(null),[nt,Dt]=Le.useState(!1),[nr,ir]=Le.useState(!1),[rr,or]=Le.useState(!1),[Ft,ze]=Le.useState(!1),[Pr,Kt]=Le.useState(!1),[on,Rt]=Le.useState(0),[En,Vn]=Le.useState(0),pi=Le.useRef(T.duration||be||RB),dt=Le.useRef(null),Ot=Le.useRef(null),Zt=H===0,Cr=H+1<=I,vr=T.type,Sr=T.dismissible!==!1,pr=T.className||"",Mn=T.descriptionClassName||"",Ai=Le.useMemo(()=>V.findIndex(Gn=>Gn.toastId===T.id)||0,[V,T.id]),Vi=Le.useMemo(()=>{var Gn;return(Gn=T.closeButton)!=null?Gn:se},[T.closeButton,se]),Ui=Le.useMemo(()=>T.duration||be||RB,[T.duration,be]),xo=Le.useRef(0),Wa=Le.useRef(0),Qs=Le.useRef(0),Eo=Le.useRef(null),[ss,ac]=pe.split("-"),Il=Le.useMemo(()=>V.reduce((Gn,va,Ea)=>Ea>=Ai?Gn:Gn+va.height,0),[V,Ai]),$s=Uoe(),sc=T.invert||S,ln=vr==="loading";Wa.current=Le.useMemo(()=>Ai*Se+Il,[Ai,Il]),Le.useEffect(()=>{pi.current=Ui},[Ui]),Le.useEffect(()=>{Dt(!0)},[]),Le.useEffect(()=>{const Gn=Ot.current;if(Gn){const va=Gn.getBoundingClientRect().height;return Vn(va),U(Ea=>[{toastId:T.id,height:va,position:T.position},...Ea]),()=>U(Ea=>Ea.filter(Es=>Es.toastId!==T.id))}},[U,T.id]),Le.useLayoutEffect(()=>{if(!nt)return;const Gn=Ot.current,va=Gn.style.height;Gn.style.height="auto";const Ea=Gn.getBoundingClientRect().height;Gn.style.height=va,Vn(Ea),U(Es=>Es.find(Ma=>Ma.toastId===T.id)?Es.map(Ma=>Ma.toastId===T.id?{...Ma,height:Ea}:Ma):[{toastId:T.id,height:Ea,position:T.position},...Es])},[nt,T.title,T.description,U,T.id]);const os=Le.useCallback(()=>{ir(!0),Rt(Wa.current),U(Gn=>Gn.filter(va=>va.toastId!==T.id)),setTimeout(()=>{ae(T)},tle)},[T,ae,U,Wa]);Le.useEffect(()=>{if(T.promise&&vr==="loading"||T.duration===1/0||T.type==="loading")return;let Gn;return Q||D||$s?(()=>{if(Qs.current<xo.current){const Es=new Date().getTime()-xo.current;pi.current=pi.current-Es}Qs.current=new Date().getTime()})():(()=>{pi.current!==1/0&&(xo.current=new Date().getTime(),Gn=setTimeout(()=>{T.onAutoClose==null||T.onAutoClose.call(T,T),os()},pi.current))})(),()=>clearTimeout(Gn)},[Q,D,T,vr,$s,os]),Le.useEffect(()=>{T.delete&&os()},[os,T.delete]);function qu(){var Gn;if(Pe!=null&&Pe.loading){var va;return Le.createElement("div",{className:Vf(we==null?void 0:we.loader,T==null||(va=T.classNames)==null?void 0:va.loader,"sonner-loader"),"data-visible":vr==="loading"},Pe.loading)}return Le.createElement(Loe,{className:Vf(we==null?void 0:we.loader,T==null||(Gn=T.classNames)==null?void 0:Gn.loader),visible:vr==="loading"})}var Ha,eo;return Le.createElement("li",{tabIndex:0,ref:Ot,className:Vf(Ne,pr,we==null?void 0:we.toast,T==null||(t=T.classNames)==null?void 0:t.toast,we==null?void 0:we.default,we==null?void 0:we[vr],T==null||(r=T.classNames)==null?void 0:r[vr]),"data-sonner-toast":"","data-rich-colors":(Ha=T.richColors)!=null?Ha:ee,"data-styled":!(T.jsx||T.unstyled||E),"data-mounted":nt,"data-promise":!!T.promise,"data-swiped":Pr,"data-removed":nr,"data-visible":Cr,"data-y-position":ss,"data-x-position":ac,"data-index":H,"data-front":Zt,"data-swiping":rr,"data-dismissible":Sr,"data-type":vr,"data-invert":sc,"data-swipe-out":Ft,"data-swipe-direction":We,"data-expanded":!!(Q||Ee&&nt),style:{"--index":H,"--toasts-before":H,"--z-index":K.length-H,"--offset":`${nr?on:Wa.current}px`,"--initial-height":Ee?"auto":`${En}px`,...ue,...T.style},onDragEnd:()=>{or(!1),Ge(null),Eo.current=null},onPointerDown:Gn=>{ln||!Sr||(dt.current=new Date,Rt(Wa.current),Gn.target.setPointerCapture(Gn.pointerId),Gn.target.tagName!=="BUTTON"&&(or(!0),Eo.current={x:Gn.clientX,y:Gn.clientY}))},onPointerUp:()=>{var Gn,va,Ea;if(Ft||!Sr)return;Eo.current=null;const Es=Number(((Gn=Ot.current)==null?void 0:Gn.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Ll=Number(((va=Ot.current)==null?void 0:va.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Ma=new Date().getTime()-((Ea=dt.current)==null?void 0:Ea.getTime()),qs=Be==="x"?Es:Ll,$i=Math.abs(qs)/Ma;if(Math.abs(qs)>=ele||$i>.11){Rt(Wa.current),T.onDismiss==null||T.onDismiss.call(T,T),tt(Be==="x"?Es>0?"right":"left":Ll>0?"down":"up"),os(),ze(!0);return}else{var Ms,gs;(Ms=Ot.current)==null||Ms.style.setProperty("--swipe-amount-x","0px"),(gs=Ot.current)==null||gs.style.setProperty("--swipe-amount-y","0px")}Kt(!1),or(!1),Ge(null)},onPointerMove:Gn=>{var va,Ea,Es;if(!Eo.current||!Sr||((va=window.getSelection())==null?void 0:va.toString().length)>0)return;const Ma=Gn.clientY-Eo.current.y,qs=Gn.clientX-Eo.current.x;var $i;const Ms=($i=e.swipeDirections)!=null?$i:rle(pe);!Be&&(Math.abs(qs)>1||Math.abs(Ma)>1)&&Ge(Math.abs(qs)>Math.abs(Ma)?"x":"y");let gs={x:0,y:0};const Gu=Xi=>1/(1.5+Math.abs(Xi)/20);if(Be==="y"){if(Ms.includes("top")||Ms.includes("bottom"))if(Ms.includes("top")&&Ma<0||Ms.includes("bottom")&&Ma>0)gs.y=Ma;else{const Xi=Ma*Gu(Ma);gs.y=Math.abs(Xi)<Math.abs(Ma)?Xi:Ma}}else if(Be==="x"&&(Ms.includes("left")||Ms.includes("right")))if(Ms.includes("left")&&qs<0||Ms.includes("right")&&qs>0)gs.x=qs;else{const Xi=qs*Gu(qs);gs.x=Math.abs(Xi)<Math.abs(qs)?Xi:qs}(Math.abs(gs.x)>0||Math.abs(gs.y)>0)&&Kt(!0),(Ea=Ot.current)==null||Ea.style.setProperty("--swipe-amount-x",`${gs.x}px`),(Es=Ot.current)==null||Es.style.setProperty("--swipe-amount-y",`${gs.y}px`)}},Vi&&!T.jsx&&vr!=="loading"?Le.createElement("button",{"aria-label":Me,"data-disabled":ln,"data-close-button":!0,onClick:ln||!Sr?()=>{}:()=>{os(),T.onDismiss==null||T.onDismiss.call(T,T)},className:Vf(we==null?void 0:we.closeButton,T==null||(n=T.classNames)==null?void 0:n.closeButton)},(eo=Pe==null?void 0:Pe.close)!=null?eo:Voe):null,vr||T.icon||T.promise?Le.createElement("div",{"data-icon":"",className:Vf(we==null?void 0:we.icon,T==null||(a=T.classNames)==null?void 0:a.icon)},T.promise||T.type==="loading"&&!T.icon?T.icon||qu():null,T.type!=="loading"?T.icon||(Pe==null?void 0:Pe[vr])||Roe(vr):null):null,Le.createElement("div",{"data-content":"",className:Vf(we==null?void 0:we.content,T==null||(c=T.classNames)==null?void 0:c.content)},Le.createElement("div",{"data-title":"",className:Vf(we==null?void 0:we.title,T==null||(h=T.classNames)==null?void 0:h.title)},T.jsx?T.jsx:typeof T.title=="function"?T.title():T.title),T.description?Le.createElement("div",{"data-description":"",className:Vf(me,Mn,we==null?void 0:we.description,T==null||(i=T.classNames)==null?void 0:i.description)},typeof T.description=="function"?T.description():T.description):null),Le.isValidElement(T.cancel)?T.cancel:T.cancel&&MS(T.cancel)?Le.createElement("button",{"data-button":!0,"data-cancel":!0,style:T.cancelButtonStyle||he,onClick:Gn=>{MS(T.cancel)&&Sr&&(T.cancel.onClick==null||T.cancel.onClick.call(T.cancel,Gn),os())},className:Vf(we==null?void 0:we.cancelButton,T==null||(x=T.classNames)==null?void 0:x.cancelButton)},T.cancel.label):null,Le.isValidElement(T.action)?T.action:T.action&&MS(T.action)?Le.createElement("button",{"data-button":!0,"data-action":!0,style:T.actionButtonStyle||Ce,onClick:Gn=>{MS(T.action)&&(T.action.onClick==null||T.action.onClick.call(T.action,Gn),!Gn.defaultPrevented&&os())},className:Vf(we==null?void 0:we.actionButton,T==null||(w=T.classNames)==null?void 0:w.actionButton)},T.action.label):null)};function IB(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function ile(e,t){const r={};return[e,t].forEach((n,a)=>{const c=a===1,h=c?"--mobile-offset":"--offset",i=c?Xoe:Yoe;function x(w){["top","right","bottom","left"].forEach(S=>{r[`${h}-${S}`]=typeof w=="number"?`${w}px`:w})}typeof n=="number"||typeof n=="string"?x(n):typeof n=="object"?["top","right","bottom","left"].forEach(w=>{n[w]===void 0?r[`${h}-${w}`]=i:r[`${h}-${w}`]=typeof n[w]=="number"?`${n[w]}px`:n[w]}):x(i)}),r}const ale=Le.forwardRef(function(t,r){const{invert:n,position:a="bottom-right",hotkey:c=["altKey","KeyT"],expand:h,closeButton:i,className:x,offset:w,mobileOffset:S,theme:T="light",richColors:E,duration:D,style:U,visibleToasts:I=Zoe,toastOptions:V,dir:H=IB(),gap:K=Qoe,icons:Q,containerAriaLabel:ae="Notifications"}=t,[ee,se]=Le.useState([]),ue=Le.useMemo(()=>Array.from(new Set([a].concat(ee.filter(We=>We.position).map(We=>We.position)))),[ee,a]),[he,Ce]=Le.useState([]),[Ne,me]=Le.useState(!1),[be,pe]=Le.useState(!1),[Se,Ee]=Le.useState(T!=="system"?T:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),we=Le.useRef(null),Pe=c.join("+").replace(/Key/g,"").replace(/Digit/g,""),Me=Le.useRef(null),Be=Le.useRef(!1),Ge=Le.useCallback(We=>{se(tt=>{var nt;return(nt=tt.find(Dt=>Dt.id===We.id))!=null&&nt.delete||Yc.dismiss(We.id),tt.filter(({id:Dt})=>Dt!==We.id)})},[]);return Le.useEffect(()=>Yc.subscribe(We=>{if(We.dismiss){const tt=ee.map(nt=>nt.id===We.id?{...nt,delete:!0}:nt);requestAnimationFrame(()=>{se(tt)});return}setTimeout(()=>{YW.flushSync(()=>{se(tt=>{const nt=tt.findIndex(Dt=>Dt.id===We.id);return nt!==-1?[...tt.slice(0,nt),{...tt[nt],...We},...tt.slice(nt+1)]:[We,...tt]})})})}),[ee]),Le.useEffect(()=>{if(T!=="system"){Ee(T);return}if(T==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Ee("dark"):Ee("light")),typeof window>"u")return;const We=window.matchMedia("(prefers-color-scheme: dark)");try{We.addEventListener("change",({matches:tt})=>{Ee(tt?"dark":"light")})}catch{We.addListener(({matches:nt})=>{try{Ee(nt?"dark":"light")}catch(Dt){console.error(Dt)}})}},[T]),Le.useEffect(()=>{ee.length<=1&&me(!1)},[ee]),Le.useEffect(()=>{const We=tt=>{var nt;if(c.every(ir=>tt[ir]||tt.code===ir)){var nr;me(!0),(nr=we.current)==null||nr.focus()}tt.code==="Escape"&&(document.activeElement===we.current||(nt=we.current)!=null&&nt.contains(document.activeElement))&&me(!1)};return document.addEventListener("keydown",We),()=>document.removeEventListener("keydown",We)},[c]),Le.useEffect(()=>{if(we.current)return()=>{Me.current&&(Me.current.focus({preventScroll:!0}),Me.current=null,Be.current=!1)}},[we.current]),Le.createElement("section",{ref:r,"aria-label":`${ae} ${Pe}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},ue.map((We,tt)=>{var nt;const[Dt,nr]=We.split("-");return ee.length?Le.createElement("ol",{key:We,dir:H==="auto"?IB():H,tabIndex:-1,ref:we,className:x,"data-sonner-toaster":!0,"data-sonner-theme":Se,"data-y-position":Dt,"data-lifted":Ne&&ee.length>1&&!h,"data-x-position":nr,style:{"--front-toast-height":`${((nt=he[0])==null?void 0:nt.height)||0}px`,"--width":`${Joe}px`,"--gap":`${K}px`,...U,...ile(w,S)},onBlur:ir=>{Be.current&&!ir.currentTarget.contains(ir.relatedTarget)&&(Be.current=!1,Me.current&&(Me.current.focus({preventScroll:!0}),Me.current=null))},onFocus:ir=>{ir.target instanceof HTMLElement&&ir.target.dataset.dismissible==="false"||Be.current||(Be.current=!0,Me.current=ir.relatedTarget)},onMouseEnter:()=>me(!0),onMouseMove:()=>me(!0),onMouseLeave:()=>{be||me(!1)},onDragEnd:()=>me(!1),onPointerDown:ir=>{ir.target instanceof HTMLElement&&ir.target.dataset.dismissible==="false"||pe(!0)},onPointerUp:()=>pe(!1)},ee.filter(ir=>!ir.position&&tt===0||ir.position===We).map((ir,rr)=>{var or,Ft;return Le.createElement(nle,{key:ir.id,icons:Q,index:rr,toast:ir,defaultRichColors:E,duration:(or=V==null?void 0:V.duration)!=null?or:D,className:V==null?void 0:V.className,descriptionClassName:V==null?void 0:V.descriptionClassName,invert:n,visibleToasts:I,closeButton:(Ft=V==null?void 0:V.closeButton)!=null?Ft:i,interacting:be,position:We,style:V==null?void 0:V.style,unstyled:V==null?void 0:V.unstyled,classNames:V==null?void 0:V.classNames,cancelButtonStyle:V==null?void 0:V.cancelButtonStyle,actionButtonStyle:V==null?void 0:V.actionButtonStyle,closeButtonAriaLabel:V==null?void 0:V.closeButtonAriaLabel,removeToast:Ge,toasts:ee.filter(ze=>ze.position==ir.position),heights:he.filter(ze=>ze.position==ir.position),setHeights:Ce,expandByDefault:h,gap:K,expanded:Ne,swipeDirections:t.swipeDirections})})):null}))}),sle=({...e})=>{const{theme:t="system"}=Poe();return o.jsx(ale,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};/**
 * react-router v7.9.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var LB="popstate";function ole(e={}){function t(n,a){let{pathname:c,search:h,hash:i}=n.location;return aR("",{pathname:c,search:h,hash:i},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:T1(a)}return cle(t,r,null,e)}function Cs(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Hh(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function lle(){return Math.random().toString(36).substring(2,10)}function DB(e,t){return{usr:e.state,key:e.key,idx:t}}function aR(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?p_(t):t,state:r,key:t&&t.key||n||lle()}}function T1({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function p_(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function cle(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:c=!1}=n,h=a.history,i="POP",x=null,w=S();w==null&&(w=0,h.replaceState({...h.state,idx:w},""));function S(){return(h.state||{idx:null}).idx}function T(){i="POP";let V=S(),H=V==null?null:V-w;w=V,x&&x({action:i,location:I.location,delta:H})}function E(V,H){i="PUSH";let K=aR(I.location,V,H);w=S()+1;let Q=DB(K,w),ae=I.createHref(K);try{h.pushState(Q,"",ae)}catch(ee){if(ee instanceof DOMException&&ee.name==="DataCloneError")throw ee;a.location.assign(ae)}c&&x&&x({action:i,location:I.location,delta:1})}function D(V,H){i="REPLACE";let K=aR(I.location,V,H);w=S();let Q=DB(K,w),ae=I.createHref(K);h.replaceState(Q,"",ae),c&&x&&x({action:i,location:I.location,delta:0})}function U(V){return ule(V)}let I={get action(){return i},get location(){return e(a,h)},listen(V){if(x)throw new Error("A history only accepts one active listener");return a.addEventListener(LB,T),x=V,()=>{a.removeEventListener(LB,T),x=null}},createHref(V){return t(a,V)},createURL:U,encodeLocation(V){let H=U(V);return{pathname:H.pathname,search:H.search,hash:H.hash}},push:E,replace:D,go(V){return h.go(V)}};return I}function ule(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Cs(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:T1(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function XW(e,t,r="/"){return dle(e,t,r,!1)}function dle(e,t,r,n){let a=typeof t=="string"?p_(t):t,c=wm(a.pathname||"/",r);if(c==null)return null;let h=JW(e);hle(h);let i=null;for(let x=0;i==null&&x<h.length;++x){let w=Sle(c);i=ble(h[x],w,n)}return i}function JW(e,t=[],r=[],n="",a=!1){let c=(h,i,x=a,w)=>{let S={relativePath:w===void 0?h.path||"":w,caseSensitive:h.caseSensitive===!0,childrenIndex:i,route:h};if(S.relativePath.startsWith("/")){if(!S.relativePath.startsWith(n)&&x)return;Cs(S.relativePath.startsWith(n),`Absolute route path "${S.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),S.relativePath=S.relativePath.slice(n.length)}let T=ym([n,S.relativePath]),E=r.concat(S);h.children&&h.children.length>0&&(Cs(h.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${T}".`),JW(h.children,t,E,T,x)),!(h.path==null&&!h.index)&&t.push({path:T,score:vle(T,h.index),routesMeta:E})};return e.forEach((h,i)=>{var x;if(h.path===""||!((x=h.path)!=null&&x.includes("?")))c(h,i);else for(let w of QW(h.path))c(h,i,!0,w)}),t}function QW(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),c=r.replace(/\?$/,"");if(n.length===0)return a?[c,""]:[c];let h=QW(n.join("/")),i=[];return i.push(...h.map(x=>x===""?c:[c,x].join("/"))),a&&i.push(...h),i.map(x=>e.startsWith("/")&&x===""?"/":x)}function hle(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:_le(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var fle=/^:[\w-]+$/,ple=3,mle=2,gle=1,yle=10,xle=-2,FB=e=>e==="*";function vle(e,t){let r=e.split("/"),n=r.length;return r.some(FB)&&(n+=xle),t&&(n+=mle),r.filter(a=>!FB(a)).reduce((a,c)=>a+(fle.test(c)?ple:c===""?gle:yle),n)}function _le(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function ble(e,t,r=!1){let{routesMeta:n}=e,a={},c="/",h=[];for(let i=0;i<n.length;++i){let x=n[i],w=i===n.length-1,S=c==="/"?t:t.slice(c.length)||"/",T=LN({path:x.relativePath,caseSensitive:x.caseSensitive,end:w},S),E=x.route;if(!T&&w&&r&&!n[n.length-1].route.index&&(T=LN({path:x.relativePath,caseSensitive:x.caseSensitive,end:!1},S)),!T)return null;Object.assign(a,T.params),h.push({params:a,pathname:ym([c,T.pathname]),pathnameBase:jle(ym([c,T.pathnameBase])),route:E}),T.pathnameBase!=="/"&&(c=ym([c,T.pathnameBase]))}return h}function LN(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=wle(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let c=a[0],h=c.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:n.reduce((w,{paramName:S,isOptional:T},E)=>{if(S==="*"){let U=i[E]||"";h=c.slice(0,c.length-U.length).replace(/(.)\/+$/,"$1")}const D=i[E];return T&&!D?w[S]=void 0:w[S]=(D||"").replace(/%2F/g,"/"),w},{}),pathname:c,pathnameBase:h,pattern:e}}function wle(e,t=!1,r=!0){Hh(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,i,x)=>(n.push({paramName:i,isOptional:x!=null}),x?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function Sle(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Hh(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function wm(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Nle(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?p_(e):e;return{pathname:r?r.startsWith("/")?r:Ale(r,t):t,search:kle(n),hash:Ple(a)}}function Ale(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function iP(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Tle(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function W3(e){let t=Tle(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function H3(e,t,r,n=!1){let a;typeof e=="string"?a=p_(e):(a={...e},Cs(!a.pathname||!a.pathname.includes("?"),iP("?","pathname","search",a)),Cs(!a.pathname||!a.pathname.includes("#"),iP("#","pathname","hash",a)),Cs(!a.search||!a.search.includes("#"),iP("#","search","hash",a)));let c=e===""||a.pathname==="",h=c?"/":a.pathname,i;if(h==null)i=r;else{let T=t.length-1;if(!n&&h.startsWith("..")){let E=h.split("/");for(;E[0]==="..";)E.shift(),T-=1;a.pathname=E.join("/")}i=T>=0?t[T]:"/"}let x=Nle(a,i),w=h&&h!=="/"&&h.endsWith("/"),S=(c||h===".")&&r.endsWith("/");return!x.pathname.endsWith("/")&&(w||S)&&(x.pathname+="/"),x}var ym=e=>e.join("/").replace(/\/\/+/g,"/"),jle=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),kle=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Ple=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Cle(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var eH=["POST","PUT","PATCH","DELETE"];new Set(eH);var Ele=["GET",...eH];new Set(Ele);var m_=G.createContext(null);m_.displayName="DataRouter";var wT=G.createContext(null);wT.displayName="DataRouterState";G.createContext(!1);var tH=G.createContext({isTransitioning:!1});tH.displayName="ViewTransition";var Mle=G.createContext(new Map);Mle.displayName="Fetchers";var Ole=G.createContext(null);Ole.displayName="Await";var tf=G.createContext(null);tf.displayName="Navigation";var qw=G.createContext(null);qw.displayName="Location";var $d=G.createContext({outlet:null,matches:[],isDataRoute:!1});$d.displayName="Route";var K3=G.createContext(null);K3.displayName="RouteError";function Rle(e,{relative:t}={}){Cs(g_(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=G.useContext(tf),{hash:a,pathname:c,search:h}=Gw(e,{relative:t}),i=c;return r!=="/"&&(i=c==="/"?r:ym([r,c])),n.createHref({pathname:i,search:h,hash:a})}function g_(){return G.useContext(qw)!=null}function Co(){return Cs(g_(),"useLocation() may be used only in the context of a <Router> component."),G.useContext(qw).location}var rH="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function nH(e){G.useContext(tf).static||G.useLayoutEffect(e)}function Ba(){let{isDataRoute:e}=G.useContext($d);return e?Zle():Ile()}function Ile(){Cs(g_(),"useNavigate() may be used only in the context of a <Router> component.");let e=G.useContext(m_),{basename:t,navigator:r}=G.useContext(tf),{matches:n}=G.useContext($d),{pathname:a}=Co(),c=JSON.stringify(W3(n)),h=G.useRef(!1);return nH(()=>{h.current=!0}),G.useCallback((x,w={})=>{if(Hh(h.current,rH),!h.current)return;if(typeof x=="number"){r.go(x);return}let S=H3(x,JSON.parse(c),a,w.relative==="path");e==null&&t!=="/"&&(S.pathname=S.pathname==="/"?t:ym([t,S.pathname])),(w.replace?r.replace:r.push)(S,w.state,w)},[t,r,c,a,e])}var Lle=G.createContext(null);function Dle(e){let t=G.useContext($d).outlet;return G.useMemo(()=>t&&G.createElement(Lle.Provider,{value:e},t),[t,e])}function J0(){let{matches:e}=G.useContext($d),t=e[e.length-1];return t?t.params:{}}function Gw(e,{relative:t}={}){let{matches:r}=G.useContext($d),{pathname:n}=Co(),a=JSON.stringify(W3(r));return G.useMemo(()=>H3(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function Fle(e,t){return iH(e,t)}function iH(e,t,r,n,a){var K;Cs(g_(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=G.useContext(tf),{matches:h}=G.useContext($d),i=h[h.length-1],x=i?i.params:{},w=i?i.pathname:"/",S=i?i.pathnameBase:"/",T=i&&i.route;{let Q=T&&T.path||"";aH(w,!T||Q.endsWith("*")||Q.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${w}" (under <Route path="${Q}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Q}"> to <Route path="${Q==="/"?"*":`${Q}/*`}">.`)}let E=Co(),D;if(t){let Q=typeof t=="string"?p_(t):t;Cs(S==="/"||((K=Q.pathname)==null?void 0:K.startsWith(S)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${S}" but pathname "${Q.pathname}" was given in the \`location\` prop.`),D=Q}else D=E;let U=D.pathname||"/",I=U;if(S!=="/"){let Q=S.replace(/^\//,"").split("/");I="/"+U.replace(/^\//,"").split("/").slice(Q.length).join("/")}let V=XW(e,{pathname:I});Hh(T||V!=null,`No routes matched location "${D.pathname}${D.search}${D.hash}" `),Hh(V==null||V[V.length-1].route.element!==void 0||V[V.length-1].route.Component!==void 0||V[V.length-1].route.lazy!==void 0,`Matched leaf route at location "${D.pathname}${D.search}${D.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let H=$le(V&&V.map(Q=>Object.assign({},Q,{params:Object.assign({},x,Q.params),pathname:ym([S,c.encodeLocation?c.encodeLocation(Q.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Q.pathname]),pathnameBase:Q.pathnameBase==="/"?S:ym([S,c.encodeLocation?c.encodeLocation(Q.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Q.pathnameBase])})),h,r,n,a);return t&&H?G.createElement(qw.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...D},navigationType:"POP"}},H):H}function zle(){let e=Kle(),t=Cle(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},c={padding:"2px 4px",backgroundColor:n},h=null;return console.error("Error handled by React Router default ErrorBoundary:",e),h=G.createElement(G.Fragment,null,G.createElement("p",null," Hey developer "),G.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",G.createElement("code",{style:c},"ErrorBoundary")," or"," ",G.createElement("code",{style:c},"errorElement")," prop on your route.")),G.createElement(G.Fragment,null,G.createElement("h2",null,"Unexpected Application Error!"),G.createElement("h3",{style:{fontStyle:"italic"}},t),r?G.createElement("pre",{style:a},r):null,h)}var Ble=G.createElement(zle,null),Vle=class extends G.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?G.createElement($d.Provider,{value:this.props.routeContext},G.createElement(K3.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Ule({routeContext:e,match:t,children:r}){let n=G.useContext(m_);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),G.createElement($d.Provider,{value:e},r)}function $le(e,t=[],r=null,n=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let c=e,h=r==null?void 0:r.errors;if(h!=null){let w=c.findIndex(S=>S.route.id&&(h==null?void 0:h[S.route.id])!==void 0);Cs(w>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(h).join(",")}`),c=c.slice(0,Math.min(c.length,w+1))}let i=!1,x=-1;if(r)for(let w=0;w<c.length;w++){let S=c[w];if((S.route.HydrateFallback||S.route.hydrateFallbackElement)&&(x=w),S.route.id){let{loaderData:T,errors:E}=r,D=S.route.loader&&!T.hasOwnProperty(S.route.id)&&(!E||E[S.route.id]===void 0);if(S.route.lazy||D){i=!0,x>=0?c=c.slice(0,x+1):c=[c[0]];break}}}return c.reduceRight((w,S,T)=>{let E,D=!1,U=null,I=null;r&&(E=h&&S.route.id?h[S.route.id]:void 0,U=S.route.errorElement||Ble,i&&(x<0&&T===0?(aH("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),D=!0,I=null):x===T&&(D=!0,I=S.route.hydrateFallbackElement||null)));let V=t.concat(c.slice(0,T+1)),H=()=>{let K;return E?K=U:D?K=I:S.route.Component?K=G.createElement(S.route.Component,null):S.route.element?K=S.route.element:K=w,G.createElement(Ule,{match:S,routeContext:{outlet:w,matches:V,isDataRoute:r!=null},children:K})};return r&&(S.route.ErrorBoundary||S.route.errorElement||T===0)?G.createElement(Vle,{location:r.location,revalidation:r.revalidation,component:U,error:E,children:H(),routeContext:{outlet:null,matches:V,isDataRoute:!0},unstable_onError:n}):H()},null)}function Z3(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function qle(e){let t=G.useContext(m_);return Cs(t,Z3(e)),t}function Gle(e){let t=G.useContext(wT);return Cs(t,Z3(e)),t}function Wle(e){let t=G.useContext($d);return Cs(t,Z3(e)),t}function Y3(e){let t=Wle(e),r=t.matches[t.matches.length-1];return Cs(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function Hle(){return Y3("useRouteId")}function Kle(){var n;let e=G.useContext(K3),t=Gle("useRouteError"),r=Y3("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function Zle(){let{router:e}=qle("useNavigate"),t=Y3("useNavigate"),r=G.useRef(!1);return nH(()=>{r.current=!0}),G.useCallback(async(a,c={})=>{Hh(r.current,rH),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...c}))},[e,t])}var zB={};function aH(e,t,r){!t&&!zB[e]&&(zB[e]=!0,Hh(!1,r))}G.memo(Yle);function Yle({routes:e,future:t,state:r,unstable_onError:n}){return iH(e,void 0,r,n,t)}function X3({to:e,replace:t,state:r,relative:n}){Cs(g_(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=G.useContext(tf);Hh(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=G.useContext($d),{pathname:h}=Co(),i=Ba(),x=H3(e,W3(c),h,n==="path"),w=JSON.stringify(x);return G.useEffect(()=>{i(JSON.parse(w),{replace:t,state:r,relative:n})},[i,w,n,t,r]),null}function sH(e){return Dle(e.context)}function Da(e){Cs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Xle({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:c=!1}){Cs(!g_(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=e.replace(/^\/*/,"/"),i=G.useMemo(()=>({basename:h,navigator:a,static:c,future:{}}),[h,a,c]);typeof r=="string"&&(r=p_(r));let{pathname:x="/",search:w="",hash:S="",state:T=null,key:E="default"}=r,D=G.useMemo(()=>{let U=wm(x,h);return U==null?null:{location:{pathname:U,search:w,hash:S,state:T,key:E},navigationType:n}},[h,x,w,S,T,E,n]);return Hh(D!=null,`<Router basename="${h}"> is not able to match the URL "${x}${w}${S}" because it does not start with the basename, so the <Router> won't render anything.`),D==null?null:G.createElement(tf.Provider,{value:i},G.createElement(qw.Provider,{children:t,value:D}))}function Jle({children:e,location:t}){return Fle(sR(e),t)}function sR(e,t=[]){let r=[];return G.Children.forEach(e,(n,a)=>{if(!G.isValidElement(n))return;let c=[...t,a];if(n.type===G.Fragment){r.push.apply(r,sR(n.props.children,c));return}Cs(n.type===Da,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Cs(!n.props.index||!n.props.children,"An index route cannot have child routes.");let h={id:n.props.id||c.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(h.children=sR(n.props.children,c)),r.push(h)}),r}var xN="get",vN="application/x-www-form-urlencoded";function ST(e){return e!=null&&typeof e.tagName=="string"}function Qle(e){return ST(e)&&e.tagName.toLowerCase()==="button"}function ece(e){return ST(e)&&e.tagName.toLowerCase()==="form"}function tce(e){return ST(e)&&e.tagName.toLowerCase()==="input"}function rce(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function nce(e,t){return e.button===0&&(!t||t==="_self")&&!rce(e)}var OS=null;function ice(){if(OS===null)try{new FormData(document.createElement("form"),0),OS=!1}catch{OS=!0}return OS}var ace=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function aP(e){return e!=null&&!ace.has(e)?(Hh(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${vN}"`),null):e}function sce(e,t){let r,n,a,c,h;if(ece(e)){let i=e.getAttribute("action");n=i?wm(i,t):null,r=e.getAttribute("method")||xN,a=aP(e.getAttribute("enctype"))||vN,c=new FormData(e)}else if(Qle(e)||tce(e)&&(e.type==="submit"||e.type==="image")){let i=e.form;if(i==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let x=e.getAttribute("formaction")||i.getAttribute("action");if(n=x?wm(x,t):null,r=e.getAttribute("formmethod")||i.getAttribute("method")||xN,a=aP(e.getAttribute("formenctype"))||aP(i.getAttribute("enctype"))||vN,c=new FormData(i,e),!ice()){let{name:w,type:S,value:T}=e;if(S==="image"){let E=w?`${w}.`:"";c.append(`${E}x`,"0"),c.append(`${E}y`,"0")}else w&&c.append(w,T)}}else{if(ST(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=xN,n=null,a=vN,h=e}return c&&a==="text/plain"&&(h=c,c=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:c,body:h}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function J3(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function oce(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&wm(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function lce(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function cce(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function uce(e,t,r){let n=await Promise.all(e.map(async a=>{let c=t.routes[a.route.id];if(c){let h=await lce(c,r);return h.links?h.links():[]}return[]}));return pce(n.flat(1).filter(cce).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function BB(e,t,r,n,a,c){let h=(x,w)=>r[w]?x.route.id!==r[w].route.id:!0,i=(x,w)=>{var S;return r[w].pathname!==x.pathname||((S=r[w].route.path)==null?void 0:S.endsWith("*"))&&r[w].params["*"]!==x.params["*"]};return c==="assets"?t.filter((x,w)=>h(x,w)||i(x,w)):c==="data"?t.filter((x,w)=>{var T;let S=n.routes[x.route.id];if(!S||!S.hasLoader)return!1;if(h(x,w)||i(x,w))return!0;if(x.route.shouldRevalidate){let E=x.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((T=r[0])==null?void 0:T.params)||{},nextUrl:new URL(e,window.origin),nextParams:x.params,defaultShouldRevalidate:!0});if(typeof E=="boolean")return E}return!0}):[]}function dce(e,t,{includeHydrateFallback:r}={}){return hce(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let c=[a.module];return a.clientActionModule&&(c=c.concat(a.clientActionModule)),a.clientLoaderModule&&(c=c.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(c=c.concat(a.hydrateFallbackModule)),a.imports&&(c=c.concat(a.imports)),c}).flat(1))}function hce(e){return[...new Set(e)]}function fce(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function pce(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let c=JSON.stringify(fce(a));return r.has(c)||(r.add(c),n.push({key:c,link:a})),n},[])}function oH(){let e=G.useContext(m_);return J3(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function mce(){let e=G.useContext(wT);return J3(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Q3=G.createContext(void 0);Q3.displayName="FrameworkContext";function lH(){let e=G.useContext(Q3);return J3(e,"You must render this element inside a <HydratedRouter> element"),e}function gce(e,t){let r=G.useContext(Q3),[n,a]=G.useState(!1),[c,h]=G.useState(!1),{onFocus:i,onBlur:x,onMouseEnter:w,onMouseLeave:S,onTouchStart:T}=t,E=G.useRef(null);G.useEffect(()=>{if(e==="render"&&h(!0),e==="viewport"){let I=H=>{H.forEach(K=>{h(K.isIntersecting)})},V=new IntersectionObserver(I,{threshold:.5});return E.current&&V.observe(E.current),()=>{V.disconnect()}}},[e]),G.useEffect(()=>{if(n){let I=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(I)}}},[n]);let D=()=>{a(!0)},U=()=>{a(!1),h(!1)};return r?e!=="intent"?[c,E,{}]:[c,E,{onFocus:Ib(i,D),onBlur:Ib(x,U),onMouseEnter:Ib(w,D),onMouseLeave:Ib(S,U),onTouchStart:Ib(T,D)}]:[!1,E,{}]}function Ib(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function yce({page:e,...t}){let{router:r}=oH(),n=G.useMemo(()=>XW(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?G.createElement(vce,{page:e,matches:n,...t}):null}function xce(e){let{manifest:t,routeModules:r}=lH(),[n,a]=G.useState([]);return G.useEffect(()=>{let c=!1;return uce(e,t,r).then(h=>{c||a(h)}),()=>{c=!0}},[e,t,r]),n}function vce({page:e,matches:t,...r}){let n=Co(),{manifest:a,routeModules:c}=lH(),{basename:h}=oH(),{loaderData:i,matches:x}=mce(),w=G.useMemo(()=>BB(e,t,x,a,n,"data"),[e,t,x,a,n]),S=G.useMemo(()=>BB(e,t,x,a,n,"assets"),[e,t,x,a,n]),T=G.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let U=new Set,I=!1;if(t.forEach(H=>{var Q;let K=a.routes[H.route.id];!K||!K.hasLoader||(!w.some(ae=>ae.route.id===H.route.id)&&H.route.id in i&&((Q=c[H.route.id])!=null&&Q.shouldRevalidate)||K.hasClientLoader?I=!0:U.add(H.route.id))}),U.size===0)return[];let V=oce(e,h,"data");return I&&U.size>0&&V.searchParams.set("_routes",t.filter(H=>U.has(H.route.id)).map(H=>H.route.id).join(",")),[V.pathname+V.search]},[h,i,n,a,w,t,e,c]),E=G.useMemo(()=>dce(S,a),[S,a]),D=xce(S);return G.createElement(G.Fragment,null,T.map(U=>G.createElement("link",{key:U,rel:"prefetch",as:"fetch",href:U,...r})),E.map(U=>G.createElement("link",{key:U,rel:"modulepreload",href:U,...r})),D.map(({key:U,link:I})=>G.createElement("link",{key:U,nonce:r.nonce,...I})))}function _ce(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var cH=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{cH&&(window.__reactRouterVersion="7.9.5")}catch{}function bce({basename:e,children:t,window:r}){let n=G.useRef();n.current==null&&(n.current=ole({window:r,v5Compat:!0}));let a=n.current,[c,h]=G.useState({action:a.action,location:a.location}),i=G.useCallback(x=>{G.startTransition(()=>h(x))},[h]);return G.useLayoutEffect(()=>a.listen(i),[a,i]),G.createElement(Xle,{basename:e,children:t,location:c.location,navigationType:c.action,navigator:a})}var uH=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,To=G.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:c,replace:h,state:i,target:x,to:w,preventScrollReset:S,viewTransition:T,...E},D){let{basename:U}=G.useContext(tf),I=typeof w=="string"&&uH.test(w),V,H=!1;if(typeof w=="string"&&I&&(V=w,cH))try{let Ce=new URL(window.location.href),Ne=w.startsWith("//")?new URL(Ce.protocol+w):new URL(w),me=wm(Ne.pathname,U);Ne.origin===Ce.origin&&me!=null?w=me+Ne.search+Ne.hash:H=!0}catch{Hh(!1,`<Link to="${w}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let K=Rle(w,{relative:a}),[Q,ae,ee]=gce(n,E),se=Ace(w,{replace:h,state:i,target:x,preventScrollReset:S,relative:a,viewTransition:T});function ue(Ce){t&&t(Ce),Ce.defaultPrevented||se(Ce)}let he=G.createElement("a",{...E,...ee,href:V||K,onClick:H||c?t:ue,ref:_ce(D,ae),target:x,"data-discover":!I&&r==="render"?"true":void 0});return Q&&!I?G.createElement(G.Fragment,null,he,G.createElement(yce,{page:K})):he});To.displayName="Link";var wce=G.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:c,to:h,viewTransition:i,children:x,...w},S){let T=Gw(h,{relative:w.relative}),E=Co(),D=G.useContext(wT),{navigator:U,basename:I}=G.useContext(tf),V=D!=null&&Cce(T)&&i===!0,H=U.encodeLocation?U.encodeLocation(T).pathname:T.pathname,K=E.pathname,Q=D&&D.navigation&&D.navigation.location?D.navigation.location.pathname:null;r||(K=K.toLowerCase(),Q=Q?Q.toLowerCase():null,H=H.toLowerCase()),Q&&I&&(Q=wm(Q,I)||Q);const ae=H!=="/"&&H.endsWith("/")?H.length-1:H.length;let ee=K===H||!a&&K.startsWith(H)&&K.charAt(ae)==="/",se=Q!=null&&(Q===H||!a&&Q.startsWith(H)&&Q.charAt(H.length)==="/"),ue={isActive:ee,isPending:se,isTransitioning:V},he=ee?t:void 0,Ce;typeof n=="function"?Ce=n(ue):Ce=[n,ee?"active":null,se?"pending":null,V?"transitioning":null].filter(Boolean).join(" ");let Ne=typeof c=="function"?c(ue):c;return G.createElement(To,{...w,"aria-current":he,className:Ce,ref:S,style:Ne,to:h,viewTransition:i},typeof x=="function"?x(ue):x)});wce.displayName="NavLink";var Sce=G.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:c,method:h=xN,action:i,onSubmit:x,relative:w,preventScrollReset:S,viewTransition:T,...E},D)=>{let U=kce(),I=Pce(i,{relative:w}),V=h.toLowerCase()==="get"?"get":"post",H=typeof i=="string"&&uH.test(i),K=Q=>{if(x&&x(Q),Q.defaultPrevented)return;Q.preventDefault();let ae=Q.nativeEvent.submitter,ee=(ae==null?void 0:ae.getAttribute("formmethod"))||h;U(ae||Q.currentTarget,{fetcherKey:t,method:ee,navigate:r,replace:a,state:c,relative:w,preventScrollReset:S,viewTransition:T})};return G.createElement("form",{ref:D,method:V,action:I,onSubmit:n?x:K,...E,"data-discover":!H&&e==="render"?"true":void 0})});Sce.displayName="Form";function Nce(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function dH(e){let t=G.useContext(m_);return Cs(t,Nce(e)),t}function Ace(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:c,viewTransition:h}={}){let i=Ba(),x=Co(),w=Gw(e,{relative:c});return G.useCallback(S=>{if(nce(S,t)){S.preventDefault();let T=r!==void 0?r:T1(x)===T1(w);i(e,{replace:T,state:n,preventScrollReset:a,relative:c,viewTransition:h})}},[x,i,w,r,n,t,e,a,c,h])}var Tce=0,jce=()=>`__${String(++Tce)}__`;function kce(){let{router:e}=dH("useSubmit"),{basename:t}=G.useContext(tf),r=Hle();return G.useCallback(async(n,a={})=>{let{action:c,method:h,encType:i,formData:x,body:w}=sce(n,t);if(a.navigate===!1){let S=a.fetcherKey||jce();await e.fetch(S,r,a.action||c,{preventScrollReset:a.preventScrollReset,formData:x,body:w,formMethod:a.method||h,formEncType:a.encType||i,flushSync:a.flushSync})}else await e.navigate(a.action||c,{preventScrollReset:a.preventScrollReset,formData:x,body:w,formMethod:a.method||h,formEncType:a.encType||i,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function Pce(e,{relative:t}={}){let{basename:r}=G.useContext(tf),n=G.useContext($d);Cs(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),c={...Gw(e||".",{relative:t})},h=Co();if(e==null){c.search=h.search;let i=new URLSearchParams(c.search),x=i.getAll("index");if(x.some(S=>S==="")){i.delete("index"),x.filter(T=>T).forEach(T=>i.append("index",T));let S=i.toString();c.search=S?`?${S}`:""}}return(!e||e===".")&&a.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(c.pathname=c.pathname==="/"?r:ym([r,c.pathname])),T1(c)}function Cce(e,{relative:t}={}){let r=G.useContext(tH);Cs(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=dH("useViewTransitionState"),a=Gw(e,{relative:t});if(!r.isTransitioning)return!1;let c=wm(r.currentLocation.pathname,n)||r.currentLocation.pathname,h=wm(r.nextLocation.pathname,n)||r.nextLocation.pathname;return LN(a.pathname,h)!=null||LN(a.pathname,c)!=null}function VB(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function NT(...e){return t=>{let r=!1;const n=e.map(a=>{const c=VB(a,t);return!r&&typeof c=="function"&&(r=!0),c});if(r)return()=>{for(let a=0;a<n.length;a++){const c=n[a];typeof c=="function"?c():VB(e[a],null)}}}}function ta(...e){return G.useCallback(NT(...e),e)}var nc=G.forwardRef((e,t)=>{const{children:r,...n}=e,a=G.Children.toArray(r),c=a.find(Ece);if(c){const h=c.props.children,i=a.map(x=>x===c?G.Children.count(h)>1?G.Children.only(null):G.isValidElement(h)?h.props.children:null:x);return o.jsx(oR,{...n,ref:t,children:G.isValidElement(h)?G.cloneElement(h,void 0,i):null})}return o.jsx(oR,{...n,ref:t,children:r})});nc.displayName="Slot";var oR=G.forwardRef((e,t)=>{const{children:r,...n}=e;if(G.isValidElement(r)){const a=Oce(r),c=Mce(n,r.props);return r.type!==G.Fragment&&(c.ref=t?NT(t,a):a),G.cloneElement(r,c)}return G.Children.count(r)>1?G.Children.only(null):null});oR.displayName="SlotClone";var e4=({children:e})=>o.jsx(o.Fragment,{children:e});function Ece(e){return G.isValidElement(e)&&e.type===e4}function Mce(e,t){const r={...t};for(const n in t){const a=e[n],c=t[n];/^on[A-Z]/.test(n)?a&&c?r[n]=(...i)=>{c(...i),a(...i)}:a&&(r[n]=a):n==="style"?r[n]={...a,...c}:n==="className"&&(r[n]=[a,c].filter(Boolean).join(" "))}return{...e,...r}}function Oce(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function hH(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=hH(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function di(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=hH(e))&&(n&&(n+=" "),n+=t);return n}const UB=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,$B=di,Ww=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return $B(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:c}=t,h=Object.keys(a).map(w=>{const S=r==null?void 0:r[w],T=c==null?void 0:c[w];if(S===null)return null;const E=UB(S)||UB(T);return a[w][E]}),i=r&&Object.entries(r).reduce((w,S)=>{let[T,E]=S;return E===void 0||(w[T]=E),w},{}),x=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((w,S)=>{let{class:T,className:E,...D}=S;return Object.entries(D).every(U=>{let[I,V]=U;return Array.isArray(V)?V.includes({...c,...i}[I]):{...c,...i}[I]===V})?[...w,T,E]:w},[]);return $B(e,h,x,r==null?void 0:r.class,r==null?void 0:r.className)},t4="-",Rce=e=>{const t=Lce(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:h=>{const i=h.split(t4);return i[0]===""&&i.length!==1&&i.shift(),fH(i,t)||Ice(h)},getConflictingClassGroupIds:(h,i)=>{const x=r[h]||[];return i&&n[h]?[...x,...n[h]]:x}}},fH=(e,t)=>{var h;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?fH(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const c=e.join(t4);return(h=t.validators.find(({validator:i})=>i(c)))==null?void 0:h.classGroupId},qB=/^\[(.+)\]$/,Ice=e=>{if(qB.test(e)){const t=qB.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},Lce=e=>{const{theme:t,classGroups:r}=e,n={nextPart:new Map,validators:[]};for(const a in r)lR(r[a],n,a,t);return n},lR=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const c=a===""?t:GB(t,a);c.classGroupId=r;return}if(typeof a=="function"){if(Dce(a)){lR(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([c,h])=>{lR(h,GB(t,c),r,n)})})},GB=(e,t)=>{let r=e;return t.split(t4).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Dce=e=>e.isThemeGetter,Fce=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(c,h)=>{r.set(c,h),t++,t>e&&(t=0,n=r,r=new Map)};return{get(c){let h=r.get(c);if(h!==void 0)return h;if((h=n.get(c))!==void 0)return a(c,h),h},set(c,h){r.has(c)?r.set(c,h):a(c,h)}}},cR="!",uR=":",zce=uR.length,Bce=e=>{const{prefix:t,experimentalParseClassName:r}=e;let n=a=>{const c=[];let h=0,i=0,x=0,w;for(let U=0;U<a.length;U++){let I=a[U];if(h===0&&i===0){if(I===uR){c.push(a.slice(x,U)),x=U+zce;continue}if(I==="/"){w=U;continue}}I==="["?h++:I==="]"?h--:I==="("?i++:I===")"&&i--}const S=c.length===0?a:a.substring(x),T=Vce(S),E=T!==S,D=w&&w>x?w-x:void 0;return{modifiers:c,hasImportantModifier:E,baseClassName:T,maybePostfixModifierPosition:D}};if(t){const a=t+uR,c=n;n=h=>h.startsWith(a)?c(h.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:h,maybePostfixModifierPosition:void 0}}if(r){const a=n;n=c=>r({className:c,parseClassName:a})}return n},Vce=e=>e.endsWith(cR)?e.substring(0,e.length-1):e.startsWith(cR)?e.substring(1):e,Uce=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const a=[];let c=[];return n.forEach(h=>{h[0]==="["||t[h]?(a.push(...c.sort(),h),c=[]):c.push(h)}),a.push(...c.sort()),a}},$ce=e=>({cache:Fce(e.cacheSize),parseClassName:Bce(e),sortModifiers:Uce(e),...Rce(e)}),qce=/\s+/,Gce=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a,sortModifiers:c}=t,h=[],i=e.trim().split(qce);let x="";for(let w=i.length-1;w>=0;w-=1){const S=i[w],{isExternal:T,modifiers:E,hasImportantModifier:D,baseClassName:U,maybePostfixModifierPosition:I}=r(S);if(T){x=S+(x.length>0?" "+x:x);continue}let V=!!I,H=n(V?U.substring(0,I):U);if(!H){if(!V){x=S+(x.length>0?" "+x:x);continue}if(H=n(U),!H){x=S+(x.length>0?" "+x:x);continue}V=!1}const K=c(E).join(":"),Q=D?K+cR:K,ae=Q+H;if(h.includes(ae))continue;h.push(ae);const ee=a(H,V);for(let se=0;se<ee.length;++se){const ue=ee[se];h.push(Q+ue)}x=S+(x.length>0?" "+x:x)}return x};function Wce(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=pH(t))&&(n&&(n+=" "),n+=r);return n}const pH=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=pH(e[n]))&&(r&&(r+=" "),r+=t);return r};function Hce(e,...t){let r,n,a,c=h;function h(x){const w=t.reduce((S,T)=>T(S),e());return r=$ce(w),n=r.cache.get,a=r.cache.set,c=i,i(x)}function i(x){const w=n(x);if(w)return w;const S=Gce(x,r);return a(x,S),S}return function(){return c(Wce.apply(null,arguments))}}const ll=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},mH=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,gH=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Kce=/^\d+\/\d+$/,Zce=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Yce=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Xce=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Jce=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Qce=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Zx=e=>Kce.test(e),Di=e=>!!e&&!Number.isNaN(Number(e)),u0=e=>!!e&&Number.isInteger(Number(e)),WB=e=>e.endsWith("%")&&Di(e.slice(0,-1)),Ig=e=>Zce.test(e),eue=()=>!0,tue=e=>Yce.test(e)&&!Xce.test(e),r4=()=>!1,rue=e=>Jce.test(e),nue=e=>Qce.test(e),iue=e=>!_n(e)&&!bn(e),aue=e=>y_(e,vH,r4),_n=e=>mH.test(e),d0=e=>y_(e,_H,tue),sP=e=>y_(e,gue,Di),sue=e=>y_(e,yH,r4),oue=e=>y_(e,xH,nue),lue=e=>y_(e,r4,rue),bn=e=>gH.test(e),RS=e=>x_(e,_H),cue=e=>x_(e,yue),uue=e=>x_(e,yH),due=e=>x_(e,vH),hue=e=>x_(e,xH),fue=e=>x_(e,xue,!0),y_=(e,t,r)=>{const n=mH.exec(e);return n?n[1]?t(n[1]):r(n[2]):!1},x_=(e,t,r=!1)=>{const n=gH.exec(e);return n?n[1]?t(n[1]):r:!1},yH=e=>e==="position",pue=new Set(["image","url"]),xH=e=>pue.has(e),mue=new Set(["length","size","percentage"]),vH=e=>mue.has(e),_H=e=>e==="length",gue=e=>e==="number",yue=e=>e==="family-name",xue=e=>e==="shadow",vue=()=>{const e=ll("color"),t=ll("font"),r=ll("text"),n=ll("font-weight"),a=ll("tracking"),c=ll("leading"),h=ll("breakpoint"),i=ll("container"),x=ll("spacing"),w=ll("radius"),S=ll("shadow"),T=ll("inset-shadow"),E=ll("drop-shadow"),D=ll("blur"),U=ll("perspective"),I=ll("aspect"),V=ll("ease"),H=ll("animate"),K=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Q=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ae=()=>["auto","hidden","clip","visible","scroll"],ee=()=>["auto","contain","none"],se=()=>[bn,_n,x],ue=()=>[Zx,"full","auto",...se()],he=()=>[u0,"none","subgrid",bn,_n],Ce=()=>["auto",{span:["full",u0,bn,_n]},bn,_n],Ne=()=>[u0,"auto",bn,_n],me=()=>["auto","min","max","fr",bn,_n],be=()=>["start","end","center","between","around","evenly","stretch","baseline"],pe=()=>["start","end","center","stretch"],Se=()=>["auto",...se()],Ee=()=>[Zx,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...se()],we=()=>[e,bn,_n],Pe=()=>[WB,d0],Me=()=>["","none","full",w,bn,_n],Be=()=>["",Di,RS,d0],Ge=()=>["solid","dashed","dotted","double"],We=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],tt=()=>["","none",D,bn,_n],nt=()=>["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",bn,_n],Dt=()=>["none",Di,bn,_n],nr=()=>["none",Di,bn,_n],ir=()=>[Di,bn,_n],rr=()=>[Zx,"full",...se()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Ig],breakpoint:[Ig],color:[eue],container:[Ig],"drop-shadow":[Ig],ease:["in","out","in-out"],font:[iue],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Ig],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Ig],shadow:[Ig],spacing:["px",Di],text:[Ig],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Zx,_n,bn,I]}],container:["container"],columns:[{columns:[Di,_n,bn,i]}],"break-after":[{"break-after":K()}],"break-before":[{"break-before":K()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Q(),_n,bn]}],overflow:[{overflow:ae()}],"overflow-x":[{"overflow-x":ae()}],"overflow-y":[{"overflow-y":ae()}],overscroll:[{overscroll:ee()}],"overscroll-x":[{"overscroll-x":ee()}],"overscroll-y":[{"overscroll-y":ee()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:ue()}],"inset-x":[{"inset-x":ue()}],"inset-y":[{"inset-y":ue()}],start:[{start:ue()}],end:[{end:ue()}],top:[{top:ue()}],right:[{right:ue()}],bottom:[{bottom:ue()}],left:[{left:ue()}],visibility:["visible","invisible","collapse"],z:[{z:[u0,"auto",bn,_n]}],basis:[{basis:[Zx,"full","auto",i,...se()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Di,Zx,"auto","initial","none",_n]}],grow:[{grow:["",Di,bn,_n]}],shrink:[{shrink:["",Di,bn,_n]}],order:[{order:[u0,"first","last","none",bn,_n]}],"grid-cols":[{"grid-cols":he()}],"col-start-end":[{col:Ce()}],"col-start":[{"col-start":Ne()}],"col-end":[{"col-end":Ne()}],"grid-rows":[{"grid-rows":he()}],"row-start-end":[{row:Ce()}],"row-start":[{"row-start":Ne()}],"row-end":[{"row-end":Ne()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":me()}],"auto-rows":[{"auto-rows":me()}],gap:[{gap:se()}],"gap-x":[{"gap-x":se()}],"gap-y":[{"gap-y":se()}],"justify-content":[{justify:[...be(),"normal"]}],"justify-items":[{"justify-items":[...pe(),"normal"]}],"justify-self":[{"justify-self":["auto",...pe()]}],"align-content":[{content:["normal",...be()]}],"align-items":[{items:[...pe(),"baseline"]}],"align-self":[{self:["auto",...pe(),"baseline"]}],"place-content":[{"place-content":be()}],"place-items":[{"place-items":[...pe(),"baseline"]}],"place-self":[{"place-self":["auto",...pe()]}],p:[{p:se()}],px:[{px:se()}],py:[{py:se()}],ps:[{ps:se()}],pe:[{pe:se()}],pt:[{pt:se()}],pr:[{pr:se()}],pb:[{pb:se()}],pl:[{pl:se()}],m:[{m:Se()}],mx:[{mx:Se()}],my:[{my:Se()}],ms:[{ms:Se()}],me:[{me:Se()}],mt:[{mt:Se()}],mr:[{mr:Se()}],mb:[{mb:Se()}],ml:[{ml:Se()}],"space-x":[{"space-x":se()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":se()}],"space-y-reverse":["space-y-reverse"],size:[{size:Ee()}],w:[{w:[i,"screen",...Ee()]}],"min-w":[{"min-w":[i,"screen","none",...Ee()]}],"max-w":[{"max-w":[i,"screen","none","prose",{screen:[h]},...Ee()]}],h:[{h:["screen",...Ee()]}],"min-h":[{"min-h":["screen","none",...Ee()]}],"max-h":[{"max-h":["screen",...Ee()]}],"font-size":[{text:["base",r,RS,d0]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,bn,sP]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",WB,_n]}],"font-family":[{font:[cue,_n,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,bn,_n]}],"line-clamp":[{"line-clamp":[Di,"none",bn,sP]}],leading:[{leading:[c,...se()]}],"list-image":[{"list-image":["none",bn,_n]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",bn,_n]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:we()}],"text-color":[{text:we()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Ge(),"wavy"]}],"text-decoration-thickness":[{decoration:[Di,"from-font","auto",bn,d0]}],"text-decoration-color":[{decoration:we()}],"underline-offset":[{"underline-offset":[Di,"auto",bn,_n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:se()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",bn,_n]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",bn,_n]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Q(),uue,sue]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:["auto","cover","contain",due,aue]}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},u0,bn,_n],radial:["",bn,_n],conic:[u0,bn,_n]},hue,oue]}],"bg-color":[{bg:we()}],"gradient-from-pos":[{from:Pe()}],"gradient-via-pos":[{via:Pe()}],"gradient-to-pos":[{to:Pe()}],"gradient-from":[{from:we()}],"gradient-via":[{via:we()}],"gradient-to":[{to:we()}],rounded:[{rounded:Me()}],"rounded-s":[{"rounded-s":Me()}],"rounded-e":[{"rounded-e":Me()}],"rounded-t":[{"rounded-t":Me()}],"rounded-r":[{"rounded-r":Me()}],"rounded-b":[{"rounded-b":Me()}],"rounded-l":[{"rounded-l":Me()}],"rounded-ss":[{"rounded-ss":Me()}],"rounded-se":[{"rounded-se":Me()}],"rounded-ee":[{"rounded-ee":Me()}],"rounded-es":[{"rounded-es":Me()}],"rounded-tl":[{"rounded-tl":Me()}],"rounded-tr":[{"rounded-tr":Me()}],"rounded-br":[{"rounded-br":Me()}],"rounded-bl":[{"rounded-bl":Me()}],"border-w":[{border:Be()}],"border-w-x":[{"border-x":Be()}],"border-w-y":[{"border-y":Be()}],"border-w-s":[{"border-s":Be()}],"border-w-e":[{"border-e":Be()}],"border-w-t":[{"border-t":Be()}],"border-w-r":[{"border-r":Be()}],"border-w-b":[{"border-b":Be()}],"border-w-l":[{"border-l":Be()}],"divide-x":[{"divide-x":Be()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Be()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Ge(),"hidden","none"]}],"divide-style":[{divide:[...Ge(),"hidden","none"]}],"border-color":[{border:we()}],"border-color-x":[{"border-x":we()}],"border-color-y":[{"border-y":we()}],"border-color-s":[{"border-s":we()}],"border-color-e":[{"border-e":we()}],"border-color-t":[{"border-t":we()}],"border-color-r":[{"border-r":we()}],"border-color-b":[{"border-b":we()}],"border-color-l":[{"border-l":we()}],"divide-color":[{divide:we()}],"outline-style":[{outline:[...Ge(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Di,bn,_n]}],"outline-w":[{outline:["",Di,RS,d0]}],"outline-color":[{outline:[e]}],shadow:[{shadow:["","none",S,fue,lue]}],"shadow-color":[{shadow:we()}],"inset-shadow":[{"inset-shadow":["none",bn,_n,T]}],"inset-shadow-color":[{"inset-shadow":we()}],"ring-w":[{ring:Be()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:we()}],"ring-offset-w":[{"ring-offset":[Di,d0]}],"ring-offset-color":[{"ring-offset":we()}],"inset-ring-w":[{"inset-ring":Be()}],"inset-ring-color":[{"inset-ring":we()}],opacity:[{opacity:[Di,bn,_n]}],"mix-blend":[{"mix-blend":[...We(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":We()}],filter:[{filter:["","none",bn,_n]}],blur:[{blur:tt()}],brightness:[{brightness:[Di,bn,_n]}],contrast:[{contrast:[Di,bn,_n]}],"drop-shadow":[{"drop-shadow":["","none",E,bn,_n]}],grayscale:[{grayscale:["",Di,bn,_n]}],"hue-rotate":[{"hue-rotate":[Di,bn,_n]}],invert:[{invert:["",Di,bn,_n]}],saturate:[{saturate:[Di,bn,_n]}],sepia:[{sepia:["",Di,bn,_n]}],"backdrop-filter":[{"backdrop-filter":["","none",bn,_n]}],"backdrop-blur":[{"backdrop-blur":tt()}],"backdrop-brightness":[{"backdrop-brightness":[Di,bn,_n]}],"backdrop-contrast":[{"backdrop-contrast":[Di,bn,_n]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Di,bn,_n]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Di,bn,_n]}],"backdrop-invert":[{"backdrop-invert":["",Di,bn,_n]}],"backdrop-opacity":[{"backdrop-opacity":[Di,bn,_n]}],"backdrop-saturate":[{"backdrop-saturate":[Di,bn,_n]}],"backdrop-sepia":[{"backdrop-sepia":["",Di,bn,_n]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":se()}],"border-spacing-x":[{"border-spacing-x":se()}],"border-spacing-y":[{"border-spacing-y":se()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",bn,_n]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Di,"initial",bn,_n]}],ease:[{ease:["linear","initial",V,bn,_n]}],delay:[{delay:[Di,bn,_n]}],animate:[{animate:["none",H,bn,_n]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[U,bn,_n]}],"perspective-origin":[{"perspective-origin":nt()}],rotate:[{rotate:Dt()}],"rotate-x":[{"rotate-x":Dt()}],"rotate-y":[{"rotate-y":Dt()}],"rotate-z":[{"rotate-z":Dt()}],scale:[{scale:nr()}],"scale-x":[{"scale-x":nr()}],"scale-y":[{"scale-y":nr()}],"scale-z":[{"scale-z":nr()}],"scale-3d":["scale-3d"],skew:[{skew:ir()}],"skew-x":[{"skew-x":ir()}],"skew-y":[{"skew-y":ir()}],transform:[{transform:[bn,_n,"","none","gpu","cpu"]}],"transform-origin":[{origin:nt()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:rr()}],"translate-x":[{"translate-x":rr()}],"translate-y":[{"translate-y":rr()}],"translate-z":[{"translate-z":rr()}],"translate-none":["translate-none"],accent:[{accent:we()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:we()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",bn,_n]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":se()}],"scroll-mx":[{"scroll-mx":se()}],"scroll-my":[{"scroll-my":se()}],"scroll-ms":[{"scroll-ms":se()}],"scroll-me":[{"scroll-me":se()}],"scroll-mt":[{"scroll-mt":se()}],"scroll-mr":[{"scroll-mr":se()}],"scroll-mb":[{"scroll-mb":se()}],"scroll-ml":[{"scroll-ml":se()}],"scroll-p":[{"scroll-p":se()}],"scroll-px":[{"scroll-px":se()}],"scroll-py":[{"scroll-py":se()}],"scroll-ps":[{"scroll-ps":se()}],"scroll-pe":[{"scroll-pe":se()}],"scroll-pt":[{"scroll-pt":se()}],"scroll-pr":[{"scroll-pr":se()}],"scroll-pb":[{"scroll-pb":se()}],"scroll-pl":[{"scroll-pl":se()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",bn,_n]}],fill:[{fill:["none",...we()]}],"stroke-w":[{stroke:[Di,RS,d0,sP]}],stroke:[{stroke:["none",...we()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["before","after","placeholder","file","marker","selection","first-line","first-letter","backdrop","*","**"]}},_ue=Hce(vue);function zt(...e){return _ue(di(e))}const j1=Ww("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input dark:border-[#424242] bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"sm"}}),ur=G.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},c)=>{const h=n?nc:"button";return o.jsx(h,{className:zt(j1({variant:t,size:r,className:e})),ref:c,...a})});ur.displayName="Button";/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bue=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),bH=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var wue={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sue=G.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:c,iconNode:h,...i},x)=>G.createElement("svg",{ref:x,...wue,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:bH("lucide",a),...i},[...h.map(([w,S])=>G.createElement(w,S)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=(e,t)=>{const r=G.forwardRef(({className:n,...a},c)=>G.createElement(Sue,{ref:c,iconNode:t,className:bH(`lucide-${bue(e)}`,n),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nue=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],dR=Kr("Activity",Nue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aue=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],HB=Kr("ArrowDown",Aue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tue=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],n4=Kr("ArrowLeft",Tue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jue=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],KB=Kr("ArrowUp",jue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kue=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Pue=Kr("BadgeCheck",kue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cue=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ZB=Kr("BookOpen",Cue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eue=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],Jb=Kr("Building",Eue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mue=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],Oue=Kr("CalendarCheck2",Mue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rue=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Xs=Kr("Calendar",Rue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iue=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Lue=Kr("Camera",Iue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Due=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],fo=Kr("Car",Due);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fue=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],i4=Kr("ChartColumn",Fue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zue=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],k1=Kr("ChartPie",zue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bue=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M7 16c.5-2 1.5-7 4-7 2 0 2 3 4 3 2.5 0 4.5-5 5-7",key:"lw07rv"}]],Vue=Kr("ChartSpline",Bue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uue=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],a4=Kr("Check",Uue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ue=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],wH=Kr("ChevronDown",$ue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const que=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],s4=Kr("ChevronLeft",que);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gue=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],z0=Kr("ChevronRight",Gue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wue=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Hue=Kr("ChevronUp",Wue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kue=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],Zue=Kr("ChevronsLeft",Kue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yue=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],Xue=Kr("ChevronsRight",Yue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jue=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],SH=Kr("ChevronsUpDown",Jue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Que=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Hf=Kr("CircleAlert",Que);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ede=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],NH=Kr("CircleCheckBig",ede);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tde=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],hR=Kr("CircleCheck",tde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rde=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],nde=Kr("CircleX",rde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ide=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ade=Kr("Circle",ide);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sde=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],AT=Kr("Clock",sde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ode=[["rect",{width:"14",height:"8",x:"5",y:"2",rx:"2",key:"wc9tft"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",key:"w68u3i"}],["path",{d:"M6 18h2",key:"rwmk9e"}],["path",{d:"M12 18h6",key:"aqd8w3"}]],lde=Kr("Computer",ode);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cde=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],TT=Kr("CreditCard",cde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ude=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],o4=Kr("Download",ude);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dde=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],hde=Kr("Ellipsis",dde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fde=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],DN=Kr("EyeOff",fde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pde=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],FN=Kr("Eye",pde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mde=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],gde=Kr("FileJson",mde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yde=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ho=Kr("FileText",yde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xde=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],AH=Kr("Filter",xde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vde=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],qf=Kr("Hash",vde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _de=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],YB=Kr("Image",_de);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bde=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],XB=Kr("Layers",bde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wde=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]],JB=Kr("ListFilter",wde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sde=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],Nde=Kr("List",Sde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ade=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Nc=Kr("LoaderCircle",Ade);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tde=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],fR=Kr("Lock",Tde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jde=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],kde=Kr("LogOut",jde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pde=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],Hw=Kr("Mail",Pde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cde=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Rd=Kr("MapPin",Cde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ede=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],QB=Kr("Moon",Ede);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mde=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],TH=Kr("Palette",Mde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ode=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],Rde=Kr("PanelLeft",Ode);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ide=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],pR=Kr("PenLine",Ide);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lde=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],l4=Kr("Phone",Lde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dde=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],v_=Kr("Plus",Dde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fde=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],sv=Kr("RefreshCw",Fde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zde=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Bde=Kr("RotateCcw",zde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vde=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],jH=Kr("Save",Vde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ude=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Kw=Kr("Search",Ude);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $de=[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],qde=Kr("Settings2",$de);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gde=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Xg=Kr("Shield",Gde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wde=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M17 12h-2l-2 5-2-10-2 5H7",key:"15hlnc"}]],oP=Kr("SquareActivity",Wde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hde=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 8h7",key:"kbo1nt"}],["path",{d:"M8 12h6",key:"ikassy"}],["path",{d:"M11 16h5",key:"oq65wt"}]],lP=Kr("SquareChartGantt",Hde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kde=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],za=Kr("SquarePen",Kde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zde=[["path",{d:"m7 11 2-2-2-2",key:"1lz0vl"}],["path",{d:"M11 13h4",key:"1p7l4v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}]],Yde=Kr("SquareTerminal",Zde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xde=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],e6=Kr("Sun",Xde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jde=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],Qde=Kr("Table",Jde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ehe=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],the=Kr("Tag",ehe);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rhe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],c4=Kr("Target",rhe);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nhe=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],ihe=Kr("Trash2",nhe);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ahe=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],mR=Kr("TrendingDown",ahe);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const she=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],P1=Kr("TrendingUp",she);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ohe=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ko=Kr("TriangleAlert",ohe);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lhe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],kH=Kr("UserCheck",lhe);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const che=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],zN=Kr("UserPlus",che);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uhe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],fl=Kr("User",uhe);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dhe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],u4=Kr("Users",dhe);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hhe=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],PH=Kr("Wrench",hhe);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fhe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],zd=Kr("X",fhe);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const phe=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],mhe=Kr("Zap",phe);function dn(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function ghe(e,t){const r=G.createContext(t),n=c=>{const{children:h,...i}=c,x=G.useMemo(()=>i,Object.values(i));return o.jsx(r.Provider,{value:x,children:h})};n.displayName=e+"Provider";function a(c){const h=G.useContext(r);if(h)return h;if(t!==void 0)return t;throw new Error(`\`${c}\` must be used within \`${e}\``)}return[n,a]}function qd(e,t=[]){let r=[];function n(c,h){const i=G.createContext(h),x=r.length;r=[...r,h];const w=T=>{var H;const{scope:E,children:D,...U}=T,I=((H=E==null?void 0:E[e])==null?void 0:H[x])||i,V=G.useMemo(()=>U,Object.values(U));return o.jsx(I.Provider,{value:V,children:D})};w.displayName=c+"Provider";function S(T,E){var I;const D=((I=E==null?void 0:E[e])==null?void 0:I[x])||i,U=G.useContext(D);if(U)return U;if(h!==void 0)return h;throw new Error(`\`${T}\` must be used within \`${c}\``)}return[w,S]}const a=()=>{const c=r.map(h=>G.createContext(h));return function(i){const x=(i==null?void 0:i[e])||c;return G.useMemo(()=>({[`__scope${e}`]:{...i,[e]:x}}),[i,x])}};return a.scopeName=e,[n,yhe(a,...t)]}function yhe(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const h=n.reduce((i,{useScope:x,scopeName:w})=>{const T=x(c)[`__scope${w}`];return{...i,...T}},{});return G.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}function zu(e){const t=G.useRef(e);return G.useEffect(()=>{t.current=e}),G.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function Jg({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,a]=xhe({defaultProp:t,onChange:r}),c=e!==void 0,h=c?e:n,i=zu(r),x=G.useCallback(w=>{if(c){const T=typeof w=="function"?w(e):w;T!==e&&i(T)}else a(w)},[c,e,a,i]);return[h,x]}function xhe({defaultProp:e,onChange:t}){const r=G.useState(e),[n]=r,a=G.useRef(n),c=zu(t);return G.useEffect(()=>{a.current!==n&&(c(n),a.current=n)},[n,a,c]),r}var vhe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],gi=vhe.reduce((e,t)=>{const r=G.forwardRef((n,a)=>{const{asChild:c,...h}=n,i=c?nc:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(i,{...h,ref:a})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function CH(e,t){e&&$w.flushSync(()=>e.dispatchEvent(t))}function d4(e){const t=e+"CollectionProvider",[r,n]=qd(t),[a,c]=r(t,{collectionRef:{current:null},itemMap:new Map}),h=D=>{const{scope:U,children:I}=D,V=Le.useRef(null),H=Le.useRef(new Map).current;return o.jsx(a,{scope:U,itemMap:H,collectionRef:V,children:I})};h.displayName=t;const i=e+"CollectionSlot",x=Le.forwardRef((D,U)=>{const{scope:I,children:V}=D,H=c(i,I),K=ta(U,H.collectionRef);return o.jsx(nc,{ref:K,children:V})});x.displayName=i;const w=e+"CollectionItemSlot",S="data-radix-collection-item",T=Le.forwardRef((D,U)=>{const{scope:I,children:V,...H}=D,K=Le.useRef(null),Q=ta(U,K),ae=c(w,I);return Le.useEffect(()=>(ae.itemMap.set(K,{ref:K,...H}),()=>void ae.itemMap.delete(K))),o.jsx(nc,{[S]:"",ref:Q,children:V})});T.displayName=w;function E(D){const U=c(e+"CollectionConsumer",D);return Le.useCallback(()=>{const V=U.collectionRef.current;if(!V)return[];const H=Array.from(V.querySelectorAll(`[${S}]`));return Array.from(U.itemMap.values()).sort((ae,ee)=>H.indexOf(ae.ref.current)-H.indexOf(ee.ref.current))},[U.collectionRef,U.itemMap])}return[{Provider:h,Slot:x,ItemSlot:T},E,n]}var _he=G.createContext(void 0);function h4(e){const t=G.useContext(_he);return e||t||"ltr"}function bhe(e,t=globalThis==null?void 0:globalThis.document){const r=zu(e);G.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var whe="DismissableLayer",gR="dismissableLayer.update",She="dismissableLayer.pointerDownOutside",Nhe="dismissableLayer.focusOutside",t6,EH=G.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),__=G.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:c,onInteractOutside:h,onDismiss:i,...x}=e,w=G.useContext(EH),[S,T]=G.useState(null),E=(S==null?void 0:S.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,D]=G.useState({}),U=ta(t,ue=>T(ue)),I=Array.from(w.layers),[V]=[...w.layersWithOutsidePointerEventsDisabled].slice(-1),H=I.indexOf(V),K=S?I.indexOf(S):-1,Q=w.layersWithOutsidePointerEventsDisabled.size>0,ae=K>=H,ee=jhe(ue=>{const he=ue.target,Ce=[...w.branches].some(Ne=>Ne.contains(he));!ae||Ce||(a==null||a(ue),h==null||h(ue),ue.defaultPrevented||i==null||i())},E),se=khe(ue=>{const he=ue.target;[...w.branches].some(Ne=>Ne.contains(he))||(c==null||c(ue),h==null||h(ue),ue.defaultPrevented||i==null||i())},E);return bhe(ue=>{K===w.layers.size-1&&(n==null||n(ue),!ue.defaultPrevented&&i&&(ue.preventDefault(),i()))},E),G.useEffect(()=>{if(S)return r&&(w.layersWithOutsidePointerEventsDisabled.size===0&&(t6=E.body.style.pointerEvents,E.body.style.pointerEvents="none"),w.layersWithOutsidePointerEventsDisabled.add(S)),w.layers.add(S),r6(),()=>{r&&w.layersWithOutsidePointerEventsDisabled.size===1&&(E.body.style.pointerEvents=t6)}},[S,E,r,w]),G.useEffect(()=>()=>{S&&(w.layers.delete(S),w.layersWithOutsidePointerEventsDisabled.delete(S),r6())},[S,w]),G.useEffect(()=>{const ue=()=>D({});return document.addEventListener(gR,ue),()=>document.removeEventListener(gR,ue)},[]),o.jsx(gi.div,{...x,ref:U,style:{pointerEvents:Q?ae?"auto":"none":void 0,...e.style},onFocusCapture:dn(e.onFocusCapture,se.onFocusCapture),onBlurCapture:dn(e.onBlurCapture,se.onBlurCapture),onPointerDownCapture:dn(e.onPointerDownCapture,ee.onPointerDownCapture)})});__.displayName=whe;var Ahe="DismissableLayerBranch",The=G.forwardRef((e,t)=>{const r=G.useContext(EH),n=G.useRef(null),a=ta(t,n);return G.useEffect(()=>{const c=n.current;if(c)return r.branches.add(c),()=>{r.branches.delete(c)}},[r.branches]),o.jsx(gi.div,{...e,ref:a})});The.displayName=Ahe;function jhe(e,t=globalThis==null?void 0:globalThis.document){const r=zu(e),n=G.useRef(!1),a=G.useRef(()=>{});return G.useEffect(()=>{const c=i=>{if(i.target&&!n.current){let x=function(){MH(She,r,w,{discrete:!0})};const w={originalEvent:i};i.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=x,t.addEventListener("click",a.current,{once:!0})):x()}else t.removeEventListener("click",a.current);n.current=!1},h=window.setTimeout(()=>{t.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(h),t.removeEventListener("pointerdown",c),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function khe(e,t=globalThis==null?void 0:globalThis.document){const r=zu(e),n=G.useRef(!1);return G.useEffect(()=>{const a=c=>{c.target&&!n.current&&MH(Nhe,r,{originalEvent:c},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function r6(){const e=new CustomEvent(gR);document.dispatchEvent(e)}function MH(e,t,r,{discrete:n}){const a=r.originalEvent.target,c=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?CH(a,c):a.dispatchEvent(c)}var cP=0;function jT(){G.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??n6()),document.body.insertAdjacentElement("beforeend",e[1]??n6()),cP++,()=>{cP===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),cP--}},[])}function n6(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var uP="focusScope.autoFocusOnMount",dP="focusScope.autoFocusOnUnmount",i6={bubbles:!1,cancelable:!0},Phe="FocusScope",Zw=G.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:c,...h}=e,[i,x]=G.useState(null),w=zu(a),S=zu(c),T=G.useRef(null),E=ta(t,I=>x(I)),D=G.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;G.useEffect(()=>{if(n){let I=function(Q){if(D.paused||!i)return;const ae=Q.target;i.contains(ae)?T.current=ae:Dg(T.current,{select:!0})},V=function(Q){if(D.paused||!i)return;const ae=Q.relatedTarget;ae!==null&&(i.contains(ae)||Dg(T.current,{select:!0}))},H=function(Q){if(document.activeElement===document.body)for(const ee of Q)ee.removedNodes.length>0&&Dg(i)};document.addEventListener("focusin",I),document.addEventListener("focusout",V);const K=new MutationObserver(H);return i&&K.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",I),document.removeEventListener("focusout",V),K.disconnect()}}},[n,i,D.paused]),G.useEffect(()=>{if(i){s6.add(D);const I=document.activeElement;if(!i.contains(I)){const H=new CustomEvent(uP,i6);i.addEventListener(uP,w),i.dispatchEvent(H),H.defaultPrevented||(Che(Ihe(OH(i)),{select:!0}),document.activeElement===I&&Dg(i))}return()=>{i.removeEventListener(uP,w),setTimeout(()=>{const H=new CustomEvent(dP,i6);i.addEventListener(dP,S),i.dispatchEvent(H),H.defaultPrevented||Dg(I??document.body,{select:!0}),i.removeEventListener(dP,S),s6.remove(D)},0)}}},[i,w,S,D]);const U=G.useCallback(I=>{if(!r&&!n||D.paused)return;const V=I.key==="Tab"&&!I.altKey&&!I.ctrlKey&&!I.metaKey,H=document.activeElement;if(V&&H){const K=I.currentTarget,[Q,ae]=Ehe(K);Q&&ae?!I.shiftKey&&H===ae?(I.preventDefault(),r&&Dg(Q,{select:!0})):I.shiftKey&&H===Q&&(I.preventDefault(),r&&Dg(ae,{select:!0})):H===K&&I.preventDefault()}},[r,n,D.paused]);return o.jsx(gi.div,{tabIndex:-1,...h,ref:E,onKeyDown:U})});Zw.displayName=Phe;function Che(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Dg(n,{select:t}),document.activeElement!==r)return}function Ehe(e){const t=OH(e),r=a6(t,e),n=a6(t.reverse(),e);return[r,n]}function OH(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function a6(e,t){for(const r of e)if(!Mhe(r,{upTo:t}))return r}function Mhe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Ohe(e){return e instanceof HTMLInputElement&&"select"in e}function Dg(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Ohe(e)&&t&&e.select()}}var s6=Rhe();function Rhe(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=o6(e,t),e.unshift(t)},remove(t){var r;e=o6(e,t),(r=e[0])==null||r.resume()}}}function o6(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function Ihe(e){return e.filter(t=>t.tagName!=="A")}var pl=globalThis!=null&&globalThis.document?G.useLayoutEffect:()=>{},Lhe=KW.useId||(()=>{}),Dhe=0;function Ld(e){const[t,r]=G.useState(Lhe());return pl(()=>{r(n=>n??String(Dhe++))},[e]),t?`radix-${t}`:""}const Fhe=["top","right","bottom","left"],Qg=Math.min,Mu=Math.max,BN=Math.round,IS=Math.floor,Jf=e=>({x:e,y:e}),zhe={left:"right",right:"left",bottom:"top",top:"bottom"},Bhe={start:"end",end:"start"};function yR(e,t,r){return Mu(e,Qg(t,r))}function Sm(e,t){return typeof e=="function"?e(t):e}function Nm(e){return e.split("-")[0]}function b_(e){return e.split("-")[1]}function f4(e){return e==="x"?"y":"x"}function p4(e){return e==="y"?"height":"width"}function ey(e){return["top","bottom"].includes(Nm(e))?"y":"x"}function m4(e){return f4(ey(e))}function Vhe(e,t,r){r===void 0&&(r=!1);const n=b_(e),a=m4(e),c=p4(a);let h=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[c]>t.floating[c]&&(h=VN(h)),[h,VN(h)]}function Uhe(e){const t=VN(e);return[xR(e),t,xR(t)]}function xR(e){return e.replace(/start|end/g,t=>Bhe[t])}function $he(e,t,r){const n=["left","right"],a=["right","left"],c=["top","bottom"],h=["bottom","top"];switch(e){case"top":case"bottom":return r?t?a:n:t?n:a;case"left":case"right":return t?c:h;default:return[]}}function qhe(e,t,r,n){const a=b_(e);let c=$he(Nm(e),r==="start",n);return a&&(c=c.map(h=>h+"-"+a),t&&(c=c.concat(c.map(xR)))),c}function VN(e){return e.replace(/left|right|bottom|top/g,t=>zhe[t])}function Ghe(e){return{top:0,right:0,bottom:0,left:0,...e}}function RH(e){return typeof e!="number"?Ghe(e):{top:e,right:e,bottom:e,left:e}}function UN(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function l6(e,t,r){let{reference:n,floating:a}=e;const c=ey(t),h=m4(t),i=p4(h),x=Nm(t),w=c==="y",S=n.x+n.width/2-a.width/2,T=n.y+n.height/2-a.height/2,E=n[i]/2-a[i]/2;let D;switch(x){case"top":D={x:S,y:n.y-a.height};break;case"bottom":D={x:S,y:n.y+n.height};break;case"right":D={x:n.x+n.width,y:T};break;case"left":D={x:n.x-a.width,y:T};break;default:D={x:n.x,y:n.y}}switch(b_(t)){case"start":D[h]-=E*(r&&w?-1:1);break;case"end":D[h]+=E*(r&&w?-1:1);break}return D}const Whe=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:c=[],platform:h}=r,i=c.filter(Boolean),x=await(h.isRTL==null?void 0:h.isRTL(t));let w=await h.getElementRects({reference:e,floating:t,strategy:a}),{x:S,y:T}=l6(w,n,x),E=n,D={},U=0;for(let I=0;I<i.length;I++){const{name:V,fn:H}=i[I],{x:K,y:Q,data:ae,reset:ee}=await H({x:S,y:T,initialPlacement:n,placement:E,strategy:a,middlewareData:D,rects:w,platform:h,elements:{reference:e,floating:t}});S=K??S,T=Q??T,D={...D,[V]:{...D[V],...ae}},ee&&U<=50&&(U++,typeof ee=="object"&&(ee.placement&&(E=ee.placement),ee.rects&&(w=ee.rects===!0?await h.getElementRects({reference:e,floating:t,strategy:a}):ee.rects),{x:S,y:T}=l6(w,E,x)),I=-1)}return{x:S,y:T,placement:E,strategy:a,middlewareData:D}};async function C1(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:c,rects:h,elements:i,strategy:x}=e,{boundary:w="clippingAncestors",rootBoundary:S="viewport",elementContext:T="floating",altBoundary:E=!1,padding:D=0}=Sm(t,e),U=RH(D),V=i[E?T==="floating"?"reference":"floating":T],H=UN(await c.getClippingRect({element:(r=await(c.isElement==null?void 0:c.isElement(V)))==null||r?V:V.contextElement||await(c.getDocumentElement==null?void 0:c.getDocumentElement(i.floating)),boundary:w,rootBoundary:S,strategy:x})),K=T==="floating"?{x:n,y:a,width:h.floating.width,height:h.floating.height}:h.reference,Q=await(c.getOffsetParent==null?void 0:c.getOffsetParent(i.floating)),ae=await(c.isElement==null?void 0:c.isElement(Q))?await(c.getScale==null?void 0:c.getScale(Q))||{x:1,y:1}:{x:1,y:1},ee=UN(c.convertOffsetParentRelativeRectToViewportRelativeRect?await c.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:K,offsetParent:Q,strategy:x}):K);return{top:(H.top-ee.top+U.top)/ae.y,bottom:(ee.bottom-H.bottom+U.bottom)/ae.y,left:(H.left-ee.left+U.left)/ae.x,right:(ee.right-H.right+U.right)/ae.x}}const Hhe=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:c,platform:h,elements:i,middlewareData:x}=t,{element:w,padding:S=0}=Sm(e,t)||{};if(w==null)return{};const T=RH(S),E={x:r,y:n},D=m4(a),U=p4(D),I=await h.getDimensions(w),V=D==="y",H=V?"top":"left",K=V?"bottom":"right",Q=V?"clientHeight":"clientWidth",ae=c.reference[U]+c.reference[D]-E[D]-c.floating[U],ee=E[D]-c.reference[D],se=await(h.getOffsetParent==null?void 0:h.getOffsetParent(w));let ue=se?se[Q]:0;(!ue||!await(h.isElement==null?void 0:h.isElement(se)))&&(ue=i.floating[Q]||c.floating[U]);const he=ae/2-ee/2,Ce=ue/2-I[U]/2-1,Ne=Qg(T[H],Ce),me=Qg(T[K],Ce),be=Ne,pe=ue-I[U]-me,Se=ue/2-I[U]/2+he,Ee=yR(be,Se,pe),we=!x.arrow&&b_(a)!=null&&Se!==Ee&&c.reference[U]/2-(Se<be?Ne:me)-I[U]/2<0,Pe=we?Se<be?Se-be:Se-pe:0;return{[D]:E[D]+Pe,data:{[D]:Ee,centerOffset:Se-Ee-Pe,...we&&{alignmentOffset:Pe}},reset:we}}}),Khe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:c,rects:h,initialPlacement:i,platform:x,elements:w}=t,{mainAxis:S=!0,crossAxis:T=!0,fallbackPlacements:E,fallbackStrategy:D="bestFit",fallbackAxisSideDirection:U="none",flipAlignment:I=!0,...V}=Sm(e,t);if((r=c.arrow)!=null&&r.alignmentOffset)return{};const H=Nm(a),K=ey(i),Q=Nm(i)===i,ae=await(x.isRTL==null?void 0:x.isRTL(w.floating)),ee=E||(Q||!I?[VN(i)]:Uhe(i)),se=U!=="none";!E&&se&&ee.push(...qhe(i,I,U,ae));const ue=[i,...ee],he=await C1(t,V),Ce=[];let Ne=((n=c.flip)==null?void 0:n.overflows)||[];if(S&&Ce.push(he[H]),T){const Se=Vhe(a,h,ae);Ce.push(he[Se[0]],he[Se[1]])}if(Ne=[...Ne,{placement:a,overflows:Ce}],!Ce.every(Se=>Se<=0)){var me,be;const Se=(((me=c.flip)==null?void 0:me.index)||0)+1,Ee=ue[Se];if(Ee)return{data:{index:Se,overflows:Ne},reset:{placement:Ee}};let we=(be=Ne.filter(Pe=>Pe.overflows[0]<=0).sort((Pe,Me)=>Pe.overflows[1]-Me.overflows[1])[0])==null?void 0:be.placement;if(!we)switch(D){case"bestFit":{var pe;const Pe=(pe=Ne.filter(Me=>{if(se){const Be=ey(Me.placement);return Be===K||Be==="y"}return!0}).map(Me=>[Me.placement,Me.overflows.filter(Be=>Be>0).reduce((Be,Ge)=>Be+Ge,0)]).sort((Me,Be)=>Me[1]-Be[1])[0])==null?void 0:pe[0];Pe&&(we=Pe);break}case"initialPlacement":we=i;break}if(a!==we)return{reset:{placement:we}}}return{}}}};function c6(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function u6(e){return Fhe.some(t=>e[t]>=0)}const Zhe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=Sm(e,t);switch(n){case"referenceHidden":{const c=await C1(t,{...a,elementContext:"reference"}),h=c6(c,r.reference);return{data:{referenceHiddenOffsets:h,referenceHidden:u6(h)}}}case"escaped":{const c=await C1(t,{...a,altBoundary:!0}),h=c6(c,r.floating);return{data:{escapedOffsets:h,escaped:u6(h)}}}default:return{}}}}};async function Yhe(e,t){const{placement:r,platform:n,elements:a}=e,c=await(n.isRTL==null?void 0:n.isRTL(a.floating)),h=Nm(r),i=b_(r),x=ey(r)==="y",w=["left","top"].includes(h)?-1:1,S=c&&x?-1:1,T=Sm(t,e);let{mainAxis:E,crossAxis:D,alignmentAxis:U}=typeof T=="number"?{mainAxis:T,crossAxis:0,alignmentAxis:null}:{mainAxis:T.mainAxis||0,crossAxis:T.crossAxis||0,alignmentAxis:T.alignmentAxis};return i&&typeof U=="number"&&(D=i==="end"?U*-1:U),x?{x:D*S,y:E*w}:{x:E*w,y:D*S}}const Xhe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:c,placement:h,middlewareData:i}=t,x=await Yhe(t,e);return h===((r=i.offset)==null?void 0:r.placement)&&(n=i.arrow)!=null&&n.alignmentOffset?{}:{x:a+x.x,y:c+x.y,data:{...x,placement:h}}}}},Jhe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:c=!0,crossAxis:h=!1,limiter:i={fn:V=>{let{x:H,y:K}=V;return{x:H,y:K}}},...x}=Sm(e,t),w={x:r,y:n},S=await C1(t,x),T=ey(Nm(a)),E=f4(T);let D=w[E],U=w[T];if(c){const V=E==="y"?"top":"left",H=E==="y"?"bottom":"right",K=D+S[V],Q=D-S[H];D=yR(K,D,Q)}if(h){const V=T==="y"?"top":"left",H=T==="y"?"bottom":"right",K=U+S[V],Q=U-S[H];U=yR(K,U,Q)}const I=i.fn({...t,[E]:D,[T]:U});return{...I,data:{x:I.x-r,y:I.y-n,enabled:{[E]:c,[T]:h}}}}}},Qhe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:c,middlewareData:h}=t,{offset:i=0,mainAxis:x=!0,crossAxis:w=!0}=Sm(e,t),S={x:r,y:n},T=ey(a),E=f4(T);let D=S[E],U=S[T];const I=Sm(i,t),V=typeof I=="number"?{mainAxis:I,crossAxis:0}:{mainAxis:0,crossAxis:0,...I};if(x){const Q=E==="y"?"height":"width",ae=c.reference[E]-c.floating[Q]+V.mainAxis,ee=c.reference[E]+c.reference[Q]-V.mainAxis;D<ae?D=ae:D>ee&&(D=ee)}if(w){var H,K;const Q=E==="y"?"width":"height",ae=["top","left"].includes(Nm(a)),ee=c.reference[T]-c.floating[Q]+(ae&&((H=h.offset)==null?void 0:H[T])||0)+(ae?0:V.crossAxis),se=c.reference[T]+c.reference[Q]+(ae?0:((K=h.offset)==null?void 0:K[T])||0)-(ae?V.crossAxis:0);U<ee?U=ee:U>se&&(U=se)}return{[E]:D,[T]:U}}}},efe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:c,platform:h,elements:i}=t,{apply:x=()=>{},...w}=Sm(e,t),S=await C1(t,w),T=Nm(a),E=b_(a),D=ey(a)==="y",{width:U,height:I}=c.floating;let V,H;T==="top"||T==="bottom"?(V=T,H=E===(await(h.isRTL==null?void 0:h.isRTL(i.floating))?"start":"end")?"left":"right"):(H=T,V=E==="end"?"top":"bottom");const K=I-S.top-S.bottom,Q=U-S.left-S.right,ae=Qg(I-S[V],K),ee=Qg(U-S[H],Q),se=!t.middlewareData.shift;let ue=ae,he=ee;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(he=Q),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(ue=K),se&&!E){const Ne=Mu(S.left,0),me=Mu(S.right,0),be=Mu(S.top,0),pe=Mu(S.bottom,0);D?he=U-2*(Ne!==0||me!==0?Ne+me:Mu(S.left,S.right)):ue=I-2*(be!==0||pe!==0?be+pe:Mu(S.top,S.bottom))}await x({...t,availableWidth:he,availableHeight:ue});const Ce=await h.getDimensions(i.floating);return U!==Ce.width||I!==Ce.height?{reset:{rects:!0}}:{}}}};function kT(){return typeof window<"u"}function w_(e){return IH(e)?(e.nodeName||"").toLowerCase():"#document"}function Ru(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function mp(e){var t;return(t=(IH(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function IH(e){return kT()?e instanceof Node||e instanceof Ru(e).Node:!1}function Kh(e){return kT()?e instanceof Element||e instanceof Ru(e).Element:!1}function sp(e){return kT()?e instanceof HTMLElement||e instanceof Ru(e).HTMLElement:!1}function d6(e){return!kT()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ru(e).ShadowRoot}function Yw(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=Zh(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(a)}function tfe(e){return["table","td","th"].includes(w_(e))}function PT(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function g4(e){const t=y4(),r=Kh(e)?Zh(e):e;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function rfe(e){let t=ty(e);for(;sp(t)&&!jv(t);){if(g4(t))return t;if(PT(t))return null;t=ty(t)}return null}function y4(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function jv(e){return["html","body","#document"].includes(w_(e))}function Zh(e){return Ru(e).getComputedStyle(e)}function CT(e){return Kh(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function ty(e){if(w_(e)==="html")return e;const t=e.assignedSlot||e.parentNode||d6(e)&&e.host||mp(e);return d6(t)?t.host:t}function LH(e){const t=ty(e);return jv(t)?e.ownerDocument?e.ownerDocument.body:e.body:sp(t)&&Yw(t)?t:LH(t)}function E1(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=LH(e),c=a===((n=e.ownerDocument)==null?void 0:n.body),h=Ru(a);if(c){const i=vR(h);return t.concat(h,h.visualViewport||[],Yw(a)?a:[],i&&r?E1(i):[])}return t.concat(a,E1(a,[],r))}function vR(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function DH(e){const t=Zh(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=sp(e),c=a?e.offsetWidth:r,h=a?e.offsetHeight:n,i=BN(r)!==c||BN(n)!==h;return i&&(r=c,n=h),{width:r,height:n,$:i}}function x4(e){return Kh(e)?e:e.contextElement}function _v(e){const t=x4(e);if(!sp(t))return Jf(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:c}=DH(t);let h=(c?BN(r.width):r.width)/n,i=(c?BN(r.height):r.height)/a;return(!h||!Number.isFinite(h))&&(h=1),(!i||!Number.isFinite(i))&&(i=1),{x:h,y:i}}const nfe=Jf(0);function FH(e){const t=Ru(e);return!y4()||!t.visualViewport?nfe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function ife(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Ru(e)?!1:t}function B0(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),c=x4(e);let h=Jf(1);t&&(n?Kh(n)&&(h=_v(n)):h=_v(e));const i=ife(c,r,n)?FH(c):Jf(0);let x=(a.left+i.x)/h.x,w=(a.top+i.y)/h.y,S=a.width/h.x,T=a.height/h.y;if(c){const E=Ru(c),D=n&&Kh(n)?Ru(n):n;let U=E,I=vR(U);for(;I&&n&&D!==U;){const V=_v(I),H=I.getBoundingClientRect(),K=Zh(I),Q=H.left+(I.clientLeft+parseFloat(K.paddingLeft))*V.x,ae=H.top+(I.clientTop+parseFloat(K.paddingTop))*V.y;x*=V.x,w*=V.y,S*=V.x,T*=V.y,x+=Q,w+=ae,U=Ru(I),I=vR(U)}}return UN({width:S,height:T,x,y:w})}function v4(e,t){const r=CT(e).scrollLeft;return t?t.left+r:B0(mp(e)).left+r}function zH(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:v4(e,n)),c=n.top+t.scrollTop;return{x:a,y:c}}function afe(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const c=a==="fixed",h=mp(n),i=t?PT(t.floating):!1;if(n===h||i&&c)return r;let x={scrollLeft:0,scrollTop:0},w=Jf(1);const S=Jf(0),T=sp(n);if((T||!T&&!c)&&((w_(n)!=="body"||Yw(h))&&(x=CT(n)),sp(n))){const D=B0(n);w=_v(n),S.x=D.x+n.clientLeft,S.y=D.y+n.clientTop}const E=h&&!T&&!c?zH(h,x,!0):Jf(0);return{width:r.width*w.x,height:r.height*w.y,x:r.x*w.x-x.scrollLeft*w.x+S.x+E.x,y:r.y*w.y-x.scrollTop*w.y+S.y+E.y}}function sfe(e){return Array.from(e.getClientRects())}function ofe(e){const t=mp(e),r=CT(e),n=e.ownerDocument.body,a=Mu(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),c=Mu(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let h=-r.scrollLeft+v4(e);const i=-r.scrollTop;return Zh(n).direction==="rtl"&&(h+=Mu(t.clientWidth,n.clientWidth)-a),{width:a,height:c,x:h,y:i}}function lfe(e,t){const r=Ru(e),n=mp(e),a=r.visualViewport;let c=n.clientWidth,h=n.clientHeight,i=0,x=0;if(a){c=a.width,h=a.height;const w=y4();(!w||w&&t==="fixed")&&(i=a.offsetLeft,x=a.offsetTop)}return{width:c,height:h,x:i,y:x}}function cfe(e,t){const r=B0(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,c=sp(e)?_v(e):Jf(1),h=e.clientWidth*c.x,i=e.clientHeight*c.y,x=a*c.x,w=n*c.y;return{width:h,height:i,x,y:w}}function h6(e,t,r){let n;if(t==="viewport")n=lfe(e,r);else if(t==="document")n=ofe(mp(e));else if(Kh(t))n=cfe(t,r);else{const a=FH(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return UN(n)}function BH(e,t){const r=ty(e);return r===t||!Kh(r)||jv(r)?!1:Zh(r).position==="fixed"||BH(r,t)}function ufe(e,t){const r=t.get(e);if(r)return r;let n=E1(e,[],!1).filter(i=>Kh(i)&&w_(i)!=="body"),a=null;const c=Zh(e).position==="fixed";let h=c?ty(e):e;for(;Kh(h)&&!jv(h);){const i=Zh(h),x=g4(h);!x&&i.position==="fixed"&&(a=null),(c?!x&&!a:!x&&i.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||Yw(h)&&!x&&BH(e,h))?n=n.filter(S=>S!==h):a=i,h=ty(h)}return t.set(e,n),n}function dfe(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const h=[...r==="clippingAncestors"?PT(t)?[]:ufe(t,this._c):[].concat(r),n],i=h[0],x=h.reduce((w,S)=>{const T=h6(t,S,a);return w.top=Mu(T.top,w.top),w.right=Qg(T.right,w.right),w.bottom=Qg(T.bottom,w.bottom),w.left=Mu(T.left,w.left),w},h6(t,i,a));return{width:x.right-x.left,height:x.bottom-x.top,x:x.left,y:x.top}}function hfe(e){const{width:t,height:r}=DH(e);return{width:t,height:r}}function ffe(e,t,r){const n=sp(t),a=mp(t),c=r==="fixed",h=B0(e,!0,c,t);let i={scrollLeft:0,scrollTop:0};const x=Jf(0);if(n||!n&&!c)if((w_(t)!=="body"||Yw(a))&&(i=CT(t)),n){const E=B0(t,!0,c,t);x.x=E.x+t.clientLeft,x.y=E.y+t.clientTop}else a&&(x.x=v4(a));const w=a&&!n&&!c?zH(a,i):Jf(0),S=h.left+i.scrollLeft-x.x-w.x,T=h.top+i.scrollTop-x.y-w.y;return{x:S,y:T,width:h.width,height:h.height}}function hP(e){return Zh(e).position==="static"}function f6(e,t){if(!sp(e)||Zh(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return mp(e)===r&&(r=r.ownerDocument.body),r}function VH(e,t){const r=Ru(e);if(PT(e))return r;if(!sp(e)){let a=ty(e);for(;a&&!jv(a);){if(Kh(a)&&!hP(a))return a;a=ty(a)}return r}let n=f6(e,t);for(;n&&tfe(n)&&hP(n);)n=f6(n,t);return n&&jv(n)&&hP(n)&&!g4(n)?r:n||rfe(e)||r}const pfe=async function(e){const t=this.getOffsetParent||VH,r=this.getDimensions,n=await r(e.floating);return{reference:ffe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function mfe(e){return Zh(e).direction==="rtl"}const gfe={convertOffsetParentRelativeRectToViewportRelativeRect:afe,getDocumentElement:mp,getClippingRect:dfe,getOffsetParent:VH,getElementRects:pfe,getClientRects:sfe,getDimensions:hfe,getScale:_v,isElement:Kh,isRTL:mfe};function UH(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function yfe(e,t){let r=null,n;const a=mp(e);function c(){var i;clearTimeout(n),(i=r)==null||i.disconnect(),r=null}function h(i,x){i===void 0&&(i=!1),x===void 0&&(x=1),c();const w=e.getBoundingClientRect(),{left:S,top:T,width:E,height:D}=w;if(i||t(),!E||!D)return;const U=IS(T),I=IS(a.clientWidth-(S+E)),V=IS(a.clientHeight-(T+D)),H=IS(S),Q={rootMargin:-U+"px "+-I+"px "+-V+"px "+-H+"px",threshold:Mu(0,Qg(1,x))||1};let ae=!0;function ee(se){const ue=se[0].intersectionRatio;if(ue!==x){if(!ae)return h();ue?h(!1,ue):n=setTimeout(()=>{h(!1,1e-7)},1e3)}ue===1&&!UH(w,e.getBoundingClientRect())&&h(),ae=!1}try{r=new IntersectionObserver(ee,{...Q,root:a.ownerDocument})}catch{r=new IntersectionObserver(ee,Q)}r.observe(e)}return h(!0),c}function xfe(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:c=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:x=!1}=n,w=x4(e),S=a||c?[...w?E1(w):[],...E1(t)]:[];S.forEach(H=>{a&&H.addEventListener("scroll",r,{passive:!0}),c&&H.addEventListener("resize",r)});const T=w&&i?yfe(w,r):null;let E=-1,D=null;h&&(D=new ResizeObserver(H=>{let[K]=H;K&&K.target===w&&D&&(D.unobserve(t),cancelAnimationFrame(E),E=requestAnimationFrame(()=>{var Q;(Q=D)==null||Q.observe(t)})),r()}),w&&!x&&D.observe(w),D.observe(t));let U,I=x?B0(e):null;x&&V();function V(){const H=B0(e);I&&!UH(I,H)&&r(),I=H,U=requestAnimationFrame(V)}return r(),()=>{var H;S.forEach(K=>{a&&K.removeEventListener("scroll",r),c&&K.removeEventListener("resize",r)}),T==null||T(),(H=D)==null||H.disconnect(),D=null,x&&cancelAnimationFrame(U)}}const vfe=Xhe,_fe=Jhe,bfe=Khe,wfe=efe,Sfe=Zhe,p6=Hhe,Nfe=Qhe,Afe=(e,t,r)=>{const n=new Map,a={platform:gfe,...r},c={...a.platform,_c:n};return Whe(e,t,{...a,platform:c})};var _N=typeof document<"u"?G.useLayoutEffect:G.useEffect;function $N(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!$N(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const c=a[n];if(!(c==="_owner"&&e.$$typeof)&&!$N(e[c],t[c]))return!1}return!0}return e!==e&&t!==t}function $H(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function m6(e,t){const r=$H(e);return Math.round(t*r)/r}function fP(e){const t=G.useRef(e);return _N(()=>{t.current=e}),t}function Tfe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:c,floating:h}={},transform:i=!0,whileElementsMounted:x,open:w}=e,[S,T]=G.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[E,D]=G.useState(n);$N(E,n)||D(n);const[U,I]=G.useState(null),[V,H]=G.useState(null),K=G.useCallback(Me=>{Me!==se.current&&(se.current=Me,I(Me))},[]),Q=G.useCallback(Me=>{Me!==ue.current&&(ue.current=Me,H(Me))},[]),ae=c||U,ee=h||V,se=G.useRef(null),ue=G.useRef(null),he=G.useRef(S),Ce=x!=null,Ne=fP(x),me=fP(a),be=fP(w),pe=G.useCallback(()=>{if(!se.current||!ue.current)return;const Me={placement:t,strategy:r,middleware:E};me.current&&(Me.platform=me.current),Afe(se.current,ue.current,Me).then(Be=>{const Ge={...Be,isPositioned:be.current!==!1};Se.current&&!$N(he.current,Ge)&&(he.current=Ge,$w.flushSync(()=>{T(Ge)}))})},[E,t,r,me,be]);_N(()=>{w===!1&&he.current.isPositioned&&(he.current.isPositioned=!1,T(Me=>({...Me,isPositioned:!1})))},[w]);const Se=G.useRef(!1);_N(()=>(Se.current=!0,()=>{Se.current=!1}),[]),_N(()=>{if(ae&&(se.current=ae),ee&&(ue.current=ee),ae&&ee){if(Ne.current)return Ne.current(ae,ee,pe);pe()}},[ae,ee,pe,Ne,Ce]);const Ee=G.useMemo(()=>({reference:se,floating:ue,setReference:K,setFloating:Q}),[K,Q]),we=G.useMemo(()=>({reference:ae,floating:ee}),[ae,ee]),Pe=G.useMemo(()=>{const Me={position:r,left:0,top:0};if(!we.floating)return Me;const Be=m6(we.floating,S.x),Ge=m6(we.floating,S.y);return i?{...Me,transform:"translate("+Be+"px, "+Ge+"px)",...$H(we.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Be,top:Ge}},[r,i,we.floating,S.x,S.y]);return G.useMemo(()=>({...S,update:pe,refs:Ee,elements:we,floatingStyles:Pe}),[S,pe,Ee,we,Pe])}const jfe=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?p6({element:n.current,padding:a}).fn(r):{}:n?p6({element:n,padding:a}).fn(r):{}}}},kfe=(e,t)=>({...vfe(e),options:[e,t]}),Pfe=(e,t)=>({..._fe(e),options:[e,t]}),Cfe=(e,t)=>({...Nfe(e),options:[e,t]}),Efe=(e,t)=>({...bfe(e),options:[e,t]}),Mfe=(e,t)=>({...wfe(e),options:[e,t]}),Ofe=(e,t)=>({...Sfe(e),options:[e,t]}),Rfe=(e,t)=>({...jfe(e),options:[e,t]});var Ife="Arrow",qH=G.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...c}=e;return o.jsx(gi.svg,{...c,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:o.jsx("polygon",{points:"0,0 30,0 15,10"})})});qH.displayName=Ife;var Lfe=qH;function Dfe(e){const[t,r]=G.useState(void 0);return pl(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const c=a[0];let h,i;if("borderBoxSize"in c){const x=c.borderBoxSize,w=Array.isArray(x)?x[0]:x;h=w.inlineSize,i=w.blockSize}else h=e.offsetWidth,i=e.offsetHeight;r({width:h,height:i})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var _4="Popper",[GH,cy]=qd(_4),[Ffe,WH]=GH(_4),HH=e=>{const{__scopePopper:t,children:r}=e,[n,a]=G.useState(null);return o.jsx(Ffe,{scope:t,anchor:n,onAnchorChange:a,children:r})};HH.displayName=_4;var KH="PopperAnchor",ZH=G.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,c=WH(KH,r),h=G.useRef(null),i=ta(t,h);return G.useEffect(()=>{c.onAnchorChange((n==null?void 0:n.current)||h.current)}),n?null:o.jsx(gi.div,{...a,ref:i})});ZH.displayName=KH;var b4="PopperContent",[zfe,Bfe]=GH(b4),YH=G.forwardRef((e,t)=>{var rr,or,Ft,ze,Pr,Kt;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:c="center",alignOffset:h=0,arrowPadding:i=0,avoidCollisions:x=!0,collisionBoundary:w=[],collisionPadding:S=0,sticky:T="partial",hideWhenDetached:E=!1,updatePositionStrategy:D="optimized",onPlaced:U,...I}=e,V=WH(b4,r),[H,K]=G.useState(null),Q=ta(t,on=>K(on)),[ae,ee]=G.useState(null),se=Dfe(ae),ue=(se==null?void 0:se.width)??0,he=(se==null?void 0:se.height)??0,Ce=n+(c!=="center"?"-"+c:""),Ne=typeof S=="number"?S:{top:0,right:0,bottom:0,left:0,...S},me=Array.isArray(w)?w:[w],be=me.length>0,pe={padding:Ne,boundary:me.filter(Ufe),altBoundary:be},{refs:Se,floatingStyles:Ee,placement:we,isPositioned:Pe,middlewareData:Me}=Tfe({strategy:"fixed",placement:Ce,whileElementsMounted:(...on)=>xfe(...on,{animationFrame:D==="always"}),elements:{reference:V.anchor},middleware:[kfe({mainAxis:a+he,alignmentAxis:h}),x&&Pfe({mainAxis:!0,crossAxis:!1,limiter:T==="partial"?Cfe():void 0,...pe}),x&&Efe({...pe}),Mfe({...pe,apply:({elements:on,rects:Rt,availableWidth:En,availableHeight:Vn})=>{const{width:pi,height:dt}=Rt.reference,Ot=on.floating.style;Ot.setProperty("--radix-popper-available-width",`${En}px`),Ot.setProperty("--radix-popper-available-height",`${Vn}px`),Ot.setProperty("--radix-popper-anchor-width",`${pi}px`),Ot.setProperty("--radix-popper-anchor-height",`${dt}px`)}}),ae&&Rfe({element:ae,padding:i}),$fe({arrowWidth:ue,arrowHeight:he}),E&&Ofe({strategy:"referenceHidden",...pe})]}),[Be,Ge]=QH(we),We=zu(U);pl(()=>{Pe&&(We==null||We())},[Pe,We]);const tt=(rr=Me.arrow)==null?void 0:rr.x,nt=(or=Me.arrow)==null?void 0:or.y,Dt=((Ft=Me.arrow)==null?void 0:Ft.centerOffset)!==0,[nr,ir]=G.useState();return pl(()=>{H&&ir(window.getComputedStyle(H).zIndex)},[H]),o.jsx("div",{ref:Se.setFloating,"data-radix-popper-content-wrapper":"",style:{...Ee,transform:Pe?Ee.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:nr,"--radix-popper-transform-origin":[(ze=Me.transformOrigin)==null?void 0:ze.x,(Pr=Me.transformOrigin)==null?void 0:Pr.y].join(" "),...((Kt=Me.hide)==null?void 0:Kt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:o.jsx(zfe,{scope:r,placedSide:Be,onArrowChange:ee,arrowX:tt,arrowY:nt,shouldHideArrow:Dt,children:o.jsx(gi.div,{"data-side":Be,"data-align":Ge,...I,ref:Q,style:{...I.style,animation:Pe?void 0:"none"}})})})});YH.displayName=b4;var XH="PopperArrow",Vfe={top:"bottom",right:"left",bottom:"top",left:"right"},JH=G.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,c=Bfe(XH,n),h=Vfe[c.placedSide];return o.jsx("span",{ref:c.onArrowChange,style:{position:"absolute",left:c.arrowX,top:c.arrowY,[h]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[c.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[c.placedSide],visibility:c.shouldHideArrow?"hidden":void 0},children:o.jsx(Lfe,{...a,ref:r,style:{...a.style,display:"block"}})})});JH.displayName=XH;function Ufe(e){return e!==null}var $fe=e=>({name:"transformOrigin",options:e,fn(t){var V,H,K;const{placement:r,rects:n,middlewareData:a}=t,h=((V=a.arrow)==null?void 0:V.centerOffset)!==0,i=h?0:e.arrowWidth,x=h?0:e.arrowHeight,[w,S]=QH(r),T={start:"0%",center:"50%",end:"100%"}[S],E=(((H=a.arrow)==null?void 0:H.x)??0)+i/2,D=(((K=a.arrow)==null?void 0:K.y)??0)+x/2;let U="",I="";return w==="bottom"?(U=h?T:`${E}px`,I=`${-x}px`):w==="top"?(U=h?T:`${E}px`,I=`${n.floating.height+x}px`):w==="right"?(U=`${-x}px`,I=h?T:`${D}px`):w==="left"&&(U=`${n.floating.width+x}px`,I=h?T:`${D}px`),{data:{x:U,y:I}}}});function QH(e){const[t,r="center"]=e.split("-");return[t,r]}var ET=HH,Xw=ZH,MT=YH,OT=JH,qfe="Portal",S_=G.forwardRef((e,t)=>{var i;const{container:r,...n}=e,[a,c]=G.useState(!1);pl(()=>c(!0),[]);const h=r||a&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return h?YW.createPortal(o.jsx(gi.div,{...n,ref:t}),h):null});S_.displayName=qfe;function Gfe(e,t){return G.useReducer((r,n)=>t[r][n]??r,e)}var $u=e=>{const{present:t,children:r}=e,n=Wfe(t),a=typeof r=="function"?r({present:n.isPresent}):G.Children.only(r),c=ta(n.ref,Hfe(a));return typeof r=="function"||n.isPresent?G.cloneElement(a,{ref:c}):null};$u.displayName="Presence";function Wfe(e){const[t,r]=G.useState(),n=G.useRef({}),a=G.useRef(e),c=G.useRef("none"),h=e?"mounted":"unmounted",[i,x]=Gfe(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return G.useEffect(()=>{const w=LS(n.current);c.current=i==="mounted"?w:"none"},[i]),pl(()=>{const w=n.current,S=a.current;if(S!==e){const E=c.current,D=LS(w);e?x("MOUNT"):D==="none"||(w==null?void 0:w.display)==="none"?x("UNMOUNT"):x(S&&E!==D?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,x]),pl(()=>{if(t){let w;const S=t.ownerDocument.defaultView??window,T=D=>{const I=LS(n.current).includes(D.animationName);if(D.target===t&&I&&(x("ANIMATION_END"),!a.current)){const V=t.style.animationFillMode;t.style.animationFillMode="forwards",w=S.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=V)})}},E=D=>{D.target===t&&(c.current=LS(n.current))};return t.addEventListener("animationstart",E),t.addEventListener("animationcancel",T),t.addEventListener("animationend",T),()=>{S.clearTimeout(w),t.removeEventListener("animationstart",E),t.removeEventListener("animationcancel",T),t.removeEventListener("animationend",T)}}else x("ANIMATION_END")},[t,x]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:G.useCallback(w=>{w&&(n.current=getComputedStyle(w)),r(w)},[])}}function LS(e){return(e==null?void 0:e.animationName)||"none"}function Hfe(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var pP="rovingFocusGroup.onEntryFocus",Kfe={bubbles:!1,cancelable:!0},RT="RovingFocusGroup",[_R,eK,Zfe]=d4(RT),[Yfe,tK]=qd(RT,[Zfe]),[Xfe,Jfe]=Yfe(RT),rK=G.forwardRef((e,t)=>o.jsx(_R.Provider,{scope:e.__scopeRovingFocusGroup,children:o.jsx(_R.Slot,{scope:e.__scopeRovingFocusGroup,children:o.jsx(Qfe,{...e,ref:t})})}));rK.displayName=RT;var Qfe=G.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:c,currentTabStopId:h,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:x,onEntryFocus:w,preventScrollOnEntryFocus:S=!1,...T}=e,E=G.useRef(null),D=ta(t,E),U=h4(c),[I=null,V]=Jg({prop:h,defaultProp:i,onChange:x}),[H,K]=G.useState(!1),Q=zu(w),ae=eK(r),ee=G.useRef(!1),[se,ue]=G.useState(0);return G.useEffect(()=>{const he=E.current;if(he)return he.addEventListener(pP,Q),()=>he.removeEventListener(pP,Q)},[Q]),o.jsx(Xfe,{scope:r,orientation:n,dir:U,loop:a,currentTabStopId:I,onItemFocus:G.useCallback(he=>V(he),[V]),onItemShiftTab:G.useCallback(()=>K(!0),[]),onFocusableItemAdd:G.useCallback(()=>ue(he=>he+1),[]),onFocusableItemRemove:G.useCallback(()=>ue(he=>he-1),[]),children:o.jsx(gi.div,{tabIndex:H||se===0?-1:0,"data-orientation":n,...T,ref:D,style:{outline:"none",...e.style},onMouseDown:dn(e.onMouseDown,()=>{ee.current=!0}),onFocus:dn(e.onFocus,he=>{const Ce=!ee.current;if(he.target===he.currentTarget&&Ce&&!H){const Ne=new CustomEvent(pP,Kfe);if(he.currentTarget.dispatchEvent(Ne),!Ne.defaultPrevented){const me=ae().filter(we=>we.focusable),be=me.find(we=>we.active),pe=me.find(we=>we.id===I),Ee=[be,pe,...me].filter(Boolean).map(we=>we.ref.current);aK(Ee,S)}}ee.current=!1}),onBlur:dn(e.onBlur,()=>K(!1))})})}),nK="RovingFocusGroupItem",iK=G.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:c,...h}=e,i=Ld(),x=c||i,w=Jfe(nK,r),S=w.currentTabStopId===x,T=eK(r),{onFocusableItemAdd:E,onFocusableItemRemove:D}=w;return G.useEffect(()=>{if(n)return E(),()=>D()},[n,E,D]),o.jsx(_R.ItemSlot,{scope:r,id:x,focusable:n,active:a,children:o.jsx(gi.span,{tabIndex:S?0:-1,"data-orientation":w.orientation,...h,ref:t,onMouseDown:dn(e.onMouseDown,U=>{n?w.onItemFocus(x):U.preventDefault()}),onFocus:dn(e.onFocus,()=>w.onItemFocus(x)),onKeyDown:dn(e.onKeyDown,U=>{if(U.key==="Tab"&&U.shiftKey){w.onItemShiftTab();return}if(U.target!==U.currentTarget)return;const I=rpe(U,w.orientation,w.dir);if(I!==void 0){if(U.metaKey||U.ctrlKey||U.altKey||U.shiftKey)return;U.preventDefault();let H=T().filter(K=>K.focusable).map(K=>K.ref.current);if(I==="last")H.reverse();else if(I==="prev"||I==="next"){I==="prev"&&H.reverse();const K=H.indexOf(U.currentTarget);H=w.loop?npe(H,K+1):H.slice(K+1)}setTimeout(()=>aK(H))}})})})});iK.displayName=nK;var epe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function tpe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function rpe(e,t,r){const n=tpe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return epe[n]}function aK(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function npe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var ipe=rK,ape=iK,spe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Yx=new WeakMap,DS=new WeakMap,FS={},mP=0,sK=function(e){return e&&(e.host||sK(e.parentNode))},ope=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=sK(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},lpe=function(e,t,r,n){var a=ope(t,Array.isArray(e)?e:[e]);FS[r]||(FS[r]=new WeakMap);var c=FS[r],h=[],i=new Set,x=new Set(a),w=function(T){!T||i.has(T)||(i.add(T),w(T.parentNode))};a.forEach(w);var S=function(T){!T||x.has(T)||Array.prototype.forEach.call(T.children,function(E){if(i.has(E))S(E);else try{var D=E.getAttribute(n),U=D!==null&&D!=="false",I=(Yx.get(E)||0)+1,V=(c.get(E)||0)+1;Yx.set(E,I),c.set(E,V),h.push(E),I===1&&U&&DS.set(E,!0),V===1&&E.setAttribute(r,"true"),U||E.setAttribute(n,"true")}catch(H){console.error("aria-hidden: cannot operate on ",E,H)}})};return S(t),i.clear(),mP++,function(){h.forEach(function(T){var E=Yx.get(T)-1,D=c.get(T)-1;Yx.set(T,E),c.set(T,D),E||(DS.has(T)||T.removeAttribute(n),DS.delete(T)),D||T.removeAttribute(r)}),mP--,mP||(Yx=new WeakMap,Yx=new WeakMap,DS=new WeakMap,FS={})}},IT=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=spe(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live]"))),lpe(n,a,r,"aria-hidden")):function(){return null}},Gf=function(){return Gf=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},Gf.apply(this,arguments)};function oK(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function cpe(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,c;n<a;n++)(c||!(n in t))&&(c||(c=Array.prototype.slice.call(t,0,n)),c[n]=t[n]);return e.concat(c||Array.prototype.slice.call(t))}var bN="right-scroll-bar-position",wN="width-before-scroll-bar",upe="with-scroll-bars-hidden",dpe="--removed-body-scroll-bar-size";function gP(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function hpe(e,t){var r=G.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var fpe=typeof window<"u"?G.useLayoutEffect:G.useEffect,g6=new WeakMap;function ppe(e,t){var r=hpe(null,function(n){return e.forEach(function(a){return gP(a,n)})});return fpe(function(){var n=g6.get(r);if(n){var a=new Set(n),c=new Set(e),h=r.current;a.forEach(function(i){c.has(i)||gP(i,null)}),c.forEach(function(i){a.has(i)||gP(i,h)})}g6.set(r,e)},[e]),r}function mpe(e){return e}function gpe(e,t){t===void 0&&(t=mpe);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(c){var h=t(c,n);return r.push(h),function(){r=r.filter(function(i){return i!==h})}},assignSyncMedium:function(c){for(n=!0;r.length;){var h=r;r=[],h.forEach(c)}r={push:function(i){return c(i)},filter:function(){return r}}},assignMedium:function(c){n=!0;var h=[];if(r.length){var i=r;r=[],i.forEach(c),h=r}var x=function(){var S=h;h=[],S.forEach(c)},w=function(){return Promise.resolve().then(x)};w(),r={push:function(S){h.push(S),w()},filter:function(S){return h=h.filter(S),r}}}};return a}function ype(e){e===void 0&&(e={});var t=gpe(null);return t.options=Gf({async:!0,ssr:!1},e),t}var lK=function(e){var t=e.sideCar,r=oK(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return G.createElement(n,Gf({},r))};lK.isSideCarExport=!0;function xpe(e,t){return e.useMedium(t),lK}var cK=ype(),yP=function(){},LT=G.forwardRef(function(e,t){var r=G.useRef(null),n=G.useState({onScrollCapture:yP,onWheelCapture:yP,onTouchMoveCapture:yP}),a=n[0],c=n[1],h=e.forwardProps,i=e.children,x=e.className,w=e.removeScrollBar,S=e.enabled,T=e.shards,E=e.sideCar,D=e.noIsolation,U=e.inert,I=e.allowPinchZoom,V=e.as,H=V===void 0?"div":V,K=e.gapMode,Q=oK(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),ae=E,ee=ppe([r,t]),se=Gf(Gf({},Q),a);return G.createElement(G.Fragment,null,S&&G.createElement(ae,{sideCar:cK,removeScrollBar:w,shards:T,noIsolation:D,inert:U,setCallbacks:c,allowPinchZoom:!!I,lockRef:r,gapMode:K}),h?G.cloneElement(G.Children.only(i),Gf(Gf({},se),{ref:ee})):G.createElement(H,Gf({},se,{className:x,ref:ee}),i))});LT.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};LT.classNames={fullWidth:wN,zeroRight:bN};var vpe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function _pe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=vpe();return t&&e.setAttribute("nonce",t),e}function bpe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function wpe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Spe=function(){var e=0,t=null;return{add:function(r){e==0&&(t=_pe())&&(bpe(t,r),wpe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Npe=function(){var e=Spe();return function(t,r){G.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},uK=function(){var e=Npe(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},Ape={left:0,top:0,right:0,gap:0},xP=function(e){return parseInt(e||"",10)||0},Tpe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[xP(r),xP(n),xP(a)]},jpe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Ape;var t=Tpe(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},kpe=uK(),bv="data-scroll-locked",Ppe=function(e,t,r,n){var a=e.left,c=e.top,h=e.right,i=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(upe,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(i,"px ").concat(n,`;
  }
  body[`).concat(bv,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(c,`px;
    padding-right: `).concat(h,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(i,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(bN,` {
    right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(wN,` {
    margin-right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(bN," .").concat(bN,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(wN," .").concat(wN,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(bv,`] {
    `).concat(dpe,": ").concat(i,`px;
  }
`)},y6=function(){var e=parseInt(document.body.getAttribute(bv)||"0",10);return isFinite(e)?e:0},Cpe=function(){G.useEffect(function(){return document.body.setAttribute(bv,(y6()+1).toString()),function(){var e=y6()-1;e<=0?document.body.removeAttribute(bv):document.body.setAttribute(bv,e.toString())}},[])},Epe=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;Cpe();var c=G.useMemo(function(){return jpe(a)},[a]);return G.createElement(kpe,{styles:Ppe(c,!t,a,r?"":"!important")})},bR=!1;if(typeof window<"u")try{var zS=Object.defineProperty({},"passive",{get:function(){return bR=!0,!0}});window.addEventListener("test",zS,zS),window.removeEventListener("test",zS,zS)}catch{bR=!1}var Xx=bR?{passive:!1}:!1,Mpe=function(e){return e.tagName==="TEXTAREA"},dK=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Mpe(e)&&r[t]==="visible")},Ope=function(e){return dK(e,"overflowY")},Rpe=function(e){return dK(e,"overflowX")},x6=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=hK(e,n);if(a){var c=fK(e,n),h=c[1],i=c[2];if(h>i)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Ipe=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Lpe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},hK=function(e,t){return e==="v"?Ope(t):Rpe(t)},fK=function(e,t){return e==="v"?Ipe(t):Lpe(t)},Dpe=function(e,t){return e==="h"&&t==="rtl"?-1:1},Fpe=function(e,t,r,n,a){var c=Dpe(e,window.getComputedStyle(t).direction),h=c*n,i=r.target,x=t.contains(i),w=!1,S=h>0,T=0,E=0;do{var D=fK(e,i),U=D[0],I=D[1],V=D[2],H=I-V-c*U;(U||H)&&hK(e,i)&&(T+=H,E+=U),i instanceof ShadowRoot?i=i.host:i=i.parentNode}while(!x&&i!==document.body||x&&(t.contains(i)||t===i));return(S&&Math.abs(T)<1||!S&&Math.abs(E)<1)&&(w=!0),w},BS=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},v6=function(e){return[e.deltaX,e.deltaY]},_6=function(e){return e&&"current"in e?e.current:e},zpe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Bpe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Vpe=0,Jx=[];function Upe(e){var t=G.useRef([]),r=G.useRef([0,0]),n=G.useRef(),a=G.useState(Vpe++)[0],c=G.useState(uK)[0],h=G.useRef(e);G.useEffect(function(){h.current=e},[e]),G.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var I=cpe([e.lockRef.current],(e.shards||[]).map(_6),!0).filter(Boolean);return I.forEach(function(V){return V.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),I.forEach(function(V){return V.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var i=G.useCallback(function(I,V){if("touches"in I&&I.touches.length===2||I.type==="wheel"&&I.ctrlKey)return!h.current.allowPinchZoom;var H=BS(I),K=r.current,Q="deltaX"in I?I.deltaX:K[0]-H[0],ae="deltaY"in I?I.deltaY:K[1]-H[1],ee,se=I.target,ue=Math.abs(Q)>Math.abs(ae)?"h":"v";if("touches"in I&&ue==="h"&&se.type==="range")return!1;var he=x6(ue,se);if(!he)return!0;if(he?ee=ue:(ee=ue==="v"?"h":"v",he=x6(ue,se)),!he)return!1;if(!n.current&&"changedTouches"in I&&(Q||ae)&&(n.current=ee),!ee)return!0;var Ce=n.current||ee;return Fpe(Ce,V,I,Ce==="h"?Q:ae)},[]),x=G.useCallback(function(I){var V=I;if(!(!Jx.length||Jx[Jx.length-1]!==c)){var H="deltaY"in V?v6(V):BS(V),K=t.current.filter(function(ee){return ee.name===V.type&&(ee.target===V.target||V.target===ee.shadowParent)&&zpe(ee.delta,H)})[0];if(K&&K.should){V.cancelable&&V.preventDefault();return}if(!K){var Q=(h.current.shards||[]).map(_6).filter(Boolean).filter(function(ee){return ee.contains(V.target)}),ae=Q.length>0?i(V,Q[0]):!h.current.noIsolation;ae&&V.cancelable&&V.preventDefault()}}},[]),w=G.useCallback(function(I,V,H,K){var Q={name:I,delta:V,target:H,should:K,shadowParent:$pe(H)};t.current.push(Q),setTimeout(function(){t.current=t.current.filter(function(ae){return ae!==Q})},1)},[]),S=G.useCallback(function(I){r.current=BS(I),n.current=void 0},[]),T=G.useCallback(function(I){w(I.type,v6(I),I.target,i(I,e.lockRef.current))},[]),E=G.useCallback(function(I){w(I.type,BS(I),I.target,i(I,e.lockRef.current))},[]);G.useEffect(function(){return Jx.push(c),e.setCallbacks({onScrollCapture:T,onWheelCapture:T,onTouchMoveCapture:E}),document.addEventListener("wheel",x,Xx),document.addEventListener("touchmove",x,Xx),document.addEventListener("touchstart",S,Xx),function(){Jx=Jx.filter(function(I){return I!==c}),document.removeEventListener("wheel",x,Xx),document.removeEventListener("touchmove",x,Xx),document.removeEventListener("touchstart",S,Xx)}},[]);var D=e.removeScrollBar,U=e.inert;return G.createElement(G.Fragment,null,U?G.createElement(c,{styles:Bpe(a)}):null,D?G.createElement(Epe,{gapMode:e.gapMode}):null)}function $pe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const qpe=xpe(cK,Upe);var Jw=G.forwardRef(function(e,t){return G.createElement(LT,Gf({},e,{ref:t,sideCar:qpe}))});Jw.classNames=LT.classNames;var wR=["Enter"," "],Gpe=["ArrowDown","PageUp","Home"],pK=["ArrowUp","PageDown","End"],Wpe=[...Gpe,...pK],Hpe={ltr:[...wR,"ArrowRight"],rtl:[...wR,"ArrowLeft"]},Kpe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Qw="Menu",[M1,Zpe,Ype]=d4(Qw),[Q0,mK]=qd(Qw,[Ype,cy,tK]),DT=cy(),gK=tK(),[Xpe,ex]=Q0(Qw),[Jpe,e2]=Q0(Qw),yK=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:a,onOpenChange:c,modal:h=!0}=e,i=DT(t),[x,w]=G.useState(null),S=G.useRef(!1),T=zu(c),E=h4(a);return G.useEffect(()=>{const D=()=>{S.current=!0,document.addEventListener("pointerdown",U,{capture:!0,once:!0}),document.addEventListener("pointermove",U,{capture:!0,once:!0})},U=()=>S.current=!1;return document.addEventListener("keydown",D,{capture:!0}),()=>{document.removeEventListener("keydown",D,{capture:!0}),document.removeEventListener("pointerdown",U,{capture:!0}),document.removeEventListener("pointermove",U,{capture:!0})}},[]),o.jsx(ET,{...i,children:o.jsx(Xpe,{scope:t,open:r,onOpenChange:T,content:x,onContentChange:w,children:o.jsx(Jpe,{scope:t,onClose:G.useCallback(()=>T(!1),[T]),isUsingKeyboardRef:S,dir:E,modal:h,children:n})})})};yK.displayName=Qw;var Qpe="MenuAnchor",w4=G.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=DT(r);return o.jsx(Xw,{...a,...n,ref:t})});w4.displayName=Qpe;var S4="MenuPortal",[eme,xK]=Q0(S4,{forceMount:void 0}),vK=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:a}=e,c=ex(S4,t);return o.jsx(eme,{scope:t,forceMount:r,children:o.jsx($u,{present:r||c.open,children:o.jsx(S_,{asChild:!0,container:a,children:n})})})};vK.displayName=S4;var Dd="MenuContent",[tme,N4]=Q0(Dd),_K=G.forwardRef((e,t)=>{const r=xK(Dd,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,c=ex(Dd,e.__scopeMenu),h=e2(Dd,e.__scopeMenu);return o.jsx(M1.Provider,{scope:e.__scopeMenu,children:o.jsx($u,{present:n||c.open,children:o.jsx(M1.Slot,{scope:e.__scopeMenu,children:h.modal?o.jsx(rme,{...a,ref:t}):o.jsx(nme,{...a,ref:t})})})})}),rme=G.forwardRef((e,t)=>{const r=ex(Dd,e.__scopeMenu),n=G.useRef(null),a=ta(t,n);return G.useEffect(()=>{const c=n.current;if(c)return IT(c)},[]),o.jsx(A4,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:dn(e.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),nme=G.forwardRef((e,t)=>{const r=ex(Dd,e.__scopeMenu);return o.jsx(A4,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),A4=G.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:c,onCloseAutoFocus:h,disableOutsidePointerEvents:i,onEntryFocus:x,onEscapeKeyDown:w,onPointerDownOutside:S,onFocusOutside:T,onInteractOutside:E,onDismiss:D,disableOutsideScroll:U,...I}=e,V=ex(Dd,r),H=e2(Dd,r),K=DT(r),Q=gK(r),ae=Zpe(r),[ee,se]=G.useState(null),ue=G.useRef(null),he=ta(t,ue,V.onContentChange),Ce=G.useRef(0),Ne=G.useRef(""),me=G.useRef(0),be=G.useRef(null),pe=G.useRef("right"),Se=G.useRef(0),Ee=U?Jw:G.Fragment,we=U?{as:nc,allowPinchZoom:!0}:void 0,Pe=Be=>{var rr,or;const Ge=Ne.current+Be,We=ae().filter(Ft=>!Ft.disabled),tt=document.activeElement,nt=(rr=We.find(Ft=>Ft.ref.current===tt))==null?void 0:rr.textValue,Dt=We.map(Ft=>Ft.textValue),nr=mme(Dt,Ge,nt),ir=(or=We.find(Ft=>Ft.textValue===nr))==null?void 0:or.ref.current;(function Ft(ze){Ne.current=ze,window.clearTimeout(Ce.current),ze!==""&&(Ce.current=window.setTimeout(()=>Ft(""),1e3))})(Ge),ir&&setTimeout(()=>ir.focus())};G.useEffect(()=>()=>window.clearTimeout(Ce.current),[]),jT();const Me=G.useCallback(Be=>{var We,tt;return pe.current===((We=be.current)==null?void 0:We.side)&&yme(Be,(tt=be.current)==null?void 0:tt.area)},[]);return o.jsx(tme,{scope:r,searchRef:Ne,onItemEnter:G.useCallback(Be=>{Me(Be)&&Be.preventDefault()},[Me]),onItemLeave:G.useCallback(Be=>{var Ge;Me(Be)||((Ge=ue.current)==null||Ge.focus(),se(null))},[Me]),onTriggerLeave:G.useCallback(Be=>{Me(Be)&&Be.preventDefault()},[Me]),pointerGraceTimerRef:me,onPointerGraceIntentChange:G.useCallback(Be=>{be.current=Be},[]),children:o.jsx(Ee,{...we,children:o.jsx(Zw,{asChild:!0,trapped:a,onMountAutoFocus:dn(c,Be=>{var Ge;Be.preventDefault(),(Ge=ue.current)==null||Ge.focus({preventScroll:!0})}),onUnmountAutoFocus:h,children:o.jsx(__,{asChild:!0,disableOutsidePointerEvents:i,onEscapeKeyDown:w,onPointerDownOutside:S,onFocusOutside:T,onInteractOutside:E,onDismiss:D,children:o.jsx(ipe,{asChild:!0,...Q,dir:H.dir,orientation:"vertical",loop:n,currentTabStopId:ee,onCurrentTabStopIdChange:se,onEntryFocus:dn(x,Be=>{H.isUsingKeyboardRef.current||Be.preventDefault()}),preventScrollOnEntryFocus:!0,children:o.jsx(MT,{role:"menu","aria-orientation":"vertical","data-state":LK(V.open),"data-radix-menu-content":"",dir:H.dir,...K,...I,ref:he,style:{outline:"none",...I.style},onKeyDown:dn(I.onKeyDown,Be=>{const We=Be.target.closest("[data-radix-menu-content]")===Be.currentTarget,tt=Be.ctrlKey||Be.altKey||Be.metaKey,nt=Be.key.length===1;We&&(Be.key==="Tab"&&Be.preventDefault(),!tt&&nt&&Pe(Be.key));const Dt=ue.current;if(Be.target!==Dt||!Wpe.includes(Be.key))return;Be.preventDefault();const ir=ae().filter(rr=>!rr.disabled).map(rr=>rr.ref.current);pK.includes(Be.key)&&ir.reverse(),fme(ir)}),onBlur:dn(e.onBlur,Be=>{Be.currentTarget.contains(Be.target)||(window.clearTimeout(Ce.current),Ne.current="")}),onPointerMove:dn(e.onPointerMove,O1(Be=>{const Ge=Be.target,We=Se.current!==Be.clientX;if(Be.currentTarget.contains(Ge)&&We){const tt=Be.clientX>Se.current?"right":"left";pe.current=tt,Se.current=Be.clientX}}))})})})})})})});_K.displayName=Dd;var ime="MenuGroup",T4=G.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return o.jsx(gi.div,{role:"group",...n,ref:t})});T4.displayName=ime;var ame="MenuLabel",bK=G.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return o.jsx(gi.div,{...n,ref:t})});bK.displayName=ame;var qN="MenuItem",b6="menu.itemSelect",FT=G.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...a}=e,c=G.useRef(null),h=e2(qN,e.__scopeMenu),i=N4(qN,e.__scopeMenu),x=ta(t,c),w=G.useRef(!1),S=()=>{const T=c.current;if(!r&&T){const E=new CustomEvent(b6,{bubbles:!0,cancelable:!0});T.addEventListener(b6,D=>n==null?void 0:n(D),{once:!0}),CH(T,E),E.defaultPrevented?w.current=!1:h.onClose()}};return o.jsx(wK,{...a,ref:x,disabled:r,onClick:dn(e.onClick,S),onPointerDown:T=>{var E;(E=e.onPointerDown)==null||E.call(e,T),w.current=!0},onPointerUp:dn(e.onPointerUp,T=>{var E;w.current||(E=T.currentTarget)==null||E.click()}),onKeyDown:dn(e.onKeyDown,T=>{const E=i.searchRef.current!=="";r||E&&T.key===" "||wR.includes(T.key)&&(T.currentTarget.click(),T.preventDefault())})})});FT.displayName=qN;var wK=G.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:a,...c}=e,h=N4(qN,r),i=gK(r),x=G.useRef(null),w=ta(t,x),[S,T]=G.useState(!1),[E,D]=G.useState("");return G.useEffect(()=>{const U=x.current;U&&D((U.textContent??"").trim())},[c.children]),o.jsx(M1.ItemSlot,{scope:r,disabled:n,textValue:a??E,children:o.jsx(ape,{asChild:!0,...i,focusable:!n,children:o.jsx(gi.div,{role:"menuitem","data-highlighted":S?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...c,ref:w,onPointerMove:dn(e.onPointerMove,O1(U=>{n?h.onItemLeave(U):(h.onItemEnter(U),U.defaultPrevented||U.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:dn(e.onPointerLeave,O1(U=>h.onItemLeave(U))),onFocus:dn(e.onFocus,()=>T(!0)),onBlur:dn(e.onBlur,()=>T(!1))})})})}),sme="MenuCheckboxItem",SK=G.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...a}=e;return o.jsx(kK,{scope:e.__scopeMenu,checked:r,children:o.jsx(FT,{role:"menuitemcheckbox","aria-checked":GN(r)?"mixed":r,...a,ref:t,"data-state":k4(r),onSelect:dn(a.onSelect,()=>n==null?void 0:n(GN(r)?!0:!r),{checkForDefaultPrevented:!1})})})});SK.displayName=sme;var NK="MenuRadioGroup",[ome,lme]=Q0(NK,{value:void 0,onValueChange:()=>{}}),AK=G.forwardRef((e,t)=>{const{value:r,onValueChange:n,...a}=e,c=zu(n);return o.jsx(ome,{scope:e.__scopeMenu,value:r,onValueChange:c,children:o.jsx(T4,{...a,ref:t})})});AK.displayName=NK;var TK="MenuRadioItem",jK=G.forwardRef((e,t)=>{const{value:r,...n}=e,a=lme(TK,e.__scopeMenu),c=r===a.value;return o.jsx(kK,{scope:e.__scopeMenu,checked:c,children:o.jsx(FT,{role:"menuitemradio","aria-checked":c,...n,ref:t,"data-state":k4(c),onSelect:dn(n.onSelect,()=>{var h;return(h=a.onValueChange)==null?void 0:h.call(a,r)},{checkForDefaultPrevented:!1})})})});jK.displayName=TK;var j4="MenuItemIndicator",[kK,cme]=Q0(j4,{checked:!1}),PK=G.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...a}=e,c=cme(j4,r);return o.jsx($u,{present:n||GN(c.checked)||c.checked===!0,children:o.jsx(gi.span,{...a,ref:t,"data-state":k4(c.checked)})})});PK.displayName=j4;var ume="MenuSeparator",CK=G.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return o.jsx(gi.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});CK.displayName=ume;var dme="MenuArrow",EK=G.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=DT(r);return o.jsx(OT,{...a,...n,ref:t})});EK.displayName=dme;var hme="MenuSub",[O$e,MK]=Q0(hme),Qb="MenuSubTrigger",OK=G.forwardRef((e,t)=>{const r=ex(Qb,e.__scopeMenu),n=e2(Qb,e.__scopeMenu),a=MK(Qb,e.__scopeMenu),c=N4(Qb,e.__scopeMenu),h=G.useRef(null),{pointerGraceTimerRef:i,onPointerGraceIntentChange:x}=c,w={__scopeMenu:e.__scopeMenu},S=G.useCallback(()=>{h.current&&window.clearTimeout(h.current),h.current=null},[]);return G.useEffect(()=>S,[S]),G.useEffect(()=>{const T=i.current;return()=>{window.clearTimeout(T),x(null)}},[i,x]),o.jsx(w4,{asChild:!0,...w,children:o.jsx(wK,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":LK(r.open),...e,ref:NT(t,a.onTriggerChange),onClick:T=>{var E;(E=e.onClick)==null||E.call(e,T),!(e.disabled||T.defaultPrevented)&&(T.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:dn(e.onPointerMove,O1(T=>{c.onItemEnter(T),!T.defaultPrevented&&!e.disabled&&!r.open&&!h.current&&(c.onPointerGraceIntentChange(null),h.current=window.setTimeout(()=>{r.onOpenChange(!0),S()},100))})),onPointerLeave:dn(e.onPointerLeave,O1(T=>{var D,U;S();const E=(D=r.content)==null?void 0:D.getBoundingClientRect();if(E){const I=(U=r.content)==null?void 0:U.dataset.side,V=I==="right",H=V?-5:5,K=E[V?"left":"right"],Q=E[V?"right":"left"];c.onPointerGraceIntentChange({area:[{x:T.clientX+H,y:T.clientY},{x:K,y:E.top},{x:Q,y:E.top},{x:Q,y:E.bottom},{x:K,y:E.bottom}],side:I}),window.clearTimeout(i.current),i.current=window.setTimeout(()=>c.onPointerGraceIntentChange(null),300)}else{if(c.onTriggerLeave(T),T.defaultPrevented)return;c.onPointerGraceIntentChange(null)}})),onKeyDown:dn(e.onKeyDown,T=>{var D;const E=c.searchRef.current!=="";e.disabled||E&&T.key===" "||Hpe[n.dir].includes(T.key)&&(r.onOpenChange(!0),(D=r.content)==null||D.focus(),T.preventDefault())})})})});OK.displayName=Qb;var RK="MenuSubContent",IK=G.forwardRef((e,t)=>{const r=xK(Dd,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,c=ex(Dd,e.__scopeMenu),h=e2(Dd,e.__scopeMenu),i=MK(RK,e.__scopeMenu),x=G.useRef(null),w=ta(t,x);return o.jsx(M1.Provider,{scope:e.__scopeMenu,children:o.jsx($u,{present:n||c.open,children:o.jsx(M1.Slot,{scope:e.__scopeMenu,children:o.jsx(A4,{id:i.contentId,"aria-labelledby":i.triggerId,...a,ref:w,align:"start",side:h.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:S=>{var T;h.isUsingKeyboardRef.current&&((T=x.current)==null||T.focus()),S.preventDefault()},onCloseAutoFocus:S=>S.preventDefault(),onFocusOutside:dn(e.onFocusOutside,S=>{S.target!==i.trigger&&c.onOpenChange(!1)}),onEscapeKeyDown:dn(e.onEscapeKeyDown,S=>{h.onClose(),S.preventDefault()}),onKeyDown:dn(e.onKeyDown,S=>{var D;const T=S.currentTarget.contains(S.target),E=Kpe[h.dir].includes(S.key);T&&E&&(c.onOpenChange(!1),(D=i.trigger)==null||D.focus(),S.preventDefault())})})})})})});IK.displayName=RK;function LK(e){return e?"open":"closed"}function GN(e){return e==="indeterminate"}function k4(e){return GN(e)?"indeterminate":e?"checked":"unchecked"}function fme(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function pme(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function mme(e,t,r){const a=t.length>1&&Array.from(t).every(w=>w===t[0])?t[0]:t,c=r?e.indexOf(r):-1;let h=pme(e,Math.max(c,0));a.length===1&&(h=h.filter(w=>w!==r));const x=h.find(w=>w.toLowerCase().startsWith(a.toLowerCase()));return x!==r?x:void 0}function gme(e,t){const{x:r,y:n}=e;let a=!1;for(let c=0,h=t.length-1;c<t.length;h=c++){const i=t[c].x,x=t[c].y,w=t[h].x,S=t[h].y;x>n!=S>n&&r<(w-i)*(n-x)/(S-x)+i&&(a=!a)}return a}function yme(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return gme(r,t)}function O1(e){return t=>t.pointerType==="mouse"?e(t):void 0}var xme=yK,vme=w4,_me=vK,bme=_K,wme=T4,Sme=bK,Nme=FT,Ame=SK,Tme=AK,jme=jK,kme=PK,Pme=CK,Cme=EK,Eme=OK,Mme=IK,P4="DropdownMenu",[Ome,R$e]=qd(P4,[mK]),Tc=mK(),[Rme,DK]=Ome(P4),FK=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:a,defaultOpen:c,onOpenChange:h,modal:i=!0}=e,x=Tc(t),w=G.useRef(null),[S=!1,T]=Jg({prop:a,defaultProp:c,onChange:h});return o.jsx(Rme,{scope:t,triggerId:Ld(),triggerRef:w,contentId:Ld(),open:S,onOpenChange:T,onOpenToggle:G.useCallback(()=>T(E=>!E),[T]),modal:i,children:o.jsx(xme,{...x,open:S,onOpenChange:T,dir:n,modal:i,children:r})})};FK.displayName=P4;var zK="DropdownMenuTrigger",C4=G.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...a}=e,c=DK(zK,r),h=Tc(r);return o.jsx(vme,{asChild:!0,...h,children:o.jsx(gi.button,{type:"button",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":c.open,"aria-controls":c.open?c.contentId:void 0,"data-state":c.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:NT(t,c.triggerRef),onPointerDown:dn(e.onPointerDown,i=>{!n&&i.button===0&&i.ctrlKey===!1&&(c.onOpenToggle(),c.open||i.preventDefault())}),onKeyDown:dn(e.onKeyDown,i=>{n||(["Enter"," "].includes(i.key)&&c.onOpenToggle(),i.key==="ArrowDown"&&c.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(i.key)&&i.preventDefault())})})})});C4.displayName=zK;var Ime="DropdownMenuPortal",BK=e=>{const{__scopeDropdownMenu:t,...r}=e,n=Tc(t);return o.jsx(_me,{...n,...r})};BK.displayName=Ime;var VK="DropdownMenuContent",UK=G.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=DK(VK,r),c=Tc(r),h=G.useRef(!1);return o.jsx(bme,{id:a.contentId,"aria-labelledby":a.triggerId,...c,...n,ref:t,onCloseAutoFocus:dn(e.onCloseAutoFocus,i=>{var x;h.current||(x=a.triggerRef.current)==null||x.focus(),h.current=!1,i.preventDefault()}),onInteractOutside:dn(e.onInteractOutside,i=>{const x=i.detail.originalEvent,w=x.button===0&&x.ctrlKey===!0,S=x.button===2||w;(!a.modal||S)&&(h.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});UK.displayName=VK;var Lme="DropdownMenuGroup",$K=G.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Tc(r);return o.jsx(wme,{...a,...n,ref:t})});$K.displayName=Lme;var Dme="DropdownMenuLabel",qK=G.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Tc(r);return o.jsx(Sme,{...a,...n,ref:t})});qK.displayName=Dme;var Fme="DropdownMenuItem",GK=G.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Tc(r);return o.jsx(Nme,{...a,...n,ref:t})});GK.displayName=Fme;var zme="DropdownMenuCheckboxItem",WK=G.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Tc(r);return o.jsx(Ame,{...a,...n,ref:t})});WK.displayName=zme;var Bme="DropdownMenuRadioGroup",Vme=G.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Tc(r);return o.jsx(Tme,{...a,...n,ref:t})});Vme.displayName=Bme;var Ume="DropdownMenuRadioItem",HK=G.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Tc(r);return o.jsx(jme,{...a,...n,ref:t})});HK.displayName=Ume;var $me="DropdownMenuItemIndicator",KK=G.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Tc(r);return o.jsx(kme,{...a,...n,ref:t})});KK.displayName=$me;var qme="DropdownMenuSeparator",ZK=G.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Tc(r);return o.jsx(Pme,{...a,...n,ref:t})});ZK.displayName=qme;var Gme="DropdownMenuArrow",Wme=G.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Tc(r);return o.jsx(Cme,{...a,...n,ref:t})});Wme.displayName=Gme;var Hme="DropdownMenuSubTrigger",YK=G.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Tc(r);return o.jsx(Eme,{...a,...n,ref:t})});YK.displayName=Hme;var Kme="DropdownMenuSubContent",XK=G.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Tc(r);return o.jsx(Mme,{...a,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});XK.displayName=Kme;var Zme=FK,Yme=C4,Xme=BK,JK=UK,Jme=$K,QK=qK,eZ=GK,tZ=WK,rZ=HK,nZ=KK,iZ=ZK,aZ=YK,sZ=XK;const Yh=Zme,op=Yme,Qme=Jme,ege=G.forwardRef(({className:e,inset:t,children:r,...n},a)=>o.jsxs(aZ,{ref:a,className:zt("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n,children:[r,o.jsx(z0,{className:"ml-auto"})]}));ege.displayName=aZ.displayName;const tge=G.forwardRef(({className:e,...t},r)=>o.jsx(sZ,{ref:r,className:zt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));tge.displayName=sZ.displayName;const Bd=G.forwardRef(({className:e,sideOffset:t=4,...r},n)=>o.jsx(Xme,{children:o.jsx(JK,{ref:n,sideOffset:t,className:zt("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md scrollbar-transparent","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));Bd.displayName=JK.displayName;const es=G.forwardRef(({className:e,inset:t,...r},n)=>o.jsx(eZ,{ref:n,className:zt("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",t&&"pl-8",e),...r}));es.displayName=eZ.displayName;const oZ=G.forwardRef(({className:e,children:t,checked:r,...n},a)=>o.jsxs(tZ,{ref:a,className:zt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(nZ,{children:o.jsx(a4,{className:"h-4 w-4"})})}),t]}));oZ.displayName=tZ.displayName;const rge=G.forwardRef(({className:e,children:t,...r},n)=>o.jsxs(rZ,{ref:n,className:zt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(nZ,{children:o.jsx(ade,{className:"h-2 w-2 fill-current"})})}),t]}));rge.displayName=rZ.displayName;const N_=G.forwardRef(({className:e,inset:t,...r},n)=>o.jsx(QK,{ref:n,className:zt("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));N_.displayName=QK.displayName;const Am=G.forwardRef(({className:e,...t},r)=>o.jsx(iZ,{ref:r,className:zt("-mx-1 my-1 h-px bg-muted",e),...t}));Am.displayName=iZ.displayName;const lZ=G.createContext({theme:"system",setTheme:()=>null});function nge({children:e,defaultTheme:t="system",storageKey:r="vite-ui-theme",...n}){const[a,c]=G.useState(()=>localStorage.getItem(r)||t);G.useEffect(()=>{const i=window.document.documentElement;if(i.classList.remove("light","dark"),a==="system"){const x=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i.classList.add(x);return}i.classList.add(a)},[a]);const h={theme:a,setTheme:i=>{localStorage.setItem(r,i),c(i)}};return o.jsx(lZ.Provider,{...n,value:h,children:e})}const cZ=()=>{const e=G.useContext(lZ);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e};function ige(){const{theme:e,setTheme:t}=cZ();return o.jsxs(Yh,{children:[o.jsx(op,{asChild:!0,children:o.jsxs(ur,{variant:"outline",size:"icon",children:[o.jsx(e6,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),o.jsx(QB,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),o.jsx("span",{className:"sr-only",children:"Toggle theme"})]})}),o.jsxs(Bd,{align:"end",children:[o.jsxs(es,{className:e==="light"&&" border-2 border-primary",onClick:()=>t("light"),children:[o.jsx(e6,{className:"mr-2 h-4 w-4"}),"Light"]}),o.jsxs(es,{className:e==="dark"&&" border-2 border-primary",onClick:()=>t("dark"),children:[o.jsx(QB,{className:"mr-2 h-4 w-4"}),"Dark"]}),o.jsxs(es,{className:e==="system"&&" border-2 border-primary",onClick:()=>t("system"),children:[o.jsx(lde,{className:"mr-2 h-4 w-4"}),"System"]})]})]})}const Yr=G.forwardRef(({className:e,type:t,...r},n)=>o.jsx("input",{type:t,className:zt("flex h-9 w-full rounded-md border border-input dark:border-[#424242] bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));Yr.displayName="Input";function w6(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function uZ(...e){return t=>{let r=!1;const n=e.map(a=>{const c=w6(a,t);return!r&&typeof c=="function"&&(r=!0),c});if(r)return()=>{for(let a=0;a<n.length;a++){const c=n[a];typeof c=="function"?c():w6(e[a],null)}}}}function E4(...e){return G.useCallback(uZ(...e),e)}function age(e,t=[]){let r=[];function n(c,h){const i=G.createContext(h),x=r.length;r=[...r,h];const w=T=>{var H;const{scope:E,children:D,...U}=T,I=((H=E==null?void 0:E[e])==null?void 0:H[x])||i,V=G.useMemo(()=>U,Object.values(U));return o.jsx(I.Provider,{value:V,children:D})};w.displayName=c+"Provider";function S(T,E){var I;const D=((I=E==null?void 0:E[e])==null?void 0:I[x])||i,U=G.useContext(D);if(U)return U;if(h!==void 0)return h;throw new Error(`\`${T}\` must be used within \`${c}\``)}return[w,S]}const a=()=>{const c=r.map(h=>G.createContext(h));return function(i){const x=(i==null?void 0:i[e])||c;return G.useMemo(()=>({[`__scope${e}`]:{...i,[e]:x}}),[i,x])}};return a.scopeName=e,[n,sge(a,...t)]}function sge(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const h=n.reduce((i,{useScope:x,scopeName:w})=>{const T=x(c)[`__scope${w}`];return{...i,...T}},{});return G.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}function S6(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}var WN=globalThis!=null&&globalThis.document?G.useLayoutEffect:()=>{},oge=KW[" useInsertionEffect ".trim().toString()]||WN;function lge({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,c,h]=cge({defaultProp:t,onChange:r}),i=e!==void 0,x=i?e:a;{const S=G.useRef(e!==void 0);G.useEffect(()=>{const T=S.current;T!==i&&console.warn(`${n} is changing from ${T?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),S.current=i},[i,n])}const w=G.useCallback(S=>{var T;if(i){const E=uge(S)?S(e):S;E!==e&&((T=h.current)==null||T.call(h,E))}else c(S)},[i,e,c,h]);return[x,w]}function cge({defaultProp:e,onChange:t}){const[r,n]=G.useState(e),a=G.useRef(r),c=G.useRef(t);return oge(()=>{c.current=t},[t]),G.useEffect(()=>{var h;a.current!==r&&((h=c.current)==null||h.call(c,r),a.current=r)},[r,a]),[r,n,c]}function uge(e){return typeof e=="function"}function dge(e){const t=G.useRef({value:e,previous:e});return G.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}function hge(e){const[t,r]=G.useState(void 0);return WN(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const c=a[0];let h,i;if("borderBoxSize"in c){const x=c.borderBoxSize,w=Array.isArray(x)?x[0]:x;h=w.inlineSize,i=w.blockSize}else h=e.offsetWidth,i=e.offsetHeight;r({width:h,height:i})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}function fge(e,t){return G.useReducer((r,n)=>t[r][n]??r,e)}var dZ=e=>{const{present:t,children:r}=e,n=pge(t),a=typeof r=="function"?r({present:n.isPresent}):G.Children.only(r),c=E4(n.ref,mge(a));return typeof r=="function"||n.isPresent?G.cloneElement(a,{ref:c}):null};dZ.displayName="Presence";function pge(e){const[t,r]=G.useState(),n=G.useRef(null),a=G.useRef(e),c=G.useRef("none"),h=e?"mounted":"unmounted",[i,x]=fge(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return G.useEffect(()=>{const w=VS(n.current);c.current=i==="mounted"?w:"none"},[i]),WN(()=>{const w=n.current,S=a.current;if(S!==e){const E=c.current,D=VS(w);e?x("MOUNT"):D==="none"||(w==null?void 0:w.display)==="none"?x("UNMOUNT"):x(S&&E!==D?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,x]),WN(()=>{if(t){let w;const S=t.ownerDocument.defaultView??window,T=D=>{const I=VS(n.current).includes(CSS.escape(D.animationName));if(D.target===t&&I&&(x("ANIMATION_END"),!a.current)){const V=t.style.animationFillMode;t.style.animationFillMode="forwards",w=S.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=V)})}},E=D=>{D.target===t&&(c.current=VS(n.current))};return t.addEventListener("animationstart",E),t.addEventListener("animationcancel",T),t.addEventListener("animationend",T),()=>{S.clearTimeout(w),t.removeEventListener("animationstart",E),t.removeEventListener("animationcancel",T),t.removeEventListener("animationend",T)}}else x("ANIMATION_END")},[t,x]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:G.useCallback(w=>{n.current=w?getComputedStyle(w):null,r(w)},[])}}function VS(e){return(e==null?void 0:e.animationName)||"none"}function mge(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function gge(e){const t=yge(e),r=G.forwardRef((n,a)=>{const{children:c,...h}=n,i=G.Children.toArray(c),x=i.find(vge);if(x){const w=x.props.children,S=i.map(T=>T===x?G.Children.count(w)>1?G.Children.only(null):G.isValidElement(w)?w.props.children:null:T);return o.jsx(t,{...h,ref:a,children:G.isValidElement(w)?G.cloneElement(w,void 0,S):null})}return o.jsx(t,{...h,ref:a,children:c})});return r.displayName=`${e}.Slot`,r}function yge(e){const t=G.forwardRef((r,n)=>{const{children:a,...c}=r;if(G.isValidElement(a)){const h=bge(a),i=_ge(c,a.props);return a.type!==G.Fragment&&(i.ref=n?uZ(n,h):h),G.cloneElement(a,i)}return G.Children.count(a)>1?G.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var xge=Symbol("radix.slottable");function vge(e){return G.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===xge}function _ge(e,t){const r={...t};for(const n in t){const a=e[n],c=t[n];/^on[A-Z]/.test(n)?a&&c?r[n]=(...i)=>{const x=c(...i);return a(...i),x}:a&&(r[n]=a):n==="style"?r[n]={...a,...c}:n==="className"&&(r[n]=[a,c].filter(Boolean).join(" "))}return{...e,...r}}function bge(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var wge=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],M4=wge.reduce((e,t)=>{const r=gge(`Primitive.${t}`),n=G.forwardRef((a,c)=>{const{asChild:h,...i}=a,x=h?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(x,{...i,ref:c})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{}),zT="Checkbox",[Sge,I$e]=age(zT),[Nge,O4]=Sge(zT);function Age(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:a,disabled:c,form:h,name:i,onCheckedChange:x,required:w,value:S="on",internal_do_not_use_render:T}=e,[E,D]=lge({prop:r,defaultProp:a??!1,onChange:x,caller:zT}),[U,I]=G.useState(null),[V,H]=G.useState(null),K=G.useRef(!1),Q=U?!!h||!!U.closest("form"):!0,ae={checked:E,disabled:c,setChecked:D,control:U,setControl:I,name:i,form:h,value:S,hasConsumerStoppedPropagationRef:K,required:w,defaultChecked:Kg(a)?!1:a,isFormControl:Q,bubbleInput:V,setBubbleInput:H};return o.jsx(Nge,{scope:t,...ae,children:Tge(T)?T(ae):n})}var hZ="CheckboxTrigger",fZ=G.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},a)=>{const{control:c,value:h,disabled:i,checked:x,required:w,setControl:S,setChecked:T,hasConsumerStoppedPropagationRef:E,isFormControl:D,bubbleInput:U}=O4(hZ,e),I=E4(a,S),V=G.useRef(x);return G.useEffect(()=>{const H=c==null?void 0:c.form;if(H){const K=()=>T(V.current);return H.addEventListener("reset",K),()=>H.removeEventListener("reset",K)}},[c,T]),o.jsx(M4.button,{type:"button",role:"checkbox","aria-checked":Kg(x)?"mixed":x,"aria-required":w,"data-state":xZ(x),"data-disabled":i?"":void 0,disabled:i,value:h,...n,ref:I,onKeyDown:S6(t,H=>{H.key==="Enter"&&H.preventDefault()}),onClick:S6(r,H=>{T(K=>Kg(K)?!0:!K),U&&D&&(E.current=H.isPropagationStopped(),E.current||H.stopPropagation())})})});fZ.displayName=hZ;var R4=G.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:c,required:h,disabled:i,value:x,onCheckedChange:w,form:S,...T}=e;return o.jsx(Age,{__scopeCheckbox:r,checked:a,defaultChecked:c,disabled:i,required:h,onCheckedChange:w,name:n,form:S,value:x,internal_do_not_use_render:({isFormControl:E})=>o.jsxs(o.Fragment,{children:[o.jsx(fZ,{...T,ref:t,__scopeCheckbox:r}),E&&o.jsx(yZ,{__scopeCheckbox:r})]})})});R4.displayName=zT;var pZ="CheckboxIndicator",mZ=G.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...a}=e,c=O4(pZ,r);return o.jsx(dZ,{present:n||Kg(c.checked)||c.checked===!0,children:o.jsx(M4.span,{"data-state":xZ(c.checked),"data-disabled":c.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});mZ.displayName=pZ;var gZ="CheckboxBubbleInput",yZ=G.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:a,checked:c,defaultChecked:h,required:i,disabled:x,name:w,value:S,form:T,bubbleInput:E,setBubbleInput:D}=O4(gZ,e),U=E4(r,D),I=dge(c),V=hge(n);G.useEffect(()=>{const K=E;if(!K)return;const Q=window.HTMLInputElement.prototype,ee=Object.getOwnPropertyDescriptor(Q,"checked").set,se=!a.current;if(I!==c&&ee){const ue=new Event("click",{bubbles:se});K.indeterminate=Kg(c),ee.call(K,Kg(c)?!1:c),K.dispatchEvent(ue)}},[E,I,c,a]);const H=G.useRef(Kg(c)?!1:c);return o.jsx(M4.input,{type:"checkbox","aria-hidden":!0,defaultChecked:h??H.current,required:i,disabled:x,name:w,value:S,form:T,...t,tabIndex:-1,ref:U,style:{...t.style,...V,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});yZ.displayName=gZ;function Tge(e){return typeof e=="function"}function Kg(e){return e==="indeterminate"}function xZ(e){return Kg(e)?"indeterminate":e?"checked":"unchecked"}const vZ=G.forwardRef(({className:e,...t},r)=>o.jsx(R4,{ref:r,className:zt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:o.jsx(mZ,{className:zt("flex items-center justify-center text-current"),children:o.jsx(a4,{className:"h-4 w-4"})})}));vZ.displayName=R4.displayName;var t2=e=>e.type==="checkbox",S0=e=>e instanceof Date,xc=e=>e==null;const _Z=e=>typeof e=="object";var po=e=>!xc(e)&&!Array.isArray(e)&&_Z(e)&&!S0(e),bZ=e=>po(e)&&e.target?t2(e.target)?e.target.checked:e.target.value:e,jge=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,wZ=(e,t)=>e.has(jge(t)),kge=e=>{const t=e.constructor&&e.constructor.prototype;return po(t)&&t.hasOwnProperty("isPrototypeOf")},I4=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Kc(e){let t;const r=Array.isArray(e),n=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(I4&&(e instanceof Blob||n))&&(r||po(e)))if(t=r?[]:{},!r&&!kge(e))t=e;else for(const a in e)e.hasOwnProperty(a)&&(t[a]=Kc(e[a]));else return e;return t}var BT=e=>Array.isArray(e)?e.filter(Boolean):[],co=e=>e===void 0,Gr=(e,t,r)=>{if(!t||!po(e))return r;const n=BT(t.split(/[,[\].]+?/)).reduce((a,c)=>xc(a)?a:a[c],e);return co(n)||n===e?co(e[t])?r:e[t]:n},Md=e=>typeof e=="boolean",L4=e=>/^\w*$/.test(e),SZ=e=>BT(e.replace(/["|']|\]/g,"").split(/\.|\[/)),ja=(e,t,r)=>{let n=-1;const a=L4(t)?[t]:SZ(t),c=a.length,h=c-1;for(;++n<c;){const i=a[n];let x=r;if(n!==h){const w=e[i];x=po(w)||Array.isArray(w)?w:isNaN(+a[n+1])?{}:[]}if(i==="__proto__"||i==="constructor"||i==="prototype")return;e[i]=x,e=e[i]}return e};const HN={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Bh={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},sm={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},NZ=Le.createContext(null),VT=()=>Le.useContext(NZ),Pge=e=>{const{children:t,...r}=e;return Le.createElement(NZ.Provider,{value:r},t)};var AZ=(e,t,r,n=!0)=>{const a={defaultValues:t._defaultValues};for(const c in e)Object.defineProperty(a,c,{get:()=>{const h=c;return t._proxyFormState[h]!==Bh.all&&(t._proxyFormState[h]=!n||Bh.all),r&&(r[h]=!0),e[h]}});return a},Zc=e=>po(e)&&!Object.keys(e).length,TZ=(e,t,r,n)=>{r(e);const{name:a,...c}=e;return Zc(c)||Object.keys(c).length>=Object.keys(t).length||Object.keys(c).find(h=>t[h]===(!n||Bh.all))},u1=e=>Array.isArray(e)?e:[e],jZ=(e,t,r)=>!e||!t||e===t||u1(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n)));function D4(e){const t=Le.useRef(e);t.current=e,Le.useEffect(()=>{const r=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{r&&r.unsubscribe()}},[e.disabled])}function Cge(e){const t=VT(),{control:r=t.control,disabled:n,name:a,exact:c}=e||{},[h,i]=Le.useState(r._formState),x=Le.useRef(!0),w=Le.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),S=Le.useRef(a);return S.current=a,D4({disabled:n,next:T=>x.current&&jZ(S.current,T.name,c)&&TZ(T,w.current,r._updateFormState)&&i({...r._formState,...T}),subject:r._subjects.state}),Le.useEffect(()=>(x.current=!0,w.current.isValid&&r._updateValid(!0),()=>{x.current=!1}),[r]),Le.useMemo(()=>AZ(h,r,w.current,!1),[h,r])}var Kf=e=>typeof e=="string",kZ=(e,t,r,n,a)=>Kf(e)?(n&&t.watch.add(e),Gr(r,e,a)):Array.isArray(e)?e.map(c=>(n&&t.watch.add(c),Gr(r,c))):(n&&(t.watchAll=!0),r);function SR(e){const t=VT(),{control:r=t.control,name:n,defaultValue:a,disabled:c,exact:h}=e||{},i=Le.useRef(n);i.current=n,D4({disabled:c,subject:r._subjects.values,next:S=>{jZ(i.current,S.name,h)&&w(Kc(kZ(i.current,r._names,S.values||r._formValues,!1,a)))}});const[x,w]=Le.useState(r._getWatch(n,a));return Le.useEffect(()=>r._removeUnmounted()),x}function Ege(e){const t=VT(),{name:r,disabled:n,control:a=t.control,shouldUnregister:c}=e,h=wZ(a._names.array,r),i=SR({control:a,name:r,defaultValue:Gr(a._formValues,r,Gr(a._defaultValues,r,e.defaultValue)),exact:!0}),x=Cge({control:a,name:r,exact:!0}),w=Le.useRef(a.register(r,{...e.rules,value:i,...Md(e.disabled)?{disabled:e.disabled}:{}})),S=Le.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Gr(x.errors,r)},isDirty:{enumerable:!0,get:()=>!!Gr(x.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!Gr(x.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!Gr(x.validatingFields,r)},error:{enumerable:!0,get:()=>Gr(x.errors,r)}}),[x,r]),T=Le.useMemo(()=>({name:r,value:i,...Md(n)||x.disabled?{disabled:x.disabled||n}:{},onChange:E=>w.current.onChange({target:{value:bZ(E),name:r},type:HN.CHANGE}),onBlur:()=>w.current.onBlur({target:{value:Gr(a._formValues,r),name:r},type:HN.BLUR}),ref:E=>{const D=Gr(a._fields,r);D&&E&&(D._f.ref={focus:()=>E.focus(),select:()=>E.select(),setCustomValidity:U=>E.setCustomValidity(U),reportValidity:()=>E.reportValidity()})}}),[r,a._formValues,n,x.disabled,i,a._fields]);return Le.useEffect(()=>{const E=a._options.shouldUnregister||c,D=(U,I)=>{const V=Gr(a._fields,U);V&&V._f&&(V._f.mount=I)};if(D(r,!0),E){const U=Kc(Gr(a._options.defaultValues,r));ja(a._defaultValues,r,U),co(Gr(a._formValues,r))&&ja(a._formValues,r,U)}return!h&&a.register(r),()=>{(h?E&&!a._state.action:E)?a.unregister(r):D(r,!1)}},[r,a,h,c]),Le.useEffect(()=>{a._updateDisabledField({disabled:n,fields:a._fields,name:r})},[n,r,a]),Le.useMemo(()=>({field:T,formState:x,fieldState:S}),[T,x,S])}const Mge=e=>e.render(Ege(e));var PZ=(e,t,r,n,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:a||!0}}:{},N6=e=>({isOnSubmit:!e||e===Bh.onSubmit,isOnBlur:e===Bh.onBlur,isOnChange:e===Bh.onChange,isOnAll:e===Bh.all,isOnTouch:e===Bh.onTouched}),A6=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const d1=(e,t,r,n)=>{for(const a of r||Object.keys(e)){const c=Gr(e,a);if(c){const{_f:h,...i}=c;if(h){if(h.refs&&h.refs[0]&&t(h.refs[0],a)&&!n)return!0;if(h.ref&&t(h.ref,h.name)&&!n)return!0;if(d1(i,t))break}else if(po(i)&&d1(i,t))break}}};var Oge=(e,t,r)=>{const n=u1(Gr(e,r));return ja(n,"root",t[r]),ja(e,r,n),e},F4=e=>e.type==="file",Wf=e=>typeof e=="function",KN=e=>{if(!I4)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},SN=e=>Kf(e),z4=e=>e.type==="radio",ZN=e=>e instanceof RegExp;const T6={value:!1,isValid:!1},j6={value:!0,isValid:!0};var CZ=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!co(e[0].attributes.value)?co(e[0].value)||e[0].value===""?j6:{value:e[0].value,isValid:!0}:j6:T6}return T6};const k6={isValid:!1,value:null};var EZ=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,k6):k6;function P6(e,t,r="validate"){if(SN(e)||Array.isArray(e)&&e.every(SN)||Md(e)&&!e)return{type:r,message:SN(e)?e:"",ref:t}}var Qx=e=>po(e)&&!ZN(e)?e:{value:e,message:""},C6=async(e,t,r,n,a,c)=>{const{ref:h,refs:i,required:x,maxLength:w,minLength:S,min:T,max:E,pattern:D,validate:U,name:I,valueAsNumber:V,mount:H}=e._f,K=Gr(r,I);if(!H||t.has(I))return{};const Q=i?i[0]:h,ae=be=>{a&&Q.reportValidity&&(Q.setCustomValidity(Md(be)?"":be||""),Q.reportValidity())},ee={},se=z4(h),ue=t2(h),he=se||ue,Ce=(V||F4(h))&&co(h.value)&&co(K)||KN(h)&&h.value===""||K===""||Array.isArray(K)&&!K.length,Ne=PZ.bind(null,I,n,ee),me=(be,pe,Se,Ee=sm.maxLength,we=sm.minLength)=>{const Pe=be?pe:Se;ee[I]={type:be?Ee:we,message:Pe,ref:h,...Ne(be?Ee:we,Pe)}};if(c?!Array.isArray(K)||!K.length:x&&(!he&&(Ce||xc(K))||Md(K)&&!K||ue&&!CZ(i).isValid||se&&!EZ(i).isValid)){const{value:be,message:pe}=SN(x)?{value:!!x,message:x}:Qx(x);if(be&&(ee[I]={type:sm.required,message:pe,ref:Q,...Ne(sm.required,pe)},!n))return ae(pe),ee}if(!Ce&&(!xc(T)||!xc(E))){let be,pe;const Se=Qx(E),Ee=Qx(T);if(!xc(K)&&!isNaN(K)){const we=h.valueAsNumber||K&&+K;xc(Se.value)||(be=we>Se.value),xc(Ee.value)||(pe=we<Ee.value)}else{const we=h.valueAsDate||new Date(K),Pe=Ge=>new Date(new Date().toDateString()+" "+Ge),Me=h.type=="time",Be=h.type=="week";Kf(Se.value)&&K&&(be=Me?Pe(K)>Pe(Se.value):Be?K>Se.value:we>new Date(Se.value)),Kf(Ee.value)&&K&&(pe=Me?Pe(K)<Pe(Ee.value):Be?K<Ee.value:we<new Date(Ee.value))}if((be||pe)&&(me(!!be,Se.message,Ee.message,sm.max,sm.min),!n))return ae(ee[I].message),ee}if((w||S)&&!Ce&&(Kf(K)||c&&Array.isArray(K))){const be=Qx(w),pe=Qx(S),Se=!xc(be.value)&&K.length>+be.value,Ee=!xc(pe.value)&&K.length<+pe.value;if((Se||Ee)&&(me(Se,be.message,pe.message),!n))return ae(ee[I].message),ee}if(D&&!Ce&&Kf(K)){const{value:be,message:pe}=Qx(D);if(ZN(be)&&!K.match(be)&&(ee[I]={type:sm.pattern,message:pe,ref:h,...Ne(sm.pattern,pe)},!n))return ae(pe),ee}if(U){if(Wf(U)){const be=await U(K,r),pe=P6(be,Q);if(pe&&(ee[I]={...pe,...Ne(sm.validate,pe.message)},!n))return ae(pe.message),ee}else if(po(U)){let be={};for(const pe in U){if(!Zc(be)&&!n)break;const Se=P6(await U[pe](K,r),Q,pe);Se&&(be={...Se,...Ne(pe,Se.message)},ae(Se.message),n&&(ee[I]=be))}if(!Zc(be)&&(ee[I]={ref:Q,...be},!n))return ee}}return ae(!0),ee};function Rge(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=co(e)?n++:e[t[n++]];return e}function Ige(e){for(const t in e)if(e.hasOwnProperty(t)&&!co(e[t]))return!1;return!0}function Go(e,t){const r=Array.isArray(t)?t:L4(t)?[t]:SZ(t),n=r.length===1?e:Rge(e,r),a=r.length-1,c=r[a];return n&&delete n[c],a!==0&&(po(n)&&Zc(n)||Array.isArray(n)&&Ige(n))&&Go(e,r.slice(0,-1)),e}var vP=()=>{let e=[];return{get observers(){return e},next:a=>{for(const c of e)c.next&&c.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(c=>c!==a)}}),unsubscribe:()=>{e=[]}}},NR=e=>xc(e)||!_Z(e);function Ug(e,t){if(NR(e)||NR(t))return e===t;if(S0(e)&&S0(t))return e.getTime()===t.getTime();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const a of r){const c=e[a];if(!n.includes(a))return!1;if(a!=="ref"){const h=t[a];if(S0(c)&&S0(h)||po(c)&&po(h)||Array.isArray(c)&&Array.isArray(h)?!Ug(c,h):c!==h)return!1}}return!0}var MZ=e=>e.type==="select-multiple",Lge=e=>z4(e)||t2(e),_P=e=>KN(e)&&e.isConnected,OZ=e=>{for(const t in e)if(Wf(e[t]))return!0;return!1};function YN(e,t={}){const r=Array.isArray(e);if(po(e)||r)for(const n in e)Array.isArray(e[n])||po(e[n])&&!OZ(e[n])?(t[n]=Array.isArray(e[n])?[]:{},YN(e[n],t[n])):xc(e[n])||(t[n]=!0);return t}function RZ(e,t,r){const n=Array.isArray(e);if(po(e)||n)for(const a in e)Array.isArray(e[a])||po(e[a])&&!OZ(e[a])?co(t)||NR(r[a])?r[a]=Array.isArray(e[a])?YN(e[a],[]):{...YN(e[a])}:RZ(e[a],xc(t)?{}:t[a],r[a]):r[a]=!Ug(e[a],t[a]);return r}var Lb=(e,t)=>RZ(e,t,YN(t)),IZ=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>co(e)?e:t?e===""?NaN:e&&+e:r&&Kf(e)?new Date(e):n?n(e):e;function bP(e){const t=e.ref;return F4(t)?t.files:z4(t)?EZ(e.refs).value:MZ(t)?[...t.selectedOptions].map(({value:r})=>r):t2(t)?CZ(e.refs).value:IZ(co(t.value)?e.ref.value:t.value,e)}var Dge=(e,t,r,n)=>{const a={};for(const c of e){const h=Gr(t,c);h&&ja(a,c,h._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:n}},Db=e=>co(e)?e:ZN(e)?e.source:po(e)?ZN(e.value)?e.value.source:e.value:e;const E6="AsyncFunction";var Fge=e=>!!e&&!!e.validate&&!!(Wf(e.validate)&&e.validate.constructor.name===E6||po(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===E6)),zge=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function M6(e,t,r){const n=Gr(e,r);if(n||L4(r))return{error:n,name:r};const a=r.split(".");for(;a.length;){const c=a.join("."),h=Gr(t,c),i=Gr(e,c);if(h&&!Array.isArray(h)&&r!==c)return{name:r};if(i&&i.type)return{name:c,error:i};a.pop()}return{name:r}}var Bge=(e,t,r,n,a)=>a.isOnAll?!1:!r&&a.isOnTouch?!(t||e):(r?n.isOnBlur:a.isOnBlur)?!e:(r?n.isOnChange:a.isOnChange)?e:!0,Vge=(e,t)=>!BT(Gr(e,t)).length&&Go(e,t);const Uge={mode:Bh.onSubmit,reValidateMode:Bh.onChange,shouldFocusError:!0};function $ge(e={}){let t={...Uge,...e},r={submitCount:0,isDirty:!1,isLoading:Wf(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},n={},a=po(t.defaultValues)||po(t.values)?Kc(t.defaultValues||t.values)||{}:{},c=t.shouldUnregister?{}:Kc(a),h={action:!1,mount:!1,watch:!1},i={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},x,w=0;const S={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},T={values:vP(),array:vP(),state:vP()},E=N6(t.mode),D=N6(t.reValidateMode),U=t.criteriaMode===Bh.all,I=dt=>Ot=>{clearTimeout(w),w=setTimeout(dt,Ot)},V=async dt=>{if(!t.disabled&&(S.isValid||dt)){const Ot=t.resolver?Zc((await he()).errors):await Ne(n,!0);Ot!==r.isValid&&T.state.next({isValid:Ot})}},H=(dt,Ot)=>{!t.disabled&&(S.isValidating||S.validatingFields)&&((dt||Array.from(i.mount)).forEach(Zt=>{Zt&&(Ot?ja(r.validatingFields,Zt,Ot):Go(r.validatingFields,Zt))}),T.state.next({validatingFields:r.validatingFields,isValidating:!Zc(r.validatingFields)}))},K=(dt,Ot=[],Zt,Cr,vr=!0,Sr=!0)=>{if(Cr&&Zt&&!t.disabled){if(h.action=!0,Sr&&Array.isArray(Gr(n,dt))){const pr=Zt(Gr(n,dt),Cr.argA,Cr.argB);vr&&ja(n,dt,pr)}if(Sr&&Array.isArray(Gr(r.errors,dt))){const pr=Zt(Gr(r.errors,dt),Cr.argA,Cr.argB);vr&&ja(r.errors,dt,pr),Vge(r.errors,dt)}if(S.touchedFields&&Sr&&Array.isArray(Gr(r.touchedFields,dt))){const pr=Zt(Gr(r.touchedFields,dt),Cr.argA,Cr.argB);vr&&ja(r.touchedFields,dt,pr)}S.dirtyFields&&(r.dirtyFields=Lb(a,c)),T.state.next({name:dt,isDirty:be(dt,Ot),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else ja(c,dt,Ot)},Q=(dt,Ot)=>{ja(r.errors,dt,Ot),T.state.next({errors:r.errors})},ae=dt=>{r.errors=dt,T.state.next({errors:r.errors,isValid:!1})},ee=(dt,Ot,Zt,Cr)=>{const vr=Gr(n,dt);if(vr){const Sr=Gr(c,dt,co(Zt)?Gr(a,dt):Zt);co(Sr)||Cr&&Cr.defaultChecked||Ot?ja(c,dt,Ot?Sr:bP(vr._f)):Ee(dt,Sr),h.mount&&V()}},se=(dt,Ot,Zt,Cr,vr)=>{let Sr=!1,pr=!1;const Mn={name:dt};if(!t.disabled){const Ai=!!(Gr(n,dt)&&Gr(n,dt)._f&&Gr(n,dt)._f.disabled);if(!Zt||Cr){S.isDirty&&(pr=r.isDirty,r.isDirty=Mn.isDirty=be(),Sr=pr!==Mn.isDirty);const Vi=Ai||Ug(Gr(a,dt),Ot);pr=!!(!Ai&&Gr(r.dirtyFields,dt)),Vi||Ai?Go(r.dirtyFields,dt):ja(r.dirtyFields,dt,!0),Mn.dirtyFields=r.dirtyFields,Sr=Sr||S.dirtyFields&&pr!==!Vi}if(Zt){const Vi=Gr(r.touchedFields,dt);Vi||(ja(r.touchedFields,dt,Zt),Mn.touchedFields=r.touchedFields,Sr=Sr||S.touchedFields&&Vi!==Zt)}Sr&&vr&&T.state.next(Mn)}return Sr?Mn:{}},ue=(dt,Ot,Zt,Cr)=>{const vr=Gr(r.errors,dt),Sr=S.isValid&&Md(Ot)&&r.isValid!==Ot;if(t.delayError&&Zt?(x=I(()=>Q(dt,Zt)),x(t.delayError)):(clearTimeout(w),x=null,Zt?ja(r.errors,dt,Zt):Go(r.errors,dt)),(Zt?!Ug(vr,Zt):vr)||!Zc(Cr)||Sr){const pr={...Cr,...Sr&&Md(Ot)?{isValid:Ot}:{},errors:r.errors,name:dt};r={...r,...pr},T.state.next(pr)}},he=async dt=>{H(dt,!0);const Ot=await t.resolver(c,t.context,Dge(dt||i.mount,n,t.criteriaMode,t.shouldUseNativeValidation));return H(dt),Ot},Ce=async dt=>{const{errors:Ot}=await he(dt);if(dt)for(const Zt of dt){const Cr=Gr(Ot,Zt);Cr?ja(r.errors,Zt,Cr):Go(r.errors,Zt)}else r.errors=Ot;return Ot},Ne=async(dt,Ot,Zt={valid:!0})=>{for(const Cr in dt){const vr=dt[Cr];if(vr){const{_f:Sr,...pr}=vr;if(Sr){const Mn=i.array.has(Sr.name),Ai=vr._f&&Fge(vr._f);Ai&&S.validatingFields&&H([Cr],!0);const Vi=await C6(vr,i.disabled,c,U,t.shouldUseNativeValidation&&!Ot,Mn);if(Ai&&S.validatingFields&&H([Cr]),Vi[Sr.name]&&(Zt.valid=!1,Ot))break;!Ot&&(Gr(Vi,Sr.name)?Mn?Oge(r.errors,Vi,Sr.name):ja(r.errors,Sr.name,Vi[Sr.name]):Go(r.errors,Sr.name))}!Zc(pr)&&await Ne(pr,Ot,Zt)}}return Zt.valid},me=()=>{for(const dt of i.unMount){const Ot=Gr(n,dt);Ot&&(Ot._f.refs?Ot._f.refs.every(Zt=>!_P(Zt)):!_P(Ot._f.ref))&&ir(dt)}i.unMount=new Set},be=(dt,Ot)=>!t.disabled&&(dt&&Ot&&ja(c,dt,Ot),!Ug(We(),a)),pe=(dt,Ot,Zt)=>kZ(dt,i,{...h.mount?c:co(Ot)?a:Kf(dt)?{[dt]:Ot}:Ot},Zt,Ot),Se=dt=>BT(Gr(h.mount?c:a,dt,t.shouldUnregister?Gr(a,dt,[]):[])),Ee=(dt,Ot,Zt={})=>{const Cr=Gr(n,dt);let vr=Ot;if(Cr){const Sr=Cr._f;Sr&&(!Sr.disabled&&ja(c,dt,IZ(Ot,Sr)),vr=KN(Sr.ref)&&xc(Ot)?"":Ot,MZ(Sr.ref)?[...Sr.ref.options].forEach(pr=>pr.selected=vr.includes(pr.value)):Sr.refs?t2(Sr.ref)?Sr.refs.length>1?Sr.refs.forEach(pr=>(!pr.defaultChecked||!pr.disabled)&&(pr.checked=Array.isArray(vr)?!!vr.find(Mn=>Mn===pr.value):vr===pr.value)):Sr.refs[0]&&(Sr.refs[0].checked=!!vr):Sr.refs.forEach(pr=>pr.checked=pr.value===vr):F4(Sr.ref)?Sr.ref.value="":(Sr.ref.value=vr,Sr.ref.type||T.values.next({name:dt,values:{...c}})))}(Zt.shouldDirty||Zt.shouldTouch)&&se(dt,vr,Zt.shouldTouch,Zt.shouldDirty,!0),Zt.shouldValidate&&Ge(dt)},we=(dt,Ot,Zt)=>{for(const Cr in Ot){const vr=Ot[Cr],Sr=`${dt}.${Cr}`,pr=Gr(n,Sr);(i.array.has(dt)||po(vr)||pr&&!pr._f)&&!S0(vr)?we(Sr,vr,Zt):Ee(Sr,vr,Zt)}},Pe=(dt,Ot,Zt={})=>{const Cr=Gr(n,dt),vr=i.array.has(dt),Sr=Kc(Ot);ja(c,dt,Sr),vr?(T.array.next({name:dt,values:{...c}}),(S.isDirty||S.dirtyFields)&&Zt.shouldDirty&&T.state.next({name:dt,dirtyFields:Lb(a,c),isDirty:be(dt,Sr)})):Cr&&!Cr._f&&!xc(Sr)?we(dt,Sr,Zt):Ee(dt,Sr,Zt),A6(dt,i)&&T.state.next({...r}),T.values.next({name:h.mount?dt:void 0,values:{...c}})},Me=async dt=>{h.mount=!0;const Ot=dt.target;let Zt=Ot.name,Cr=!0;const vr=Gr(n,Zt),Sr=()=>Ot.type?bP(vr._f):bZ(dt),pr=Mn=>{Cr=Number.isNaN(Mn)||S0(Mn)&&isNaN(Mn.getTime())||Ug(Mn,Gr(c,Zt,Mn))};if(vr){let Mn,Ai;const Vi=Sr(),Ui=dt.type===HN.BLUR||dt.type===HN.FOCUS_OUT,xo=!zge(vr._f)&&!t.resolver&&!Gr(r.errors,Zt)&&!vr._f.deps||Bge(Ui,Gr(r.touchedFields,Zt),r.isSubmitted,D,E),Wa=A6(Zt,i,Ui);ja(c,Zt,Vi),Ui?(vr._f.onBlur&&vr._f.onBlur(dt),x&&x(0)):vr._f.onChange&&vr._f.onChange(dt);const Qs=se(Zt,Vi,Ui,!1),Eo=!Zc(Qs)||Wa;if(!Ui&&T.values.next({name:Zt,type:dt.type,values:{...c}}),xo)return S.isValid&&(t.mode==="onBlur"&&Ui?V():Ui||V()),Eo&&T.state.next({name:Zt,...Wa?{}:Qs});if(!Ui&&Wa&&T.state.next({...r}),t.resolver){const{errors:ss}=await he([Zt]);if(pr(Vi),Cr){const ac=M6(r.errors,n,Zt),Il=M6(ss,n,ac.name||Zt);Mn=Il.error,Zt=Il.name,Ai=Zc(ss)}}else H([Zt],!0),Mn=(await C6(vr,i.disabled,c,U,t.shouldUseNativeValidation))[Zt],H([Zt]),pr(Vi),Cr&&(Mn?Ai=!1:S.isValid&&(Ai=await Ne(n,!0)));Cr&&(vr._f.deps&&Ge(vr._f.deps),ue(Zt,Ai,Mn,Qs))}},Be=(dt,Ot)=>{if(Gr(r.errors,Ot)&&dt.focus)return dt.focus(),1},Ge=async(dt,Ot={})=>{let Zt,Cr;const vr=u1(dt);if(t.resolver){const Sr=await Ce(co(dt)?dt:vr);Zt=Zc(Sr),Cr=dt?!vr.some(pr=>Gr(Sr,pr)):Zt}else dt?(Cr=(await Promise.all(vr.map(async Sr=>{const pr=Gr(n,Sr);return await Ne(pr&&pr._f?{[Sr]:pr}:pr)}))).every(Boolean),!(!Cr&&!r.isValid)&&V()):Cr=Zt=await Ne(n);return T.state.next({...!Kf(dt)||S.isValid&&Zt!==r.isValid?{}:{name:dt},...t.resolver||!dt?{isValid:Zt}:{},errors:r.errors}),Ot.shouldFocus&&!Cr&&d1(n,Be,dt?vr:i.mount),Cr},We=dt=>{const Ot={...h.mount?c:a};return co(dt)?Ot:Kf(dt)?Gr(Ot,dt):dt.map(Zt=>Gr(Ot,Zt))},tt=(dt,Ot)=>({invalid:!!Gr((Ot||r).errors,dt),isDirty:!!Gr((Ot||r).dirtyFields,dt),error:Gr((Ot||r).errors,dt),isValidating:!!Gr(r.validatingFields,dt),isTouched:!!Gr((Ot||r).touchedFields,dt)}),nt=dt=>{dt&&u1(dt).forEach(Ot=>Go(r.errors,Ot)),T.state.next({errors:dt?r.errors:{}})},Dt=(dt,Ot,Zt)=>{const Cr=(Gr(n,dt,{_f:{}})._f||{}).ref,vr=Gr(r.errors,dt)||{},{ref:Sr,message:pr,type:Mn,...Ai}=vr;ja(r.errors,dt,{...Ai,...Ot,ref:Cr}),T.state.next({name:dt,errors:r.errors,isValid:!1}),Zt&&Zt.shouldFocus&&Cr&&Cr.focus&&Cr.focus()},nr=(dt,Ot)=>Wf(dt)?T.values.subscribe({next:Zt=>dt(pe(void 0,Ot),Zt)}):pe(dt,Ot,!0),ir=(dt,Ot={})=>{for(const Zt of dt?u1(dt):i.mount)i.mount.delete(Zt),i.array.delete(Zt),Ot.keepValue||(Go(n,Zt),Go(c,Zt)),!Ot.keepError&&Go(r.errors,Zt),!Ot.keepDirty&&Go(r.dirtyFields,Zt),!Ot.keepTouched&&Go(r.touchedFields,Zt),!Ot.keepIsValidating&&Go(r.validatingFields,Zt),!t.shouldUnregister&&!Ot.keepDefaultValue&&Go(a,Zt);T.values.next({values:{...c}}),T.state.next({...r,...Ot.keepDirty?{isDirty:be()}:{}}),!Ot.keepIsValid&&V()},rr=({disabled:dt,name:Ot,field:Zt,fields:Cr})=>{(Md(dt)&&h.mount||dt||i.disabled.has(Ot))&&(dt?i.disabled.add(Ot):i.disabled.delete(Ot),se(Ot,bP(Zt?Zt._f:Gr(Cr,Ot)._f),!1,!1,!0))},or=(dt,Ot={})=>{let Zt=Gr(n,dt);const Cr=Md(Ot.disabled)||Md(t.disabled);return ja(n,dt,{...Zt||{},_f:{...Zt&&Zt._f?Zt._f:{ref:{name:dt}},name:dt,mount:!0,...Ot}}),i.mount.add(dt),Zt?rr({field:Zt,disabled:Md(Ot.disabled)?Ot.disabled:t.disabled,name:dt}):ee(dt,!0,Ot.value),{...Cr?{disabled:Ot.disabled||t.disabled}:{},...t.progressive?{required:!!Ot.required,min:Db(Ot.min),max:Db(Ot.max),minLength:Db(Ot.minLength),maxLength:Db(Ot.maxLength),pattern:Db(Ot.pattern)}:{},name:dt,onChange:Me,onBlur:Me,ref:vr=>{if(vr){or(dt,Ot),Zt=Gr(n,dt);const Sr=co(vr.value)&&vr.querySelectorAll&&vr.querySelectorAll("input,select,textarea")[0]||vr,pr=Lge(Sr),Mn=Zt._f.refs||[];if(pr?Mn.find(Ai=>Ai===Sr):Sr===Zt._f.ref)return;ja(n,dt,{_f:{...Zt._f,...pr?{refs:[...Mn.filter(_P),Sr,...Array.isArray(Gr(a,dt))?[{}]:[]],ref:{type:Sr.type,name:dt}}:{ref:Sr}}}),ee(dt,!1,void 0,Sr)}else Zt=Gr(n,dt,{}),Zt._f&&(Zt._f.mount=!1),(t.shouldUnregister||Ot.shouldUnregister)&&!(wZ(i.array,dt)&&h.action)&&i.unMount.add(dt)}}},Ft=()=>t.shouldFocusError&&d1(n,Be,i.mount),ze=dt=>{Md(dt)&&(T.state.next({disabled:dt}),d1(n,(Ot,Zt)=>{const Cr=Gr(n,Zt);Cr&&(Ot.disabled=Cr._f.disabled||dt,Array.isArray(Cr._f.refs)&&Cr._f.refs.forEach(vr=>{vr.disabled=Cr._f.disabled||dt}))},0,!1))},Pr=(dt,Ot)=>async Zt=>{let Cr;Zt&&(Zt.preventDefault&&Zt.preventDefault(),Zt.persist&&Zt.persist());let vr=Kc(c);if(i.disabled.size)for(const Sr of i.disabled)ja(vr,Sr,void 0);if(T.state.next({isSubmitting:!0}),t.resolver){const{errors:Sr,values:pr}=await he();r.errors=Sr,vr=pr}else await Ne(n);if(Go(r.errors,"root"),Zc(r.errors)){T.state.next({errors:{}});try{await dt(vr,Zt)}catch(Sr){Cr=Sr}}else Ot&&await Ot({...r.errors},Zt),Ft(),setTimeout(Ft);if(T.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Zc(r.errors)&&!Cr,submitCount:r.submitCount+1,errors:r.errors}),Cr)throw Cr},Kt=(dt,Ot={})=>{Gr(n,dt)&&(co(Ot.defaultValue)?Pe(dt,Kc(Gr(a,dt))):(Pe(dt,Ot.defaultValue),ja(a,dt,Kc(Ot.defaultValue))),Ot.keepTouched||Go(r.touchedFields,dt),Ot.keepDirty||(Go(r.dirtyFields,dt),r.isDirty=Ot.defaultValue?be(dt,Kc(Gr(a,dt))):be()),Ot.keepError||(Go(r.errors,dt),S.isValid&&V()),T.state.next({...r}))},on=(dt,Ot={})=>{const Zt=dt?Kc(dt):a,Cr=Kc(Zt),vr=Zc(dt),Sr=vr?a:Cr;if(Ot.keepDefaultValues||(a=Zt),!Ot.keepValues){if(Ot.keepDirtyValues){const pr=new Set([...i.mount,...Object.keys(Lb(a,c))]);for(const Mn of Array.from(pr))Gr(r.dirtyFields,Mn)?ja(Sr,Mn,Gr(c,Mn)):Pe(Mn,Gr(Sr,Mn))}else{if(I4&&co(dt))for(const pr of i.mount){const Mn=Gr(n,pr);if(Mn&&Mn._f){const Ai=Array.isArray(Mn._f.refs)?Mn._f.refs[0]:Mn._f.ref;if(KN(Ai)){const Vi=Ai.closest("form");if(Vi){Vi.reset();break}}}}n={}}c=t.shouldUnregister?Ot.keepDefaultValues?Kc(a):{}:Kc(Sr),T.array.next({values:{...Sr}}),T.values.next({values:{...Sr}})}i={mount:Ot.keepDirtyValues?i.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},h.mount=!S.isValid||!!Ot.keepIsValid||!!Ot.keepDirtyValues,h.watch=!!t.shouldUnregister,T.state.next({submitCount:Ot.keepSubmitCount?r.submitCount:0,isDirty:vr?!1:Ot.keepDirty?r.isDirty:!!(Ot.keepDefaultValues&&!Ug(dt,a)),isSubmitted:Ot.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:vr?{}:Ot.keepDirtyValues?Ot.keepDefaultValues&&c?Lb(a,c):r.dirtyFields:Ot.keepDefaultValues&&dt?Lb(a,dt):Ot.keepDirty?r.dirtyFields:{},touchedFields:Ot.keepTouched?r.touchedFields:{},errors:Ot.keepErrors?r.errors:{},isSubmitSuccessful:Ot.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},Rt=(dt,Ot)=>on(Wf(dt)?dt(c):dt,Ot);return{control:{register:or,unregister:ir,getFieldState:tt,handleSubmit:Pr,setError:Dt,_executeSchema:he,_getWatch:pe,_getDirty:be,_updateValid:V,_removeUnmounted:me,_updateFieldArray:K,_updateDisabledField:rr,_getFieldArray:Se,_reset:on,_resetDefaultValues:()=>Wf(t.defaultValues)&&t.defaultValues().then(dt=>{Rt(dt,t.resetOptions),T.state.next({isLoading:!1})}),_updateFormState:dt=>{r={...r,...dt}},_disableForm:ze,_subjects:T,_proxyFormState:S,_setErrors:ae,get _fields(){return n},get _formValues(){return c},get _state(){return h},set _state(dt){h=dt},get _defaultValues(){return a},get _names(){return i},set _names(dt){i=dt},get _formState(){return r},set _formState(dt){r=dt},get _options(){return t},set _options(dt){t={...t,...dt}}},trigger:Ge,register:or,handleSubmit:Pr,watch:nr,setValue:Pe,getValues:We,reset:Rt,resetField:Kt,clearErrors:nt,unregister:ir,setError:Dt,setFocus:(dt,Ot={})=>{const Zt=Gr(n,dt),Cr=Zt&&Zt._f;if(Cr){const vr=Cr.refs?Cr.refs[0]:Cr.ref;vr.focus&&(vr.focus(),Ot.shouldSelect&&Wf(vr.select)&&vr.select())}},getFieldState:tt}}function ml(e={}){const t=Le.useRef(void 0),r=Le.useRef(void 0),[n,a]=Le.useState({isDirty:!1,isValidating:!1,isLoading:Wf(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:Wf(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...$ge(e),formState:n});const c=t.current.control;return c._options=e,D4({subject:c._subjects.state,next:h=>{TZ(h,c._proxyFormState,c._updateFormState,!0)&&a({...c._formState})}}),Le.useEffect(()=>c._disableForm(e.disabled),[c,e.disabled]),Le.useEffect(()=>{if(c._proxyFormState.isDirty){const h=c._getDirty();h!==n.isDirty&&c._subjects.state.next({isDirty:h})}},[c,n.isDirty]),Le.useEffect(()=>{e.values&&!Ug(e.values,r.current)?(c._reset(e.values,c._options.resetOptions),r.current=e.values,a(h=>({...h}))):c._resetDefaultValues()},[e.values,c]),Le.useEffect(()=>{e.errors&&c._setErrors(e.errors)},[e.errors,c]),Le.useEffect(()=>{c._state.mount||(c._updateValid(),c._state.mount=!0),c._state.watch&&(c._state.watch=!1,c._subjects.state.next({...c._formState})),c._removeUnmounted()}),Le.useEffect(()=>{e.shouldUnregister&&c._subjects.values.next({values:c._getWatch()})},[e.shouldUnregister,c]),t.current.formState=AZ(n,c),t.current}var ea;(function(e){e.assertEqual=a=>a;function t(a){}e.assertIs=t;function r(a){throw new Error}e.assertNever=r,e.arrayToEnum=a=>{const c={};for(const h of a)c[h]=h;return c},e.getValidEnumValues=a=>{const c=e.objectKeys(a).filter(i=>typeof a[a[i]]!="number"),h={};for(const i of c)h[i]=a[i];return e.objectValues(h)},e.objectValues=a=>e.objectKeys(a).map(function(c){return a[c]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const c=[];for(const h in a)Object.prototype.hasOwnProperty.call(a,h)&&c.push(h);return c},e.find=(a,c)=>{for(const h of a)if(c(h))return h},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function n(a,c=" | "){return a.map(h=>typeof h=="string"?`'${h}'`:h).join(c)}e.joinValues=n,e.jsonStringifyReplacer=(a,c)=>typeof c=="bigint"?c.toString():c})(ea||(ea={}));var AR;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(AR||(AR={}));const un=ea.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),fm=e=>{switch(typeof e){case"undefined":return un.undefined;case"string":return un.string;case"number":return isNaN(e)?un.nan:un.number;case"boolean":return un.boolean;case"function":return un.function;case"bigint":return un.bigint;case"symbol":return un.symbol;case"object":return Array.isArray(e)?un.array:e===null?un.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?un.promise:typeof Map<"u"&&e instanceof Map?un.map:typeof Set<"u"&&e instanceof Set?un.set:typeof Date<"u"&&e instanceof Date?un.date:un.object;default:return un.unknown}},Rr=ea.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),qge=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Iu extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(c){return c.message},n={_errors:[]},a=c=>{for(const h of c.issues)if(h.code==="invalid_union")h.unionErrors.map(a);else if(h.code==="invalid_return_type")a(h.returnTypeError);else if(h.code==="invalid_arguments")a(h.argumentsError);else if(h.path.length===0)n._errors.push(r(h));else{let i=n,x=0;for(;x<h.path.length;){const w=h.path[x];x===h.path.length-1?(i[w]=i[w]||{_errors:[]},i[w]._errors.push(r(h))):i[w]=i[w]||{_errors:[]},i=i[w],x++}}};return a(this),n}static assert(t){if(!(t instanceof Iu))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ea.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const a of this.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Iu.create=e=>new Iu(e);const kv=(e,t)=>{let r;switch(e.code){case Rr.invalid_type:e.received===un.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case Rr.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,ea.jsonStringifyReplacer)}`;break;case Rr.unrecognized_keys:r=`Unrecognized key(s) in object: ${ea.joinValues(e.keys,", ")}`;break;case Rr.invalid_union:r="Invalid input";break;case Rr.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ea.joinValues(e.options)}`;break;case Rr.invalid_enum_value:r=`Invalid enum value. Expected ${ea.joinValues(e.options)}, received '${e.received}'`;break;case Rr.invalid_arguments:r="Invalid function arguments";break;case Rr.invalid_return_type:r="Invalid function return type";break;case Rr.invalid_date:r="Invalid date";break;case Rr.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:ea.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case Rr.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case Rr.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case Rr.custom:r="Invalid input";break;case Rr.invalid_intersection_types:r="Intersection results could not be merged";break;case Rr.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case Rr.not_finite:r="Number must be finite";break;default:r=t.defaultError,ea.assertNever(e)}return{message:r}};let LZ=kv;function Gge(e){LZ=e}function XN(){return LZ}const JN=e=>{const{data:t,path:r,errorMaps:n,issueData:a}=e,c=[...r,...a.path||[]],h={...a,path:c};if(a.message!==void 0)return{...a,path:c,message:a.message};let i="";const x=n.filter(w=>!!w).slice().reverse();for(const w of x)i=w(h,{data:t,defaultError:i}).message;return{...a,path:c,message:i}},Wge=[];function en(e,t){const r=XN(),n=JN({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===kv?void 0:kv].filter(a=>!!a)});e.common.issues.push(n)}class ic{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const a of r){if(a.status==="aborted")return ci;a.status==="dirty"&&t.dirty(),n.push(a.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const a of r){const c=await a.key,h=await a.value;n.push({key:c,value:h})}return ic.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const a of r){const{key:c,value:h}=a;if(c.status==="aborted"||h.status==="aborted")return ci;c.status==="dirty"&&t.dirty(),h.status==="dirty"&&t.dirty(),c.value!=="__proto__"&&(typeof h.value<"u"||a.alwaysSet)&&(n[c.value]=h.value)}return{status:t.value,value:n}}}const ci=Object.freeze({status:"aborted"}),lv=e=>({status:"dirty",value:e}),Ac=e=>({status:"valid",value:e}),TR=e=>e.status==="aborted",jR=e=>e.status==="dirty",V0=e=>e.status==="valid",R1=e=>typeof Promise<"u"&&e instanceof Promise;function QN(e,t,r,n){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function DZ(e,t,r,n,a){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var Cn;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Cn||(Cn={}));var e1,t1;class lp{constructor(t,r,n,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const O6=(e,t)=>{if(V0(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Iu(e.common.issues);return this._error=r,this._error}}};function Si(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:a}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(h,i)=>{var x,w;const{message:S}=e;return h.code==="invalid_enum_value"?{message:S??i.defaultError}:typeof i.data>"u"?{message:(x=S??n)!==null&&x!==void 0?x:i.defaultError}:h.code!=="invalid_type"?{message:i.defaultError}:{message:(w=S??r)!==null&&w!==void 0?w:i.defaultError}},description:a}}class ki{get description(){return this._def.description}_getType(t){return fm(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:fm(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new ic,ctx:{common:t.parent.common,data:t.data,parsedType:fm(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(R1(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;const a={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:fm(t)},c=this._parseSync({data:t,path:a.path,parent:a});return O6(a,c)}"~validate"(t){var r,n;const a={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:fm(t)};if(!this["~standard"].async)try{const c=this._parseSync({data:t,path:[],parent:a});return V0(c)?{value:c.value}:{issues:a.common.issues}}catch(c){!((n=(r=c==null?void 0:c.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),a.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:a}).then(c=>V0(c)?{value:c.value}:{issues:a.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:fm(t)},a=this._parse({data:t,path:n.path,parent:n}),c=await(R1(a)?a:Promise.resolve(a));return O6(n,c)}refine(t,r){const n=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,c)=>{const h=t(a),i=()=>c.addIssue({code:Rr.custom,...n(a)});return typeof Promise<"u"&&h instanceof Promise?h.then(x=>x?!0:(i(),!1)):h?!0:(i(),!1)})}refinement(t,r){return this._refinement((n,a)=>t(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(t){return new Xh({schema:this,typeName:oi.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Qf.create(this,this._def)}nullable(){return ay.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return $h.create(this)}promise(){return Cv.create(this,this._def)}or(t){return F1.create([this,t],this._def)}and(t){return z1.create(this,t,this._def)}transform(t){return new Xh({...Si(this._def),schema:this,typeName:oi.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new q1({...Si(this._def),innerType:this,defaultValue:r,typeName:oi.ZodDefault})}brand(){return new B4({typeName:oi.ZodBranded,type:this,...Si(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new G1({...Si(this._def),innerType:this,catchValue:r,typeName:oi.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return r2.create(this,t)}readonly(){return W1.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Hge=/^c[^\s-]{8,}$/i,Kge=/^[0-9a-z]+$/,Zge=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Yge=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Xge=/^[a-z0-9_-]{21}$/i,Jge=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Qge=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,eye=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,tye="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let wP;const rye=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,nye=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,iye=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,aye=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,sye=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,oye=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,FZ="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",lye=new RegExp(`^${FZ}$`);function zZ(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function cye(e){return new RegExp(`^${zZ(e)}$`)}function BZ(e){let t=`${FZ}T${zZ(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function uye(e,t){return!!((t==="v4"||!t)&&rye.test(e)||(t==="v6"||!t)&&iye.test(e))}function dye(e,t){if(!Jge.test(e))return!1;try{const[r]=e.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||!a.typ||!a.alg||t&&a.alg!==t)}catch{return!1}}function hye(e,t){return!!((t==="v4"||!t)&&nye.test(e)||(t==="v6"||!t)&&aye.test(e))}class Uh extends ki{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==un.string){const c=this._getOrReturnCtx(t);return en(c,{code:Rr.invalid_type,expected:un.string,received:c.parsedType}),ci}const n=new ic;let a;for(const c of this._def.checks)if(c.kind==="min")t.data.length<c.value&&(a=this._getOrReturnCtx(t,a),en(a,{code:Rr.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),n.dirty());else if(c.kind==="max")t.data.length>c.value&&(a=this._getOrReturnCtx(t,a),en(a,{code:Rr.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),n.dirty());else if(c.kind==="length"){const h=t.data.length>c.value,i=t.data.length<c.value;(h||i)&&(a=this._getOrReturnCtx(t,a),h?en(a,{code:Rr.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}):i&&en(a,{code:Rr.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}),n.dirty())}else if(c.kind==="email")eye.test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"email",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="emoji")wP||(wP=new RegExp(tye,"u")),wP.test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"emoji",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="uuid")Yge.test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"uuid",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="nanoid")Xge.test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"nanoid",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="cuid")Hge.test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"cuid",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="cuid2")Kge.test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"cuid2",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="ulid")Zge.test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"ulid",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),en(a,{validation:"url",code:Rr.invalid_string,message:c.message}),n.dirty()}else c.kind==="regex"?(c.regex.lastIndex=0,c.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"regex",code:Rr.invalid_string,message:c.message}),n.dirty())):c.kind==="trim"?t.data=t.data.trim():c.kind==="includes"?t.data.includes(c.value,c.position)||(a=this._getOrReturnCtx(t,a),en(a,{code:Rr.invalid_string,validation:{includes:c.value,position:c.position},message:c.message}),n.dirty()):c.kind==="toLowerCase"?t.data=t.data.toLowerCase():c.kind==="toUpperCase"?t.data=t.data.toUpperCase():c.kind==="startsWith"?t.data.startsWith(c.value)||(a=this._getOrReturnCtx(t,a),en(a,{code:Rr.invalid_string,validation:{startsWith:c.value},message:c.message}),n.dirty()):c.kind==="endsWith"?t.data.endsWith(c.value)||(a=this._getOrReturnCtx(t,a),en(a,{code:Rr.invalid_string,validation:{endsWith:c.value},message:c.message}),n.dirty()):c.kind==="datetime"?BZ(c).test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{code:Rr.invalid_string,validation:"datetime",message:c.message}),n.dirty()):c.kind==="date"?lye.test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{code:Rr.invalid_string,validation:"date",message:c.message}),n.dirty()):c.kind==="time"?cye(c).test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{code:Rr.invalid_string,validation:"time",message:c.message}),n.dirty()):c.kind==="duration"?Qge.test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"duration",code:Rr.invalid_string,message:c.message}),n.dirty()):c.kind==="ip"?uye(t.data,c.version)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"ip",code:Rr.invalid_string,message:c.message}),n.dirty()):c.kind==="jwt"?dye(t.data,c.alg)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"jwt",code:Rr.invalid_string,message:c.message}),n.dirty()):c.kind==="cidr"?hye(t.data,c.version)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"cidr",code:Rr.invalid_string,message:c.message}),n.dirty()):c.kind==="base64"?sye.test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"base64",code:Rr.invalid_string,message:c.message}),n.dirty()):c.kind==="base64url"?oye.test(t.data)||(a=this._getOrReturnCtx(t,a),en(a,{validation:"base64url",code:Rr.invalid_string,message:c.message}),n.dirty()):ea.assertNever(c);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(a=>t.test(a),{validation:r,code:Rr.invalid_string,...Cn.errToObj(n)})}_addCheck(t){return new Uh({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Cn.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Cn.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Cn.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Cn.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Cn.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Cn.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Cn.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Cn.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Cn.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Cn.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Cn.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Cn.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Cn.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...Cn.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Cn.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Cn.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...Cn.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...Cn.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...Cn.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...Cn.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...Cn.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...Cn.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...Cn.errToObj(r)})}nonempty(t){return this.min(1,Cn.errToObj(t))}trim(){return new Uh({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Uh({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Uh({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Uh.create=e=>{var t;return new Uh({checks:[],typeName:oi.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Si(e)})};function fye(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n,c=parseInt(e.toFixed(a).replace(".","")),h=parseInt(t.toFixed(a).replace(".",""));return c%h/Math.pow(10,a)}class ry extends ki{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==un.number){const c=this._getOrReturnCtx(t);return en(c,{code:Rr.invalid_type,expected:un.number,received:c.parsedType}),ci}let n;const a=new ic;for(const c of this._def.checks)c.kind==="int"?ea.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),en(n,{code:Rr.invalid_type,expected:"integer",received:"float",message:c.message}),a.dirty()):c.kind==="min"?(c.inclusive?t.data<c.value:t.data<=c.value)&&(n=this._getOrReturnCtx(t,n),en(n,{code:Rr.too_small,minimum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),a.dirty()):c.kind==="max"?(c.inclusive?t.data>c.value:t.data>=c.value)&&(n=this._getOrReturnCtx(t,n),en(n,{code:Rr.too_big,maximum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),a.dirty()):c.kind==="multipleOf"?fye(t.data,c.value)!==0&&(n=this._getOrReturnCtx(t,n),en(n,{code:Rr.not_multiple_of,multipleOf:c.value,message:c.message}),a.dirty()):c.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),en(n,{code:Rr.not_finite,message:c.message}),a.dirty()):ea.assertNever(c);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,Cn.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Cn.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Cn.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Cn.toString(r))}setLimit(t,r,n,a){return new ry({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:Cn.toString(a)}]})}_addCheck(t){return new ry({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Cn.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Cn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Cn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Cn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Cn.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Cn.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:Cn.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Cn.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Cn.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&ea.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}ry.create=e=>new ry({checks:[],typeName:oi.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Si(e)});class ny extends ki{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==un.bigint)return this._getInvalidInput(t);let n;const a=new ic;for(const c of this._def.checks)c.kind==="min"?(c.inclusive?t.data<c.value:t.data<=c.value)&&(n=this._getOrReturnCtx(t,n),en(n,{code:Rr.too_small,type:"bigint",minimum:c.value,inclusive:c.inclusive,message:c.message}),a.dirty()):c.kind==="max"?(c.inclusive?t.data>c.value:t.data>=c.value)&&(n=this._getOrReturnCtx(t,n),en(n,{code:Rr.too_big,type:"bigint",maximum:c.value,inclusive:c.inclusive,message:c.message}),a.dirty()):c.kind==="multipleOf"?t.data%c.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),en(n,{code:Rr.not_multiple_of,multipleOf:c.value,message:c.message}),a.dirty()):ea.assertNever(c);return{status:a.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return en(r,{code:Rr.invalid_type,expected:un.bigint,received:r.parsedType}),ci}gte(t,r){return this.setLimit("min",t,!0,Cn.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Cn.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Cn.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Cn.toString(r))}setLimit(t,r,n,a){return new ny({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:Cn.toString(a)}]})}_addCheck(t){return new ny({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Cn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Cn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Cn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Cn.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Cn.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}ny.create=e=>{var t;return new ny({checks:[],typeName:oi.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Si(e)})};class I1 extends ki{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==un.boolean){const n=this._getOrReturnCtx(t);return en(n,{code:Rr.invalid_type,expected:un.boolean,received:n.parsedType}),ci}return Ac(t.data)}}I1.create=e=>new I1({typeName:oi.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Si(e)});class U0 extends ki{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==un.date){const c=this._getOrReturnCtx(t);return en(c,{code:Rr.invalid_type,expected:un.date,received:c.parsedType}),ci}if(isNaN(t.data.getTime())){const c=this._getOrReturnCtx(t);return en(c,{code:Rr.invalid_date}),ci}const n=new ic;let a;for(const c of this._def.checks)c.kind==="min"?t.data.getTime()<c.value&&(a=this._getOrReturnCtx(t,a),en(a,{code:Rr.too_small,message:c.message,inclusive:!0,exact:!1,minimum:c.value,type:"date"}),n.dirty()):c.kind==="max"?t.data.getTime()>c.value&&(a=this._getOrReturnCtx(t,a),en(a,{code:Rr.too_big,message:c.message,inclusive:!0,exact:!1,maximum:c.value,type:"date"}),n.dirty()):ea.assertNever(c);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new U0({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:Cn.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:Cn.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}U0.create=e=>new U0({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:oi.ZodDate,...Si(e)});class eA extends ki{_parse(t){if(this._getType(t)!==un.symbol){const n=this._getOrReturnCtx(t);return en(n,{code:Rr.invalid_type,expected:un.symbol,received:n.parsedType}),ci}return Ac(t.data)}}eA.create=e=>new eA({typeName:oi.ZodSymbol,...Si(e)});class L1 extends ki{_parse(t){if(this._getType(t)!==un.undefined){const n=this._getOrReturnCtx(t);return en(n,{code:Rr.invalid_type,expected:un.undefined,received:n.parsedType}),ci}return Ac(t.data)}}L1.create=e=>new L1({typeName:oi.ZodUndefined,...Si(e)});class D1 extends ki{_parse(t){if(this._getType(t)!==un.null){const n=this._getOrReturnCtx(t);return en(n,{code:Rr.invalid_type,expected:un.null,received:n.parsedType}),ci}return Ac(t.data)}}D1.create=e=>new D1({typeName:oi.ZodNull,...Si(e)});class Pv extends ki{constructor(){super(...arguments),this._any=!0}_parse(t){return Ac(t.data)}}Pv.create=e=>new Pv({typeName:oi.ZodAny,...Si(e)});class M0 extends ki{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Ac(t.data)}}M0.create=e=>new M0({typeName:oi.ZodUnknown,...Si(e)});class Tm extends ki{_parse(t){const r=this._getOrReturnCtx(t);return en(r,{code:Rr.invalid_type,expected:un.never,received:r.parsedType}),ci}}Tm.create=e=>new Tm({typeName:oi.ZodNever,...Si(e)});class tA extends ki{_parse(t){if(this._getType(t)!==un.undefined){const n=this._getOrReturnCtx(t);return en(n,{code:Rr.invalid_type,expected:un.void,received:n.parsedType}),ci}return Ac(t.data)}}tA.create=e=>new tA({typeName:oi.ZodVoid,...Si(e)});class $h extends ki{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),a=this._def;if(r.parsedType!==un.array)return en(r,{code:Rr.invalid_type,expected:un.array,received:r.parsedType}),ci;if(a.exactLength!==null){const h=r.data.length>a.exactLength.value,i=r.data.length<a.exactLength.value;(h||i)&&(en(r,{code:h?Rr.too_big:Rr.too_small,minimum:i?a.exactLength.value:void 0,maximum:h?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(en(r,{code:Rr.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(en(r,{code:Rr.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((h,i)=>a.type._parseAsync(new lp(r,h,r.path,i)))).then(h=>ic.mergeArray(n,h));const c=[...r.data].map((h,i)=>a.type._parseSync(new lp(r,h,r.path,i)));return ic.mergeArray(n,c)}get element(){return this._def.type}min(t,r){return new $h({...this._def,minLength:{value:t,message:Cn.toString(r)}})}max(t,r){return new $h({...this._def,maxLength:{value:t,message:Cn.toString(r)}})}length(t,r){return new $h({...this._def,exactLength:{value:t,message:Cn.toString(r)}})}nonempty(t){return this.min(1,t)}}$h.create=(e,t)=>new $h({type:e,minLength:null,maxLength:null,exactLength:null,typeName:oi.ZodArray,...Si(t)});function ov(e){if(e instanceof zs){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Qf.create(ov(n))}return new zs({...e._def,shape:()=>t})}else return e instanceof $h?new $h({...e._def,type:ov(e.element)}):e instanceof Qf?Qf.create(ov(e.unwrap())):e instanceof ay?ay.create(ov(e.unwrap())):e instanceof cp?cp.create(e.items.map(t=>ov(t))):e}class zs extends ki{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=ea.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==un.object){const w=this._getOrReturnCtx(t);return en(w,{code:Rr.invalid_type,expected:un.object,received:w.parsedType}),ci}const{status:n,ctx:a}=this._processInputParams(t),{shape:c,keys:h}=this._getCached(),i=[];if(!(this._def.catchall instanceof Tm&&this._def.unknownKeys==="strip"))for(const w in a.data)h.includes(w)||i.push(w);const x=[];for(const w of h){const S=c[w],T=a.data[w];x.push({key:{status:"valid",value:w},value:S._parse(new lp(a,T,a.path,w)),alwaysSet:w in a.data})}if(this._def.catchall instanceof Tm){const w=this._def.unknownKeys;if(w==="passthrough")for(const S of i)x.push({key:{status:"valid",value:S},value:{status:"valid",value:a.data[S]}});else if(w==="strict")i.length>0&&(en(a,{code:Rr.unrecognized_keys,keys:i}),n.dirty());else if(w!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const w=this._def.catchall;for(const S of i){const T=a.data[S];x.push({key:{status:"valid",value:S},value:w._parse(new lp(a,T,a.path,S)),alwaysSet:S in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const w=[];for(const S of x){const T=await S.key,E=await S.value;w.push({key:T,value:E,alwaysSet:S.alwaysSet})}return w}).then(w=>ic.mergeObjectSync(n,w)):ic.mergeObjectSync(n,x)}get shape(){return this._def.shape()}strict(t){return Cn.errToObj,new zs({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var a,c,h,i;const x=(h=(c=(a=this._def).errorMap)===null||c===void 0?void 0:c.call(a,r,n).message)!==null&&h!==void 0?h:n.defaultError;return r.code==="unrecognized_keys"?{message:(i=Cn.errToObj(t).message)!==null&&i!==void 0?i:x}:{message:x}}}:{}})}strip(){return new zs({...this._def,unknownKeys:"strip"})}passthrough(){return new zs({...this._def,unknownKeys:"passthrough"})}extend(t){return new zs({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new zs({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:oi.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new zs({...this._def,catchall:t})}pick(t){const r={};return ea.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new zs({...this._def,shape:()=>r})}omit(t){const r={};return ea.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n])}),new zs({...this._def,shape:()=>r})}deepPartial(){return ov(this)}partial(t){const r={};return ea.objectKeys(this.shape).forEach(n=>{const a=this.shape[n];t&&!t[n]?r[n]=a:r[n]=a.optional()}),new zs({...this._def,shape:()=>r})}required(t){const r={};return ea.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else{let c=this.shape[n];for(;c instanceof Qf;)c=c._def.innerType;r[n]=c}}),new zs({...this._def,shape:()=>r})}keyof(){return VZ(ea.objectKeys(this.shape))}}zs.create=(e,t)=>new zs({shape:()=>e,unknownKeys:"strip",catchall:Tm.create(),typeName:oi.ZodObject,...Si(t)});zs.strictCreate=(e,t)=>new zs({shape:()=>e,unknownKeys:"strict",catchall:Tm.create(),typeName:oi.ZodObject,...Si(t)});zs.lazycreate=(e,t)=>new zs({shape:e,unknownKeys:"strip",catchall:Tm.create(),typeName:oi.ZodObject,...Si(t)});class F1 extends ki{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function a(c){for(const i of c)if(i.result.status==="valid")return i.result;for(const i of c)if(i.result.status==="dirty")return r.common.issues.push(...i.ctx.common.issues),i.result;const h=c.map(i=>new Iu(i.ctx.common.issues));return en(r,{code:Rr.invalid_union,unionErrors:h}),ci}if(r.common.async)return Promise.all(n.map(async c=>{const h={...r,common:{...r.common,issues:[]},parent:null};return{result:await c._parseAsync({data:r.data,path:r.path,parent:h}),ctx:h}})).then(a);{let c;const h=[];for(const x of n){const w={...r,common:{...r.common,issues:[]},parent:null},S=x._parseSync({data:r.data,path:r.path,parent:w});if(S.status==="valid")return S;S.status==="dirty"&&!c&&(c={result:S,ctx:w}),w.common.issues.length&&h.push(w.common.issues)}if(c)return r.common.issues.push(...c.ctx.common.issues),c.result;const i=h.map(x=>new Iu(x));return en(r,{code:Rr.invalid_union,unionErrors:i}),ci}}get options(){return this._def.options}}F1.create=(e,t)=>new F1({options:e,typeName:oi.ZodUnion,...Si(t)});const um=e=>e instanceof V1?um(e.schema):e instanceof Xh?um(e.innerType()):e instanceof U1?[e.value]:e instanceof iy?e.options:e instanceof $1?ea.objectValues(e.enum):e instanceof q1?um(e._def.innerType):e instanceof L1?[void 0]:e instanceof D1?[null]:e instanceof Qf?[void 0,...um(e.unwrap())]:e instanceof ay?[null,...um(e.unwrap())]:e instanceof B4||e instanceof W1?um(e.unwrap()):e instanceof G1?um(e._def.innerType):[];class UT extends ki{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==un.object)return en(r,{code:Rr.invalid_type,expected:un.object,received:r.parsedType}),ci;const n=this.discriminator,a=r.data[n],c=this.optionsMap.get(a);return c?r.common.async?c._parseAsync({data:r.data,path:r.path,parent:r}):c._parseSync({data:r.data,path:r.path,parent:r}):(en(r,{code:Rr.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),ci)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){const a=new Map;for(const c of r){const h=um(c.shape[t]);if(!h.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const i of h){if(a.has(i))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(i)}`);a.set(i,c)}}return new UT({typeName:oi.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:a,...Si(n)})}}function kR(e,t){const r=fm(e),n=fm(t);if(e===t)return{valid:!0,data:e};if(r===un.object&&n===un.object){const a=ea.objectKeys(t),c=ea.objectKeys(e).filter(i=>a.indexOf(i)!==-1),h={...e,...t};for(const i of c){const x=kR(e[i],t[i]);if(!x.valid)return{valid:!1};h[i]=x.data}return{valid:!0,data:h}}else if(r===un.array&&n===un.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let c=0;c<e.length;c++){const h=e[c],i=t[c],x=kR(h,i);if(!x.valid)return{valid:!1};a.push(x.data)}return{valid:!0,data:a}}else return r===un.date&&n===un.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class z1 extends ki{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=(c,h)=>{if(TR(c)||TR(h))return ci;const i=kR(c.value,h.value);return i.valid?((jR(c)||jR(h))&&r.dirty(),{status:r.value,value:i.data}):(en(n,{code:Rr.invalid_intersection_types}),ci)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([c,h])=>a(c,h)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}z1.create=(e,t,r)=>new z1({left:e,right:t,typeName:oi.ZodIntersection,...Si(r)});class cp extends ki{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==un.array)return en(n,{code:Rr.invalid_type,expected:un.array,received:n.parsedType}),ci;if(n.data.length<this._def.items.length)return en(n,{code:Rr.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ci;!this._def.rest&&n.data.length>this._def.items.length&&(en(n,{code:Rr.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const c=[...n.data].map((h,i)=>{const x=this._def.items[i]||this._def.rest;return x?x._parse(new lp(n,h,n.path,i)):null}).filter(h=>!!h);return n.common.async?Promise.all(c).then(h=>ic.mergeArray(r,h)):ic.mergeArray(r,c)}get items(){return this._def.items}rest(t){return new cp({...this._def,rest:t})}}cp.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new cp({items:e,typeName:oi.ZodTuple,rest:null,...Si(t)})};class B1 extends ki{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==un.object)return en(n,{code:Rr.invalid_type,expected:un.object,received:n.parsedType}),ci;const a=[],c=this._def.keyType,h=this._def.valueType;for(const i in n.data)a.push({key:c._parse(new lp(n,i,n.path,i)),value:h._parse(new lp(n,n.data[i],n.path,i)),alwaysSet:i in n.data});return n.common.async?ic.mergeObjectAsync(r,a):ic.mergeObjectSync(r,a)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof ki?new B1({keyType:t,valueType:r,typeName:oi.ZodRecord,...Si(n)}):new B1({keyType:Uh.create(),valueType:t,typeName:oi.ZodRecord,...Si(r)})}}class rA extends ki{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==un.map)return en(n,{code:Rr.invalid_type,expected:un.map,received:n.parsedType}),ci;const a=this._def.keyType,c=this._def.valueType,h=[...n.data.entries()].map(([i,x],w)=>({key:a._parse(new lp(n,i,n.path,[w,"key"])),value:c._parse(new lp(n,x,n.path,[w,"value"]))}));if(n.common.async){const i=new Map;return Promise.resolve().then(async()=>{for(const x of h){const w=await x.key,S=await x.value;if(w.status==="aborted"||S.status==="aborted")return ci;(w.status==="dirty"||S.status==="dirty")&&r.dirty(),i.set(w.value,S.value)}return{status:r.value,value:i}})}else{const i=new Map;for(const x of h){const w=x.key,S=x.value;if(w.status==="aborted"||S.status==="aborted")return ci;(w.status==="dirty"||S.status==="dirty")&&r.dirty(),i.set(w.value,S.value)}return{status:r.value,value:i}}}}rA.create=(e,t,r)=>new rA({valueType:t,keyType:e,typeName:oi.ZodMap,...Si(r)});class $0 extends ki{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==un.set)return en(n,{code:Rr.invalid_type,expected:un.set,received:n.parsedType}),ci;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(en(n,{code:Rr.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(en(n,{code:Rr.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const c=this._def.valueType;function h(x){const w=new Set;for(const S of x){if(S.status==="aborted")return ci;S.status==="dirty"&&r.dirty(),w.add(S.value)}return{status:r.value,value:w}}const i=[...n.data.values()].map((x,w)=>c._parse(new lp(n,x,n.path,w)));return n.common.async?Promise.all(i).then(x=>h(x)):h(i)}min(t,r){return new $0({...this._def,minSize:{value:t,message:Cn.toString(r)}})}max(t,r){return new $0({...this._def,maxSize:{value:t,message:Cn.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}$0.create=(e,t)=>new $0({valueType:e,minSize:null,maxSize:null,typeName:oi.ZodSet,...Si(t)});class wv extends ki{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==un.function)return en(r,{code:Rr.invalid_type,expected:un.function,received:r.parsedType}),ci;function n(i,x){return JN({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,XN(),kv].filter(w=>!!w),issueData:{code:Rr.invalid_arguments,argumentsError:x}})}function a(i,x){return JN({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,XN(),kv].filter(w=>!!w),issueData:{code:Rr.invalid_return_type,returnTypeError:x}})}const c={errorMap:r.common.contextualErrorMap},h=r.data;if(this._def.returns instanceof Cv){const i=this;return Ac(async function(...x){const w=new Iu([]),S=await i._def.args.parseAsync(x,c).catch(D=>{throw w.addIssue(n(x,D)),w}),T=await Reflect.apply(h,this,S);return await i._def.returns._def.type.parseAsync(T,c).catch(D=>{throw w.addIssue(a(T,D)),w})})}else{const i=this;return Ac(function(...x){const w=i._def.args.safeParse(x,c);if(!w.success)throw new Iu([n(x,w.error)]);const S=Reflect.apply(h,this,w.data),T=i._def.returns.safeParse(S,c);if(!T.success)throw new Iu([a(S,T.error)]);return T.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new wv({...this._def,args:cp.create(t).rest(M0.create())})}returns(t){return new wv({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new wv({args:t||cp.create([]).rest(M0.create()),returns:r||M0.create(),typeName:oi.ZodFunction,...Si(n)})}}class V1 extends ki{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}V1.create=(e,t)=>new V1({getter:e,typeName:oi.ZodLazy,...Si(t)});class U1 extends ki{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return en(r,{received:r.data,code:Rr.invalid_literal,expected:this._def.value}),ci}return{status:"valid",value:t.data}}get value(){return this._def.value}}U1.create=(e,t)=>new U1({value:e,typeName:oi.ZodLiteral,...Si(t)});function VZ(e,t){return new iy({values:e,typeName:oi.ZodEnum,...Si(t)})}class iy extends ki{constructor(){super(...arguments),e1.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return en(r,{expected:ea.joinValues(n),received:r.parsedType,code:Rr.invalid_type}),ci}if(QN(this,e1)||DZ(this,e1,new Set(this._def.values)),!QN(this,e1).has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return en(r,{received:r.data,code:Rr.invalid_enum_value,options:n}),ci}return Ac(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return iy.create(t,{...this._def,...r})}exclude(t,r=this._def){return iy.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}e1=new WeakMap;iy.create=VZ;class $1 extends ki{constructor(){super(...arguments),t1.set(this,void 0)}_parse(t){const r=ea.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==un.string&&n.parsedType!==un.number){const a=ea.objectValues(r);return en(n,{expected:ea.joinValues(a),received:n.parsedType,code:Rr.invalid_type}),ci}if(QN(this,t1)||DZ(this,t1,new Set(ea.getValidEnumValues(this._def.values))),!QN(this,t1).has(t.data)){const a=ea.objectValues(r);return en(n,{received:n.data,code:Rr.invalid_enum_value,options:a}),ci}return Ac(t.data)}get enum(){return this._def.values}}t1=new WeakMap;$1.create=(e,t)=>new $1({values:e,typeName:oi.ZodNativeEnum,...Si(t)});class Cv extends ki{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==un.promise&&r.common.async===!1)return en(r,{code:Rr.invalid_type,expected:un.promise,received:r.parsedType}),ci;const n=r.parsedType===un.promise?r.data:Promise.resolve(r.data);return Ac(n.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Cv.create=(e,t)=>new Cv({type:e,typeName:oi.ZodPromise,...Si(t)});class Xh extends ki{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===oi.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=this._def.effect||null,c={addIssue:h=>{en(n,h),h.fatal?r.abort():r.dirty()},get path(){return n.path}};if(c.addIssue=c.addIssue.bind(c),a.type==="preprocess"){const h=a.transform(n.data,c);if(n.common.async)return Promise.resolve(h).then(async i=>{if(r.value==="aborted")return ci;const x=await this._def.schema._parseAsync({data:i,path:n.path,parent:n});return x.status==="aborted"?ci:x.status==="dirty"||r.value==="dirty"?lv(x.value):x});{if(r.value==="aborted")return ci;const i=this._def.schema._parseSync({data:h,path:n.path,parent:n});return i.status==="aborted"?ci:i.status==="dirty"||r.value==="dirty"?lv(i.value):i}}if(a.type==="refinement"){const h=i=>{const x=a.refinement(i,c);if(n.common.async)return Promise.resolve(x);if(x instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(n.common.async===!1){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?ci:(i.status==="dirty"&&r.dirty(),h(i.value),{status:r.value,value:i.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>i.status==="aborted"?ci:(i.status==="dirty"&&r.dirty(),h(i.value).then(()=>({status:r.value,value:i.value}))))}if(a.type==="transform")if(n.common.async===!1){const h=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!V0(h))return h;const i=a.transform(h.value,c);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:i}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(h=>V0(h)?Promise.resolve(a.transform(h.value,c)).then(i=>({status:r.value,value:i})):h);ea.assertNever(a)}}Xh.create=(e,t,r)=>new Xh({schema:e,typeName:oi.ZodEffects,effect:t,...Si(r)});Xh.createWithPreprocess=(e,t,r)=>new Xh({schema:t,effect:{type:"preprocess",transform:e},typeName:oi.ZodEffects,...Si(r)});class Qf extends ki{_parse(t){return this._getType(t)===un.undefined?Ac(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Qf.create=(e,t)=>new Qf({innerType:e,typeName:oi.ZodOptional,...Si(t)});class ay extends ki{_parse(t){return this._getType(t)===un.null?Ac(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}ay.create=(e,t)=>new ay({innerType:e,typeName:oi.ZodNullable,...Si(t)});class q1 extends ki{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===un.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}q1.create=(e,t)=>new q1({innerType:e,typeName:oi.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Si(t)});class G1 extends ki{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return R1(a)?a.then(c=>({status:"valid",value:c.status==="valid"?c.value:this._def.catchValue({get error(){return new Iu(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Iu(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}G1.create=(e,t)=>new G1({innerType:e,typeName:oi.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Si(t)});class nA extends ki{_parse(t){if(this._getType(t)!==un.nan){const n=this._getOrReturnCtx(t);return en(n,{code:Rr.invalid_type,expected:un.nan,received:n.parsedType}),ci}return{status:"valid",value:t.data}}}nA.create=e=>new nA({typeName:oi.ZodNaN,...Si(e)});const pye=Symbol("zod_brand");class B4 extends ki{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class r2 extends ki{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const c=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return c.status==="aborted"?ci:c.status==="dirty"?(r.dirty(),lv(c.value)):this._def.out._parseAsync({data:c.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?ci:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(t,r){return new r2({in:t,out:r,typeName:oi.ZodPipeline})}}class W1 extends ki{_parse(t){const r=this._def.innerType._parse(t),n=a=>(V0(a)&&(a.value=Object.freeze(a.value)),a);return R1(r)?r.then(a=>n(a)):n(r)}unwrap(){return this._def.innerType}}W1.create=(e,t)=>new W1({innerType:e,typeName:oi.ZodReadonly,...Si(t)});function R6(e,t){const r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function UZ(e,t={},r){return e?Pv.create().superRefine((n,a)=>{var c,h;const i=e(n);if(i instanceof Promise)return i.then(x=>{var w,S;if(!x){const T=R6(t,n),E=(S=(w=T.fatal)!==null&&w!==void 0?w:r)!==null&&S!==void 0?S:!0;a.addIssue({code:"custom",...T,fatal:E})}});if(!i){const x=R6(t,n),w=(h=(c=x.fatal)!==null&&c!==void 0?c:r)!==null&&h!==void 0?h:!0;a.addIssue({code:"custom",...x,fatal:w})}}):Pv.create()}const mye={object:zs.lazycreate};var oi;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(oi||(oi={}));const gye=(e,t={message:`Input not instance of ${e.name}`})=>UZ(r=>r instanceof e,t),$Z=Uh.create,qZ=ry.create,yye=nA.create,xye=ny.create,GZ=I1.create,vye=U0.create,_ye=eA.create,bye=L1.create,wye=D1.create,Sye=Pv.create,Nye=M0.create,Aye=Tm.create,Tye=tA.create,jye=$h.create,kye=zs.create,Pye=zs.strictCreate,Cye=F1.create,Eye=UT.create,Mye=z1.create,Oye=cp.create,Rye=B1.create,Iye=rA.create,Lye=$0.create,Dye=wv.create,Fye=V1.create,zye=U1.create,Bye=iy.create,Vye=$1.create,Uye=Cv.create,I6=Xh.create,$ye=Qf.create,qye=ay.create,Gye=Xh.createWithPreprocess,Wye=r2.create,Hye=()=>$Z().optional(),Kye=()=>qZ().optional(),Zye=()=>GZ().optional(),Yye={string:e=>Uh.create({...e,coerce:!0}),number:e=>ry.create({...e,coerce:!0}),boolean:e=>I1.create({...e,coerce:!0}),bigint:e=>ny.create({...e,coerce:!0}),date:e=>U0.create({...e,coerce:!0})},Xye=ci;var Ar=Object.freeze({__proto__:null,defaultErrorMap:kv,setErrorMap:Gge,getErrorMap:XN,makeIssue:JN,EMPTY_PATH:Wge,addIssueToContext:en,ParseStatus:ic,INVALID:ci,DIRTY:lv,OK:Ac,isAborted:TR,isDirty:jR,isValid:V0,isAsync:R1,get util(){return ea},get objectUtil(){return AR},ZodParsedType:un,getParsedType:fm,ZodType:ki,datetimeRegex:BZ,ZodString:Uh,ZodNumber:ry,ZodBigInt:ny,ZodBoolean:I1,ZodDate:U0,ZodSymbol:eA,ZodUndefined:L1,ZodNull:D1,ZodAny:Pv,ZodUnknown:M0,ZodNever:Tm,ZodVoid:tA,ZodArray:$h,ZodObject:zs,ZodUnion:F1,ZodDiscriminatedUnion:UT,ZodIntersection:z1,ZodTuple:cp,ZodRecord:B1,ZodMap:rA,ZodSet:$0,ZodFunction:wv,ZodLazy:V1,ZodLiteral:U1,ZodEnum:iy,ZodNativeEnum:$1,ZodPromise:Cv,ZodEffects:Xh,ZodTransformer:Xh,ZodOptional:Qf,ZodNullable:ay,ZodDefault:q1,ZodCatch:G1,ZodNaN:nA,BRAND:pye,ZodBranded:B4,ZodPipeline:r2,ZodReadonly:W1,custom:UZ,Schema:ki,ZodSchema:ki,late:mye,get ZodFirstPartyTypeKind(){return oi},coerce:Yye,any:Sye,array:jye,bigint:xye,boolean:GZ,date:vye,discriminatedUnion:Eye,effect:I6,enum:Bye,function:Dye,instanceof:gye,intersection:Mye,lazy:Fye,literal:zye,map:Iye,nan:yye,nativeEnum:Vye,never:Aye,null:wye,nullable:qye,number:qZ,object:kye,oboolean:Zye,onumber:Kye,optional:$ye,ostring:Hye,pipeline:Wye,preprocess:Gye,promise:Uye,record:Rye,set:Lye,strictObject:Pye,string:$Z,symbol:_ye,transformer:I6,tuple:Oye,undefined:bye,union:Cye,unknown:Nye,void:Tye,NEVER:Xye,ZodIssueCode:Rr,quotelessJson:qge,ZodError:Iu});const Jye=Ar.object({email:Ar.string().email(),password:Ar.string().min(6,{message:"Password must be at least 6 characters long"})}),WZ=Ar.object({plateNo:Ar.union([Ar.string().min(1,{message:"Plate number is required"}),Ar.array(Ar.string().min(1,{message:"Each plate number must not be empty"})).min(1,{message:"At least one plate number is required"})]).transform(e=>typeof e=="string"?e.split(",").map(t=>t.trim()).filter(t=>t.length>0):e),fileNo:Ar.string().optional(),ownerRepresentativeName:Ar.string().min(1,{message:"Owner/Representative name is required"}),purok:Ar.string().optional(),barangay:Ar.string().min(1,{message:"Barangay is required"}),municipality:Ar.string().min(1,{message:"Municipality is required"}),province:Ar.string().min(1,{message:"Province is required"}),contactNumber:Ar.string().optional(),emailAddress:Ar.string().email({message:"Invalid email format"}).optional().or(Ar.literal("")),hasDriversLicense:Ar.boolean({required_error:"Please specify if you have a driver's license"}),driversLicenseNumber:Ar.string().optional(),birthDate:Ar.date().optional()}).refine(e=>!(e.hasDriversLicense&&!e.driversLicenseNumber),{message:"Driver's license number is required when you have a driver's license",path:["driversLicenseNumber"]}),HZ=Ar.object({plateNo:Ar.string().min(1,{message:"Plate number is required"}),fileNo:Ar.string().min(1,{message:"File number is required"}),engineNo:Ar.string().optional(),chassisNo:Ar.string().optional(),make:Ar.string().min(1,{message:"Make is required"}),bodyType:Ar.string().min(1,{message:"Body type is required"}),color:Ar.string().optional(),classification:Ar.string().min(1,{message:"Classification is required"}),dateOfRenewal:Ar.date({required_error:"Date of renewal is required"}),vehicleStatusType:Ar.enum(["New","Old"],{required_error:"Vehicle status type is required"}),driver:Ar.string().min(1,{message:"Driver selection is required"})}),Qye=Ar.object({plateNo:Ar.string().min(1,{message:"Plate number is required"}),fileNo:Ar.string().min(1,{message:"File number is required"}),engineNo:Ar.string().optional(),chassisNo:Ar.string().optional(),make:Ar.string().min(1,{message:"Make is required"}),bodyType:Ar.string().min(1,{message:"Body type is required"}),color:Ar.string().optional(),classification:Ar.string().min(1,{message:"Classification is required"}),dateOfRenewal:Ar.date({required_error:"Date of renewal is required"}),vehicleStatusType:Ar.enum(["New","Old"],{required_error:"Vehicle status type is required"}),driver:Ar.string().optional().or(Ar.null())}),V4=Ar.object({blotterNo:Ar.string().optional(),vehiclePlateNo:Ar.string().optional(),vehicleMCPlateNo:Ar.string().optional(),vehicleChassisNo:Ar.string().optional(),suspect:Ar.string().optional(),stageOfFelony:Ar.string().optional(),offense:Ar.string().optional(),offenseType:Ar.string().optional(),narrative:Ar.string().optional(),caseStatus:Ar.string().optional(),region:Ar.string().optional(),province:Ar.string().optional(),municipality:Ar.string().min(1,{message:"Municipality is required"}),barangay:Ar.string().min(1,{message:"Barangay is required"}),street:Ar.string().optional(),lat:Ar.number().optional(),lng:Ar.number().optional(),dateEncoded:Ar.date().optional(),dateReported:Ar.date().optional(),timeReported:Ar.string().optional(),dateCommited:Ar.date({required_error:"Date committed is required"}),timeCommited:Ar.string().optional(),incidentType:Ar.string().optional()}),U4=Ar.object({topNo:Ar.string().optional(),firstName:Ar.string().optional().nullable(),middleInitial:Ar.string().optional().nullable(),lastName:Ar.string().optional().nullable(),suffix:Ar.string().optional().nullable(),violations:Ar.array(Ar.string()).optional().nullable(),violationType:Ar.enum(["confiscated","alarm","impounded"],{required_error:"Violation type is required"}),licenseType:Ar.string().optional().nullable(),plateNo:Ar.string().min(1,{message:"Plate number is required"}),dateOfApprehension:Ar.date({required_error:"Date of apprehension is required"}),apprehendingOfficer:Ar.string().min(1,{message:"Apprehending officer is required"}),chassisNo:Ar.string().optional().nullable(),engineNo:Ar.string().optional().nullable()}).refine(e=>!(e.middleInitial&&e.middleInitial!==null&&e.middleInitial!=="null"&&e.middleInitial.trim()!==""&&e.middleInitial.length>1),{message:"Middle initial must be 1 character",path:["middleInitial"]}).refine(e=>!(e.licenseType&&e.licenseType!==null&&e.licenseType!=="null"&&e.licenseType.trim()!==""&&!["SP","DL","CL","PLATE","SP RECEIPT","DL RECEIPT","REFUSE TO SUR.","DL TEMPORARY","-","null"].includes(e.licenseType)),{message:"License type must be a valid option",path:["licenseType"]}),L6=(e,t,r)=>{if(e&&"reportValidity"in e){const n=Gr(r,t);e.setCustomValidity(n&&n.message||""),e.reportValidity()}},KZ=(e,t)=>{for(const r in t.fields){const n=t.fields[r];n&&n.ref&&"reportValidity"in n.ref?L6(n.ref,r,e):n&&n.refs&&n.refs.forEach(a=>L6(a,r,e))}},e0e=(e,t)=>{t.shouldUseNativeValidation&&KZ(e,t);const r={};for(const n in e){const a=Gr(t.fields,n),c=Object.assign(e[n]||{},{ref:a&&a.ref});if(t0e(t.names||Object.keys(e),n)){const h=Object.assign({},Gr(r,n));ja(h,"root",c),ja(r,n,h)}else ja(r,n,c)}return r},t0e=(e,t)=>{const r=D6(t);return e.some(n=>D6(n).match(`^${r}\\.\\d+`))};function D6(e){return e.replace(/\]|\[/g,"")}function r0e(e,t){for(var r={};e.length;){var n=e[0],a=n.code,c=n.message,h=n.path.join(".");if(!r[h])if("unionErrors"in n){var i=n.unionErrors[0].errors[0];r[h]={message:i.message,type:i.code}}else r[h]={message:c,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(S){return S.errors.forEach(function(T){return e.push(T)})}),t){var x=r[h].types,w=x&&x[n.code];r[h]=PZ(h,t,r,a,w?[].concat(w,n.message):n.message)}e.shift()}return r}function Rl(e,t,r){return r===void 0&&(r={}),function(n,a,c){try{return Promise.resolve(function(h,i){try{var x=Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](n,t)).then(function(w){return c.shouldUseNativeValidation&&KZ({},c),{errors:{},values:r.raw?Object.assign({},n):w}})}catch(w){return i(w)}return x&&x.then?x.then(void 0,i):x}(0,function(h){if(function(i){return Array.isArray(i==null?void 0:i.errors)}(h))return{values:{},errors:e0e(r0e(h.errors,!c.shouldUseNativeValidation&&c.criteriaMode==="all"),c)};throw h}))}catch(h){return Promise.reject(h)}}}var n0e="Label",ZZ=G.forwardRef((e,t)=>o.jsx(gi.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));ZZ.displayName=n0e;var YZ=ZZ;const i0e=Ww("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ml=G.forwardRef(({className:e,...t},r)=>o.jsx(YZ,{ref:r,className:zt(i0e(),e),...t}));Ml.displayName=YZ.displayName;const up=Pge,XZ=G.createContext({}),an=({...e})=>o.jsx(XZ.Provider,{value:{name:e.name},children:o.jsx(Mge,{...e})}),$T=()=>{const e=G.useContext(XZ),t=G.useContext(JZ),{getFieldState:r,formState:n}=VT(),a=r(e.name,n);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:c}=t;return{id:c,name:e.name,formItemId:`${c}-form-item`,formDescriptionId:`${c}-form-item-description`,formMessageId:`${c}-form-item-message`,...a}},JZ=G.createContext({}),nn=G.forwardRef(({className:e,...t},r)=>{const n=G.useId();return o.jsx(JZ.Provider,{value:{id:n},children:o.jsx("div",{ref:r,className:zt("space-y-2",e),...t})})});nn.displayName="FormItem";const pn=G.forwardRef(({className:e,...t},r)=>{const{error:n,formItemId:a}=$T();return o.jsx(Ml,{ref:r,className:zt(n&&"text-destructive",e),htmlFor:a,...t})});pn.displayName="FormLabel";const Hr=G.forwardRef(({...e},t)=>{const{error:r,formItemId:n,formDescriptionId:a,formMessageId:c}=$T();return o.jsx(nc,{ref:t,id:n,"aria-describedby":r?`${a} ${c}`:`${a}`,"aria-invalid":!!r,...e})});Hr.displayName="FormControl";const a0e=G.forwardRef(({className:e,...t},r)=>{const{formDescriptionId:n}=$T();return o.jsx("p",{ref:r,id:n,className:zt("text-[0.8rem] text-muted-foreground",e),...t})});a0e.displayName="FormDescription";const cn=G.forwardRef(({className:e,children:t,...r},n)=>{const{error:a,formMessageId:c}=$T(),h=a?String((a==null?void 0:a.message)??""):t;return h?o.jsx("p",{ref:n,id:c,className:zt("text-[0.8rem] font-medium text-destructive",e),...r,children:h}):null});cn.displayName="FormMessage";function QZ(e,t){return function(){return e.apply(t,arguments)}}const{toString:s0e}=Object.prototype,{getPrototypeOf:$4}=Object,{iterator:qT,toStringTag:eY}=Symbol,GT=(e=>t=>{const r=s0e.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),rf=e=>(e=e.toLowerCase(),t=>GT(t)===e),WT=e=>t=>typeof t===e,{isArray:A_}=Array,Ev=WT("undefined");function n2(e){return e!==null&&!Ev(e)&&e.constructor!==null&&!Ev(e.constructor)&&eu(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const tY=rf("ArrayBuffer");function o0e(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&tY(e.buffer),t}const l0e=WT("string"),eu=WT("function"),rY=WT("number"),i2=e=>e!==null&&typeof e=="object",c0e=e=>e===!0||e===!1,NN=e=>{if(GT(e)!=="object")return!1;const t=$4(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(eY in e)&&!(qT in e)},u0e=e=>{if(!i2(e)||n2(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},d0e=rf("Date"),h0e=rf("File"),f0e=rf("Blob"),p0e=rf("FileList"),m0e=e=>i2(e)&&eu(e.pipe),g0e=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||eu(e.append)&&((t=GT(e))==="formdata"||t==="object"&&eu(e.toString)&&e.toString()==="[object FormData]"))},y0e=rf("URLSearchParams"),[x0e,v0e,_0e,b0e]=["ReadableStream","Request","Response","Headers"].map(rf),w0e=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function a2(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),A_(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(n2(e))return;const c=r?Object.getOwnPropertyNames(e):Object.keys(e),h=c.length;let i;for(n=0;n<h;n++)i=c[n],t.call(null,e[i],i,e)}}function nY(e,t){if(n2(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const N0=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,iY=e=>!Ev(e)&&e!==N0;function PR(){const{caseless:e,skipUndefined:t}=iY(this)&&this||{},r={},n=(a,c)=>{const h=e&&nY(r,c)||c;NN(r[h])&&NN(a)?r[h]=PR(r[h],a):NN(a)?r[h]=PR({},a):A_(a)?r[h]=a.slice():(!t||!Ev(a))&&(r[h]=a)};for(let a=0,c=arguments.length;a<c;a++)arguments[a]&&a2(arguments[a],n);return r}const S0e=(e,t,r,{allOwnKeys:n}={})=>(a2(t,(a,c)=>{r&&eu(a)?e[c]=QZ(a,r):e[c]=a},{allOwnKeys:n}),e),N0e=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),A0e=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},T0e=(e,t,r,n)=>{let a,c,h;const i={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),c=a.length;c-- >0;)h=a[c],(!n||n(h,e,t))&&!i[h]&&(t[h]=e[h],i[h]=!0);e=r!==!1&&$4(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},j0e=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},k0e=e=>{if(!e)return null;if(A_(e))return e;let t=e.length;if(!rY(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},P0e=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&$4(Uint8Array)),C0e=(e,t)=>{const n=(e&&e[qT]).call(e);let a;for(;(a=n.next())&&!a.done;){const c=a.value;t.call(e,c[0],c[1])}},E0e=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},M0e=rf("HTMLFormElement"),O0e=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),F6=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),R0e=rf("RegExp"),aY=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};a2(r,(a,c)=>{let h;(h=t(a,c,e))!==!1&&(n[c]=h||a)}),Object.defineProperties(e,n)},I0e=e=>{aY(e,(t,r)=>{if(eu(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(eu(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},L0e=(e,t)=>{const r={},n=a=>{a.forEach(c=>{r[c]=!0})};return A_(e)?n(e):n(String(e).split(t)),r},D0e=()=>{},F0e=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function z0e(e){return!!(e&&eu(e.append)&&e[eY]==="FormData"&&e[qT])}const B0e=e=>{const t=new Array(10),r=(n,a)=>{if(i2(n)){if(t.indexOf(n)>=0)return;if(n2(n))return n;if(!("toJSON"in n)){t[a]=n;const c=A_(n)?[]:{};return a2(n,(h,i)=>{const x=r(h,a+1);!Ev(x)&&(c[i]=x)}),t[a]=void 0,c}}return n};return r(e,0)},V0e=rf("AsyncFunction"),U0e=e=>e&&(i2(e)||eu(e))&&eu(e.then)&&eu(e.catch),sY=((e,t)=>e?setImmediate:t?((r,n)=>(N0.addEventListener("message",({source:a,data:c})=>{a===N0&&c===r&&n.length&&n.shift()()},!1),a=>{n.push(a),N0.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",eu(N0.postMessage)),$0e=typeof queueMicrotask<"u"?queueMicrotask.bind(N0):typeof process<"u"&&process.nextTick||sY,q0e=e=>e!=null&&eu(e[qT]),er={isArray:A_,isArrayBuffer:tY,isBuffer:n2,isFormData:g0e,isArrayBufferView:o0e,isString:l0e,isNumber:rY,isBoolean:c0e,isObject:i2,isPlainObject:NN,isEmptyObject:u0e,isReadableStream:x0e,isRequest:v0e,isResponse:_0e,isHeaders:b0e,isUndefined:Ev,isDate:d0e,isFile:h0e,isBlob:f0e,isRegExp:R0e,isFunction:eu,isStream:m0e,isURLSearchParams:y0e,isTypedArray:P0e,isFileList:p0e,forEach:a2,merge:PR,extend:S0e,trim:w0e,stripBOM:N0e,inherits:A0e,toFlatObject:T0e,kindOf:GT,kindOfTest:rf,endsWith:j0e,toArray:k0e,forEachEntry:C0e,matchAll:E0e,isHTMLForm:M0e,hasOwnProperty:F6,hasOwnProp:F6,reduceDescriptors:aY,freezeMethods:I0e,toObjectSet:L0e,toCamelCase:O0e,noop:D0e,toFiniteNumber:F0e,findKey:nY,global:N0,isContextDefined:iY,isSpecCompliantForm:z0e,toJSONObject:B0e,isAsyncFn:V0e,isThenable:U0e,setImmediate:sY,asap:$0e,isIterable:q0e};function wi(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}er.inherits(wi,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:er.toJSONObject(this.config),code:this.code,status:this.status}}});const oY=wi.prototype,lY={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{lY[e]={value:e}});Object.defineProperties(wi,lY);Object.defineProperty(oY,"isAxiosError",{value:!0});wi.from=(e,t,r,n,a,c)=>{const h=Object.create(oY);er.toFlatObject(e,h,function(S){return S!==Error.prototype},w=>w!=="isAxiosError");const i=e&&e.message?e.message:"Error",x=t==null&&e?e.code:t;return wi.call(h,i,x,r,n,a),e&&h.cause==null&&Object.defineProperty(h,"cause",{value:e,configurable:!0}),h.name=e&&e.name||"Error",c&&Object.assign(h,c),h};const G0e=null;function CR(e){return er.isPlainObject(e)||er.isArray(e)}function cY(e){return er.endsWith(e,"[]")?e.slice(0,-2):e}function z6(e,t,r){return e?e.concat(t).map(function(a,c){return a=cY(a),!r&&c?"["+a+"]":a}).join(r?".":""):t}function W0e(e){return er.isArray(e)&&!e.some(CR)}const H0e=er.toFlatObject(er,{},null,function(t){return/^is[A-Z]/.test(t)});function HT(e,t,r){if(!er.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=er.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(I,V){return!er.isUndefined(V[I])});const n=r.metaTokens,a=r.visitor||S,c=r.dots,h=r.indexes,x=(r.Blob||typeof Blob<"u"&&Blob)&&er.isSpecCompliantForm(t);if(!er.isFunction(a))throw new TypeError("visitor must be a function");function w(U){if(U===null)return"";if(er.isDate(U))return U.toISOString();if(er.isBoolean(U))return U.toString();if(!x&&er.isBlob(U))throw new wi("Blob is not supported. Use a Buffer instead.");return er.isArrayBuffer(U)||er.isTypedArray(U)?x&&typeof Blob=="function"?new Blob([U]):Buffer.from(U):U}function S(U,I,V){let H=U;if(U&&!V&&typeof U=="object"){if(er.endsWith(I,"{}"))I=n?I:I.slice(0,-2),U=JSON.stringify(U);else if(er.isArray(U)&&W0e(U)||(er.isFileList(U)||er.endsWith(I,"[]"))&&(H=er.toArray(U)))return I=cY(I),H.forEach(function(Q,ae){!(er.isUndefined(Q)||Q===null)&&t.append(h===!0?z6([I],ae,c):h===null?I:I+"[]",w(Q))}),!1}return CR(U)?!0:(t.append(z6(V,I,c),w(U)),!1)}const T=[],E=Object.assign(H0e,{defaultVisitor:S,convertValue:w,isVisitable:CR});function D(U,I){if(!er.isUndefined(U)){if(T.indexOf(U)!==-1)throw Error("Circular reference detected in "+I.join("."));T.push(U),er.forEach(U,function(H,K){(!(er.isUndefined(H)||H===null)&&a.call(t,H,er.isString(K)?K.trim():K,I,E))===!0&&D(H,I?I.concat(K):[K])}),T.pop()}}if(!er.isObject(e))throw new TypeError("data must be an object");return D(e),t}function B6(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function q4(e,t){this._pairs=[],e&&HT(e,this,t)}const uY=q4.prototype;uY.append=function(t,r){this._pairs.push([t,r])};uY.toString=function(t){const r=t?function(n){return t.call(this,n,B6)}:B6;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function K0e(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function dY(e,t,r){if(!t)return e;const n=r&&r.encode||K0e;er.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let c;if(a?c=a(t,r):c=er.isURLSearchParams(t)?t.toString():new q4(t,r).toString(n),c){const h=e.indexOf("#");h!==-1&&(e=e.slice(0,h)),e+=(e.indexOf("?")===-1?"?":"&")+c}return e}class V6{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){er.forEach(this.handlers,function(n){n!==null&&t(n)})}}const hY={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Z0e=typeof URLSearchParams<"u"?URLSearchParams:q4,Y0e=typeof FormData<"u"?FormData:null,X0e=typeof Blob<"u"?Blob:null,J0e={isBrowser:!0,classes:{URLSearchParams:Z0e,FormData:Y0e,Blob:X0e},protocols:["http","https","file","blob","url","data"]},G4=typeof window<"u"&&typeof document<"u",ER=typeof navigator=="object"&&navigator||void 0,Q0e=G4&&(!ER||["ReactNative","NativeScript","NS"].indexOf(ER.product)<0),exe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",txe=G4&&window.location.href||"http://localhost",rxe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:G4,hasStandardBrowserEnv:Q0e,hasStandardBrowserWebWorkerEnv:exe,navigator:ER,origin:txe},Symbol.toStringTag,{value:"Module"})),ec={...rxe,...J0e};function nxe(e,t){return HT(e,new ec.classes.URLSearchParams,{visitor:function(r,n,a,c){return ec.isNode&&er.isBuffer(r)?(this.append(n,r.toString("base64")),!1):c.defaultVisitor.apply(this,arguments)},...t})}function ixe(e){return er.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function axe(e){const t={},r=Object.keys(e);let n;const a=r.length;let c;for(n=0;n<a;n++)c=r[n],t[c]=e[c];return t}function fY(e){function t(r,n,a,c){let h=r[c++];if(h==="__proto__")return!0;const i=Number.isFinite(+h),x=c>=r.length;return h=!h&&er.isArray(a)?a.length:h,x?(er.hasOwnProp(a,h)?a[h]=[a[h],n]:a[h]=n,!i):((!a[h]||!er.isObject(a[h]))&&(a[h]=[]),t(r,n,a[h],c)&&er.isArray(a[h])&&(a[h]=axe(a[h])),!i)}if(er.isFormData(e)&&er.isFunction(e.entries)){const r={};return er.forEachEntry(e,(n,a)=>{t(ixe(n),a,r,0)}),r}return null}function sxe(e,t,r){if(er.isString(e))try{return(t||JSON.parse)(e),er.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const s2={transitional:hY,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,c=er.isObject(t);if(c&&er.isHTMLForm(t)&&(t=new FormData(t)),er.isFormData(t))return a?JSON.stringify(fY(t)):t;if(er.isArrayBuffer(t)||er.isBuffer(t)||er.isStream(t)||er.isFile(t)||er.isBlob(t)||er.isReadableStream(t))return t;if(er.isArrayBufferView(t))return t.buffer;if(er.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let i;if(c){if(n.indexOf("application/x-www-form-urlencoded")>-1)return nxe(t,this.formSerializer).toString();if((i=er.isFileList(t))||n.indexOf("multipart/form-data")>-1){const x=this.env&&this.env.FormData;return HT(i?{"files[]":t}:t,x&&new x,this.formSerializer)}}return c||a?(r.setContentType("application/json",!1),sxe(t)):t}],transformResponse:[function(t){const r=this.transitional||s2.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(er.isResponse(t)||er.isReadableStream(t))return t;if(t&&er.isString(t)&&(n&&!this.responseType||a)){const h=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(i){if(h)throw i.name==="SyntaxError"?wi.from(i,wi.ERR_BAD_RESPONSE,this,null,this.response):i}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ec.classes.FormData,Blob:ec.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};er.forEach(["delete","get","head","post","put","patch"],e=>{s2.headers[e]={}});const oxe=er.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),lxe=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(h){a=h.indexOf(":"),r=h.substring(0,a).trim().toLowerCase(),n=h.substring(a+1).trim(),!(!r||t[r]&&oxe[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},U6=Symbol("internals");function Fb(e){return e&&String(e).trim().toLowerCase()}function AN(e){return e===!1||e==null?e:er.isArray(e)?e.map(AN):String(e)}function cxe(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const uxe=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function SP(e,t,r,n,a){if(er.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!er.isString(t)){if(er.isString(n))return t.indexOf(n)!==-1;if(er.isRegExp(n))return n.test(t)}}function dxe(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function hxe(e,t){const r=er.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,c,h){return this[n].call(this,t,a,c,h)},configurable:!0})})}let tu=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function c(i,x,w){const S=Fb(x);if(!S)throw new Error("header name must be a non-empty string");const T=er.findKey(a,S);(!T||a[T]===void 0||w===!0||w===void 0&&a[T]!==!1)&&(a[T||x]=AN(i))}const h=(i,x)=>er.forEach(i,(w,S)=>c(w,S,x));if(er.isPlainObject(t)||t instanceof this.constructor)h(t,r);else if(er.isString(t)&&(t=t.trim())&&!uxe(t))h(lxe(t),r);else if(er.isObject(t)&&er.isIterable(t)){let i={},x,w;for(const S of t){if(!er.isArray(S))throw TypeError("Object iterator must return a key-value pair");i[w=S[0]]=(x=i[w])?er.isArray(x)?[...x,S[1]]:[x,S[1]]:S[1]}h(i,r)}else t!=null&&c(r,t,n);return this}get(t,r){if(t=Fb(t),t){const n=er.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return cxe(a);if(er.isFunction(r))return r.call(this,a,n);if(er.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Fb(t),t){const n=er.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||SP(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function c(h){if(h=Fb(h),h){const i=er.findKey(n,h);i&&(!r||SP(n,n[i],i,r))&&(delete n[i],a=!0)}}return er.isArray(t)?t.forEach(c):c(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const c=r[n];(!t||SP(this,this[c],c,t,!0))&&(delete this[c],a=!0)}return a}normalize(t){const r=this,n={};return er.forEach(this,(a,c)=>{const h=er.findKey(n,c);if(h){r[h]=AN(a),delete r[c];return}const i=t?dxe(c):String(c).trim();i!==c&&delete r[c],r[i]=AN(a),n[i]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return er.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&er.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[U6]=this[U6]={accessors:{}}).accessors,a=this.prototype;function c(h){const i=Fb(h);n[i]||(hxe(a,h),n[i]=!0)}return er.isArray(t)?t.forEach(c):c(t),this}};tu.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);er.reduceDescriptors(tu.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});er.freezeMethods(tu);function NP(e,t){const r=this||s2,n=t||r,a=tu.from(n.headers);let c=n.data;return er.forEach(e,function(i){c=i.call(r,c,a.normalize(),t?t.status:void 0)}),a.normalize(),c}function pY(e){return!!(e&&e.__CANCEL__)}function T_(e,t,r){wi.call(this,e??"canceled",wi.ERR_CANCELED,t,r),this.name="CanceledError"}er.inherits(T_,wi,{__CANCEL__:!0});function mY(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new wi("Request failed with status code "+r.status,[wi.ERR_BAD_REQUEST,wi.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function fxe(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function pxe(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,c=0,h;return t=t!==void 0?t:1e3,function(x){const w=Date.now(),S=n[c];h||(h=w),r[a]=x,n[a]=w;let T=c,E=0;for(;T!==a;)E+=r[T++],T=T%e;if(a=(a+1)%e,a===c&&(c=(c+1)%e),w-h<t)return;const D=S&&w-S;return D?Math.round(E*1e3/D):void 0}}function mxe(e,t){let r=0,n=1e3/t,a,c;const h=(w,S=Date.now())=>{r=S,a=null,c&&(clearTimeout(c),c=null),e(...w)};return[(...w)=>{const S=Date.now(),T=S-r;T>=n?h(w,S):(a=w,c||(c=setTimeout(()=>{c=null,h(a)},n-T)))},()=>a&&h(a)]}const iA=(e,t,r=3)=>{let n=0;const a=pxe(50,250);return mxe(c=>{const h=c.loaded,i=c.lengthComputable?c.total:void 0,x=h-n,w=a(x),S=h<=i;n=h;const T={loaded:h,total:i,progress:i?h/i:void 0,bytes:x,rate:w||void 0,estimated:w&&i&&S?(i-h)/w:void 0,event:c,lengthComputable:i!=null,[t?"download":"upload"]:!0};e(T)},r)},$6=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},q6=e=>(...t)=>er.asap(()=>e(...t)),gxe=ec.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,ec.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(ec.origin),ec.navigator&&/(msie|trident)/i.test(ec.navigator.userAgent)):()=>!0,yxe=ec.hasStandardBrowserEnv?{write(e,t,r,n,a,c,h){if(typeof document>"u")return;const i=[`${e}=${encodeURIComponent(t)}`];er.isNumber(r)&&i.push(`expires=${new Date(r).toUTCString()}`),er.isString(n)&&i.push(`path=${n}`),er.isString(a)&&i.push(`domain=${a}`),c===!0&&i.push("secure"),er.isString(h)&&i.push(`SameSite=${h}`),document.cookie=i.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function xxe(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function vxe(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function gY(e,t,r){let n=!xxe(t);return e&&(n||r==!1)?vxe(e,t):t}const G6=e=>e instanceof tu?{...e}:e;function q0(e,t){t=t||{};const r={};function n(w,S,T,E){return er.isPlainObject(w)&&er.isPlainObject(S)?er.merge.call({caseless:E},w,S):er.isPlainObject(S)?er.merge({},S):er.isArray(S)?S.slice():S}function a(w,S,T,E){if(er.isUndefined(S)){if(!er.isUndefined(w))return n(void 0,w,T,E)}else return n(w,S,T,E)}function c(w,S){if(!er.isUndefined(S))return n(void 0,S)}function h(w,S){if(er.isUndefined(S)){if(!er.isUndefined(w))return n(void 0,w)}else return n(void 0,S)}function i(w,S,T){if(T in t)return n(w,S);if(T in e)return n(void 0,w)}const x={url:c,method:c,data:c,baseURL:h,transformRequest:h,transformResponse:h,paramsSerializer:h,timeout:h,timeoutMessage:h,withCredentials:h,withXSRFToken:h,adapter:h,responseType:h,xsrfCookieName:h,xsrfHeaderName:h,onUploadProgress:h,onDownloadProgress:h,decompress:h,maxContentLength:h,maxBodyLength:h,beforeRedirect:h,transport:h,httpAgent:h,httpsAgent:h,cancelToken:h,socketPath:h,responseEncoding:h,validateStatus:i,headers:(w,S,T)=>a(G6(w),G6(S),T,!0)};return er.forEach(Object.keys({...e,...t}),function(S){const T=x[S]||a,E=T(e[S],t[S],S);er.isUndefined(E)&&T!==i||(r[S]=E)}),r}const yY=e=>{const t=q0({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:c,headers:h,auth:i}=t;if(t.headers=h=tu.from(h),t.url=dY(gY(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),i&&h.set("Authorization","Basic "+btoa((i.username||"")+":"+(i.password?unescape(encodeURIComponent(i.password)):""))),er.isFormData(r)){if(ec.hasStandardBrowserEnv||ec.hasStandardBrowserWebWorkerEnv)h.setContentType(void 0);else if(er.isFunction(r.getHeaders)){const x=r.getHeaders(),w=["content-type","content-length"];Object.entries(x).forEach(([S,T])=>{w.includes(S.toLowerCase())&&h.set(S,T)})}}if(ec.hasStandardBrowserEnv&&(n&&er.isFunction(n)&&(n=n(t)),n||n!==!1&&gxe(t.url))){const x=a&&c&&yxe.read(c);x&&h.set(a,x)}return t},_xe=typeof XMLHttpRequest<"u",bxe=_xe&&function(e){return new Promise(function(r,n){const a=yY(e);let c=a.data;const h=tu.from(a.headers).normalize();let{responseType:i,onUploadProgress:x,onDownloadProgress:w}=a,S,T,E,D,U;function I(){D&&D(),U&&U(),a.cancelToken&&a.cancelToken.unsubscribe(S),a.signal&&a.signal.removeEventListener("abort",S)}let V=new XMLHttpRequest;V.open(a.method.toUpperCase(),a.url,!0),V.timeout=a.timeout;function H(){if(!V)return;const Q=tu.from("getAllResponseHeaders"in V&&V.getAllResponseHeaders()),ee={data:!i||i==="text"||i==="json"?V.responseText:V.response,status:V.status,statusText:V.statusText,headers:Q,config:e,request:V};mY(function(ue){r(ue),I()},function(ue){n(ue),I()},ee),V=null}"onloadend"in V?V.onloadend=H:V.onreadystatechange=function(){!V||V.readyState!==4||V.status===0&&!(V.responseURL&&V.responseURL.indexOf("file:")===0)||setTimeout(H)},V.onabort=function(){V&&(n(new wi("Request aborted",wi.ECONNABORTED,e,V)),V=null)},V.onerror=function(ae){const ee=ae&&ae.message?ae.message:"Network Error",se=new wi(ee,wi.ERR_NETWORK,e,V);se.event=ae||null,n(se),V=null},V.ontimeout=function(){let ae=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const ee=a.transitional||hY;a.timeoutErrorMessage&&(ae=a.timeoutErrorMessage),n(new wi(ae,ee.clarifyTimeoutError?wi.ETIMEDOUT:wi.ECONNABORTED,e,V)),V=null},c===void 0&&h.setContentType(null),"setRequestHeader"in V&&er.forEach(h.toJSON(),function(ae,ee){V.setRequestHeader(ee,ae)}),er.isUndefined(a.withCredentials)||(V.withCredentials=!!a.withCredentials),i&&i!=="json"&&(V.responseType=a.responseType),w&&([E,U]=iA(w,!0),V.addEventListener("progress",E)),x&&V.upload&&([T,D]=iA(x),V.upload.addEventListener("progress",T),V.upload.addEventListener("loadend",D)),(a.cancelToken||a.signal)&&(S=Q=>{V&&(n(!Q||Q.type?new T_(null,e,V):Q),V.abort(),V=null)},a.cancelToken&&a.cancelToken.subscribe(S),a.signal&&(a.signal.aborted?S():a.signal.addEventListener("abort",S)));const K=fxe(a.url);if(K&&ec.protocols.indexOf(K)===-1){n(new wi("Unsupported protocol "+K+":",wi.ERR_BAD_REQUEST,e));return}V.send(c||null)})},wxe=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const c=function(w){if(!a){a=!0,i();const S=w instanceof Error?w:this.reason;n.abort(S instanceof wi?S:new T_(S instanceof Error?S.message:S))}};let h=t&&setTimeout(()=>{h=null,c(new wi(`timeout ${t} of ms exceeded`,wi.ETIMEDOUT))},t);const i=()=>{e&&(h&&clearTimeout(h),h=null,e.forEach(w=>{w.unsubscribe?w.unsubscribe(c):w.removeEventListener("abort",c)}),e=null)};e.forEach(w=>w.addEventListener("abort",c));const{signal:x}=n;return x.unsubscribe=()=>er.asap(i),x}},Sxe=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},Nxe=async function*(e,t){for await(const r of Axe(e))yield*Sxe(r,t)},Axe=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},W6=(e,t,r,n)=>{const a=Nxe(e,t);let c=0,h,i=x=>{h||(h=!0,n&&n(x))};return new ReadableStream({async pull(x){try{const{done:w,value:S}=await a.next();if(w){i(),x.close();return}let T=S.byteLength;if(r){let E=c+=T;r(E)}x.enqueue(new Uint8Array(S))}catch(w){throw i(w),w}},cancel(x){return i(x),a.return()}},{highWaterMark:2})},H6=64*1024,{isFunction:US}=er,Txe=(({Request:e,Response:t})=>({Request:e,Response:t}))(er.global),{ReadableStream:K6,TextEncoder:Z6}=er.global,Y6=(e,...t)=>{try{return!!e(...t)}catch{return!1}},jxe=e=>{e=er.merge.call({skipUndefined:!0},Txe,e);const{fetch:t,Request:r,Response:n}=e,a=t?US(t):typeof fetch=="function",c=US(r),h=US(n);if(!a)return!1;const i=a&&US(K6),x=a&&(typeof Z6=="function"?(U=>I=>U.encode(I))(new Z6):async U=>new Uint8Array(await new r(U).arrayBuffer())),w=c&&i&&Y6(()=>{let U=!1;const I=new r(ec.origin,{body:new K6,method:"POST",get duplex(){return U=!0,"half"}}).headers.has("Content-Type");return U&&!I}),S=h&&i&&Y6(()=>er.isReadableStream(new n("").body)),T={stream:S&&(U=>U.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(U=>{!T[U]&&(T[U]=(I,V)=>{let H=I&&I[U];if(H)return H.call(I);throw new wi(`Response type '${U}' is not supported`,wi.ERR_NOT_SUPPORT,V)})});const E=async U=>{if(U==null)return 0;if(er.isBlob(U))return U.size;if(er.isSpecCompliantForm(U))return(await new r(ec.origin,{method:"POST",body:U}).arrayBuffer()).byteLength;if(er.isArrayBufferView(U)||er.isArrayBuffer(U))return U.byteLength;if(er.isURLSearchParams(U)&&(U=U+""),er.isString(U))return(await x(U)).byteLength},D=async(U,I)=>{const V=er.toFiniteNumber(U.getContentLength());return V??E(I)};return async U=>{let{url:I,method:V,data:H,signal:K,cancelToken:Q,timeout:ae,onDownloadProgress:ee,onUploadProgress:se,responseType:ue,headers:he,withCredentials:Ce="same-origin",fetchOptions:Ne}=yY(U),me=t||fetch;ue=ue?(ue+"").toLowerCase():"text";let be=wxe([K,Q&&Q.toAbortSignal()],ae),pe=null;const Se=be&&be.unsubscribe&&(()=>{be.unsubscribe()});let Ee;try{if(se&&w&&V!=="get"&&V!=="head"&&(Ee=await D(he,H))!==0){let We=new r(I,{method:"POST",body:H,duplex:"half"}),tt;if(er.isFormData(H)&&(tt=We.headers.get("content-type"))&&he.setContentType(tt),We.body){const[nt,Dt]=$6(Ee,iA(q6(se)));H=W6(We.body,H6,nt,Dt)}}er.isString(Ce)||(Ce=Ce?"include":"omit");const we=c&&"credentials"in r.prototype,Pe={...Ne,signal:be,method:V.toUpperCase(),headers:he.normalize().toJSON(),body:H,duplex:"half",credentials:we?Ce:void 0};pe=c&&new r(I,Pe);let Me=await(c?me(pe,Ne):me(I,Pe));const Be=S&&(ue==="stream"||ue==="response");if(S&&(ee||Be&&Se)){const We={};["status","statusText","headers"].forEach(nr=>{We[nr]=Me[nr]});const tt=er.toFiniteNumber(Me.headers.get("content-length")),[nt,Dt]=ee&&$6(tt,iA(q6(ee),!0))||[];Me=new n(W6(Me.body,H6,nt,()=>{Dt&&Dt(),Se&&Se()}),We)}ue=ue||"text";let Ge=await T[er.findKey(T,ue)||"text"](Me,U);return!Be&&Se&&Se(),await new Promise((We,tt)=>{mY(We,tt,{data:Ge,headers:tu.from(Me.headers),status:Me.status,statusText:Me.statusText,config:U,request:pe})})}catch(we){throw Se&&Se(),we&&we.name==="TypeError"&&/Load failed|fetch/i.test(we.message)?Object.assign(new wi("Network Error",wi.ERR_NETWORK,U,pe),{cause:we.cause||we}):wi.from(we,we&&we.code,U,pe)}}},kxe=new Map,xY=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:a}=t,c=[n,a,r];let h=c.length,i=h,x,w,S=kxe;for(;i--;)x=c[i],w=S.get(x),w===void 0&&S.set(x,w=i?new Map:jxe(t)),S=w;return w};xY();const W4={http:G0e,xhr:bxe,fetch:{get:xY}};er.forEach(W4,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const X6=e=>`- ${e}`,Pxe=e=>er.isFunction(e)||e===null||e===!1;function Cxe(e,t){e=er.isArray(e)?e:[e];const{length:r}=e;let n,a;const c={};for(let h=0;h<r;h++){n=e[h];let i;if(a=n,!Pxe(n)&&(a=W4[(i=String(n)).toLowerCase()],a===void 0))throw new wi(`Unknown adapter '${i}'`);if(a&&(er.isFunction(a)||(a=a.get(t))))break;c[i||"#"+h]=a}if(!a){const h=Object.entries(c).map(([x,w])=>`adapter ${x} `+(w===!1?"is not supported by the environment":"is not available in the build"));let i=r?h.length>1?`since :
`+h.map(X6).join(`
`):" "+X6(h[0]):"as no adapter specified";throw new wi("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return a}const vY={getAdapter:Cxe,adapters:W4};function AP(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new T_(null,e)}function J6(e){return AP(e),e.headers=tu.from(e.headers),e.data=NP.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),vY.getAdapter(e.adapter||s2.adapter,e)(e).then(function(n){return AP(e),n.data=NP.call(e,e.transformResponse,n),n.headers=tu.from(n.headers),n},function(n){return pY(n)||(AP(e),n&&n.response&&(n.response.data=NP.call(e,e.transformResponse,n.response),n.response.headers=tu.from(n.response.headers))),Promise.reject(n)})}const _Y="1.13.1",KT={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{KT[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Q6={};KT.transitional=function(t,r,n){function a(c,h){return"[Axios v"+_Y+"] Transitional option '"+c+"'"+h+(n?". "+n:"")}return(c,h,i)=>{if(t===!1)throw new wi(a(h," has been removed"+(r?" in "+r:"")),wi.ERR_DEPRECATED);return r&&!Q6[h]&&(Q6[h]=!0,console.warn(a(h," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(c,h,i):!0}};KT.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function Exe(e,t,r){if(typeof e!="object")throw new wi("options must be an object",wi.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const c=n[a],h=t[c];if(h){const i=e[c],x=i===void 0||h(i,c,e);if(x!==!0)throw new wi("option "+c+" must be "+x,wi.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new wi("Unknown option "+c,wi.ERR_BAD_OPTION)}}const TN={assertOptions:Exe,validators:KT},Uf=TN.validators;let O0=class{constructor(t){this.defaults=t||{},this.interceptors={request:new V6,response:new V6}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const c=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?c&&!String(n.stack).endsWith(c.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+c):n.stack=c}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=q0(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:c}=r;n!==void 0&&TN.assertOptions(n,{silentJSONParsing:Uf.transitional(Uf.boolean),forcedJSONParsing:Uf.transitional(Uf.boolean),clarifyTimeoutError:Uf.transitional(Uf.boolean)},!1),a!=null&&(er.isFunction(a)?r.paramsSerializer={serialize:a}:TN.assertOptions(a,{encode:Uf.function,serialize:Uf.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),TN.assertOptions(r,{baseUrl:Uf.spelling("baseURL"),withXsrfToken:Uf.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let h=c&&er.merge(c.common,c[r.method]);c&&er.forEach(["delete","get","head","post","put","patch","common"],U=>{delete c[U]}),r.headers=tu.concat(h,c);const i=[];let x=!0;this.interceptors.request.forEach(function(I){typeof I.runWhen=="function"&&I.runWhen(r)===!1||(x=x&&I.synchronous,i.unshift(I.fulfilled,I.rejected))});const w=[];this.interceptors.response.forEach(function(I){w.push(I.fulfilled,I.rejected)});let S,T=0,E;if(!x){const U=[J6.bind(this),void 0];for(U.unshift(...i),U.push(...w),E=U.length,S=Promise.resolve(r);T<E;)S=S.then(U[T++],U[T++]);return S}E=i.length;let D=r;for(;T<E;){const U=i[T++],I=i[T++];try{D=U(D)}catch(V){I.call(this,V);break}}try{S=J6.call(this,D)}catch(U){return Promise.reject(U)}for(T=0,E=w.length;T<E;)S=S.then(w[T++],w[T++]);return S}getUri(t){t=q0(this.defaults,t);const r=gY(t.baseURL,t.url,t.allowAbsoluteUrls);return dY(r,t.params,t.paramsSerializer)}};er.forEach(["delete","get","head","options"],function(t){O0.prototype[t]=function(r,n){return this.request(q0(n||{},{method:t,url:r,data:(n||{}).data}))}});er.forEach(["post","put","patch"],function(t){function r(n){return function(c,h,i){return this.request(q0(i||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:c,data:h}))}}O0.prototype[t]=r(),O0.prototype[t+"Form"]=r(!0)});let Mxe=class bY{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(c){r=c});const n=this;this.promise.then(a=>{if(!n._listeners)return;let c=n._listeners.length;for(;c-- >0;)n._listeners[c](a);n._listeners=null}),this.promise.then=a=>{let c;const h=new Promise(i=>{n.subscribe(i),c=i}).then(a);return h.cancel=function(){n.unsubscribe(c)},h},t(function(c,h,i){n.reason||(n.reason=new T_(c,h,i),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new bY(function(a){t=a}),cancel:t}}};function Oxe(e){return function(r){return e.apply(null,r)}}function Rxe(e){return er.isObject(e)&&e.isAxiosError===!0}const MR={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(MR).forEach(([e,t])=>{MR[t]=e});function wY(e){const t=new O0(e),r=QZ(O0.prototype.request,t);return er.extend(r,O0.prototype,t,{allOwnKeys:!0}),er.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return wY(q0(e,a))},r}const go=wY(s2);go.Axios=O0;go.CanceledError=T_;go.CancelToken=Mxe;go.isCancel=pY;go.VERSION=_Y;go.toFormData=HT;go.AxiosError=wi;go.Cancel=go.CanceledError;go.all=function(t){return Promise.all(t)};go.spread=Oxe;go.isAxiosError=Rxe;go.mergeConfig=q0;go.AxiosHeaders=tu;go.formToJSON=e=>fY(er.isHTMLForm(e)?new FormData(e):e);go.getAdapter=vY.getAdapter;go.HttpStatusCode=MR;go.default=go;const{Axios:F$e,AxiosError:z$e,CanceledError:B$e,isCancel:V$e,CancelToken:U$e,VERSION:$$e,all:q$e,Cancel:G$e,isAxiosError:W$e,spread:H$e,toFormData:K$e,AxiosHeaders:Z$e,HttpStatusCode:Y$e,formToJSON:X$e,getAdapter:J$e,mergeConfig:Q$e}=go,Ixe="http://localhost:5000/api",mn=go.create({baseURL:Ixe});mn.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=t),e},e=>Promise.reject(e));mn.interceptors.response.use(e=>e,e=>{var t,r,n;return((t=e.response)==null?void 0:t.status)===401&&((n=(r=e.config)==null?void 0:r.url)!=null&&n.includes("/auth/login")||(localStorage.removeItem("token"),localStorage.removeItem("userData"))),Promise.reject(e)});class r1 extends Error{}r1.prototype.name="InvalidTokenError";function Lxe(e){return decodeURIComponent(atob(e).replace(/(.)/g,(t,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function Dxe(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Lxe(t)}catch{return atob(t)}}function $S(e,t){if(typeof e!="string")throw new r1("Invalid token specified: must be a string");t||(t={});const r=t.header===!0?0:1,n=e.split(".")[r];if(typeof n!="string")throw new r1(`Invalid token specified: missing part #${r+1}`);let a;try{a=Dxe(n)}catch(c){throw new r1(`Invalid token specified: invalid base64 for part #${r+1} (${c.message})`)}try{return JSON.parse(a)}catch(c){throw new r1(`Invalid token specified: invalid json for part #${r+1} (${c.message})`)}}var H4="Dialog",[SY,NY]=qd(H4),[Fxe,nf]=SY(H4),AY=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:c,modal:h=!0}=e,i=G.useRef(null),x=G.useRef(null),[w=!1,S]=Jg({prop:n,defaultProp:a,onChange:c});return o.jsx(Fxe,{scope:t,triggerRef:i,contentRef:x,contentId:Ld(),titleId:Ld(),descriptionId:Ld(),open:w,onOpenChange:S,onOpenToggle:G.useCallback(()=>S(T=>!T),[S]),modal:h,children:r})};AY.displayName=H4;var TY="DialogTrigger",jY=G.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=nf(TY,r),c=ta(t,a.triggerRef);return o.jsx(gi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Y4(a.open),...n,ref:c,onClick:dn(e.onClick,a.onOpenToggle)})});jY.displayName=TY;var K4="DialogPortal",[zxe,kY]=SY(K4,{forceMount:void 0}),PY=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,c=nf(K4,t);return o.jsx(zxe,{scope:t,forceMount:r,children:G.Children.map(n,h=>o.jsx($u,{present:r||c.open,children:o.jsx(S_,{asChild:!0,container:a,children:h})}))})};PY.displayName=K4;var aA="DialogOverlay",CY=G.forwardRef((e,t)=>{const r=kY(aA,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,c=nf(aA,e.__scopeDialog);return c.modal?o.jsx($u,{present:n||c.open,children:o.jsx(Bxe,{...a,ref:t})}):null});CY.displayName=aA;var Bxe=G.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=nf(aA,r);return o.jsx(Jw,{as:nc,allowPinchZoom:!0,shards:[a.contentRef],children:o.jsx(gi.div,{"data-state":Y4(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),G0="DialogContent",EY=G.forwardRef((e,t)=>{const r=kY(G0,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,c=nf(G0,e.__scopeDialog);return o.jsx($u,{present:n||c.open,children:c.modal?o.jsx(Vxe,{...a,ref:t}):o.jsx(Uxe,{...a,ref:t})})});EY.displayName=G0;var Vxe=G.forwardRef((e,t)=>{const r=nf(G0,e.__scopeDialog),n=G.useRef(null),a=ta(t,r.contentRef,n);return G.useEffect(()=>{const c=n.current;if(c)return IT(c)},[]),o.jsx(MY,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:dn(e.onCloseAutoFocus,c=>{var h;c.preventDefault(),(h=r.triggerRef.current)==null||h.focus()}),onPointerDownOutside:dn(e.onPointerDownOutside,c=>{const h=c.detail.originalEvent,i=h.button===0&&h.ctrlKey===!0;(h.button===2||i)&&c.preventDefault()}),onFocusOutside:dn(e.onFocusOutside,c=>c.preventDefault())})}),Uxe=G.forwardRef((e,t)=>{const r=nf(G0,e.__scopeDialog),n=G.useRef(!1),a=G.useRef(!1);return o.jsx(MY,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var h,i;(h=e.onCloseAutoFocus)==null||h.call(e,c),c.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),c.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:c=>{var x,w;(x=e.onInteractOutside)==null||x.call(e,c),c.defaultPrevented||(n.current=!0,c.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const h=c.target;((w=r.triggerRef.current)==null?void 0:w.contains(h))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&a.current&&c.preventDefault()}})}),MY=G.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:c,...h}=e,i=nf(G0,r),x=G.useRef(null),w=ta(t,x);return jT(),o.jsxs(o.Fragment,{children:[o.jsx(Zw,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:c,children:o.jsx(__,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":Y4(i.open),...h,ref:w,onDismiss:()=>i.onOpenChange(!1)})}),o.jsxs(o.Fragment,{children:[o.jsx(qxe,{titleId:i.titleId}),o.jsx(Wxe,{contentRef:x,descriptionId:i.descriptionId})]})]})}),Z4="DialogTitle",OY=G.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=nf(Z4,r);return o.jsx(gi.h2,{id:a.titleId,...n,ref:t})});OY.displayName=Z4;var RY="DialogDescription",IY=G.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=nf(RY,r);return o.jsx(gi.p,{id:a.descriptionId,...n,ref:t})});IY.displayName=RY;var LY="DialogClose",DY=G.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=nf(LY,r);return o.jsx(gi.button,{type:"button",...n,ref:t,onClick:dn(e.onClick,()=>a.onOpenChange(!1))})});DY.displayName=LY;function Y4(e){return e?"open":"closed"}var FY="DialogTitleWarning",[$xe,zY]=ghe(FY,{contentName:G0,titleName:Z4,docsSlug:"dialog"}),qxe=({titleId:e})=>{const t=zY(FY),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return G.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},Gxe="DialogDescriptionWarning",Wxe=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${zY(Gxe).contentName}}.`;return G.useEffect(()=>{var c;const a=(c=e.current)==null?void 0:c.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},X4=AY,Hxe=jY,J4=PY,o2=CY,l2=EY,c2=OY,u2=IY,ZT=DY;const Yi=X4,Kxe=J4,BY=G.forwardRef(({className:e,...t},r)=>o.jsx(o2,{ref:r,className:zt("fixed inset-0 z-50 bg-black/60 backdrop-blur-[10px] dark:bg-[#101010]/80 dark:backdrop-blur-[5px] data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));BY.displayName=o2.displayName;const Bi=G.forwardRef(({className:e,children:t,...r},n)=>o.jsxs(Kxe,{children:[o.jsx(BY,{}),o.jsxs(l2,{ref:n,className:zt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]",e),onPointerDownOutside:a=>a.preventDefault(),onEscapeKeyDown:a=>a.preventDefault(),...r,children:[t,o.jsxs(ZT,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700 text-gray-900 dark:text-gray-100",children:[o.jsx(zd,{className:"h-4 w-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Bi.displayName=l2.displayName;const ia=({className:e,...t})=>o.jsx("div",{className:zt("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});ia.displayName="DialogHeader";const mo=({className:e,...t})=>o.jsx("div",{className:zt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});mo.displayName="DialogFooter";const aa=G.forwardRef(({className:e,...t},r)=>o.jsx(c2,{ref:r,className:zt("text-lg font-semibold leading-none tracking-tight",e),...t}));aa.displayName=c2.displayName;const js=G.forwardRef(({className:e,...t},r)=>o.jsx(u2,{ref:r,className:zt("text-sm text-muted-foreground",e),...t}));js.displayName=u2.displayName;const Zxe=({isOpen:e,onClose:t,onSuccess:r,userEmail:n})=>{const[a,c]=G.useState(""),[h,i]=G.useState(!1),[x,w]=G.useState(300),[S,T]=G.useState(!1);G.useEffect(()=>{if(x>0&&e){const I=setTimeout(()=>w(x-1),1e3);return()=>clearTimeout(I)}else x===0&&T(!0)},[x,e]),G.useEffect(()=>{e&&(w(300),T(!1),c(""))},[e]);const E=async I=>{var V,H;if(I.preventDefault(),!a||a.length!==6){Xr.error("Please enter a valid 6-digit OTP");return}i(!0);try{const K=await mn.post("/auth/verify-otp",{email:n,otp:a});K.data.success?(Xr.success("OTP verified successfully!"),r(K.data.token)):Xr.error(K.data.message||"OTP verification failed")}catch(K){const Q=((H=(V=K.response)==null?void 0:V.data)==null?void 0:H.message)||"OTP verification failed";Xr.error(Q)}finally{i(!1)}},D=async()=>{i(!0);try{Xr.info("Please login again to receive a new OTP"),t()}catch{Xr.error("Failed to resend OTP")}finally{i(!1)}},U=I=>{const V=Math.floor(I/60),H=I%60;return`${V}:${H.toString().padStart(2,"0")}`};return o.jsx(Yi,{open:e,onOpenChange:t,children:o.jsxs(Bi,{className:"sm:max-w-md",children:[o.jsxs(ia,{children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(Xg,{className:"h-5 w-5 text-blue-600"}),"OTP Verification Required"]}),o.jsx(js,{children:"Please enter the 6-digit OTP sent to your email address to complete the login process."})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg",children:[o.jsx(Hw,{className:"h-4 w-4 text-blue-600"}),o.jsxs("span",{className:"text-sm text-blue-800",children:["OTP sent to: ",o.jsx("strong",{children:n})]})]}),o.jsxs("form",{onSubmit:E,className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ml,{htmlFor:"otp",children:"Enter OTP"}),o.jsx(Yr,{id:"otp",type:"text",placeholder:"000000",value:a,onChange:I=>c(I.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,className:"text-center text-lg tracking-widest",disabled:h})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[o.jsxs("span",{children:["Time remaining: ",U(x)]}),S&&o.jsx(ur,{type:"button",variant:"link",size:"sm",onClick:D,disabled:h,className:"p-0 h-auto",children:"Resend OTP"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:t,disabled:h,className:"flex-1",children:"Cancel"}),o.jsx(ur,{type:"submit",disabled:h||a.length!==6,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:h?o.jsxs(o.Fragment,{children:[o.jsx(Nc,{className:"mr-2 h-4 w-4 animate-spin"}),"Verifying..."]}):"Verify OTP"})]})]})]})]})})},VY=G.createContext(null),Yxe=({children:e})=>{const[t,r]=G.useState(null),[n,a]=G.useState(null),[c,h]=G.useState(!1),[i,x]=G.useState(!0),[w,S]=G.useState(!1),T=Ba(),E=G.useRef(!1),D=ae=>ae.exp*1e3<Date.now();G.useEffect(()=>{(()=>{try{const ee=localStorage.getItem("token"),se=localStorage.getItem("userData"),ue=se?JSON.parse(se):null;if(ee)try{const he=$S(ee);if(D(he))localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1);else{if(r(ee),ue&&ue.avatar&&!ue.avatar.startsWith("http")){const Ne="http://localhost:5000/api".replace("/api","");ue.avatar=`${Ne}/${ue.avatar}`}a(ue),h(!0)}}catch{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1)}else r(null),a(null),h(!1)}catch(ee){console.error("Auth initialization error:",ee),r(null),a(null),h(!1)}finally{x(!1)}})()},[]);const U=ae=>{const ee=$S(ae);if(D(ee)){localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1);return}const se={userId:ee.userId,role:ee.role,email:ee.email,firstName:ee.firstName,middleName:ee.middleName,lastName:ee.lastName,avatar:ee.avatar?`${"http://localhost:5000/api".replace("/api","")}/${ee.avatar}`:"",isPasswordChange:ee.isPasswordChange,isOtpVerified:ee.isOtpVerified};localStorage.setItem("token",ae),localStorage.setItem("userData",JSON.stringify(se)),r(ae),a(se),h(!0)},I=ae=>{const ee=$S(ae);if(D(ee)){localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1);return}const se={userId:ee.userId,role:ee.role,email:ee.email,firstName:ee.firstName,middleName:ee.middleName,lastName:ee.lastName,avatar:ee.avatar?`${"http://localhost:5000/api".replace("/api","")}/${ee.avatar}`:"",isPasswordChange:ee.isPasswordChange,isOtpVerified:ee.isOtpVerified};localStorage.setItem("token",ae),localStorage.setItem("userData",JSON.stringify(se)),r(ae),a(se),h(!0)};G.useEffect(()=>{c&&(n!=null&&n.role)&&n.role!=="0"&&n.isOtpVerified===!1?S(!0):S(!1)},[c,n]);const V=ae=>{I(ae),setTimeout(()=>{E.current||(E.current=!0,T("/"),setTimeout(()=>{E.current=!1},100))},100)},H=()=>{S(!1),K()},K=async()=>{try{await mn.post("/auth/logout")}catch(ae){console.error("Logout API call failed:",ae)}finally{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1),E.current||(E.current=!0,T("/login"),setTimeout(()=>{E.current=!1},100))}};if(G.useEffect(()=>{if(c&&t)try{const ee=$S(t).exp*1e3-Date.now();if(ee>0){const se=setTimeout(()=>{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1),E.current||(E.current=!0,T("/login"),setTimeout(()=>{E.current=!1},100))},ee);return()=>clearTimeout(se)}else localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1),E.current||(E.current=!0,T("/login"),setTimeout(()=>{E.current=!1},100))}catch{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1)}},[t]),i)return o.jsx("div",{className:"h-screen flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const Q={token:t,isAuthenticated:c,login:U,logout:K,updateToken:I,userData:n,setUserData:a};return o.jsxs(VY.Provider,{value:Q,children:[e,o.jsx(Zxe,{isOpen:w,onClose:H,onSuccess:V,userEmail:n==null?void 0:n.email})]})},Ei=()=>{const e=G.useContext(VY);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},H1="/assets/lto_logo-DG4ICtLK.png";function Xxe({className:e,...t}){const[r,n]=G.useState(!1),[a,c]=G.useState(!1),[h,i]=G.useState(null),[x,w]=G.useState(!1),{login:S,isAuthenticated:T}=Ei(),E=Ba(),D=()=>{n(!r)},U=ml({resolver:Rl(Jye),defaultValues:{email:localStorage.getItem("rememberedEmail")||"",password:""}});G.useEffect(()=>{const V=localStorage.getItem("rememberedEmail");V&&(w(!0),U.setValue("email",V))},[U]);const I=async V=>{var H,K;try{c(!0),i(null),x?localStorage.setItem("rememberedEmail",V.email):localStorage.removeItem("rememberedEmail");const{data:Q}=await mn.post("/auth/login",V);if(Q){if(c(!1),Q.requiresOTP){Xr.success(`OTP has been sent to ${Q.email}. Please check your email.`),Q.token&&S(Q.token);return}Q.token&&(S(Q.token),E("/"))}}catch(Q){console.error("Login error:",Q),U.clearErrors(),(((K=(H=Q.response)==null?void 0:H.data)==null?void 0:K.message)==="Password is incorrect"?"0":"1")==="0"?U.setError("password",{type:"manual",message:"Password is incorrect"}):U.setError("email",{type:"manual",message:"Email or license number is incorrect"}),c(!1)}};return o.jsx("div",{className:zt("w-full max-w-md",e),...t,children:o.jsx("div",{className:"bg-white text-gray-900 rounded-lg shadow-lg p-8",children:o.jsx(up,{...U,children:o.jsx("form",{onSubmit:V=>{V.preventDefault(),U.handleSubmit(I)(V)},children:o.jsxs("div",{className:"flex flex-col gap-4",children:[o.jsx("div",{className:"flex justify-center mb-3",children:o.jsx("img",{src:H1,alt:"LTO Logo",className:"h-28 w-28"})}),o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"text-4xl font-bold text-[#1e3a8a] mb-1",children:"LTO SYSTEM"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Land Transportation Management System"})]}),o.jsxs("div",{className:"flex flex-col gap-4",children:[o.jsx(an,{control:U.control,name:"email",render:({field:V})=>o.jsxs(nn,{children:[o.jsx(Hr,{children:o.jsxs("div",{className:"relative",children:[o.jsx(fl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),o.jsx(Yr,{...V,type:"text",placeholder:"EMAIL",autoComplete:"current-email",className:zt("pl-10 h-11 border-gray-300 focus:ring-0 focus:border-[#1e3a8a] rounded-md bg-white text-gray-900 placeholder:text-gray-500",U.formState.errors.email&&"border-red-500")})]})}),o.jsx(cn,{})]})}),o.jsx(an,{control:U.control,name:"password",render:({field:V})=>o.jsxs(nn,{children:[o.jsx(Hr,{children:o.jsxs("div",{className:"relative",children:[o.jsx(fR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),o.jsx(Yr,{...V,type:r?"text":"password",placeholder:"PASSWORD",autoComplete:"current-password",className:zt("pl-10 pr-10 h-11 border-gray-300 focus:ring-0 focus:border-[#1e3a8a] rounded-md bg-white text-gray-900 placeholder:text-gray-500",U.formState.errors.password&&"border-red-500")}),o.jsx(ur,{type:"button",size:"icon",variant:"ghost",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-8 w-8 hover:bg-transparent",onClick:D,"aria-label":r?"Hide Password":"Show Password",children:r?o.jsx(FN,{className:"text-gray-400 h-4 w-4"}):o.jsx(DN,{className:"text-gray-400 h-4 w-4"})})]})}),o.jsx(cn,{})]})})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(vZ,{id:"remember",checked:x,onCheckedChange:w,className:"border-gray-300 data-[state=checked]:bg-[#1e3a8a] data-[state=checked]:border-[#1e3a8a]"}),o.jsx("label",{htmlFor:"remember",className:"text-sm text-gray-600",children:"Remember Username"})]}),o.jsx("button",{type:"button",onClick:()=>E("/forgot-password"),className:"text-sm text-[#1e3a8a] hover:underline",children:"Forgot Password"})]}),o.jsx(ur,{type:"submit",disabled:a,className:"w-full h-12 bg-[#1e3a8a] hover:bg-[#1e40af] text-white font-semibold rounded-md",children:a?o.jsx(Nc,{className:"w-5 h-5 text-white mx-auto animate-spin"}):"LOGIN"})]})},"login-form")})})})}const Jxe="/assets/bg_tools-srshAVJ8.jpg",Qxe="/assets/lto_mid_logo_white_small-ea2yHhYW.png",eve=()=>o.jsxs("div",{className:"min-h-screen relative",children:[o.jsx("div",{className:"bg-[#1e3a8a] h-14 md:h-16 flex items-center justify-between px-4 md:px-6 relative z-10",children:o.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[o.jsx("img",{src:"/lto.svg",alt:"LTO Logo",className:"h-6 w-6 md:h-8 md:w-8"}),o.jsx("span",{className:"text-white text-base md:text-lg font-semibold",children:"LTO SYSTEM"})]})}),o.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url(${Jxe})`},children:o.jsx("div",{className:"absolute inset-0 bg-[#1e3a8a]/30"})}),o.jsx("div",{className:"relative z-10 flex items-center justify-center min-h-[calc(100vh-3.5rem)] md:min-h-[calc(100vh-4rem)] p-4 md:p-6",children:o.jsx(Xxe,{})}),o.jsx("div",{className:"absolute bottom-4 right-4 md:bottom-6 md:right-6 z-10",children:o.jsx("img",{src:Qxe,alt:"MID Logo",className:"h-12 w-auto md:h-16 object-contain opacity-70"})})]}),UY=G.createContext({});function tve(e){const t=G.useRef(null);return t.current===null&&(t.current=e()),t.current}const Q4=typeof window<"u",rve=Q4?G.useLayoutEffect:G.useEffect,eL=G.createContext(null),$Y=G.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function nve(e=!0){const t=G.useContext(eL);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:a}=t,c=G.useId();G.useEffect(()=>{if(e)return a(c)},[e]);const h=G.useCallback(()=>e&&n&&n(c),[c,n,e]);return!r&&n?[!1,h]:[!0]}function tL(e,t){e.indexOf(t)===-1&&e.push(t)}function rL(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const Lu=e=>e;let qY=Lu;const ive={useManualTiming:!1};function nL(e){let t;return()=>(t===void 0&&(t=e()),t)}const Mv=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class iL{constructor(){this.subscriptions=[]}add(t){return tL(this.subscriptions,t),()=>rL(this.subscriptions,t)}notify(t,r,n){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,r,n);else for(let c=0;c<a;c++){const h=this.subscriptions[c];h&&h(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const xm=e=>e*1e3,vm=e=>e/1e3;function GY(e,t){return t?e*(1e3/t):0}const ave=nL(()=>window.ScrollTimeline!==void 0);class sve{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,r){for(let n=0;n<this.animations.length;n++)this.animations[n][t]=r}attachTimeline(t,r){const n=this.animations.map(a=>{if(ave()&&a.attachTimeline)return a.attachTimeline(t);if(typeof r=="function")return r(a)});return()=>{n.forEach((a,c)=>{a&&a(),this.animations[c].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let r=0;r<this.animations.length;r++)t=Math.max(t,this.animations[r].duration);return t}runAll(t){this.animations.forEach(r=>r[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class ove extends sve{then(t,r){return Promise.all(this.animations).then(t).catch(r)}}function aL(e,t){return e?e[t]||e.default||e:void 0}const OR=2e4;function WY(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<OR;)t+=r,n=e.next(t);return t>=OR?1/0:t}function sL(e){return typeof e=="function"}function eV(e,t){e.timeline=t,e.onfinish=null}const oL=e=>Array.isArray(e)&&typeof e[0]=="number",lve={linearEasing:void 0};function cve(e,t){const r=nL(e);return()=>{var n;return(n=lve[t])!==null&&n!==void 0?n:r()}}const sA=cve(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),HY=(e,t,r=10)=>{let n="";const a=Math.max(Math.round(t/r),2);for(let c=0;c<a;c++)n+=e(Mv(0,a-1,c))+", ";return`linear(${n.substring(0,n.length-2)})`};function KY(e){return!!(typeof e=="function"&&sA()||!e||typeof e=="string"&&(e in RR||sA())||oL(e)||Array.isArray(e)&&e.every(KY))}const n1=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,RR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:n1([0,.65,.55,1]),circOut:n1([.55,0,1,.45]),backIn:n1([.31,.01,.66,-.59]),backOut:n1([.33,1.53,.69,.99])};function ZY(e,t){if(e)return typeof e=="function"&&sA()?HY(e,t):oL(e)?n1(e):Array.isArray(e)?e.map(r=>ZY(r,t)||RR.easeOut):RR[e]}const qS=["read","resolveKeyframes","update","preRender","render","postRender"],tV={value:null};function uve(e,t){let r=new Set,n=new Set,a=!1,c=!1;const h=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1},x=0;function w(T){h.has(T)&&(S.schedule(T),e()),x++,T(i)}const S={schedule:(T,E=!1,D=!1)=>{const I=D&&a?r:n;return E&&h.add(T),I.has(T)||I.add(T),T},cancel:T=>{n.delete(T),h.delete(T)},process:T=>{if(i=T,a){c=!0;return}a=!0,[r,n]=[n,r],r.forEach(w),t&&tV.value&&tV.value.frameloop[t].push(x),x=0,r.clear(),a=!1,c&&(c=!1,S.process(T))}};return S}const dve=40;function YY(e,t){let r=!1,n=!0;const a={delta:0,timestamp:0,isProcessing:!1},c=()=>r=!0,h=qS.reduce((H,K)=>(H[K]=uve(c,t?K:void 0),H),{}),{read:i,resolveKeyframes:x,update:w,preRender:S,render:T,postRender:E}=h,D=()=>{const H=performance.now();r=!1,a.delta=n?1e3/60:Math.max(Math.min(H-a.timestamp,dve),1),a.timestamp=H,a.isProcessing=!0,i.process(a),x.process(a),w.process(a),S.process(a),T.process(a),E.process(a),a.isProcessing=!1,r&&t&&(n=!1,e(D))},U=()=>{r=!0,n=!0,a.isProcessing||e(D)};return{schedule:qS.reduce((H,K)=>{const Q=h[K];return H[K]=(ae,ee=!1,se=!1)=>(r||U(),Q.schedule(ae,ee,se)),H},{}),cancel:H=>{for(let K=0;K<qS.length;K++)h[qS[K]].cancel(H)},state:a,steps:h}}const{schedule:is,cancel:sy,state:El,steps:TP}=YY(typeof requestAnimationFrame<"u"?requestAnimationFrame:Lu,!0),{schedule:lL}=YY(queueMicrotask,!1);let jN;function hve(){jN=void 0}const ep={now:()=>(jN===void 0&&ep.set(El.isProcessing||ive.useManualTiming?El.timestamp:performance.now()),jN),set:e=>{jN=e,queueMicrotask(hve)}},Lh={x:!1,y:!1};function XY(){return Lh.x||Lh.y}function fve(e){return e==="x"||e==="y"?Lh[e]?null:(Lh[e]=!0,()=>{Lh[e]=!1}):Lh.x||Lh.y?null:(Lh.x=Lh.y=!0,()=>{Lh.x=Lh.y=!1})}function pve(e,t,r){var n;if(e instanceof EventTarget)return[e];if(typeof e=="string"){let a=document;const c=(n=void 0)!==null&&n!==void 0?n:a.querySelectorAll(e);return c?Array.from(c):[]}return Array.from(e)}function JY(e,t){const r=pve(e),n=new AbortController,a={passive:!0,...t,signal:n.signal};return[r,a,()=>n.abort()]}function rV(e){return!(e.pointerType==="touch"||XY())}function mve(e,t,r={}){const[n,a,c]=JY(e,r),h=i=>{if(!rV(i))return;const{target:x}=i,w=t(x,i);if(typeof w!="function"||!x)return;const S=T=>{rV(T)&&(w(T),x.removeEventListener("pointerleave",S))};x.addEventListener("pointerleave",S,a)};return n.forEach(i=>{i.addEventListener("pointerenter",h,a)}),c}function nV(e,t){const r=`${t}PointerCapture`;if(e.target instanceof Element&&r in e.target&&e.pointerId!==void 0)try{e.target[r](e.pointerId)}catch{}}const QY=(e,t)=>t?e===t?!0:QY(e,t.parentElement):!1,cL=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,gve=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function yve(e){return gve.has(e.tagName)||e.tabIndex!==-1}const i1=new WeakSet;function iV(e){return t=>{t.key==="Enter"&&e(t)}}function jP(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const xve=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=iV(()=>{if(i1.has(r))return;jP(r,"down");const a=iV(()=>{jP(r,"up")}),c=()=>jP(r,"cancel");r.addEventListener("keyup",a,t),r.addEventListener("blur",c,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function aV(e){return cL(e)&&!XY()}function vve(e,t,r={}){const[n,a,c]=JY(e,r),h=i=>{const x=i.currentTarget;if(!x||!aV(i)||i1.has(x))return;i1.add(x),nV(i,"set");const w=t(x,i),S=(D,U)=>{x.removeEventListener("pointerup",T),x.removeEventListener("pointercancel",E),nV(D,"release"),!(!aV(D)||!i1.has(x))&&(i1.delete(x),typeof w=="function"&&w(D,{success:U}))},T=D=>{(D.isTrusted?_ve(D,x instanceof Element?x.getBoundingClientRect():{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight}):!1)?S(D,!1):S(D,!(x instanceof Element)||QY(x,D.target))},E=D=>{S(D,!1)};x.addEventListener("pointerup",T,a),x.addEventListener("pointercancel",E,a),x.addEventListener("lostpointercapture",E,a)};return n.forEach(i=>{i=r.useGlobalTarget?window:i;let x=!1;i instanceof HTMLElement&&(x=!0,!yve(i)&&i.getAttribute("tabindex")===null&&(i.tabIndex=0)),i.addEventListener("pointerdown",h,a),x&&i.addEventListener("focus",w=>xve(w,a),a)}),c}function _ve(e,t){return e.clientX<t.left||e.clientX>t.right||e.clientY<t.top||e.clientY>t.bottom}const sV=30,bve=e=>!isNaN(parseFloat(e));class wve{constructor(t,r={}){this.version="12.5.0",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,a=!0)=>{const c=ep.now();this.updatedAt!==c&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),a&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=ep.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=bve(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new iL);const n=this.events[t].add(r);return t==="change"?()=>{n(),is.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=ep.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>sV)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,sV);return GY(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function K1(e,t){return new wve(e,t)}const eX=G.createContext({strict:!1}),oV={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ov={};for(const e in oV)Ov[e]={isEnabled:t=>oV[e].some(r=>!!t[r])};function Sve(e){for(const t in e)Ov[t]={...Ov[t],...e[t]}}const Nve=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function oA(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Nve.has(e)}let tX=e=>!oA(e);function Ave(e){e&&(tX=t=>t.startsWith("on")?!oA(t):e(t))}try{Ave(require("@emotion/is-prop-valid").default)}catch{}function Tve(e,t,r){const n={};for(const a in e)a==="values"&&typeof e.values=="object"||(tX(a)||r===!0&&oA(a)||!t&&!oA(a)||e.draggable&&a.startsWith("onDrag"))&&(n[a]=e[a]);return n}function jve(e){if(typeof Proxy>"u")return e;const t=new Map,r=(...n)=>e(...n);return new Proxy(r,{get:(n,a)=>a==="create"?e:(t.has(a)||t.set(a,e(a)),t.get(a))})}const YT=G.createContext({});function XT(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Z1(e){return typeof e=="string"||Array.isArray(e)}const uL=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],dL=["initial",...uL];function JT(e){return XT(e.animate)||dL.some(t=>Z1(e[t]))}function rX(e){return!!(JT(e)||e.variants)}function kve(e,t){if(JT(e)){const{initial:r,animate:n}=e;return{initial:r===!1||Z1(r)?r:void 0,animate:Z1(n)?n:void 0}}return e.inherit!==!1?t:{}}function Pve(e){const{initial:t,animate:r}=kve(e,G.useContext(YT));return G.useMemo(()=>({initial:t,animate:r}),[lV(t),lV(r)])}function lV(e){return Array.isArray(e)?e.join(" "):e}const Cve=Symbol.for("motionComponentSymbol");function cv(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Eve(e,t,r){return G.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):cv(r)&&(r.current=n))},[t])}const hL=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Mve="framerAppearId",nX="data-"+hL(Mve),iX=G.createContext({});function Ove(e,t,r,n,a){var c,h;const{visualElement:i}=G.useContext(YT),x=G.useContext(eX),w=G.useContext(eL),S=G.useContext($Y).reducedMotion,T=G.useRef(null);n=n||x.renderer,!T.current&&n&&(T.current=n(e,{visualState:t,parent:i,props:r,presenceContext:w,blockInitialAnimation:w?w.initial===!1:!1,reducedMotionConfig:S}));const E=T.current,D=G.useContext(iX);E&&!E.projection&&a&&(E.type==="html"||E.type==="svg")&&Rve(T.current,r,a,D);const U=G.useRef(!1);G.useInsertionEffect(()=>{E&&U.current&&E.update(r,w)});const I=r[nX],V=G.useRef(!!I&&!(!((c=window.MotionHandoffIsComplete)===null||c===void 0)&&c.call(window,I))&&((h=window.MotionHasOptimisedAnimation)===null||h===void 0?void 0:h.call(window,I)));return rve(()=>{E&&(U.current=!0,window.MotionIsMounted=!0,E.updateFeatures(),lL.render(E.render),V.current&&E.animationState&&E.animationState.animateChanges())}),G.useEffect(()=>{E&&(!V.current&&E.animationState&&E.animationState.animateChanges(),V.current&&(queueMicrotask(()=>{var H;(H=window.MotionHandoffMarkAsComplete)===null||H===void 0||H.call(window,I)}),V.current=!1))}),E}function Rve(e,t,r,n){const{layoutId:a,layout:c,drag:h,dragConstraints:i,layoutScroll:x,layoutRoot:w}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:aX(e.parent)),e.projection.setOptions({layoutId:a,layout:c,alwaysMeasureLayout:!!h||i&&cv(i),visualElement:e,animationType:typeof c=="string"?c:"both",initialPromotionConfig:n,layoutScroll:x,layoutRoot:w})}function aX(e){if(e)return e.options.allowProjection!==!1?e.projection:aX(e.parent)}function Ive({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:a}){var c,h;e&&Sve(e);function i(w,S){let T;const E={...G.useContext($Y),...w,layoutId:Lve(w)},{isStatic:D}=E,U=Pve(w),I=n(w,D);if(!D&&Q4){Dve();const V=Fve(E);T=V.MeasureLayout,U.visualElement=Ove(a,I,E,t,V.ProjectionNode)}return o.jsxs(YT.Provider,{value:U,children:[T&&U.visualElement?o.jsx(T,{visualElement:U.visualElement,...E}):null,r(a,w,Eve(I,U.visualElement,S),I,D,U.visualElement)]})}i.displayName=`motion.${typeof a=="string"?a:`create(${(h=(c=a.displayName)!==null&&c!==void 0?c:a.name)!==null&&h!==void 0?h:""})`}`;const x=G.forwardRef(i);return x[Cve]=a,x}function Lve({layoutId:e}){const t=G.useContext(UY).id;return t&&e!==void 0?t+"-"+e:e}function Dve(e,t){G.useContext(eX).strict}function Fve(e){const{drag:t,layout:r}=Ov;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const sX=e=>t=>typeof t=="string"&&t.startsWith(e),fL=sX("--"),zve=sX("var(--"),pL=e=>zve(e)?Bve.test(e.split("/*")[0].trim()):!1,Bve=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Y1={};function Vve(e){for(const t in e)Y1[t]=e[t],fL(t)&&(Y1[t].isCSSVariable=!0)}const j_=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],tx=new Set(j_);function oX(e,{layout:t,layoutId:r}){return tx.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Y1[e]||e==="opacity")}const tc=e=>!!(e&&e.getVelocity),lX=(e,t)=>t&&typeof e=="number"?t.transform(e):e,jm=(e,t,r)=>r>t?t:r<e?e:r,k_={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},X1={...k_,transform:e=>jm(0,1,e)},GS={...k_,default:1},d2=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Fg=d2("deg"),tp=d2("%"),ti=d2("px"),Uve=d2("vh"),$ve=d2("vw"),cV={...tp,parse:e=>tp.parse(e)/100,transform:e=>tp.transform(e*100)},qve={borderWidth:ti,borderTopWidth:ti,borderRightWidth:ti,borderBottomWidth:ti,borderLeftWidth:ti,borderRadius:ti,radius:ti,borderTopLeftRadius:ti,borderTopRightRadius:ti,borderBottomRightRadius:ti,borderBottomLeftRadius:ti,width:ti,maxWidth:ti,height:ti,maxHeight:ti,top:ti,right:ti,bottom:ti,left:ti,padding:ti,paddingTop:ti,paddingRight:ti,paddingBottom:ti,paddingLeft:ti,margin:ti,marginTop:ti,marginRight:ti,marginBottom:ti,marginLeft:ti,backgroundPositionX:ti,backgroundPositionY:ti},Gve={rotate:Fg,rotateX:Fg,rotateY:Fg,rotateZ:Fg,scale:GS,scaleX:GS,scaleY:GS,scaleZ:GS,skew:Fg,skewX:Fg,skewY:Fg,distance:ti,translateX:ti,translateY:ti,translateZ:ti,x:ti,y:ti,z:ti,perspective:ti,transformPerspective:ti,opacity:X1,originX:cV,originY:cV,originZ:ti},uV={...k_,transform:Math.round},mL={...qve,...Gve,zIndex:uV,size:ti,fillOpacity:X1,strokeOpacity:X1,numOctaves:uV},Wve={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Hve=j_.length;function Kve(e,t,r){let n="",a=!0;for(let c=0;c<Hve;c++){const h=j_[c],i=e[h];if(i===void 0)continue;let x=!0;if(typeof i=="number"?x=i===(h.startsWith("scale")?1:0):x=parseFloat(i)===0,!x||r){const w=lX(i,mL[h]);if(!x){a=!1;const S=Wve[h]||h;n+=`${S}(${w}) `}r&&(t[h]=w)}}return n=n.trim(),r?n=r(t,a?"":n):a&&(n="none"),n}function gL(e,t,r){const{style:n,vars:a,transformOrigin:c}=e;let h=!1,i=!1;for(const x in t){const w=t[x];if(tx.has(x)){h=!0;continue}else if(fL(x)){a[x]=w;continue}else{const S=lX(w,mL[x]);x.startsWith("origin")?(i=!0,c[x]=S):n[x]=S}}if(t.transform||(h||r?n.transform=Kve(t,e.transform,r):n.transform&&(n.transform="none")),i){const{originX:x="50%",originY:w="50%",originZ:S=0}=c;n.transformOrigin=`${x} ${w} ${S}`}}const yL=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function cX(e,t,r){for(const n in t)!tc(t[n])&&!oX(n,r)&&(e[n]=t[n])}function Zve({transformTemplate:e},t){return G.useMemo(()=>{const r=yL();return gL(r,t,e),Object.assign({},r.vars,r.style)},[t])}function Yve(e,t){const r=e.style||{},n={};return cX(n,r,e),Object.assign(n,Zve(e,t)),n}function Xve(e,t){const r={},n=Yve(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const Jve=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function xL(e){return typeof e!="string"||e.includes("-")?!1:!!(Jve.indexOf(e)>-1||/[A-Z]/u.test(e))}const Qve={offset:"stroke-dashoffset",array:"stroke-dasharray"},e_e={offset:"strokeDashoffset",array:"strokeDasharray"};function t_e(e,t,r=1,n=0,a=!0){e.pathLength=1;const c=a?Qve:e_e;e[c.offset]=ti.transform(-n);const h=ti.transform(t),i=ti.transform(r);e[c.array]=`${h} ${i}`}function dV(e,t,r){return typeof e=="string"?e:ti.transform(t+r*e)}function r_e(e,t,r){const n=dV(t,e.x,e.width),a=dV(r,e.y,e.height);return`${n} ${a}`}function vL(e,{attrX:t,attrY:r,attrScale:n,originX:a,originY:c,pathLength:h,pathSpacing:i=1,pathOffset:x=0,...w},S,T){if(gL(e,w,T),S){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:E,style:D,dimensions:U}=e;E.transform&&(U&&(D.transform=E.transform),delete E.transform),U&&(a!==void 0||c!==void 0||D.transform)&&(D.transformOrigin=r_e(U,a!==void 0?a:.5,c!==void 0?c:.5)),t!==void 0&&(E.x=t),r!==void 0&&(E.y=r),n!==void 0&&(E.scale=n),h!==void 0&&t_e(E,h,i,x,!1)}const uX=()=>({...yL(),attrs:{}}),_L=e=>typeof e=="string"&&e.toLowerCase()==="svg";function n_e(e,t,r,n){const a=G.useMemo(()=>{const c=uX();return vL(c,t,_L(n),e.transformTemplate),{...c.attrs,style:{...c.style}}},[t]);if(e.style){const c={};cX(c,e.style,e),a.style={...c,...a.style}}return a}function i_e(e=!1){return(r,n,a,{latestValues:c},h)=>{const x=(xL(r)?n_e:Xve)(n,c,h,r),w=Tve(n,typeof r=="string",e),S=r!==G.Fragment?{...w,...x,ref:a}:{},{children:T}=n,E=G.useMemo(()=>tc(T)?T.get():T,[T]);return G.createElement(r,{...S,children:E})}}function hV(e){const t=[{},{}];return e==null||e.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function bL(e,t,r,n){if(typeof t=="function"){const[a,c]=hV(n);t=t(r!==void 0?r:e.custom,a,c)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[a,c]=hV(n);t=t(r!==void 0?r:e.custom,a,c)}return t}const IR=e=>Array.isArray(e),a_e=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),s_e=e=>IR(e)?e[e.length-1]||0:e;function kN(e){const t=tc(e)?e.get():e;return a_e(t)?t.toValue():t}function o_e({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:r},n,a,c){const h={latestValues:l_e(n,a,c,e),renderState:t()};return r&&(h.onMount=i=>r({props:n,current:i,...h}),h.onUpdate=i=>r(i)),h}const dX=e=>(t,r)=>{const n=G.useContext(YT),a=G.useContext(eL),c=()=>o_e(e,t,n,a);return r?c():tve(c)};function l_e(e,t,r,n){const a={},c=n(e,{});for(const E in c)a[E]=kN(c[E]);let{initial:h,animate:i}=e;const x=JT(e),w=rX(e);t&&w&&!x&&e.inherit!==!1&&(h===void 0&&(h=t.initial),i===void 0&&(i=t.animate));let S=r?r.initial===!1:!1;S=S||h===!1;const T=S?i:h;if(T&&typeof T!="boolean"&&!XT(T)){const E=Array.isArray(T)?T:[T];for(let D=0;D<E.length;D++){const U=bL(e,E[D]);if(U){const{transitionEnd:I,transition:V,...H}=U;for(const K in H){let Q=H[K];if(Array.isArray(Q)){const ae=S?Q.length-1:0;Q=Q[ae]}Q!==null&&(a[K]=Q)}for(const K in I)a[K]=I[K]}}}return a}function wL(e,t,r){var n;const{style:a}=e,c={};for(const h in a)(tc(a[h])||t.style&&tc(t.style[h])||oX(h,e)||((n=r==null?void 0:r.getValue(h))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(c[h]=a[h]);return c}const c_e={useVisualState:dX({scrapeMotionValuesFromProps:wL,createRenderState:yL})};function hX(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}function fX(e,{style:t,vars:r},n,a){Object.assign(e.style,t,a&&a.getProjectionStyles(n));for(const c in r)e.style.setProperty(c,r[c])}const pX=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function mX(e,t,r,n){fX(e,t,void 0,n);for(const a in t.attrs)e.setAttribute(pX.has(a)?a:hL(a),t.attrs[a])}function gX(e,t,r){const n=wL(e,t,r);for(const a in e)if(tc(e[a])||tc(t[a])){const c=j_.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;n[c]=e[a]}return n}const fV=["x","y","width","height","cx","cy","r"],u_e={useVisualState:dX({scrapeMotionValuesFromProps:gX,createRenderState:uX,onUpdate:({props:e,prevProps:t,current:r,renderState:n,latestValues:a})=>{if(!r)return;let c=!!e.drag;if(!c){for(const i in a)if(tx.has(i)){c=!0;break}}if(!c)return;let h=!t;if(t)for(let i=0;i<fV.length;i++){const x=fV[i];e[x]!==t[x]&&(h=!0)}h&&is.read(()=>{hX(r,n),is.render(()=>{vL(n,a,_L(r.tagName),e.transformTemplate),mX(r,n)})})}})};function d_e(e,t){return function(n,{forwardMotionProps:a}={forwardMotionProps:!1}){const h={...xL(n)?u_e:c_e,preloadedFeatures:e,useRender:i_e(a),createVisualElement:t,Component:n};return Ive(h)}}function J1(e,t,r){const n=e.getProps();return bL(n,t,r!==void 0?r:n.custom,e)}const yX=new Set(["width","height","top","left","right","bottom",...j_]);function h_e(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,K1(r))}function f_e(e,t){const r=J1(e,t);let{transitionEnd:n={},transition:a={},...c}=r||{};c={...c,...n};for(const h in c){const i=s_e(c[h]);h_e(e,h,i)}}function p_e(e){return!!(tc(e)&&e.add)}function LR(e,t){const r=e.getValue("willChange");if(p_e(r))return r.add(t)}function xX(e){return e.props[nX]}const vX=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,m_e=1e-7,g_e=12;function y_e(e,t,r,n,a){let c,h,i=0;do h=t+(r-t)/2,c=vX(h,n,a)-e,c>0?r=h:t=h;while(Math.abs(c)>m_e&&++i<g_e);return h}function h2(e,t,r,n){if(e===t&&r===n)return Lu;const a=c=>y_e(c,0,1,e,r);return c=>c===0||c===1?c:vX(a(c),t,n)}const _X=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,bX=e=>t=>1-e(1-t),wX=h2(.33,1.53,.69,.99),SL=bX(wX),SX=_X(SL),NX=e=>(e*=2)<1?.5*SL(e):.5*(2-Math.pow(2,-10*(e-1))),NL=e=>1-Math.sin(Math.acos(e)),AX=bX(NL),TX=_X(NL),jX=e=>/^0[^.\s]+$/u.test(e);function x_e(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||jX(e):!0}const h1=e=>Math.round(e*1e5)/1e5,AL=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function v_e(e){return e==null}const __e=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,TL=(e,t)=>r=>!!(typeof r=="string"&&__e.test(r)&&r.startsWith(e)||t&&!v_e(r)&&Object.prototype.hasOwnProperty.call(r,t)),kX=(e,t,r)=>n=>{if(typeof n!="string")return n;const[a,c,h,i]=n.match(AL);return{[e]:parseFloat(a),[t]:parseFloat(c),[r]:parseFloat(h),alpha:i!==void 0?parseFloat(i):1}},b_e=e=>jm(0,255,e),kP={...k_,transform:e=>Math.round(b_e(e))},A0={test:TL("rgb","red"),parse:kX("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+kP.transform(e)+", "+kP.transform(t)+", "+kP.transform(r)+", "+h1(X1.transform(n))+")"};function w_e(e){let t="",r="",n="",a="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),a=e.substring(4,5),t+=t,r+=r,n+=n,a+=a),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:a?parseInt(a,16)/255:1}}const DR={test:TL("#"),parse:w_e,transform:A0.transform},uv={test:TL("hsl","hue"),parse:kX("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+tp.transform(h1(t))+", "+tp.transform(h1(r))+", "+h1(X1.transform(n))+")"},Xl={test:e=>A0.test(e)||DR.test(e)||uv.test(e),parse:e=>A0.test(e)?A0.parse(e):uv.test(e)?uv.parse(e):DR.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?A0.transform(e):uv.transform(e)},S_e=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function N_e(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(AL))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(S_e))===null||r===void 0?void 0:r.length)||0)>0}const PX="number",CX="color",A_e="var",T_e="var(",pV="${}",j_e=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Q1(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},a=[];let c=0;const i=t.replace(j_e,x=>(Xl.test(x)?(n.color.push(c),a.push(CX),r.push(Xl.parse(x))):x.startsWith(T_e)?(n.var.push(c),a.push(A_e),r.push(x)):(n.number.push(c),a.push(PX),r.push(parseFloat(x))),++c,pV)).split(pV);return{values:r,split:i,indexes:n,types:a}}function EX(e){return Q1(e).values}function MX(e){const{split:t,types:r}=Q1(e),n=t.length;return a=>{let c="";for(let h=0;h<n;h++)if(c+=t[h],a[h]!==void 0){const i=r[h];i===PX?c+=h1(a[h]):i===CX?c+=Xl.transform(a[h]):c+=a[h]}return c}}const k_e=e=>typeof e=="number"?0:e;function P_e(e){const t=EX(e);return MX(e)(t.map(k_e))}const oy={test:N_e,parse:EX,createTransformer:MX,getAnimatableNone:P_e},C_e=new Set(["brightness","contrast","saturate","opacity"]);function E_e(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(AL)||[];if(!n)return e;const a=r.replace(n,"");let c=C_e.has(t)?1:0;return n!==r&&(c*=100),t+"("+c+a+")"}const M_e=/\b([a-z-]*)\(.*?\)/gu,FR={...oy,getAnimatableNone:e=>{const t=e.match(M_e);return t?t.map(E_e).join(" "):e}},O_e={...mL,color:Xl,backgroundColor:Xl,outlineColor:Xl,fill:Xl,stroke:Xl,borderColor:Xl,borderTopColor:Xl,borderRightColor:Xl,borderBottomColor:Xl,borderLeftColor:Xl,filter:FR,WebkitFilter:FR},OX=e=>O_e[e];function RX(e,t){let r=OX(e);return r!==FR&&(r=oy),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const R_e=new Set(["auto","none","0"]);function I_e(e,t,r){let n=0,a;for(;n<e.length&&!a;){const c=e[n];typeof c=="string"&&!R_e.has(c)&&Q1(c).values.length&&(a=e[n]),n++}if(a&&r)for(const c of t)e[c]=RX(r,a)}const T0=e=>e*180/Math.PI,zR=e=>{const t=T0(Math.atan2(e[1],e[0]));return BR(t)},L_e={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:zR,rotateZ:zR,skewX:e=>T0(Math.atan(e[1])),skewY:e=>T0(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},BR=e=>(e=e%360,e<0&&(e+=360),e),mV=zR,gV=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),yV=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),D_e={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:gV,scaleY:yV,scale:e=>(gV(e)+yV(e))/2,rotateX:e=>BR(T0(Math.atan2(e[6],e[5]))),rotateY:e=>BR(T0(Math.atan2(-e[2],e[0]))),rotateZ:mV,rotate:mV,skewX:e=>T0(Math.atan(e[4])),skewY:e=>T0(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function xV(e){return e.includes("scale")?1:0}function VR(e,t){if(!e||e==="none")return xV(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,a;if(r)n=D_e,a=r;else{const i=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=L_e,a=i}if(!a)return xV(t);const c=n[t],h=a[1].split(",").map(z_e);return typeof c=="function"?c(h):h[c]}const F_e=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return VR(r,t)};function z_e(e){return parseFloat(e.trim())}const vV=e=>e===k_||e===ti,B_e=new Set(["x","y","z"]),V_e=j_.filter(e=>!B_e.has(e));function U_e(e){const t=[];return V_e.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const Rv={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>VR(t,"x"),y:(e,{transform:t})=>VR(t,"y")};Rv.translateX=Rv.x;Rv.translateY=Rv.y;const R0=new Set;let UR=!1,$R=!1;function IX(){if($R){const e=Array.from(R0).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const a=U_e(n);a.length&&(r.set(n,a),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const a=r.get(n);a&&a.forEach(([c,h])=>{var i;(i=n.getValue(c))===null||i===void 0||i.set(h)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}$R=!1,UR=!1,R0.forEach(e=>e.complete()),R0.clear()}function LX(){R0.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&($R=!0)})}function $_e(){LX(),IX()}class jL{constructor(t,r,n,a,c,h=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=a,this.element=c,this.isAsync=h}scheduleResolve(){this.isScheduled=!0,this.isAsync?(R0.add(this),UR||(UR=!0,is.read(LX),is.resolveKeyframes(IX))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:a}=this;for(let c=0;c<t.length;c++)if(t[c]===null)if(c===0){const h=a==null?void 0:a.get(),i=t[t.length-1];if(h!==void 0)t[0]=h;else if(n&&r){const x=n.readValue(r,i);x!=null&&(t[0]=x)}t[0]===void 0&&(t[0]=i),a&&h===void 0&&a.set(t[0])}else t[c]=t[c-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),R0.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,R0.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const DX=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),q_e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function G_e(e){const t=q_e.exec(e);if(!t)return[,];const[,r,n,a]=t;return[`--${r??n}`,a]}function FX(e,t,r=1){const[n,a]=G_e(e);if(!n)return;const c=window.getComputedStyle(t).getPropertyValue(n);if(c){const h=c.trim();return DX(h)?parseFloat(h):h}return pL(a)?FX(a,t,r+1):a}const zX=e=>t=>t.test(e),W_e={test:e=>e==="auto",parse:e=>e},BX=[k_,ti,tp,Fg,$ve,Uve,W_e],_V=e=>BX.find(zX(e));class VX extends jL{constructor(t,r,n,a,c){super(t,r,n,a,c,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let x=0;x<t.length;x++){let w=t[x];if(typeof w=="string"&&(w=w.trim(),pL(w))){const S=FX(w,r.current);S!==void 0&&(t[x]=S),x===t.length-1&&(this.finalKeyframe=w)}}if(this.resolveNoneKeyframes(),!yX.has(n)||t.length!==2)return;const[a,c]=t,h=_V(a),i=_V(c);if(h!==i)if(vV(h)&&vV(i))for(let x=0;x<t.length;x++){const w=t[x];typeof w=="string"&&(t[x]=parseFloat(w))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let a=0;a<t.length;a++)x_e(t[a])&&n.push(a);n.length&&I_e(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Rv[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const a=r[r.length-1];a!==void 0&&t.getValue(n,a).jump(a,!1)}measureEndState(){var t;const{element:r,name:n,unresolvedKeyframes:a}=this;if(!r||!r.current)return;const c=r.getValue(n);c&&c.jump(this.measuredOrigin,!1);const h=a.length-1,i=a[h];a[h]=Rv[n](r.measureViewportBox(),window.getComputedStyle(r.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([x,w])=>{r.getValue(x).set(w)}),this.resolveNoneKeyframes()}}const bV=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(oy.test(e)||e==="0")&&!e.startsWith("url("));function H_e(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function K_e(e,t,r,n){const a=e[0];if(a===null)return!1;if(t==="display"||t==="visibility")return!0;const c=e[e.length-1],h=bV(a,t),i=bV(c,t);return!h||!i?!1:H_e(e)||(r==="spring"||sL(r))&&n}const Z_e=e=>e!==null;function QT(e,{repeat:t,repeatType:r="loop"},n){const a=e.filter(Z_e),c=t&&r!=="loop"&&t%2===1?0:a.length-1;return!c||n===void 0?a[c]:n}const Y_e=40;class UX{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:a=0,repeatDelay:c=0,repeatType:h="loop",...i}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ep.now(),this.options={autoplay:t,delay:r,type:n,repeat:a,repeatDelay:c,repeatType:h,...i},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Y_e?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&$_e(),this._resolved}onKeyframesResolved(t,r){this.resolvedAt=ep.now(),this.hasAttemptedResolve=!0;const{name:n,type:a,velocity:c,delay:h,onComplete:i,onUpdate:x,isGenerator:w}=this.options;if(!w&&!K_e(t,n,a,c))if(h)this.options.duration=0;else{x&&x(QT(t,this.options,r)),i&&i(),this.resolveFinishedPromise();return}const S=this.initPlayback(t,r);S!==!1&&(this._resolved={keyframes:t,finalKeyframe:r,...S},this.onPostResolved())}onPostResolved(){}then(t,r){return this.currentFinishedPromise.then(t,r)}flatten(){this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear")}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const Bs=(e,t,r)=>e+(t-e)*r;function PP(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function X_e({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let a=0,c=0,h=0;if(!t)a=c=h=r;else{const i=r<.5?r*(1+t):r+t-r*t,x=2*r-i;a=PP(x,i,e+1/3),c=PP(x,i,e),h=PP(x,i,e-1/3)}return{red:Math.round(a*255),green:Math.round(c*255),blue:Math.round(h*255),alpha:n}}function lA(e,t){return r=>r>0?t:e}const CP=(e,t,r)=>{const n=e*e,a=r*(t*t-n)+n;return a<0?0:Math.sqrt(a)},J_e=[DR,A0,uv],Q_e=e=>J_e.find(t=>t.test(e));function wV(e){const t=Q_e(e);if(!t)return!1;let r=t.parse(e);return t===uv&&(r=X_e(r)),r}const SV=(e,t)=>{const r=wV(e),n=wV(t);if(!r||!n)return lA(e,t);const a={...r};return c=>(a.red=CP(r.red,n.red,c),a.green=CP(r.green,n.green,c),a.blue=CP(r.blue,n.blue,c),a.alpha=Bs(r.alpha,n.alpha,c),A0.transform(a))},ebe=(e,t)=>r=>t(e(r)),f2=(...e)=>e.reduce(ebe),qR=new Set(["none","hidden"]);function tbe(e,t){return qR.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function rbe(e,t){return r=>Bs(e,t,r)}function kL(e){return typeof e=="number"?rbe:typeof e=="string"?pL(e)?lA:Xl.test(e)?SV:abe:Array.isArray(e)?$X:typeof e=="object"?Xl.test(e)?SV:nbe:lA}function $X(e,t){const r=[...e],n=r.length,a=e.map((c,h)=>kL(c)(c,t[h]));return c=>{for(let h=0;h<n;h++)r[h]=a[h](c);return r}}function nbe(e,t){const r={...e,...t},n={};for(const a in r)e[a]!==void 0&&t[a]!==void 0&&(n[a]=kL(e[a])(e[a],t[a]));return a=>{for(const c in n)r[c]=n[c](a);return r}}function ibe(e,t){var r;const n=[],a={color:0,var:0,number:0};for(let c=0;c<t.values.length;c++){const h=t.types[c],i=e.indexes[h][a[h]],x=(r=e.values[i])!==null&&r!==void 0?r:0;n[c]=x,a[h]++}return n}const abe=(e,t)=>{const r=oy.createTransformer(t),n=Q1(e),a=Q1(t);return n.indexes.var.length===a.indexes.var.length&&n.indexes.color.length===a.indexes.color.length&&n.indexes.number.length>=a.indexes.number.length?qR.has(e)&&!a.values.length||qR.has(t)&&!n.values.length?tbe(e,t):f2($X(ibe(n,a),a.values),r):lA(e,t)};function qX(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?Bs(e,t,r):kL(e)(e,t)}const sbe=5;function GX(e,t,r){const n=Math.max(t-sbe,0);return GY(r-e(n),t-n)}const Zs={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},NV=.001;function obe({duration:e=Zs.duration,bounce:t=Zs.bounce,velocity:r=Zs.velocity,mass:n=Zs.mass}){let a,c,h=1-t;h=jm(Zs.minDamping,Zs.maxDamping,h),e=jm(Zs.minDuration,Zs.maxDuration,vm(e)),h<1?(a=w=>{const S=w*h,T=S*e,E=S-r,D=GR(w,h),U=Math.exp(-T);return NV-E/D*U},c=w=>{const T=w*h*e,E=T*r+r,D=Math.pow(h,2)*Math.pow(w,2)*e,U=Math.exp(-T),I=GR(Math.pow(w,2),h);return(-a(w)+NV>0?-1:1)*((E-D)*U)/I}):(a=w=>{const S=Math.exp(-w*e),T=(w-r)*e+1;return-.001+S*T},c=w=>{const S=Math.exp(-w*e),T=(r-w)*(e*e);return S*T});const i=5/e,x=cbe(a,c,i);if(e=xm(e),isNaN(x))return{stiffness:Zs.stiffness,damping:Zs.damping,duration:e};{const w=Math.pow(x,2)*n;return{stiffness:w,damping:h*2*Math.sqrt(n*w),duration:e}}}const lbe=12;function cbe(e,t,r){let n=r;for(let a=1;a<lbe;a++)n=n-e(n)/t(n);return n}function GR(e,t){return e*Math.sqrt(1-t*t)}const ube=["duration","bounce"],dbe=["stiffness","damping","mass"];function AV(e,t){return t.some(r=>e[r]!==void 0)}function hbe(e){let t={velocity:Zs.velocity,stiffness:Zs.stiffness,damping:Zs.damping,mass:Zs.mass,isResolvedFromDuration:!1,...e};if(!AV(e,dbe)&&AV(e,ube))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),a=n*n,c=2*jm(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:Zs.mass,stiffness:a,damping:c}}else{const r=obe(e);t={...t,...r,mass:Zs.mass},t.isResolvedFromDuration=!0}return t}function WX(e=Zs.visualDuration,t=Zs.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:a}=r;const c=r.keyframes[0],h=r.keyframes[r.keyframes.length-1],i={done:!1,value:c},{stiffness:x,damping:w,mass:S,duration:T,velocity:E,isResolvedFromDuration:D}=hbe({...r,velocity:-vm(r.velocity||0)}),U=E||0,I=w/(2*Math.sqrt(x*S)),V=h-c,H=vm(Math.sqrt(x/S)),K=Math.abs(V)<5;n||(n=K?Zs.restSpeed.granular:Zs.restSpeed.default),a||(a=K?Zs.restDelta.granular:Zs.restDelta.default);let Q;if(I<1){const ee=GR(H,I);Q=se=>{const ue=Math.exp(-I*H*se);return h-ue*((U+I*H*V)/ee*Math.sin(ee*se)+V*Math.cos(ee*se))}}else if(I===1)Q=ee=>h-Math.exp(-H*ee)*(V+(U+H*V)*ee);else{const ee=H*Math.sqrt(I*I-1);Q=se=>{const ue=Math.exp(-I*H*se),he=Math.min(ee*se,300);return h-ue*((U+I*H*V)*Math.sinh(he)+ee*V*Math.cosh(he))/ee}}const ae={calculatedDuration:D&&T||null,next:ee=>{const se=Q(ee);if(D)i.done=ee>=T;else{let ue=0;I<1&&(ue=ee===0?xm(U):GX(Q,ee,se));const he=Math.abs(ue)<=n,Ce=Math.abs(h-se)<=a;i.done=he&&Ce}return i.value=i.done?h:se,i},toString:()=>{const ee=Math.min(WY(ae),OR),se=HY(ue=>ae.next(ee*ue).value,ee,30);return ee+"ms "+se}};return ae}function TV({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:a=10,bounceStiffness:c=500,modifyTarget:h,min:i,max:x,restDelta:w=.5,restSpeed:S}){const T=e[0],E={done:!1,value:T},D=he=>i!==void 0&&he<i||x!==void 0&&he>x,U=he=>i===void 0?x:x===void 0||Math.abs(i-he)<Math.abs(x-he)?i:x;let I=r*t;const V=T+I,H=h===void 0?V:h(V);H!==V&&(I=H-T);const K=he=>-I*Math.exp(-he/n),Q=he=>H+K(he),ae=he=>{const Ce=K(he),Ne=Q(he);E.done=Math.abs(Ce)<=w,E.value=E.done?H:Ne};let ee,se;const ue=he=>{D(E.value)&&(ee=he,se=WX({keyframes:[E.value,U(E.value)],velocity:GX(Q,he,E.value),damping:a,stiffness:c,restDelta:w,restSpeed:S}))};return ue(0),{calculatedDuration:null,next:he=>{let Ce=!1;return!se&&ee===void 0&&(Ce=!0,ae(he),ue(he)),ee!==void 0&&he>=ee?se.next(he-ee):(!Ce&&ae(he),E)}}}const fbe=h2(.42,0,1,1),pbe=h2(0,0,.58,1),HX=h2(.42,0,.58,1),mbe=e=>Array.isArray(e)&&typeof e[0]!="number",gbe={linear:Lu,easeIn:fbe,easeInOut:HX,easeOut:pbe,circIn:NL,circInOut:TX,circOut:AX,backIn:SL,backInOut:SX,backOut:wX,anticipate:NX},jV=e=>{if(oL(e)){qY(e.length===4);const[t,r,n,a]=e;return h2(t,r,n,a)}else if(typeof e=="string")return gbe[e];return e};function ybe(e,t,r){const n=[],a=r||qX,c=e.length-1;for(let h=0;h<c;h++){let i=a(e[h],e[h+1]);if(t){const x=Array.isArray(t)?t[h]||Lu:t;i=f2(x,i)}n.push(i)}return n}function xbe(e,t,{clamp:r=!0,ease:n,mixer:a}={}){const c=e.length;if(qY(c===t.length),c===1)return()=>t[0];if(c===2&&t[0]===t[1])return()=>t[1];const h=e[0]===e[1];e[0]>e[c-1]&&(e=[...e].reverse(),t=[...t].reverse());const i=ybe(t,n,a),x=i.length,w=S=>{if(h&&S<e[0])return t[0];let T=0;if(x>1)for(;T<e.length-2&&!(S<e[T+1]);T++);const E=Mv(e[T],e[T+1],S);return i[T](E)};return r?S=>w(jm(e[0],e[c-1],S)):w}function vbe(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const a=Mv(0,t,n);e.push(Bs(r,1,a))}}function _be(e){const t=[0];return vbe(t,e.length-1),t}function bbe(e,t){return e.map(r=>r*t)}function wbe(e,t){return e.map(()=>t||HX).splice(0,e.length-1)}function cA({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const a=mbe(n)?n.map(jV):jV(n),c={done:!1,value:t[0]},h=bbe(r&&r.length===t.length?r:_be(t),e),i=xbe(h,t,{ease:Array.isArray(a)?a:wbe(t,a)});return{calculatedDuration:e,next:x=>(c.value=i(x),c.done=x>=e,c)}}const Sbe=e=>{const t=({timestamp:r})=>e(r);return{start:()=>is.update(t,!0),stop:()=>sy(t),now:()=>El.isProcessing?El.timestamp:ep.now()}},Nbe={decay:TV,inertia:TV,tween:cA,keyframes:cA,spring:WX},Abe=e=>e/100;class PL extends UX{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:x}=this.options;x&&x()};const{name:r,motionValue:n,element:a,keyframes:c}=this.options,h=(a==null?void 0:a.KeyframeResolver)||jL,i=(x,w)=>this.onKeyframesResolved(x,w);this.resolver=new h(c,i,r,n,a),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:r="keyframes",repeat:n=0,repeatDelay:a=0,repeatType:c,velocity:h=0}=this.options,i=sL(r)?r:Nbe[r]||cA;let x,w;i!==cA&&typeof t[0]!="number"&&(x=f2(Abe,qX(t[0],t[1])),t=[0,100]);const S=i({...this.options,keyframes:t});c==="mirror"&&(w=i({...this.options,keyframes:[...t].reverse(),velocity:-h})),S.calculatedDuration===null&&(S.calculatedDuration=WY(S));const{calculatedDuration:T}=S,E=T+a,D=E*(n+1)-a;return{generator:S,mirroredGenerator:w,mapPercentToKeyframes:x,calculatedDuration:T,resolvedDuration:E,totalDuration:D}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,r=!1){const{resolved:n}=this;if(!n){const{keyframes:he}=this.options;return{done:!0,value:he[he.length-1]}}const{finalKeyframe:a,generator:c,mirroredGenerator:h,mapPercentToKeyframes:i,keyframes:x,calculatedDuration:w,totalDuration:S,resolvedDuration:T}=n;if(this.startTime===null)return c.next(0);const{delay:E,repeat:D,repeatType:U,repeatDelay:I,onUpdate:V}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-S/this.speed,this.startTime)),r?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const H=this.currentTime-E*(this.speed>=0?1:-1),K=this.speed>=0?H<0:H>S;this.currentTime=Math.max(H,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=S);let Q=this.currentTime,ae=c;if(D){const he=Math.min(this.currentTime,S)/T;let Ce=Math.floor(he),Ne=he%1;!Ne&&he>=1&&(Ne=1),Ne===1&&Ce--,Ce=Math.min(Ce,D+1),!!(Ce%2)&&(U==="reverse"?(Ne=1-Ne,I&&(Ne-=I/T)):U==="mirror"&&(ae=h)),Q=jm(0,1,Ne)*T}const ee=K?{done:!1,value:x[0]}:ae.next(Q);i&&(ee.value=i(ee.value));let{done:se}=ee;!K&&w!==null&&(se=this.speed>=0?this.currentTime>=S:this.currentTime<=0);const ue=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&se);return ue&&a!==void 0&&(ee.value=QT(x,this.options,a)),V&&V(ee.value),ue&&this.finish(),ee}get duration(){const{resolved:t}=this;return t?vm(t.calculatedDuration):0}get time(){return vm(this.currentTime)}set time(t){t=xm(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=vm(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=Sbe,onPlay:r,startTime:n}=this.options;this.driver||(this.driver=t(c=>this.tick(c))),r&&r();const a=this.driver.now();this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=a):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const Tbe=new Set(["opacity","clipPath","filter","transform"]);function jbe(e,t,r,{delay:n=0,duration:a=300,repeat:c=0,repeatType:h="loop",ease:i="easeInOut",times:x}={}){const w={[t]:r};x&&(w.offset=x);const S=ZY(i,a);return Array.isArray(S)&&(w.easing=S),e.animate(w,{delay:n,duration:a,easing:Array.isArray(S)?"linear":S,fill:"both",iterations:c+1,direction:h==="reverse"?"alternate":"normal"})}const kbe=nL(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),uA=10,Pbe=2e4;function Cbe(e){return sL(e.type)||e.type==="spring"||!KY(e.ease)}function Ebe(e,t){const r=new PL({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:e[0]};const a=[];let c=0;for(;!n.done&&c<Pbe;)n=r.sample(c),a.push(n.value),c+=uA;return{times:void 0,keyframes:a,duration:c-uA,ease:"linear"}}const KX={anticipate:NX,backInOut:SX,circInOut:TX};function Mbe(e){return e in KX}class kV extends UX{constructor(t){super(t);const{name:r,motionValue:n,element:a,keyframes:c}=this.options;this.resolver=new VX(c,(h,i)=>this.onKeyframesResolved(h,i),r,n,a),this.resolver.scheduleResolve()}initPlayback(t,r){let{duration:n=300,times:a,ease:c,type:h,motionValue:i,name:x,startTime:w}=this.options;if(!i.owner||!i.owner.current)return!1;if(typeof c=="string"&&sA()&&Mbe(c)&&(c=KX[c]),Cbe(this.options)){const{onComplete:T,onUpdate:E,motionValue:D,element:U,...I}=this.options,V=Ebe(t,I);t=V.keyframes,t.length===1&&(t[1]=t[0]),n=V.duration,a=V.times,c=V.ease,h="keyframes"}const S=jbe(i.owner.current,x,t,{...this.options,duration:n,times:a,ease:c});return S.startTime=w??this.calcStartTime(),this.pendingTimeline?(eV(S,this.pendingTimeline),this.pendingTimeline=void 0):S.onfinish=()=>{const{onComplete:T}=this.options;i.set(QT(t,this.options,r)),T&&T(),this.cancel(),this.resolveFinishedPromise()},{animation:S,duration:n,times:a,type:h,ease:c,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:r}=t;return vm(r)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:r}=t;return vm(r.currentTime||0)}set time(t){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.currentTime=xm(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:r}=t;return r.playbackRate}set speed(t){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:r}=t;return r.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:r}=t;return r.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:r}=this;if(!r)return Lu;const{animation:n}=r;eV(n,t)}return Lu}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playState==="finished"&&this.updateFinishedPromise(),r.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:r,keyframes:n,duration:a,type:c,ease:h,times:i}=t;if(r.playState==="idle"||r.playState==="finished")return;if(this.time){const{motionValue:w,onUpdate:S,onComplete:T,element:E,...D}=this.options,U=new PL({...D,keyframes:n,duration:a,type:c,ease:h,times:i,isGenerator:!0}),I=xm(this.time);w.setWithVelocity(U.sample(I-uA).value,U.sample(I).value,uA)}const{onStop:x}=this.options;x&&x(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:r,name:n,repeatDelay:a,repeatType:c,damping:h,type:i}=t;if(!r||!r.owner||!(r.owner.current instanceof HTMLElement))return!1;const{onUpdate:x,transformTemplate:w}=r.owner.getProps();return kbe()&&n&&Tbe.has(n)&&!x&&!w&&!a&&c!=="mirror"&&h!==0&&i!=="inertia"}}const Obe={type:"spring",stiffness:500,damping:25,restSpeed:10},Rbe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Ibe={type:"keyframes",duration:.8},Lbe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Dbe=(e,{keyframes:t})=>t.length>2?Ibe:tx.has(e)?e.startsWith("scale")?Rbe(t[1]):Obe:Lbe;function Fbe({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:a,repeat:c,repeatType:h,repeatDelay:i,from:x,elapsed:w,...S}){return!!Object.keys(S).length}const CL=(e,t,r,n={},a,c)=>h=>{const i=aL(n,e)||{},x=i.delay||n.delay||0;let{elapsed:w=0}=n;w=w-xm(x);let S={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...i,delay:-w,onUpdate:E=>{t.set(E),i.onUpdate&&i.onUpdate(E)},onComplete:()=>{h(),i.onComplete&&i.onComplete()},name:e,motionValue:t,element:c?void 0:a};Fbe(i)||(S={...S,...Dbe(e,S)}),S.duration&&(S.duration=xm(S.duration)),S.repeatDelay&&(S.repeatDelay=xm(S.repeatDelay)),S.from!==void 0&&(S.keyframes[0]=S.from);let T=!1;if((S.type===!1||S.duration===0&&!S.repeatDelay)&&(S.duration=0,S.delay===0&&(T=!0)),S.allowFlatten=!i.type&&!i.ease,T&&!c&&t.get()!==void 0){const E=QT(S.keyframes,i);if(E!==void 0)return is.update(()=>{S.onUpdate(E),S.onComplete()}),new ove([])}return!c&&kV.supports(S)?new kV(S):new PL(S)};function zbe({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function ZX(e,t,{delay:r=0,transitionOverride:n,type:a}={}){var c;let{transition:h=e.getDefaultTransition(),transitionEnd:i,...x}=t;n&&(h=n);const w=[],S=a&&e.animationState&&e.animationState.getState()[a];for(const T in x){const E=e.getValue(T,(c=e.latestValues[T])!==null&&c!==void 0?c:null),D=x[T];if(D===void 0||S&&zbe(S,T))continue;const U={delay:r,...aL(h||{},T)};let I=!1;if(window.MotionHandoffAnimation){const H=xX(e);if(H){const K=window.MotionHandoffAnimation(H,T,is);K!==null&&(U.startTime=K,I=!0)}}LR(e,T),E.start(CL(T,E,D,e.shouldReduceMotion&&yX.has(T)?{type:!1}:U,e,I));const V=E.animation;V&&w.push(V)}return i&&Promise.all(w).then(()=>{is.update(()=>{i&&f_e(e,i)})}),w}function WR(e,t,r={}){var n;const a=J1(e,t,r.type==="exit"?(n=e.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:c=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(c=r.transitionOverride);const h=a?()=>Promise.all(ZX(e,a,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(w=0)=>{const{delayChildren:S=0,staggerChildren:T,staggerDirection:E}=c;return Bbe(e,t,S+w,T,E,r)}:()=>Promise.resolve(),{when:x}=c;if(x){const[w,S]=x==="beforeChildren"?[h,i]:[i,h];return w().then(()=>S())}else return Promise.all([h(),i(r.delay)])}function Bbe(e,t,r=0,n=0,a=1,c){const h=[],i=(e.variantChildren.size-1)*n,x=a===1?(w=0)=>w*n:(w=0)=>i-w*n;return Array.from(e.variantChildren).sort(Vbe).forEach((w,S)=>{w.notify("AnimationStart",t),h.push(WR(w,t,{...c,delay:r+x(S)}).then(()=>w.notify("AnimationComplete",t)))}),Promise.all(h)}function Vbe(e,t){return e.sortNodePosition(t)}function Ube(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const a=t.map(c=>WR(e,c,r));n=Promise.all(a)}else if(typeof t=="string")n=WR(e,t,r);else{const a=typeof t=="function"?J1(e,t,r.custom):t;n=Promise.all(ZX(e,a,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function YX(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const $be=dL.length;function XX(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?XX(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<$be;r++){const n=dL[r],a=e.props[n];(Z1(a)||a===!1)&&(t[n]=a)}return t}const qbe=[...uL].reverse(),Gbe=uL.length;function Wbe(e){return t=>Promise.all(t.map(({animation:r,options:n})=>Ube(e,r,n)))}function Hbe(e){let t=Wbe(e),r=PV(),n=!0;const a=x=>(w,S)=>{var T;const E=J1(e,S,x==="exit"?(T=e.presenceContext)===null||T===void 0?void 0:T.custom:void 0);if(E){const{transition:D,transitionEnd:U,...I}=E;w={...w,...I,...U}}return w};function c(x){t=x(e)}function h(x){const{props:w}=e,S=XX(e.parent)||{},T=[],E=new Set;let D={},U=1/0;for(let V=0;V<Gbe;V++){const H=qbe[V],K=r[H],Q=w[H]!==void 0?w[H]:S[H],ae=Z1(Q),ee=H===x?K.isActive:null;ee===!1&&(U=V);let se=Q===S[H]&&Q!==w[H]&&ae;if(se&&n&&e.manuallyAnimateOnMount&&(se=!1),K.protectedKeys={...D},!K.isActive&&ee===null||!Q&&!K.prevProp||XT(Q)||typeof Q=="boolean")continue;const ue=Kbe(K.prevProp,Q);let he=ue||H===x&&K.isActive&&!se&&ae||V>U&&ae,Ce=!1;const Ne=Array.isArray(Q)?Q:[Q];let me=Ne.reduce(a(H),{});ee===!1&&(me={});const{prevResolvedValues:be={}}=K,pe={...be,...me},Se=Pe=>{he=!0,E.has(Pe)&&(Ce=!0,E.delete(Pe)),K.needsAnimating[Pe]=!0;const Me=e.getValue(Pe);Me&&(Me.liveStyle=!1)};for(const Pe in pe){const Me=me[Pe],Be=be[Pe];if(D.hasOwnProperty(Pe))continue;let Ge=!1;IR(Me)&&IR(Be)?Ge=!YX(Me,Be):Ge=Me!==Be,Ge?Me!=null?Se(Pe):E.add(Pe):Me!==void 0&&E.has(Pe)?Se(Pe):K.protectedKeys[Pe]=!0}K.prevProp=Q,K.prevResolvedValues=me,K.isActive&&(D={...D,...me}),n&&e.blockInitialAnimation&&(he=!1),he&&(!(se&&ue)||Ce)&&T.push(...Ne.map(Pe=>({animation:Pe,options:{type:H}})))}if(E.size){const V={};if(typeof w.initial!="boolean"){const H=J1(e,Array.isArray(w.initial)?w.initial[0]:w.initial);H&&H.transition&&(V.transition=H.transition)}E.forEach(H=>{const K=e.getBaseTarget(H),Q=e.getValue(H);Q&&(Q.liveStyle=!0),V[H]=K??null}),T.push({animation:V})}let I=!!T.length;return n&&(w.initial===!1||w.initial===w.animate)&&!e.manuallyAnimateOnMount&&(I=!1),n=!1,I?t(T):Promise.resolve()}function i(x,w){var S;if(r[x].isActive===w)return Promise.resolve();(S=e.variantChildren)===null||S===void 0||S.forEach(E=>{var D;return(D=E.animationState)===null||D===void 0?void 0:D.setActive(x,w)}),r[x].isActive=w;const T=h(x);for(const E in r)r[E].protectedKeys={};return T}return{animateChanges:h,setActive:i,setAnimateFunction:c,getState:()=>r,reset:()=>{r=PV(),n=!0}}}function Kbe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!YX(t,e):!1}function h0(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function PV(){return{animate:h0(!0),whileInView:h0(),whileHover:h0(),whileTap:h0(),whileDrag:h0(),whileFocus:h0(),exit:h0()}}class uy{constructor(t){this.isMounted=!1,this.node=t}update(){}}class Zbe extends uy{constructor(t){super(t),t.animationState||(t.animationState=Hbe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();XT(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let Ybe=0;class Xbe extends uy{constructor(){super(...arguments),this.id=Ybe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const a=this.node.animationState.setActive("exit",!t);r&&!t&&a.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const Jbe={animation:{Feature:Zbe},exit:{Feature:Xbe}};function ew(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function p2(e){return{point:{x:e.pageX,y:e.pageY}}}const Qbe=e=>t=>cL(t)&&e(t,p2(t));function f1(e,t,r,n){return ew(e,t,Qbe(r),n)}function JX({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function e1e({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function t1e(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}const QX=1e-4,r1e=1-QX,n1e=1+QX,eJ=.01,i1e=0-eJ,a1e=0+eJ;function _c(e){return e.max-e.min}function s1e(e,t,r){return Math.abs(e-t)<=r}function CV(e,t,r,n=.5){e.origin=n,e.originPoint=Bs(t.min,t.max,e.origin),e.scale=_c(r)/_c(t),e.translate=Bs(r.min,r.max,e.origin)-e.originPoint,(e.scale>=r1e&&e.scale<=n1e||isNaN(e.scale))&&(e.scale=1),(e.translate>=i1e&&e.translate<=a1e||isNaN(e.translate))&&(e.translate=0)}function p1(e,t,r,n){CV(e.x,t.x,r.x,n?n.originX:void 0),CV(e.y,t.y,r.y,n?n.originY:void 0)}function EV(e,t,r){e.min=r.min+t.min,e.max=e.min+_c(t)}function o1e(e,t,r){EV(e.x,t.x,r.x),EV(e.y,t.y,r.y)}function MV(e,t,r){e.min=t.min-r.min,e.max=e.min+_c(t)}function m1(e,t,r){MV(e.x,t.x,r.x),MV(e.y,t.y,r.y)}const OV=()=>({translate:0,scale:1,origin:0,originPoint:0}),dv=()=>({x:OV(),y:OV()}),RV=()=>({min:0,max:0}),lo=()=>({x:RV(),y:RV()});function kd(e){return[e("x"),e("y")]}function EP(e){return e===void 0||e===1}function HR({scale:e,scaleX:t,scaleY:r}){return!EP(e)||!EP(t)||!EP(r)}function g0(e){return HR(e)||tJ(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function tJ(e){return IV(e.x)||IV(e.y)}function IV(e){return e&&e!=="0%"}function dA(e,t,r){const n=e-r,a=t*n;return r+a}function LV(e,t,r,n,a){return a!==void 0&&(e=dA(e,a,n)),dA(e,r,n)+t}function KR(e,t=0,r=1,n,a){e.min=LV(e.min,t,r,n,a),e.max=LV(e.max,t,r,n,a)}function rJ(e,{x:t,y:r}){KR(e.x,t.translate,t.scale,t.originPoint),KR(e.y,r.translate,r.scale,r.originPoint)}const DV=.999999999999,FV=1.0000000000001;function l1e(e,t,r,n=!1){const a=r.length;if(!a)return;t.x=t.y=1;let c,h;for(let i=0;i<a;i++){c=r[i],h=c.projectionDelta;const{visualElement:x}=c.options;x&&x.props.style&&x.props.style.display==="contents"||(n&&c.options.layoutScroll&&c.scroll&&c!==c.root&&fv(e,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),h&&(t.x*=h.x.scale,t.y*=h.y.scale,rJ(e,h)),n&&g0(c.latestValues)&&fv(e,c.latestValues))}t.x<FV&&t.x>DV&&(t.x=1),t.y<FV&&t.y>DV&&(t.y=1)}function hv(e,t){e.min=e.min+t,e.max=e.max+t}function zV(e,t,r,n,a=.5){const c=Bs(e.min,e.max,a);KR(e,t,r,c,n)}function fv(e,t){zV(e.x,t.x,t.scaleX,t.scale,t.originX),zV(e.y,t.y,t.scaleY,t.scale,t.originY)}function nJ(e,t){return JX(t1e(e.getBoundingClientRect(),t))}function c1e(e,t,r){const n=nJ(e,r),{scroll:a}=t;return a&&(hv(n.x,a.offset.x),hv(n.y,a.offset.y)),n}const iJ=({current:e})=>e?e.ownerDocument.defaultView:null,BV=(e,t)=>Math.abs(e-t);function u1e(e,t){const r=BV(e.x,t.x),n=BV(e.y,t.y);return Math.sqrt(r**2+n**2)}class aJ{constructor(t,r,{transformPagePoint:n,contextWindow:a,dragSnapToOrigin:c=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=OP(this.lastMoveEventInfo,this.history),E=this.startEvent!==null,D=u1e(T.offset,{x:0,y:0})>=3;if(!E&&!D)return;const{point:U}=T,{timestamp:I}=El;this.history.push({...U,timestamp:I});const{onStart:V,onMove:H}=this.handlers;E||(V&&V(this.lastMoveEvent,T),this.startEvent=this.lastMoveEvent),H&&H(this.lastMoveEvent,T)},this.handlePointerMove=(T,E)=>{this.lastMoveEvent=T,this.lastMoveEventInfo=MP(E,this.transformPagePoint),is.update(this.updatePoint,!0)},this.handlePointerUp=(T,E)=>{this.end();const{onEnd:D,onSessionEnd:U,resumeAnimation:I}=this.handlers;if(this.dragSnapToOrigin&&I&&I(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const V=OP(T.type==="pointercancel"?this.lastMoveEventInfo:MP(E,this.transformPagePoint),this.history);this.startEvent&&D&&D(T,V),U&&U(T,V)},!cL(t))return;this.dragSnapToOrigin=c,this.handlers=r,this.transformPagePoint=n,this.contextWindow=a||window;const h=p2(t),i=MP(h,this.transformPagePoint),{point:x}=i,{timestamp:w}=El;this.history=[{...x,timestamp:w}];const{onSessionStart:S}=r;S&&S(t,OP(i,this.history)),this.removeListeners=f2(f1(this.contextWindow,"pointermove",this.handlePointerMove),f1(this.contextWindow,"pointerup",this.handlePointerUp),f1(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),sy(this.updatePoint)}}function MP(e,t){return t?{point:t(e.point)}:e}function VV(e,t){return{x:e.x-t.x,y:e.y-t.y}}function OP({point:e},t){return{point:e,delta:VV(e,sJ(t)),offset:VV(e,d1e(t)),velocity:h1e(t,.1)}}function d1e(e){return e[0]}function sJ(e){return e[e.length-1]}function h1e(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const a=sJ(e);for(;r>=0&&(n=e[r],!(a.timestamp-n.timestamp>xm(t)));)r--;if(!n)return{x:0,y:0};const c=vm(a.timestamp-n.timestamp);if(c===0)return{x:0,y:0};const h={x:(a.x-n.x)/c,y:(a.y-n.y)/c};return h.x===1/0&&(h.x=0),h.y===1/0&&(h.y=0),h}function f1e(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?Bs(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?Bs(r,e,n.max):Math.min(e,r)),e}function UV(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function p1e(e,{top:t,left:r,bottom:n,right:a}){return{x:UV(e.x,r,a),y:UV(e.y,t,n)}}function $V(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function m1e(e,t){return{x:$V(e.x,t.x),y:$V(e.y,t.y)}}function g1e(e,t){let r=.5;const n=_c(e),a=_c(t);return a>n?r=Mv(t.min,t.max-n,e.min):n>a&&(r=Mv(e.min,e.max-a,t.min)),jm(0,1,r)}function y1e(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const ZR=.35;function x1e(e=ZR){return e===!1?e=0:e===!0&&(e=ZR),{x:qV(e,"left","right"),y:qV(e,"top","bottom")}}function qV(e,t,r){return{min:GV(e,t),max:GV(e,r)}}function GV(e,t){return typeof e=="number"?e:e[t]||0}const v1e=new WeakMap;class _1e{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=lo(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const a=S=>{const{dragSnapToOrigin:T}=this.getProps();T?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(p2(S).point)},c=(S,T)=>{const{drag:E,dragPropagation:D,onDragStart:U}=this.getProps();if(E&&!D&&(this.openDragLock&&this.openDragLock(),this.openDragLock=fve(E),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),kd(V=>{let H=this.getAxisMotionValue(V).get()||0;if(tp.test(H)){const{projection:K}=this.visualElement;if(K&&K.layout){const Q=K.layout.layoutBox[V];Q&&(H=_c(Q)*(parseFloat(H)/100))}}this.originPoint[V]=H}),U&&is.postRender(()=>U(S,T)),LR(this.visualElement,"transform");const{animationState:I}=this.visualElement;I&&I.setActive("whileDrag",!0)},h=(S,T)=>{const{dragPropagation:E,dragDirectionLock:D,onDirectionLock:U,onDrag:I}=this.getProps();if(!E&&!this.openDragLock)return;const{offset:V}=T;if(D&&this.currentDirection===null){this.currentDirection=b1e(V),this.currentDirection!==null&&U&&U(this.currentDirection);return}this.updateAxis("x",T.point,V),this.updateAxis("y",T.point,V),this.visualElement.render(),I&&I(S,T)},i=(S,T)=>this.stop(S,T),x=()=>kd(S=>{var T;return this.getAnimationState(S)==="paused"&&((T=this.getAxisMotionValue(S).animation)===null||T===void 0?void 0:T.play())}),{dragSnapToOrigin:w}=this.getProps();this.panSession=new aJ(t,{onSessionStart:a,onStart:c,onMove:h,onSessionEnd:i,resumeAnimation:x},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:w,contextWindow:iJ(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:a}=r;this.startAnimation(a);const{onDragEnd:c}=this.getProps();c&&is.postRender(()=>c(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:a}=this.getProps();if(!n||!WS(t,a,this.currentDirection))return;const c=this.getAxisMotionValue(t);let h=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(h=f1e(h,this.constraints[t],this.elastic[t])),c.set(h)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,c=this.constraints;r&&cv(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&a?this.constraints=p1e(a.layoutBox,r):this.constraints=!1,this.elastic=x1e(n),c!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&kd(h=>{this.constraints!==!1&&this.getAxisMotionValue(h)&&(this.constraints[h]=y1e(a.layoutBox[h],this.constraints[h]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!cv(t))return!1;const n=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const c=c1e(n,a.root,this.visualElement.getTransformPagePoint());let h=m1e(a.layout.layoutBox,c);if(r){const i=r(e1e(h));this.hasMutatedConstraints=!!i,i&&(h=JX(i))}return h}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:a,dragTransition:c,dragSnapToOrigin:h,onDragTransitionEnd:i}=this.getProps(),x=this.constraints||{},w=kd(S=>{if(!WS(S,r,this.currentDirection))return;let T=x&&x[S]||{};h&&(T={min:0,max:0});const E=a?200:1e6,D=a?40:1e7,U={type:"inertia",velocity:n?t[S]:0,bounceStiffness:E,bounceDamping:D,timeConstant:750,restDelta:1,restSpeed:10,...c,...T};return this.startAxisValueAnimation(S,U)});return Promise.all(w).then(i)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return LR(this.visualElement,t),n.start(CL(t,n,0,r,this.visualElement,!1))}stopAnimation(){kd(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){kd(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),a=n[r];return a||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){kd(r=>{const{drag:n}=this.getProps();if(!WS(r,n,this.currentDirection))return;const{projection:a}=this.visualElement,c=this.getAxisMotionValue(r);if(a&&a.layout){const{min:h,max:i}=a.layout.layoutBox[r];c.set(t[r]-Bs(h,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!cv(r)||!n||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};kd(h=>{const i=this.getAxisMotionValue(h);if(i&&this.constraints!==!1){const x=i.get();a[h]=g1e({min:x,max:x},this.constraints[h])}});const{transformTemplate:c}=this.visualElement.getProps();this.visualElement.current.style.transform=c?c({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),kd(h=>{if(!WS(h,t,null))return;const i=this.getAxisMotionValue(h),{min:x,max:w}=this.constraints[h];i.set(Bs(x,w,a[h]))})}addListeners(){if(!this.visualElement.current)return;v1e.set(this.visualElement,this);const t=this.visualElement.current,r=f1(t,"pointerdown",x=>{const{drag:w,dragListener:S=!0}=this.getProps();w&&S&&this.start(x)}),n=()=>{const{dragConstraints:x}=this.getProps();cv(x)&&x.current&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,c=a.addEventListener("measure",n);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),is.read(n);const h=ew(window,"resize",()=>this.scalePositionWithinConstraints()),i=a.addEventListener("didUpdate",({delta:x,hasLayoutChanged:w})=>{this.isDragging&&w&&(kd(S=>{const T=this.getAxisMotionValue(S);T&&(this.originPoint[S]+=x[S].translate,T.set(T.get()+x[S].translate))}),this.visualElement.render())});return()=>{h(),r(),c(),i&&i()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:a=!1,dragConstraints:c=!1,dragElastic:h=ZR,dragMomentum:i=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:a,dragConstraints:c,dragElastic:h,dragMomentum:i}}}function WS(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function b1e(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class w1e extends uy{constructor(t){super(t),this.removeGroupControls=Lu,this.removeListeners=Lu,this.controls=new _1e(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Lu}unmount(){this.removeGroupControls(),this.removeListeners()}}const WV=e=>(t,r)=>{e&&is.postRender(()=>e(t,r))};class S1e extends uy{constructor(){super(...arguments),this.removePointerDownListener=Lu}onPointerDown(t){this.session=new aJ(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:iJ(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:a}=this.node.getProps();return{onSessionStart:WV(t),onStart:WV(r),onMove:n,onEnd:(c,h)=>{delete this.session,a&&is.postRender(()=>a(c,h))}}}mount(){this.removePointerDownListener=f1(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const PN={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function HV(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const zb={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ti.test(e))e=parseFloat(e);else return e;const r=HV(e,t.target.x),n=HV(e,t.target.y);return`${r}% ${n}%`}},N1e={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,a=oy.parse(e);if(a.length>5)return n;const c=oy.createTransformer(e),h=typeof a[0]!="number"?1:0,i=r.x.scale*t.x,x=r.y.scale*t.y;a[0+h]/=i,a[1+h]/=x;const w=Bs(i,x,.5);return typeof a[2+h]=="number"&&(a[2+h]/=w),typeof a[3+h]=="number"&&(a[3+h]/=w),c(a)}};class A1e extends G.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:a}=this.props,{projection:c}=t;Vve(T1e),c&&(r.group&&r.group.add(c),n&&n.register&&a&&n.register(c),c.root.didUpdate(),c.addEventListener("animationComplete",()=>{this.safeToRemove()}),c.setOptions({...c.options,onExitComplete:()=>this.safeToRemove()})),PN.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:a,isPresent:c}=this.props,h=n.projection;return h&&(h.isPresent=c,a||t.layoutDependency!==r||r===void 0||t.isPresent!==c?h.willUpdate():this.safeToRemove(),t.isPresent!==c&&(c?h.promote():h.relegate()||is.postRender(()=>{const i=h.getStack();(!i||!i.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),lL.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:a}=t;a&&(a.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(a),n&&n.deregister&&n.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function oJ(e){const[t,r]=nve(),n=G.useContext(UY);return o.jsx(A1e,{...e,layoutGroup:n,switchLayoutGroup:G.useContext(iX),isPresent:t,safeToRemove:r})}const T1e={borderRadius:{...zb,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:zb,borderTopRightRadius:zb,borderBottomLeftRadius:zb,borderBottomRightRadius:zb,boxShadow:N1e};function j1e(e,t,r){const n=tc(e)?e:K1(e);return n.start(CL("",n,t,r)),n.animation}function k1e(e){return e instanceof SVGElement&&e.tagName!=="svg"}const P1e=(e,t)=>e.depth-t.depth;class C1e{constructor(){this.children=[],this.isDirty=!1}add(t){tL(this.children,t),this.isDirty=!0}remove(t){rL(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(P1e),this.isDirty=!1,this.children.forEach(t)}}function E1e(e,t){const r=ep.now(),n=({timestamp:a})=>{const c=a-r;c>=t&&(sy(n),e(c-t))};return is.read(n,!0),()=>sy(n)}const lJ=["TopLeft","TopRight","BottomLeft","BottomRight"],M1e=lJ.length,KV=e=>typeof e=="string"?parseFloat(e):e,ZV=e=>typeof e=="number"||ti.test(e);function O1e(e,t,r,n,a,c){a?(e.opacity=Bs(0,r.opacity!==void 0?r.opacity:1,R1e(n)),e.opacityExit=Bs(t.opacity!==void 0?t.opacity:1,0,I1e(n))):c&&(e.opacity=Bs(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let h=0;h<M1e;h++){const i=`border${lJ[h]}Radius`;let x=YV(t,i),w=YV(r,i);if(x===void 0&&w===void 0)continue;x||(x=0),w||(w=0),x===0||w===0||ZV(x)===ZV(w)?(e[i]=Math.max(Bs(KV(x),KV(w),n),0),(tp.test(w)||tp.test(x))&&(e[i]+="%")):e[i]=w}(t.rotate||r.rotate)&&(e.rotate=Bs(t.rotate||0,r.rotate||0,n))}function YV(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const R1e=cJ(0,.5,AX),I1e=cJ(.5,.95,Lu);function cJ(e,t,r){return n=>n<e?0:n>t?1:r(Mv(e,t,n))}function XV(e,t){e.min=t.min,e.max=t.max}function Ad(e,t){XV(e.x,t.x),XV(e.y,t.y)}function JV(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function QV(e,t,r,n,a){return e-=t,e=dA(e,1/r,n),a!==void 0&&(e=dA(e,1/a,n)),e}function L1e(e,t=0,r=1,n=.5,a,c=e,h=e){if(tp.test(t)&&(t=parseFloat(t),t=Bs(h.min,h.max,t/100)-h.min),typeof t!="number")return;let i=Bs(c.min,c.max,n);e===c&&(i-=t),e.min=QV(e.min,t,r,i,a),e.max=QV(e.max,t,r,i,a)}function eU(e,t,[r,n,a],c,h){L1e(e,t[r],t[n],t[a],t.scale,c,h)}const D1e=["x","scaleX","originX"],F1e=["y","scaleY","originY"];function tU(e,t,r,n){eU(e.x,t,D1e,r?r.x:void 0,n?n.x:void 0),eU(e.y,t,F1e,r?r.y:void 0,n?n.y:void 0)}function rU(e){return e.translate===0&&e.scale===1}function uJ(e){return rU(e.x)&&rU(e.y)}function nU(e,t){return e.min===t.min&&e.max===t.max}function z1e(e,t){return nU(e.x,t.x)&&nU(e.y,t.y)}function iU(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function dJ(e,t){return iU(e.x,t.x)&&iU(e.y,t.y)}function aU(e){return _c(e.x)/_c(e.y)}function sU(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class B1e{constructor(){this.members=[]}add(t){tL(this.members,t),t.scheduleRender()}remove(t){if(rL(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(a=>t===a);if(r===0)return!1;let n;for(let a=r;a>=0;a--){const c=this.members[a];if(c.isPresent!==!1){n=c;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function V1e(e,t,r){let n="";const a=e.x.translate/t.x,c=e.y.translate/t.y,h=(r==null?void 0:r.z)||0;if((a||c||h)&&(n=`translate3d(${a}px, ${c}px, ${h}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:w,rotate:S,rotateX:T,rotateY:E,skewX:D,skewY:U}=r;w&&(n=`perspective(${w}px) ${n}`),S&&(n+=`rotate(${S}deg) `),T&&(n+=`rotateX(${T}deg) `),E&&(n+=`rotateY(${E}deg) `),D&&(n+=`skewX(${D}deg) `),U&&(n+=`skewY(${U}deg) `)}const i=e.x.scale*t.x,x=e.y.scale*t.y;return(i!==1||x!==1)&&(n+=`scale(${i}, ${x})`),n||"none"}const RP=["","X","Y","Z"],U1e={visibility:"hidden"},oU=1e3;let $1e=0;function IP(e,t,r,n){const{latestValues:a}=t;a[e]&&(r[e]=a[e],t.setStaticValue(e,0),n&&(n[e]=0))}function hJ(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=xX(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:a,layoutId:c}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",is,!(a||c))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&hJ(n)}function fJ({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:a}){return class{constructor(h={},i=t==null?void 0:t()){this.id=$1e++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(W1e),this.nodes.forEach(X1e),this.nodes.forEach(J1e),this.nodes.forEach(H1e)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=h,this.root=i?i.root||i:this,this.path=i?[...i.path,i]:[],this.parent=i,this.depth=i?i.depth+1:0;for(let x=0;x<this.path.length;x++)this.path[x].shouldResetTransform=!0;this.root===this&&(this.nodes=new C1e)}addEventListener(h,i){return this.eventHandlers.has(h)||this.eventHandlers.set(h,new iL),this.eventHandlers.get(h).add(i)}notifyListeners(h,...i){const x=this.eventHandlers.get(h);x&&x.notify(...i)}hasListeners(h){return this.eventHandlers.has(h)}mount(h,i=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=k1e(h),this.instance=h;const{layoutId:x,layout:w,visualElement:S}=this.options;if(S&&!S.current&&S.mount(h),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),i&&(w||x)&&(this.isLayoutDirty=!0),e){let T;const E=()=>this.root.updateBlockedByResize=!1;e(h,()=>{this.root.updateBlockedByResize=!0,T&&T(),T=E1e(E,250),PN.hasAnimatedSinceResize&&(PN.hasAnimatedSinceResize=!1,this.nodes.forEach(cU))})}x&&this.root.registerSharedNode(x,this),this.options.animate!==!1&&S&&(x||w)&&this.addEventListener("didUpdate",({delta:T,hasLayoutChanged:E,hasRelativeLayoutChanged:D,layout:U})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const I=this.options.transition||S.getDefaultTransition()||nwe,{onLayoutAnimationStart:V,onLayoutAnimationComplete:H}=S.getProps(),K=!this.targetLayout||!dJ(this.targetLayout,U),Q=!E&&D;if(this.options.layoutRoot||this.resumeFrom||Q||E&&(K||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(T,Q);const ae={...aL(I,"layout"),onPlay:V,onComplete:H};(S.shouldReduceMotion||this.options.layoutRoot)&&(ae.delay=0,ae.type=!1),this.startAnimation(ae)}else E||cU(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=U})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const h=this.getStack();h&&h.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,sy(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Q1e),this.animationId++)}getTransformTemplate(){const{visualElement:h}=this.options;return h&&h.getProps().transformTemplate}willUpdate(h=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&hJ(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let S=0;S<this.path.length;S++){const T=this.path[S];T.shouldResetTransform=!0,T.updateScroll("snapshot"),T.options.layoutRoot&&T.willUpdate(!1)}const{layoutId:i,layout:x}=this.options;if(i===void 0&&!x)return;const w=this.getTransformTemplate();this.prevTransformTemplateValue=w?w(this.latestValues,""):void 0,this.updateSnapshot(),h&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(lU);return}this.isUpdating||this.nodes.forEach(Z1e),this.isUpdating=!1,this.nodes.forEach(Y1e),this.nodes.forEach(q1e),this.nodes.forEach(G1e),this.clearAllSnapshots();const i=ep.now();El.delta=jm(0,1e3/60,i-El.timestamp),El.timestamp=i,El.isProcessing=!0,TP.update.process(El),TP.preRender.process(El),TP.render.process(El),El.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,lL.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(K1e),this.sharedNodes.forEach(ewe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,is.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){is.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!_c(this.snapshot.measuredBox.x)&&!_c(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let x=0;x<this.path.length;x++)this.path[x].updateScroll();const h=this.layout;this.layout=this.measure(!1),this.layoutCorrected=lo(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:i}=this.options;i&&i.notify("LayoutMeasure",this.layout.layoutBox,h?h.layoutBox:void 0)}updateScroll(h="measure"){let i=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===h&&(i=!1),i){const x=n(this.instance);this.scroll={animationId:this.root.animationId,phase:h,isRoot:x,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:x}}}resetTransform(){if(!a)return;const h=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,i=this.projectionDelta&&!uJ(this.projectionDelta),x=this.getTransformTemplate(),w=x?x(this.latestValues,""):void 0,S=w!==this.prevTransformTemplateValue;h&&(i||g0(this.latestValues)||S)&&(a(this.instance,w),this.shouldResetTransform=!1,this.scheduleRender())}measure(h=!0){const i=this.measurePageBox();let x=this.removeElementScroll(i);return h&&(x=this.removeTransform(x)),iwe(x),{animationId:this.root.animationId,measuredBox:i,layoutBox:x,latestValues:{},source:this.id}}measurePageBox(){var h;const{visualElement:i}=this.options;if(!i)return lo();const x=i.measureViewportBox();if(!(((h=this.scroll)===null||h===void 0?void 0:h.wasRoot)||this.path.some(awe))){const{scroll:S}=this.root;S&&(hv(x.x,S.offset.x),hv(x.y,S.offset.y))}return x}removeElementScroll(h){var i;const x=lo();if(Ad(x,h),!((i=this.scroll)===null||i===void 0)&&i.wasRoot)return x;for(let w=0;w<this.path.length;w++){const S=this.path[w],{scroll:T,options:E}=S;S!==this.root&&T&&E.layoutScroll&&(T.wasRoot&&Ad(x,h),hv(x.x,T.offset.x),hv(x.y,T.offset.y))}return x}applyTransform(h,i=!1){const x=lo();Ad(x,h);for(let w=0;w<this.path.length;w++){const S=this.path[w];!i&&S.options.layoutScroll&&S.scroll&&S!==S.root&&fv(x,{x:-S.scroll.offset.x,y:-S.scroll.offset.y}),g0(S.latestValues)&&fv(x,S.latestValues)}return g0(this.latestValues)&&fv(x,this.latestValues),x}removeTransform(h){const i=lo();Ad(i,h);for(let x=0;x<this.path.length;x++){const w=this.path[x];if(!w.instance||!g0(w.latestValues))continue;HR(w.latestValues)&&w.updateSnapshot();const S=lo(),T=w.measurePageBox();Ad(S,T),tU(i,w.latestValues,w.snapshot?w.snapshot.layoutBox:void 0,S)}return g0(this.latestValues)&&tU(i,this.latestValues),i}setTargetDelta(h){this.targetDelta=h,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(h){this.options={...this.options,...h,crossfade:h.crossfade!==void 0?h.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==El.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(h=!1){var i;const x=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=x.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=x.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=x.isSharedProjectionDirty);const w=!!this.resumingFrom||this!==x;if(!(h||w&&this.isSharedProjectionDirty||this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:T,layoutId:E}=this.options;if(!(!this.layout||!(T||E))){if(this.resolvedRelativeTargetAt=El.timestamp,!this.targetDelta&&!this.relativeTarget){const D=this.getClosestProjectingParent();D&&D.layout&&this.animationProgress!==1?(this.relativeParent=D,this.forceRelativeParentToResolveTarget(),this.relativeTarget=lo(),this.relativeTargetOrigin=lo(),m1(this.relativeTargetOrigin,this.layout.layoutBox,D.layout.layoutBox),Ad(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=lo(),this.targetWithTransforms=lo()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),o1e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ad(this.target,this.layout.layoutBox),rJ(this.target,this.targetDelta)):Ad(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const D=this.getClosestProjectingParent();D&&!!D.resumingFrom==!!this.resumingFrom&&!D.options.layoutScroll&&D.target&&this.animationProgress!==1?(this.relativeParent=D,this.forceRelativeParentToResolveTarget(),this.relativeTarget=lo(),this.relativeTargetOrigin=lo(),m1(this.relativeTargetOrigin,this.target,D.target),Ad(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||HR(this.parent.latestValues)||tJ(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var h;const i=this.getLead(),x=!!this.resumingFrom||this!==i;let w=!0;if((this.isProjectionDirty||!((h=this.parent)===null||h===void 0)&&h.isProjectionDirty)&&(w=!1),x&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(w=!1),this.resolvedRelativeTargetAt===El.timestamp&&(w=!1),w)return;const{layout:S,layoutId:T}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(S||T))return;Ad(this.layoutCorrected,this.layout.layoutBox);const E=this.treeScale.x,D=this.treeScale.y;l1e(this.layoutCorrected,this.treeScale,this.path,x),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=lo());const{target:U}=i;if(!U){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(JV(this.prevProjectionDelta.x,this.projectionDelta.x),JV(this.prevProjectionDelta.y,this.projectionDelta.y)),p1(this.projectionDelta,this.layoutCorrected,U,this.latestValues),(this.treeScale.x!==E||this.treeScale.y!==D||!sU(this.projectionDelta.x,this.prevProjectionDelta.x)||!sU(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",U))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(h=!0){var i;if((i=this.options.visualElement)===null||i===void 0||i.scheduleRender(),h){const x=this.getStack();x&&x.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=dv(),this.projectionDelta=dv(),this.projectionDeltaWithTransform=dv()}setAnimationOrigin(h,i=!1){const x=this.snapshot,w=x?x.latestValues:{},S={...this.latestValues},T=dv();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!i;const E=lo(),D=x?x.source:void 0,U=this.layout?this.layout.source:void 0,I=D!==U,V=this.getStack(),H=!V||V.members.length<=1,K=!!(I&&!H&&this.options.crossfade===!0&&!this.path.some(rwe));this.animationProgress=0;let Q;this.mixTargetDelta=ae=>{const ee=ae/1e3;uU(T.x,h.x,ee),uU(T.y,h.y,ee),this.setTargetDelta(T),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(m1(E,this.layout.layoutBox,this.relativeParent.layout.layoutBox),twe(this.relativeTarget,this.relativeTargetOrigin,E,ee),Q&&z1e(this.relativeTarget,Q)&&(this.isProjectionDirty=!1),Q||(Q=lo()),Ad(Q,this.relativeTarget)),I&&(this.animationValues=S,O1e(S,w,this.latestValues,ee,K,H)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=ee},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(h){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(sy(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=is.update(()=>{PN.hasAnimatedSinceResize=!0,this.currentAnimation=j1e(0,oU,{...h,onUpdate:i=>{this.mixTargetDelta(i),h.onUpdate&&h.onUpdate(i)},onStop:()=>{},onComplete:()=>{h.onComplete&&h.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const h=this.getStack();h&&h.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(oU),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const h=this.getLead();let{targetWithTransforms:i,target:x,layout:w,latestValues:S}=h;if(!(!i||!x||!w)){if(this!==h&&this.layout&&w&&pJ(this.options.animationType,this.layout.layoutBox,w.layoutBox)){x=this.target||lo();const T=_c(this.layout.layoutBox.x);x.x.min=h.target.x.min,x.x.max=x.x.min+T;const E=_c(this.layout.layoutBox.y);x.y.min=h.target.y.min,x.y.max=x.y.min+E}Ad(i,x),fv(i,S),p1(this.projectionDeltaWithTransform,this.layoutCorrected,i,S)}}registerSharedNode(h,i){this.sharedNodes.has(h)||this.sharedNodes.set(h,new B1e),this.sharedNodes.get(h).add(i);const w=i.options.initialPromotionConfig;i.promote({transition:w?w.transition:void 0,preserveFollowOpacity:w&&w.shouldPreserveFollowOpacity?w.shouldPreserveFollowOpacity(i):void 0})}isLead(){const h=this.getStack();return h?h.lead===this:!0}getLead(){var h;const{layoutId:i}=this.options;return i?((h=this.getStack())===null||h===void 0?void 0:h.lead)||this:this}getPrevLead(){var h;const{layoutId:i}=this.options;return i?(h=this.getStack())===null||h===void 0?void 0:h.prevLead:void 0}getStack(){const{layoutId:h}=this.options;if(h)return this.root.sharedNodes.get(h)}promote({needsReset:h,transition:i,preserveFollowOpacity:x}={}){const w=this.getStack();w&&w.promote(this,x),h&&(this.projectionDelta=void 0,this.needsReset=!0),i&&this.setOptions({transition:i})}relegate(){const h=this.getStack();return h?h.relegate(this):!1}resetSkewAndRotation(){const{visualElement:h}=this.options;if(!h)return;let i=!1;const{latestValues:x}=h;if((x.z||x.rotate||x.rotateX||x.rotateY||x.rotateZ||x.skewX||x.skewY)&&(i=!0),!i)return;const w={};x.z&&IP("z",h,w,this.animationValues);for(let S=0;S<RP.length;S++)IP(`rotate${RP[S]}`,h,w,this.animationValues),IP(`skew${RP[S]}`,h,w,this.animationValues);h.render();for(const S in w)h.setStaticValue(S,w[S]),this.animationValues&&(this.animationValues[S]=w[S]);h.scheduleRender()}getProjectionStyles(h){var i,x;if(!this.instance||this.isSVG)return;if(!this.isVisible)return U1e;const w={visibility:""},S=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,w.opacity="",w.pointerEvents=kN(h==null?void 0:h.pointerEvents)||"",w.transform=S?S(this.latestValues,""):"none",w;const T=this.getLead();if(!this.projectionDelta||!this.layout||!T.target){const I={};return this.options.layoutId&&(I.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,I.pointerEvents=kN(h==null?void 0:h.pointerEvents)||""),this.hasProjected&&!g0(this.latestValues)&&(I.transform=S?S({},""):"none",this.hasProjected=!1),I}const E=T.animationValues||T.latestValues;this.applyTransformsToTarget(),w.transform=V1e(this.projectionDeltaWithTransform,this.treeScale,E),S&&(w.transform=S(E,w.transform));const{x:D,y:U}=this.projectionDelta;w.transformOrigin=`${D.origin*100}% ${U.origin*100}% 0`,T.animationValues?w.opacity=T===this?(x=(i=E.opacity)!==null&&i!==void 0?i:this.latestValues.opacity)!==null&&x!==void 0?x:1:this.preserveOpacity?this.latestValues.opacity:E.opacityExit:w.opacity=T===this?E.opacity!==void 0?E.opacity:"":E.opacityExit!==void 0?E.opacityExit:0;for(const I in Y1){if(E[I]===void 0)continue;const{correct:V,applyTo:H,isCSSVariable:K}=Y1[I],Q=w.transform==="none"?E[I]:V(E[I],T);if(H){const ae=H.length;for(let ee=0;ee<ae;ee++)w[H[ee]]=Q}else K?this.options.visualElement.renderState.vars[I]=Q:w[I]=Q}return this.options.layoutId&&(w.pointerEvents=T===this?kN(h==null?void 0:h.pointerEvents)||"":"none"),w}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(h=>{var i;return(i=h.currentAnimation)===null||i===void 0?void 0:i.stop()}),this.root.nodes.forEach(lU),this.root.sharedNodes.clear()}}}function q1e(e){e.updateLayout()}function G1e(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:a}=e.layout,{animationType:c}=e.options,h=r.source!==e.layout.source;c==="size"?kd(T=>{const E=h?r.measuredBox[T]:r.layoutBox[T],D=_c(E);E.min=n[T].min,E.max=E.min+D}):pJ(c,r.layoutBox,n)&&kd(T=>{const E=h?r.measuredBox[T]:r.layoutBox[T],D=_c(n[T]);E.max=E.min+D,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[T].max=e.relativeTarget[T].min+D)});const i=dv();p1(i,n,r.layoutBox);const x=dv();h?p1(x,e.applyTransform(a,!0),r.measuredBox):p1(x,n,r.layoutBox);const w=!uJ(i);let S=!1;if(!e.resumeFrom){const T=e.getClosestProjectingParent();if(T&&!T.resumeFrom){const{snapshot:E,layout:D}=T;if(E&&D){const U=lo();m1(U,r.layoutBox,E.layoutBox);const I=lo();m1(I,n,D.layoutBox),dJ(U,I)||(S=!0),T.options.layoutRoot&&(e.relativeTarget=I,e.relativeTargetOrigin=U,e.relativeParent=T)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:x,layoutDelta:i,hasLayoutChanged:w,hasRelativeLayoutChanged:S})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function W1e(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function H1e(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function K1e(e){e.clearSnapshot()}function lU(e){e.clearMeasurements()}function Z1e(e){e.isLayoutDirty=!1}function Y1e(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function cU(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function X1e(e){e.resolveTargetDelta()}function J1e(e){e.calcProjection()}function Q1e(e){e.resetSkewAndRotation()}function ewe(e){e.removeLeadSnapshot()}function uU(e,t,r){e.translate=Bs(t.translate,0,r),e.scale=Bs(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function dU(e,t,r,n){e.min=Bs(t.min,r.min,n),e.max=Bs(t.max,r.max,n)}function twe(e,t,r,n){dU(e.x,t.x,r.x,n),dU(e.y,t.y,r.y,n)}function rwe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const nwe={duration:.45,ease:[.4,0,.1,1]},hU=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),fU=hU("applewebkit/")&&!hU("chrome/")?Math.round:Lu;function pU(e){e.min=fU(e.min),e.max=fU(e.max)}function iwe(e){pU(e.x),pU(e.y)}function pJ(e,t,r){return e==="position"||e==="preserve-aspect"&&!s1e(aU(t),aU(r),.2)}function awe(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const swe=fJ({attachResizeListener:(e,t)=>ew(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),LP={current:void 0},mJ=fJ({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!LP.current){const e=new swe({});e.mount(window),e.setOptions({layoutScroll:!0}),LP.current=e}return LP.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),owe={pan:{Feature:S1e},drag:{Feature:w1e,ProjectionNode:mJ,MeasureLayout:oJ}};function mU(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const a="onHover"+r,c=n[a];c&&is.postRender(()=>c(t,p2(t)))}class lwe extends uy{mount(){const{current:t}=this.node;t&&(this.unmount=mve(t,(r,n)=>(mU(this.node,n,"Start"),a=>mU(this.node,a,"End"))))}unmount(){}}class cwe extends uy{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=f2(ew(this.node.current,"focus",()=>this.onFocus()),ew(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function gU(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const a="onTap"+(r==="End"?"":r),c=n[a];c&&is.postRender(()=>c(t,p2(t)))}class uwe extends uy{mount(){const{current:t}=this.node;t&&(this.unmount=vve(t,(r,n)=>(gU(this.node,n,"Start"),(a,{success:c})=>gU(this.node,a,c?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const YR=new WeakMap,DP=new WeakMap,dwe=e=>{const t=YR.get(e.target);t&&t(e)},hwe=e=>{e.forEach(dwe)};function fwe({root:e,...t}){const r=e||document;DP.has(r)||DP.set(r,{});const n=DP.get(r),a=JSON.stringify(t);return n[a]||(n[a]=new IntersectionObserver(hwe,{root:e,...t})),n[a]}function pwe(e,t,r){const n=fwe(t);return YR.set(e,r),n.observe(e),()=>{YR.delete(e),n.unobserve(e)}}const mwe={some:0,all:1};class gwe extends uy{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:a="some",once:c}=t,h={root:r?r.current:void 0,rootMargin:n,threshold:typeof a=="number"?a:mwe[a]},i=x=>{const{isIntersecting:w}=x;if(this.isInView===w||(this.isInView=w,c&&!w&&this.hasEnteredView))return;w&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",w);const{onViewportEnter:S,onViewportLeave:T}=this.node.getProps(),E=w?S:T;E&&E(x)};return pwe(this.node.current,h,i)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(ywe(t,r))&&this.startObserver()}unmount(){}}function ywe({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const xwe={inView:{Feature:gwe},tap:{Feature:uwe},focus:{Feature:cwe},hover:{Feature:lwe}},vwe={layout:{ProjectionNode:mJ,MeasureLayout:oJ}},XR={current:null},gJ={current:!1};function _we(){if(gJ.current=!0,!!Q4)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>XR.current=e.matches;e.addListener(t),t()}else XR.current=!1}const bwe=[...BX,Xl,oy],wwe=e=>bwe.find(zX(e)),Swe=new WeakMap;function Nwe(e,t,r){for(const n in t){const a=t[n],c=r[n];if(tc(a))e.addValue(n,a);else if(tc(c))e.addValue(n,K1(a,{owner:e}));else if(c!==a)if(e.hasValue(n)){const h=e.getValue(n);h.liveStyle===!0?h.jump(a):h.hasAnimated||h.set(a)}else{const h=e.getStaticValue(n);e.addValue(n,K1(h!==void 0?h:a,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const yU=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Awe{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:a,blockInitialAnimation:c,visualState:h},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=jL,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const D=ep.now();this.renderScheduledAt<D&&(this.renderScheduledAt=D,is.render(this.render,!1,!0))};const{latestValues:x,renderState:w,onUpdate:S}=h;this.onUpdate=S,this.latestValues=x,this.baseTarget={...x},this.initialValues=r.initial?{...x}:{},this.renderState=w,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=i,this.blockInitialAnimation=!!c,this.isControllingVariants=JT(r),this.isVariantNode=rX(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:T,...E}=this.scrapeMotionValuesFromProps(r,{},this);for(const D in E){const U=E[D];x[D]!==void 0&&tc(U)&&U.set(x[D],!1)}}mount(t){this.current=t,Swe.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),gJ.current||_we(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:XR.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),sy(this.notifyUpdate),sy(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=tx.has(t);n&&this.onBindTransform&&this.onBindTransform();const a=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&is.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),c=r.on("renderRequest",this.scheduleRender);let h;window.MotionCheckAppearSync&&(h=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{a(),c(),h&&h(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Ov){const r=Ov[t];if(!r)continue;const{isEnabled:n,Feature:a}=r;if(!this.features[t]&&a&&n(this.props)&&(this.features[t]=new a(this)),this.features[t]){const c=this.features[t];c.isMounted?c.update():(c.mount(),c.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):lo()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<yU.length;n++){const a=yU[n];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const c="on"+a,h=t[c];h&&(this.propEventSubscriptions[a]=this.on(a,h))}this.prevMotionValues=Nwe(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=K1(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){var n;let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(n=this.getBaseTargetFromProps(this.props,t))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(DX(a)||jX(a))?a=parseFloat(a):!wwe(a)&&oy.test(r)&&(a=RX(t,r)),this.setBaseTarget(t,tc(a)?a.get():a)),tc(a)?a.get():a}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props;let a;if(typeof n=="string"||typeof n=="object"){const h=bL(this.props,n,(r=this.presenceContext)===null||r===void 0?void 0:r.custom);h&&(a=h[t])}if(n&&a!==void 0)return a;const c=this.getBaseTargetFromProps(this.props,t);return c!==void 0&&!tc(c)?c:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new iL),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class yJ extends Awe{constructor(){super(...arguments),this.KeyframeResolver=VX}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;tc(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function Twe(e){return window.getComputedStyle(e)}class jwe extends yJ{constructor(){super(...arguments),this.type="html",this.renderInstance=fX}readValueFromInstance(t,r){if(tx.has(r))return F_e(t,r);{const n=Twe(t),a=(fL(r)?n.getPropertyValue(r):n[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return nJ(t,r)}build(t,r,n){gL(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return wL(t,r,n)}}class kwe extends yJ{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=lo,this.updateDimensions=()=>{this.current&&!this.renderState.dimensions&&hX(this.current,this.renderState)}}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(tx.has(r)){const n=OX(r);return n&&n.default||0}return r=pX.has(r)?r:hL(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return gX(t,r,n)}onBindTransform(){this.current&&!this.renderState.dimensions&&is.postRender(this.updateDimensions)}build(t,r,n){vL(t,r,this.isSVGTag,n.transformTemplate)}renderInstance(t,r,n,a){mX(t,r,n,a)}mount(t){this.isSVGTag=_L(t.tagName),super.mount(t)}}const Pwe=(e,t)=>xL(e)?new kwe(t):new jwe(t,{allowProjection:e!==G.Fragment}),Cwe=d_e({...Jbe,...xwe,...owe,...vwe},Pwe),Ewe=jve(Cwe);function hA({className:e,...t}){return o.jsx("div",{className:zt("animate-pulse rounded-md bg-primary/10",e),...t})}const HS=({name:e,icon:t,value:r,color:n,loading:a,statuses:c=[]})=>o.jsx(Ewe.div,{className:"bg-card shadow-sm border border-border overflow-hidden rounded-xl",children:a?o.jsx(hA,{className:"h-[100px]"}):o.jsxs("div",{className:"md:px-4 md:py-5 p-6",children:[o.jsxs("span",{className:"flex items-center justify-between text-xs text-muted-foreground ",children:[e,o.jsx(t,{size:20,className:"mr-3 text-accent-foreground"})]}),o.jsx("p",{className:"mt-1 text-3xl md:text-4xl tracking-tight font-bold ",children:r}),c.length>0&&o.jsx("div",{className:"space-x-2 mt-2",children:c.map((h,i)=>o.jsx("span",{className:" text-xs py-1 px-2 rounded-md",style:{color:h.color,backgroundColor:h.bgColor},children:h.label},i))})]})});var FP,xU;function nu(){if(xU)return FP;xU=1;var e=Array.isArray;return FP=e,FP}var zP,vU;function xJ(){if(vU)return zP;vU=1;var e=typeof ES=="object"&&ES&&ES.Object===Object&&ES;return zP=e,zP}var BP,_U;function gp(){if(_U)return BP;_U=1;var e=xJ(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return BP=r,BP}var VP,bU;function m2(){if(bU)return VP;bU=1;var e=gp(),t=e.Symbol;return VP=t,VP}var UP,wU;function Mwe(){if(wU)return UP;wU=1;var e=m2(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,a=e?e.toStringTag:void 0;function c(h){var i=r.call(h,a),x=h[a];try{h[a]=void 0;var w=!0}catch{}var S=n.call(h);return w&&(i?h[a]=x:delete h[a]),S}return UP=c,UP}var $P,SU;function Owe(){if(SU)return $P;SU=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return $P=r,$P}var qP,NU;function Mm(){if(NU)return qP;NU=1;var e=m2(),t=Mwe(),r=Owe(),n="[object Null]",a="[object Undefined]",c=e?e.toStringTag:void 0;function h(i){return i==null?i===void 0?a:n:c&&c in Object(i)?t(i):r(i)}return qP=h,qP}var GP,AU;function Om(){if(AU)return GP;AU=1;function e(t){return t!=null&&typeof t=="object"}return GP=e,GP}var WP,TU;function P_(){if(TU)return WP;TU=1;var e=Mm(),t=Om(),r="[object Symbol]";function n(a){return typeof a=="symbol"||t(a)&&e(a)==r}return WP=n,WP}var HP,jU;function EL(){if(jU)return HP;jU=1;var e=nu(),t=P_(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(c,h){if(e(c))return!1;var i=typeof c;return i=="number"||i=="symbol"||i=="boolean"||c==null||t(c)?!0:n.test(c)||!r.test(c)||h!=null&&c in Object(h)}return HP=a,HP}var KP,kU;function dy(){if(kU)return KP;kU=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return KP=e,KP}var ZP,PU;function ML(){if(PU)return ZP;PU=1;var e=Mm(),t=dy(),r="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",c="[object Proxy]";function h(i){if(!t(i))return!1;var x=e(i);return x==n||x==a||x==r||x==c}return ZP=h,ZP}var YP,CU;function Rwe(){if(CU)return YP;CU=1;var e=gp(),t=e["__core-js_shared__"];return YP=t,YP}var XP,EU;function Iwe(){if(EU)return XP;EU=1;var e=Rwe(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return XP=r,XP}var JP,MU;function vJ(){if(MU)return JP;MU=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return JP=r,JP}var QP,OU;function Lwe(){if(OU)return QP;OU=1;var e=ML(),t=Iwe(),r=dy(),n=vJ(),a=/[\\^$.*+?()[\]{}|]/g,c=/^\[object .+?Constructor\]$/,h=Function.prototype,i=Object.prototype,x=h.toString,w=i.hasOwnProperty,S=RegExp("^"+x.call(w).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function T(E){if(!r(E)||t(E))return!1;var D=e(E)?S:c;return D.test(n(E))}return QP=T,QP}var eC,RU;function Dwe(){if(RU)return eC;RU=1;function e(t,r){return t==null?void 0:t[r]}return eC=e,eC}var tC,IU;function rx(){if(IU)return tC;IU=1;var e=Lwe(),t=Dwe();function r(n,a){var c=t(n,a);return e(c)?c:void 0}return tC=r,tC}var rC,LU;function ej(){if(LU)return rC;LU=1;var e=rx(),t=e(Object,"create");return rC=t,rC}var nC,DU;function Fwe(){if(DU)return nC;DU=1;var e=ej();function t(){this.__data__=e?e(null):{},this.size=0}return nC=t,nC}var iC,FU;function zwe(){if(FU)return iC;FU=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return iC=e,iC}var aC,zU;function Bwe(){if(zU)return aC;zU=1;var e=ej(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function a(c){var h=this.__data__;if(e){var i=h[c];return i===t?void 0:i}return n.call(h,c)?h[c]:void 0}return aC=a,aC}var sC,BU;function Vwe(){if(BU)return sC;BU=1;var e=ej(),t=Object.prototype,r=t.hasOwnProperty;function n(a){var c=this.__data__;return e?c[a]!==void 0:r.call(c,a)}return sC=n,sC}var oC,VU;function Uwe(){if(VU)return oC;VU=1;var e=ej(),t="__lodash_hash_undefined__";function r(n,a){var c=this.__data__;return this.size+=this.has(n)?0:1,c[n]=e&&a===void 0?t:a,this}return oC=r,oC}var lC,UU;function $we(){if(UU)return lC;UU=1;var e=Fwe(),t=zwe(),r=Bwe(),n=Vwe(),a=Uwe();function c(h){var i=-1,x=h==null?0:h.length;for(this.clear();++i<x;){var w=h[i];this.set(w[0],w[1])}}return c.prototype.clear=e,c.prototype.delete=t,c.prototype.get=r,c.prototype.has=n,c.prototype.set=a,lC=c,lC}var cC,$U;function qwe(){if($U)return cC;$U=1;function e(){this.__data__=[],this.size=0}return cC=e,cC}var uC,qU;function OL(){if(qU)return uC;qU=1;function e(t,r){return t===r||t!==t&&r!==r}return uC=e,uC}var dC,GU;function tj(){if(GU)return dC;GU=1;var e=OL();function t(r,n){for(var a=r.length;a--;)if(e(r[a][0],n))return a;return-1}return dC=t,dC}var hC,WU;function Gwe(){if(WU)return hC;WU=1;var e=tj(),t=Array.prototype,r=t.splice;function n(a){var c=this.__data__,h=e(c,a);if(h<0)return!1;var i=c.length-1;return h==i?c.pop():r.call(c,h,1),--this.size,!0}return hC=n,hC}var fC,HU;function Wwe(){if(HU)return fC;HU=1;var e=tj();function t(r){var n=this.__data__,a=e(n,r);return a<0?void 0:n[a][1]}return fC=t,fC}var pC,KU;function Hwe(){if(KU)return pC;KU=1;var e=tj();function t(r){return e(this.__data__,r)>-1}return pC=t,pC}var mC,ZU;function Kwe(){if(ZU)return mC;ZU=1;var e=tj();function t(r,n){var a=this.__data__,c=e(a,r);return c<0?(++this.size,a.push([r,n])):a[c][1]=n,this}return mC=t,mC}var gC,YU;function rj(){if(YU)return gC;YU=1;var e=qwe(),t=Gwe(),r=Wwe(),n=Hwe(),a=Kwe();function c(h){var i=-1,x=h==null?0:h.length;for(this.clear();++i<x;){var w=h[i];this.set(w[0],w[1])}}return c.prototype.clear=e,c.prototype.delete=t,c.prototype.get=r,c.prototype.has=n,c.prototype.set=a,gC=c,gC}var yC,XU;function RL(){if(XU)return yC;XU=1;var e=rx(),t=gp(),r=e(t,"Map");return yC=r,yC}var xC,JU;function Zwe(){if(JU)return xC;JU=1;var e=$we(),t=rj(),r=RL();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return xC=n,xC}var vC,QU;function Ywe(){if(QU)return vC;QU=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return vC=e,vC}var _C,e$;function nj(){if(e$)return _C;e$=1;var e=Ywe();function t(r,n){var a=r.__data__;return e(n)?a[typeof n=="string"?"string":"hash"]:a.map}return _C=t,_C}var bC,t$;function Xwe(){if(t$)return bC;t$=1;var e=nj();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return bC=t,bC}var wC,r$;function Jwe(){if(r$)return wC;r$=1;var e=nj();function t(r){return e(this,r).get(r)}return wC=t,wC}var SC,n$;function Qwe(){if(n$)return SC;n$=1;var e=nj();function t(r){return e(this,r).has(r)}return SC=t,SC}var NC,i$;function e2e(){if(i$)return NC;i$=1;var e=nj();function t(r,n){var a=e(this,r),c=a.size;return a.set(r,n),this.size+=a.size==c?0:1,this}return NC=t,NC}var AC,a$;function IL(){if(a$)return AC;a$=1;var e=Zwe(),t=Xwe(),r=Jwe(),n=Qwe(),a=e2e();function c(h){var i=-1,x=h==null?0:h.length;for(this.clear();++i<x;){var w=h[i];this.set(w[0],w[1])}}return c.prototype.clear=e,c.prototype.delete=t,c.prototype.get=r,c.prototype.has=n,c.prototype.set=a,AC=c,AC}var TC,s$;function _J(){if(s$)return TC;s$=1;var e=IL(),t="Expected a function";function r(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var c=function(){var h=arguments,i=a?a.apply(this,h):h[0],x=c.cache;if(x.has(i))return x.get(i);var w=n.apply(this,h);return c.cache=x.set(i,w)||x,w};return c.cache=new(r.Cache||e),c}return r.Cache=e,TC=r,TC}var jC,o$;function t2e(){if(o$)return jC;o$=1;var e=_J(),t=500;function r(n){var a=e(n,function(h){return c.size===t&&c.clear(),h}),c=a.cache;return a}return jC=r,jC}var kC,l$;function r2e(){if(l$)return kC;l$=1;var e=t2e(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(a){var c=[];return a.charCodeAt(0)===46&&c.push(""),a.replace(t,function(h,i,x,w){c.push(x?w.replace(r,"$1"):i||h)}),c});return kC=n,kC}var PC,c$;function LL(){if(c$)return PC;c$=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,c=Array(a);++n<a;)c[n]=r(t[n],n,t);return c}return PC=e,PC}var CC,u$;function n2e(){if(u$)return CC;u$=1;var e=m2(),t=LL(),r=nu(),n=P_(),a=e?e.prototype:void 0,c=a?a.toString:void 0;function h(i){if(typeof i=="string")return i;if(r(i))return t(i,h)+"";if(n(i))return c?c.call(i):"";var x=i+"";return x=="0"&&1/i==-1/0?"-0":x}return CC=h,CC}var EC,d$;function bJ(){if(d$)return EC;d$=1;var e=n2e();function t(r){return r==null?"":e(r)}return EC=t,EC}var MC,h$;function wJ(){if(h$)return MC;h$=1;var e=nu(),t=EL(),r=r2e(),n=bJ();function a(c,h){return e(c)?c:t(c,h)?[c]:r(n(c))}return MC=a,MC}var OC,f$;function ij(){if(f$)return OC;f$=1;var e=P_();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return OC=t,OC}var RC,p$;function DL(){if(p$)return RC;p$=1;var e=wJ(),t=ij();function r(n,a){a=e(a,n);for(var c=0,h=a.length;n!=null&&c<h;)n=n[t(a[c++])];return c&&c==h?n:void 0}return RC=r,RC}var IC,m$;function SJ(){if(m$)return IC;m$=1;var e=DL();function t(r,n,a){var c=r==null?void 0:e(r,n);return c===void 0?a:c}return IC=t,IC}var i2e=SJ();const Du=ha(i2e);var LC,g$;function a2e(){if(g$)return LC;g$=1;function e(t){return t==null}return LC=e,LC}var s2e=a2e();const Yn=ha(s2e);var DC,y$;function o2e(){if(y$)return DC;y$=1;var e=Mm(),t=nu(),r=Om(),n="[object String]";function a(c){return typeof c=="string"||!t(c)&&r(c)&&e(c)==n}return DC=a,DC}var l2e=o2e();const g2=ha(l2e);var c2e=ML();const qn=ha(c2e);var u2e=dy();const C_=ha(u2e);var FC={exports:{}},Aa={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x$;function d2e(){if(x$)return Aa;x$=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),h=Symbol.for("react.context"),i=Symbol.for("react.server_context"),x=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),D=Symbol.for("react.offscreen"),U;U=Symbol.for("react.module.reference");function I(V){if(typeof V=="object"&&V!==null){var H=V.$$typeof;switch(H){case e:switch(V=V.type,V){case r:case a:case n:case w:case S:return V;default:switch(V=V&&V.$$typeof,V){case i:case h:case x:case E:case T:case c:return V;default:return H}}case t:return H}}}return Aa.ContextConsumer=h,Aa.ContextProvider=c,Aa.Element=e,Aa.ForwardRef=x,Aa.Fragment=r,Aa.Lazy=E,Aa.Memo=T,Aa.Portal=t,Aa.Profiler=a,Aa.StrictMode=n,Aa.Suspense=w,Aa.SuspenseList=S,Aa.isAsyncMode=function(){return!1},Aa.isConcurrentMode=function(){return!1},Aa.isContextConsumer=function(V){return I(V)===h},Aa.isContextProvider=function(V){return I(V)===c},Aa.isElement=function(V){return typeof V=="object"&&V!==null&&V.$$typeof===e},Aa.isForwardRef=function(V){return I(V)===x},Aa.isFragment=function(V){return I(V)===r},Aa.isLazy=function(V){return I(V)===E},Aa.isMemo=function(V){return I(V)===T},Aa.isPortal=function(V){return I(V)===t},Aa.isProfiler=function(V){return I(V)===a},Aa.isStrictMode=function(V){return I(V)===n},Aa.isSuspense=function(V){return I(V)===w},Aa.isSuspenseList=function(V){return I(V)===S},Aa.isValidElementType=function(V){return typeof V=="string"||typeof V=="function"||V===r||V===a||V===n||V===w||V===S||V===D||typeof V=="object"&&V!==null&&(V.$$typeof===E||V.$$typeof===T||V.$$typeof===c||V.$$typeof===h||V.$$typeof===x||V.$$typeof===U||V.getModuleId!==void 0)},Aa.typeOf=I,Aa}var v$;function h2e(){return v$||(v$=1,FC.exports=d2e()),FC.exports}var f2e=h2e(),zC,_$;function NJ(){if(_$)return zC;_$=1;var e=Mm(),t=Om(),r="[object Number]";function n(a){return typeof a=="number"||t(a)&&e(a)==r}return zC=n,zC}var BC,b$;function p2e(){if(b$)return BC;b$=1;var e=NJ();function t(r){return e(r)&&r!=+r}return BC=t,BC}var m2e=p2e();const E_=ha(m2e);var g2e=NJ();const y2e=ha(g2e);var hl=function(t){return t===0?0:t>0?1:-1},j0=function(t){return g2(t)&&t.indexOf("%")===t.length-1},Dr=function(t){return y2e(t)&&!E_(t)},Wo=function(t){return Dr(t)||g2(t)},x2e=0,hy=function(t){var r=++x2e;return"".concat(t||"").concat(r)},bc=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Dr(t)&&!g2(t))return n;var c;if(j0(t)){var h=t.indexOf("%");c=r*parseFloat(t.slice(0,h))/100}else c=+t;return E_(c)&&(c=n),a&&c>r&&(c=r),c},$g=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},v2e=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},ts=function(t,r){return Dr(t)&&Dr(r)?function(n){return t+n*(r-t)}:function(){return r}};function fA(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Du(n,t))===r})}var _2e=function(t){if(!t||!t.length)return null;for(var r=t.length,n=0,a=0,c=0,h=0,i=1/0,x=-1/0,w=0,S=0,T=0;T<r;T++)w=t[T].cx||0,S=t[T].cy||0,n+=w,a+=S,c+=w*S,h+=w*w,i=Math.min(i,w),x=Math.max(x,w);var E=r*h!==n*n?(r*c-n*a)/(r*h-n*n):0;return{xmin:i,xmax:x,a:E,b:(a-E*n)/r}};function Sv(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function JR(e){"@babel/helpers - typeof";return JR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},JR(e)}var b2e=["viewBox","children"],w2e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],w$=["points","pathLength"],VC={svg:b2e,polygon:w$,polyline:w$},FL=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],pA=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(G.isValidElement(t)&&(n=t.props),!C_(n))return null;var a={};return Object.keys(n).forEach(function(c){FL.includes(c)&&(a[c]=r||function(h){return n[c](n,h)})}),a},S2e=function(t,r,n){return function(a){return t(r,n,a),null}},dp=function(t,r,n){if(!C_(t)||JR(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(c){var h=t[c];FL.includes(c)&&typeof h=="function"&&(a||(a={}),a[c]=S2e(h,r,n))}),a},N2e=["children"],A2e=["children"];function S$(e,t){if(e==null)return{};var r=T2e(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function T2e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function QR(e){"@babel/helpers - typeof";return QR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},QR(e)}var N$={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},_m=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},A$=null,UC=null,zL=function e(t){if(t===A$&&Array.isArray(UC))return UC;var r=[];return G.Children.forEach(t,function(n){Yn(n)||(f2e.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),UC=r,A$=t,r};function rc(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return _m(a)}):n=[_m(t)],zL(e).forEach(function(a){var c=Du(a,"type.displayName")||Du(a,"type.name");n.indexOf(c)!==-1&&r.push(a)}),r}function Eu(e,t){var r=rc(e,t);return r&&r[0]}var T$=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!Dr(n)||n<=0||!Dr(a)||a<=0)},j2e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],k2e=function(t){return t&&t.type&&g2(t.type)&&j2e.indexOf(t.type)>=0},AJ=function(t){return t&&QR(t)==="object"&&"clipDot"in t},P2e=function(t,r,n,a){var c,h=(c=VC==null?void 0:VC[a])!==null&&c!==void 0?c:[];return!qn(t)&&(a&&h.includes(r)||w2e.includes(r))||n&&FL.includes(r)},wn=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(G.isValidElement(t)&&(a=t.props),!C_(a))return null;var c={};return Object.keys(a).forEach(function(h){var i;P2e((i=a)===null||i===void 0?void 0:i[h],h,r,n)&&(c[h]=a[h])}),c},eI=function e(t,r){if(t===r)return!0;var n=G.Children.count(t);if(n!==G.Children.count(r))return!1;if(n===0)return!0;if(n===1)return j$(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var c=t[a],h=r[a];if(Array.isArray(c)||Array.isArray(h)){if(!e(c,h))return!1}else if(!j$(c,h))return!1}return!0},j$=function(t,r){if(Yn(t)&&Yn(r))return!0;if(!Yn(t)&&!Yn(r)){var n=t.props||{},a=n.children,c=S$(n,N2e),h=r.props||{},i=h.children,x=S$(h,A2e);return a&&i?Sv(c,x)&&eI(a,i):!a&&!i?Sv(c,x):!1}return!1},k$=function(t,r){var n=[],a={};return zL(t).forEach(function(c,h){if(k2e(c))n.push(c);else if(c){var i=_m(c.type),x=r[i]||{},w=x.handler,S=x.once;if(w&&(!S||!a[i])){var T=w(c,i,h);n.push(T),a[i]=!0}}}),n},C2e=function(t){var r=t&&t.type;return r&&N$[r]?N$[r]:null},E2e=function(t,r){return zL(r).indexOf(t)},M2e=["children","width","height","viewBox","className","style","title","desc"];function tI(){return tI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tI.apply(this,arguments)}function O2e(e,t){if(e==null)return{};var r=R2e(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function R2e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function rI(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,c=e.className,h=e.style,i=e.title,x=e.desc,w=O2e(e,M2e),S=a||{width:r,height:n,x:0,y:0},T=di("recharts-surface",c);return Le.createElement("svg",tI({},wn(w,!0,"svg"),{className:T,width:r,height:n,style:h,viewBox:"".concat(S.x," ").concat(S.y," ").concat(S.width," ").concat(S.height)}),Le.createElement("title",null,i),Le.createElement("desc",null,x),t)}var I2e=["children","className"];function nI(){return nI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nI.apply(this,arguments)}function L2e(e,t){if(e==null)return{};var r=D2e(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function D2e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var fi=Le.forwardRef(function(e,t){var r=e.children,n=e.className,a=L2e(e,I2e),c=di("recharts-layer",n);return Le.createElement("g",nI({className:c},wn(a,!0),{ref:t}),r)}),qh=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),c=2;c<n;c++)a[c-2]=arguments[c]},$C,P$;function F2e(){if(P$)return $C;P$=1;function e(t,r,n){var a=-1,c=t.length;r<0&&(r=-r>c?0:c+r),n=n>c?c:n,n<0&&(n+=c),c=r>n?0:n-r>>>0,r>>>=0;for(var h=Array(c);++a<c;)h[a]=t[a+r];return h}return $C=e,$C}var qC,C$;function z2e(){if(C$)return qC;C$=1;var e=F2e();function t(r,n,a){var c=r.length;return a=a===void 0?c:a,!n&&a>=c?r:e(r,n,a)}return qC=t,qC}var GC,E$;function TJ(){if(E$)return GC;E$=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,c="\\ufe0e\\ufe0f",h="\\u200d",i=RegExp("["+h+e+a+c+"]");function x(w){return i.test(w)}return GC=x,GC}var WC,M$;function B2e(){if(M$)return WC;M$=1;function e(t){return t.split("")}return WC=e,WC}var HC,O$;function V2e(){if(O$)return HC;O$=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,c="\\ufe0e\\ufe0f",h="["+e+"]",i="["+a+"]",x="\\ud83c[\\udffb-\\udfff]",w="(?:"+i+"|"+x+")",S="[^"+e+"]",T="(?:\\ud83c[\\udde6-\\uddff]){2}",E="[\\ud800-\\udbff][\\udc00-\\udfff]",D="\\u200d",U=w+"?",I="["+c+"]?",V="(?:"+D+"(?:"+[S,T,E].join("|")+")"+I+U+")*",H=I+U+V,K="(?:"+[S+i+"?",i,T,E,h].join("|")+")",Q=RegExp(x+"(?="+x+")|"+K+H,"g");function ae(ee){return ee.match(Q)||[]}return HC=ae,HC}var KC,R$;function U2e(){if(R$)return KC;R$=1;var e=B2e(),t=TJ(),r=V2e();function n(a){return t(a)?r(a):e(a)}return KC=n,KC}var ZC,I$;function $2e(){if(I$)return ZC;I$=1;var e=z2e(),t=TJ(),r=U2e(),n=bJ();function a(c){return function(h){h=n(h);var i=t(h)?r(h):void 0,x=i?i[0]:h.charAt(0),w=i?e(i,1).join(""):h.slice(1);return x[c]()+w}}return ZC=a,ZC}var YC,L$;function q2e(){if(L$)return YC;L$=1;var e=$2e(),t=e("toUpperCase");return YC=t,YC}var G2e=q2e();const aj=ha(G2e);function Ja(e){return function(){return e}}const jJ=Math.cos,mA=Math.sin,af=Math.sqrt,gA=Math.PI,sj=2*gA,iI=Math.PI,aI=2*iI,y0=1e-6,W2e=aI-y0;function kJ(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function H2e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return kJ;const r=10**t;return function(n){this._+=n[0];for(let a=1,c=n.length;a<c;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class K2e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?kJ:H2e(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,c,h){this._append`C${+t},${+r},${+n},${+a},${this._x1=+c},${this._y1=+h}`}arcTo(t,r,n,a,c){if(t=+t,r=+r,n=+n,a=+a,c=+c,c<0)throw new Error(`negative radius: ${c}`);let h=this._x1,i=this._y1,x=n-t,w=a-r,S=h-t,T=i-r,E=S*S+T*T;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(E>y0)if(!(Math.abs(T*x-w*S)>y0)||!c)this._append`L${this._x1=t},${this._y1=r}`;else{let D=n-h,U=a-i,I=x*x+w*w,V=D*D+U*U,H=Math.sqrt(I),K=Math.sqrt(E),Q=c*Math.tan((iI-Math.acos((I+E-V)/(2*H*K)))/2),ae=Q/K,ee=Q/H;Math.abs(ae-1)>y0&&this._append`L${t+ae*S},${r+ae*T}`,this._append`A${c},${c},0,0,${+(T*D>S*U)},${this._x1=t+ee*x},${this._y1=r+ee*w}`}}arc(t,r,n,a,c,h){if(t=+t,r=+r,n=+n,h=!!h,n<0)throw new Error(`negative radius: ${n}`);let i=n*Math.cos(a),x=n*Math.sin(a),w=t+i,S=r+x,T=1^h,E=h?a-c:c-a;this._x1===null?this._append`M${w},${S}`:(Math.abs(this._x1-w)>y0||Math.abs(this._y1-S)>y0)&&this._append`L${w},${S}`,n&&(E<0&&(E=E%aI+aI),E>W2e?this._append`A${n},${n},0,1,${T},${t-i},${r-x}A${n},${n},0,1,${T},${this._x1=w},${this._y1=S}`:E>y0&&this._append`A${n},${n},0,${+(E>=iI)},${T},${this._x1=t+n*Math.cos(c)},${this._y1=r+n*Math.sin(c)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function BL(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new K2e(t)}function VL(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function PJ(e){this._context=e}PJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function oj(e){return new PJ(e)}function CJ(e){return e[0]}function EJ(e){return e[1]}function MJ(e,t){var r=Ja(!0),n=null,a=oj,c=null,h=BL(i);e=typeof e=="function"?e:e===void 0?CJ:Ja(e),t=typeof t=="function"?t:t===void 0?EJ:Ja(t);function i(x){var w,S=(x=VL(x)).length,T,E=!1,D;for(n==null&&(c=a(D=h())),w=0;w<=S;++w)!(w<S&&r(T=x[w],w,x))===E&&((E=!E)?c.lineStart():c.lineEnd()),E&&c.point(+e(T,w,x),+t(T,w,x));if(D)return c=null,D+""||null}return i.x=function(x){return arguments.length?(e=typeof x=="function"?x:Ja(+x),i):e},i.y=function(x){return arguments.length?(t=typeof x=="function"?x:Ja(+x),i):t},i.defined=function(x){return arguments.length?(r=typeof x=="function"?x:Ja(!!x),i):r},i.curve=function(x){return arguments.length?(a=x,n!=null&&(c=a(n)),i):a},i.context=function(x){return arguments.length?(x==null?n=c=null:c=a(n=x),i):n},i}function KS(e,t,r){var n=null,a=Ja(!0),c=null,h=oj,i=null,x=BL(w);e=typeof e=="function"?e:e===void 0?CJ:Ja(+e),t=typeof t=="function"?t:Ja(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?EJ:Ja(+r);function w(T){var E,D,U,I=(T=VL(T)).length,V,H=!1,K,Q=new Array(I),ae=new Array(I);for(c==null&&(i=h(K=x())),E=0;E<=I;++E){if(!(E<I&&a(V=T[E],E,T))===H)if(H=!H)D=E,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),U=E-1;U>=D;--U)i.point(Q[U],ae[U]);i.lineEnd(),i.areaEnd()}H&&(Q[E]=+e(V,E,T),ae[E]=+t(V,E,T),i.point(n?+n(V,E,T):Q[E],r?+r(V,E,T):ae[E]))}if(K)return i=null,K+""||null}function S(){return MJ().defined(a).curve(h).context(c)}return w.x=function(T){return arguments.length?(e=typeof T=="function"?T:Ja(+T),n=null,w):e},w.x0=function(T){return arguments.length?(e=typeof T=="function"?T:Ja(+T),w):e},w.x1=function(T){return arguments.length?(n=T==null?null:typeof T=="function"?T:Ja(+T),w):n},w.y=function(T){return arguments.length?(t=typeof T=="function"?T:Ja(+T),r=null,w):t},w.y0=function(T){return arguments.length?(t=typeof T=="function"?T:Ja(+T),w):t},w.y1=function(T){return arguments.length?(r=T==null?null:typeof T=="function"?T:Ja(+T),w):r},w.lineX0=w.lineY0=function(){return S().x(e).y(t)},w.lineY1=function(){return S().x(e).y(r)},w.lineX1=function(){return S().x(n).y(t)},w.defined=function(T){return arguments.length?(a=typeof T=="function"?T:Ja(!!T),w):a},w.curve=function(T){return arguments.length?(h=T,c!=null&&(i=h(c)),w):h},w.context=function(T){return arguments.length?(T==null?c=i=null:i=h(c=T),w):c},w}class OJ{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Z2e(e){return new OJ(e,!0)}function Y2e(e){return new OJ(e,!1)}const UL={draw(e,t){const r=af(t/gA);e.moveTo(r,0),e.arc(0,0,r,0,sj)}},X2e={draw(e,t){const r=af(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},RJ=af(1/3),J2e=RJ*2,Q2e={draw(e,t){const r=af(t/J2e),n=r*RJ;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},eSe={draw(e,t){const r=af(t),n=-r/2;e.rect(n,n,r,r)}},tSe=.8908130915292852,IJ=mA(gA/10)/mA(7*gA/10),rSe=mA(sj/10)*IJ,nSe=-jJ(sj/10)*IJ,iSe={draw(e,t){const r=af(t*tSe),n=rSe*r,a=nSe*r;e.moveTo(0,-r),e.lineTo(n,a);for(let c=1;c<5;++c){const h=sj*c/5,i=jJ(h),x=mA(h);e.lineTo(x*r,-i*r),e.lineTo(i*n-x*a,x*n+i*a)}e.closePath()}},XC=af(3),aSe={draw(e,t){const r=-af(t/(XC*3));e.moveTo(0,r*2),e.lineTo(-XC*r,-r),e.lineTo(XC*r,-r),e.closePath()}},Td=-.5,jd=af(3)/2,sI=1/af(12),sSe=(sI/2+1)*3,oSe={draw(e,t){const r=af(t/sSe),n=r/2,a=r*sI,c=n,h=r*sI+r,i=-c,x=h;e.moveTo(n,a),e.lineTo(c,h),e.lineTo(i,x),e.lineTo(Td*n-jd*a,jd*n+Td*a),e.lineTo(Td*c-jd*h,jd*c+Td*h),e.lineTo(Td*i-jd*x,jd*i+Td*x),e.lineTo(Td*n+jd*a,Td*a-jd*n),e.lineTo(Td*c+jd*h,Td*h-jd*c),e.lineTo(Td*i+jd*x,Td*x-jd*i),e.closePath()}};function lSe(e,t){let r=null,n=BL(a);e=typeof e=="function"?e:Ja(e||UL),t=typeof t=="function"?t:Ja(t===void 0?64:+t);function a(){let c;if(r||(r=c=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),c)return r=null,c+""||null}return a.type=function(c){return arguments.length?(e=typeof c=="function"?c:Ja(c),a):e},a.size=function(c){return arguments.length?(t=typeof c=="function"?c:Ja(+c),a):t},a.context=function(c){return arguments.length?(r=c??null,a):r},a}function yA(){}function xA(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function LJ(e){this._context=e}LJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:xA(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:xA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function cSe(e){return new LJ(e)}function DJ(e){this._context=e}DJ.prototype={areaStart:yA,areaEnd:yA,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:xA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function uSe(e){return new DJ(e)}function FJ(e){this._context=e}FJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:xA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function dSe(e){return new FJ(e)}function zJ(e){this._context=e}zJ.prototype={areaStart:yA,areaEnd:yA,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function hSe(e){return new zJ(e)}function D$(e){return e<0?-1:1}function F$(e,t,r){var n=e._x1-e._x0,a=t-e._x1,c=(e._y1-e._y0)/(n||a<0&&-0),h=(r-e._y1)/(a||n<0&&-0),i=(c*a+h*n)/(n+a);return(D$(c)+D$(h))*Math.min(Math.abs(c),Math.abs(h),.5*Math.abs(i))||0}function z$(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function JC(e,t,r){var n=e._x0,a=e._y0,c=e._x1,h=e._y1,i=(c-n)/3;e._context.bezierCurveTo(n+i,a+i*t,c-i,h-i*r,c,h)}function vA(e){this._context=e}vA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:JC(this,this._t0,z$(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,JC(this,z$(this,r=F$(this,e,t)),r);break;default:JC(this,this._t0,r=F$(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function BJ(e){this._context=new VJ(e)}(BJ.prototype=Object.create(vA.prototype)).point=function(e,t){vA.prototype.point.call(this,t,e)};function VJ(e){this._context=e}VJ.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,c){this._context.bezierCurveTo(t,e,n,r,c,a)}};function fSe(e){return new vA(e)}function pSe(e){return new BJ(e)}function UJ(e){this._context=e}UJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=B$(e),a=B$(t),c=0,h=1;h<r;++c,++h)this._context.bezierCurveTo(n[0][c],a[0][c],n[1][c],a[1][c],e[h],t[h]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function B$(e){var t,r=e.length-1,n,a=new Array(r),c=new Array(r),h=new Array(r);for(a[0]=0,c[0]=2,h[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,c[t]=4,h[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,c[r-1]=7,h[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/c[t-1],c[t]-=n,h[t]-=n*h[t-1];for(a[r-1]=h[r-1]/c[r-1],t=r-2;t>=0;--t)a[t]=(h[t]-a[t+1])/c[t];for(c[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)c[t]=2*e[t+1]-a[t+1];return[a,c]}function mSe(e){return new UJ(e)}function lj(e,t){this._context=e,this._t=t}lj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function gSe(e){return new lj(e,.5)}function ySe(e){return new lj(e,0)}function xSe(e){return new lj(e,1)}function Iv(e,t){if((h=e.length)>1)for(var r=1,n,a,c=e[t[0]],h,i=c.length;r<h;++r)for(a=c,c=e[t[r]],n=0;n<i;++n)c[n][1]+=c[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function oI(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function vSe(e,t){return e[t]}function _Se(e){const t=[];return t.key=e,t}function bSe(){var e=Ja([]),t=oI,r=Iv,n=vSe;function a(c){var h=Array.from(e.apply(this,arguments),_Se),i,x=h.length,w=-1,S;for(const T of c)for(i=0,++w;i<x;++i)(h[i][w]=[0,+n(T,h[i].key,w,c)]).data=T;for(i=0,S=VL(t(h));i<x;++i)h[S[i]].index=i;return r(h,S),h}return a.keys=function(c){return arguments.length?(e=typeof c=="function"?c:Ja(Array.from(c)),a):e},a.value=function(c){return arguments.length?(n=typeof c=="function"?c:Ja(+c),a):n},a.order=function(c){return arguments.length?(t=c==null?oI:typeof c=="function"?c:Ja(Array.from(c)),a):t},a.offset=function(c){return arguments.length?(r=c??Iv,a):r},a}function wSe(e,t){if((n=e.length)>0){for(var r,n,a=0,c=e[0].length,h;a<c;++a){for(h=r=0;r<n;++r)h+=e[r][a][1]||0;if(h)for(r=0;r<n;++r)e[r][a][1]/=h}Iv(e,t)}}function SSe(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,c=n.length;r<c;++r){for(var h=0,i=0;h<a;++h)i+=e[h][r][1]||0;n[r][1]+=n[r][0]=-i/2}Iv(e,t)}}function NSe(e,t){if(!(!((h=e.length)>0)||!((c=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,c,h;n<c;++n){for(var i=0,x=0,w=0;i<h;++i){for(var S=e[t[i]],T=S[n][1]||0,E=S[n-1][1]||0,D=(T-E)/2,U=0;U<i;++U){var I=e[t[U]],V=I[n][1]||0,H=I[n-1][1]||0;D+=V-H}x+=T,w+=D*T}a[n-1][1]+=a[n-1][0]=r,x&&(r-=w/x)}a[n-1][1]+=a[n-1][0]=r,Iv(e,t)}}function tw(e){"@babel/helpers - typeof";return tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tw(e)}var ASe=["type","size","sizeType"];function lI(){return lI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lI.apply(this,arguments)}function V$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function U$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V$(Object(r),!0).forEach(function(n){TSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TSe(e,t,r){return t=jSe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jSe(e){var t=kSe(e,"string");return tw(t)=="symbol"?t:t+""}function kSe(e,t){if(tw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(tw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PSe(e,t){if(e==null)return{};var r=CSe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function CSe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var $J={symbolCircle:UL,symbolCross:X2e,symbolDiamond:Q2e,symbolSquare:eSe,symbolStar:iSe,symbolTriangle:aSe,symbolWye:oSe},ESe=Math.PI/180,MSe=function(t){var r="symbol".concat(aj(t));return $J[r]||UL},OSe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*ESe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},RSe=function(t,r){$J["symbol".concat(aj(t))]=r},cj=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,c=a===void 0?64:a,h=t.sizeType,i=h===void 0?"area":h,x=PSe(t,ASe),w=U$(U$({},x),{},{type:n,size:c,sizeType:i}),S=function(){var V=MSe(n),H=lSe().type(V).size(OSe(c,i,n));return H()},T=w.className,E=w.cx,D=w.cy,U=wn(w,!0);return E===+E&&D===+D&&c===+c?Le.createElement("path",lI({},U,{className:di("recharts-symbols",T),transform:"translate(".concat(E,", ").concat(D,")"),d:S()})):null};cj.registerSymbol=RSe;function Lv(e){"@babel/helpers - typeof";return Lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lv(e)}function cI(){return cI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cI.apply(this,arguments)}function $$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ISe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$$(Object(r),!0).forEach(function(n){rw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DSe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GJ(n.key),n)}}function FSe(e,t,r){return t&&DSe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zSe(e,t,r){return t=_A(t),BSe(e,qJ()?Reflect.construct(t,r||[],_A(e).constructor):t.apply(e,r))}function BSe(e,t){if(t&&(Lv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VSe(e)}function VSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qJ=function(){return!!e})()}function _A(e){return _A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_A(e)}function USe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uI(e,t)}function uI(e,t){return uI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},uI(e,t)}function rw(e,t,r){return t=GJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GJ(e){var t=$Se(e,"string");return Lv(t)=="symbol"?t:t+""}function $Se(e,t){if(Lv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Lv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Rh=32,$L=function(e){function t(){return LSe(this,t),zSe(this,t,arguments)}return USe(t,e),FSe(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,c=Rh/2,h=Rh/6,i=Rh/3,x=n.inactive?a:n.color;if(n.type==="plainline")return Le.createElement("line",{strokeWidth:4,fill:"none",stroke:x,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:c,x2:Rh,y2:c,className:"recharts-legend-icon"});if(n.type==="line")return Le.createElement("path",{strokeWidth:4,fill:"none",stroke:x,d:"M0,".concat(c,"h").concat(i,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(2*i,",").concat(c,`
            H`).concat(Rh,"M").concat(2*i,",").concat(c,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(i,",").concat(c),className:"recharts-legend-icon"});if(n.type==="rect")return Le.createElement("path",{stroke:"none",fill:x,d:"M0,".concat(Rh/8,"h").concat(Rh,"v").concat(Rh*3/4,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(Le.isValidElement(n.legendIcon)){var w=ISe({},n);return delete w.legendIcon,Le.cloneElement(n.legendIcon,w)}return Le.createElement(cj,{fill:x,cx:c,cy:c,size:Rh,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,c=a.payload,h=a.iconSize,i=a.layout,x=a.formatter,w=a.inactiveColor,S={x:0,y:0,width:Rh,height:Rh},T={display:i==="horizontal"?"inline-block":"block",marginRight:10},E={display:"inline-block",verticalAlign:"middle",marginRight:4};return c.map(function(D,U){var I=D.formatter||x,V=di(rw(rw({"recharts-legend-item":!0},"legend-item-".concat(U),!0),"inactive",D.inactive));if(D.type==="none")return null;var H=qn(D.value)?null:D.value;qh(!qn(D.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var K=D.inactive?w:D.color;return Le.createElement("li",cI({className:V,style:T,key:"legend-item-".concat(U)},dp(n.props,D,U)),Le.createElement(rI,{width:h,height:h,viewBox:S,style:E},n.renderIcon(D)),Le.createElement("span",{className:"recharts-legend-item-text",style:{color:K}},I?I(H,D,U):H))})}},{key:"render",value:function(){var n=this.props,a=n.payload,c=n.layout,h=n.align;if(!a||!a.length)return null;var i={padding:0,margin:0,textAlign:c==="horizontal"?h:"left"};return Le.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(G.PureComponent);rw($L,"displayName","Legend");rw($L,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var QC,q$;function qSe(){if(q$)return QC;q$=1;var e=rj();function t(){this.__data__=new e,this.size=0}return QC=t,QC}var eE,G$;function GSe(){if(G$)return eE;G$=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return eE=e,eE}var tE,W$;function WSe(){if(W$)return tE;W$=1;function e(t){return this.__data__.get(t)}return tE=e,tE}var rE,H$;function HSe(){if(H$)return rE;H$=1;function e(t){return this.__data__.has(t)}return rE=e,rE}var nE,K$;function KSe(){if(K$)return nE;K$=1;var e=rj(),t=RL(),r=IL(),n=200;function a(c,h){var i=this.__data__;if(i instanceof e){var x=i.__data__;if(!t||x.length<n-1)return x.push([c,h]),this.size=++i.size,this;i=this.__data__=new r(x)}return i.set(c,h),this.size=i.size,this}return nE=a,nE}var iE,Z$;function WJ(){if(Z$)return iE;Z$=1;var e=rj(),t=qSe(),r=GSe(),n=WSe(),a=HSe(),c=KSe();function h(i){var x=this.__data__=new e(i);this.size=x.size}return h.prototype.clear=t,h.prototype.delete=r,h.prototype.get=n,h.prototype.has=a,h.prototype.set=c,iE=h,iE}var aE,Y$;function ZSe(){if(Y$)return aE;Y$=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return aE=t,aE}var sE,X$;function YSe(){if(X$)return sE;X$=1;function e(t){return this.__data__.has(t)}return sE=e,sE}var oE,J$;function HJ(){if(J$)return oE;J$=1;var e=IL(),t=ZSe(),r=YSe();function n(a){var c=-1,h=a==null?0:a.length;for(this.__data__=new e;++c<h;)this.add(a[c])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,oE=n,oE}var lE,Q$;function KJ(){if(Q$)return lE;Q$=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(r(t[n],n,t))return!0;return!1}return lE=e,lE}var cE,e8;function ZJ(){if(e8)return cE;e8=1;function e(t,r){return t.has(r)}return cE=e,cE}var uE,t8;function YJ(){if(t8)return uE;t8=1;var e=HJ(),t=KJ(),r=ZJ(),n=1,a=2;function c(h,i,x,w,S,T){var E=x&n,D=h.length,U=i.length;if(D!=U&&!(E&&U>D))return!1;var I=T.get(h),V=T.get(i);if(I&&V)return I==i&&V==h;var H=-1,K=!0,Q=x&a?new e:void 0;for(T.set(h,i),T.set(i,h);++H<D;){var ae=h[H],ee=i[H];if(w)var se=E?w(ee,ae,H,i,h,T):w(ae,ee,H,h,i,T);if(se!==void 0){if(se)continue;K=!1;break}if(Q){if(!t(i,function(ue,he){if(!r(Q,he)&&(ae===ue||S(ae,ue,x,w,T)))return Q.push(he)})){K=!1;break}}else if(!(ae===ee||S(ae,ee,x,w,T))){K=!1;break}}return T.delete(h),T.delete(i),K}return uE=c,uE}var dE,r8;function XSe(){if(r8)return dE;r8=1;var e=gp(),t=e.Uint8Array;return dE=t,dE}var hE,n8;function JSe(){if(n8)return hE;n8=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a,c){n[++r]=[c,a]}),n}return hE=e,hE}var fE,i8;function qL(){if(i8)return fE;i8=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a){n[++r]=a}),n}return fE=e,fE}var pE,a8;function QSe(){if(a8)return pE;a8=1;var e=m2(),t=XSe(),r=OL(),n=YJ(),a=JSe(),c=qL(),h=1,i=2,x="[object Boolean]",w="[object Date]",S="[object Error]",T="[object Map]",E="[object Number]",D="[object RegExp]",U="[object Set]",I="[object String]",V="[object Symbol]",H="[object ArrayBuffer]",K="[object DataView]",Q=e?e.prototype:void 0,ae=Q?Q.valueOf:void 0;function ee(se,ue,he,Ce,Ne,me,be){switch(he){case K:if(se.byteLength!=ue.byteLength||se.byteOffset!=ue.byteOffset)return!1;se=se.buffer,ue=ue.buffer;case H:return!(se.byteLength!=ue.byteLength||!me(new t(se),new t(ue)));case x:case w:case E:return r(+se,+ue);case S:return se.name==ue.name&&se.message==ue.message;case D:case I:return se==ue+"";case T:var pe=a;case U:var Se=Ce&h;if(pe||(pe=c),se.size!=ue.size&&!Se)return!1;var Ee=be.get(se);if(Ee)return Ee==ue;Ce|=i,be.set(se,ue);var we=n(pe(se),pe(ue),Ce,Ne,me,be);return be.delete(se),we;case V:if(ae)return ae.call(se)==ae.call(ue)}return!1}return pE=ee,pE}var mE,s8;function XJ(){if(s8)return mE;s8=1;function e(t,r){for(var n=-1,a=r.length,c=t.length;++n<a;)t[c+n]=r[n];return t}return mE=e,mE}var gE,o8;function eNe(){if(o8)return gE;o8=1;var e=XJ(),t=nu();function r(n,a,c){var h=a(n);return t(n)?h:e(h,c(n))}return gE=r,gE}var yE,l8;function tNe(){if(l8)return yE;l8=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,c=0,h=[];++n<a;){var i=t[n];r(i,n,t)&&(h[c++]=i)}return h}return yE=e,yE}var xE,c8;function rNe(){if(c8)return xE;c8=1;function e(){return[]}return xE=e,xE}var vE,u8;function nNe(){if(u8)return vE;u8=1;var e=tNe(),t=rNe(),r=Object.prototype,n=r.propertyIsEnumerable,a=Object.getOwnPropertySymbols,c=a?function(h){return h==null?[]:(h=Object(h),e(a(h),function(i){return n.call(h,i)}))}:t;return vE=c,vE}var _E,d8;function iNe(){if(d8)return _E;d8=1;function e(t,r){for(var n=-1,a=Array(t);++n<t;)a[n]=r(n);return a}return _E=e,_E}var bE,h8;function aNe(){if(h8)return bE;h8=1;var e=Mm(),t=Om(),r="[object Arguments]";function n(a){return t(a)&&e(a)==r}return bE=n,bE}var wE,f8;function GL(){if(f8)return wE;f8=1;var e=aNe(),t=Om(),r=Object.prototype,n=r.hasOwnProperty,a=r.propertyIsEnumerable,c=e(function(){return arguments}())?e:function(h){return t(h)&&n.call(h,"callee")&&!a.call(h,"callee")};return wE=c,wE}var a1={exports:{}},SE,p8;function sNe(){if(p8)return SE;p8=1;function e(){return!1}return SE=e,SE}a1.exports;var m8;function JJ(){return m8||(m8=1,function(e,t){var r=gp(),n=sNe(),a=t&&!t.nodeType&&t,c=a&&!0&&e&&!e.nodeType&&e,h=c&&c.exports===a,i=h?r.Buffer:void 0,x=i?i.isBuffer:void 0,w=x||n;e.exports=w}(a1,a1.exports)),a1.exports}var NE,g8;function WL(){if(g8)return NE;g8=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,a){var c=typeof n;return a=a??e,!!a&&(c=="number"||c!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<a}return NE=r,NE}var AE,y8;function HL(){if(y8)return AE;y8=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return AE=t,AE}var TE,x8;function oNe(){if(x8)return TE;x8=1;var e=Mm(),t=HL(),r=Om(),n="[object Arguments]",a="[object Array]",c="[object Boolean]",h="[object Date]",i="[object Error]",x="[object Function]",w="[object Map]",S="[object Number]",T="[object Object]",E="[object RegExp]",D="[object Set]",U="[object String]",I="[object WeakMap]",V="[object ArrayBuffer]",H="[object DataView]",K="[object Float32Array]",Q="[object Float64Array]",ae="[object Int8Array]",ee="[object Int16Array]",se="[object Int32Array]",ue="[object Uint8Array]",he="[object Uint8ClampedArray]",Ce="[object Uint16Array]",Ne="[object Uint32Array]",me={};me[K]=me[Q]=me[ae]=me[ee]=me[se]=me[ue]=me[he]=me[Ce]=me[Ne]=!0,me[n]=me[a]=me[V]=me[c]=me[H]=me[h]=me[i]=me[x]=me[w]=me[S]=me[T]=me[E]=me[D]=me[U]=me[I]=!1;function be(pe){return r(pe)&&t(pe.length)&&!!me[e(pe)]}return TE=be,TE}var jE,v8;function QJ(){if(v8)return jE;v8=1;function e(t){return function(r){return t(r)}}return jE=e,jE}var s1={exports:{}};s1.exports;var _8;function lNe(){return _8||(_8=1,function(e,t){var r=xJ(),n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,c=a&&a.exports===n,h=c&&r.process,i=function(){try{var x=a&&a.require&&a.require("util").types;return x||h&&h.binding&&h.binding("util")}catch{}}();e.exports=i}(s1,s1.exports)),s1.exports}var kE,b8;function eQ(){if(b8)return kE;b8=1;var e=oNe(),t=QJ(),r=lNe(),n=r&&r.isTypedArray,a=n?t(n):e;return kE=a,kE}var PE,w8;function cNe(){if(w8)return PE;w8=1;var e=iNe(),t=GL(),r=nu(),n=JJ(),a=WL(),c=eQ(),h=Object.prototype,i=h.hasOwnProperty;function x(w,S){var T=r(w),E=!T&&t(w),D=!T&&!E&&n(w),U=!T&&!E&&!D&&c(w),I=T||E||D||U,V=I?e(w.length,String):[],H=V.length;for(var K in w)(S||i.call(w,K))&&!(I&&(K=="length"||D&&(K=="offset"||K=="parent")||U&&(K=="buffer"||K=="byteLength"||K=="byteOffset")||a(K,H)))&&V.push(K);return V}return PE=x,PE}var CE,S8;function uNe(){if(S8)return CE;S8=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||e;return r===a}return CE=t,CE}var EE,N8;function tQ(){if(N8)return EE;N8=1;function e(t,r){return function(n){return t(r(n))}}return EE=e,EE}var ME,A8;function dNe(){if(A8)return ME;A8=1;var e=tQ(),t=e(Object.keys,Object);return ME=t,ME}var OE,T8;function hNe(){if(T8)return OE;T8=1;var e=uNe(),t=dNe(),r=Object.prototype,n=r.hasOwnProperty;function a(c){if(!e(c))return t(c);var h=[];for(var i in Object(c))n.call(c,i)&&i!="constructor"&&h.push(i);return h}return OE=a,OE}var RE,j8;function y2(){if(j8)return RE;j8=1;var e=ML(),t=HL();function r(n){return n!=null&&t(n.length)&&!e(n)}return RE=r,RE}var IE,k8;function uj(){if(k8)return IE;k8=1;var e=cNe(),t=hNe(),r=y2();function n(a){return r(a)?e(a):t(a)}return IE=n,IE}var LE,P8;function fNe(){if(P8)return LE;P8=1;var e=eNe(),t=nNe(),r=uj();function n(a){return e(a,r,t)}return LE=n,LE}var DE,C8;function pNe(){if(C8)return DE;C8=1;var e=fNe(),t=1,r=Object.prototype,n=r.hasOwnProperty;function a(c,h,i,x,w,S){var T=i&t,E=e(c),D=E.length,U=e(h),I=U.length;if(D!=I&&!T)return!1;for(var V=D;V--;){var H=E[V];if(!(T?H in h:n.call(h,H)))return!1}var K=S.get(c),Q=S.get(h);if(K&&Q)return K==h&&Q==c;var ae=!0;S.set(c,h),S.set(h,c);for(var ee=T;++V<D;){H=E[V];var se=c[H],ue=h[H];if(x)var he=T?x(ue,se,H,h,c,S):x(se,ue,H,c,h,S);if(!(he===void 0?se===ue||w(se,ue,i,x,S):he)){ae=!1;break}ee||(ee=H=="constructor")}if(ae&&!ee){var Ce=c.constructor,Ne=h.constructor;Ce!=Ne&&"constructor"in c&&"constructor"in h&&!(typeof Ce=="function"&&Ce instanceof Ce&&typeof Ne=="function"&&Ne instanceof Ne)&&(ae=!1)}return S.delete(c),S.delete(h),ae}return DE=a,DE}var FE,E8;function mNe(){if(E8)return FE;E8=1;var e=rx(),t=gp(),r=e(t,"DataView");return FE=r,FE}var zE,M8;function gNe(){if(M8)return zE;M8=1;var e=rx(),t=gp(),r=e(t,"Promise");return zE=r,zE}var BE,O8;function rQ(){if(O8)return BE;O8=1;var e=rx(),t=gp(),r=e(t,"Set");return BE=r,BE}var VE,R8;function yNe(){if(R8)return VE;R8=1;var e=rx(),t=gp(),r=e(t,"WeakMap");return VE=r,VE}var UE,I8;function xNe(){if(I8)return UE;I8=1;var e=mNe(),t=RL(),r=gNe(),n=rQ(),a=yNe(),c=Mm(),h=vJ(),i="[object Map]",x="[object Object]",w="[object Promise]",S="[object Set]",T="[object WeakMap]",E="[object DataView]",D=h(e),U=h(t),I=h(r),V=h(n),H=h(a),K=c;return(e&&K(new e(new ArrayBuffer(1)))!=E||t&&K(new t)!=i||r&&K(r.resolve())!=w||n&&K(new n)!=S||a&&K(new a)!=T)&&(K=function(Q){var ae=c(Q),ee=ae==x?Q.constructor:void 0,se=ee?h(ee):"";if(se)switch(se){case D:return E;case U:return i;case I:return w;case V:return S;case H:return T}return ae}),UE=K,UE}var $E,L8;function vNe(){if(L8)return $E;L8=1;var e=WJ(),t=YJ(),r=QSe(),n=pNe(),a=xNe(),c=nu(),h=JJ(),i=eQ(),x=1,w="[object Arguments]",S="[object Array]",T="[object Object]",E=Object.prototype,D=E.hasOwnProperty;function U(I,V,H,K,Q,ae){var ee=c(I),se=c(V),ue=ee?S:a(I),he=se?S:a(V);ue=ue==w?T:ue,he=he==w?T:he;var Ce=ue==T,Ne=he==T,me=ue==he;if(me&&h(I)){if(!h(V))return!1;ee=!0,Ce=!1}if(me&&!Ce)return ae||(ae=new e),ee||i(I)?t(I,V,H,K,Q,ae):r(I,V,ue,H,K,Q,ae);if(!(H&x)){var be=Ce&&D.call(I,"__wrapped__"),pe=Ne&&D.call(V,"__wrapped__");if(be||pe){var Se=be?I.value():I,Ee=pe?V.value():V;return ae||(ae=new e),Q(Se,Ee,H,K,ae)}}return me?(ae||(ae=new e),n(I,V,H,K,Q,ae)):!1}return $E=U,$E}var qE,D8;function KL(){if(D8)return qE;D8=1;var e=vNe(),t=Om();function r(n,a,c,h,i){return n===a?!0:n==null||a==null||!t(n)&&!t(a)?n!==n&&a!==a:e(n,a,c,h,r,i)}return qE=r,qE}var GE,F8;function _Ne(){if(F8)return GE;F8=1;var e=WJ(),t=KL(),r=1,n=2;function a(c,h,i,x){var w=i.length,S=w,T=!x;if(c==null)return!S;for(c=Object(c);w--;){var E=i[w];if(T&&E[2]?E[1]!==c[E[0]]:!(E[0]in c))return!1}for(;++w<S;){E=i[w];var D=E[0],U=c[D],I=E[1];if(T&&E[2]){if(U===void 0&&!(D in c))return!1}else{var V=new e;if(x)var H=x(U,I,D,c,h,V);if(!(H===void 0?t(I,U,r|n,x,V):H))return!1}}return!0}return GE=a,GE}var WE,z8;function nQ(){if(z8)return WE;z8=1;var e=dy();function t(r){return r===r&&!e(r)}return WE=t,WE}var HE,B8;function bNe(){if(B8)return HE;B8=1;var e=nQ(),t=uj();function r(n){for(var a=t(n),c=a.length;c--;){var h=a[c],i=n[h];a[c]=[h,i,e(i)]}return a}return HE=r,HE}var KE,V8;function iQ(){if(V8)return KE;V8=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return KE=e,KE}var ZE,U8;function wNe(){if(U8)return ZE;U8=1;var e=_Ne(),t=bNe(),r=iQ();function n(a){var c=t(a);return c.length==1&&c[0][2]?r(c[0][0],c[0][1]):function(h){return h===a||e(h,a,c)}}return ZE=n,ZE}var YE,$8;function SNe(){if($8)return YE;$8=1;function e(t,r){return t!=null&&r in Object(t)}return YE=e,YE}var XE,q8;function NNe(){if(q8)return XE;q8=1;var e=wJ(),t=GL(),r=nu(),n=WL(),a=HL(),c=ij();function h(i,x,w){x=e(x,i);for(var S=-1,T=x.length,E=!1;++S<T;){var D=c(x[S]);if(!(E=i!=null&&w(i,D)))break;i=i[D]}return E||++S!=T?E:(T=i==null?0:i.length,!!T&&a(T)&&n(D,T)&&(r(i)||t(i)))}return XE=h,XE}var JE,G8;function ANe(){if(G8)return JE;G8=1;var e=SNe(),t=NNe();function r(n,a){return n!=null&&t(n,a,e)}return JE=r,JE}var QE,W8;function TNe(){if(W8)return QE;W8=1;var e=KL(),t=SJ(),r=ANe(),n=EL(),a=nQ(),c=iQ(),h=ij(),i=1,x=2;function w(S,T){return n(S)&&a(T)?c(h(S),T):function(E){var D=t(E,S);return D===void 0&&D===T?r(E,S):e(T,D,i|x)}}return QE=w,QE}var eM,H8;function M_(){if(H8)return eM;H8=1;function e(t){return t}return eM=e,eM}var tM,K8;function jNe(){if(K8)return tM;K8=1;function e(t){return function(r){return r==null?void 0:r[t]}}return tM=e,tM}var rM,Z8;function kNe(){if(Z8)return rM;Z8=1;var e=DL();function t(r){return function(n){return e(n,r)}}return rM=t,rM}var nM,Y8;function PNe(){if(Y8)return nM;Y8=1;var e=jNe(),t=kNe(),r=EL(),n=ij();function a(c){return r(c)?e(n(c)):t(c)}return nM=a,nM}var iM,X8;function yp(){if(X8)return iM;X8=1;var e=wNe(),t=TNe(),r=M_(),n=nu(),a=PNe();function c(h){return typeof h=="function"?h:h==null?r:typeof h=="object"?n(h)?t(h[0],h[1]):e(h):a(h)}return iM=c,iM}var aM,J8;function aQ(){if(J8)return aM;J8=1;function e(t,r,n,a){for(var c=t.length,h=n+(a?1:-1);a?h--:++h<c;)if(r(t[h],h,t))return h;return-1}return aM=e,aM}var sM,Q8;function CNe(){if(Q8)return sM;Q8=1;function e(t){return t!==t}return sM=e,sM}var oM,e7;function ENe(){if(e7)return oM;e7=1;function e(t,r,n){for(var a=n-1,c=t.length;++a<c;)if(t[a]===r)return a;return-1}return oM=e,oM}var lM,t7;function MNe(){if(t7)return lM;t7=1;var e=aQ(),t=CNe(),r=ENe();function n(a,c,h){return c===c?r(a,c,h):e(a,t,h)}return lM=n,lM}var cM,r7;function ONe(){if(r7)return cM;r7=1;var e=MNe();function t(r,n){var a=r==null?0:r.length;return!!a&&e(r,n,0)>-1}return cM=t,cM}var uM,n7;function RNe(){if(n7)return uM;n7=1;function e(t,r,n){for(var a=-1,c=t==null?0:t.length;++a<c;)if(n(r,t[a]))return!0;return!1}return uM=e,uM}var dM,i7;function INe(){if(i7)return dM;i7=1;function e(){}return dM=e,dM}var hM,a7;function LNe(){if(a7)return hM;a7=1;var e=rQ(),t=INe(),r=qL(),n=1/0,a=e&&1/r(new e([,-0]))[1]==n?function(c){return new e(c)}:t;return hM=a,hM}var fM,s7;function DNe(){if(s7)return fM;s7=1;var e=HJ(),t=ONe(),r=RNe(),n=ZJ(),a=LNe(),c=qL(),h=200;function i(x,w,S){var T=-1,E=t,D=x.length,U=!0,I=[],V=I;if(S)U=!1,E=r;else if(D>=h){var H=w?null:a(x);if(H)return c(H);U=!1,E=n,V=new e}else V=w?[]:I;e:for(;++T<D;){var K=x[T],Q=w?w(K):K;if(K=S||K!==0?K:0,U&&Q===Q){for(var ae=V.length;ae--;)if(V[ae]===Q)continue e;w&&V.push(Q),I.push(K)}else E(V,Q,S)||(V!==I&&V.push(Q),I.push(K))}return I}return fM=i,fM}var pM,o7;function FNe(){if(o7)return pM;o7=1;var e=yp(),t=DNe();function r(n,a){return n&&n.length?t(n,e(a,2)):[]}return pM=r,pM}var zNe=FNe();const l7=ha(zNe);function sQ(e,t,r){return t===!0?l7(e,r):qn(t)?l7(e,t):e}function Dv(e){"@babel/helpers - typeof";return Dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dv(e)}var BNe=["ref"];function c7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function om(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c7(Object(r),!0).forEach(function(n){dj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lQ(n.key),n)}}function UNe(e,t,r){return t&&u7(e.prototype,t),r&&u7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Ne(e,t,r){return t=bA(t),qNe(e,oQ()?Reflect.construct(t,r||[],bA(e).constructor):t.apply(e,r))}function qNe(e,t){if(t&&(Dv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GNe(e)}function GNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oQ=function(){return!!e})()}function bA(e){return bA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bA(e)}function WNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dI(e,t)}function dI(e,t){return dI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},dI(e,t)}function dj(e,t,r){return t=lQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lQ(e){var t=HNe(e,"string");return Dv(t)=="symbol"?t:t+""}function HNe(e,t){if(Dv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function KNe(e,t){if(e==null)return{};var r=ZNe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ZNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function YNe(e){return e.value}function XNe(e,t){if(Le.isValidElement(e))return Le.cloneElement(e,t);if(typeof e=="function")return Le.createElement(e,t);t.ref;var r=KNe(t,BNe);return Le.createElement($L,r)}var d7=1,Fu=function(e){function t(){var r;VNe(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=$Ne(this,t,[].concat(a)),dj(r,"lastBoundingBox",{width:-1,height:-1}),r}return WNe(t,e),UNe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>d7||Math.abs(a.height-this.lastBoundingBox.height)>d7)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?om({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,c=a.layout,h=a.align,i=a.verticalAlign,x=a.margin,w=a.chartWidth,S=a.chartHeight,T,E;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(h==="center"&&c==="vertical"){var D=this.getBBoxSnapshot();T={left:((w||0)-D.width)/2}}else T=h==="right"?{right:x&&x.right||0}:{left:x&&x.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var U=this.getBBoxSnapshot();E={top:((S||0)-U.height)/2}}else E=i==="bottom"?{bottom:x&&x.bottom||0}:{top:x&&x.top||0};return om(om({},T),E)}},{key:"render",value:function(){var n=this,a=this.props,c=a.content,h=a.width,i=a.height,x=a.wrapperStyle,w=a.payloadUniqBy,S=a.payload,T=om(om({position:"absolute",width:h||"auto",height:i||"auto"},this.getDefaultPosition(x)),x);return Le.createElement("div",{className:"recharts-legend-wrapper",style:T,ref:function(D){n.wrapperNode=D}},XNe(c,om(om({},this.props),{},{payload:sQ(S,w,YNe)})))}}],[{key:"getWithHeight",value:function(n,a){var c=om(om({},this.defaultProps),n.props),h=c.layout;return h==="vertical"&&Dr(n.props.height)?{height:n.props.height}:h==="horizontal"?{width:n.props.width||a}:null}}])}(G.PureComponent);dj(Fu,"displayName","Legend");dj(Fu,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var mM,h7;function JNe(){if(h7)return mM;h7=1;var e=m2(),t=GL(),r=nu(),n=e?e.isConcatSpreadable:void 0;function a(c){return r(c)||t(c)||!!(n&&c&&c[n])}return mM=a,mM}var gM,f7;function cQ(){if(f7)return gM;f7=1;var e=XJ(),t=JNe();function r(n,a,c,h,i){var x=-1,w=n.length;for(c||(c=t),i||(i=[]);++x<w;){var S=n[x];a>0&&c(S)?a>1?r(S,a-1,c,h,i):e(i,S):h||(i[i.length]=S)}return i}return gM=r,gM}var yM,p7;function QNe(){if(p7)return yM;p7=1;function e(t){return function(r,n,a){for(var c=-1,h=Object(r),i=a(r),x=i.length;x--;){var w=i[t?x:++c];if(n(h[w],w,h)===!1)break}return r}}return yM=e,yM}var xM,m7;function eAe(){if(m7)return xM;m7=1;var e=QNe(),t=e();return xM=t,xM}var vM,g7;function uQ(){if(g7)return vM;g7=1;var e=eAe(),t=uj();function r(n,a){return n&&e(n,a,t)}return vM=r,vM}var _M,y7;function tAe(){if(y7)return _M;y7=1;var e=y2();function t(r,n){return function(a,c){if(a==null)return a;if(!e(a))return r(a,c);for(var h=a.length,i=n?h:-1,x=Object(a);(n?i--:++i<h)&&c(x[i],i,x)!==!1;);return a}}return _M=t,_M}var bM,x7;function ZL(){if(x7)return bM;x7=1;var e=uQ(),t=tAe(),r=t(e);return bM=r,bM}var wM,v7;function dQ(){if(v7)return wM;v7=1;var e=ZL(),t=y2();function r(n,a){var c=-1,h=t(n)?Array(n.length):[];return e(n,function(i,x,w){h[++c]=a(i,x,w)}),h}return wM=r,wM}var SM,_7;function rAe(){if(_7)return SM;_7=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return SM=e,SM}var NM,b7;function nAe(){if(b7)return NM;b7=1;var e=P_();function t(r,n){if(r!==n){var a=r!==void 0,c=r===null,h=r===r,i=e(r),x=n!==void 0,w=n===null,S=n===n,T=e(n);if(!w&&!T&&!i&&r>n||i&&x&&S&&!w&&!T||c&&x&&S||!a&&S||!h)return 1;if(!c&&!i&&!T&&r<n||T&&a&&h&&!c&&!i||w&&a&&h||!x&&h||!S)return-1}return 0}return NM=t,NM}var AM,w7;function iAe(){if(w7)return AM;w7=1;var e=nAe();function t(r,n,a){for(var c=-1,h=r.criteria,i=n.criteria,x=h.length,w=a.length;++c<x;){var S=e(h[c],i[c]);if(S){if(c>=w)return S;var T=a[c];return S*(T=="desc"?-1:1)}}return r.index-n.index}return AM=t,AM}var TM,S7;function aAe(){if(S7)return TM;S7=1;var e=LL(),t=DL(),r=yp(),n=dQ(),a=rAe(),c=QJ(),h=iAe(),i=M_(),x=nu();function w(S,T,E){T.length?T=e(T,function(I){return x(I)?function(V){return t(V,I.length===1?I[0]:I)}:I}):T=[i];var D=-1;T=e(T,c(r));var U=n(S,function(I,V,H){var K=e(T,function(Q){return Q(I)});return{criteria:K,index:++D,value:I}});return a(U,function(I,V){return h(I,V,E)})}return TM=w,TM}var jM,N7;function sAe(){if(N7)return jM;N7=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return jM=e,jM}var kM,A7;function oAe(){if(A7)return kM;A7=1;var e=sAe(),t=Math.max;function r(n,a,c){return a=t(a===void 0?n.length-1:a,0),function(){for(var h=arguments,i=-1,x=t(h.length-a,0),w=Array(x);++i<x;)w[i]=h[a+i];i=-1;for(var S=Array(a+1);++i<a;)S[i]=h[i];return S[a]=c(w),e(n,this,S)}}return kM=r,kM}var PM,T7;function lAe(){if(T7)return PM;T7=1;function e(t){return function(){return t}}return PM=e,PM}var CM,j7;function hQ(){if(j7)return CM;j7=1;var e=rx(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return CM=t,CM}var EM,k7;function cAe(){if(k7)return EM;k7=1;var e=lAe(),t=hQ(),r=M_(),n=t?function(a,c){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(c),writable:!0})}:r;return EM=n,EM}var MM,P7;function uAe(){if(P7)return MM;P7=1;var e=800,t=16,r=Date.now;function n(a){var c=0,h=0;return function(){var i=r(),x=t-(i-h);if(h=i,x>0){if(++c>=e)return arguments[0]}else c=0;return a.apply(void 0,arguments)}}return MM=n,MM}var OM,C7;function dAe(){if(C7)return OM;C7=1;var e=cAe(),t=uAe(),r=t(e);return OM=r,OM}var RM,E7;function hAe(){if(E7)return RM;E7=1;var e=M_(),t=oAe(),r=dAe();function n(a,c){return r(t(a,c,e),a+"")}return RM=n,RM}var IM,M7;function hj(){if(M7)return IM;M7=1;var e=OL(),t=y2(),r=WL(),n=dy();function a(c,h,i){if(!n(i))return!1;var x=typeof h;return(x=="number"?t(i)&&r(h,i.length):x=="string"&&h in i)?e(i[h],c):!1}return IM=a,IM}var LM,O7;function fAe(){if(O7)return LM;O7=1;var e=cQ(),t=aAe(),r=hAe(),n=hj(),a=r(function(c,h){if(c==null)return[];var i=h.length;return i>1&&n(c,h[0],h[1])?h=[]:i>2&&n(h[0],h[1],h[2])&&(h=[h[0]]),t(c,e(h,1),[])});return LM=a,LM}var pAe=fAe();const YL=ha(pAe);function nw(e){"@babel/helpers - typeof";return nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nw(e)}function hI(){return hI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hI.apply(this,arguments)}function mAe(e,t){return vAe(e)||xAe(e,t)||yAe(e,t)||gAe()}function gAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yAe(e,t){if(e){if(typeof e=="string")return R7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R7(e,t)}}function R7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,h,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(S){w=!0,a=S}finally{try{if(!x&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function vAe(e){if(Array.isArray(e))return e}function I7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function DM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I7(Object(r),!0).forEach(function(n){_Ae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Ae(e,t,r){return t=bAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bAe(e){var t=wAe(e,"string");return nw(t)=="symbol"?t:t+""}function wAe(e,t){if(nw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(nw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SAe(e){return Array.isArray(e)&&Wo(e[0])&&Wo(e[1])?e.join(" ~ "):e}var NAe=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,c=a===void 0?{}:a,h=t.itemStyle,i=h===void 0?{}:h,x=t.labelStyle,w=x===void 0?{}:x,S=t.payload,T=t.formatter,E=t.itemSorter,D=t.wrapperClassName,U=t.labelClassName,I=t.label,V=t.labelFormatter,H=t.accessibilityLayer,K=H===void 0?!1:H,Q=function(){if(S&&S.length){var be={padding:0,margin:0},pe=(E?YL(S,E):S).map(function(Se,Ee){if(Se.type==="none")return null;var we=DM({display:"block",paddingTop:4,paddingBottom:4,color:Se.color||"#000"},i),Pe=Se.formatter||T||SAe,Me=Se.value,Be=Se.name,Ge=Me,We=Be;if(Pe&&Ge!=null&&We!=null){var tt=Pe(Me,Be,Se,Ee,S);if(Array.isArray(tt)){var nt=mAe(tt,2);Ge=nt[0],We=nt[1]}else Ge=tt}return Le.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(Ee),style:we},Wo(We)?Le.createElement("span",{className:"recharts-tooltip-item-name"},We):null,Wo(We)?Le.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Le.createElement("span",{className:"recharts-tooltip-item-value"},Ge),Le.createElement("span",{className:"recharts-tooltip-item-unit"},Se.unit||""))});return Le.createElement("ul",{className:"recharts-tooltip-item-list",style:be},pe)}return null},ae=DM({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},c),ee=DM({margin:0},w),se=!Yn(I),ue=se?I:"",he=di("recharts-default-tooltip",D),Ce=di("recharts-tooltip-label",U);se&&V&&S!==void 0&&S!==null&&(ue=V(I,S));var Ne=K?{role:"status","aria-live":"assertive"}:{};return Le.createElement("div",hI({className:he,style:ae},Ne),Le.createElement("p",{className:Ce,style:ee},Le.isValidElement(ue)?ue:"".concat(ue)),Q())};function iw(e){"@babel/helpers - typeof";return iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iw(e)}function ZS(e,t,r){return t=AAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AAe(e){var t=TAe(e,"string");return iw(t)=="symbol"?t:t+""}function TAe(e,t){if(iw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(iw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bb="recharts-tooltip-wrapper",jAe={visibility:"hidden"};function kAe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return di(Bb,ZS(ZS(ZS(ZS({},"".concat(Bb,"-right"),Dr(r)&&t&&Dr(t.x)&&r>=t.x),"".concat(Bb,"-left"),Dr(r)&&t&&Dr(t.x)&&r<t.x),"".concat(Bb,"-bottom"),Dr(n)&&t&&Dr(t.y)&&n>=t.y),"".concat(Bb,"-top"),Dr(n)&&t&&Dr(t.y)&&n<t.y))}function L7(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,c=e.position,h=e.reverseDirection,i=e.tooltipDimension,x=e.viewBox,w=e.viewBoxDimension;if(c&&Dr(c[n]))return c[n];var S=r[n]-i-a,T=r[n]+a;if(t[n])return h[n]?S:T;if(h[n]){var E=S,D=x[n];return E<D?Math.max(T,x[n]):Math.max(S,x[n])}var U=T+i,I=x[n]+w;return U>I?Math.max(S,x[n]):Math.max(T,x[n])}function PAe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function CAe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,c=e.reverseDirection,h=e.tooltipBox,i=e.useTranslate3d,x=e.viewBox,w,S,T;return h.height>0&&h.width>0&&r?(S=L7({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:c,tooltipDimension:h.width,viewBox:x,viewBoxDimension:x.width}),T=L7({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:c,tooltipDimension:h.height,viewBox:x,viewBoxDimension:x.height}),w=PAe({translateX:S,translateY:T,useTranslate3d:i})):w=jAe,{cssProperties:w,cssClasses:kAe({translateX:S,translateY:T,coordinate:r})}}function Fv(e){"@babel/helpers - typeof";return Fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fv(e)}function D7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function F7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D7(Object(r),!0).forEach(function(n){pI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MAe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pQ(n.key),n)}}function OAe(e,t,r){return t&&MAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function RAe(e,t,r){return t=wA(t),IAe(e,fQ()?Reflect.construct(t,r||[],wA(e).constructor):t.apply(e,r))}function IAe(e,t){if(t&&(Fv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LAe(e)}function LAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fQ=function(){return!!e})()}function wA(e){return wA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wA(e)}function DAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fI(e,t)}function fI(e,t){return fI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},fI(e,t)}function pI(e,t,r){return t=pQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pQ(e){var t=FAe(e,"string");return Fv(t)=="symbol"?t:t+""}function FAe(e,t){if(Fv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Fv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var z7=1,zAe=function(e){function t(){var r;EAe(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=RAe(this,t,[].concat(a)),pI(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),pI(r,"handleKeyDown",function(h){if(h.key==="Escape"){var i,x,w,S;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(x=r.props.coordinate)===null||x===void 0?void 0:x.x)!==null&&i!==void 0?i:0,y:(w=(S=r.props.coordinate)===null||S===void 0?void 0:S.y)!==null&&w!==void 0?w:0}})}}),r}return DAe(t,e),OAe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>z7||Math.abs(n.height-this.state.lastBoundingBox.height)>z7)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,c=a.active,h=a.allowEscapeViewBox,i=a.animationDuration,x=a.animationEasing,w=a.children,S=a.coordinate,T=a.hasPayload,E=a.isAnimationActive,D=a.offset,U=a.position,I=a.reverseDirection,V=a.useTranslate3d,H=a.viewBox,K=a.wrapperStyle,Q=CAe({allowEscapeViewBox:h,coordinate:S,offsetTopLeft:D,position:U,reverseDirection:I,tooltipBox:this.state.lastBoundingBox,useTranslate3d:V,viewBox:H}),ae=Q.cssClasses,ee=Q.cssProperties,se=F7(F7({transition:E&&c?"transform ".concat(i,"ms ").concat(x):void 0},ee),{},{pointerEvents:"none",visibility:!this.state.dismissed&&c&&T?"visible":"hidden",position:"absolute",top:0,left:0},K);return Le.createElement("div",{tabIndex:-1,className:ae,style:se,ref:function(he){n.wrapperNode=he}},w)}}])}(G.PureComponent),BAe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},xp={isSsr:BAe()};function zv(e){"@babel/helpers - typeof";return zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zv(e)}function B7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function V7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B7(Object(r),!0).forEach(function(n){XL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UAe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gQ(n.key),n)}}function $Ae(e,t,r){return t&&UAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qAe(e,t,r){return t=SA(t),GAe(e,mQ()?Reflect.construct(t,r||[],SA(e).constructor):t.apply(e,r))}function GAe(e,t){if(t&&(zv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WAe(e)}function WAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mQ=function(){return!!e})()}function SA(e){return SA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},SA(e)}function HAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mI(e,t)}function mI(e,t){return mI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},mI(e,t)}function XL(e,t,r){return t=gQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gQ(e){var t=KAe(e,"string");return zv(t)=="symbol"?t:t+""}function KAe(e,t){if(zv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function ZAe(e){return e.dataKey}function YAe(e,t){return Le.isValidElement(e)?Le.cloneElement(e,t):typeof e=="function"?Le.createElement(e,t):Le.createElement(NAe,t)}var zi=function(e){function t(){return VAe(this,t),qAe(this,t,arguments)}return HAe(t,e),$Ae(t,[{key:"render",value:function(){var n=this,a=this.props,c=a.active,h=a.allowEscapeViewBox,i=a.animationDuration,x=a.animationEasing,w=a.content,S=a.coordinate,T=a.filterNull,E=a.isAnimationActive,D=a.offset,U=a.payload,I=a.payloadUniqBy,V=a.position,H=a.reverseDirection,K=a.useTranslate3d,Q=a.viewBox,ae=a.wrapperStyle,ee=U??[];T&&ee.length&&(ee=sQ(U.filter(function(ue){return ue.value!=null&&(ue.hide!==!0||n.props.includeHidden)}),I,ZAe));var se=ee.length>0;return Le.createElement(zAe,{allowEscapeViewBox:h,animationDuration:i,animationEasing:x,isAnimationActive:E,active:c,coordinate:S,hasPayload:se,offset:D,position:V,reverseDirection:H,useTranslate3d:K,viewBox:Q,wrapperStyle:ae},YAe(w,V7(V7({},this.props),{},{payload:ee})))}}])}(G.PureComponent);XL(zi,"displayName","Tooltip");XL(zi,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!xp.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var FM,U7;function XAe(){if(U7)return FM;U7=1;var e=gp(),t=function(){return e.Date.now()};return FM=t,FM}var zM,$7;function JAe(){if($7)return zM;$7=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return zM=t,zM}var BM,q7;function QAe(){if(q7)return BM;q7=1;var e=JAe(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return BM=r,BM}var VM,G7;function yQ(){if(G7)return VM;G7=1;var e=QAe(),t=dy(),r=P_(),n=NaN,a=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,h=/^0o[0-7]+$/i,i=parseInt;function x(w){if(typeof w=="number")return w;if(r(w))return n;if(t(w)){var S=typeof w.valueOf=="function"?w.valueOf():w;w=t(S)?S+"":S}if(typeof w!="string")return w===0?w:+w;w=e(w);var T=c.test(w);return T||h.test(w)?i(w.slice(2),T?2:8):a.test(w)?n:+w}return VM=x,VM}var UM,W7;function eTe(){if(W7)return UM;W7=1;var e=dy(),t=XAe(),r=yQ(),n="Expected a function",a=Math.max,c=Math.min;function h(i,x,w){var S,T,E,D,U,I,V=0,H=!1,K=!1,Q=!0;if(typeof i!="function")throw new TypeError(n);x=r(x)||0,e(w)&&(H=!!w.leading,K="maxWait"in w,E=K?a(r(w.maxWait)||0,x):E,Q="trailing"in w?!!w.trailing:Q);function ae(pe){var Se=S,Ee=T;return S=T=void 0,V=pe,D=i.apply(Ee,Se),D}function ee(pe){return V=pe,U=setTimeout(he,x),H?ae(pe):D}function se(pe){var Se=pe-I,Ee=pe-V,we=x-Se;return K?c(we,E-Ee):we}function ue(pe){var Se=pe-I,Ee=pe-V;return I===void 0||Se>=x||Se<0||K&&Ee>=E}function he(){var pe=t();if(ue(pe))return Ce(pe);U=setTimeout(he,se(pe))}function Ce(pe){return U=void 0,Q&&S?ae(pe):(S=T=void 0,D)}function Ne(){U!==void 0&&clearTimeout(U),V=0,S=I=T=U=void 0}function me(){return U===void 0?D:Ce(t())}function be(){var pe=t(),Se=ue(pe);if(S=arguments,T=this,I=pe,Se){if(U===void 0)return ee(I);if(K)return clearTimeout(U),U=setTimeout(he,x),ae(I)}return U===void 0&&(U=setTimeout(he,x)),D}return be.cancel=Ne,be.flush=me,be}return UM=h,UM}var $M,H7;function tTe(){if(H7)return $M;H7=1;var e=eTe(),t=dy(),r="Expected a function";function n(a,c,h){var i=!0,x=!0;if(typeof a!="function")throw new TypeError(r);return t(h)&&(i="leading"in h?!!h.leading:i,x="trailing"in h?!!h.trailing:x),e(a,c,{leading:i,maxWait:c,trailing:x})}return $M=n,$M}var rTe=tTe();const xQ=ha(rTe);function aw(e){"@babel/helpers - typeof";return aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aw(e)}function K7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function YS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K7(Object(r),!0).forEach(function(n){nTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nTe(e,t,r){return t=iTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iTe(e){var t=aTe(e,"string");return aw(t)=="symbol"?t:t+""}function aTe(e,t){if(aw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(aw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sTe(e,t){return uTe(e)||cTe(e,t)||lTe(e,t)||oTe()}function oTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lTe(e,t){if(e){if(typeof e=="string")return Z7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z7(e,t)}}function Z7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,h,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(S){w=!0,a=S}finally{try{if(!x&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function uTe(e){if(Array.isArray(e))return e}var uo=G.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,c=e.width,h=c===void 0?"100%":c,i=e.height,x=i===void 0?"100%":i,w=e.minWidth,S=w===void 0?0:w,T=e.minHeight,E=e.maxHeight,D=e.children,U=e.debounce,I=U===void 0?0:U,V=e.id,H=e.className,K=e.onResize,Q=e.style,ae=Q===void 0?{}:Q,ee=G.useRef(null),se=G.useRef();se.current=K,G.useImperativeHandle(t,function(){return Object.defineProperty(ee.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),ee.current},configurable:!0})});var ue=G.useState({containerWidth:a.width,containerHeight:a.height}),he=sTe(ue,2),Ce=he[0],Ne=he[1],me=G.useCallback(function(pe,Se){Ne(function(Ee){var we=Math.round(pe),Pe=Math.round(Se);return Ee.containerWidth===we&&Ee.containerHeight===Pe?Ee:{containerWidth:we,containerHeight:Pe}})},[]);G.useEffect(function(){var pe=function(Be){var Ge,We=Be[0].contentRect,tt=We.width,nt=We.height;me(tt,nt),(Ge=se.current)===null||Ge===void 0||Ge.call(se,tt,nt)};I>0&&(pe=xQ(pe,I,{trailing:!0,leading:!1}));var Se=new ResizeObserver(pe),Ee=ee.current.getBoundingClientRect(),we=Ee.width,Pe=Ee.height;return me(we,Pe),Se.observe(ee.current),function(){Se.disconnect()}},[me,I]);var be=G.useMemo(function(){var pe=Ce.containerWidth,Se=Ce.containerHeight;if(pe<0||Se<0)return null;qh(j0(h)||j0(x),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,h,x),qh(!r||r>0,"The aspect(%s) must be greater than zero.",r);var Ee=j0(h)?pe:h,we=j0(x)?Se:x;r&&r>0&&(Ee?we=Ee/r:we&&(Ee=we*r),E&&we>E&&(we=E)),qh(Ee>0||we>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Ee,we,h,x,S,T,r);var Pe=!Array.isArray(D)&&_m(D.type).endsWith("Chart");return Le.Children.map(D,function(Me){return Le.isValidElement(Me)?G.cloneElement(Me,YS({width:Ee,height:we},Pe?{style:YS({height:"100%",width:"100%",maxHeight:we,maxWidth:Ee},Me.props.style)}:{})):Me})},[r,D,x,E,T,S,Ce,h]);return Le.createElement("div",{id:V?"".concat(V):void 0,className:di("recharts-responsive-container",H),style:YS(YS({},ae),{},{width:h,height:x,minWidth:S,minHeight:T,maxHeight:E}),ref:ee},be)}),Jh=function(t){return null};Jh.displayName="Cell";function sw(e){"@babel/helpers - typeof";return sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sw(e)}function Y7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y7(Object(r),!0).forEach(function(n){dTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dTe(e,t,r){return t=hTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hTe(e){var t=fTe(e,"string");return sw(t)=="symbol"?t:t+""}function fTe(e,t){if(sw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(sw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ev={widthCache:{},cacheCount:0},pTe=2e3,mTe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},X7="recharts_measurement_span";function gTe(e){var t=gI({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var g1=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||xp.isSsr)return{width:0,height:0};var n=gTe(r),a=JSON.stringify({text:t,copyStyle:n});if(ev.widthCache[a])return ev.widthCache[a];try{var c=document.getElementById(X7);c||(c=document.createElement("span"),c.setAttribute("id",X7),c.setAttribute("aria-hidden","true"),document.body.appendChild(c));var h=gI(gI({},mTe),n);Object.assign(c.style,h),c.textContent="".concat(t);var i=c.getBoundingClientRect(),x={width:i.width,height:i.height};return ev.widthCache[a]=x,++ev.cacheCount>pTe&&(ev.cacheCount=0,ev.widthCache={}),x}catch{return{width:0,height:0}}},yTe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function ow(e){"@babel/helpers - typeof";return ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ow(e)}function NA(e,t){return bTe(e)||_Te(e,t)||vTe(e,t)||xTe()}function xTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vTe(e,t){if(e){if(typeof e=="string")return J7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J7(e,t)}}function J7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Te(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,h,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;x=!1}else for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(S){w=!0,a=S}finally{try{if(!x&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function bTe(e){if(Array.isArray(e))return e}function wTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NTe(n.key),n)}}function STe(e,t,r){return t&&Q7(e.prototype,t),r&&Q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NTe(e){var t=ATe(e,"string");return ow(t)=="symbol"?t:t+""}function ATe(e,t){if(ow(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ow(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var e9=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,t9=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,TTe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,jTe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,vQ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},kTe=Object.keys(vQ),pv="NaN";function PTe(e,t){return e*vQ[t]}var XS=function(){function e(t,r){wTe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!TTe.test(r)&&(this.num=NaN,this.unit=""),kTe.includes(r)&&(this.num=PTe(t,r),this.unit="px")}return STe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=jTe.exec(r))!==null&&n!==void 0?n:[],c=NA(a,3),h=c[1],i=c[2];return new e(parseFloat(h),i??"")}}])}();function _Q(e){if(e.includes(pv))return pv;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=e9.exec(t))!==null&&r!==void 0?r:[],a=NA(n,4),c=a[1],h=a[2],i=a[3],x=XS.parse(c??""),w=XS.parse(i??""),S=h==="*"?x.multiply(w):x.divide(w);if(S.isNaN())return pv;t=t.replace(e9,S.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var T,E=(T=t9.exec(t))!==null&&T!==void 0?T:[],D=NA(E,4),U=D[1],I=D[2],V=D[3],H=XS.parse(U??""),K=XS.parse(V??""),Q=I==="+"?H.add(K):H.subtract(K);if(Q.isNaN())return pv;t=t.replace(t9,Q.toString())}return t}var r9=/\(([^()]*)\)/;function CTe(e){for(var t=e;t.includes("(");){var r=r9.exec(t),n=NA(r,2),a=n[1];t=t.replace(r9,_Q(a))}return t}function ETe(e){var t=e.replace(/\s+/g,"");return t=CTe(t),t=_Q(t),t}function MTe(e){try{return ETe(e)}catch{return pv}}function qM(e){var t=MTe(e.slice(5,-1));return t===pv?"":t}var OTe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],RTe=["dx","dy","angle","className","breakAll"];function yI(){return yI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yI.apply(this,arguments)}function n9(e,t){if(e==null)return{};var r=ITe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ITe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function i9(e,t){return zTe(e)||FTe(e,t)||DTe(e,t)||LTe()}function LTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DTe(e,t){if(e){if(typeof e=="string")return a9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a9(e,t)}}function a9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,h,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;x=!1}else for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(S){w=!0,a=S}finally{try{if(!x&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function zTe(e){if(Array.isArray(e))return e}var bQ=/[ \f\n\r\t\v\u2028\u2029]+/,wQ=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var c=[];Yn(r)||(n?c=r.toString().split(""):c=r.toString().split(bQ));var h=c.map(function(x){return{word:x,width:g1(x,a).width}}),i=n?0:g1("",a).width;return{wordsWithComputedWidth:h,spaceWidth:i}}catch{return null}},BTe=function(t,r,n,a,c){var h=t.maxLines,i=t.children,x=t.style,w=t.breakAll,S=Dr(h),T=i,E=function(){var Ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Ee.reduce(function(we,Pe){var Me=Pe.word,Be=Pe.width,Ge=we[we.length-1];if(Ge&&(a==null||c||Ge.width+Be+n<Number(a)))Ge.words.push(Me),Ge.width+=Be+n;else{var We={words:[Me],width:Be};we.push(We)}return we},[])},D=E(r),U=function(Ee){return Ee.reduce(function(we,Pe){return we.width>Pe.width?we:Pe})};if(!S)return D;for(var I="",V=function(Ee){var we=T.slice(0,Ee),Pe=wQ({breakAll:w,style:x,children:we+I}).wordsWithComputedWidth,Me=E(Pe),Be=Me.length>h||U(Me).width>Number(a);return[Be,Me]},H=0,K=T.length-1,Q=0,ae;H<=K&&Q<=T.length-1;){var ee=Math.floor((H+K)/2),se=ee-1,ue=V(se),he=i9(ue,2),Ce=he[0],Ne=he[1],me=V(ee),be=i9(me,1),pe=be[0];if(!Ce&&!pe&&(H=ee+1),Ce&&pe&&(K=ee-1),!Ce&&pe){ae=Ne;break}Q++}return ae||D},s9=function(t){var r=Yn(t)?[]:t.toString().split(bQ);return[{words:r}]},VTe=function(t){var r=t.width,n=t.scaleToFit,a=t.children,c=t.style,h=t.breakAll,i=t.maxLines;if((r||n)&&!xp.isSsr){var x,w,S=wQ({breakAll:h,children:a,style:c});if(S){var T=S.wordsWithComputedWidth,E=S.spaceWidth;x=T,w=E}else return s9(a);return BTe({breakAll:h,children:a,maxLines:i,style:c},x,w,r,n)}return s9(a)},o9="#808080",W0=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,c=a===void 0?0:a,h=t.lineHeight,i=h===void 0?"1em":h,x=t.capHeight,w=x===void 0?"0.71em":x,S=t.scaleToFit,T=S===void 0?!1:S,E=t.textAnchor,D=E===void 0?"start":E,U=t.verticalAnchor,I=U===void 0?"end":U,V=t.fill,H=V===void 0?o9:V,K=n9(t,OTe),Q=G.useMemo(function(){return VTe({breakAll:K.breakAll,children:K.children,maxLines:K.maxLines,scaleToFit:T,style:K.style,width:K.width})},[K.breakAll,K.children,K.maxLines,T,K.style,K.width]),ae=K.dx,ee=K.dy,se=K.angle,ue=K.className,he=K.breakAll,Ce=n9(K,RTe);if(!Wo(n)||!Wo(c))return null;var Ne=n+(Dr(ae)?ae:0),me=c+(Dr(ee)?ee:0),be;switch(I){case"start":be=qM("calc(".concat(w,")"));break;case"middle":be=qM("calc(".concat((Q.length-1)/2," * -").concat(i," + (").concat(w," / 2))"));break;default:be=qM("calc(".concat(Q.length-1," * -").concat(i,")"));break}var pe=[];if(T){var Se=Q[0].width,Ee=K.width;pe.push("scale(".concat((Dr(Ee)?Ee/Se:1)/Se,")"))}return se&&pe.push("rotate(".concat(se,", ").concat(Ne,", ").concat(me,")")),pe.length&&(Ce.transform=pe.join(" ")),Le.createElement("text",yI({},wn(Ce,!0),{x:Ne,y:me,className:di("recharts-text",ue),textAnchor:D,fill:H.includes("url")?o9:H}),Q.map(function(we,Pe){var Me=we.words.join(he?"":" ");return Le.createElement("tspan",{x:Ne,dy:Pe===0?be:i,key:"".concat(Me,"-").concat(Pe)},Me)}))};function Zg(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function UTe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function JL(e){let t,r,n;e.length!==2?(t=Zg,r=(i,x)=>Zg(e(i),x),n=(i,x)=>e(i)-x):(t=e===Zg||e===UTe?e:$Te,r=e,n=e);function a(i,x,w=0,S=i.length){if(w<S){if(t(x,x)!==0)return S;do{const T=w+S>>>1;r(i[T],x)<0?w=T+1:S=T}while(w<S)}return w}function c(i,x,w=0,S=i.length){if(w<S){if(t(x,x)!==0)return S;do{const T=w+S>>>1;r(i[T],x)<=0?w=T+1:S=T}while(w<S)}return w}function h(i,x,w=0,S=i.length){const T=a(i,x,w,S-1);return T>w&&n(i[T-1],x)>-n(i[T],x)?T-1:T}return{left:a,center:h,right:c}}function $Te(){return 0}function SQ(e){return e===null?NaN:+e}function*qTe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const GTe=JL(Zg),x2=GTe.right;JL(SQ).center;class l9 extends Map{constructor(t,r=KTe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(c9(this,t))}has(t){return super.has(c9(this,t))}set(t,r){return super.set(WTe(this,t),r)}delete(t){return super.delete(HTe(this,t))}}function c9({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function WTe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function HTe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function KTe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function ZTe(e=Zg){if(e===Zg)return NQ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function NQ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const YTe=Math.sqrt(50),XTe=Math.sqrt(10),JTe=Math.sqrt(2);function AA(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),c=n/Math.pow(10,a),h=c>=YTe?10:c>=XTe?5:c>=JTe?2:1;let i,x,w;return a<0?(w=Math.pow(10,-a)/h,i=Math.round(e*w),x=Math.round(t*w),i/w<e&&++i,x/w>t&&--x,w=-w):(w=Math.pow(10,a)*h,i=Math.round(e/w),x=Math.round(t/w),i*w<e&&++i,x*w>t&&--x),x<i&&.5<=r&&r<2?AA(e,t,r*2):[i,x,w]}function xI(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,c,h]=n?AA(t,e,r):AA(e,t,r);if(!(c>=a))return[];const i=c-a+1,x=new Array(i);if(n)if(h<0)for(let w=0;w<i;++w)x[w]=(c-w)/-h;else for(let w=0;w<i;++w)x[w]=(c-w)*h;else if(h<0)for(let w=0;w<i;++w)x[w]=(a+w)/-h;else for(let w=0;w<i;++w)x[w]=(a+w)*h;return x}function vI(e,t,r){return t=+t,e=+e,r=+r,AA(e,t,r)[2]}function _I(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?vI(t,e,r):vI(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function u9(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function d9(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function AQ(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?NQ:ZTe(a);n>r;){if(n-r>600){const x=n-r+1,w=t-r+1,S=Math.log(x),T=.5*Math.exp(2*S/3),E=.5*Math.sqrt(S*T*(x-T)/x)*(w-x/2<0?-1:1),D=Math.max(r,Math.floor(t-w*T/x+E)),U=Math.min(n,Math.floor(t+(x-w)*T/x+E));AQ(e,t,D,U,a)}const c=e[t];let h=r,i=n;for(Vb(e,r,t),a(e[n],c)>0&&Vb(e,r,n);h<i;){for(Vb(e,h,i),++h,--i;a(e[h],c)<0;)++h;for(;a(e[i],c)>0;)--i}a(e[r],c)===0?Vb(e,r,i):(++i,Vb(e,i,n)),i<=t&&(r=i+1),t<=i&&(n=i-1)}return e}function Vb(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function QTe(e,t,r){if(e=Float64Array.from(qTe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return d9(e);if(t>=1)return u9(e);var n,a=(n-1)*t,c=Math.floor(a),h=u9(AQ(e,c).subarray(0,c+1)),i=d9(e.subarray(c+1));return h+(i-h)*(a-c)}}function eje(e,t,r=SQ){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,c=Math.floor(a),h=+r(e[c],c,e),i=+r(e[c+1],c+1,e);return h+(i-h)*(a-c)}}function tje(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,c=new Array(a);++n<a;)c[n]=e+n*r;return c}function Gd(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Rm(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const bI=Symbol("implicit");function QL(){var e=new l9,t=[],r=[],n=bI;function a(c){let h=e.get(c);if(h===void 0){if(n!==bI)return n;e.set(c,h=t.push(c)-1)}return r[h%r.length]}return a.domain=function(c){if(!arguments.length)return t.slice();t=[],e=new l9;for(const h of c)e.has(h)||e.set(h,t.push(h)-1);return a},a.range=function(c){return arguments.length?(r=Array.from(c),a):r.slice()},a.unknown=function(c){return arguments.length?(n=c,a):n},a.copy=function(){return QL(t,r).unknown(n)},Gd.apply(a,arguments),a}function lw(){var e=QL().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,c,h,i=!1,x=0,w=0,S=.5;delete e.unknown;function T(){var E=t().length,D=a<n,U=D?a:n,I=D?n:a;c=(I-U)/Math.max(1,E-x+w*2),i&&(c=Math.floor(c)),U+=(I-U-c*(E-x))*S,h=c*(1-x),i&&(U=Math.round(U),h=Math.round(h));var V=tje(E).map(function(H){return U+c*H});return r(D?V.reverse():V)}return e.domain=function(E){return arguments.length?(t(E),T()):t()},e.range=function(E){return arguments.length?([n,a]=E,n=+n,a=+a,T()):[n,a]},e.rangeRound=function(E){return[n,a]=E,n=+n,a=+a,i=!0,T()},e.bandwidth=function(){return h},e.step=function(){return c},e.round=function(E){return arguments.length?(i=!!E,T()):i},e.padding=function(E){return arguments.length?(x=Math.min(1,w=+E),T()):x},e.paddingInner=function(E){return arguments.length?(x=Math.min(1,E),T()):x},e.paddingOuter=function(E){return arguments.length?(w=+E,T()):w},e.align=function(E){return arguments.length?(S=Math.max(0,Math.min(1,E)),T()):S},e.copy=function(){return lw(t(),[n,a]).round(i).paddingInner(x).paddingOuter(w).align(S)},Gd.apply(T(),arguments)}function TQ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return TQ(t())},e}function y1(){return TQ(lw.apply(null,arguments).paddingInner(1))}function eD(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function jQ(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function v2(){}var cw=.7,TA=1/cw,Nv="\\s*([+-]?\\d+)\\s*",uw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",rp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",rje=/^#([0-9a-f]{3,8})$/,nje=new RegExp(`^rgb\\(${Nv},${Nv},${Nv}\\)$`),ije=new RegExp(`^rgb\\(${rp},${rp},${rp}\\)$`),aje=new RegExp(`^rgba\\(${Nv},${Nv},${Nv},${uw}\\)$`),sje=new RegExp(`^rgba\\(${rp},${rp},${rp},${uw}\\)$`),oje=new RegExp(`^hsl\\(${uw},${rp},${rp}\\)$`),lje=new RegExp(`^hsla\\(${uw},${rp},${rp},${uw}\\)$`),h9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};eD(v2,dw,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:f9,formatHex:f9,formatHex8:cje,formatHsl:uje,formatRgb:p9,toString:p9});function f9(){return this.rgb().formatHex()}function cje(){return this.rgb().formatHex8()}function uje(){return kQ(this).formatHsl()}function p9(){return this.rgb().formatRgb()}function dw(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=rje.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?m9(t):r===3?new Jc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?JS(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?JS(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=nje.exec(e))?new Jc(t[1],t[2],t[3],1):(t=ije.exec(e))?new Jc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=aje.exec(e))?JS(t[1],t[2],t[3],t[4]):(t=sje.exec(e))?JS(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=oje.exec(e))?x9(t[1],t[2]/100,t[3]/100,1):(t=lje.exec(e))?x9(t[1],t[2]/100,t[3]/100,t[4]):h9.hasOwnProperty(e)?m9(h9[e]):e==="transparent"?new Jc(NaN,NaN,NaN,0):null}function m9(e){return new Jc(e>>16&255,e>>8&255,e&255,1)}function JS(e,t,r,n){return n<=0&&(e=t=r=NaN),new Jc(e,t,r,n)}function dje(e){return e instanceof v2||(e=dw(e)),e?(e=e.rgb(),new Jc(e.r,e.g,e.b,e.opacity)):new Jc}function wI(e,t,r,n){return arguments.length===1?dje(e):new Jc(e,t,r,n??1)}function Jc(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}eD(Jc,wI,jQ(v2,{brighter(e){return e=e==null?TA:Math.pow(TA,e),new Jc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?cw:Math.pow(cw,e),new Jc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Jc(I0(this.r),I0(this.g),I0(this.b),jA(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:g9,formatHex:g9,formatHex8:hje,formatRgb:y9,toString:y9}));function g9(){return`#${k0(this.r)}${k0(this.g)}${k0(this.b)}`}function hje(){return`#${k0(this.r)}${k0(this.g)}${k0(this.b)}${k0((isNaN(this.opacity)?1:this.opacity)*255)}`}function y9(){const e=jA(this.opacity);return`${e===1?"rgb(":"rgba("}${I0(this.r)}, ${I0(this.g)}, ${I0(this.b)}${e===1?")":`, ${e})`}`}function jA(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function I0(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function k0(e){return e=I0(e),(e<16?"0":"")+e.toString(16)}function x9(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Vh(e,t,r,n)}function kQ(e){if(e instanceof Vh)return new Vh(e.h,e.s,e.l,e.opacity);if(e instanceof v2||(e=dw(e)),!e)return new Vh;if(e instanceof Vh)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),c=Math.max(t,r,n),h=NaN,i=c-a,x=(c+a)/2;return i?(t===c?h=(r-n)/i+(r<n)*6:r===c?h=(n-t)/i+2:h=(t-r)/i+4,i/=x<.5?c+a:2-c-a,h*=60):i=x>0&&x<1?0:h,new Vh(h,i,x,e.opacity)}function fje(e,t,r,n){return arguments.length===1?kQ(e):new Vh(e,t,r,n??1)}function Vh(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}eD(Vh,fje,jQ(v2,{brighter(e){return e=e==null?TA:Math.pow(TA,e),new Vh(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?cw:Math.pow(cw,e),new Vh(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Jc(GM(e>=240?e-240:e+120,a,n),GM(e,a,n),GM(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Vh(v9(this.h),QS(this.s),QS(this.l),jA(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=jA(this.opacity);return`${e===1?"hsl(":"hsla("}${v9(this.h)}, ${QS(this.s)*100}%, ${QS(this.l)*100}%${e===1?")":`, ${e})`}`}}));function v9(e){return e=(e||0)%360,e<0?e+360:e}function QS(e){return Math.max(0,Math.min(1,e||0))}function GM(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const tD=e=>()=>e;function pje(e,t){return function(r){return e+r*t}}function mje(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function gje(e){return(e=+e)==1?PQ:function(t,r){return r-t?mje(t,r,e):tD(isNaN(t)?r:t)}}function PQ(e,t){var r=t-e;return r?pje(e,r):tD(isNaN(e)?t:e)}const _9=function e(t){var r=gje(t);function n(a,c){var h=r((a=wI(a)).r,(c=wI(c)).r),i=r(a.g,c.g),x=r(a.b,c.b),w=PQ(a.opacity,c.opacity);return function(S){return a.r=h(S),a.g=i(S),a.b=x(S),a.opacity=w(S),a+""}}return n.gamma=e,n}(1);function yje(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(c){for(a=0;a<r;++a)n[a]=e[a]*(1-c)+t[a]*c;return n}}function xje(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function vje(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),c=new Array(r),h;for(h=0;h<n;++h)a[h]=O_(e[h],t[h]);for(;h<r;++h)c[h]=t[h];return function(i){for(h=0;h<n;++h)c[h]=a[h](i);return c}}function _je(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function kA(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function bje(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=O_(e[a],t[a]):n[a]=t[a];return function(c){for(a in r)n[a]=r[a](c);return n}}var SI=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,WM=new RegExp(SI.source,"g");function wje(e){return function(){return e}}function Sje(e){return function(t){return e(t)+""}}function Nje(e,t){var r=SI.lastIndex=WM.lastIndex=0,n,a,c,h=-1,i=[],x=[];for(e=e+"",t=t+"";(n=SI.exec(e))&&(a=WM.exec(t));)(c=a.index)>r&&(c=t.slice(r,c),i[h]?i[h]+=c:i[++h]=c),(n=n[0])===(a=a[0])?i[h]?i[h]+=a:i[++h]=a:(i[++h]=null,x.push({i:h,x:kA(n,a)})),r=WM.lastIndex;return r<t.length&&(c=t.slice(r),i[h]?i[h]+=c:i[++h]=c),i.length<2?x[0]?Sje(x[0].x):wje(t):(t=x.length,function(w){for(var S=0,T;S<t;++S)i[(T=x[S]).i]=T.x(w);return i.join("")})}function O_(e,t){var r=typeof t,n;return t==null||r==="boolean"?tD(t):(r==="number"?kA:r==="string"?(n=dw(t))?(t=n,_9):Nje:t instanceof dw?_9:t instanceof Date?_je:xje(t)?yje:Array.isArray(t)?vje:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?bje:kA)(e,t)}function rD(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Aje(e,t){t===void 0&&(t=e,e=O_);for(var r=0,n=t.length-1,a=t[0],c=new Array(n<0?0:n);r<n;)c[r]=e(a,a=t[++r]);return function(h){var i=Math.max(0,Math.min(n-1,Math.floor(h*=n)));return c[i](h-i)}}function Tje(e){return function(){return e}}function PA(e){return+e}var b9=[0,1];function wc(e){return e}function NI(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Tje(isNaN(t)?NaN:.5)}function jje(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function kje(e,t,r){var n=e[0],a=e[1],c=t[0],h=t[1];return a<n?(n=NI(a,n),c=r(h,c)):(n=NI(n,a),c=r(c,h)),function(i){return c(n(i))}}function Pje(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),c=new Array(n),h=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++h<n;)a[h]=NI(e[h],e[h+1]),c[h]=r(t[h],t[h+1]);return function(i){var x=x2(e,i,1,n)-1;return c[x](a[x](i))}}function _2(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function fj(){var e=b9,t=b9,r=O_,n,a,c,h=wc,i,x,w;function S(){var E=Math.min(e.length,t.length);return h!==wc&&(h=jje(e[0],e[E-1])),i=E>2?Pje:kje,x=w=null,T}function T(E){return E==null||isNaN(E=+E)?c:(x||(x=i(e.map(n),t,r)))(n(h(E)))}return T.invert=function(E){return h(a((w||(w=i(t,e.map(n),kA)))(E)))},T.domain=function(E){return arguments.length?(e=Array.from(E,PA),S()):e.slice()},T.range=function(E){return arguments.length?(t=Array.from(E),S()):t.slice()},T.rangeRound=function(E){return t=Array.from(E),r=rD,S()},T.clamp=function(E){return arguments.length?(h=E?!0:wc,S()):h!==wc},T.interpolate=function(E){return arguments.length?(r=E,S()):r},T.unknown=function(E){return arguments.length?(c=E,T):c},function(E,D){return n=E,a=D,S()}}function nD(){return fj()(wc,wc)}function Cje(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function CA(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Bv(e){return e=CA(Math.abs(e)),e?e[1]:NaN}function Eje(e,t){return function(r,n){for(var a=r.length,c=[],h=0,i=e[0],x=0;a>0&&i>0&&(x+i+1>n&&(i=Math.max(1,n-x)),c.push(r.substring(a-=i,a+i)),!((x+=i+1)>n));)i=e[h=(h+1)%e.length];return c.reverse().join(t)}}function Mje(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var Oje=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function hw(e){if(!(t=Oje.exec(e)))throw new Error("invalid format: "+e);var t;return new iD({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}hw.prototype=iD.prototype;function iD(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}iD.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Rje(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var CQ;function Ije(e,t){var r=CA(e,t);if(!r)return e+"";var n=r[0],a=r[1],c=a-(CQ=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,h=n.length;return c===h?n:c>h?n+new Array(c-h+1).join("0"):c>0?n.slice(0,c)+"."+n.slice(c):"0."+new Array(1-c).join("0")+CA(e,Math.max(0,t+c-1))[0]}function w9(e,t){var r=CA(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const S9={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Cje,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>w9(e*100,t),r:w9,s:Ije,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function N9(e){return e}var A9=Array.prototype.map,T9=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Lje(e){var t=e.grouping===void 0||e.thousands===void 0?N9:Eje(A9.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",c=e.numerals===void 0?N9:Mje(A9.call(e.numerals,String)),h=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"":e.minus+"",x=e.nan===void 0?"NaN":e.nan+"";function w(T){T=hw(T);var E=T.fill,D=T.align,U=T.sign,I=T.symbol,V=T.zero,H=T.width,K=T.comma,Q=T.precision,ae=T.trim,ee=T.type;ee==="n"?(K=!0,ee="g"):S9[ee]||(Q===void 0&&(Q=12),ae=!0,ee="g"),(V||E==="0"&&D==="=")&&(V=!0,E="0",D="=");var se=I==="$"?r:I==="#"&&/[boxX]/.test(ee)?"0"+ee.toLowerCase():"",ue=I==="$"?n:/[%p]/.test(ee)?h:"",he=S9[ee],Ce=/[defgprs%]/.test(ee);Q=Q===void 0?6:/[gprs]/.test(ee)?Math.max(1,Math.min(21,Q)):Math.max(0,Math.min(20,Q));function Ne(me){var be=se,pe=ue,Se,Ee,we;if(ee==="c")pe=he(me)+pe,me="";else{me=+me;var Pe=me<0||1/me<0;if(me=isNaN(me)?x:he(Math.abs(me),Q),ae&&(me=Rje(me)),Pe&&+me==0&&U!=="+"&&(Pe=!1),be=(Pe?U==="("?U:i:U==="-"||U==="("?"":U)+be,pe=(ee==="s"?T9[8+CQ/3]:"")+pe+(Pe&&U==="("?")":""),Ce){for(Se=-1,Ee=me.length;++Se<Ee;)if(we=me.charCodeAt(Se),48>we||we>57){pe=(we===46?a+me.slice(Se+1):me.slice(Se))+pe,me=me.slice(0,Se);break}}}K&&!V&&(me=t(me,1/0));var Me=be.length+me.length+pe.length,Be=Me<H?new Array(H-Me+1).join(E):"";switch(K&&V&&(me=t(Be+me,Be.length?H-pe.length:1/0),Be=""),D){case"<":me=be+me+pe+Be;break;case"=":me=be+Be+me+pe;break;case"^":me=Be.slice(0,Me=Be.length>>1)+be+me+pe+Be.slice(Me);break;default:me=Be+be+me+pe;break}return c(me)}return Ne.toString=function(){return T+""},Ne}function S(T,E){var D=w((T=hw(T),T.type="f",T)),U=Math.max(-8,Math.min(8,Math.floor(Bv(E)/3)))*3,I=Math.pow(10,-U),V=T9[8+U/3];return function(H){return D(I*H)+V}}return{format:w,formatPrefix:S}}var eN,aD,EQ;Dje({thousands:",",grouping:[3],currency:["$",""]});function Dje(e){return eN=Lje(e),aD=eN.format,EQ=eN.formatPrefix,eN}function Fje(e){return Math.max(0,-Bv(Math.abs(e)))}function zje(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Bv(t)/3)))*3-Bv(Math.abs(e)))}function Bje(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Bv(t)-Bv(e))+1}function MQ(e,t,r,n){var a=_I(e,t,r),c;switch(n=hw(n??",f"),n.type){case"s":{var h=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(c=zje(a,h))&&(n.precision=c),EQ(n,h)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(c=Bje(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=c-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(c=Fje(a))&&(n.precision=c-(n.type==="%")*2);break}}return aD(n)}function fy(e){var t=e.domain;return e.ticks=function(r){var n=t();return xI(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return MQ(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,c=n.length-1,h=n[a],i=n[c],x,w,S=10;for(i<h&&(w=h,h=i,i=w,w=a,a=c,c=w);S-- >0;){if(w=vI(h,i,r),w===x)return n[a]=h,n[c]=i,t(n);if(w>0)h=Math.floor(h/w)*w,i=Math.ceil(i/w)*w;else if(w<0)h=Math.ceil(h*w)/w,i=Math.floor(i*w)/w;else break;x=w}return e},e}function EA(){var e=nD();return e.copy=function(){return _2(e,EA())},Gd.apply(e,arguments),fy(e)}function OQ(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,PA),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return OQ(e).unknown(t)},e=arguments.length?Array.from(e,PA):[0,1],fy(r)}function RQ(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],c=e[n],h;return c<a&&(h=r,r=n,n=h,h=a,a=c,c=h),e[r]=t.floor(a),e[n]=t.ceil(c),e}function j9(e){return Math.log(e)}function k9(e){return Math.exp(e)}function Vje(e){return-Math.log(-e)}function Uje(e){return-Math.exp(-e)}function $je(e){return isFinite(e)?+("1e"+e):e<0?0:e}function qje(e){return e===10?$je:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Gje(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function P9(e){return(t,r)=>-e(-t,r)}function sD(e){const t=e(j9,k9),r=t.domain;let n=10,a,c;function h(){return a=Gje(n),c=qje(n),r()[0]<0?(a=P9(a),c=P9(c),e(Vje,Uje)):e(j9,k9),t}return t.base=function(i){return arguments.length?(n=+i,h()):n},t.domain=function(i){return arguments.length?(r(i),h()):r()},t.ticks=i=>{const x=r();let w=x[0],S=x[x.length-1];const T=S<w;T&&([w,S]=[S,w]);let E=a(w),D=a(S),U,I;const V=i==null?10:+i;let H=[];if(!(n%1)&&D-E<V){if(E=Math.floor(E),D=Math.ceil(D),w>0){for(;E<=D;++E)for(U=1;U<n;++U)if(I=E<0?U/c(-E):U*c(E),!(I<w)){if(I>S)break;H.push(I)}}else for(;E<=D;++E)for(U=n-1;U>=1;--U)if(I=E>0?U/c(-E):U*c(E),!(I<w)){if(I>S)break;H.push(I)}H.length*2<V&&(H=xI(w,S,V))}else H=xI(E,D,Math.min(D-E,V)).map(c);return T?H.reverse():H},t.tickFormat=(i,x)=>{if(i==null&&(i=10),x==null&&(x=n===10?"s":","),typeof x!="function"&&(!(n%1)&&(x=hw(x)).precision==null&&(x.trim=!0),x=aD(x)),i===1/0)return x;const w=Math.max(1,n*i/t.ticks().length);return S=>{let T=S/c(Math.round(a(S)));return T*n<n-.5&&(T*=n),T<=w?x(S):""}},t.nice=()=>r(RQ(r(),{floor:i=>c(Math.floor(a(i))),ceil:i=>c(Math.ceil(a(i)))})),t}function IQ(){const e=sD(fj()).domain([1,10]);return e.copy=()=>_2(e,IQ()).base(e.base()),Gd.apply(e,arguments),e}function C9(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function E9(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function oD(e){var t=1,r=e(C9(t),E9(t));return r.constant=function(n){return arguments.length?e(C9(t=+n),E9(t)):t},fy(r)}function LQ(){var e=oD(fj());return e.copy=function(){return _2(e,LQ()).constant(e.constant())},Gd.apply(e,arguments)}function M9(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Wje(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Hje(e){return e<0?-e*e:e*e}function lD(e){var t=e(wc,wc),r=1;function n(){return r===1?e(wc,wc):r===.5?e(Wje,Hje):e(M9(r),M9(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},fy(t)}function cD(){var e=lD(fj());return e.copy=function(){return _2(e,cD()).exponent(e.exponent())},Gd.apply(e,arguments),e}function Kje(){return cD.apply(null,arguments).exponent(.5)}function O9(e){return Math.sign(e)*e*e}function Zje(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function DQ(){var e=nD(),t=[0,1],r=!1,n;function a(c){var h=Zje(e(c));return isNaN(h)?n:r?Math.round(h):h}return a.invert=function(c){return e.invert(O9(c))},a.domain=function(c){return arguments.length?(e.domain(c),a):e.domain()},a.range=function(c){return arguments.length?(e.range((t=Array.from(c,PA)).map(O9)),a):t.slice()},a.rangeRound=function(c){return a.range(c).round(!0)},a.round=function(c){return arguments.length?(r=!!c,a):r},a.clamp=function(c){return arguments.length?(e.clamp(c),a):e.clamp()},a.unknown=function(c){return arguments.length?(n=c,a):n},a.copy=function(){return DQ(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Gd.apply(a,arguments),fy(a)}function FQ(){var e=[],t=[],r=[],n;function a(){var h=0,i=Math.max(1,t.length);for(r=new Array(i-1);++h<i;)r[h-1]=eje(e,h/i);return c}function c(h){return h==null||isNaN(h=+h)?n:t[x2(r,h)]}return c.invertExtent=function(h){var i=t.indexOf(h);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},c.domain=function(h){if(!arguments.length)return e.slice();e=[];for(let i of h)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Zg),a()},c.range=function(h){return arguments.length?(t=Array.from(h),a()):t.slice()},c.unknown=function(h){return arguments.length?(n=h,c):n},c.quantiles=function(){return r.slice()},c.copy=function(){return FQ().domain(e).range(t).unknown(n)},Gd.apply(c,arguments)}function zQ(){var e=0,t=1,r=1,n=[.5],a=[0,1],c;function h(x){return x!=null&&x<=x?a[x2(n,x,0,r)]:c}function i(){var x=-1;for(n=new Array(r);++x<r;)n[x]=((x+1)*t-(x-r)*e)/(r+1);return h}return h.domain=function(x){return arguments.length?([e,t]=x,e=+e,t=+t,i()):[e,t]},h.range=function(x){return arguments.length?(r=(a=Array.from(x)).length-1,i()):a.slice()},h.invertExtent=function(x){var w=a.indexOf(x);return w<0?[NaN,NaN]:w<1?[e,n[0]]:w>=r?[n[r-1],t]:[n[w-1],n[w]]},h.unknown=function(x){return arguments.length&&(c=x),h},h.thresholds=function(){return n.slice()},h.copy=function(){return zQ().domain([e,t]).range(a).unknown(c)},Gd.apply(fy(h),arguments)}function BQ(){var e=[.5],t=[0,1],r,n=1;function a(c){return c!=null&&c<=c?t[x2(e,c,0,n)]:r}return a.domain=function(c){return arguments.length?(e=Array.from(c),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(c){return arguments.length?(t=Array.from(c),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(c){var h=t.indexOf(c);return[e[h-1],e[h]]},a.unknown=function(c){return arguments.length?(r=c,a):r},a.copy=function(){return BQ().domain(e).range(t).unknown(r)},Gd.apply(a,arguments)}const HM=new Date,KM=new Date;function Ho(e,t,r,n){function a(c){return e(c=arguments.length===0?new Date:new Date(+c)),c}return a.floor=c=>(e(c=new Date(+c)),c),a.ceil=c=>(e(c=new Date(c-1)),t(c,1),e(c),c),a.round=c=>{const h=a(c),i=a.ceil(c);return c-h<i-c?h:i},a.offset=(c,h)=>(t(c=new Date(+c),h==null?1:Math.floor(h)),c),a.range=(c,h,i)=>{const x=[];if(c=a.ceil(c),i=i==null?1:Math.floor(i),!(c<h)||!(i>0))return x;let w;do x.push(w=new Date(+c)),t(c,i),e(c);while(w<c&&c<h);return x},a.filter=c=>Ho(h=>{if(h>=h)for(;e(h),!c(h);)h.setTime(h-1)},(h,i)=>{if(h>=h)if(i<0)for(;++i<=0;)for(;t(h,-1),!c(h););else for(;--i>=0;)for(;t(h,1),!c(h););}),r&&(a.count=(c,h)=>(HM.setTime(+c),KM.setTime(+h),e(HM),e(KM),Math.floor(r(HM,KM))),a.every=c=>(c=Math.floor(c),!isFinite(c)||!(c>0)?null:c>1?a.filter(n?h=>n(h)%c===0:h=>a.count(0,h)%c===0):a)),a}const MA=Ho(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);MA.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ho(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):MA);MA.range;const pm=1e3,Id=pm*60,mm=Id*60,km=mm*24,uD=km*7,R9=km*30,ZM=km*365,P0=Ho(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*pm)},(e,t)=>(t-e)/pm,e=>e.getUTCSeconds());P0.range;const dD=Ho(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*pm)},(e,t)=>{e.setTime(+e+t*Id)},(e,t)=>(t-e)/Id,e=>e.getMinutes());dD.range;const hD=Ho(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Id)},(e,t)=>(t-e)/Id,e=>e.getUTCMinutes());hD.range;const fD=Ho(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*pm-e.getMinutes()*Id)},(e,t)=>{e.setTime(+e+t*mm)},(e,t)=>(t-e)/mm,e=>e.getHours());fD.range;const pD=Ho(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*mm)},(e,t)=>(t-e)/mm,e=>e.getUTCHours());pD.range;const b2=Ho(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Id)/km,e=>e.getDate()-1);b2.range;const pj=Ho(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/km,e=>e.getUTCDate()-1);pj.range;const VQ=Ho(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/km,e=>Math.floor(e/km));VQ.range;function nx(e){return Ho(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Id)/uD)}const mj=nx(0),OA=nx(1),Yje=nx(2),Xje=nx(3),Vv=nx(4),Jje=nx(5),Qje=nx(6);mj.range;OA.range;Yje.range;Xje.range;Vv.range;Jje.range;Qje.range;function ix(e){return Ho(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/uD)}const gj=ix(0),RA=ix(1),eke=ix(2),tke=ix(3),Uv=ix(4),rke=ix(5),nke=ix(6);gj.range;RA.range;eke.range;tke.range;Uv.range;rke.range;nke.range;const mD=Ho(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());mD.range;const gD=Ho(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());gD.range;const Pm=Ho(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Pm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ho(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Pm.range;const Cm=Ho(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Cm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ho(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Cm.range;function UQ(e,t,r,n,a,c){const h=[[P0,1,pm],[P0,5,5*pm],[P0,15,15*pm],[P0,30,30*pm],[c,1,Id],[c,5,5*Id],[c,15,15*Id],[c,30,30*Id],[a,1,mm],[a,3,3*mm],[a,6,6*mm],[a,12,12*mm],[n,1,km],[n,2,2*km],[r,1,uD],[t,1,R9],[t,3,3*R9],[e,1,ZM]];function i(w,S,T){const E=S<w;E&&([w,S]=[S,w]);const D=T&&typeof T.range=="function"?T:x(w,S,T),U=D?D.range(w,+S+1):[];return E?U.reverse():U}function x(w,S,T){const E=Math.abs(S-w)/T,D=JL(([,,V])=>V).right(h,E);if(D===h.length)return e.every(_I(w/ZM,S/ZM,T));if(D===0)return MA.every(Math.max(_I(w,S,T),1));const[U,I]=h[E/h[D-1][2]<h[D][2]/E?D-1:D];return U.every(I)}return[i,x]}const[ike,ake]=UQ(Cm,gD,gj,VQ,pD,hD),[ske,oke]=UQ(Pm,mD,mj,b2,fD,dD);function YM(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function XM(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ub(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function lke(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,c=e.days,h=e.shortDays,i=e.months,x=e.shortMonths,w=$b(a),S=qb(a),T=$b(c),E=qb(c),D=$b(h),U=qb(h),I=$b(i),V=qb(i),H=$b(x),K=qb(x),Q={a:Pe,A:Me,b:Be,B:Ge,c:null,d:B9,e:B9,f:Eke,g:Vke,G:$ke,H:kke,I:Pke,j:Cke,L:$Q,m:Mke,M:Oke,p:We,q:tt,Q:$9,s:q9,S:Rke,u:Ike,U:Lke,V:Dke,w:Fke,W:zke,x:null,X:null,y:Bke,Y:Uke,Z:qke,"%":U9},ae={a:nt,A:Dt,b:nr,B:ir,c:null,d:V9,e:V9,f:Kke,g:iPe,G:sPe,H:Gke,I:Wke,j:Hke,L:GQ,m:Zke,M:Yke,p:rr,q:or,Q:$9,s:q9,S:Xke,u:Jke,U:Qke,V:ePe,w:tPe,W:rPe,x:null,X:null,y:nPe,Y:aPe,Z:oPe,"%":U9},ee={a:Ne,A:me,b:be,B:pe,c:Se,d:F9,e:F9,f:Nke,g:D9,G:L9,H:z9,I:z9,j:_ke,L:Ske,m:vke,M:bke,p:Ce,q:xke,Q:Tke,s:jke,S:wke,u:fke,U:pke,V:mke,w:hke,W:gke,x:Ee,X:we,y:D9,Y:L9,Z:yke,"%":Ake};Q.x=se(r,Q),Q.X=se(n,Q),Q.c=se(t,Q),ae.x=se(r,ae),ae.X=se(n,ae),ae.c=se(t,ae);function se(Ft,ze){return function(Pr){var Kt=[],on=-1,Rt=0,En=Ft.length,Vn,pi,dt;for(Pr instanceof Date||(Pr=new Date(+Pr));++on<En;)Ft.charCodeAt(on)===37&&(Kt.push(Ft.slice(Rt,on)),(pi=I9[Vn=Ft.charAt(++on)])!=null?Vn=Ft.charAt(++on):pi=Vn==="e"?" ":"0",(dt=ze[Vn])&&(Vn=dt(Pr,pi)),Kt.push(Vn),Rt=on+1);return Kt.push(Ft.slice(Rt,on)),Kt.join("")}}function ue(Ft,ze){return function(Pr){var Kt=Ub(1900,void 0,1),on=he(Kt,Ft,Pr+="",0),Rt,En;if(on!=Pr.length)return null;if("Q"in Kt)return new Date(Kt.Q);if("s"in Kt)return new Date(Kt.s*1e3+("L"in Kt?Kt.L:0));if(ze&&!("Z"in Kt)&&(Kt.Z=0),"p"in Kt&&(Kt.H=Kt.H%12+Kt.p*12),Kt.m===void 0&&(Kt.m="q"in Kt?Kt.q:0),"V"in Kt){if(Kt.V<1||Kt.V>53)return null;"w"in Kt||(Kt.w=1),"Z"in Kt?(Rt=XM(Ub(Kt.y,0,1)),En=Rt.getUTCDay(),Rt=En>4||En===0?RA.ceil(Rt):RA(Rt),Rt=pj.offset(Rt,(Kt.V-1)*7),Kt.y=Rt.getUTCFullYear(),Kt.m=Rt.getUTCMonth(),Kt.d=Rt.getUTCDate()+(Kt.w+6)%7):(Rt=YM(Ub(Kt.y,0,1)),En=Rt.getDay(),Rt=En>4||En===0?OA.ceil(Rt):OA(Rt),Rt=b2.offset(Rt,(Kt.V-1)*7),Kt.y=Rt.getFullYear(),Kt.m=Rt.getMonth(),Kt.d=Rt.getDate()+(Kt.w+6)%7)}else("W"in Kt||"U"in Kt)&&("w"in Kt||(Kt.w="u"in Kt?Kt.u%7:"W"in Kt?1:0),En="Z"in Kt?XM(Ub(Kt.y,0,1)).getUTCDay():YM(Ub(Kt.y,0,1)).getDay(),Kt.m=0,Kt.d="W"in Kt?(Kt.w+6)%7+Kt.W*7-(En+5)%7:Kt.w+Kt.U*7-(En+6)%7);return"Z"in Kt?(Kt.H+=Kt.Z/100|0,Kt.M+=Kt.Z%100,XM(Kt)):YM(Kt)}}function he(Ft,ze,Pr,Kt){for(var on=0,Rt=ze.length,En=Pr.length,Vn,pi;on<Rt;){if(Kt>=En)return-1;if(Vn=ze.charCodeAt(on++),Vn===37){if(Vn=ze.charAt(on++),pi=ee[Vn in I9?ze.charAt(on++):Vn],!pi||(Kt=pi(Ft,Pr,Kt))<0)return-1}else if(Vn!=Pr.charCodeAt(Kt++))return-1}return Kt}function Ce(Ft,ze,Pr){var Kt=w.exec(ze.slice(Pr));return Kt?(Ft.p=S.get(Kt[0].toLowerCase()),Pr+Kt[0].length):-1}function Ne(Ft,ze,Pr){var Kt=D.exec(ze.slice(Pr));return Kt?(Ft.w=U.get(Kt[0].toLowerCase()),Pr+Kt[0].length):-1}function me(Ft,ze,Pr){var Kt=T.exec(ze.slice(Pr));return Kt?(Ft.w=E.get(Kt[0].toLowerCase()),Pr+Kt[0].length):-1}function be(Ft,ze,Pr){var Kt=H.exec(ze.slice(Pr));return Kt?(Ft.m=K.get(Kt[0].toLowerCase()),Pr+Kt[0].length):-1}function pe(Ft,ze,Pr){var Kt=I.exec(ze.slice(Pr));return Kt?(Ft.m=V.get(Kt[0].toLowerCase()),Pr+Kt[0].length):-1}function Se(Ft,ze,Pr){return he(Ft,t,ze,Pr)}function Ee(Ft,ze,Pr){return he(Ft,r,ze,Pr)}function we(Ft,ze,Pr){return he(Ft,n,ze,Pr)}function Pe(Ft){return h[Ft.getDay()]}function Me(Ft){return c[Ft.getDay()]}function Be(Ft){return x[Ft.getMonth()]}function Ge(Ft){return i[Ft.getMonth()]}function We(Ft){return a[+(Ft.getHours()>=12)]}function tt(Ft){return 1+~~(Ft.getMonth()/3)}function nt(Ft){return h[Ft.getUTCDay()]}function Dt(Ft){return c[Ft.getUTCDay()]}function nr(Ft){return x[Ft.getUTCMonth()]}function ir(Ft){return i[Ft.getUTCMonth()]}function rr(Ft){return a[+(Ft.getUTCHours()>=12)]}function or(Ft){return 1+~~(Ft.getUTCMonth()/3)}return{format:function(Ft){var ze=se(Ft+="",Q);return ze.toString=function(){return Ft},ze},parse:function(Ft){var ze=ue(Ft+="",!1);return ze.toString=function(){return Ft},ze},utcFormat:function(Ft){var ze=se(Ft+="",ae);return ze.toString=function(){return Ft},ze},utcParse:function(Ft){var ze=ue(Ft+="",!0);return ze.toString=function(){return Ft},ze}}}var I9={"-":"",_:" ",0:"0"},gl=/^\s*\d+/,cke=/^%/,uke=/[\\^$*+?|[\]().{}]/g;function da(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",c=a.length;return n+(c<r?new Array(r-c+1).join(t)+a:a)}function dke(e){return e.replace(uke,"\\$&")}function $b(e){return new RegExp("^(?:"+e.map(dke).join("|")+")","i")}function qb(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function hke(e,t,r){var n=gl.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function fke(e,t,r){var n=gl.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function pke(e,t,r){var n=gl.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function mke(e,t,r){var n=gl.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function gke(e,t,r){var n=gl.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function L9(e,t,r){var n=gl.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function D9(e,t,r){var n=gl.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function yke(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function xke(e,t,r){var n=gl.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function vke(e,t,r){var n=gl.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function F9(e,t,r){var n=gl.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function _ke(e,t,r){var n=gl.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function z9(e,t,r){var n=gl.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function bke(e,t,r){var n=gl.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function wke(e,t,r){var n=gl.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function Ske(e,t,r){var n=gl.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function Nke(e,t,r){var n=gl.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Ake(e,t,r){var n=cke.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function Tke(e,t,r){var n=gl.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function jke(e,t,r){var n=gl.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function B9(e,t){return da(e.getDate(),t,2)}function kke(e,t){return da(e.getHours(),t,2)}function Pke(e,t){return da(e.getHours()%12||12,t,2)}function Cke(e,t){return da(1+b2.count(Pm(e),e),t,3)}function $Q(e,t){return da(e.getMilliseconds(),t,3)}function Eke(e,t){return $Q(e,t)+"000"}function Mke(e,t){return da(e.getMonth()+1,t,2)}function Oke(e,t){return da(e.getMinutes(),t,2)}function Rke(e,t){return da(e.getSeconds(),t,2)}function Ike(e){var t=e.getDay();return t===0?7:t}function Lke(e,t){return da(mj.count(Pm(e)-1,e),t,2)}function qQ(e){var t=e.getDay();return t>=4||t===0?Vv(e):Vv.ceil(e)}function Dke(e,t){return e=qQ(e),da(Vv.count(Pm(e),e)+(Pm(e).getDay()===4),t,2)}function Fke(e){return e.getDay()}function zke(e,t){return da(OA.count(Pm(e)-1,e),t,2)}function Bke(e,t){return da(e.getFullYear()%100,t,2)}function Vke(e,t){return e=qQ(e),da(e.getFullYear()%100,t,2)}function Uke(e,t){return da(e.getFullYear()%1e4,t,4)}function $ke(e,t){var r=e.getDay();return e=r>=4||r===0?Vv(e):Vv.ceil(e),da(e.getFullYear()%1e4,t,4)}function qke(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+da(t/60|0,"0",2)+da(t%60,"0",2)}function V9(e,t){return da(e.getUTCDate(),t,2)}function Gke(e,t){return da(e.getUTCHours(),t,2)}function Wke(e,t){return da(e.getUTCHours()%12||12,t,2)}function Hke(e,t){return da(1+pj.count(Cm(e),e),t,3)}function GQ(e,t){return da(e.getUTCMilliseconds(),t,3)}function Kke(e,t){return GQ(e,t)+"000"}function Zke(e,t){return da(e.getUTCMonth()+1,t,2)}function Yke(e,t){return da(e.getUTCMinutes(),t,2)}function Xke(e,t){return da(e.getUTCSeconds(),t,2)}function Jke(e){var t=e.getUTCDay();return t===0?7:t}function Qke(e,t){return da(gj.count(Cm(e)-1,e),t,2)}function WQ(e){var t=e.getUTCDay();return t>=4||t===0?Uv(e):Uv.ceil(e)}function ePe(e,t){return e=WQ(e),da(Uv.count(Cm(e),e)+(Cm(e).getUTCDay()===4),t,2)}function tPe(e){return e.getUTCDay()}function rPe(e,t){return da(RA.count(Cm(e)-1,e),t,2)}function nPe(e,t){return da(e.getUTCFullYear()%100,t,2)}function iPe(e,t){return e=WQ(e),da(e.getUTCFullYear()%100,t,2)}function aPe(e,t){return da(e.getUTCFullYear()%1e4,t,4)}function sPe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Uv(e):Uv.ceil(e),da(e.getUTCFullYear()%1e4,t,4)}function oPe(){return"+0000"}function U9(){return"%"}function $9(e){return+e}function q9(e){return Math.floor(+e/1e3)}var tv,HQ,KQ;lPe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function lPe(e){return tv=lke(e),HQ=tv.format,tv.parse,KQ=tv.utcFormat,tv.utcParse,tv}function cPe(e){return new Date(e)}function uPe(e){return e instanceof Date?+e:+new Date(+e)}function yD(e,t,r,n,a,c,h,i,x,w){var S=nD(),T=S.invert,E=S.domain,D=w(".%L"),U=w(":%S"),I=w("%I:%M"),V=w("%I %p"),H=w("%a %d"),K=w("%b %d"),Q=w("%B"),ae=w("%Y");function ee(se){return(x(se)<se?D:i(se)<se?U:h(se)<se?I:c(se)<se?V:n(se)<se?a(se)<se?H:K:r(se)<se?Q:ae)(se)}return S.invert=function(se){return new Date(T(se))},S.domain=function(se){return arguments.length?E(Array.from(se,uPe)):E().map(cPe)},S.ticks=function(se){var ue=E();return e(ue[0],ue[ue.length-1],se??10)},S.tickFormat=function(se,ue){return ue==null?ee:w(ue)},S.nice=function(se){var ue=E();return(!se||typeof se.range!="function")&&(se=t(ue[0],ue[ue.length-1],se??10)),se?E(RQ(ue,se)):S},S.copy=function(){return _2(S,yD(e,t,r,n,a,c,h,i,x,w))},S}function dPe(){return Gd.apply(yD(ske,oke,Pm,mD,mj,b2,fD,dD,P0,HQ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function hPe(){return Gd.apply(yD(ike,ake,Cm,gD,gj,pj,pD,hD,P0,KQ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function yj(){var e=0,t=1,r,n,a,c,h=wc,i=!1,x;function w(T){return T==null||isNaN(T=+T)?x:h(a===0?.5:(T=(c(T)-r)*a,i?Math.max(0,Math.min(1,T)):T))}w.domain=function(T){return arguments.length?([e,t]=T,r=c(e=+e),n=c(t=+t),a=r===n?0:1/(n-r),w):[e,t]},w.clamp=function(T){return arguments.length?(i=!!T,w):i},w.interpolator=function(T){return arguments.length?(h=T,w):h};function S(T){return function(E){var D,U;return arguments.length?([D,U]=E,h=T(D,U),w):[h(0),h(1)]}}return w.range=S(O_),w.rangeRound=S(rD),w.unknown=function(T){return arguments.length?(x=T,w):x},function(T){return c=T,r=T(e),n=T(t),a=r===n?0:1/(n-r),w}}function py(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function ZQ(){var e=fy(yj()(wc));return e.copy=function(){return py(e,ZQ())},Rm.apply(e,arguments)}function YQ(){var e=sD(yj()).domain([1,10]);return e.copy=function(){return py(e,YQ()).base(e.base())},Rm.apply(e,arguments)}function XQ(){var e=oD(yj());return e.copy=function(){return py(e,XQ()).constant(e.constant())},Rm.apply(e,arguments)}function xD(){var e=lD(yj());return e.copy=function(){return py(e,xD()).exponent(e.exponent())},Rm.apply(e,arguments)}function fPe(){return xD.apply(null,arguments).exponent(.5)}function JQ(){var e=[],t=wc;function r(n){if(n!=null&&!isNaN(n=+n))return t((x2(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Zg),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,c)=>QTe(e,c/n))},r.copy=function(){return JQ(t).domain(e)},Rm.apply(r,arguments)}function xj(){var e=0,t=.5,r=1,n=1,a,c,h,i,x,w=wc,S,T=!1,E;function D(I){return isNaN(I=+I)?E:(I=.5+((I=+S(I))-c)*(n*I<n*c?i:x),w(T?Math.max(0,Math.min(1,I)):I))}D.domain=function(I){return arguments.length?([e,t,r]=I,a=S(e=+e),c=S(t=+t),h=S(r=+r),i=a===c?0:.5/(c-a),x=c===h?0:.5/(h-c),n=c<a?-1:1,D):[e,t,r]},D.clamp=function(I){return arguments.length?(T=!!I,D):T},D.interpolator=function(I){return arguments.length?(w=I,D):w};function U(I){return function(V){var H,K,Q;return arguments.length?([H,K,Q]=V,w=Aje(I,[H,K,Q]),D):[w(0),w(.5),w(1)]}}return D.range=U(O_),D.rangeRound=U(rD),D.unknown=function(I){return arguments.length?(E=I,D):E},function(I){return S=I,a=I(e),c=I(t),h=I(r),i=a===c?0:.5/(c-a),x=c===h?0:.5/(h-c),n=c<a?-1:1,D}}function QQ(){var e=fy(xj()(wc));return e.copy=function(){return py(e,QQ())},Rm.apply(e,arguments)}function eee(){var e=sD(xj()).domain([.1,1,10]);return e.copy=function(){return py(e,eee()).base(e.base())},Rm.apply(e,arguments)}function tee(){var e=oD(xj());return e.copy=function(){return py(e,tee()).constant(e.constant())},Rm.apply(e,arguments)}function vD(){var e=lD(xj());return e.copy=function(){return py(e,vD()).exponent(e.exponent())},Rm.apply(e,arguments)}function pPe(){return vD.apply(null,arguments).exponent(.5)}const G9=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:lw,scaleDiverging:QQ,scaleDivergingLog:eee,scaleDivergingPow:vD,scaleDivergingSqrt:pPe,scaleDivergingSymlog:tee,scaleIdentity:OQ,scaleImplicit:bI,scaleLinear:EA,scaleLog:IQ,scaleOrdinal:QL,scalePoint:y1,scalePow:cD,scaleQuantile:FQ,scaleQuantize:zQ,scaleRadial:DQ,scaleSequential:ZQ,scaleSequentialLog:YQ,scaleSequentialPow:xD,scaleSequentialQuantile:JQ,scaleSequentialSqrt:fPe,scaleSequentialSymlog:XQ,scaleSqrt:Kje,scaleSymlog:LQ,scaleThreshold:BQ,scaleTime:dPe,scaleUtc:hPe,tickFormat:MQ},Symbol.toStringTag,{value:"Module"}));var JM,W9;function vj(){if(W9)return JM;W9=1;var e=P_();function t(r,n,a){for(var c=-1,h=r.length;++c<h;){var i=r[c],x=n(i);if(x!=null&&(w===void 0?x===x&&!e(x):a(x,w)))var w=x,S=i}return S}return JM=t,JM}var QM,H9;function ree(){if(H9)return QM;H9=1;function e(t,r){return t>r}return QM=e,QM}var eO,K9;function mPe(){if(K9)return eO;K9=1;var e=vj(),t=ree(),r=M_();function n(a){return a&&a.length?e(a,r,t):void 0}return eO=n,eO}var gPe=mPe();const qg=ha(gPe);var tO,Z9;function nee(){if(Z9)return tO;Z9=1;function e(t,r){return t<r}return tO=e,tO}var rO,Y9;function yPe(){if(Y9)return rO;Y9=1;var e=vj(),t=nee(),r=M_();function n(a){return a&&a.length?e(a,r,t):void 0}return rO=n,rO}var xPe=yPe();const _j=ha(xPe);var nO,X9;function vPe(){if(X9)return nO;X9=1;var e=LL(),t=yp(),r=dQ(),n=nu();function a(c,h){var i=n(c)?e:r;return i(c,t(h,3))}return nO=a,nO}var iO,J9;function _Pe(){if(J9)return iO;J9=1;var e=cQ(),t=vPe();function r(n,a){return e(t(n,a),1)}return iO=r,iO}var bPe=_Pe();const wPe=ha(bPe);var aO,Q9;function SPe(){if(Q9)return aO;Q9=1;var e=KL();function t(r,n){return e(r,n)}return aO=t,aO}var NPe=SPe();const Em=ha(NPe);var R_=1e9,APe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},bD,ks=!0,Vd="[DecimalError] ",L0=Vd+"Invalid argument: ",_D=Vd+"Exponent out of range: ",I_=Math.floor,x0=Math.pow,TPe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ou,ul=1e7,ps=7,iee=9007199254740991,IA=I_(iee/ps),yn={};yn.absoluteValue=yn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};yn.comparedTo=yn.cmp=function(e){var t,r,n,a,c=this;if(e=new c.constructor(e),c.s!==e.s)return c.s||-e.s;if(c.e!==e.e)return c.e>e.e^c.s<0?1:-1;for(n=c.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(c.d[t]!==e.d[t])return c.d[t]>e.d[t]^c.s<0?1:-1;return n===a?0:n>a^c.s<0?1:-1};yn.decimalPlaces=yn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*ps;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};yn.dividedBy=yn.div=function(e){return bm(this,new this.constructor(e))};yn.dividedToIntegerBy=yn.idiv=function(e){var t=this,r=t.constructor;return qa(bm(t,new r(e),0,1),r.precision)};yn.equals=yn.eq=function(e){return!this.cmp(e)};yn.exponent=function(){return Po(this)};yn.greaterThan=yn.gt=function(e){return this.cmp(e)>0};yn.greaterThanOrEqualTo=yn.gte=function(e){return this.cmp(e)>=0};yn.isInteger=yn.isint=function(){return this.e>this.d.length-2};yn.isNegative=yn.isneg=function(){return this.s<0};yn.isPositive=yn.ispos=function(){return this.s>0};yn.isZero=function(){return this.s===0};yn.lessThan=yn.lt=function(e){return this.cmp(e)<0};yn.lessThanOrEqualTo=yn.lte=function(e){return this.cmp(e)<1};yn.logarithm=yn.log=function(e){var t,r=this,n=r.constructor,a=n.precision,c=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Ou))throw Error(Vd+"NaN");if(r.s<1)throw Error(Vd+(r.s?"NaN":"-Infinity"));return r.eq(Ou)?new n(0):(ks=!1,t=bm(fw(r,c),fw(e,c),c),ks=!0,qa(t,a))};yn.minus=yn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?oee(t,e):aee(t,(e.s=-e.s,e))};yn.modulo=yn.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Vd+"NaN");return r.s?(ks=!1,t=bm(r,e,0,1).times(e),ks=!0,r.minus(t)):qa(new n(r),a)};yn.naturalExponential=yn.exp=function(){return see(this)};yn.naturalLogarithm=yn.ln=function(){return fw(this)};yn.negated=yn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};yn.plus=yn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?aee(t,e):oee(t,(e.s=-e.s,e))};yn.precision=yn.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(L0+e);if(t=Po(a)+1,n=a.d.length-1,r=n*ps+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};yn.squareRoot=yn.sqrt=function(){var e,t,r,n,a,c,h,i=this,x=i.constructor;if(i.s<1){if(!i.s)return new x(0);throw Error(Vd+"NaN")}for(e=Po(i),ks=!1,a=Math.sqrt(+i),a==0||a==1/0?(t=Zf(i.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=I_((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new x(t)):n=new x(a.toString()),r=x.precision,a=h=r+3;;)if(c=n,n=c.plus(bm(i,c,h+2)).times(.5),Zf(c.d).slice(0,h)===(t=Zf(n.d)).slice(0,h)){if(t=t.slice(h-3,h+1),a==h&&t=="4999"){if(qa(c,r+1,0),c.times(c).eq(i)){n=c;break}}else if(t!="9999")break;h+=4}return ks=!0,qa(n,r)};yn.times=yn.mul=function(e){var t,r,n,a,c,h,i,x,w,S=this,T=S.constructor,E=S.d,D=(e=new T(e)).d;if(!S.s||!e.s)return new T(0);for(e.s*=S.s,r=S.e+e.e,x=E.length,w=D.length,x<w&&(c=E,E=D,D=c,h=x,x=w,w=h),c=[],h=x+w,n=h;n--;)c.push(0);for(n=w;--n>=0;){for(t=0,a=x+n;a>n;)i=c[a]+D[n]*E[a-n-1]+t,c[a--]=i%ul|0,t=i/ul|0;c[a]=(c[a]+t)%ul|0}for(;!c[--h];)c.pop();return t?++r:c.shift(),e.d=c,e.e=r,ks?qa(e,T.precision):e};yn.toDecimalPlaces=yn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(hp(e,0,R_),t===void 0?t=n.rounding:hp(t,0,8),qa(r,e+Po(r)+1,t))};yn.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=H0(n,!0):(hp(e,0,R_),t===void 0?t=a.rounding:hp(t,0,8),n=qa(new a(n),e+1,t),r=H0(n,!0,e+1)),r};yn.toFixed=function(e,t){var r,n,a=this,c=a.constructor;return e===void 0?H0(a):(hp(e,0,R_),t===void 0?t=c.rounding:hp(t,0,8),n=qa(new c(a),e+Po(a)+1,t),r=H0(n.abs(),!1,e+Po(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};yn.toInteger=yn.toint=function(){var e=this,t=e.constructor;return qa(new t(e),Po(e)+1,t.rounding)};yn.toNumber=function(){return+this};yn.toPower=yn.pow=function(e){var t,r,n,a,c,h,i=this,x=i.constructor,w=12,S=+(e=new x(e));if(!e.s)return new x(Ou);if(i=new x(i),!i.s){if(e.s<1)throw Error(Vd+"Infinity");return i}if(i.eq(Ou))return i;if(n=x.precision,e.eq(Ou))return qa(i,n);if(t=e.e,r=e.d.length-1,h=t>=r,c=i.s,h){if((r=S<0?-S:S)<=iee){for(a=new x(Ou),t=Math.ceil(n/ps+4),ks=!1;r%2&&(a=a.times(i),tq(a.d,t)),r=I_(r/2),r!==0;)i=i.times(i),tq(i.d,t);return ks=!0,e.s<0?new x(Ou).div(a):qa(a,n)}}else if(c<0)throw Error(Vd+"NaN");return c=c<0&&e.d[Math.max(t,r)]&1?-1:1,i.s=1,ks=!1,a=e.times(fw(i,n+w)),ks=!0,a=see(a),a.s=c,a};yn.toPrecision=function(e,t){var r,n,a=this,c=a.constructor;return e===void 0?(r=Po(a),n=H0(a,r<=c.toExpNeg||r>=c.toExpPos)):(hp(e,1,R_),t===void 0?t=c.rounding:hp(t,0,8),a=qa(new c(a),e,t),r=Po(a),n=H0(a,e<=r||r<=c.toExpNeg,e)),n};yn.toSignificantDigits=yn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(hp(e,1,R_),t===void 0?t=n.rounding:hp(t,0,8)),qa(new n(r),e,t)};yn.toString=yn.valueOf=yn.val=yn.toJSON=yn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Po(e),r=e.constructor;return H0(e,t<=r.toExpNeg||t>=r.toExpPos)};function aee(e,t){var r,n,a,c,h,i,x,w,S=e.constructor,T=S.precision;if(!e.s||!t.s)return t.s||(t=new S(e)),ks?qa(t,T):t;if(x=e.d,w=t.d,h=e.e,a=t.e,x=x.slice(),c=h-a,c){for(c<0?(n=x,c=-c,i=w.length):(n=w,a=h,i=x.length),h=Math.ceil(T/ps),i=h>i?h+1:i+1,c>i&&(c=i,n.length=1),n.reverse();c--;)n.push(0);n.reverse()}for(i=x.length,c=w.length,i-c<0&&(c=i,n=w,w=x,x=n),r=0;c;)r=(x[--c]=x[c]+w[c]+r)/ul|0,x[c]%=ul;for(r&&(x.unshift(r),++a),i=x.length;x[--i]==0;)x.pop();return t.d=x,t.e=a,ks?qa(t,T):t}function hp(e,t,r){if(e!==~~e||e<t||e>r)throw Error(L0+e)}function Zf(e){var t,r,n,a=e.length-1,c="",h=e[0];if(a>0){for(c+=h,t=1;t<a;t++)n=e[t]+"",r=ps-n.length,r&&(c+=Bg(r)),c+=n;h=e[t],n=h+"",r=ps-n.length,r&&(c+=Bg(r))}else if(h===0)return"0";for(;h%10===0;)h/=10;return c+h}var bm=function(){function e(n,a){var c,h=0,i=n.length;for(n=n.slice();i--;)c=n[i]*a+h,n[i]=c%ul|0,h=c/ul|0;return h&&n.unshift(h),n}function t(n,a,c,h){var i,x;if(c!=h)x=c>h?1:-1;else for(i=x=0;i<c;i++)if(n[i]!=a[i]){x=n[i]>a[i]?1:-1;break}return x}function r(n,a,c){for(var h=0;c--;)n[c]-=h,h=n[c]<a[c]?1:0,n[c]=h*ul+n[c]-a[c];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,c,h){var i,x,w,S,T,E,D,U,I,V,H,K,Q,ae,ee,se,ue,he,Ce=n.constructor,Ne=n.s==a.s?1:-1,me=n.d,be=a.d;if(!n.s)return new Ce(n);if(!a.s)throw Error(Vd+"Division by zero");for(x=n.e-a.e,ue=be.length,ee=me.length,D=new Ce(Ne),U=D.d=[],w=0;be[w]==(me[w]||0);)++w;if(be[w]>(me[w]||0)&&--x,c==null?K=c=Ce.precision:h?K=c+(Po(n)-Po(a))+1:K=c,K<0)return new Ce(0);if(K=K/ps+2|0,w=0,ue==1)for(S=0,be=be[0],K++;(w<ee||S)&&K--;w++)Q=S*ul+(me[w]||0),U[w]=Q/be|0,S=Q%be|0;else{for(S=ul/(be[0]+1)|0,S>1&&(be=e(be,S),me=e(me,S),ue=be.length,ee=me.length),ae=ue,I=me.slice(0,ue),V=I.length;V<ue;)I[V++]=0;he=be.slice(),he.unshift(0),se=be[0],be[1]>=ul/2&&++se;do S=0,i=t(be,I,ue,V),i<0?(H=I[0],ue!=V&&(H=H*ul+(I[1]||0)),S=H/se|0,S>1?(S>=ul&&(S=ul-1),T=e(be,S),E=T.length,V=I.length,i=t(T,I,E,V),i==1&&(S--,r(T,ue<E?he:be,E))):(S==0&&(i=S=1),T=be.slice()),E=T.length,E<V&&T.unshift(0),r(I,T,V),i==-1&&(V=I.length,i=t(be,I,ue,V),i<1&&(S++,r(I,ue<V?he:be,V))),V=I.length):i===0&&(S++,I=[0]),U[w++]=S,i&&I[0]?I[V++]=me[ae]||0:(I=[me[ae]],V=1);while((ae++<ee||I[0]!==void 0)&&K--)}return U[0]||U.shift(),D.e=x,qa(D,h?c+Po(D)+1:c)}}();function see(e,t){var r,n,a,c,h,i,x=0,w=0,S=e.constructor,T=S.precision;if(Po(e)>16)throw Error(_D+Po(e));if(!e.s)return new S(Ou);for(ks=!1,i=T,h=new S(.03125);e.abs().gte(.1);)e=e.times(h),w+=5;for(n=Math.log(x0(2,w))/Math.LN10*2+5|0,i+=n,r=a=c=new S(Ou),S.precision=i;;){if(a=qa(a.times(e),i),r=r.times(++x),h=c.plus(bm(a,r,i)),Zf(h.d).slice(0,i)===Zf(c.d).slice(0,i)){for(;w--;)c=qa(c.times(c),i);return S.precision=T,t==null?(ks=!0,qa(c,T)):c}c=h}}function Po(e){for(var t=e.e*ps,r=e.d[0];r>=10;r/=10)t++;return t}function sO(e,t,r){if(t>e.LN10.sd())throw ks=!0,r&&(e.precision=r),Error(Vd+"LN10 precision limit exceeded");return qa(new e(e.LN10),t)}function Bg(e){for(var t="";e--;)t+="0";return t}function fw(e,t){var r,n,a,c,h,i,x,w,S,T=1,E=10,D=e,U=D.d,I=D.constructor,V=I.precision;if(D.s<1)throw Error(Vd+(D.s?"NaN":"-Infinity"));if(D.eq(Ou))return new I(0);if(t==null?(ks=!1,w=V):w=t,D.eq(10))return t==null&&(ks=!0),sO(I,w);if(w+=E,I.precision=w,r=Zf(U),n=r.charAt(0),c=Po(D),Math.abs(c)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)D=D.times(e),r=Zf(D.d),n=r.charAt(0),T++;c=Po(D),n>1?(D=new I("0."+r),c++):D=new I(n+"."+r.slice(1))}else return x=sO(I,w+2,V).times(c+""),D=fw(new I(n+"."+r.slice(1)),w-E).plus(x),I.precision=V,t==null?(ks=!0,qa(D,V)):D;for(i=h=D=bm(D.minus(Ou),D.plus(Ou),w),S=qa(D.times(D),w),a=3;;){if(h=qa(h.times(S),w),x=i.plus(bm(h,new I(a),w)),Zf(x.d).slice(0,w)===Zf(i.d).slice(0,w))return i=i.times(2),c!==0&&(i=i.plus(sO(I,w+2,V).times(c+""))),i=bm(i,new I(T),w),I.precision=V,t==null?(ks=!0,qa(i,V)):i;i=x,a+=2}}function eq(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=I_(r/ps),e.d=[],n=(r+1)%ps,r<0&&(n+=ps),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=ps;n<a;)e.d.push(+t.slice(n,n+=ps));t=t.slice(n),n=ps-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),ks&&(e.e>IA||e.e<-IA))throw Error(_D+r)}else e.s=0,e.e=0,e.d=[0];return e}function qa(e,t,r){var n,a,c,h,i,x,w,S,T=e.d;for(h=1,c=T[0];c>=10;c/=10)h++;if(n=t-h,n<0)n+=ps,a=t,w=T[S=0];else{if(S=Math.ceil((n+1)/ps),c=T.length,S>=c)return e;for(w=c=T[S],h=1;c>=10;c/=10)h++;n%=ps,a=n-ps+h}if(r!==void 0&&(c=x0(10,h-a-1),i=w/c%10|0,x=t<0||T[S+1]!==void 0||w%c,x=r<4?(i||x)&&(r==0||r==(e.s<0?3:2)):i>5||i==5&&(r==4||x||r==6&&(n>0?a>0?w/x0(10,h-a):0:T[S-1])%10&1||r==(e.s<0?8:7))),t<1||!T[0])return x?(c=Po(e),T.length=1,t=t-c-1,T[0]=x0(10,(ps-t%ps)%ps),e.e=I_(-t/ps)||0):(T.length=1,T[0]=e.e=e.s=0),e;if(n==0?(T.length=S,c=1,S--):(T.length=S+1,c=x0(10,ps-n),T[S]=a>0?(w/x0(10,h-a)%x0(10,a)|0)*c:0),x)for(;;)if(S==0){(T[0]+=c)==ul&&(T[0]=1,++e.e);break}else{if(T[S]+=c,T[S]!=ul)break;T[S--]=0,c=1}for(n=T.length;T[--n]===0;)T.pop();if(ks&&(e.e>IA||e.e<-IA))throw Error(_D+Po(e));return e}function oee(e,t){var r,n,a,c,h,i,x,w,S,T,E=e.constructor,D=E.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new E(e),ks?qa(t,D):t;if(x=e.d,T=t.d,n=t.e,w=e.e,x=x.slice(),h=w-n,h){for(S=h<0,S?(r=x,h=-h,i=T.length):(r=T,n=w,i=x.length),a=Math.max(Math.ceil(D/ps),i)+2,h>a&&(h=a,r.length=1),r.reverse(),a=h;a--;)r.push(0);r.reverse()}else{for(a=x.length,i=T.length,S=a<i,S&&(i=a),a=0;a<i;a++)if(x[a]!=T[a]){S=x[a]<T[a];break}h=0}for(S&&(r=x,x=T,T=r,t.s=-t.s),i=x.length,a=T.length-i;a>0;--a)x[i++]=0;for(a=T.length;a>h;){if(x[--a]<T[a]){for(c=a;c&&x[--c]===0;)x[c]=ul-1;--x[c],x[a]+=ul}x[a]-=T[a]}for(;x[--i]===0;)x.pop();for(;x[0]===0;x.shift())--n;return x[0]?(t.d=x,t.e=n,ks?qa(t,D):t):new E(0)}function H0(e,t,r){var n,a=Po(e),c=Zf(e.d),h=c.length;return t?(r&&(n=r-h)>0?c=c.charAt(0)+"."+c.slice(1)+Bg(n):h>1&&(c=c.charAt(0)+"."+c.slice(1)),c=c+(a<0?"e":"e+")+a):a<0?(c="0."+Bg(-a-1)+c,r&&(n=r-h)>0&&(c+=Bg(n))):a>=h?(c+=Bg(a+1-h),r&&(n=r-a-1)>0&&(c=c+"."+Bg(n))):((n=a+1)<h&&(c=c.slice(0,n)+"."+c.slice(n)),r&&(n=r-h)>0&&(a+1===h&&(c+="."),c+=Bg(n))),e.s<0?"-"+c:c}function tq(e,t){if(e.length>t)return e.length=t,!0}function lee(e){var t,r,n;function a(c){var h=this;if(!(h instanceof a))return new a(c);if(h.constructor=a,c instanceof a){h.s=c.s,h.e=c.e,h.d=(c=c.d)?c.slice():c;return}if(typeof c=="number"){if(c*0!==0)throw Error(L0+c);if(c>0)h.s=1;else if(c<0)c=-c,h.s=-1;else{h.s=0,h.e=0,h.d=[0];return}if(c===~~c&&c<1e7){h.e=0,h.d=[c];return}return eq(h,c.toString())}else if(typeof c!="string")throw Error(L0+c);if(c.charCodeAt(0)===45?(c=c.slice(1),h.s=-1):h.s=1,TPe.test(c))eq(h,c);else throw Error(L0+c)}if(a.prototype=yn,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=lee,a.config=a.set=jPe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function jPe(e){if(!e||typeof e!="object")throw Error(Vd+"Object expected");var t,r,n,a=["precision",1,R_,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(I_(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(L0+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(L0+r+": "+n);return this}var bD=lee(APe);Ou=new bD(1);const Fa=bD;function kPe(e){return MPe(e)||EPe(e)||CPe(e)||PPe()}function PPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CPe(e,t){if(e){if(typeof e=="string")return AI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AI(e,t)}}function EPe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function MPe(e){if(Array.isArray(e))return AI(e)}function AI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var OPe=function(t){return t},cee={},uee=function(t){return t===cee},rq=function(t){return function r(){return arguments.length===0||arguments.length===1&&uee(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},RPe=function e(t,r){return t===1?r:rq(function(){for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];var h=a.filter(function(i){return i!==cee}).length;return h>=t?r.apply(void 0,a):e(t-h,rq(function(){for(var i=arguments.length,x=new Array(i),w=0;w<i;w++)x[w]=arguments[w];var S=a.map(function(T){return uee(T)?x.shift():T});return r.apply(void 0,kPe(S).concat(x))}))})},bj=function(t){return RPe(t.length,t)},TI=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},IPe=bj(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),LPe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return OPe;var a=r.reverse(),c=a[0],h=a.slice(1);return function(){return h.reduce(function(i,x){return x(i)},c.apply(void 0,arguments))}},jI=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},dee=function(t){var r=null,n=null;return function(){for(var a=arguments.length,c=new Array(a),h=0;h<a;h++)c[h]=arguments[h];return r&&c.every(function(i,x){return i===r[x]})||(r=c,n=t.apply(void 0,c)),n}};function DPe(e){var t;return e===0?t=1:t=Math.floor(new Fa(e).abs().log(10).toNumber())+1,t}function FPe(e,t,r){for(var n=new Fa(e),a=0,c=[];n.lt(t)&&a<1e5;)c.push(n.toNumber()),n=n.add(r),a++;return c}var zPe=bj(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),BPe=bj(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),VPe=bj(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const wj={rangeStep:FPe,getDigitCount:DPe,interpolateNumber:zPe,uninterpolateNumber:BPe,uninterpolateTruncation:VPe};function kI(e){return qPe(e)||$Pe(e)||hee(e)||UPe()}function UPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Pe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function qPe(e){if(Array.isArray(e))return PI(e)}function pw(e,t){return HPe(e)||WPe(e,t)||hee(e,t)||GPe()}function GPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hee(e,t){if(e){if(typeof e=="string")return PI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PI(e,t)}}function PI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WPe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,c=void 0;try{for(var h=e[Symbol.iterator](),i;!(n=(i=h.next()).done)&&(r.push(i.value),!(t&&r.length===t));n=!0);}catch(x){a=!0,c=x}finally{try{!n&&h.return!=null&&h.return()}finally{if(a)throw c}}return r}}function HPe(e){if(Array.isArray(e))return e}function fee(e){var t=pw(e,2),r=t[0],n=t[1],a=r,c=n;return r>n&&(a=n,c=r),[a,c]}function pee(e,t,r){if(e.lte(0))return new Fa(0);var n=wj.getDigitCount(e.toNumber()),a=new Fa(10).pow(n),c=e.div(a),h=n!==1?.05:.1,i=new Fa(Math.ceil(c.div(h).toNumber())).add(r).mul(h),x=i.mul(a);return t?x:new Fa(Math.ceil(x))}function KPe(e,t,r){var n=1,a=new Fa(e);if(!a.isint()&&r){var c=Math.abs(e);c<1?(n=new Fa(10).pow(wj.getDigitCount(e)-1),a=new Fa(Math.floor(a.div(n).toNumber())).mul(n)):c>1&&(a=new Fa(Math.floor(e)))}else e===0?a=new Fa(Math.floor((t-1)/2)):r||(a=new Fa(Math.floor(e)));var h=Math.floor((t-1)/2),i=LPe(IPe(function(x){return a.add(new Fa(x-h).mul(n)).toNumber()}),TI);return i(0,t)}function mee(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Fa(0),tickMin:new Fa(0),tickMax:new Fa(0)};var c=pee(new Fa(t).sub(e).div(r-1),n,a),h;e<=0&&t>=0?h=new Fa(0):(h=new Fa(e).add(t).div(2),h=h.sub(new Fa(h).mod(c)));var i=Math.ceil(h.sub(e).div(c).toNumber()),x=Math.ceil(new Fa(t).sub(h).div(c).toNumber()),w=i+x+1;return w>r?mee(e,t,r,n,a+1):(w<r&&(x=t>0?x+(r-w):x,i=t>0?i:i+(r-w)),{step:c,tickMin:h.sub(new Fa(i).mul(c)),tickMax:h.add(new Fa(x).mul(c))})}function ZPe(e){var t=pw(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=Math.max(a,2),i=fee([r,n]),x=pw(i,2),w=x[0],S=x[1];if(w===-1/0||S===1/0){var T=S===1/0?[w].concat(kI(TI(0,a-1).map(function(){return 1/0}))):[].concat(kI(TI(0,a-1).map(function(){return-1/0})),[S]);return r>n?jI(T):T}if(w===S)return KPe(w,a,c);var E=mee(w,S,h,c),D=E.step,U=E.tickMin,I=E.tickMax,V=wj.rangeStep(U,I.add(new Fa(.1).mul(D)),D);return r>n?jI(V):V}function YPe(e,t){var r=pw(e,2),n=r[0],a=r[1],c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=fee([n,a]),i=pw(h,2),x=i[0],w=i[1];if(x===-1/0||w===1/0)return[n,a];if(x===w)return[x];var S=Math.max(t,2),T=pee(new Fa(w).sub(x).div(S-1),c,0),E=[].concat(kI(wj.rangeStep(new Fa(x),new Fa(w).sub(new Fa(.99).mul(T)),T)),[w]);return n>a?jI(E):E}var XPe=dee(ZPe),JPe=dee(YPe),QPe="Invariant failed";function K0(e,t){throw new Error(QPe)}var eCe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function $v(e){"@babel/helpers - typeof";return $v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$v(e)}function LA(){return LA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},LA.apply(this,arguments)}function tCe(e,t){return aCe(e)||iCe(e,t)||nCe(e,t)||rCe()}function rCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nCe(e,t){if(e){if(typeof e=="string")return nq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nq(e,t)}}function nq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,h,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(S){w=!0,a=S}finally{try{if(!x&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function aCe(e){if(Array.isArray(e))return e}function sCe(e,t){if(e==null)return{};var r=oCe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function oCe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function lCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cCe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xee(n.key),n)}}function uCe(e,t,r){return t&&cCe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function dCe(e,t,r){return t=DA(t),hCe(e,gee()?Reflect.construct(t,r||[],DA(e).constructor):t.apply(e,r))}function hCe(e,t){if(t&&($v(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fCe(e)}function fCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gee=function(){return!!e})()}function DA(e){return DA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},DA(e)}function pCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CI(e,t)}function CI(e,t){return CI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},CI(e,t)}function yee(e,t,r){return t=xee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xee(e){var t=mCe(e,"string");return $v(t)=="symbol"?t:t+""}function mCe(e,t){if($v(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($v(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var L_=function(e){function t(){return lCe(this,t),dCe(this,t,arguments)}return pCe(t,e),uCe(t,[{key:"render",value:function(){var n=this.props,a=n.offset,c=n.layout,h=n.width,i=n.dataKey,x=n.data,w=n.dataPointFormatter,S=n.xAxis,T=n.yAxis,E=sCe(n,eCe),D=wn(E,!1);this.props.direction==="x"&&S.type!=="number"&&K0();var U=x.map(function(I){var V=w(I,i),H=V.x,K=V.y,Q=V.value,ae=V.errorVal;if(!ae)return null;var ee=[],se,ue;if(Array.isArray(ae)){var he=tCe(ae,2);se=he[0],ue=he[1]}else se=ue=ae;if(c==="vertical"){var Ce=S.scale,Ne=K+a,me=Ne+h,be=Ne-h,pe=Ce(Q-se),Se=Ce(Q+ue);ee.push({x1:Se,y1:me,x2:Se,y2:be}),ee.push({x1:pe,y1:Ne,x2:Se,y2:Ne}),ee.push({x1:pe,y1:me,x2:pe,y2:be})}else if(c==="horizontal"){var Ee=T.scale,we=H+a,Pe=we-h,Me=we+h,Be=Ee(Q-se),Ge=Ee(Q+ue);ee.push({x1:Pe,y1:Ge,x2:Me,y2:Ge}),ee.push({x1:we,y1:Be,x2:we,y2:Ge}),ee.push({x1:Pe,y1:Be,x2:Me,y2:Be})}return Le.createElement(fi,LA({className:"recharts-errorBar",key:"bar-".concat(ee.map(function(We){return"".concat(We.x1,"-").concat(We.x2,"-").concat(We.y1,"-").concat(We.y2)}))},D),ee.map(function(We){return Le.createElement("line",LA({},We,{key:"line-".concat(We.x1,"-").concat(We.x2,"-").concat(We.y1,"-").concat(We.y2)}))}))});return Le.createElement(fi,{className:"recharts-errorBars"},U)}}])}(Le.Component);yee(L_,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});yee(L_,"displayName","ErrorBar");function mw(e){"@babel/helpers - typeof";return mw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mw(e)}function iq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function f0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iq(Object(r),!0).forEach(function(n){gCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gCe(e,t,r){return t=yCe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yCe(e){var t=xCe(e,"string");return mw(t)=="symbol"?t:t+""}function xCe(e,t){if(mw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vee=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,c=t.legendContent,h=Eu(r,Fu);if(!h)return null;var i=Fu.defaultProps,x=i!==void 0?f0(f0({},i),h.props):{},w;return h.props&&h.props.payload?w=h.props&&h.props.payload:c==="children"?w=(n||[]).reduce(function(S,T){var E=T.item,D=T.props,U=D.sectors||D.data||[];return S.concat(U.map(function(I){return{type:h.props.iconType||E.props.legendType,value:I.name,color:I.fill,payload:I}}))},[]):w=(n||[]).map(function(S){var T=S.item,E=T.type.defaultProps,D=E!==void 0?f0(f0({},E),T.props):{},U=D.dataKey,I=D.name,V=D.legendType,H=D.hide;return{inactive:H,dataKey:U,type:x.iconType||V||"square",color:wD(T),value:I||U,payload:D}}),f0(f0(f0({},x),Fu.getWithHeight(h,a)),{},{payload:w,item:h})};function gw(e){"@babel/helpers - typeof";return gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gw(e)}function aq(e){return wCe(e)||bCe(e)||_Ce(e)||vCe()}function vCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Ce(e,t){if(e){if(typeof e=="string")return EI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EI(e,t)}}function bCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wCe(e){if(Array.isArray(e))return EI(e)}function EI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ys(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sq(Object(r),!0).forEach(function(n){Av(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Av(e,t,r){return t=SCe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SCe(e){var t=NCe(e,"string");return gw(t)=="symbol"?t:t+""}function NCe(e,t){if(gw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ns(e,t,r){return Yn(e)||Yn(t)?r:Wo(t)?Du(e,t,r):qn(t)?t(e):r}function x1(e,t,r,n){var a=wPe(e,function(i){return ns(i,t)});if(r==="number"){var c=a.filter(function(i){return Dr(i)||parseFloat(i)});return c.length?[_j(c),qg(c)]:[1/0,-1/0]}var h=n?a.filter(function(i){return!Yn(i)}):a;return h.map(function(i){return Wo(i)||i instanceof Date?i:""})}var ACe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,h=-1,i=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(i<=1)return 0;if(c&&c.axisType==="angleAxis"&&Math.abs(Math.abs(c.range[1]-c.range[0])-360)<=1e-6)for(var x=c.range,w=0;w<i;w++){var S=w>0?a[w-1].coordinate:a[i-1].coordinate,T=a[w].coordinate,E=w>=i-1?a[0].coordinate:a[w+1].coordinate,D=void 0;if(hl(T-S)!==hl(E-T)){var U=[];if(hl(E-T)===hl(x[1]-x[0])){D=E;var I=T+x[1]-x[0];U[0]=Math.min(I,(I+S)/2),U[1]=Math.max(I,(I+S)/2)}else{D=S;var V=E+x[1]-x[0];U[0]=Math.min(T,(V+T)/2),U[1]=Math.max(T,(V+T)/2)}var H=[Math.min(T,(D+T)/2),Math.max(T,(D+T)/2)];if(t>H[0]&&t<=H[1]||t>=U[0]&&t<=U[1]){h=a[w].index;break}}else{var K=Math.min(S,E),Q=Math.max(S,E);if(t>(K+T)/2&&t<=(Q+T)/2){h=a[w].index;break}}}else for(var ae=0;ae<i;ae++)if(ae===0&&t<=(n[ae].coordinate+n[ae+1].coordinate)/2||ae>0&&ae<i-1&&t>(n[ae].coordinate+n[ae-1].coordinate)/2&&t<=(n[ae].coordinate+n[ae+1].coordinate)/2||ae===i-1&&t>(n[ae].coordinate+n[ae-1].coordinate)/2){h=n[ae].index;break}return h},wD=function(t){var r,n=t,a=n.type.displayName,c=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Ys(Ys({},t.type.defaultProps),t.props):t.props,h=c.stroke,i=c.fill,x;switch(a){case"Line":x=h;break;case"Area":case"Radar":x=h&&h!=="none"?h:i;break;default:x=i;break}return x},TCe=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,c=a===void 0?{}:a;if(!c)return{};for(var h={},i=Object.keys(c),x=0,w=i.length;x<w;x++)for(var S=c[i[x]].stackGroups,T=Object.keys(S),E=0,D=T.length;E<D;E++){var U=S[T[E]],I=U.items,V=U.cateAxisId,H=I.filter(function(ue){return _m(ue.type).indexOf("Bar")>=0});if(H&&H.length){var K=H[0].type.defaultProps,Q=K!==void 0?Ys(Ys({},K),H[0].props):H[0].props,ae=Q.barSize,ee=Q[V];h[ee]||(h[ee]=[]);var se=Yn(ae)?r:ae;h[ee].push({item:H[0],stackList:H.slice(1),barSize:Yn(se)?void 0:bc(se,n,0)})}}return h},jCe=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,c=t.sizeList,h=c===void 0?[]:c,i=t.maxBarSize,x=h.length;if(x<1)return null;var w=bc(r,a,0,!0),S,T=[];if(h[0].barSize===+h[0].barSize){var E=!1,D=a/x,U=h.reduce(function(ae,ee){return ae+ee.barSize||0},0);U+=(x-1)*w,U>=a&&(U-=(x-1)*w,w=0),U>=a&&D>0&&(E=!0,D*=.9,U=x*D);var I=(a-U)/2>>0,V={offset:I-w,size:0};S=h.reduce(function(ae,ee){var se={item:ee.item,position:{offset:V.offset+V.size+w,size:E?D:ee.barSize}},ue=[].concat(aq(ae),[se]);return V=ue[ue.length-1].position,ee.stackList&&ee.stackList.length&&ee.stackList.forEach(function(he){ue.push({item:he,position:V})}),ue},T)}else{var H=bc(n,a,0,!0);a-2*H-(x-1)*w<=0&&(w=0);var K=(a-2*H-(x-1)*w)/x;K>1&&(K>>=0);var Q=i===+i?Math.min(K,i):K;S=h.reduce(function(ae,ee,se){var ue=[].concat(aq(ae),[{item:ee.item,position:{offset:H+(K+w)*se+(K-Q)/2,size:Q}}]);return ee.stackList&&ee.stackList.length&&ee.stackList.forEach(function(he){ue.push({item:he,position:ue[ue.length-1].position})}),ue},T)}return S},kCe=function(t,r,n,a){var c=n.children,h=n.width,i=n.margin,x=h-(i.left||0)-(i.right||0),w=vee({children:c,legendWidth:x});if(w){var S=a||{},T=S.width,E=S.height,D=w.align,U=w.verticalAlign,I=w.layout;if((I==="vertical"||I==="horizontal"&&U==="middle")&&D!=="center"&&Dr(t[D]))return Ys(Ys({},t),{},Av({},D,t[D]+(T||0)));if((I==="horizontal"||I==="vertical"&&D==="center")&&U!=="middle"&&Dr(t[U]))return Ys(Ys({},t),{},Av({},U,t[U]+(E||0)))}return t},PCe=function(t,r,n){return Yn(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},_ee=function(t,r,n,a,c){var h=r.props.children,i=rc(h,L_).filter(function(w){return PCe(a,c,w.props.direction)});if(i&&i.length){var x=i.map(function(w){return w.props.dataKey});return t.reduce(function(w,S){var T=ns(S,n);if(Yn(T))return w;var E=Array.isArray(T)?[_j(T),qg(T)]:[T,T],D=x.reduce(function(U,I){var V=ns(S,I,0),H=E[0]-Math.abs(Array.isArray(V)?V[0]:V),K=E[1]+Math.abs(Array.isArray(V)?V[1]:V);return[Math.min(H,U[0]),Math.max(K,U[1])]},[1/0,-1/0]);return[Math.min(D[0],w[0]),Math.max(D[1],w[1])]},[1/0,-1/0])}return null},CCe=function(t,r,n,a,c){var h=r.map(function(i){return _ee(t,i,n,c,a)}).filter(function(i){return!Yn(i)});return h&&h.length?h.reduce(function(i,x){return[Math.min(i[0],x[0]),Math.max(i[1],x[1])]},[1/0,-1/0]):null},bee=function(t,r,n,a,c){var h=r.map(function(x){var w=x.props.dataKey;return n==="number"&&w&&_ee(t,x,w,a)||x1(t,w,n,c)});if(n==="number")return h.reduce(function(x,w){return[Math.min(x[0],w[0]),Math.max(x[1],w[1])]},[1/0,-1/0]);var i={};return h.reduce(function(x,w){for(var S=0,T=w.length;S<T;S++)i[w[S]]||(i[w[S]]=!0,x.push(w[S]));return x},[])},wee=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},See=function(t,r,n,a){if(a)return t.map(function(x){return x.coordinate});var c,h,i=t.map(function(x){return x.coordinate===r&&(c=!0),x.coordinate===n&&(h=!0),x.coordinate});return c||i.push(r),h||i.push(n),i},gm=function(t,r,n){if(!t)return null;var a=t.scale,c=t.duplicateDomain,h=t.type,i=t.range,x=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,w=(r||n)&&h==="category"&&a.bandwidth?a.bandwidth()/x:0;if(w=t.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?hl(i[0]-i[1])*2*w:w,r&&(t.ticks||t.niceTicks)){var S=(t.ticks||t.niceTicks).map(function(T){var E=c?c.indexOf(T):T;return{coordinate:a(E)+w,value:T,offset:w}});return S.filter(function(T){return!E_(T.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(T,E){return{coordinate:a(T)+w,value:T,index:E,offset:w}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(T){return{coordinate:a(T)+w,value:T,offset:w}}):a.domain().map(function(T,E){return{coordinate:a(T)+w,value:c?c[T]:T,index:E,offset:w}})},oO=new WeakMap,tN=function(t,r){if(typeof r!="function")return t;oO.has(t)||oO.set(t,new WeakMap);var n=oO.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},Nee=function(t,r,n){var a=t.scale,c=t.type,h=t.layout,i=t.axisType;if(a==="auto")return h==="radial"&&i==="radiusAxis"?{scale:lw(),realScaleType:"band"}:h==="radial"&&i==="angleAxis"?{scale:EA(),realScaleType:"linear"}:c==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:y1(),realScaleType:"point"}:c==="category"?{scale:lw(),realScaleType:"band"}:{scale:EA(),realScaleType:"linear"};if(g2(a)){var x="scale".concat(aj(a));return{scale:(G9[x]||y1)(),realScaleType:G9[x]?x:"point"}}return qn(a)?{scale:a}:{scale:y1(),realScaleType:"point"}},oq=1e-4,Aee=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),c=Math.min(a[0],a[1])-oq,h=Math.max(a[0],a[1])+oq,i=t(r[0]),x=t(r[n-1]);(i<c||i>h||x<c||x>h)&&t.domain([r[0],r[n-1]])}},Tee=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},jee=function(t,r){if(!r||r.length!==2||!Dr(r[0])||!Dr(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),c=[t[0],t[1]];return(!Dr(t[0])||t[0]<n)&&(c[0]=n),(!Dr(t[1])||t[1]>a)&&(c[1]=a),c[0]>a&&(c[0]=a),c[1]<n&&(c[1]=n),c},ECe=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var c=0,h=0,i=0;i<r;++i){var x=E_(t[i][n][1])?t[i][n][0]:t[i][n][1];x>=0?(t[i][n][0]=c,t[i][n][1]=c+x,c=t[i][n][1]):(t[i][n][0]=h,t[i][n][1]=h+x,h=t[i][n][1])}},MCe=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var c=0,h=0;h<r;++h){var i=E_(t[h][n][1])?t[h][n][0]:t[h][n][1];i>=0?(t[h][n][0]=c,t[h][n][1]=c+i,c=t[h][n][1]):(t[h][n][0]=0,t[h][n][1]=0)}},OCe={sign:ECe,expand:wSe,none:Iv,silhouette:SSe,wiggle:NSe,positive:MCe},RCe=function(t,r,n){var a=r.map(function(i){return i.props.dataKey}),c=OCe[n],h=bSe().keys(a).value(function(i,x){return+ns(i,x,0)}).order(oI).offset(c);return h(t)},ICe=function(t,r,n,a,c,h){if(!t)return null;var i=h?r.reverse():r,x={},w=i.reduce(function(T,E){var D,U=(D=E.type)!==null&&D!==void 0&&D.defaultProps?Ys(Ys({},E.type.defaultProps),E.props):E.props,I=U.stackId,V=U.hide;if(V)return T;var H=U[n],K=T[H]||{hasStack:!1,stackGroups:{}};if(Wo(I)){var Q=K.stackGroups[I]||{numericAxisId:n,cateAxisId:a,items:[]};Q.items.push(E),K.hasStack=!0,K.stackGroups[I]=Q}else K.stackGroups[hy("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[E]};return Ys(Ys({},T),{},Av({},H,K))},x),S={};return Object.keys(w).reduce(function(T,E){var D=w[E];if(D.hasStack){var U={};D.stackGroups=Object.keys(D.stackGroups).reduce(function(I,V){var H=D.stackGroups[V];return Ys(Ys({},I),{},Av({},V,{numericAxisId:n,cateAxisId:a,items:H.items,stackedData:RCe(t,H.items,c)}))},U)}return Ys(Ys({},T),{},Av({},E,D))},S)},kee=function(t,r){var n=r.realScaleType,a=r.type,c=r.tickCount,h=r.originalDomain,i=r.allowDecimals,x=n||r.scale;if(x!=="auto"&&x!=="linear")return null;if(c&&a==="number"&&h&&(h[0]==="auto"||h[1]==="auto")){var w=t.domain();if(!w.length)return null;var S=XPe(w,c,i);return t.domain([_j(S),qg(S)]),{niceTicks:S}}if(c&&a==="number"){var T=t.domain(),E=JPe(T,c,i);return{niceTicks:E}}return null};function qv(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,c=e.index,h=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Yn(a[t.dataKey])){var i=fA(r,"value",a[t.dataKey]);if(i)return i.coordinate+n/2}return r[c]?r[c].coordinate+n/2:null}var x=ns(a,Yn(h)?t.dataKey:h);return Yn(x)?null:t.scale(x)}var FA=function(t){var r=t.axis,n=t.ticks,a=t.offset,c=t.bandSize,h=t.entry,i=t.index;if(r.type==="category")return n[i]?n[i].coordinate+a:null;var x=ns(h,r.dataKey,r.domain[i]);return Yn(x)?null:r.scale(x)-c/2+a},Pee=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),c=Math.max(n[0],n[1]);return a<=0&&c>=0?0:c<0?c:a}return n[0]},LCe=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Ys(Ys({},t.type.defaultProps),t.props):t.props,c=a.stackId;if(Wo(c)){var h=r[c];if(h){var i=h.items.indexOf(t);return i>=0?h.stackedData[i]:null}}return null},DCe=function(t){return t.reduce(function(r,n){return[_j(n.concat([r[0]]).filter(Dr)),qg(n.concat([r[1]]).filter(Dr))]},[1/0,-1/0])},Cee=function(t,r,n){return Object.keys(t).reduce(function(a,c){var h=t[c],i=h.stackedData,x=i.reduce(function(w,S){var T=DCe(S.slice(r,n+1));return[Math.min(w[0],T[0]),Math.max(w[1],T[1])]},[1/0,-1/0]);return[Math.min(x[0],a[0]),Math.max(x[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},lq=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,cq=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,MI=function(t,r,n){if(qn(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(Dr(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(lq.test(t[0])){var c=+lq.exec(t[0])[1];a[0]=r[0]-c}else qn(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Dr(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(cq.test(t[1])){var h=+cq.exec(t[1])[1];a[1]=r[1]+h}else qn(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},zA=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var c=YL(r,function(T){return T.coordinate}),h=1/0,i=1,x=c.length;i<x;i++){var w=c[i],S=c[i-1];h=Math.min((w.coordinate||0)-(S.coordinate||0),h)}return h===1/0?0:h}return n?void 0:0},uq=function(t,r,n){return!t||!t.length||Em(t,Du(n,"type.defaultProps.domain"))?r:t},SD=function(t,r){var n=t.type.defaultProps?Ys(Ys({},t.type.defaultProps),t.props):t.props,a=n.dataKey,c=n.name,h=n.unit,i=n.formatter,x=n.tooltipType,w=n.chartType,S=n.hide;return Ys(Ys({},wn(t,!1)),{},{dataKey:a,unit:h,formatter:i,name:c||a,color:wD(t),value:ns(r,a),type:x,payload:r,chartType:w,hide:S})};function yw(e){"@babel/helpers - typeof";return yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yw(e)}function dq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dq(Object(r),!0).forEach(function(n){Eee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Eee(e,t,r){return t=FCe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FCe(e){var t=zCe(e,"string");return yw(t)=="symbol"?t:t+""}function zCe(e,t){if(yw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(yw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BCe(e,t){return qCe(e)||$Ce(e,t)||UCe(e,t)||VCe()}function VCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UCe(e,t){if(e){if(typeof e=="string")return hq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hq(e,t)}}function hq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $Ce(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,h,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(S){w=!0,a=S}finally{try{if(!x&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function qCe(e){if(Array.isArray(e))return e}var BA=Math.PI/180,GCe=function(t){return t*180/Math.PI},Ga=function(t,r,n,a){return{x:t+Math.cos(-BA*a)*n,y:r+Math.sin(-BA*a)*n}},Mee=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Oee=function(t,r,n,a,c){var h=t.width,i=t.height,x=t.startAngle,w=t.endAngle,S=bc(t.cx,h,h/2),T=bc(t.cy,i,i/2),E=Mee(h,i,n),D=bc(t.innerRadius,E,0),U=bc(t.outerRadius,E,E*.8),I=Object.keys(r);return I.reduce(function(V,H){var K=r[H],Q=K.domain,ae=K.reversed,ee;if(Yn(K.range))a==="angleAxis"?ee=[x,w]:a==="radiusAxis"&&(ee=[D,U]),ae&&(ee=[ee[1],ee[0]]);else{ee=K.range;var se=ee,ue=BCe(se,2);x=ue[0],w=ue[1]}var he=Nee(K,c),Ce=he.realScaleType,Ne=he.scale;Ne.domain(Q).range(ee),Aee(Ne);var me=kee(Ne,dm(dm({},K),{},{realScaleType:Ce})),be=dm(dm(dm({},K),me),{},{range:ee,radius:U,realScaleType:Ce,scale:Ne,cx:S,cy:T,innerRadius:D,outerRadius:U,startAngle:x,endAngle:w});return dm(dm({},V),{},Eee({},H,be))},{})},WCe=function(t,r){var n=t.x,a=t.y,c=r.x,h=r.y;return Math.sqrt(Math.pow(n-c,2)+Math.pow(a-h,2))},HCe=function(t,r){var n=t.x,a=t.y,c=r.cx,h=r.cy,i=WCe({x:n,y:a},{x:c,y:h});if(i<=0)return{radius:i};var x=(n-c)/i,w=Math.acos(x);return a>h&&(w=2*Math.PI-w),{radius:i,angle:GCe(w),angleInRadian:w}},KCe=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),c=Math.floor(n/360),h=Math.min(a,c);return{startAngle:r-h*360,endAngle:n-h*360}},ZCe=function(t,r){var n=r.startAngle,a=r.endAngle,c=Math.floor(n/360),h=Math.floor(a/360),i=Math.min(c,h);return t+i*360},fq=function(t,r){var n=t.x,a=t.y,c=HCe({x:n,y:a},r),h=c.radius,i=c.angle,x=r.innerRadius,w=r.outerRadius;if(h<x||h>w)return!1;if(h===0)return!0;var S=KCe(r),T=S.startAngle,E=S.endAngle,D=i,U;if(T<=E){for(;D>E;)D-=360;for(;D<T;)D+=360;U=D>=T&&D<=E}else{for(;D>T;)D-=360;for(;D<E;)D+=360;U=D>=E&&D<=T}return U?dm(dm({},r),{},{radius:h,angle:ZCe(D,r)}):null},Ree=function(t){return!G.isValidElement(t)&&!qn(t)&&typeof t!="boolean"?t.className:""};function xw(e){"@babel/helpers - typeof";return xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xw(e)}var YCe=["offset"];function XCe(e){return tEe(e)||eEe(e)||QCe(e)||JCe()}function JCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QCe(e,t){if(e){if(typeof e=="string")return OI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OI(e,t)}}function eEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tEe(e){if(Array.isArray(e))return OI(e)}function OI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rEe(e,t){if(e==null)return{};var r=nEe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function nEe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function pq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pq(Object(r),!0).forEach(function(n){iEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iEe(e,t,r){return t=aEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aEe(e){var t=sEe(e,"string");return xw(t)=="symbol"?t:t+""}function sEe(e,t){if(xw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vw(){return vw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vw.apply(this,arguments)}var oEe=function(t){var r=t.value,n=t.formatter,a=Yn(t.children)?r:t.children;return qn(n)?n(a):a},lEe=function(t,r){var n=hl(r-t),a=Math.min(Math.abs(r-t),360);return n*a},cEe=function(t,r,n){var a=t.position,c=t.viewBox,h=t.offset,i=t.className,x=c,w=x.cx,S=x.cy,T=x.innerRadius,E=x.outerRadius,D=x.startAngle,U=x.endAngle,I=x.clockWise,V=(T+E)/2,H=lEe(D,U),K=H>=0?1:-1,Q,ae;a==="insideStart"?(Q=D+K*h,ae=I):a==="insideEnd"?(Q=U-K*h,ae=!I):a==="end"&&(Q=U+K*h,ae=I),ae=H<=0?ae:!ae;var ee=Ga(w,S,V,Q),se=Ga(w,S,V,Q+(ae?1:-1)*359),ue="M".concat(ee.x,",").concat(ee.y,`
    A`).concat(V,",").concat(V,",0,1,").concat(ae?0:1,`,
    `).concat(se.x,",").concat(se.y),he=Yn(t.id)?hy("recharts-radial-line-"):t.id;return Le.createElement("text",vw({},n,{dominantBaseline:"central",className:di("recharts-radial-bar-label",i)}),Le.createElement("defs",null,Le.createElement("path",{id:he,d:ue})),Le.createElement("textPath",{xlinkHref:"#".concat(he)},r))},uEe=function(t){var r=t.viewBox,n=t.offset,a=t.position,c=r,h=c.cx,i=c.cy,x=c.innerRadius,w=c.outerRadius,S=c.startAngle,T=c.endAngle,E=(S+T)/2;if(a==="outside"){var D=Ga(h,i,w+n,E),U=D.x,I=D.y;return{x:U,y:I,textAnchor:U>=h?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:h,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:h,y:i,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:h,y:i,textAnchor:"middle",verticalAnchor:"end"};var V=(x+w)/2,H=Ga(h,i,V,E),K=H.x,Q=H.y;return{x:K,y:Q,textAnchor:"middle",verticalAnchor:"middle"}},dEe=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,c=t.position,h=r,i=h.x,x=h.y,w=h.width,S=h.height,T=S>=0?1:-1,E=T*a,D=T>0?"end":"start",U=T>0?"start":"end",I=w>=0?1:-1,V=I*a,H=I>0?"end":"start",K=I>0?"start":"end";if(c==="top"){var Q={x:i+w/2,y:x-T*a,textAnchor:"middle",verticalAnchor:D};return qo(qo({},Q),n?{height:Math.max(x-n.y,0),width:w}:{})}if(c==="bottom"){var ae={x:i+w/2,y:x+S+E,textAnchor:"middle",verticalAnchor:U};return qo(qo({},ae),n?{height:Math.max(n.y+n.height-(x+S),0),width:w}:{})}if(c==="left"){var ee={x:i-V,y:x+S/2,textAnchor:H,verticalAnchor:"middle"};return qo(qo({},ee),n?{width:Math.max(ee.x-n.x,0),height:S}:{})}if(c==="right"){var se={x:i+w+V,y:x+S/2,textAnchor:K,verticalAnchor:"middle"};return qo(qo({},se),n?{width:Math.max(n.x+n.width-se.x,0),height:S}:{})}var ue=n?{width:w,height:S}:{};return c==="insideLeft"?qo({x:i+V,y:x+S/2,textAnchor:K,verticalAnchor:"middle"},ue):c==="insideRight"?qo({x:i+w-V,y:x+S/2,textAnchor:H,verticalAnchor:"middle"},ue):c==="insideTop"?qo({x:i+w/2,y:x+E,textAnchor:"middle",verticalAnchor:U},ue):c==="insideBottom"?qo({x:i+w/2,y:x+S-E,textAnchor:"middle",verticalAnchor:D},ue):c==="insideTopLeft"?qo({x:i+V,y:x+E,textAnchor:K,verticalAnchor:U},ue):c==="insideTopRight"?qo({x:i+w-V,y:x+E,textAnchor:H,verticalAnchor:U},ue):c==="insideBottomLeft"?qo({x:i+V,y:x+S-E,textAnchor:K,verticalAnchor:D},ue):c==="insideBottomRight"?qo({x:i+w-V,y:x+S-E,textAnchor:H,verticalAnchor:D},ue):C_(c)&&(Dr(c.x)||j0(c.x))&&(Dr(c.y)||j0(c.y))?qo({x:i+bc(c.x,w),y:x+bc(c.y,S),textAnchor:"end",verticalAnchor:"end"},ue):qo({x:i+w/2,y:x+S/2,textAnchor:"middle",verticalAnchor:"middle"},ue)},hEe=function(t){return"cx"in t&&Dr(t.cx)};function dl(e){var t=e.offset,r=t===void 0?5:t,n=rEe(e,YCe),a=qo({offset:r},n),c=a.viewBox,h=a.position,i=a.value,x=a.children,w=a.content,S=a.className,T=S===void 0?"":S,E=a.textBreakAll;if(!c||Yn(i)&&Yn(x)&&!G.isValidElement(w)&&!qn(w))return null;if(G.isValidElement(w))return G.cloneElement(w,a);var D;if(qn(w)){if(D=G.createElement(w,a),G.isValidElement(D))return D}else D=oEe(a);var U=hEe(c),I=wn(a,!0);if(U&&(h==="insideStart"||h==="insideEnd"||h==="end"))return cEe(a,D,I);var V=U?uEe(a):dEe(a);return Le.createElement(W0,vw({className:di("recharts-label",T)},I,V,{breakAll:E}),D)}dl.displayName="Label";var Iee=function(t){var r=t.cx,n=t.cy,a=t.angle,c=t.startAngle,h=t.endAngle,i=t.r,x=t.radius,w=t.innerRadius,S=t.outerRadius,T=t.x,E=t.y,D=t.top,U=t.left,I=t.width,V=t.height,H=t.clockWise,K=t.labelViewBox;if(K)return K;if(Dr(I)&&Dr(V)){if(Dr(T)&&Dr(E))return{x:T,y:E,width:I,height:V};if(Dr(D)&&Dr(U))return{x:D,y:U,width:I,height:V}}return Dr(T)&&Dr(E)?{x:T,y:E,width:0,height:0}:Dr(r)&&Dr(n)?{cx:r,cy:n,startAngle:c||a||0,endAngle:h||a||0,innerRadius:w||0,outerRadius:S||x||i||0,clockWise:H}:t.viewBox?t.viewBox:{}},fEe=function(t,r){return t?t===!0?Le.createElement(dl,{key:"label-implicit",viewBox:r}):Wo(t)?Le.createElement(dl,{key:"label-implicit",viewBox:r,value:t}):G.isValidElement(t)?t.type===dl?G.cloneElement(t,{key:"label-implicit",viewBox:r}):Le.createElement(dl,{key:"label-implicit",content:t,viewBox:r}):qn(t)?Le.createElement(dl,{key:"label-implicit",content:t,viewBox:r}):C_(t)?Le.createElement(dl,vw({viewBox:r},t,{key:"label-implicit"})):null:null},pEe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,c=Iee(t),h=rc(a,dl).map(function(x,w){return G.cloneElement(x,{viewBox:r||c,key:"label-".concat(w)})});if(!n)return h;var i=fEe(t.label,r||c);return[i].concat(XCe(h))};dl.parseViewBox=Iee;dl.renderCallByParent=pEe;var lO,mq;function mEe(){if(mq)return lO;mq=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return lO=e,lO}var gEe=mEe();const yEe=ha(gEe);function _w(e){"@babel/helpers - typeof";return _w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_w(e)}var xEe=["valueAccessor"],vEe=["data","dataKey","clockWise","id","textBreakAll"];function _Ee(e){return NEe(e)||SEe(e)||wEe(e)||bEe()}function bEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wEe(e,t){if(e){if(typeof e=="string")return RI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RI(e,t)}}function SEe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function NEe(e){if(Array.isArray(e))return RI(e)}function RI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function VA(){return VA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VA.apply(this,arguments)}function gq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gq(Object(r),!0).forEach(function(n){AEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AEe(e,t,r){return t=TEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TEe(e){var t=jEe(e,"string");return _w(t)=="symbol"?t:t+""}function jEe(e,t){if(_w(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_w(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xq(e,t){if(e==null)return{};var r=kEe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kEe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var PEe=function(t){return Array.isArray(t.value)?yEe(t.value):t.value};function Fd(e){var t=e.valueAccessor,r=t===void 0?PEe:t,n=xq(e,xEe),a=n.data,c=n.dataKey,h=n.clockWise,i=n.id,x=n.textBreakAll,w=xq(n,vEe);return!a||!a.length?null:Le.createElement(fi,{className:"recharts-label-list"},a.map(function(S,T){var E=Yn(c)?r(S,T):ns(S&&S.payload,c),D=Yn(i)?{}:{id:"".concat(i,"-").concat(T)};return Le.createElement(dl,VA({},wn(S,!0),w,D,{parentViewBox:S.parentViewBox,value:E,textBreakAll:x,viewBox:dl.parseViewBox(Yn(h)?S:yq(yq({},S),{},{clockWise:h})),key:"label-".concat(T),index:T}))}))}Fd.displayName="LabelList";function CEe(e,t){return e?e===!0?Le.createElement(Fd,{key:"labelList-implicit",data:t}):Le.isValidElement(e)||qn(e)?Le.createElement(Fd,{key:"labelList-implicit",data:t,content:e}):C_(e)?Le.createElement(Fd,VA({data:t},e,{key:"labelList-implicit"})):null:null}function EEe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=rc(n,Fd).map(function(h,i){return G.cloneElement(h,{data:t,key:"labelList-".concat(i)})});if(!r)return a;var c=CEe(e.label,t);return[c].concat(_Ee(a))}Fd.renderCallByParent=EEe;function bw(e){"@babel/helpers - typeof";return bw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bw(e)}function II(){return II=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},II.apply(this,arguments)}function vq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _q(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vq(Object(r),!0).forEach(function(n){MEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MEe(e,t,r){return t=OEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OEe(e){var t=REe(e,"string");return bw(t)=="symbol"?t:t+""}function REe(e,t){if(bw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(bw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IEe=function(t,r){var n=hl(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},rN=function(t){var r=t.cx,n=t.cy,a=t.radius,c=t.angle,h=t.sign,i=t.isExternal,x=t.cornerRadius,w=t.cornerIsExternal,S=x*(i?1:-1)+a,T=Math.asin(x/S)/BA,E=w?c:c+h*T,D=Ga(r,n,S,E),U=Ga(r,n,a,E),I=w?c-h*T:c,V=Ga(r,n,S*Math.cos(T*BA),I);return{center:D,circleTangency:U,lineTangency:V,theta:T}},Lee=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,c=t.outerRadius,h=t.startAngle,i=t.endAngle,x=IEe(h,i),w=h+x,S=Ga(r,n,c,h),T=Ga(r,n,c,w),E="M ".concat(S.x,",").concat(S.y,`
    A `).concat(c,",").concat(c,`,0,
    `).concat(+(Math.abs(x)>180),",").concat(+(h>w),`,
    `).concat(T.x,",").concat(T.y,`
  `);if(a>0){var D=Ga(r,n,a,h),U=Ga(r,n,a,w);E+="L ".concat(U.x,",").concat(U.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(x)>180),",").concat(+(h<=w),`,
            `).concat(D.x,",").concat(D.y," Z")}else E+="L ".concat(r,",").concat(n," Z");return E},LEe=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,c=t.outerRadius,h=t.cornerRadius,i=t.forceCornerRadius,x=t.cornerIsExternal,w=t.startAngle,S=t.endAngle,T=hl(S-w),E=rN({cx:r,cy:n,radius:c,angle:w,sign:T,cornerRadius:h,cornerIsExternal:x}),D=E.circleTangency,U=E.lineTangency,I=E.theta,V=rN({cx:r,cy:n,radius:c,angle:S,sign:-T,cornerRadius:h,cornerIsExternal:x}),H=V.circleTangency,K=V.lineTangency,Q=V.theta,ae=x?Math.abs(w-S):Math.abs(w-S)-I-Q;if(ae<0)return i?"M ".concat(U.x,",").concat(U.y,`
        a`).concat(h,",").concat(h,",0,0,1,").concat(h*2,`,0
        a`).concat(h,",").concat(h,",0,0,1,").concat(-h*2,`,0
      `):Lee({cx:r,cy:n,innerRadius:a,outerRadius:c,startAngle:w,endAngle:S});var ee="M ".concat(U.x,",").concat(U.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(T<0),",").concat(D.x,",").concat(D.y,`
    A`).concat(c,",").concat(c,",0,").concat(+(ae>180),",").concat(+(T<0),",").concat(H.x,",").concat(H.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(T<0),",").concat(K.x,",").concat(K.y,`
  `);if(a>0){var se=rN({cx:r,cy:n,radius:a,angle:w,sign:T,isExternal:!0,cornerRadius:h,cornerIsExternal:x}),ue=se.circleTangency,he=se.lineTangency,Ce=se.theta,Ne=rN({cx:r,cy:n,radius:a,angle:S,sign:-T,isExternal:!0,cornerRadius:h,cornerIsExternal:x}),me=Ne.circleTangency,be=Ne.lineTangency,pe=Ne.theta,Se=x?Math.abs(w-S):Math.abs(w-S)-Ce-pe;if(Se<0&&h===0)return"".concat(ee,"L").concat(r,",").concat(n,"Z");ee+="L".concat(be.x,",").concat(be.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(T<0),",").concat(me.x,",").concat(me.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(Se>180),",").concat(+(T>0),",").concat(ue.x,",").concat(ue.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(T<0),",").concat(he.x,",").concat(he.y,"Z")}else ee+="L".concat(r,",").concat(n,"Z");return ee},DEe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Dee=function(t){var r=_q(_q({},DEe),t),n=r.cx,a=r.cy,c=r.innerRadius,h=r.outerRadius,i=r.cornerRadius,x=r.forceCornerRadius,w=r.cornerIsExternal,S=r.startAngle,T=r.endAngle,E=r.className;if(h<c||S===T)return null;var D=di("recharts-sector",E),U=h-c,I=bc(i,U,0,!0),V;return I>0&&Math.abs(S-T)<360?V=LEe({cx:n,cy:a,innerRadius:c,outerRadius:h,cornerRadius:Math.min(I,U/2),forceCornerRadius:x,cornerIsExternal:w,startAngle:S,endAngle:T}):V=Lee({cx:n,cy:a,innerRadius:c,outerRadius:h,startAngle:S,endAngle:T}),Le.createElement("path",II({},wn(r,!0),{className:D,d:V,role:"img"}))};function ww(e){"@babel/helpers - typeof";return ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ww(e)}function LI(){return LI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},LI.apply(this,arguments)}function bq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bq(Object(r),!0).forEach(function(n){FEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FEe(e,t,r){return t=zEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zEe(e){var t=BEe(e,"string");return ww(t)=="symbol"?t:t+""}function BEe(e,t){if(ww(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ww(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sq={curveBasisClosed:uSe,curveBasisOpen:dSe,curveBasis:cSe,curveBumpX:Z2e,curveBumpY:Y2e,curveLinearClosed:hSe,curveLinear:oj,curveMonotoneX:fSe,curveMonotoneY:pSe,curveNatural:mSe,curveStep:gSe,curveStepAfter:xSe,curveStepBefore:ySe},nN=function(t){return t.x===+t.x&&t.y===+t.y},Gb=function(t){return t.x},Wb=function(t){return t.y},VEe=function(t,r){if(qn(t))return t;var n="curve".concat(aj(t));return(n==="curveMonotone"||n==="curveBump")&&r?Sq["".concat(n).concat(r==="vertical"?"Y":"X")]:Sq[n]||oj},UEe=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,c=a===void 0?[]:a,h=t.baseLine,i=t.layout,x=t.connectNulls,w=x===void 0?!1:x,S=VEe(n,i),T=w?c.filter(function(I){return nN(I)}):c,E;if(Array.isArray(h)){var D=w?h.filter(function(I){return nN(I)}):h,U=T.map(function(I,V){return wq(wq({},I),{},{base:D[V]})});return i==="vertical"?E=KS().y(Wb).x1(Gb).x0(function(I){return I.base.x}):E=KS().x(Gb).y1(Wb).y0(function(I){return I.base.y}),E.defined(nN).curve(S),E(U)}return i==="vertical"&&Dr(h)?E=KS().y(Wb).x1(Gb).x0(h):Dr(h)?E=KS().x(Gb).y1(Wb).y0(h):E=MJ().x(Gb).y(Wb),E.defined(nN).curve(S),E(T)},Yg=function(t){var r=t.className,n=t.points,a=t.path,c=t.pathRef;if((!n||!n.length)&&!a)return null;var h=n&&n.length?UEe(t):a;return Le.createElement("path",LI({},wn(t,!1),pA(t),{className:di("recharts-curve",r),d:h,ref:c}))},cO={exports:{}},uO,Nq;function $Ee(){if(Nq)return uO;Nq=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return uO=e,uO}var dO,Aq;function qEe(){if(Aq)return dO;Aq=1;var e=$Ee();function t(){}function r(){}return r.resetWarningCache=t,dO=function(){function n(h,i,x,w,S,T){if(T!==e){var E=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw E.name="Invariant Violation",E}}n.isRequired=n;function a(){return n}var c={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:r,resetWarningCache:t};return c.PropTypes=c,c},dO}var Tq;function GEe(){return Tq||(Tq=1,cO.exports=qEe()()),cO.exports}var WEe=GEe();const Ta=ha(WEe);var HEe=Object.getOwnPropertyNames,KEe=Object.getOwnPropertySymbols,ZEe=Object.prototype.hasOwnProperty;function jq(e,t){return function(n,a,c){return e(n,a,c)&&t(n,a,c)}}function iN(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var c=a.cache,h=c.get(r),i=c.get(n);if(h&&i)return h===n&&i===r;c.set(r,n),c.set(n,r);var x=e(r,n,a);return c.delete(r),c.delete(n),x}}function kq(e){return HEe(e).concat(KEe(e))}var YEe=Object.hasOwn||function(e,t){return ZEe.call(e,t)};function ax(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var XEe="__v",JEe="__o",QEe="_owner",Pq=Object.getOwnPropertyDescriptor,Cq=Object.keys;function eMe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function tMe(e,t){return ax(e.getTime(),t.getTime())}function rMe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function nMe(e,t){return e===t}function Eq(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),c=e.entries(),h,i,x=0;(h=c.next())&&!h.done;){for(var w=t.entries(),S=!1,T=0;(i=w.next())&&!i.done;){if(a[T]){T++;continue}var E=h.value,D=i.value;if(r.equals(E[0],D[0],x,T,e,t,r)&&r.equals(E[1],D[1],E[0],D[0],e,t,r)){S=a[T]=!0;break}T++}if(!S)return!1;x++}return!0}var iMe=ax;function aMe(e,t,r){var n=Cq(e),a=n.length;if(Cq(t).length!==a)return!1;for(;a-- >0;)if(!Fee(e,t,r,n[a]))return!1;return!0}function Hb(e,t,r){var n=kq(e),a=n.length;if(kq(t).length!==a)return!1;for(var c,h,i;a-- >0;)if(c=n[a],!Fee(e,t,r,c)||(h=Pq(e,c),i=Pq(t,c),(h||i)&&(!h||!i||h.configurable!==i.configurable||h.enumerable!==i.enumerable||h.writable!==i.writable)))return!1;return!0}function sMe(e,t){return ax(e.valueOf(),t.valueOf())}function oMe(e,t){return e.source===t.source&&e.flags===t.flags}function Mq(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),c=e.values(),h,i;(h=c.next())&&!h.done;){for(var x=t.values(),w=!1,S=0;(i=x.next())&&!i.done;){if(!a[S]&&r.equals(h.value,i.value,h.value,i.value,e,t,r)){w=a[S]=!0;break}S++}if(!w)return!1}return!0}function lMe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function cMe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function Fee(e,t,r,n){return(n===QEe||n===JEe||n===XEe)&&(e.$$typeof||t.$$typeof)?!0:YEe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var uMe="[object Arguments]",dMe="[object Boolean]",hMe="[object Date]",fMe="[object Error]",pMe="[object Map]",mMe="[object Number]",gMe="[object Object]",yMe="[object RegExp]",xMe="[object Set]",vMe="[object String]",_Me="[object URL]",bMe=Array.isArray,Oq=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Rq=Object.assign,wMe=Object.prototype.toString.call.bind(Object.prototype.toString);function SMe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,c=e.areMapsEqual,h=e.areNumbersEqual,i=e.areObjectsEqual,x=e.arePrimitiveWrappersEqual,w=e.areRegExpsEqual,S=e.areSetsEqual,T=e.areTypedArraysEqual,E=e.areUrlsEqual;return function(U,I,V){if(U===I)return!0;if(U==null||I==null)return!1;var H=typeof U;if(H!==typeof I)return!1;if(H!=="object")return H==="number"?h(U,I,V):H==="function"?a(U,I,V):!1;var K=U.constructor;if(K!==I.constructor)return!1;if(K===Object)return i(U,I,V);if(bMe(U))return t(U,I,V);if(Oq!=null&&Oq(U))return T(U,I,V);if(K===Date)return r(U,I,V);if(K===RegExp)return w(U,I,V);if(K===Map)return c(U,I,V);if(K===Set)return S(U,I,V);var Q=wMe(U);return Q===hMe?r(U,I,V):Q===yMe?w(U,I,V):Q===pMe?c(U,I,V):Q===xMe?S(U,I,V):Q===gMe?typeof U.then!="function"&&typeof I.then!="function"&&i(U,I,V):Q===_Me?E(U,I,V):Q===fMe?n(U,I,V):Q===uMe?i(U,I,V):Q===dMe||Q===mMe||Q===vMe?x(U,I,V):!1}}function NMe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?Hb:eMe,areDatesEqual:tMe,areErrorsEqual:rMe,areFunctionsEqual:nMe,areMapsEqual:n?jq(Eq,Hb):Eq,areNumbersEqual:iMe,areObjectsEqual:n?Hb:aMe,arePrimitiveWrappersEqual:sMe,areRegExpsEqual:oMe,areSetsEqual:n?jq(Mq,Hb):Mq,areTypedArraysEqual:n?Hb:lMe,areUrlsEqual:cMe};if(r&&(a=Rq({},a,r(a))),t){var c=iN(a.areArraysEqual),h=iN(a.areMapsEqual),i=iN(a.areObjectsEqual),x=iN(a.areSetsEqual);a=Rq({},a,{areArraysEqual:c,areMapsEqual:h,areObjectsEqual:i,areSetsEqual:x})}return a}function AMe(e){return function(t,r,n,a,c,h,i){return e(t,r,i)}}function TMe(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,c=e.strict;if(n)return function(x,w){var S=n(),T=S.cache,E=T===void 0?t?new WeakMap:void 0:T,D=S.meta;return r(x,w,{cache:E,equals:a,meta:D,strict:c})};if(t)return function(x,w){return r(x,w,{cache:new WeakMap,equals:a,meta:void 0,strict:c})};var h={cache:void 0,equals:a,meta:void 0,strict:c};return function(x,w){return r(x,w,h)}}var jMe=my();my({strict:!0});my({circular:!0});my({circular:!0,strict:!0});my({createInternalComparator:function(){return ax}});my({strict:!0,createInternalComparator:function(){return ax}});my({circular:!0,createInternalComparator:function(){return ax}});my({circular:!0,createInternalComparator:function(){return ax},strict:!0});function my(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,c=e.strict,h=c===void 0?!1:c,i=NMe(e),x=SMe(i),w=n?n(x):AMe(x);return TMe({circular:r,comparator:x,createState:a,equals:w,strict:h})}function kMe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Iq(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(c){r<0&&(r=c),c-r>t?(e(c),r=-1):kMe(a)};requestAnimationFrame(n)}function DI(e){"@babel/helpers - typeof";return DI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},DI(e)}function PMe(e){return OMe(e)||MMe(e)||EMe(e)||CMe()}function CMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EMe(e,t){if(e){if(typeof e=="string")return Lq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lq(e,t)}}function Lq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function OMe(e){if(Array.isArray(e))return e}function RMe(){var e={},t=function(){return null},r=!1,n=function a(c){if(!r){if(Array.isArray(c)){if(!c.length)return;var h=c,i=PMe(h),x=i[0],w=i.slice(1);if(typeof x=="number"){Iq(a.bind(null,w),x);return}a(x),Iq(a.bind(null,w));return}DI(c)==="object"&&(e=c,t(e)),typeof c=="function"&&c()}};return{stop:function(){r=!0},start:function(c){r=!1,n(c)},subscribe:function(c){return t=c,function(){t=function(){return null}}}}}function Sw(e){"@babel/helpers - typeof";return Sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sw(e)}function Dq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Dq(Object(r),!0).forEach(function(n){zee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zee(e,t,r){return t=IMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IMe(e){var t=LMe(e,"string");return Sw(t)==="symbol"?t:String(t)}function LMe(e,t){if(Sw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DMe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(c){return a.includes(c)})})},FMe=function(t){return t},zMe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},v1=function(t,r){return Object.keys(r).reduce(function(n,a){return Fq(Fq({},n),{},zee({},a,t(a,r[a])))},{})},zq=function(t,r,n){return t.map(function(a){return"".concat(zMe(a)," ").concat(r,"ms ").concat(n)}).join(",")};function BMe(e,t){return $Me(e)||UMe(e,t)||Bee(e,t)||VMe()}function VMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,h,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(S){w=!0,a=S}finally{try{if(!x&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function $Me(e){if(Array.isArray(e))return e}function qMe(e){return HMe(e)||WMe(e)||Bee(e)||GMe()}function GMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bee(e,t){if(e){if(typeof e=="string")return FI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FI(e,t)}}function WMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function HMe(e){if(Array.isArray(e))return FI(e)}function FI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var UA=1e-4,Vee=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},Uee=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},Bq=function(t,r){return function(n){var a=Vee(t,r);return Uee(a,n)}},KMe=function(t,r){return function(n){var a=Vee(t,r),c=[].concat(qMe(a.map(function(h,i){return h*i}).slice(1)),[0]);return Uee(c,n)}},Vq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],c=r[1],h=r[2],i=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,c=0,h=1,i=1;break;case"ease":a=.25,c=.1,h=.25,i=1;break;case"ease-in":a=.42,c=0,h=1,i=1;break;case"ease-out":a=.42,c=0,h=.58,i=1;break;case"ease-in-out":a=0,c=0,h=.58,i=1;break;default:{var x=r[0].split("(");if(x[0]==="cubic-bezier"&&x[1].split(")")[0].split(",").length===4){var w=x[1].split(")")[0].split(",").map(function(V){return parseFloat(V)}),S=BMe(w,4);a=S[0],c=S[1],h=S[2],i=S[3]}}}var T=Bq(a,h),E=Bq(c,i),D=KMe(a,h),U=function(H){return H>1?1:H<0?0:H},I=function(H){for(var K=H>1?1:H,Q=K,ae=0;ae<8;++ae){var ee=T(Q)-K,se=D(Q);if(Math.abs(ee-K)<UA||se<UA)return E(Q);Q=U(Q-ee/se)}return E(Q)};return I.isStepper=!1,I},ZMe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,c=a===void 0?8:a,h=t.dt,i=h===void 0?17:h,x=function(S,T,E){var D=-(S-T)*n,U=E*c,I=E+(D-U)*i/1e3,V=E*i/1e3+S;return Math.abs(V-T)<UA&&Math.abs(I)<UA?[T,0]:[V,I]};return x.isStepper=!0,x.dt=i,x},YMe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Vq(a);case"spring":return ZMe();default:if(a.split("(")[0]==="cubic-bezier")return Vq(a)}return typeof a=="function"?a:null};function Nw(e){"@babel/helpers - typeof";return Nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nw(e)}function Uq(e){return QMe(e)||JMe(e)||$ee(e)||XMe()}function XMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function QMe(e){if(Array.isArray(e))return BI(e)}function $q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Cl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$q(Object(r),!0).forEach(function(n){zI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$q(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zI(e,t,r){return t=eOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eOe(e){var t=tOe(e,"string");return Nw(t)==="symbol"?t:String(t)}function tOe(e,t){if(Nw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rOe(e,t){return aOe(e)||iOe(e,t)||$ee(e,t)||nOe()}function nOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ee(e,t){if(e){if(typeof e=="string")return BI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BI(e,t)}}function BI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function iOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,h,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(S){w=!0,a=S}finally{try{if(!x&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function aOe(e){if(Array.isArray(e))return e}var $A=function(t,r,n){return t+(r-t)*n},VI=function(t){var r=t.from,n=t.to;return r!==n},sOe=function e(t,r,n){var a=v1(function(c,h){if(VI(h)){var i=t(h.from,h.to,h.velocity),x=rOe(i,2),w=x[0],S=x[1];return Cl(Cl({},h),{},{from:w,velocity:S})}return h},r);return n<1?v1(function(c,h){return VI(h)?Cl(Cl({},h),{},{velocity:$A(h.velocity,a[c].velocity,n),from:$A(h.from,a[c].from,n)}):h},r):e(t,a,n-1)};const oOe=function(e,t,r,n,a){var c=DMe(e,t),h=c.reduce(function(V,H){return Cl(Cl({},V),{},zI({},H,[e[H],t[H]]))},{}),i=c.reduce(function(V,H){return Cl(Cl({},V),{},zI({},H,{from:e[H],velocity:0,to:t[H]}))},{}),x=-1,w,S,T=function(){return null},E=function(){return v1(function(H,K){return K.from},i)},D=function(){return!Object.values(i).filter(VI).length},U=function(H){w||(w=H);var K=H-w,Q=K/r.dt;i=sOe(r,i,Q),a(Cl(Cl(Cl({},e),t),E())),w=H,D()||(x=requestAnimationFrame(T))},I=function(H){S||(S=H);var K=(H-S)/n,Q=v1(function(ee,se){return $A.apply(void 0,Uq(se).concat([r(K)]))},h);if(a(Cl(Cl(Cl({},e),t),Q)),K<1)x=requestAnimationFrame(T);else{var ae=v1(function(ee,se){return $A.apply(void 0,Uq(se).concat([r(1)]))},h);a(Cl(Cl(Cl({},e),t),ae))}};return T=r.isStepper?U:I,function(){return requestAnimationFrame(T),function(){cancelAnimationFrame(x)}}};function Gv(e){"@babel/helpers - typeof";return Gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gv(e)}var lOe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function cOe(e,t){if(e==null)return{};var r=uOe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function uOe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,c;for(c=0;c<n.length;c++)a=n[c],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function hO(e){return pOe(e)||fOe(e)||hOe(e)||dOe()}function dOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hOe(e,t){if(e){if(typeof e=="string")return UI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UI(e,t)}}function fOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pOe(e){if(Array.isArray(e))return UI(e)}function UI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ih(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qq(Object(r),!0).forEach(function(n){o1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function o1(e,t,r){return t=qee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gOe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qee(n.key),n)}}function yOe(e,t,r){return t&&gOe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qee(e){var t=xOe(e,"string");return Gv(t)==="symbol"?t:String(t)}function xOe(e,t){if(Gv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$I(e,t)}function $I(e,t){return $I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$I(e,t)}function _Oe(e){var t=bOe();return function(){var n=qA(e),a;if(t){var c=qA(this).constructor;a=Reflect.construct(n,arguments,c)}else a=n.apply(this,arguments);return qI(this,a)}}function qI(e,t){if(t&&(Gv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GI(e)}function GI(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qA(e){return qA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qA(e)}var Bu=function(e){vOe(r,e);var t=_Oe(r);function r(n,a){var c;mOe(this,r),c=t.call(this,n,a);var h=c.props,i=h.isActive,x=h.attributeName,w=h.from,S=h.to,T=h.steps,E=h.children,D=h.duration;if(c.handleStyleChange=c.handleStyleChange.bind(GI(c)),c.changeStyle=c.changeStyle.bind(GI(c)),!i||D<=0)return c.state={style:{}},typeof E=="function"&&(c.state={style:S}),qI(c);if(T&&T.length)c.state={style:T[0].style};else if(w){if(typeof E=="function")return c.state={style:w},qI(c);c.state={style:x?o1({},x,w):w}}else c.state={style:{}};return c}return yOe(r,[{key:"componentDidMount",value:function(){var a=this.props,c=a.isActive,h=a.canBegin;this.mounted=!0,!(!c||!h)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var c=this.props,h=c.isActive,i=c.canBegin,x=c.attributeName,w=c.shouldReAnimate,S=c.to,T=c.from,E=this.state.style;if(i){if(!h){var D={style:x?o1({},x,S):S};this.state&&E&&(x&&E[x]!==S||!x&&E!==S)&&this.setState(D);return}if(!(jMe(a.to,S)&&a.canBegin&&a.isActive)){var U=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var I=U||w?T:a.to;if(this.state&&E){var V={style:x?o1({},x,I):I};(x&&E[x]!==I||!x&&E!==I)&&this.setState(V)}this.runAnimation(Ih(Ih({},this.props),{},{from:I,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var c=this,h=a.from,i=a.to,x=a.duration,w=a.easing,S=a.begin,T=a.onAnimationEnd,E=a.onAnimationStart,D=oOe(h,i,YMe(w),x,this.changeStyle),U=function(){c.stopJSAnimation=D()};this.manager.start([E,S,U,x,T])}},{key:"runStepAnimation",value:function(a){var c=this,h=a.steps,i=a.begin,x=a.onAnimationStart,w=h[0],S=w.style,T=w.duration,E=T===void 0?0:T,D=function(I,V,H){if(H===0)return I;var K=V.duration,Q=V.easing,ae=Q===void 0?"ease":Q,ee=V.style,se=V.properties,ue=V.onAnimationEnd,he=H>0?h[H-1]:V,Ce=se||Object.keys(ee);if(typeof ae=="function"||ae==="spring")return[].concat(hO(I),[c.runJSAnimation.bind(c,{from:he.style,to:ee,duration:K,easing:ae}),K]);var Ne=zq(Ce,K,ae),me=Ih(Ih(Ih({},he.style),ee),{},{transition:Ne});return[].concat(hO(I),[me,K,ue]).filter(FMe)};return this.manager.start([x].concat(hO(h.reduce(D,[S,Math.max(E,i)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=RMe());var c=a.begin,h=a.duration,i=a.attributeName,x=a.to,w=a.easing,S=a.onAnimationStart,T=a.onAnimationEnd,E=a.steps,D=a.children,U=this.manager;if(this.unSubscribe=U.subscribe(this.handleStyleChange),typeof w=="function"||typeof D=="function"||w==="spring"){this.runJSAnimation(a);return}if(E.length>1){this.runStepAnimation(a);return}var I=i?o1({},i,x):x,V=zq(Object.keys(I),h,w);U.start([S,c,Ih(Ih({},I),{},{transition:V}),h,T])}},{key:"render",value:function(){var a=this.props,c=a.children;a.begin;var h=a.duration;a.attributeName,a.easing;var i=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var x=cOe(a,lOe),w=G.Children.count(c),S=this.state.style;if(typeof c=="function")return c(S);if(!i||w===0||h<=0)return c;var T=function(D){var U=D.props,I=U.style,V=I===void 0?{}:I,H=U.className,K=G.cloneElement(D,Ih(Ih({},x),{},{style:Ih(Ih({},V),S),className:H}));return K};return w===1?T(G.Children.only(c)):Le.createElement("div",null,G.Children.map(c,function(E){return T(E)}))}}]),r}(G.PureComponent);Bu.displayName="Animate";Bu.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Bu.propTypes={from:Ta.oneOfType([Ta.object,Ta.string]),to:Ta.oneOfType([Ta.object,Ta.string]),attributeName:Ta.string,duration:Ta.number,begin:Ta.number,easing:Ta.oneOfType([Ta.string,Ta.func]),steps:Ta.arrayOf(Ta.shape({duration:Ta.number.isRequired,style:Ta.object.isRequired,easing:Ta.oneOfType([Ta.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Ta.func]),properties:Ta.arrayOf("string"),onAnimationEnd:Ta.func})),children:Ta.oneOfType([Ta.node,Ta.func]),isActive:Ta.bool,canBegin:Ta.bool,onAnimationEnd:Ta.func,shouldReAnimate:Ta.bool,onAnimationStart:Ta.func,onAnimationReStart:Ta.func};function Aw(e){"@babel/helpers - typeof";return Aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aw(e)}function GA(){return GA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GA.apply(this,arguments)}function wOe(e,t){return TOe(e)||AOe(e,t)||NOe(e,t)||SOe()}function SOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NOe(e,t){if(e){if(typeof e=="string")return Gq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gq(e,t)}}function Gq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,h,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(S){w=!0,a=S}finally{try{if(!x&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function TOe(e){if(Array.isArray(e))return e}function Wq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wq(Object(r),!0).forEach(function(n){jOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jOe(e,t,r){return t=kOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kOe(e){var t=POe(e,"string");return Aw(t)=="symbol"?t:t+""}function POe(e,t){if(Aw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Aw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kq=function(t,r,n,a,c){var h=Math.min(Math.abs(n)/2,Math.abs(a)/2),i=a>=0?1:-1,x=n>=0?1:-1,w=a>=0&&n>=0||a<0&&n<0?1:0,S;if(h>0&&c instanceof Array){for(var T=[0,0,0,0],E=0,D=4;E<D;E++)T[E]=c[E]>h?h:c[E];S="M".concat(t,",").concat(r+i*T[0]),T[0]>0&&(S+="A ".concat(T[0],",").concat(T[0],",0,0,").concat(w,",").concat(t+x*T[0],",").concat(r)),S+="L ".concat(t+n-x*T[1],",").concat(r),T[1]>0&&(S+="A ".concat(T[1],",").concat(T[1],",0,0,").concat(w,`,
        `).concat(t+n,",").concat(r+i*T[1])),S+="L ".concat(t+n,",").concat(r+a-i*T[2]),T[2]>0&&(S+="A ".concat(T[2],",").concat(T[2],",0,0,").concat(w,`,
        `).concat(t+n-x*T[2],",").concat(r+a)),S+="L ".concat(t+x*T[3],",").concat(r+a),T[3]>0&&(S+="A ".concat(T[3],",").concat(T[3],",0,0,").concat(w,`,
        `).concat(t,",").concat(r+a-i*T[3])),S+="Z"}else if(h>0&&c===+c&&c>0){var U=Math.min(h,c);S="M ".concat(t,",").concat(r+i*U,`
            A `).concat(U,",").concat(U,",0,0,").concat(w,",").concat(t+x*U,",").concat(r,`
            L `).concat(t+n-x*U,",").concat(r,`
            A `).concat(U,",").concat(U,",0,0,").concat(w,",").concat(t+n,",").concat(r+i*U,`
            L `).concat(t+n,",").concat(r+a-i*U,`
            A `).concat(U,",").concat(U,",0,0,").concat(w,",").concat(t+n-x*U,",").concat(r+a,`
            L `).concat(t+x*U,",").concat(r+a,`
            A `).concat(U,",").concat(U,",0,0,").concat(w,",").concat(t,",").concat(r+a-i*U," Z")}else S="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return S},COe=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,c=r.x,h=r.y,i=r.width,x=r.height;if(Math.abs(i)>0&&Math.abs(x)>0){var w=Math.min(c,c+i),S=Math.max(c,c+i),T=Math.min(h,h+x),E=Math.max(h,h+x);return n>=w&&n<=S&&a>=T&&a<=E}return!1},EOe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},ND=function(t){var r=Hq(Hq({},EOe),t),n=G.useRef(),a=G.useState(-1),c=wOe(a,2),h=c[0],i=c[1];G.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var ae=n.current.getTotalLength();ae&&i(ae)}catch{}},[]);var x=r.x,w=r.y,S=r.width,T=r.height,E=r.radius,D=r.className,U=r.animationEasing,I=r.animationDuration,V=r.animationBegin,H=r.isAnimationActive,K=r.isUpdateAnimationActive;if(x!==+x||w!==+w||S!==+S||T!==+T||S===0||T===0)return null;var Q=di("recharts-rectangle",D);return K?Le.createElement(Bu,{canBegin:h>0,from:{width:S,height:T,x,y:w},to:{width:S,height:T,x,y:w},duration:I,animationEasing:U,isActive:K},function(ae){var ee=ae.width,se=ae.height,ue=ae.x,he=ae.y;return Le.createElement(Bu,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:V,duration:I,isActive:H,easing:U},Le.createElement("path",GA({},wn(r,!0),{className:Q,d:Kq(ue,he,ee,se,E),ref:n})))}):Le.createElement("path",GA({},wn(r,!0),{className:Q,d:Kq(x,w,S,T,E)}))},MOe=["points","className","baseLinePoints","connectNulls"];function mv(){return mv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mv.apply(this,arguments)}function OOe(e,t){if(e==null)return{};var r=ROe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ROe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Zq(e){return FOe(e)||DOe(e)||LOe(e)||IOe()}function IOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LOe(e,t){if(e){if(typeof e=="string")return WI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WI(e,t)}}function DOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FOe(e){if(Array.isArray(e))return WI(e)}function WI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Yq=function(t){return t&&t.x===+t.x&&t.y===+t.y},zOe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){Yq(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),Yq(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},_1=function(t,r){var n=zOe(t);r&&(n=[n.reduce(function(c,h){return[].concat(Zq(c),Zq(h))},[])]);var a=n.map(function(c){return c.reduce(function(h,i,x){return"".concat(h).concat(x===0?"M":"L").concat(i.x,",").concat(i.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},BOe=function(t,r,n){var a=_1(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(_1(r.reverse(),n).slice(1))},VOe=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,c=t.connectNulls,h=OOe(t,MOe);if(!r||!r.length)return null;var i=di("recharts-polygon",n);if(a&&a.length){var x=h.stroke&&h.stroke!=="none",w=BOe(r,a,c);return Le.createElement("g",{className:i},Le.createElement("path",mv({},wn(h,!0),{fill:w.slice(-1)==="Z"?h.fill:"none",stroke:"none",d:w})),x?Le.createElement("path",mv({},wn(h,!0),{fill:"none",d:_1(r,c)})):null,x?Le.createElement("path",mv({},wn(h,!0),{fill:"none",d:_1(a,c)})):null)}var S=_1(r,c);return Le.createElement("path",mv({},wn(h,!0),{fill:S.slice(-1)==="Z"?h.fill:"none",className:i,d:S}))};function HI(){return HI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HI.apply(this,arguments)}var w2=function(t){var r=t.cx,n=t.cy,a=t.r,c=t.className,h=di("recharts-dot",c);return r===+r&&n===+n&&a===+a?Le.createElement("circle",HI({},wn(t,!1),pA(t),{className:h,cx:r,cy:n,r:a})):null};function Tw(e){"@babel/helpers - typeof";return Tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tw(e)}var UOe=["x","y","top","left","width","height","className"];function KI(){return KI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KI.apply(this,arguments)}function Xq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $Oe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xq(Object(r),!0).forEach(function(n){qOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qOe(e,t,r){return t=GOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GOe(e){var t=WOe(e,"string");return Tw(t)=="symbol"?t:t+""}function WOe(e,t){if(Tw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Tw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HOe(e,t){if(e==null)return{};var r=KOe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KOe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var ZOe=function(t,r,n,a,c,h){return"M".concat(t,",").concat(c,"v").concat(a,"M").concat(h,",").concat(r,"h").concat(n)},YOe=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,c=a===void 0?0:a,h=t.top,i=h===void 0?0:h,x=t.left,w=x===void 0?0:x,S=t.width,T=S===void 0?0:S,E=t.height,D=E===void 0?0:E,U=t.className,I=HOe(t,UOe),V=$Oe({x:n,y:c,top:i,left:w,width:T,height:D},I);return!Dr(n)||!Dr(c)||!Dr(T)||!Dr(D)||!Dr(i)||!Dr(w)?null:Le.createElement("path",KI({},wn(V,!0),{className:di("recharts-cross",U),d:ZOe(n,c,T,D,i,w)}))},fO,Jq;function XOe(){if(Jq)return fO;Jq=1;var e=vj(),t=ree(),r=yp();function n(a,c){return a&&a.length?e(a,r(c,2),t):void 0}return fO=n,fO}var JOe=XOe();const QOe=ha(JOe);var pO,Qq;function eRe(){if(Qq)return pO;Qq=1;var e=vj(),t=yp(),r=nee();function n(a,c){return a&&a.length?e(a,t(c,2),r):void 0}return pO=n,pO}var tRe=eRe();const rRe=ha(tRe);var nRe=["cx","cy","angle","ticks","axisLine"],iRe=["ticks","tick","angle","tickFormatter","stroke"];function Wv(e){"@babel/helpers - typeof";return Wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wv(e)}function b1(){return b1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b1.apply(this,arguments)}function eG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function p0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eG(Object(r),!0).forEach(function(n){Sj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tG(e,t){if(e==null)return{};var r=aRe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function aRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function sRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wee(n.key),n)}}function oRe(e,t,r){return t&&rG(e.prototype,t),r&&rG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lRe(e,t,r){return t=WA(t),cRe(e,Gee()?Reflect.construct(t,r||[],WA(e).constructor):t.apply(e,r))}function cRe(e,t){if(t&&(Wv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uRe(e)}function uRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Gee=function(){return!!e})()}function WA(e){return WA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},WA(e)}function dRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZI(e,t)}function ZI(e,t){return ZI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},ZI(e,t)}function Sj(e,t,r){return t=Wee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wee(e){var t=hRe(e,"string");return Wv(t)=="symbol"?t:t+""}function hRe(e,t){if(Wv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Wv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var S2=function(e){function t(){return sRe(this,t),lRe(this,t,arguments)}return dRe(t,e),oRe(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,c=this.props,h=c.angle,i=c.cx,x=c.cy;return Ga(i,x,a,h)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,c=n.cy,h=n.angle,i=n.ticks,x=QOe(i,function(S){return S.coordinate||0}),w=rRe(i,function(S){return S.coordinate||0});return{cx:a,cy:c,startAngle:h,endAngle:h,innerRadius:w.coordinate||0,outerRadius:x.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,c=n.cy,h=n.angle,i=n.ticks,x=n.axisLine,w=tG(n,nRe),S=i.reduce(function(U,I){return[Math.min(U[0],I.coordinate),Math.max(U[1],I.coordinate)]},[1/0,-1/0]),T=Ga(a,c,S[0],h),E=Ga(a,c,S[1],h),D=p0(p0(p0({},wn(w,!1)),{},{fill:"none"},wn(x,!1)),{},{x1:T.x,y1:T.y,x2:E.x,y2:E.y});return Le.createElement("line",b1({className:"recharts-polar-radius-axis-line"},D))}},{key:"renderTicks",value:function(){var n=this,a=this.props,c=a.ticks,h=a.tick,i=a.angle,x=a.tickFormatter,w=a.stroke,S=tG(a,iRe),T=this.getTickTextAnchor(),E=wn(S,!1),D=wn(h,!1),U=c.map(function(I,V){var H=n.getTickValueCoord(I),K=p0(p0(p0(p0({textAnchor:T,transform:"rotate(".concat(90-i,", ").concat(H.x,", ").concat(H.y,")")},E),{},{stroke:"none",fill:w},D),{},{index:V},H),{},{payload:I});return Le.createElement(fi,b1({className:di("recharts-polar-radius-axis-tick",Ree(h)),key:"tick-".concat(I.coordinate)},dp(n.props,I,V)),t.renderTickItem(h,K,x?x(I.value,V):I.value))});return Le.createElement(fi,{className:"recharts-polar-radius-axis-ticks"},U)}},{key:"render",value:function(){var n=this.props,a=n.ticks,c=n.axisLine,h=n.tick;return!a||!a.length?null:Le.createElement(fi,{className:di("recharts-polar-radius-axis",this.props.className)},c&&this.renderAxisLine(),h&&this.renderTicks(),dl.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,c){var h;return Le.isValidElement(n)?h=Le.cloneElement(n,a):qn(n)?h=n(a):h=Le.createElement(W0,b1({},a,{className:"recharts-polar-radius-axis-tick-value"}),c),h}}])}(G.PureComponent);Sj(S2,"displayName","PolarRadiusAxis");Sj(S2,"axisType","radiusAxis");Sj(S2,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Hv(e){"@babel/helpers - typeof";return Hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hv(e)}function w0(){return w0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w0.apply(this,arguments)}function nG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function m0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nG(Object(r),!0).forEach(function(n){Nj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kee(n.key),n)}}function pRe(e,t,r){return t&&iG(e.prototype,t),r&&iG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mRe(e,t,r){return t=HA(t),gRe(e,Hee()?Reflect.construct(t,r||[],HA(e).constructor):t.apply(e,r))}function gRe(e,t){if(t&&(Hv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yRe(e)}function yRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hee=function(){return!!e})()}function HA(e){return HA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},HA(e)}function xRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YI(e,t)}function YI(e,t){return YI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},YI(e,t)}function Nj(e,t,r){return t=Kee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kee(e){var t=vRe(e,"string");return Hv(t)=="symbol"?t:t+""}function vRe(e,t){if(Hv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var _Re=Math.PI/180,bRe=1e-5,N2=function(e){function t(){return fRe(this,t),mRe(this,t,arguments)}return xRe(t,e),pRe(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,c=a.cx,h=a.cy,i=a.radius,x=a.orientation,w=a.tickSize,S=w||8,T=Ga(c,h,i,n.coordinate),E=Ga(c,h,i+(x==="inner"?-1:1)*S,n.coordinate);return{x1:T.x,y1:T.y,x2:E.x,y2:E.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,c=Math.cos(-n.coordinate*_Re),h;return c>bRe?h=a==="outer"?"start":"end":c<-1e-5?h=a==="outer"?"end":"start":h="middle",h}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,c=n.cy,h=n.radius,i=n.axisLine,x=n.axisLineType,w=m0(m0({},wn(this.props,!1)),{},{fill:"none"},wn(i,!1));if(x==="circle")return Le.createElement(w2,w0({className:"recharts-polar-angle-axis-line"},w,{cx:a,cy:c,r:h}));var S=this.props.ticks,T=S.map(function(E){return Ga(a,c,h,E.coordinate)});return Le.createElement(VOe,w0({className:"recharts-polar-angle-axis-line"},w,{points:T}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,c=a.ticks,h=a.tick,i=a.tickLine,x=a.tickFormatter,w=a.stroke,S=wn(this.props,!1),T=wn(h,!1),E=m0(m0({},S),{},{fill:"none"},wn(i,!1)),D=c.map(function(U,I){var V=n.getTickLineCoord(U),H=n.getTickTextAnchor(U),K=m0(m0(m0({textAnchor:H},S),{},{stroke:"none",fill:w},T),{},{index:I,payload:U,x:V.x2,y:V.y2});return Le.createElement(fi,w0({className:di("recharts-polar-angle-axis-tick",Ree(h)),key:"tick-".concat(U.coordinate)},dp(n.props,U,I)),i&&Le.createElement("line",w0({className:"recharts-polar-angle-axis-tick-line"},E,V)),h&&t.renderTickItem(h,K,x?x(U.value,I):U.value))});return Le.createElement(fi,{className:"recharts-polar-angle-axis-ticks"},D)}},{key:"render",value:function(){var n=this.props,a=n.ticks,c=n.radius,h=n.axisLine;return c<=0||!a||!a.length?null:Le.createElement(fi,{className:di("recharts-polar-angle-axis",this.props.className)},h&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,c){var h;return Le.isValidElement(n)?h=Le.cloneElement(n,a):qn(n)?h=n(a):h=Le.createElement(W0,w0({},a,{className:"recharts-polar-angle-axis-tick-value"}),c),h}}])}(G.PureComponent);Nj(N2,"displayName","PolarAngleAxis");Nj(N2,"axisType","angleAxis");Nj(N2,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var mO,aG;function wRe(){if(aG)return mO;aG=1;var e=tQ(),t=e(Object.getPrototypeOf,Object);return mO=t,mO}var gO,sG;function SRe(){if(sG)return gO;sG=1;var e=Mm(),t=wRe(),r=Om(),n="[object Object]",a=Function.prototype,c=Object.prototype,h=a.toString,i=c.hasOwnProperty,x=h.call(Object);function w(S){if(!r(S)||e(S)!=n)return!1;var T=t(S);if(T===null)return!0;var E=i.call(T,"constructor")&&T.constructor;return typeof E=="function"&&E instanceof E&&h.call(E)==x}return gO=w,gO}var NRe=SRe();const ARe=ha(NRe);var yO,oG;function TRe(){if(oG)return yO;oG=1;var e=Mm(),t=Om(),r="[object Boolean]";function n(a){return a===!0||a===!1||t(a)&&e(a)==r}return yO=n,yO}var jRe=TRe();const kRe=ha(jRe);function jw(e){"@babel/helpers - typeof";return jw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jw(e)}function KA(){return KA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KA.apply(this,arguments)}function PRe(e,t){return ORe(e)||MRe(e,t)||ERe(e,t)||CRe()}function CRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ERe(e,t){if(e){if(typeof e=="string")return lG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lG(e,t)}}function lG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,h,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(S){w=!0,a=S}finally{try{if(!x&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function ORe(e){if(Array.isArray(e))return e}function cG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cG(Object(r),!0).forEach(function(n){RRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RRe(e,t,r){return t=IRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IRe(e){var t=LRe(e,"string");return jw(t)=="symbol"?t:t+""}function LRe(e,t){if(jw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dG=function(t,r,n,a,c){var h=n-a,i;return i="M ".concat(t,",").concat(r),i+="L ".concat(t+n,",").concat(r),i+="L ".concat(t+n-h/2,",").concat(r+c),i+="L ".concat(t+n-h/2-a,",").concat(r+c),i+="L ".concat(t,",").concat(r," Z"),i},DRe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},FRe=function(t){var r=uG(uG({},DRe),t),n=G.useRef(),a=G.useState(-1),c=PRe(a,2),h=c[0],i=c[1];G.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var Q=n.current.getTotalLength();Q&&i(Q)}catch{}},[]);var x=r.x,w=r.y,S=r.upperWidth,T=r.lowerWidth,E=r.height,D=r.className,U=r.animationEasing,I=r.animationDuration,V=r.animationBegin,H=r.isUpdateAnimationActive;if(x!==+x||w!==+w||S!==+S||T!==+T||E!==+E||S===0&&T===0||E===0)return null;var K=di("recharts-trapezoid",D);return H?Le.createElement(Bu,{canBegin:h>0,from:{upperWidth:0,lowerWidth:0,height:E,x,y:w},to:{upperWidth:S,lowerWidth:T,height:E,x,y:w},duration:I,animationEasing:U,isActive:H},function(Q){var ae=Q.upperWidth,ee=Q.lowerWidth,se=Q.height,ue=Q.x,he=Q.y;return Le.createElement(Bu,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:V,duration:I,easing:U},Le.createElement("path",KA({},wn(r,!0),{className:K,d:dG(ue,he,ae,ee,se),ref:n})))}):Le.createElement("g",null,Le.createElement("path",KA({},wn(r,!0),{className:K,d:dG(x,w,S,T,E)})))},zRe=["option","shapeType","propTransformer","activeClassName","isActive"];function kw(e){"@babel/helpers - typeof";return kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kw(e)}function BRe(e,t){if(e==null)return{};var r=VRe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function VRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function hG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ZA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hG(Object(r),!0).forEach(function(n){URe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function URe(e,t,r){return t=$Re(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Re(e){var t=qRe(e,"string");return kw(t)=="symbol"?t:t+""}function qRe(e,t){if(kw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(kw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GRe(e,t){return ZA(ZA({},t),e)}function WRe(e,t){return e==="symbols"}function fG(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Le.createElement(ND,r);case"trapezoid":return Le.createElement(FRe,r);case"sector":return Le.createElement(Dee,r);case"symbols":if(WRe(t))return Le.createElement(cj,r);break;default:return null}}function HRe(e){return G.isValidElement(e)?e.props:e}function Pw(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?GRe:n,c=e.activeClassName,h=c===void 0?"recharts-active-shape":c,i=e.isActive,x=BRe(e,zRe),w;if(G.isValidElement(t))w=G.cloneElement(t,ZA(ZA({},x),HRe(t)));else if(qn(t))w=t(x);else if(ARe(t)&&!kRe(t)){var S=a(t,x);w=Le.createElement(fG,{shapeType:r,elementProps:S})}else{var T=x;w=Le.createElement(fG,{shapeType:r,elementProps:T})}return i?Le.createElement(fi,{className:h},w):w}function Aj(e,t){return t!=null&&"trapezoids"in e.props}function Tj(e,t){return t!=null&&"sectors"in e.props}function Cw(e,t){return t!=null&&"points"in e.props}function KRe(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,c=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&c}function ZRe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function YRe(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function XRe(e,t){var r;return Aj(e,t)?r=KRe:Tj(e,t)?r=ZRe:Cw(e,t)&&(r=YRe),r}function JRe(e,t){var r;return Aj(e,t)?r="trapezoids":Tj(e,t)?r="sectors":Cw(e,t)&&(r="points"),r}function QRe(e,t){if(Aj(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(Tj(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Cw(e,t)?t.payload:{}}function eIe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=JRe(r,t),c=QRe(r,t),h=n.filter(function(x,w){var S=Em(c,x),T=r.props[a].filter(function(U){var I=XRe(r,t);return I(U,t)}),E=r.props[a].indexOf(T[T.length-1]),D=w===E;return S&&D}),i=n.indexOf(h[h.length-1]);return i}var CN;function Kv(e){"@babel/helpers - typeof";return Kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kv(e)}function gv(){return gv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gv.apply(this,arguments)}function pG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pG(Object(r),!0).forEach(function(n){Od(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yee(n.key),n)}}function rIe(e,t,r){return t&&mG(e.prototype,t),r&&mG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nIe(e,t,r){return t=YA(t),iIe(e,Zee()?Reflect.construct(t,r||[],YA(e).constructor):t.apply(e,r))}function iIe(e,t){if(t&&(Kv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aIe(e)}function aIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zee=function(){return!!e})()}function YA(e){return YA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},YA(e)}function sIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XI(e,t)}function XI(e,t){return XI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},XI(e,t)}function Od(e,t,r){return t=Yee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yee(e){var t=oIe(e,"string");return Kv(t)=="symbol"?t:t+""}function oIe(e,t){if(Kv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var vp=function(e){function t(r){var n;return tIe(this,t),n=nIe(this,t,[r]),Od(n,"pieRef",null),Od(n,"sectorRefs",[]),Od(n,"id",hy("recharts-pie-")),Od(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),qn(a)&&a()}),Od(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),qn(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return sIe(t,e),rIe(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var c=this.props,h=c.label,i=c.labelLine,x=c.dataKey,w=c.valueKey,S=wn(this.props,!1),T=wn(h,!1),E=wn(i,!1),D=h&&h.offsetRadius||20,U=n.map(function(I,V){var H=(I.startAngle+I.endAngle)/2,K=Ga(I.cx,I.cy,I.outerRadius+D,H),Q=Xa(Xa(Xa(Xa({},S),I),{},{stroke:"none"},T),{},{index:V,textAnchor:t.getTextAnchor(K.x,I.cx)},K),ae=Xa(Xa(Xa(Xa({},S),I),{},{fill:"none",stroke:I.fill},E),{},{index:V,points:[Ga(I.cx,I.cy,I.outerRadius,H),K]}),ee=x;return Yn(x)&&Yn(w)?ee="value":Yn(x)&&(ee=w),Le.createElement(fi,{key:"label-".concat(I.startAngle,"-").concat(I.endAngle,"-").concat(I.midAngle,"-").concat(V)},i&&t.renderLabelLineItem(i,ae,"line"),t.renderLabelItem(h,Q,ns(I,ee)))});return Le.createElement(fi,{className:"recharts-pie-labels"},U)}},{key:"renderSectorsStatically",value:function(n){var a=this,c=this.props,h=c.activeShape,i=c.blendStroke,x=c.inactiveShape;return n.map(function(w,S){if((w==null?void 0:w.startAngle)===0&&(w==null?void 0:w.endAngle)===0&&n.length!==1)return null;var T=a.isActiveIndex(S),E=x&&a.hasActiveIndex()?x:null,D=T?h:E,U=Xa(Xa({},w),{},{stroke:i?w.fill:w.stroke,tabIndex:-1});return Le.createElement(fi,gv({ref:function(V){V&&!a.sectorRefs.includes(V)&&a.sectorRefs.push(V)},tabIndex:-1,className:"recharts-pie-sector"},dp(a.props,w,S),{key:"sector-".concat(w==null?void 0:w.startAngle,"-").concat(w==null?void 0:w.endAngle,"-").concat(w.midAngle,"-").concat(S)}),Le.createElement(Pw,gv({option:D,isActive:T,shapeType:"sector"},U)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,c=a.sectors,h=a.isAnimationActive,i=a.animationBegin,x=a.animationDuration,w=a.animationEasing,S=a.animationId,T=this.state,E=T.prevSectors,D=T.prevIsAnimationActive;return Le.createElement(Bu,{begin:i,duration:x,isActive:h,easing:w,from:{t:0},to:{t:1},key:"pie-".concat(S,"-").concat(D),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(U){var I=U.t,V=[],H=c&&c[0],K=H.startAngle;return c.forEach(function(Q,ae){var ee=E&&E[ae],se=ae>0?Du(Q,"paddingAngle",0):0;if(ee){var ue=ts(ee.endAngle-ee.startAngle,Q.endAngle-Q.startAngle),he=Xa(Xa({},Q),{},{startAngle:K+se,endAngle:K+ue(I)+se});V.push(he),K=he.endAngle}else{var Ce=Q.endAngle,Ne=Q.startAngle,me=ts(0,Ce-Ne),be=me(I),pe=Xa(Xa({},Q),{},{startAngle:K+se,endAngle:K+be+se});V.push(pe),K=pe.endAngle}}),Le.createElement(fi,null,n.renderSectorsStatically(V))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(c){if(!c.altKey)switch(c.key){case"ArrowLeft":{var h=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[h].focus(),a.setState({sectorToFocus:h});break}case"ArrowRight":{var i=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[i].focus(),a.setState({sectorToFocus:i});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,c=n.isAnimationActive,h=this.state.prevSectors;return c&&a&&a.length&&(!h||!Em(h,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,c=a.hide,h=a.sectors,i=a.className,x=a.label,w=a.cx,S=a.cy,T=a.innerRadius,E=a.outerRadius,D=a.isAnimationActive,U=this.state.isAnimationFinished;if(c||!h||!h.length||!Dr(w)||!Dr(S)||!Dr(T)||!Dr(E))return null;var I=di("recharts-pie",i);return Le.createElement(fi,{tabIndex:this.props.rootTabIndex,className:I,ref:function(H){n.pieRef=H}},this.renderSectors(),x&&this.renderLabels(h),dl.renderCallByParent(this.props,null,!1),(!D||U)&&Fd.renderCallByParent(this.props,h,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,c){if(Le.isValidElement(n))return Le.cloneElement(n,a);if(qn(n))return n(a);var h=di("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return Le.createElement(Yg,gv({},a,{key:c,type:"linear",className:h}))}},{key:"renderLabelItem",value:function(n,a,c){if(Le.isValidElement(n))return Le.cloneElement(n,a);var h=c;if(qn(n)&&(h=n(a),Le.isValidElement(h)))return h;var i=di("recharts-pie-label-text",typeof n!="boolean"&&!qn(n)?n.className:"");return Le.createElement(W0,gv({},a,{alignmentBaseline:"middle",className:i}),h)}}])}(G.PureComponent);CN=vp;Od(vp,"displayName","Pie");Od(vp,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!xp.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Od(vp,"parseDeltaAngle",function(e,t){var r=hl(t-e),n=Math.min(Math.abs(t-e),360);return r*n});Od(vp,"getRealPieData",function(e){var t=e.data,r=e.children,n=wn(e,!1),a=rc(r,Jh);return t&&t.length?t.map(function(c,h){return Xa(Xa(Xa({payload:c},n),c),a&&a[h]&&a[h].props)}):a&&a.length?a.map(function(c){return Xa(Xa({},n),c.props)}):[]});Od(vp,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,a=t.width,c=t.height,h=Mee(a,c),i=n+bc(e.cx,a,a/2),x=r+bc(e.cy,c,c/2),w=bc(e.innerRadius,h,0),S=bc(e.outerRadius,h,h*.8),T=e.maxRadius||Math.sqrt(a*a+c*c)/2;return{cx:i,cy:x,innerRadius:w,outerRadius:S,maxRadius:T}});Od(vp,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?Xa(Xa({},t.type.defaultProps),t.props):t.props,a=CN.getRealPieData(n);if(!a||!a.length)return null;var c=n.cornerRadius,h=n.startAngle,i=n.endAngle,x=n.paddingAngle,w=n.dataKey,S=n.nameKey,T=n.valueKey,E=n.tooltipType,D=Math.abs(n.minAngle),U=CN.parseCoordinateOfPie(n,r),I=CN.parseDeltaAngle(h,i),V=Math.abs(I),H=w;Yn(w)&&Yn(T)?(qh(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),H="value"):Yn(w)&&(qh(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),H=T);var K=a.filter(function(he){return ns(he,H,0)!==0}).length,Q=(V>=360?K:K-1)*x,ae=V-K*D-Q,ee=a.reduce(function(he,Ce){var Ne=ns(Ce,H,0);return he+(Dr(Ne)?Ne:0)},0),se;if(ee>0){var ue;se=a.map(function(he,Ce){var Ne=ns(he,H,0),me=ns(he,S,Ce),be=(Dr(Ne)?Ne:0)/ee,pe;Ce?pe=ue.endAngle+hl(I)*x*(Ne!==0?1:0):pe=h;var Se=pe+hl(I)*((Ne!==0?D:0)+be*ae),Ee=(pe+Se)/2,we=(U.innerRadius+U.outerRadius)/2,Pe=[{name:me,value:Ne,payload:he,dataKey:H,type:E}],Me=Ga(U.cx,U.cy,we,Ee);return ue=Xa(Xa(Xa({percent:be,cornerRadius:c,name:me,tooltipPayload:Pe,midAngle:Ee,middleRadius:we,tooltipPosition:Me},he),U),{},{value:ns(he,H),startAngle:pe,endAngle:Se,payload:he,paddingAngle:hl(I)*x}),ue})}return Xa(Xa({},U),{},{sectors:se,data:a})});function Ew(e){"@babel/helpers - typeof";return Ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ew(e)}function JI(){return JI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JI.apply(this,arguments)}function gG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gG(Object(r),!0).forEach(function(n){lIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lIe(e,t,r){return t=cIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cIe(e){var t=uIe(e,"string");return Ew(t)=="symbol"?t:t+""}function uIe(e,t){if(Ew(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ew(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yG(e){return typeof e=="string"?parseInt(e,10):e}function dIe(e,t){var r="".concat(t.cx||e.cx),n=Number(r),a="".concat(t.cy||e.cy),c=Number(a);return xO(xO(xO({},t),e),{},{cx:n,cy:c})}function xG(e){return Le.createElement(Pw,JI({shapeType:"sector",propTransformer:dIe},e))}var hIe=["shape","activeShape","activeIndex","cornerRadius"],fIe=["value","background"];function Zv(e){"@babel/helpers - typeof";return Zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zv(e)}function XA(){return XA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},XA.apply(this,arguments)}function vG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vG(Object(r),!0).forEach(function(n){D0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _G(e,t){if(e==null)return{};var r=pIe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function pIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function mIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jee(n.key),n)}}function gIe(e,t,r){return t&&bG(e.prototype,t),r&&bG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yIe(e,t,r){return t=JA(t),xIe(e,Xee()?Reflect.construct(t,r||[],JA(e).constructor):t.apply(e,r))}function xIe(e,t){if(t&&(Zv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vIe(e)}function vIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xee=function(){return!!e})()}function JA(e){return JA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},JA(e)}function _Ie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QI(e,t)}function QI(e,t){return QI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},QI(e,t)}function D0(e,t,r){return t=Jee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jee(e){var t=bIe(e,"string");return Zv(t)=="symbol"?t:t+""}function bIe(e,t){if(Zv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var A2=function(e){function t(){var r;mIe(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=yIe(this,t,[].concat(a)),D0(r,"state",{isAnimationFinished:!1}),D0(r,"handleAnimationEnd",function(){var h=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),qn(h)&&h()}),D0(r,"handleAnimationStart",function(){var h=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),qn(h)&&h()}),r}return _Ie(t,e),gIe(t,[{key:"getDeltaAngle",value:function(){var n=this.props,a=n.startAngle,c=n.endAngle,h=hl(c-a),i=Math.min(Math.abs(c-a),360);return h*i}},{key:"renderSectorsStatically",value:function(n){var a=this,c=this.props,h=c.shape,i=c.activeShape,x=c.activeIndex,w=c.cornerRadius,S=_G(c,hIe),T=wn(S,!1);return n.map(function(E,D){var U=D===x,I=cl(cl(cl(cl({},T),{},{cornerRadius:yG(w)},E),dp(a.props,E,D)),{},{className:"recharts-radial-bar-sector ".concat(E.className),forceCornerRadius:S.forceCornerRadius,cornerIsExternal:S.cornerIsExternal,isActive:U,option:U?i:h});return Le.createElement(xG,XA({},I,{key:"sector-".concat(D)}))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,c=a.data,h=a.isAnimationActive,i=a.animationBegin,x=a.animationDuration,w=a.animationEasing,S=a.animationId,T=this.state.prevData;return Le.createElement(Bu,{begin:i,duration:x,isActive:h,easing:w,from:{t:0},to:{t:1},key:"radialBar-".concat(S),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(E){var D=E.t,U=c.map(function(I,V){var H=T&&T[V];if(H){var K=ts(H.startAngle,I.startAngle),Q=ts(H.endAngle,I.endAngle);return cl(cl({},I),{},{startAngle:K(D),endAngle:Q(D)})}var ae=I.endAngle,ee=I.startAngle,se=ts(ee,ae);return cl(cl({},I),{},{endAngle:se(D)})});return Le.createElement(fi,null,n.renderSectorsStatically(U))})}},{key:"renderSectors",value:function(){var n=this.props,a=n.data,c=n.isAnimationActive,h=this.state.prevData;return c&&a&&a.length&&(!h||!Em(h,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"renderBackground",value:function(n){var a=this,c=this.props.cornerRadius,h=wn(this.props.background,!1);return n.map(function(i,x){i.value;var w=i.background,S=_G(i,fIe);if(!w)return null;var T=cl(cl(cl(cl(cl({cornerRadius:yG(c)},S),{},{fill:"#eee"},w),h),dp(a.props,i,x)),{},{index:x,className:di("recharts-radial-bar-background-sector",h==null?void 0:h.className),option:w,isActive:!1});return Le.createElement(xG,XA({},T,{key:"sector-".concat(x)}))})}},{key:"render",value:function(){var n=this.props,a=n.hide,c=n.data,h=n.className,i=n.background,x=n.isAnimationActive;if(a||!c||!c.length)return null;var w=this.state.isAnimationFinished,S=di("recharts-area",h);return Le.createElement(fi,{className:S},i&&Le.createElement(fi,{className:"recharts-radial-bar-background"},this.renderBackground(c)),Le.createElement(fi,{className:"recharts-radial-bar-sectors"},this.renderSectors()),(!x||w)&&Fd.renderCallByParent(cl({},this.props),c))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(G.PureComponent);D0(A2,"displayName","RadialBar");D0(A2,"defaultProps",{angleAxisId:0,radiusAxisId:0,minPointSize:0,hide:!1,legendType:"rect",data:[],isAnimationActive:!xp.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease",forceCornerRadius:!1,cornerIsExternal:!1});D0(A2,"getComposedData",function(e){var t=e.item,r=e.props,n=e.radiusAxis,a=e.radiusAxisTicks,c=e.angleAxis,h=e.angleAxisTicks,i=e.displayedData,x=e.dataKey,w=e.stackedData,S=e.barPosition,T=e.bandSize,E=e.dataStartIndex,D=Tee(S,t);if(!D)return null;var U=c.cx,I=c.cy,V=r.layout,H=t.props,K=H.children,Q=H.minPointSize,ae=V==="radial"?c:n,ee=w?ae.scale.domain():null,se=Pee({numericAxis:ae}),ue=rc(K,Jh),he=i.map(function(Ce,Ne){var me,be,pe,Se,Ee,we;if(w?me=jee(w[E+Ne],ee):(me=ns(Ce,x),Array.isArray(me)||(me=[se,me])),V==="radial"){be=FA({axis:n,ticks:a,bandSize:T,offset:D.offset,entry:Ce,index:Ne}),Ee=c.scale(me[1]),Se=c.scale(me[0]),pe=be+D.size;var Pe=Ee-Se;if(Math.abs(Q)>0&&Math.abs(Pe)<Math.abs(Q)){var Me=hl(Pe||Q)*(Math.abs(Q)-Math.abs(Pe));Ee+=Me}we={background:{cx:U,cy:I,innerRadius:be,outerRadius:pe,startAngle:r.startAngle,endAngle:r.endAngle}}}else{be=n.scale(me[0]),pe=n.scale(me[1]),Se=FA({axis:c,ticks:h,bandSize:T,offset:D.offset,entry:Ce,index:Ne}),Ee=Se+D.size;var Be=pe-be;if(Math.abs(Q)>0&&Math.abs(Be)<Math.abs(Q)){var Ge=hl(Be||Q)*(Math.abs(Q)-Math.abs(Be));pe+=Ge}}return cl(cl(cl(cl({},Ce),we),{},{payload:Ce,value:w?me:me[1],cx:U,cy:I,innerRadius:be,outerRadius:pe,startAngle:Se,endAngle:Ee},ue&&ue[Ne]&&ue[Ne].props),{},{tooltipPayload:[SD(t,Ce)],tooltipPosition:Ga(U,I,(be+pe)/2,(Se+Ee)/2)})});return{data:he,layout:V}});var vO,wG;function wIe(){if(wG)return vO;wG=1;var e=Math.ceil,t=Math.max;function r(n,a,c,h){for(var i=-1,x=t(e((a-n)/(c||1)),0),w=Array(x);x--;)w[h?x:++i]=n,n+=c;return w}return vO=r,vO}var _O,SG;function Qee(){if(SG)return _O;SG=1;var e=yQ(),t=1/0,r=17976931348623157e292;function n(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-1/0){var c=a<0?-1:1;return c*r}return a===a?a:0}return _O=n,_O}var bO,NG;function SIe(){if(NG)return bO;NG=1;var e=wIe(),t=hj(),r=Qee();function n(a){return function(c,h,i){return i&&typeof i!="number"&&t(c,h,i)&&(h=i=void 0),c=r(c),h===void 0?(h=c,c=0):h=r(h),i=i===void 0?c<h?1:-1:r(i),e(c,h,i,a)}}return bO=n,bO}var wO,AG;function NIe(){if(AG)return wO;AG=1;var e=SIe(),t=e();return wO=t,wO}var AIe=NIe();const QA=ha(AIe);function Mw(e){"@babel/helpers - typeof";return Mw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mw(e)}function TG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TG(Object(r),!0).forEach(function(n){ete(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ete(e,t,r){return t=TIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TIe(e){var t=jIe(e,"string");return Mw(t)=="symbol"?t:t+""}function jIe(e,t){if(Mw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Mw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kIe=["Webkit","Moz","O","ms"],PIe=function(t,r){var n=t.replace(/(\w)/,function(c){return c.toUpperCase()}),a=kIe.reduce(function(c,h){return jG(jG({},c),{},ete({},h+n,r))},{});return a[t]=r,a};function Yv(e){"@babel/helpers - typeof";return Yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yv(e)}function eT(){return eT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eT.apply(this,arguments)}function kG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function SO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kG(Object(r),!0).forEach(function(n){Cu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,rte(n.key),n)}}function EIe(e,t,r){return t&&PG(e.prototype,t),r&&PG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MIe(e,t,r){return t=tT(t),OIe(e,tte()?Reflect.construct(t,r||[],tT(e).constructor):t.apply(e,r))}function OIe(e,t){if(t&&(Yv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RIe(e)}function RIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tte=function(){return!!e})()}function tT(e){return tT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tT(e)}function IIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e3(e,t)}function e3(e,t){return e3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},e3(e,t)}function Cu(e,t,r){return t=rte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rte(e){var t=LIe(e,"string");return Yv(t)=="symbol"?t:t+""}function LIe(e,t){if(Yv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var DIe=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,c=t.x,h=t.width,i=t.travellerWidth;if(!r||!r.length)return{};var x=r.length,w=y1().domain(QA(0,x)).range([c,c+h-i]),S=w.domain().map(function(T){return w(T)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:w(n),endX:w(a),scale:w,scaleValues:S}},CG=function(t){return t.changedTouches&&!!t.changedTouches.length},Xv=function(e){function t(r){var n;return CIe(this,t),n=MIe(this,t,[r]),Cu(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),Cu(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),Cu(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,c=a.endIndex,h=a.onDragEnd,i=a.startIndex;h==null||h({endIndex:c,startIndex:i})}),n.detachDragEndListener()}),Cu(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Cu(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Cu(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Cu(n,"handleSlideDragStart",function(a){var c=CG(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:c.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return IIe(t,e),EIe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,c=n.endX,h=this.state.scaleValues,i=this.props,x=i.gap,w=i.data,S=w.length-1,T=Math.min(a,c),E=Math.max(a,c),D=t.getIndexInRange(h,T),U=t.getIndexInRange(h,E);return{startIndex:D-D%x,endIndex:U===S?S:U-U%x}}},{key:"getTextOfTick",value:function(n){var a=this.props,c=a.data,h=a.tickFormatter,i=a.dataKey,x=ns(c[n],i,n);return qn(h)?h(x,n):x}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,c=a.slideMoveStartX,h=a.startX,i=a.endX,x=this.props,w=x.x,S=x.width,T=x.travellerWidth,E=x.startIndex,D=x.endIndex,U=x.onChange,I=n.pageX-c;I>0?I=Math.min(I,w+S-T-i,w+S-T-h):I<0&&(I=Math.max(I,w-h,w-i));var V=this.getIndex({startX:h+I,endX:i+I});(V.startIndex!==E||V.endIndex!==D)&&U&&U(V),this.setState({startX:h+I,endX:i+I,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var c=CG(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:c.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,c=a.brushMoveStartX,h=a.movingTravellerId,i=a.endX,x=a.startX,w=this.state[h],S=this.props,T=S.x,E=S.width,D=S.travellerWidth,U=S.onChange,I=S.gap,V=S.data,H={startX:this.state.startX,endX:this.state.endX},K=n.pageX-c;K>0?K=Math.min(K,T+E-D-w):K<0&&(K=Math.max(K,T-w)),H[h]=w+K;var Q=this.getIndex(H),ae=Q.startIndex,ee=Q.endIndex,se=function(){var he=V.length-1;return h==="startX"&&(i>x?ae%I===0:ee%I===0)||i<x&&ee===he||h==="endX"&&(i>x?ee%I===0:ae%I===0)||i>x&&ee===he};this.setState(Cu(Cu({},h,w+K),"brushMoveStartX",n.pageX),function(){U&&se()&&U(Q)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var c=this,h=this.state,i=h.scaleValues,x=h.startX,w=h.endX,S=this.state[a],T=i.indexOf(S);if(T!==-1){var E=T+n;if(!(E===-1||E>=i.length)){var D=i[E];a==="startX"&&D>=w||a==="endX"&&D<=x||this.setState(Cu({},a,D),function(){c.props.onChange(c.getIndex({startX:c.state.startX,endX:c.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,c=n.y,h=n.width,i=n.height,x=n.fill,w=n.stroke;return Le.createElement("rect",{stroke:w,fill:x,x:a,y:c,width:h,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,c=n.y,h=n.width,i=n.height,x=n.data,w=n.children,S=n.padding,T=G.Children.only(w);return T?Le.cloneElement(T,{x:a,y:c,width:h,height:i,margin:S,compact:!0,data:x}):null}},{key:"renderTravellerLayer",value:function(n,a){var c,h,i=this,x=this.props,w=x.y,S=x.travellerWidth,T=x.height,E=x.traveller,D=x.ariaLabel,U=x.data,I=x.startIndex,V=x.endIndex,H=Math.max(n,this.props.x),K=SO(SO({},wn(this.props,!1)),{},{x:H,y:w,width:S,height:T}),Q=D||"Min value: ".concat((c=U[I])===null||c===void 0?void 0:c.name,", Max value: ").concat((h=U[V])===null||h===void 0?void 0:h.name);return Le.createElement(fi,{tabIndex:0,role:"slider","aria-label":Q,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(ee){["ArrowLeft","ArrowRight"].includes(ee.key)&&(ee.preventDefault(),ee.stopPropagation(),i.handleTravellerMoveKeyboard(ee.key==="ArrowRight"?1:-1,a))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(E,K))}},{key:"renderSlide",value:function(n,a){var c=this.props,h=c.y,i=c.height,x=c.stroke,w=c.travellerWidth,S=Math.min(n,a)+w,T=Math.max(Math.abs(a-n)-w,0);return Le.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:x,fillOpacity:.2,x:S,y:h,width:T,height:i})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,c=n.endIndex,h=n.y,i=n.height,x=n.travellerWidth,w=n.stroke,S=this.state,T=S.startX,E=S.endX,D=5,U={pointerEvents:"none",fill:w};return Le.createElement(fi,{className:"recharts-brush-texts"},Le.createElement(W0,eT({textAnchor:"end",verticalAnchor:"middle",x:Math.min(T,E)-D,y:h+i/2},U),this.getTextOfTick(a)),Le.createElement(W0,eT({textAnchor:"start",verticalAnchor:"middle",x:Math.max(T,E)+x+D,y:h+i/2},U),this.getTextOfTick(c)))}},{key:"render",value:function(){var n=this.props,a=n.data,c=n.className,h=n.children,i=n.x,x=n.y,w=n.width,S=n.height,T=n.alwaysShowText,E=this.state,D=E.startX,U=E.endX,I=E.isTextActive,V=E.isSlideMoving,H=E.isTravellerMoving,K=E.isTravellerFocused;if(!a||!a.length||!Dr(i)||!Dr(x)||!Dr(w)||!Dr(S)||w<=0||S<=0)return null;var Q=di("recharts-brush",c),ae=Le.Children.count(h)===1,ee=PIe("userSelect","none");return Le.createElement(fi,{className:Q,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:ee},this.renderBackground(),ae&&this.renderPanorama(),this.renderSlide(D,U),this.renderTravellerLayer(D,"startX"),this.renderTravellerLayer(U,"endX"),(I||V||H||K||T)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,c=n.y,h=n.width,i=n.height,x=n.stroke,w=Math.floor(c+i/2)-1;return Le.createElement(Le.Fragment,null,Le.createElement("rect",{x:a,y:c,width:h,height:i,fill:x,stroke:"none"}),Le.createElement("line",{x1:a+1,y1:w,x2:a+h-1,y2:w,fill:"none",stroke:"#fff"}),Le.createElement("line",{x1:a+1,y1:w+2,x2:a+h-1,y2:w+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var c;return Le.isValidElement(n)?c=Le.cloneElement(n,a):qn(n)?c=n(a):c=t.renderDefaultTraveller(a),c}},{key:"getDerivedStateFromProps",value:function(n,a){var c=n.data,h=n.width,i=n.x,x=n.travellerWidth,w=n.updateId,S=n.startIndex,T=n.endIndex;if(c!==a.prevData||w!==a.prevUpdateId)return SO({prevData:c,prevTravellerWidth:x,prevUpdateId:w,prevX:i,prevWidth:h},c&&c.length?DIe({data:c,width:h,x:i,travellerWidth:x,startIndex:S,endIndex:T}):{scale:null,scaleValues:null});if(a.scale&&(h!==a.prevWidth||i!==a.prevX||x!==a.prevTravellerWidth)){a.scale.range([i,i+h-x]);var E=a.scale.domain().map(function(D){return a.scale(D)});return{prevData:c,prevTravellerWidth:x,prevUpdateId:w,prevX:i,prevWidth:h,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:E}}return null}},{key:"getIndexInRange",value:function(n,a){for(var c=n.length,h=0,i=c-1;i-h>1;){var x=Math.floor((h+i)/2);n[x]>a?i=x:h=x}return a>=n[i]?i:h}}])}(G.PureComponent);Cu(Xv,"displayName","Brush");Cu(Xv,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var NO,EG;function FIe(){if(EG)return NO;EG=1;var e=ZL();function t(r,n){var a;return e(r,function(c,h,i){return a=n(c,h,i),!a}),!!a}return NO=t,NO}var AO,MG;function zIe(){if(MG)return AO;MG=1;var e=KJ(),t=yp(),r=FIe(),n=nu(),a=hj();function c(h,i,x){var w=n(h)?e:r;return x&&a(h,i,x)&&(i=void 0),w(h,t(i,3))}return AO=c,AO}var BIe=zIe();const VIe=ha(BIe);var np=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},TO,OG;function UIe(){if(OG)return TO;OG=1;var e=hQ();function t(r,n,a){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}return TO=t,TO}var jO,RG;function $Ie(){if(RG)return jO;RG=1;var e=UIe(),t=uQ(),r=yp();function n(a,c){var h={};return c=r(c,3),t(a,function(i,x,w){e(h,x,c(i,x,w))}),h}return jO=n,jO}var qIe=$Ie();const GIe=ha(qIe);var kO,IG;function WIe(){if(IG)return kO;IG=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(!r(t[n],n,t))return!1;return!0}return kO=e,kO}var PO,LG;function HIe(){if(LG)return PO;LG=1;var e=ZL();function t(r,n){var a=!0;return e(r,function(c,h,i){return a=!!n(c,h,i),a}),a}return PO=t,PO}var CO,DG;function KIe(){if(DG)return CO;DG=1;var e=WIe(),t=HIe(),r=yp(),n=nu(),a=hj();function c(h,i,x){var w=n(h)?e:t;return x&&a(h,i,x)&&(i=void 0),w(h,r(i,3))}return CO=c,CO}var ZIe=KIe();const nte=ha(ZIe);var YIe=["x","y"];function Ow(e){"@babel/helpers - typeof";return Ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ow(e)}function t3(){return t3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},t3.apply(this,arguments)}function FG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FG(Object(r),!0).forEach(function(n){XIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XIe(e,t,r){return t=JIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JIe(e){var t=QIe(e,"string");return Ow(t)=="symbol"?t:t+""}function QIe(e,t){if(Ow(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ow(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e3e(e,t){if(e==null)return{};var r=t3e(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function t3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function r3e(e,t){var r=e.x,n=e.y,a=e3e(e,YIe),c="".concat(r),h=parseInt(c,10),i="".concat(n),x=parseInt(i,10),w="".concat(t.height||a.height),S=parseInt(w,10),T="".concat(t.width||a.width),E=parseInt(T,10);return Kb(Kb(Kb(Kb(Kb({},t),a),h?{x:h}:{}),x?{y:x}:{}),{},{height:S,width:E,name:t.name,radius:t.radius})}function zG(e){return Le.createElement(Pw,t3({shapeType:"rectangle",propTransformer:r3e,activeClassName:"recharts-active-bar"},e))}var n3e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var c=typeof n=="number";return c?t(n,a):(c||K0(),r)}},i3e=["value","background"],ite;function Jv(e){"@babel/helpers - typeof";return Jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jv(e)}function a3e(e,t){if(e==null)return{};var r=s3e(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function s3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function rT(){return rT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rT.apply(this,arguments)}function BG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BG(Object(r),!0).forEach(function(n){Gg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function o3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ste(n.key),n)}}function l3e(e,t,r){return t&&VG(e.prototype,t),r&&VG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function c3e(e,t,r){return t=nT(t),u3e(e,ate()?Reflect.construct(t,r||[],nT(e).constructor):t.apply(e,r))}function u3e(e,t){if(t&&(Jv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d3e(e)}function d3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ate(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ate=function(){return!!e})()}function nT(e){return nT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nT(e)}function h3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r3(e,t)}function r3(e,t){return r3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},r3(e,t)}function Gg(e,t,r){return t=ste(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ste(e){var t=f3e(e,"string");return Jv(t)=="symbol"?t:t+""}function f3e(e,t){if(Jv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var rs=function(e){function t(){var r;o3e(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=c3e(this,t,[].concat(a)),Gg(r,"state",{isAnimationFinished:!1}),Gg(r,"id",hy("recharts-bar-")),Gg(r,"handleAnimationEnd",function(){var h=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),h&&h()}),Gg(r,"handleAnimationStart",function(){var h=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),h&&h()}),r}return h3e(t,e),l3e(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,c=this.props,h=c.shape,i=c.dataKey,x=c.activeIndex,w=c.activeBar,S=wn(this.props,!1);return n&&n.map(function(T,E){var D=E===x,U=D?w:h,I=jo(jo(jo({},S),T),{},{isActive:D,option:U,index:E,dataKey:i,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return Le.createElement(fi,rT({className:"recharts-bar-rectangle"},dp(a.props,T,E),{key:"rectangle-".concat(T==null?void 0:T.x,"-").concat(T==null?void 0:T.y,"-").concat(T==null?void 0:T.value)}),Le.createElement(zG,I))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,c=a.data,h=a.layout,i=a.isAnimationActive,x=a.animationBegin,w=a.animationDuration,S=a.animationEasing,T=a.animationId,E=this.state.prevData;return Le.createElement(Bu,{begin:x,duration:w,isActive:i,easing:S,from:{t:0},to:{t:1},key:"bar-".concat(T),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(D){var U=D.t,I=c.map(function(V,H){var K=E&&E[H];if(K){var Q=ts(K.x,V.x),ae=ts(K.y,V.y),ee=ts(K.width,V.width),se=ts(K.height,V.height);return jo(jo({},V),{},{x:Q(U),y:ae(U),width:ee(U),height:se(U)})}if(h==="horizontal"){var ue=ts(0,V.height),he=ue(U);return jo(jo({},V),{},{y:V.y+V.height-he,height:he})}var Ce=ts(0,V.width),Ne=Ce(U);return jo(jo({},V),{},{width:Ne})});return Le.createElement(fi,null,n.renderRectanglesStatically(I))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,c=n.isAnimationActive,h=this.state.prevData;return c&&a&&a.length&&(!h||!Em(h,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,c=a.data,h=a.dataKey,i=a.activeIndex,x=wn(this.props.background,!1);return c.map(function(w,S){w.value;var T=w.background,E=a3e(w,i3e);if(!T)return null;var D=jo(jo(jo(jo(jo({},E),{},{fill:"#eee"},T),x),dp(n.props,w,S)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:h,index:S,className:"recharts-bar-background-rectangle"});return Le.createElement(zG,rT({key:"background-bar-".concat(S),option:n.props.background,isActive:S===i},D))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var c=this.props,h=c.data,i=c.xAxis,x=c.yAxis,w=c.layout,S=c.children,T=rc(S,L_);if(!T)return null;var E=w==="vertical"?h[0].height/2:h[0].width/2,D=function(V,H){var K=Array.isArray(V.value)?V.value[1]:V.value;return{x:V.x,y:V.y,value:K,errorVal:ns(V,H)}},U={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Le.createElement(fi,U,T.map(function(I){return Le.cloneElement(I,{key:"error-bar-".concat(a,"-").concat(I.props.dataKey),data:h,xAxis:i,yAxis:x,layout:w,offset:E,dataPointFormatter:D})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,c=n.data,h=n.className,i=n.xAxis,x=n.yAxis,w=n.left,S=n.top,T=n.width,E=n.height,D=n.isAnimationActive,U=n.background,I=n.id;if(a||!c||!c.length)return null;var V=this.state.isAnimationFinished,H=di("recharts-bar",h),K=i&&i.allowDataOverflow,Q=x&&x.allowDataOverflow,ae=K||Q,ee=Yn(I)?this.id:I;return Le.createElement(fi,{className:H},K||Q?Le.createElement("defs",null,Le.createElement("clipPath",{id:"clipPath-".concat(ee)},Le.createElement("rect",{x:K?w:w-T/2,y:Q?S:S-E/2,width:K?T:T*2,height:Q?E:E*2}))):null,Le.createElement(fi,{className:"recharts-bar-rectangles",clipPath:ae?"url(#clipPath-".concat(ee,")"):null},U?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(ae,ee),(!D||V)&&Fd.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(G.PureComponent);ite=rs;Gg(rs,"displayName","Bar");Gg(rs,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!xp.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Gg(rs,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,c=e.xAxis,h=e.yAxis,i=e.xAxisTicks,x=e.yAxisTicks,w=e.stackedData,S=e.dataStartIndex,T=e.displayedData,E=e.offset,D=Tee(n,r);if(!D)return null;var U=t.layout,I=r.type.defaultProps,V=I!==void 0?jo(jo({},I),r.props):r.props,H=V.dataKey,K=V.children,Q=V.minPointSize,ae=U==="horizontal"?h:c,ee=w?ae.scale.domain():null,se=Pee({numericAxis:ae}),ue=rc(K,Jh),he=T.map(function(Ce,Ne){var me,be,pe,Se,Ee,we;w?me=jee(w[S+Ne],ee):(me=ns(Ce,H),Array.isArray(me)||(me=[se,me]));var Pe=n3e(Q,ite.defaultProps.minPointSize)(me[1],Ne);if(U==="horizontal"){var Me,Be=[h.scale(me[0]),h.scale(me[1])],Ge=Be[0],We=Be[1];be=FA({axis:c,ticks:i,bandSize:a,offset:D.offset,entry:Ce,index:Ne}),pe=(Me=We??Ge)!==null&&Me!==void 0?Me:void 0,Se=D.size;var tt=Ge-We;if(Ee=Number.isNaN(tt)?0:tt,we={x:be,y:h.y,width:Se,height:h.height},Math.abs(Pe)>0&&Math.abs(Ee)<Math.abs(Pe)){var nt=hl(Ee||Pe)*(Math.abs(Pe)-Math.abs(Ee));pe-=nt,Ee+=nt}}else{var Dt=[c.scale(me[0]),c.scale(me[1])],nr=Dt[0],ir=Dt[1];if(be=nr,pe=FA({axis:h,ticks:x,bandSize:a,offset:D.offset,entry:Ce,index:Ne}),Se=ir-nr,Ee=D.size,we={x:c.x,y:pe,width:c.width,height:Ee},Math.abs(Pe)>0&&Math.abs(Se)<Math.abs(Pe)){var rr=hl(Se||Pe)*(Math.abs(Pe)-Math.abs(Se));Se+=rr}}return jo(jo(jo({},Ce),{},{x:be,y:pe,width:Se,height:Ee,value:w?me:me[1],payload:Ce,background:we},ue&&ue[Ne]&&ue[Ne].props),{},{tooltipPayload:[SD(r,Ce)],tooltipPosition:{x:be+Se/2,y:pe+Ee/2}})});return jo({data:he,layout:U},E)});function Rw(e){"@babel/helpers - typeof";return Rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rw(e)}function p3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ote(n.key),n)}}function m3e(e,t,r){return t&&UG(e.prototype,t),r&&UG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$G(Object(r),!0).forEach(function(n){jj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$G(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jj(e,t,r){return t=ote(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ote(e){var t=g3e(e,"string");return Rw(t)=="symbol"?t:t+""}function g3e(e,t){if(Rw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Rw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var T2=function(t,r,n,a,c){var h=t.width,i=t.height,x=t.layout,w=t.children,S=Object.keys(r),T={left:n.left,leftMirror:n.left,right:h-n.right,rightMirror:h-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},E=!!Eu(w,rs);return S.reduce(function(D,U){var I=r[U],V=I.orientation,H=I.domain,K=I.padding,Q=K===void 0?{}:K,ae=I.mirror,ee=I.reversed,se="".concat(V).concat(ae?"Mirror":""),ue,he,Ce,Ne,me;if(I.type==="number"&&(I.padding==="gap"||I.padding==="no-gap")){var be=H[1]-H[0],pe=1/0,Se=I.categoricalDomain.sort();if(Se.forEach(function(Dt,nr){nr>0&&(pe=Math.min((Dt||0)-(Se[nr-1]||0),pe))}),Number.isFinite(pe)){var Ee=pe/be,we=I.layout==="vertical"?n.height:n.width;if(I.padding==="gap"&&(ue=Ee*we/2),I.padding==="no-gap"){var Pe=bc(t.barCategoryGap,Ee*we),Me=Ee*we/2;ue=Me-Pe-(Me-Pe)/we*Pe}}}a==="xAxis"?he=[n.left+(Q.left||0)+(ue||0),n.left+n.width-(Q.right||0)-(ue||0)]:a==="yAxis"?he=x==="horizontal"?[n.top+n.height-(Q.bottom||0),n.top+(Q.top||0)]:[n.top+(Q.top||0)+(ue||0),n.top+n.height-(Q.bottom||0)-(ue||0)]:he=I.range,ee&&(he=[he[1],he[0]]);var Be=Nee(I,c,E),Ge=Be.scale,We=Be.realScaleType;Ge.domain(H).range(he),Aee(Ge);var tt=kee(Ge,Fh(Fh({},I),{},{realScaleType:We}));a==="xAxis"?(me=V==="top"&&!ae||V==="bottom"&&ae,Ce=n.left,Ne=T[se]-me*I.height):a==="yAxis"&&(me=V==="left"&&!ae||V==="right"&&ae,Ce=T[se]-me*I.width,Ne=n.top);var nt=Fh(Fh(Fh({},I),tt),{},{realScaleType:We,x:Ce,y:Ne,scale:Ge,width:a==="xAxis"?n.width:I.width,height:a==="yAxis"?n.height:I.height});return nt.bandSize=zA(nt,tt),!I.hide&&a==="xAxis"?T[se]+=(me?-1:1)*nt.height:I.hide||(T[se]+=(me?-1:1)*nt.width),Fh(Fh({},D),{},jj({},U,nt))},{})},lte=function(t,r){var n=t.x,a=t.y,c=r.x,h=r.y;return{x:Math.min(n,c),y:Math.min(a,h),width:Math.abs(c-n),height:Math.abs(h-a)}},y3e=function(t){var r=t.x1,n=t.y1,a=t.x2,c=t.y2;return lte({x:r,y:n},{x:a,y:c})},cte=function(){function e(t){p3e(this,e),this.scale=t}return m3e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,c=n.position;if(r!==void 0){if(c)switch(c){case"start":return this.scale(r);case"middle":{var h=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+h}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(r)+i}default:return this.scale(r)}if(a){var x=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+x}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],c=n[n.length-1];return a<=c?r>=a&&r<=c:r>=c&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();jj(cte,"EPS",1e-4);var AD=function(t){var r=Object.keys(t).reduce(function(n,a){return Fh(Fh({},n),{},jj({},a,cte.create(t[a])))},{});return Fh(Fh({},r),{},{apply:function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=c.bandAware,i=c.position;return GIe(a,function(x,w){return r[w].apply(x,{bandAware:h,position:i})})},isInRange:function(a){return nte(a,function(c,h){return r[h].isInRange(c)})}})};function x3e(e){return(e%180+180)%180}var v3e=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,c=x3e(a),h=c*Math.PI/180,i=Math.atan(n/r),x=h>i&&h<Math.PI-i?n/Math.sin(h):r/Math.cos(h);return Math.abs(x)},EO,qG;function _3e(){if(qG)return EO;qG=1;var e=yp(),t=y2(),r=uj();function n(a){return function(c,h,i){var x=Object(c);if(!t(c)){var w=e(h,3);c=r(c),h=function(T){return w(x[T],T,x)}}var S=a(c,h,i);return S>-1?x[w?c[S]:S]:void 0}}return EO=n,EO}var MO,GG;function b3e(){if(GG)return MO;GG=1;var e=Qee();function t(r){var n=e(r),a=n%1;return n===n?a?n-a:n:0}return MO=t,MO}var OO,WG;function w3e(){if(WG)return OO;WG=1;var e=aQ(),t=yp(),r=b3e(),n=Math.max;function a(c,h,i){var x=c==null?0:c.length;if(!x)return-1;var w=i==null?0:r(i);return w<0&&(w=n(x+w,0)),e(c,t(h,3),w)}return OO=a,OO}var RO,HG;function S3e(){if(HG)return RO;HG=1;var e=_3e(),t=w3e(),r=e(t);return RO=r,RO}var N3e=S3e();const A3e=ha(N3e);var T3e=_J();const j3e=ha(T3e);var k3e=j3e(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),TD=G.createContext(void 0),jD=G.createContext(void 0),ute=G.createContext(void 0),dte=G.createContext({}),hte=G.createContext(void 0),fte=G.createContext(0),pte=G.createContext(0),KG=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,c=r.offset,h=t.clipPathId,i=t.children,x=t.width,w=t.height,S=k3e(c);return Le.createElement(TD.Provider,{value:n},Le.createElement(jD.Provider,{value:a},Le.createElement(dte.Provider,{value:c},Le.createElement(ute.Provider,{value:S},Le.createElement(hte.Provider,{value:h},Le.createElement(fte.Provider,{value:w},Le.createElement(pte.Provider,{value:x},i)))))))},P3e=function(){return G.useContext(hte)},mte=function(t){var r=G.useContext(TD);r==null&&K0();var n=r[t];return n==null&&K0(),n},C3e=function(){var t=G.useContext(TD);return $g(t)},E3e=function(){var t=G.useContext(jD),r=A3e(t,function(n){return nte(n.domain,Number.isFinite)});return r||$g(t)},gte=function(t){var r=G.useContext(jD);r==null&&K0();var n=r[t];return n==null&&K0(),n},M3e=function(){var t=G.useContext(ute);return t},O3e=function(){return G.useContext(dte)},kD=function(){return G.useContext(pte)},PD=function(){return G.useContext(fte)};function Qv(e){"@babel/helpers - typeof";return Qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qv(e)}function R3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I3e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xte(n.key),n)}}function L3e(e,t,r){return t&&I3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function D3e(e,t,r){return t=iT(t),F3e(e,yte()?Reflect.construct(t,r||[],iT(e).constructor):t.apply(e,r))}function F3e(e,t){if(t&&(Qv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z3e(e)}function z3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yte=function(){return!!e})()}function iT(e){return iT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iT(e)}function B3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n3(e,t)}function n3(e,t){return n3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},n3(e,t)}function ZG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function YG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZG(Object(r),!0).forEach(function(n){CD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CD(e,t,r){return t=xte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xte(e){var t=V3e(e,"string");return Qv(t)=="symbol"?t:t+""}function V3e(e,t){if(Qv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Qv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function U3e(e,t){return W3e(e)||G3e(e,t)||q3e(e,t)||$3e()}function $3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q3e(e,t){if(e){if(typeof e=="string")return XG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XG(e,t)}}function XG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function G3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,h,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(S){w=!0,a=S}finally{try{if(!x&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function W3e(e){if(Array.isArray(e))return e}function i3(){return i3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i3.apply(this,arguments)}var H3e=function(t,r){var n;return Le.isValidElement(t)?n=Le.cloneElement(t,r):qn(t)?n=t(r):n=Le.createElement("line",i3({},r,{className:"recharts-reference-line-line"})),n},K3e=function(t,r,n,a,c,h,i,x,w){var S=c.x,T=c.y,E=c.width,D=c.height;if(n){var U=w.y,I=t.y.apply(U,{position:h});if(np(w,"discard")&&!t.y.isInRange(I))return null;var V=[{x:S+E,y:I},{x:S,y:I}];return x==="left"?V.reverse():V}if(r){var H=w.x,K=t.x.apply(H,{position:h});if(np(w,"discard")&&!t.x.isInRange(K))return null;var Q=[{x:K,y:T+D},{x:K,y:T}];return i==="top"?Q.reverse():Q}if(a){var ae=w.segment,ee=ae.map(function(se){return t.apply(se,{position:h})});return np(w,"discard")&&VIe(ee,function(se){return!t.isInRange(se)})?null:ee}return null};function Z3e(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,c=e.yAxisId,h=e.shape,i=e.className,x=e.alwaysShow,w=P3e(),S=mte(a),T=gte(c),E=M3e();if(!w||!E)return null;qh(x===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var D=AD({x:S.scale,y:T.scale}),U=Wo(t),I=Wo(r),V=n&&n.length===2,H=K3e(D,U,I,V,E,e.position,S.orientation,T.orientation,e);if(!H)return null;var K=U3e(H,2),Q=K[0],ae=Q.x,ee=Q.y,se=K[1],ue=se.x,he=se.y,Ce=np(e,"hidden")?"url(#".concat(w,")"):void 0,Ne=YG(YG({clipPath:Ce},wn(e,!0)),{},{x1:ae,y1:ee,x2:ue,y2:he});return Le.createElement(fi,{className:di("recharts-reference-line",i)},H3e(h,Ne),dl.renderCallByParent(e,y3e({x1:ae,y1:ee,x2:ue,y2:he})))}var ED=function(e){function t(){return R3e(this,t),D3e(this,t,arguments)}return B3e(t,e),L3e(t,[{key:"render",value:function(){return Le.createElement(Z3e,this.props)}}])}(Le.Component);CD(ED,"displayName","ReferenceLine");CD(ED,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function a3(){return a3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a3.apply(this,arguments)}function e_(e){"@babel/helpers - typeof";return e_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e_(e)}function JG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function QG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JG(Object(r),!0).forEach(function(n){kj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Y3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X3e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_te(n.key),n)}}function J3e(e,t,r){return t&&X3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q3e(e,t,r){return t=aT(t),e4e(e,vte()?Reflect.construct(t,r||[],aT(e).constructor):t.apply(e,r))}function e4e(e,t){if(t&&(e_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t4e(e)}function t4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vte=function(){return!!e})()}function aT(e){return aT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},aT(e)}function r4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s3(e,t)}function s3(e,t){return s3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},s3(e,t)}function kj(e,t,r){return t=_te(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _te(e){var t=n4e(e,"string");return e_(t)=="symbol"?t:t+""}function n4e(e,t){if(e_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(e_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var i4e=function(t){var r=t.x,n=t.y,a=t.xAxis,c=t.yAxis,h=AD({x:a.scale,y:c.scale}),i=h.apply({x:r,y:n},{bandAware:!0});return np(t,"discard")&&!h.isInRange(i)?null:i},Pj=function(e){function t(){return Y3e(this,t),Q3e(this,t,arguments)}return r4e(t,e),J3e(t,[{key:"render",value:function(){var n=this.props,a=n.x,c=n.y,h=n.r,i=n.alwaysShow,x=n.clipPathId,w=Wo(a),S=Wo(c);if(qh(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!w||!S)return null;var T=i4e(this.props);if(!T)return null;var E=T.x,D=T.y,U=this.props,I=U.shape,V=U.className,H=np(this.props,"hidden")?"url(#".concat(x,")"):void 0,K=QG(QG({clipPath:H},wn(this.props,!0)),{},{cx:E,cy:D});return Le.createElement(fi,{className:di("recharts-reference-dot",V)},t.renderDot(I,K),dl.renderCallByParent(this.props,{x:E-h,y:D-h,width:2*h,height:2*h}))}}])}(Le.Component);kj(Pj,"displayName","ReferenceDot");kj(Pj,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});kj(Pj,"renderDot",function(e,t){var r;return Le.isValidElement(e)?r=Le.cloneElement(e,t):qn(e)?r=e(t):r=Le.createElement(w2,a3({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function o3(){return o3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o3.apply(this,arguments)}function t_(e){"@babel/helpers - typeof";return t_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t_(e)}function eW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eW(Object(r),!0).forEach(function(n){Cj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function a4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s4e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wte(n.key),n)}}function o4e(e,t,r){return t&&s4e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function l4e(e,t,r){return t=sT(t),c4e(e,bte()?Reflect.construct(t,r||[],sT(e).constructor):t.apply(e,r))}function c4e(e,t){if(t&&(t_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u4e(e)}function u4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bte=function(){return!!e})()}function sT(e){return sT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sT(e)}function d4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l3(e,t)}function l3(e,t){return l3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},l3(e,t)}function Cj(e,t,r){return t=wte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wte(e){var t=h4e(e,"string");return t_(t)=="symbol"?t:t+""}function h4e(e,t){if(t_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(t_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var f4e=function(t,r,n,a,c){var h=c.x1,i=c.x2,x=c.y1,w=c.y2,S=c.xAxis,T=c.yAxis;if(!S||!T)return null;var E=AD({x:S.scale,y:T.scale}),D={x:t?E.x.apply(h,{position:"start"}):E.x.rangeMin,y:n?E.y.apply(x,{position:"start"}):E.y.rangeMin},U={x:r?E.x.apply(i,{position:"end"}):E.x.rangeMax,y:a?E.y.apply(w,{position:"end"}):E.y.rangeMax};return np(c,"discard")&&(!E.isInRange(D)||!E.isInRange(U))?null:lte(D,U)},Ej=function(e){function t(){return a4e(this,t),l4e(this,t,arguments)}return d4e(t,e),o4e(t,[{key:"render",value:function(){var n=this.props,a=n.x1,c=n.x2,h=n.y1,i=n.y2,x=n.className,w=n.alwaysShow,S=n.clipPathId;qh(w===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var T=Wo(a),E=Wo(c),D=Wo(h),U=Wo(i),I=this.props.shape;if(!T&&!E&&!D&&!U&&!I)return null;var V=f4e(T,E,D,U,this.props);if(!V&&!I)return null;var H=np(this.props,"hidden")?"url(#".concat(S,")"):void 0;return Le.createElement(fi,{className:di("recharts-reference-area",x)},t.renderRect(I,tW(tW({clipPath:H},wn(this.props,!0)),V)),dl.renderCallByParent(this.props,V))}}])}(Le.Component);Cj(Ej,"displayName","ReferenceArea");Cj(Ej,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Cj(Ej,"renderRect",function(e,t){var r;return Le.isValidElement(e)?r=Le.cloneElement(e,t):qn(e)?r=e(t):r=Le.createElement(ND,o3({},t,{className:"recharts-reference-area-rect"})),r});function Ste(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function p4e(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return v3e(n,r)}function m4e(e,t,r){var n=r==="width",a=e.x,c=e.y,h=e.width,i=e.height;return t===1?{start:n?a:c,end:n?a+h:c+i}:{start:n?a+h:c+i,end:n?a:c}}function oT(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var c=r();return e*(t-e*c/2-n)>=0&&e*(t+e*c/2-a)<=0}function g4e(e,t){return Ste(e,t+1)}function y4e(e,t,r,n,a){for(var c=(n||[]).slice(),h=t.start,i=t.end,x=0,w=1,S=h,T=function(){var U=n==null?void 0:n[x];if(U===void 0)return{v:Ste(n,w)};var I=x,V,H=function(){return V===void 0&&(V=r(U,I)),V},K=U.coordinate,Q=x===0||oT(e,K,H,S,i);Q||(x=0,S=h,w+=1),Q&&(S=K+e*(H()/2+a),x+=w)},E;w<=c.length;)if(E=T(),E)return E.v;return[]}function Iw(e){"@babel/helpers - typeof";return Iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iw(e)}function rW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rW(Object(r),!0).forEach(function(n){x4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x4e(e,t,r){return t=v4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v4e(e){var t=_4e(e,"string");return Iw(t)=="symbol"?t:t+""}function _4e(e,t){if(Iw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Iw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function b4e(e,t,r,n,a){for(var c=(n||[]).slice(),h=c.length,i=t.start,x=t.end,w=function(E){var D=c[E],U,I=function(){return U===void 0&&(U=r(D,E)),U};if(E===h-1){var V=e*(D.coordinate+e*I()/2-x);c[E]=D=Jl(Jl({},D),{},{tickCoord:V>0?D.coordinate-V*e:D.coordinate})}else c[E]=D=Jl(Jl({},D),{},{tickCoord:D.coordinate});var H=oT(e,D.tickCoord,I,i,x);H&&(x=D.tickCoord-e*(I()/2+a),c[E]=Jl(Jl({},D),{},{isShow:!0}))},S=h-1;S>=0;S--)w(S);return c}function w4e(e,t,r,n,a,c){var h=(n||[]).slice(),i=h.length,x=t.start,w=t.end;if(c){var S=n[i-1],T=r(S,i-1),E=e*(S.coordinate+e*T/2-w);h[i-1]=S=Jl(Jl({},S),{},{tickCoord:E>0?S.coordinate-E*e:S.coordinate});var D=oT(e,S.tickCoord,function(){return T},x,w);D&&(w=S.tickCoord-e*(T/2+a),h[i-1]=Jl(Jl({},S),{},{isShow:!0}))}for(var U=c?i-1:i,I=function(K){var Q=h[K],ae,ee=function(){return ae===void 0&&(ae=r(Q,K)),ae};if(K===0){var se=e*(Q.coordinate-e*ee()/2-x);h[K]=Q=Jl(Jl({},Q),{},{tickCoord:se<0?Q.coordinate-se*e:Q.coordinate})}else h[K]=Q=Jl(Jl({},Q),{},{tickCoord:Q.coordinate});var ue=oT(e,Q.tickCoord,ee,x,w);ue&&(x=Q.tickCoord+e*(ee()/2+a),h[K]=Jl(Jl({},Q),{},{isShow:!0}))},V=0;V<U;V++)I(V);return h}function MD(e,t,r){var n=e.tick,a=e.ticks,c=e.viewBox,h=e.minTickGap,i=e.orientation,x=e.interval,w=e.tickFormatter,S=e.unit,T=e.angle;if(!a||!a.length||!n)return[];if(Dr(x)||xp.isSsr)return g4e(a,typeof x=="number"&&Dr(x)?x:0);var E=[],D=i==="top"||i==="bottom"?"width":"height",U=S&&D==="width"?g1(S,{fontSize:t,letterSpacing:r}):{width:0,height:0},I=function(Q,ae){var ee=qn(w)?w(Q.value,ae):Q.value;return D==="width"?p4e(g1(ee,{fontSize:t,letterSpacing:r}),U,T):g1(ee,{fontSize:t,letterSpacing:r})[D]},V=a.length>=2?hl(a[1].coordinate-a[0].coordinate):1,H=m4e(c,V,D);return x==="equidistantPreserveStart"?y4e(V,H,I,a,h):(x==="preserveStart"||x==="preserveStartEnd"?E=w4e(V,H,I,a,h,x==="preserveStartEnd"):E=b4e(V,H,I,a,h),E.filter(function(K){return K.isShow}))}var S4e=["viewBox"],N4e=["viewBox"],A4e=["ticks"];function r_(e){"@babel/helpers - typeof";return r_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r_(e)}function yv(){return yv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yv.apply(this,arguments)}function nW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nW(Object(r),!0).forEach(function(n){OD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IO(e,t){if(e==null)return{};var r=T4e(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function T4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function j4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ate(n.key),n)}}function k4e(e,t,r){return t&&iW(e.prototype,t),r&&iW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P4e(e,t,r){return t=lT(t),C4e(e,Nte()?Reflect.construct(t,r||[],lT(e).constructor):t.apply(e,r))}function C4e(e,t){if(t&&(r_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E4e(e)}function E4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Nte=function(){return!!e})()}function lT(e){return lT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lT(e)}function M4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c3(e,t)}function c3(e,t){return c3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},c3(e,t)}function OD(e,t,r){return t=Ate(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ate(e){var t=O4e(e,"string");return r_(t)=="symbol"?t:t+""}function O4e(e,t){if(r_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(r_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var D_=function(e){function t(r){var n;return j4e(this,t),n=P4e(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return M4e(t,e),k4e(t,[{key:"shouldComponentUpdate",value:function(n,a){var c=n.viewBox,h=IO(n,S4e),i=this.props,x=i.viewBox,w=IO(i,N4e);return!Sv(c,x)||!Sv(h,w)||!Sv(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,c=a.x,h=a.y,i=a.width,x=a.height,w=a.orientation,S=a.tickSize,T=a.mirror,E=a.tickMargin,D,U,I,V,H,K,Q=T?-1:1,ae=n.tickSize||S,ee=Dr(n.tickCoord)?n.tickCoord:n.coordinate;switch(w){case"top":D=U=n.coordinate,V=h+ +!T*x,I=V-Q*ae,K=I-Q*E,H=ee;break;case"left":I=V=n.coordinate,U=c+ +!T*i,D=U-Q*ae,H=D-Q*E,K=ee;break;case"right":I=V=n.coordinate,U=c+ +T*i,D=U+Q*ae,H=D+Q*E,K=ee;break;default:D=U=n.coordinate,V=h+ +T*x,I=V+Q*ae,K=I+Q*E,H=ee;break}return{line:{x1:D,y1:I,x2:U,y2:V},tick:{x:H,y:K}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,c=n.mirror,h;switch(a){case"left":h=c?"start":"end";break;case"right":h=c?"end":"start";break;default:h="middle";break}return h}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,c=n.mirror,h="end";switch(a){case"left":case"right":h="middle";break;case"top":h=c?"start":"end";break;default:h=c?"end":"start";break}return h}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,c=n.y,h=n.width,i=n.height,x=n.orientation,w=n.mirror,S=n.axisLine,T=yc(yc(yc({},wn(this.props,!1)),wn(S,!1)),{},{fill:"none"});if(x==="top"||x==="bottom"){var E=+(x==="top"&&!w||x==="bottom"&&w);T=yc(yc({},T),{},{x1:a,y1:c+E*i,x2:a+h,y2:c+E*i})}else{var D=+(x==="left"&&!w||x==="right"&&w);T=yc(yc({},T),{},{x1:a+D*h,y1:c,x2:a+D*h,y2:c+i})}return Le.createElement("line",yv({},T,{className:di("recharts-cartesian-axis-line",Du(S,"className"))}))}},{key:"renderTicks",value:function(n,a,c){var h=this,i=this.props,x=i.tickLine,w=i.stroke,S=i.tick,T=i.tickFormatter,E=i.unit,D=MD(yc(yc({},this.props),{},{ticks:n}),a,c),U=this.getTickTextAnchor(),I=this.getTickVerticalAnchor(),V=wn(this.props,!1),H=wn(S,!1),K=yc(yc({},V),{},{fill:"none"},wn(x,!1)),Q=D.map(function(ae,ee){var se=h.getTickLineCoord(ae),ue=se.line,he=se.tick,Ce=yc(yc(yc(yc({textAnchor:U,verticalAnchor:I},V),{},{stroke:"none",fill:w},H),he),{},{index:ee,payload:ae,visibleTicksCount:D.length,tickFormatter:T});return Le.createElement(fi,yv({className:"recharts-cartesian-axis-tick",key:"tick-".concat(ae.value,"-").concat(ae.coordinate,"-").concat(ae.tickCoord)},dp(h.props,ae,ee)),x&&Le.createElement("line",yv({},K,ue,{className:di("recharts-cartesian-axis-tick-line",Du(x,"className"))})),S&&t.renderTickItem(S,Ce,"".concat(qn(T)?T(ae.value,ee):ae.value).concat(E||"")))});return Le.createElement("g",{className:"recharts-cartesian-axis-ticks"},Q)}},{key:"render",value:function(){var n=this,a=this.props,c=a.axisLine,h=a.width,i=a.height,x=a.ticksGenerator,w=a.className,S=a.hide;if(S)return null;var T=this.props,E=T.ticks,D=IO(T,A4e),U=E;return qn(x)&&(U=E&&E.length>0?x(this.props):x(D)),h<=0||i<=0||!U||!U.length?null:Le.createElement(fi,{className:di("recharts-cartesian-axis",w),ref:function(V){n.layerReference=V}},c&&this.renderAxisLine(),this.renderTicks(U,this.state.fontSize,this.state.letterSpacing),dl.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,c){var h;return Le.isValidElement(n)?h=Le.cloneElement(n,a):qn(n)?h=n(a):h=Le.createElement(W0,yv({},a,{className:"recharts-cartesian-axis-tick-value"}),c),h}}])}(G.Component);OD(D_,"displayName","CartesianAxis");OD(D_,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var R4e=["x1","y1","x2","y2","key"],I4e=["offset"];function Z0(e){"@babel/helpers - typeof";return Z0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z0(e)}function aW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ql(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aW(Object(r),!0).forEach(function(n){L4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L4e(e,t,r){return t=D4e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D4e(e){var t=F4e(e,"string");return Z0(t)=="symbol"?t:t+""}function F4e(e,t){if(Z0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Z0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C0(){return C0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},C0.apply(this,arguments)}function sW(e,t){if(e==null)return{};var r=z4e(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function z4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var B4e=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,c=t.y,h=t.width,i=t.height,x=t.ry;return Le.createElement("rect",{x:a,y:c,ry:x,width:h,height:i,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function Tte(e,t){var r;if(Le.isValidElement(e))r=Le.cloneElement(e,t);else if(qn(e))r=e(t);else{var n=t.x1,a=t.y1,c=t.x2,h=t.y2,i=t.key,x=sW(t,R4e),w=wn(x,!1);w.offset;var S=sW(w,I4e);r=Le.createElement("line",C0({},S,{x1:n,y1:a,x2:c,y2:h,fill:"none",key:i}))}return r}function V4e(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,c=e.horizontalPoints;if(!a||!c||!c.length)return null;var h=c.map(function(i,x){var w=Ql(Ql({},e),{},{x1:t,y1:i,x2:t+r,y2:i,key:"line-".concat(x),index:x});return Tte(a,w)});return Le.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function U4e(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,c=e.verticalPoints;if(!a||!c||!c.length)return null;var h=c.map(function(i,x){var w=Ql(Ql({},e),{},{x1:i,y1:t,x2:i,y2:t+r,key:"line-".concat(x),index:x});return Tte(a,w)});return Le.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function $4e(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,c=e.width,h=e.height,i=e.horizontalPoints,x=e.horizontal,w=x===void 0?!0:x;if(!w||!t||!t.length)return null;var S=i.map(function(E){return Math.round(E+a-a)}).sort(function(E,D){return E-D});a!==S[0]&&S.unshift(0);var T=S.map(function(E,D){var U=!S[D+1],I=U?a+h-E:S[D+1]-E;if(I<=0)return null;var V=D%t.length;return Le.createElement("rect",{key:"react-".concat(D),y:E,x:n,height:I,width:c,stroke:"none",fill:t[V],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Le.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},T)}function q4e(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,c=e.x,h=e.y,i=e.width,x=e.height,w=e.verticalPoints;if(!r||!n||!n.length)return null;var S=w.map(function(E){return Math.round(E+c-c)}).sort(function(E,D){return E-D});c!==S[0]&&S.unshift(0);var T=S.map(function(E,D){var U=!S[D+1],I=U?c+i-E:S[D+1]-E;if(I<=0)return null;var V=D%n.length;return Le.createElement("rect",{key:"react-".concat(D),x:E,y:h,width:I,height:x,stroke:"none",fill:n[V],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return Le.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},T)}var G4e=function(t,r){var n=t.xAxis,a=t.width,c=t.height,h=t.offset;return See(MD(Ql(Ql(Ql({},D_.defaultProps),n),{},{ticks:gm(n,!0),viewBox:{x:0,y:0,width:a,height:c}})),h.left,h.left+h.width,r)},W4e=function(t,r){var n=t.yAxis,a=t.width,c=t.height,h=t.offset;return See(MD(Ql(Ql(Ql({},D_.defaultProps),n),{},{ticks:gm(n,!0),viewBox:{x:0,y:0,width:a,height:c}})),h.top,h.top+h.height,r)},rv={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function ms(e){var t,r,n,a,c,h,i=kD(),x=PD(),w=O3e(),S=Ql(Ql({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:rv.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:rv.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:rv.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:rv.horizontalFill,vertical:(c=e.vertical)!==null&&c!==void 0?c:rv.vertical,verticalFill:(h=e.verticalFill)!==null&&h!==void 0?h:rv.verticalFill,x:Dr(e.x)?e.x:w.left,y:Dr(e.y)?e.y:w.top,width:Dr(e.width)?e.width:w.width,height:Dr(e.height)?e.height:w.height}),T=S.x,E=S.y,D=S.width,U=S.height,I=S.syncWithTicks,V=S.horizontalValues,H=S.verticalValues,K=C3e(),Q=E3e();if(!Dr(D)||D<=0||!Dr(U)||U<=0||!Dr(T)||T!==+T||!Dr(E)||E!==+E)return null;var ae=S.verticalCoordinatesGenerator||G4e,ee=S.horizontalCoordinatesGenerator||W4e,se=S.horizontalPoints,ue=S.verticalPoints;if((!se||!se.length)&&qn(ee)){var he=V&&V.length,Ce=ee({yAxis:Q?Ql(Ql({},Q),{},{ticks:he?V:Q.ticks}):void 0,width:i,height:x,offset:w},he?!0:I);qh(Array.isArray(Ce),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Z0(Ce),"]")),Array.isArray(Ce)&&(se=Ce)}if((!ue||!ue.length)&&qn(ae)){var Ne=H&&H.length,me=ae({xAxis:K?Ql(Ql({},K),{},{ticks:Ne?H:K.ticks}):void 0,width:i,height:x,offset:w},Ne?!0:I);qh(Array.isArray(me),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Z0(me),"]")),Array.isArray(me)&&(ue=me)}return Le.createElement("g",{className:"recharts-cartesian-grid"},Le.createElement(B4e,{fill:S.fill,fillOpacity:S.fillOpacity,x:S.x,y:S.y,width:S.width,height:S.height,ry:S.ry}),Le.createElement(V4e,C0({},S,{offset:w,horizontalPoints:se,xAxis:K,yAxis:Q})),Le.createElement(U4e,C0({},S,{offset:w,verticalPoints:ue,xAxis:K,yAxis:Q})),Le.createElement($4e,C0({},S,{horizontalPoints:se})),Le.createElement(q4e,C0({},S,{verticalPoints:ue})))}ms.displayName="CartesianGrid";var H4e=["type","layout","connectNulls","ref"],K4e=["key"];function n_(e){"@babel/helpers - typeof";return n_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n_(e)}function oW(e,t){if(e==null)return{};var r=Z4e(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Z4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function w1(){return w1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w1.apply(this,arguments)}function lW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lW(Object(r),!0).forEach(function(n){zh(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nv(e){return Q4e(e)||J4e(e)||X4e(e)||Y4e()}function Y4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X4e(e,t){if(e){if(typeof e=="string")return u3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u3(e,t)}}function J4e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Q4e(e){if(Array.isArray(e))return u3(e)}function u3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kte(n.key),n)}}function tLe(e,t,r){return t&&cW(e.prototype,t),r&&cW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rLe(e,t,r){return t=cT(t),nLe(e,jte()?Reflect.construct(t,r||[],cT(e).constructor):t.apply(e,r))}function nLe(e,t){if(t&&(n_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iLe(e)}function iLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jte=function(){return!!e})()}function cT(e){return cT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cT(e)}function aLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d3(e,t)}function d3(e,t){return d3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},d3(e,t)}function zh(e,t,r){return t=kte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kte(e){var t=sLe(e,"string");return n_(t)=="symbol"?t:t+""}function sLe(e,t){if(n_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(n_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ud=function(e){function t(){var r;eLe(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=rLe(this,t,[].concat(a)),zh(r,"state",{isAnimationFinished:!0,totalLength:0}),zh(r,"generateSimpleStrokeDasharray",function(h,i){return"".concat(i,"px ").concat(h-i,"px")}),zh(r,"getStrokeDasharray",function(h,i,x){var w=x.reduce(function(H,K){return H+K});if(!w)return r.generateSimpleStrokeDasharray(i,h);for(var S=Math.floor(h/w),T=h%w,E=i-h,D=[],U=0,I=0;U<x.length;I+=x[U],++U)if(I+x[U]>T){D=[].concat(nv(x.slice(0,U)),[T-I]);break}var V=D.length%2===0?[0,E]:[E];return[].concat(nv(t.repeat(x,S)),nv(D),V).map(function(H){return"".concat(H,"px")}).join(", ")}),zh(r,"id",hy("recharts-line-")),zh(r,"pathRef",function(h){r.mainCurve=h}),zh(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),zh(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return aLe(t,e),tLe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var c=this.props,h=c.points,i=c.xAxis,x=c.yAxis,w=c.layout,S=c.children,T=rc(S,L_);if(!T)return null;var E=function(I,V){return{x:I.x,y:I.y,value:I.value,errorVal:ns(I.payload,V)}},D={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Le.createElement(fi,D,T.map(function(U){return Le.cloneElement(U,{key:"bar-".concat(U.props.dataKey),data:h,xAxis:i,yAxis:x,layout:w,dataPointFormatter:E})}))}},{key:"renderDots",value:function(n,a,c){var h=this.props.isAnimationActive;if(h&&!this.state.isAnimationFinished)return null;var i=this.props,x=i.dot,w=i.points,S=i.dataKey,T=wn(this.props,!1),E=wn(x,!0),D=w.map(function(I,V){var H=Pu(Pu(Pu({key:"dot-".concat(V),r:3},T),E),{},{value:I.value,dataKey:S,cx:I.x,cy:I.y,index:V,payload:I.payload});return t.renderDotItem(x,H)}),U={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(c,")"):null};return Le.createElement(fi,w1({className:"recharts-line-dots",key:"dots"},U),D)}},{key:"renderCurveStatically",value:function(n,a,c,h){var i=this.props,x=i.type,w=i.layout,S=i.connectNulls;i.ref;var T=oW(i,H4e),E=Pu(Pu(Pu({},wn(T,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(c,")"):null,points:n},h),{},{type:x,layout:w,connectNulls:S});return Le.createElement(Yg,w1({},E,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var c=this,h=this.props,i=h.points,x=h.strokeDasharray,w=h.isAnimationActive,S=h.animationBegin,T=h.animationDuration,E=h.animationEasing,D=h.animationId,U=h.animateNewValues,I=h.width,V=h.height,H=this.state,K=H.prevPoints,Q=H.totalLength;return Le.createElement(Bu,{begin:S,duration:T,isActive:w,easing:E,from:{t:0},to:{t:1},key:"line-".concat(D),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(ae){var ee=ae.t;if(K){var se=K.length/i.length,ue=i.map(function(be,pe){var Se=Math.floor(pe*se);if(K[Se]){var Ee=K[Se],we=ts(Ee.x,be.x),Pe=ts(Ee.y,be.y);return Pu(Pu({},be),{},{x:we(ee),y:Pe(ee)})}if(U){var Me=ts(I*2,be.x),Be=ts(V/2,be.y);return Pu(Pu({},be),{},{x:Me(ee),y:Be(ee)})}return Pu(Pu({},be),{},{x:be.x,y:be.y})});return c.renderCurveStatically(ue,n,a)}var he=ts(0,Q),Ce=he(ee),Ne;if(x){var me="".concat(x).split(/[,\s]+/gim).map(function(be){return parseFloat(be)});Ne=c.getStrokeDasharray(Ce,Q,me)}else Ne=c.generateSimpleStrokeDasharray(Q,Ce);return c.renderCurveStatically(i,n,a,{strokeDasharray:Ne})})}},{key:"renderCurve",value:function(n,a){var c=this.props,h=c.points,i=c.isAnimationActive,x=this.state,w=x.prevPoints,S=x.totalLength;return i&&h&&h.length&&(!w&&S>0||!Em(w,h))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(h,n,a)}},{key:"render",value:function(){var n,a=this.props,c=a.hide,h=a.dot,i=a.points,x=a.className,w=a.xAxis,S=a.yAxis,T=a.top,E=a.left,D=a.width,U=a.height,I=a.isAnimationActive,V=a.id;if(c||!i||!i.length)return null;var H=this.state.isAnimationFinished,K=i.length===1,Q=di("recharts-line",x),ae=w&&w.allowDataOverflow,ee=S&&S.allowDataOverflow,se=ae||ee,ue=Yn(V)?this.id:V,he=(n=wn(h,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},Ce=he.r,Ne=Ce===void 0?3:Ce,me=he.strokeWidth,be=me===void 0?2:me,pe=AJ(h)?h:{},Se=pe.clipDot,Ee=Se===void 0?!0:Se,we=Ne*2+be;return Le.createElement(fi,{className:Q},ae||ee?Le.createElement("defs",null,Le.createElement("clipPath",{id:"clipPath-".concat(ue)},Le.createElement("rect",{x:ae?E:E-D/2,y:ee?T:T-U/2,width:ae?D:D*2,height:ee?U:U*2})),!Ee&&Le.createElement("clipPath",{id:"clipPath-dots-".concat(ue)},Le.createElement("rect",{x:E-we/2,y:T-we/2,width:D+we,height:U+we}))):null,!K&&this.renderCurve(se,ue),this.renderErrorBar(se,ue),(K||h)&&this.renderDots(se,Ee,ue),(!I||H)&&Fd.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var c=n.length%2!==0?[].concat(nv(n),[0]):n,h=[],i=0;i<a;++i)h=[].concat(nv(h),nv(c));return h}},{key:"renderDotItem",value:function(n,a){var c;if(Le.isValidElement(n))c=Le.cloneElement(n,a);else if(qn(n))c=n(a);else{var h=a.key,i=oW(a,K4e),x=di("recharts-line-dot",typeof n!="boolean"?n.className:"");c=Le.createElement(w2,w1({key:h},i,{className:x}))}return c}}])}(G.PureComponent);zh(Ud,"displayName","Line");zh(Ud,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!xp.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});zh(Ud,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,c=e.yAxisTicks,h=e.dataKey,i=e.bandSize,x=e.displayedData,w=e.offset,S=t.layout,T=x.map(function(E,D){var U=ns(E,h);return S==="horizontal"?{x:qv({axis:r,ticks:a,bandSize:i,entry:E,index:D}),y:Yn(U)?null:n.scale(U),value:U,payload:E}:{x:Yn(U)?null:r.scale(U),y:qv({axis:n,ticks:c,bandSize:i,entry:E,index:D}),value:U,payload:E}});return Pu({points:T,layout:S},w)});var oLe=["layout","type","stroke","connectNulls","isRange","ref"],lLe=["key"],Pte;function i_(e){"@babel/helpers - typeof";return i_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i_(e)}function Cte(e,t){if(e==null)return{};var r=cLe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function E0(){return E0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},E0.apply(this,arguments)}function uW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uW(Object(r),!0).forEach(function(n){Yf(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mte(n.key),n)}}function dLe(e,t,r){return t&&dW(e.prototype,t),r&&dW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hLe(e,t,r){return t=uT(t),fLe(e,Ete()?Reflect.construct(t,r||[],uT(e).constructor):t.apply(e,r))}function fLe(e,t){if(t&&(i_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pLe(e)}function pLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ete(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ete=function(){return!!e})()}function uT(e){return uT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uT(e)}function mLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h3(e,t)}function h3(e,t){return h3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},h3(e,t)}function Yf(e,t,r){return t=Mte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mte(e){var t=gLe(e,"string");return i_(t)=="symbol"?t:t+""}function gLe(e,t){if(i_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(i_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Sc=function(e){function t(){var r;uLe(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=hLe(this,t,[].concat(a)),Yf(r,"state",{isAnimationFinished:!0}),Yf(r,"id",hy("recharts-area-")),Yf(r,"handleAnimationEnd",function(){var h=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),qn(h)&&h()}),Yf(r,"handleAnimationStart",function(){var h=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),qn(h)&&h()}),r}return mLe(t,e),dLe(t,[{key:"renderDots",value:function(n,a,c){var h=this.props.isAnimationActive,i=this.state.isAnimationFinished;if(h&&!i)return null;var x=this.props,w=x.dot,S=x.points,T=x.dataKey,E=wn(this.props,!1),D=wn(w,!0),U=S.map(function(V,H){var K=zg(zg(zg({key:"dot-".concat(H),r:3},E),D),{},{index:H,cx:V.x,cy:V.y,dataKey:T,value:V.value,payload:V.payload,points:S});return t.renderDotItem(w,K)}),I={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(c,")"):null};return Le.createElement(fi,E0({className:"recharts-area-dots"},I),U)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,c=a.baseLine,h=a.points,i=a.strokeWidth,x=h[0].x,w=h[h.length-1].x,S=n*Math.abs(x-w),T=qg(h.map(function(E){return E.y||0}));return Dr(c)&&typeof c=="number"?T=Math.max(c,T):c&&Array.isArray(c)&&c.length&&(T=Math.max(qg(c.map(function(E){return E.y||0})),T)),Dr(T)?Le.createElement("rect",{x:x<w?x:x-S,y:0,width:S,height:Math.floor(T+(i?parseInt("".concat(i),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,c=a.baseLine,h=a.points,i=a.strokeWidth,x=h[0].y,w=h[h.length-1].y,S=n*Math.abs(x-w),T=qg(h.map(function(E){return E.x||0}));return Dr(c)&&typeof c=="number"?T=Math.max(c,T):c&&Array.isArray(c)&&c.length&&(T=Math.max(qg(c.map(function(E){return E.x||0})),T)),Dr(T)?Le.createElement("rect",{x:0,y:x<w?x:x-S,width:T+(i?parseInt("".concat(i),10):1),height:Math.floor(S)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,c,h){var i=this.props,x=i.layout,w=i.type,S=i.stroke,T=i.connectNulls,E=i.isRange;i.ref;var D=Cte(i,oLe);return Le.createElement(fi,{clipPath:c?"url(#clipPath-".concat(h,")"):null},Le.createElement(Yg,E0({},wn(D,!0),{points:n,connectNulls:T,type:w,baseLine:a,layout:x,stroke:"none",className:"recharts-area-area"})),S!=="none"&&Le.createElement(Yg,E0({},wn(this.props,!1),{className:"recharts-area-curve",layout:x,type:w,connectNulls:T,fill:"none",points:n})),S!=="none"&&E&&Le.createElement(Yg,E0({},wn(this.props,!1),{className:"recharts-area-curve",layout:x,type:w,connectNulls:T,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var c=this,h=this.props,i=h.points,x=h.baseLine,w=h.isAnimationActive,S=h.animationBegin,T=h.animationDuration,E=h.animationEasing,D=h.animationId,U=this.state,I=U.prevPoints,V=U.prevBaseLine;return Le.createElement(Bu,{begin:S,duration:T,isActive:w,easing:E,from:{t:0},to:{t:1},key:"area-".concat(D),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(H){var K=H.t;if(I){var Q=I.length/i.length,ae=i.map(function(he,Ce){var Ne=Math.floor(Ce*Q);if(I[Ne]){var me=I[Ne],be=ts(me.x,he.x),pe=ts(me.y,he.y);return zg(zg({},he),{},{x:be(K),y:pe(K)})}return he}),ee;if(Dr(x)&&typeof x=="number"){var se=ts(V,x);ee=se(K)}else if(Yn(x)||E_(x)){var ue=ts(V,0);ee=ue(K)}else ee=x.map(function(he,Ce){var Ne=Math.floor(Ce*Q);if(V[Ne]){var me=V[Ne],be=ts(me.x,he.x),pe=ts(me.y,he.y);return zg(zg({},he),{},{x:be(K),y:pe(K)})}return he});return c.renderAreaStatically(ae,ee,n,a)}return Le.createElement(fi,null,Le.createElement("defs",null,Le.createElement("clipPath",{id:"animationClipPath-".concat(a)},c.renderClipRect(K))),Le.createElement(fi,{clipPath:"url(#animationClipPath-".concat(a,")")},c.renderAreaStatically(i,x,n,a)))})}},{key:"renderArea",value:function(n,a){var c=this.props,h=c.points,i=c.baseLine,x=c.isAnimationActive,w=this.state,S=w.prevPoints,T=w.prevBaseLine,E=w.totalLength;return x&&h&&h.length&&(!S&&E>0||!Em(S,h)||!Em(T,i))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(h,i,n,a)}},{key:"render",value:function(){var n,a=this.props,c=a.hide,h=a.dot,i=a.points,x=a.className,w=a.top,S=a.left,T=a.xAxis,E=a.yAxis,D=a.width,U=a.height,I=a.isAnimationActive,V=a.id;if(c||!i||!i.length)return null;var H=this.state.isAnimationFinished,K=i.length===1,Q=di("recharts-area",x),ae=T&&T.allowDataOverflow,ee=E&&E.allowDataOverflow,se=ae||ee,ue=Yn(V)?this.id:V,he=(n=wn(h,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},Ce=he.r,Ne=Ce===void 0?3:Ce,me=he.strokeWidth,be=me===void 0?2:me,pe=AJ(h)?h:{},Se=pe.clipDot,Ee=Se===void 0?!0:Se,we=Ne*2+be;return Le.createElement(fi,{className:Q},ae||ee?Le.createElement("defs",null,Le.createElement("clipPath",{id:"clipPath-".concat(ue)},Le.createElement("rect",{x:ae?S:S-D/2,y:ee?w:w-U/2,width:ae?D:D*2,height:ee?U:U*2})),!Ee&&Le.createElement("clipPath",{id:"clipPath-dots-".concat(ue)},Le.createElement("rect",{x:S-we/2,y:w-we/2,width:D+we,height:U+we}))):null,K?null:this.renderArea(se,ue),(h||K)&&this.renderDots(se,Ee,ue),(!I||H)&&Fd.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(G.PureComponent);Pte=Sc;Yf(Sc,"displayName","Area");Yf(Sc,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!xp.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Yf(Sc,"getBaseValue",function(e,t,r,n){var a=e.layout,c=e.baseValue,h=t.props.baseValue,i=h??c;if(Dr(i)&&typeof i=="number")return i;var x=a==="horizontal"?n:r,w=x.scale.domain();if(x.type==="number"){var S=Math.max(w[0],w[1]),T=Math.min(w[0],w[1]);return i==="dataMin"?T:i==="dataMax"||S<0?S:Math.max(Math.min(w[0],w[1]),0)}return i==="dataMin"?w[0]:i==="dataMax"?w[1]:w[0]});Yf(Sc,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,c=e.xAxisTicks,h=e.yAxisTicks,i=e.bandSize,x=e.dataKey,w=e.stackedData,S=e.dataStartIndex,T=e.displayedData,E=e.offset,D=t.layout,U=w&&w.length,I=Pte.getBaseValue(t,r,n,a),V=D==="horizontal",H=!1,K=T.map(function(ae,ee){var se;U?se=w[S+ee]:(se=ns(ae,x),Array.isArray(se)?H=!0:se=[I,se]);var ue=se[1]==null||U&&ns(ae,x)==null;return V?{x:qv({axis:n,ticks:c,bandSize:i,entry:ae,index:ee}),y:ue?null:a.scale(se[1]),value:se,payload:ae}:{x:ue?null:n.scale(se[1]),y:qv({axis:a,ticks:h,bandSize:i,entry:ae,index:ee}),value:se,payload:ae}}),Q;return U||H?Q=K.map(function(ae){var ee=Array.isArray(ae.value)?ae.value[0]:null;return V?{x:ae.x,y:ee!=null&&ae.y!=null?a.scale(ee):null}:{x:ee!=null?n.scale(ee):null,y:ae.y}}):Q=V?a.scale(I):n.scale(I),zg({points:K,baseLine:Q,layout:D,isRange:H},E)});Yf(Sc,"renderDotItem",function(e,t){var r;if(Le.isValidElement(e))r=Le.cloneElement(e,t);else if(qn(e))r=e(t);else{var n=di("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,c=Cte(t,lLe);r=Le.createElement(w2,E0({},c,{key:a,className:n}))}return r});function a_(e){"@babel/helpers - typeof";return a_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a_(e)}function yLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xLe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ite(n.key),n)}}function vLe(e,t,r){return t&&xLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Le(e,t,r){return t=dT(t),bLe(e,Ote()?Reflect.construct(t,r||[],dT(e).constructor):t.apply(e,r))}function bLe(e,t){if(t&&(a_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wLe(e)}function wLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ote(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ote=function(){return!!e})()}function dT(e){return dT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dT(e)}function SLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f3(e,t)}function f3(e,t){return f3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},f3(e,t)}function Rte(e,t,r){return t=Ite(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ite(e){var t=NLe(e,"string");return a_(t)=="symbol"?t:t+""}function NLe(e,t){if(a_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(a_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var j2=function(e){function t(){return yLe(this,t),_Le(this,t,arguments)}return SLe(t,e),vLe(t,[{key:"render",value:function(){return null}}])}(Le.Component);Rte(j2,"displayName","ZAxis");Rte(j2,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var ALe=["option","isActive"];function S1(){return S1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S1.apply(this,arguments)}function TLe(e,t){if(e==null)return{};var r=jLe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function kLe(e){var t=e.option,r=e.isActive,n=TLe(e,ALe);return typeof t=="string"?Le.createElement(Pw,S1({option:Le.createElement(cj,S1({type:t},n)),isActive:r,shapeType:"symbols"},n)):Le.createElement(Pw,S1({option:t,isActive:r,shapeType:"symbols"},n))}function s_(e){"@babel/helpers - typeof";return s_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s_(e)}function N1(){return N1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},N1.apply(this,arguments)}function hW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ed(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hW(Object(r),!0).forEach(function(n){Wg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dte(n.key),n)}}function CLe(e,t,r){return t&&fW(e.prototype,t),r&&fW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ELe(e,t,r){return t=hT(t),MLe(e,Lte()?Reflect.construct(t,r||[],hT(e).constructor):t.apply(e,r))}function MLe(e,t){if(t&&(s_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OLe(e)}function OLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Lte=function(){return!!e})()}function hT(e){return hT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hT(e)}function RLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p3(e,t)}function p3(e,t){return p3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},p3(e,t)}function Wg(e,t,r){return t=Dte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dte(e){var t=ILe(e,"string");return s_(t)=="symbol"?t:t+""}function ILe(e,t){if(s_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(s_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var F_=function(e){function t(){var r;PLe(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=ELe(this,t,[].concat(a)),Wg(r,"state",{isAnimationFinished:!1}),Wg(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0})}),Wg(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1})}),Wg(r,"id",hy("recharts-scatter-")),r}return RLe(t,e),CLe(t,[{key:"renderSymbolsStatically",value:function(n){var a=this,c=this.props,h=c.shape,i=c.activeShape,x=c.activeIndex,w=wn(this.props,!1);return n.map(function(S,T){var E=x===T,D=E?i:h,U=Ed(Ed({},w),S);return Le.createElement(fi,N1({className:"recharts-scatter-symbol",key:"symbol-".concat(S==null?void 0:S.cx,"-").concat(S==null?void 0:S.cy,"-").concat(S==null?void 0:S.size,"-").concat(T)},dp(a.props,S,T),{role:"img"}),Le.createElement(kLe,N1({option:D,isActive:E,key:"symbol-".concat(T)},U)))})}},{key:"renderSymbolsWithAnimation",value:function(){var n=this,a=this.props,c=a.points,h=a.isAnimationActive,i=a.animationBegin,x=a.animationDuration,w=a.animationEasing,S=a.animationId,T=this.state.prevPoints;return Le.createElement(Bu,{begin:i,duration:x,isActive:h,easing:w,from:{t:0},to:{t:1},key:"pie-".concat(S),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(E){var D=E.t,U=c.map(function(I,V){var H=T&&T[V];if(H){var K=ts(H.cx,I.cx),Q=ts(H.cy,I.cy),ae=ts(H.size,I.size);return Ed(Ed({},I),{},{cx:K(D),cy:Q(D),size:ae(D)})}var ee=ts(0,I.size);return Ed(Ed({},I),{},{size:ee(D)})});return Le.createElement(fi,null,n.renderSymbolsStatically(U))})}},{key:"renderSymbols",value:function(){var n=this.props,a=n.points,c=n.isAnimationActive,h=this.state.prevPoints;return c&&a&&a.length&&(!h||!Em(h,a))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(a)}},{key:"renderErrorBar",value:function(){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var a=this.props,c=a.points,h=a.xAxis,i=a.yAxis,x=a.children,w=rc(x,L_);return w?w.map(function(S,T){var E=S.props,D=E.direction,U=E.dataKey;return Le.cloneElement(S,{key:"".concat(D,"-").concat(U,"-").concat(c[T]),data:c,xAxis:h,yAxis:i,layout:D==="x"?"vertical":"horizontal",dataPointFormatter:function(V,H){return{x:V.cx,y:V.cy,value:D==="x"?+V.node.x:+V.node.y,errorVal:ns(V,H)}}})}):null}},{key:"renderLine",value:function(){var n=this.props,a=n.points,c=n.line,h=n.lineType,i=n.lineJointType,x=wn(this.props,!1),w=wn(c,!1),S,T;if(h==="joint")S=a.map(function(Q){return{x:Q.cx,y:Q.cy}});else if(h==="fitting"){var E=_2e(a),D=E.xmin,U=E.xmax,I=E.a,V=E.b,H=function(ae){return I*ae+V};S=[{x:D,y:H(D)},{x:U,y:H(U)}]}var K=Ed(Ed(Ed({},x),{},{fill:"none",stroke:x&&x.fill},w),{},{points:S});return Le.isValidElement(c)?T=Le.cloneElement(c,K):qn(c)?T=c(K):T=Le.createElement(Yg,N1({},K,{type:i})),Le.createElement(fi,{className:"recharts-scatter-line",key:"recharts-scatter-line"},T)}},{key:"render",value:function(){var n=this.props,a=n.hide,c=n.points,h=n.line,i=n.className,x=n.xAxis,w=n.yAxis,S=n.left,T=n.top,E=n.width,D=n.height,U=n.id,I=n.isAnimationActive;if(a||!c||!c.length)return null;var V=this.state.isAnimationFinished,H=di("recharts-scatter",i),K=x&&x.allowDataOverflow,Q=w&&w.allowDataOverflow,ae=K||Q,ee=Yn(U)?this.id:U;return Le.createElement(fi,{className:H,clipPath:ae?"url(#clipPath-".concat(ee,")"):null},K||Q?Le.createElement("defs",null,Le.createElement("clipPath",{id:"clipPath-".concat(ee)},Le.createElement("rect",{x:K?S:S-E/2,y:Q?T:T-D/2,width:K?E:E*2,height:Q?D:D*2}))):null,h&&this.renderLine(),this.renderErrorBar(),Le.createElement(fi,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!I||V)&&Fd.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}}])}(G.PureComponent);Wg(F_,"displayName","Scatter");Wg(F_,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!xp.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});Wg(F_,"getComposedData",function(e){var t=e.xAxis,r=e.yAxis,n=e.zAxis,a=e.item,c=e.displayedData,h=e.xAxisTicks,i=e.yAxisTicks,x=e.offset,w=a.props.tooltipType,S=rc(a.props.children,Jh),T=Yn(t.dataKey)?a.props.dataKey:t.dataKey,E=Yn(r.dataKey)?a.props.dataKey:r.dataKey,D=n&&n.dataKey,U=n?n.range:j2.defaultProps.range,I=U&&U[0],V=t.scale.bandwidth?t.scale.bandwidth():0,H=r.scale.bandwidth?r.scale.bandwidth():0,K=c.map(function(Q,ae){var ee=ns(Q,T),se=ns(Q,E),ue=!Yn(D)&&ns(Q,D)||"-",he=[{name:Yn(t.dataKey)?a.props.name:t.name||t.dataKey,unit:t.unit||"",value:ee,payload:Q,dataKey:T,type:w},{name:Yn(r.dataKey)?a.props.name:r.name||r.dataKey,unit:r.unit||"",value:se,payload:Q,dataKey:E,type:w}];ue!=="-"&&he.push({name:n.name||n.dataKey,unit:n.unit||"",value:ue,payload:Q,dataKey:D,type:w});var Ce=qv({axis:t,ticks:h,bandSize:V,entry:Q,index:ae,dataKey:T}),Ne=qv({axis:r,ticks:i,bandSize:H,entry:Q,index:ae,dataKey:E}),me=ue!=="-"?n.scale(ue):I,be=Math.sqrt(Math.max(me,0)/Math.PI);return Ed(Ed({},Q),{},{cx:Ce,cy:Ne,x:Ce-be,y:Ne-be,xAxis:t,yAxis:r,zAxis:n,width:2*be,height:2*be,size:me,node:{x:ee,y:se,z:ue},tooltipPayload:he,tooltipPosition:{x:Ce,y:Ne},payload:Q},S&&S[ae]&&S[ae].props)});return Ed({points:K},x)});function o_(e){"@babel/helpers - typeof";return o_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o_(e)}function LLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DLe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bte(n.key),n)}}function FLe(e,t,r){return t&&DLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zLe(e,t,r){return t=fT(t),BLe(e,Fte()?Reflect.construct(t,r||[],fT(e).constructor):t.apply(e,r))}function BLe(e,t){if(t&&(o_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VLe(e)}function VLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fte=function(){return!!e})()}function fT(e){return fT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fT(e)}function ULe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m3(e,t)}function m3(e,t){return m3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},m3(e,t)}function zte(e,t,r){return t=Bte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bte(e){var t=$Le(e,"string");return o_(t)=="symbol"?t:t+""}function $Le(e,t){if(o_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(o_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function g3(){return g3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g3.apply(this,arguments)}function qLe(e){var t=e.xAxisId,r=kD(),n=PD(),a=mte(t);return a==null?null:Le.createElement(D_,g3({},a,{className:di("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(h){return gm(h,!0)}}))}var ga=function(e){function t(){return LLe(this,t),zLe(this,t,arguments)}return ULe(t,e),FLe(t,[{key:"render",value:function(){return Le.createElement(qLe,this.props)}}])}(Le.Component);zte(ga,"displayName","XAxis");zte(ga,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function l_(e){"@babel/helpers - typeof";return l_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l_(e)}function GLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WLe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$te(n.key),n)}}function HLe(e,t,r){return t&&WLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function KLe(e,t,r){return t=pT(t),ZLe(e,Vte()?Reflect.construct(t,r||[],pT(e).constructor):t.apply(e,r))}function ZLe(e,t){if(t&&(l_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YLe(e)}function YLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Vte=function(){return!!e})()}function pT(e){return pT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pT(e)}function XLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y3(e,t)}function y3(e,t){return y3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},y3(e,t)}function Ute(e,t,r){return t=$te(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $te(e){var t=JLe(e,"string");return l_(t)=="symbol"?t:t+""}function JLe(e,t){if(l_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(l_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function x3(){return x3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},x3.apply(this,arguments)}var QLe=function(t){var r=t.yAxisId,n=kD(),a=PD(),c=gte(r);return c==null?null:Le.createElement(D_,x3({},c,{className:di("recharts-".concat(c.axisType," ").concat(c.axisType),c.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(i){return gm(i,!0)}}))},ya=function(e){function t(){return GLe(this,t),KLe(this,t,arguments)}return XLe(t,e),HLe(t,[{key:"render",value:function(){return Le.createElement(QLe,this.props)}}])}(Le.Component);Ute(ya,"displayName","YAxis");Ute(ya,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function pW(e){return nDe(e)||rDe(e)||tDe(e)||eDe()}function eDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tDe(e,t){if(e){if(typeof e=="string")return v3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v3(e,t)}}function rDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nDe(e){if(Array.isArray(e))return v3(e)}function v3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _3=function(t,r,n,a,c){var h=rc(t,ED),i=rc(t,Pj),x=[].concat(pW(h),pW(i)),w=rc(t,Ej),S="".concat(a,"Id"),T=a[0],E=r;if(x.length&&(E=x.reduce(function(I,V){if(V.props[S]===n&&np(V.props,"extendDomain")&&Dr(V.props[T])){var H=V.props[T];return[Math.min(I[0],H),Math.max(I[1],H)]}return I},E)),w.length){var D="".concat(T,"1"),U="".concat(T,"2");E=w.reduce(function(I,V){if(V.props[S]===n&&np(V.props,"extendDomain")&&Dr(V.props[D])&&Dr(V.props[U])){var H=V.props[D],K=V.props[U];return[Math.min(I[0],H,K),Math.max(I[1],H,K)]}return I},E)}return c&&c.length&&(E=c.reduce(function(I,V){return Dr(V)?[Math.min(I[0],V),Math.max(I[1],V)]:I},E)),E},LO={exports:{}},mW;function iDe(){return mW||(mW=1,function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(x,w,S){this.fn=x,this.context=w,this.once=S||!1}function c(x,w,S,T,E){if(typeof S!="function")throw new TypeError("The listener must be a function");var D=new a(S,T||x,E),U=r?r+w:w;return x._events[U]?x._events[U].fn?x._events[U]=[x._events[U],D]:x._events[U].push(D):(x._events[U]=D,x._eventsCount++),x}function h(x,w){--x._eventsCount===0?x._events=new n:delete x._events[w]}function i(){this._events=new n,this._eventsCount=0}i.prototype.eventNames=function(){var w=[],S,T;if(this._eventsCount===0)return w;for(T in S=this._events)t.call(S,T)&&w.push(r?T.slice(1):T);return Object.getOwnPropertySymbols?w.concat(Object.getOwnPropertySymbols(S)):w},i.prototype.listeners=function(w){var S=r?r+w:w,T=this._events[S];if(!T)return[];if(T.fn)return[T.fn];for(var E=0,D=T.length,U=new Array(D);E<D;E++)U[E]=T[E].fn;return U},i.prototype.listenerCount=function(w){var S=r?r+w:w,T=this._events[S];return T?T.fn?1:T.length:0},i.prototype.emit=function(w,S,T,E,D,U){var I=r?r+w:w;if(!this._events[I])return!1;var V=this._events[I],H=arguments.length,K,Q;if(V.fn){switch(V.once&&this.removeListener(w,V.fn,void 0,!0),H){case 1:return V.fn.call(V.context),!0;case 2:return V.fn.call(V.context,S),!0;case 3:return V.fn.call(V.context,S,T),!0;case 4:return V.fn.call(V.context,S,T,E),!0;case 5:return V.fn.call(V.context,S,T,E,D),!0;case 6:return V.fn.call(V.context,S,T,E,D,U),!0}for(Q=1,K=new Array(H-1);Q<H;Q++)K[Q-1]=arguments[Q];V.fn.apply(V.context,K)}else{var ae=V.length,ee;for(Q=0;Q<ae;Q++)switch(V[Q].once&&this.removeListener(w,V[Q].fn,void 0,!0),H){case 1:V[Q].fn.call(V[Q].context);break;case 2:V[Q].fn.call(V[Q].context,S);break;case 3:V[Q].fn.call(V[Q].context,S,T);break;case 4:V[Q].fn.call(V[Q].context,S,T,E);break;default:if(!K)for(ee=1,K=new Array(H-1);ee<H;ee++)K[ee-1]=arguments[ee];V[Q].fn.apply(V[Q].context,K)}}return!0},i.prototype.on=function(w,S,T){return c(this,w,S,T,!1)},i.prototype.once=function(w,S,T){return c(this,w,S,T,!0)},i.prototype.removeListener=function(w,S,T,E){var D=r?r+w:w;if(!this._events[D])return this;if(!S)return h(this,D),this;var U=this._events[D];if(U.fn)U.fn===S&&(!E||U.once)&&(!T||U.context===T)&&h(this,D);else{for(var I=0,V=[],H=U.length;I<H;I++)(U[I].fn!==S||E&&!U[I].once||T&&U[I].context!==T)&&V.push(U[I]);V.length?this._events[D]=V.length===1?V[0]:V:h(this,D)}return this},i.prototype.removeAllListeners=function(w){var S;return w?(S=r?r+w:w,this._events[S]&&h(this,S)):(this._events=new n,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=r,i.EventEmitter=i,e.exports=i}(LO)),LO.exports}var aDe=iDe();const sDe=ha(aDe);var DO=new sDe,FO="recharts.syncMouseEvents";function Lw(e){"@babel/helpers - typeof";return Lw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lw(e)}function oDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lDe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qte(n.key),n)}}function cDe(e,t,r){return t&&lDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zO(e,t,r){return t=qte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qte(e){var t=uDe(e,"string");return Lw(t)=="symbol"?t:t+""}function uDe(e,t){if(Lw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Lw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var dDe=function(){function e(){oDe(this,e),zO(this,"activeIndex",0),zO(this,"coordinateList",[]),zO(this,"layout","horizontal")}return cDe(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,c=a===void 0?null:a,h=r.container,i=h===void 0?null:h,x=r.layout,w=x===void 0?null:x,S=r.offset,T=S===void 0?null:S,E=r.mouseHandlerCallback,D=E===void 0?null:E;this.coordinateList=(n=c??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=w??this.layout,this.offset=T??this.offset,this.mouseHandlerCallback=D??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),c=a.x,h=a.y,i=a.height,x=this.coordinateList[this.activeIndex].coordinate,w=((r=window)===null||r===void 0?void 0:r.scrollX)||0,S=((n=window)===null||n===void 0?void 0:n.scrollY)||0,T=c+x+w,E=h+this.offset.top+i/2+S;this.mouseHandlerCallback({pageX:T,pageY:E})}}}])}();function hDe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&Dr(n)&&Dr(a))return!0}return!1}function fDe(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function Gte(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,c=e.endAngle,h=Ga(t,r,n,a),i=Ga(t,r,n,c);return{points:[h,i],cx:t,cy:r,radius:n,startAngle:a,endAngle:c}}function pDe(e,t,r){var n,a,c,h;if(e==="horizontal")n=t.x,c=n,a=r.top,h=r.top+r.height;else if(e==="vertical")a=t.y,h=a,n=r.left,c=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var i=t.cx,x=t.cy,w=t.innerRadius,S=t.outerRadius,T=t.angle,E=Ga(i,x,w,T),D=Ga(i,x,S,T);n=E.x,a=E.y,c=D.x,h=D.y}else return Gte(t);return[{x:n,y:a},{x:c,y:h}]}function Dw(e){"@babel/helpers - typeof";return Dw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dw(e)}function gW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function aN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gW(Object(r),!0).forEach(function(n){mDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mDe(e,t,r){return t=gDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gDe(e){var t=yDe(e,"string");return Dw(t)=="symbol"?t:t+""}function yDe(e,t){if(Dw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xDe(e){var t,r,n=e.element,a=e.tooltipEventType,c=e.isActive,h=e.activeCoordinate,i=e.activePayload,x=e.offset,w=e.activeTooltipIndex,S=e.tooltipAxisBandSize,T=e.layout,E=e.chartName,D=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!D||!c||!h||E!=="ScatterChart"&&a!=="axis")return null;var U,I=Yg;if(E==="ScatterChart")U=h,I=YOe;else if(E==="BarChart")U=fDe(T,h,x,S),I=ND;else if(T==="radial"){var V=Gte(h),H=V.cx,K=V.cy,Q=V.radius,ae=V.startAngle,ee=V.endAngle;U={cx:H,cy:K,startAngle:ae,endAngle:ee,innerRadius:Q,outerRadius:Q},I=Dee}else U={points:pDe(T,h,x)},I=Yg;var se=aN(aN(aN(aN({stroke:"#ccc",pointerEvents:"none"},x),U),wn(D,!1)),{},{payload:i,payloadIndex:w,className:di("recharts-tooltip-cursor",D.className)});return G.isValidElement(D)?G.cloneElement(D,se):G.createElement(I,se)}var vDe=["item"],_De=["children","className","width","height","style","compact","title","desc"];function c_(e){"@babel/helpers - typeof";return c_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c_(e)}function xv(){return xv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xv.apply(this,arguments)}function yW(e,t){return SDe(e)||wDe(e,t)||Hte(e,t)||bDe()}function bDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,h,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(S){w=!0,a=S}finally{try{if(!x&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function SDe(e){if(Array.isArray(e))return e}function xW(e,t){if(e==null)return{};var r=NDe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function NDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ADe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TDe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kte(n.key),n)}}function jDe(e,t,r){return t&&TDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function kDe(e,t,r){return t=mT(t),PDe(e,Wte()?Reflect.construct(t,r||[],mT(e).constructor):t.apply(e,r))}function PDe(e,t){if(t&&(c_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CDe(e)}function CDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wte=function(){return!!e})()}function mT(e){return mT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mT(e)}function EDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b3(e,t)}function b3(e,t){return b3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},b3(e,t)}function u_(e){return RDe(e)||ODe(e)||Hte(e)||MDe()}function MDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hte(e,t){if(e){if(typeof e=="string")return w3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w3(e,t)}}function ODe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RDe(e){if(Array.isArray(e))return w3(e)}function w3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vW(Object(r),!0).forEach(function(n){ei(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ei(e,t,r){return t=Kte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kte(e){var t=IDe(e,"string");return c_(t)=="symbol"?t:t+""}function IDe(e,t){if(c_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(c_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LDe={xAxis:["bottom","top"],yAxis:["left","right"]},DDe={width:"100%",height:"100%"},Zte={x:0,y:0};function sN(e){return e}var FDe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},zDe=function(t,r,n,a){var c=r.find(function(S){return S&&S.index===n});if(c){if(t==="horizontal")return{x:c.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:c.coordinate};if(t==="centric"){var h=c.coordinate,i=a.radius;return hr(hr(hr({},a),Ga(a.cx,a.cy,i,h)),{},{angle:h,radius:i})}var x=c.coordinate,w=a.angle;return hr(hr(hr({},a),Ga(a.cx,a.cy,x,w)),{},{angle:w,radius:x})}return Zte},Mj=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,c=r.dataEndIndex,h=(n??[]).reduce(function(i,x){var w=x.props.data;return w&&w.length?[].concat(u_(i),u_(w)):i},[]);return h.length>0?h:t&&t.length&&Dr(a)&&Dr(c)?t.slice(a,c+1):[]};function Yte(e){return e==="number"?[0,"auto"]:void 0}var S3=function(t,r,n,a){var c=t.graphicalItems,h=t.tooltipAxis,i=Mj(r,t);return n<0||!c||!c.length||n>=i.length?null:c.reduce(function(x,w){var S,T=(S=w.props.data)!==null&&S!==void 0?S:r;T&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(T=T.slice(t.dataStartIndex,t.dataEndIndex+1));var E;if(h.dataKey&&!h.allowDuplicatedCategory){var D=T===void 0?i:T;E=fA(D,h.dataKey,a)}else E=T&&T[n]||i[n];return E?[].concat(u_(x),[SD(w,E)]):x},[])},_W=function(t,r,n,a){var c=a||{x:t.chartX,y:t.chartY},h=FDe(c,n),i=t.orderedTooltipTicks,x=t.tooltipAxis,w=t.tooltipTicks,S=ACe(h,i,w,x);if(S>=0&&w){var T=w[S]&&w[S].value,E=S3(t,r,S,T),D=zDe(n,i,S,c);return{activeTooltipIndex:S,activeLabel:T,activePayload:E,activeCoordinate:D}}return null},BDe=function(t,r){var n=r.axes,a=r.graphicalItems,c=r.axisType,h=r.axisIdKey,i=r.stackGroups,x=r.dataStartIndex,w=r.dataEndIndex,S=t.layout,T=t.children,E=t.stackOffset,D=wee(S,c);return n.reduce(function(U,I){var V,H=I.type.defaultProps!==void 0?hr(hr({},I.type.defaultProps),I.props):I.props,K=H.type,Q=H.dataKey,ae=H.allowDataOverflow,ee=H.allowDuplicatedCategory,se=H.scale,ue=H.ticks,he=H.includeHidden,Ce=H[h];if(U[Ce])return U;var Ne=Mj(t.data,{graphicalItems:a.filter(function(tt){var nt,Dt=h in tt.props?tt.props[h]:(nt=tt.type.defaultProps)===null||nt===void 0?void 0:nt[h];return Dt===Ce}),dataStartIndex:x,dataEndIndex:w}),me=Ne.length,be,pe,Se;hDe(H.domain,ae,K)&&(be=MI(H.domain,null,ae),D&&(K==="number"||se!=="auto")&&(Se=x1(Ne,Q,"category")));var Ee=Yte(K);if(!be||be.length===0){var we,Pe=(we=H.domain)!==null&&we!==void 0?we:Ee;if(Q){if(be=x1(Ne,Q,K),K==="category"&&D){var Me=v2e(be);ee&&Me?(pe=be,be=QA(0,me)):ee||(be=uq(Pe,be,I).reduce(function(tt,nt){return tt.indexOf(nt)>=0?tt:[].concat(u_(tt),[nt])},[]))}else if(K==="category")ee?be=be.filter(function(tt){return tt!==""&&!Yn(tt)}):be=uq(Pe,be,I).reduce(function(tt,nt){return tt.indexOf(nt)>=0||nt===""||Yn(nt)?tt:[].concat(u_(tt),[nt])},[]);else if(K==="number"){var Be=CCe(Ne,a.filter(function(tt){var nt,Dt,nr=h in tt.props?tt.props[h]:(nt=tt.type.defaultProps)===null||nt===void 0?void 0:nt[h],ir="hide"in tt.props?tt.props.hide:(Dt=tt.type.defaultProps)===null||Dt===void 0?void 0:Dt.hide;return nr===Ce&&(he||!ir)}),Q,c,S);Be&&(be=Be)}D&&(K==="number"||se!=="auto")&&(Se=x1(Ne,Q,"category"))}else D?be=QA(0,me):i&&i[Ce]&&i[Ce].hasStack&&K==="number"?be=E==="expand"?[0,1]:Cee(i[Ce].stackGroups,x,w):be=bee(Ne,a.filter(function(tt){var nt=h in tt.props?tt.props[h]:tt.type.defaultProps[h],Dt="hide"in tt.props?tt.props.hide:tt.type.defaultProps.hide;return nt===Ce&&(he||!Dt)}),K,S,!0);if(K==="number")be=_3(T,be,Ce,c,ue),Pe&&(be=MI(Pe,be,ae));else if(K==="category"&&Pe){var Ge=Pe,We=be.every(function(tt){return Ge.indexOf(tt)>=0});We&&(be=Ge)}}return hr(hr({},U),{},ei({},Ce,hr(hr({},H),{},{axisType:c,domain:be,categoricalDomain:Se,duplicateDomain:pe,originalDomain:(V=H.domain)!==null&&V!==void 0?V:Ee,isCategorical:D,layout:S})))},{})},VDe=function(t,r){var n=r.graphicalItems,a=r.Axis,c=r.axisType,h=r.axisIdKey,i=r.stackGroups,x=r.dataStartIndex,w=r.dataEndIndex,S=t.layout,T=t.children,E=Mj(t.data,{graphicalItems:n,dataStartIndex:x,dataEndIndex:w}),D=E.length,U=wee(S,c),I=-1;return n.reduce(function(V,H){var K=H.type.defaultProps!==void 0?hr(hr({},H.type.defaultProps),H.props):H.props,Q=K[h],ae=Yte("number");if(!V[Q]){I++;var ee;return U?ee=QA(0,D):i&&i[Q]&&i[Q].hasStack?(ee=Cee(i[Q].stackGroups,x,w),ee=_3(T,ee,Q,c)):(ee=MI(ae,bee(E,n.filter(function(se){var ue,he,Ce=h in se.props?se.props[h]:(ue=se.type.defaultProps)===null||ue===void 0?void 0:ue[h],Ne="hide"in se.props?se.props.hide:(he=se.type.defaultProps)===null||he===void 0?void 0:he.hide;return Ce===Q&&!Ne}),"number",S),a.defaultProps.allowDataOverflow),ee=_3(T,ee,Q,c)),hr(hr({},V),{},ei({},Q,hr(hr({axisType:c},a.defaultProps),{},{hide:!0,orientation:Du(LDe,"".concat(c,".").concat(I%2),null),domain:ee,originalDomain:ae,isCategorical:U,layout:S})))}return V},{})},UDe=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,c=r.AxisComp,h=r.graphicalItems,i=r.stackGroups,x=r.dataStartIndex,w=r.dataEndIndex,S=t.children,T="".concat(a,"Id"),E=rc(S,c),D={};return E&&E.length?D=BDe(t,{axes:E,graphicalItems:h,axisType:a,axisIdKey:T,stackGroups:i,dataStartIndex:x,dataEndIndex:w}):h&&h.length&&(D=VDe(t,{Axis:c,graphicalItems:h,axisType:a,axisIdKey:T,stackGroups:i,dataStartIndex:x,dataEndIndex:w})),D},$De=function(t){var r=$g(t),n=gm(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:YL(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:zA(r,n)}},bW=function(t){var r=t.children,n=t.defaultShowTooltip,a=Eu(r,Xv),c=0,h=0;return t.data&&t.data.length!==0&&(h=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(c=a.props.startIndex),a.props.endIndex>=0&&(h=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:c,dataEndIndex:h,activeTooltipIndex:-1,isTooltipActive:!!n}},qDe=function(t){return!t||!t.length?!1:t.some(function(r){var n=_m(r&&r.type);return n&&n.indexOf("Bar")>=0})},wW=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},GDe=function(t,r){var n=t.props,a=t.graphicalItems,c=t.xAxisMap,h=c===void 0?{}:c,i=t.yAxisMap,x=i===void 0?{}:i,w=n.width,S=n.height,T=n.children,E=n.margin||{},D=Eu(T,Xv),U=Eu(T,Fu),I=Object.keys(x).reduce(function(ee,se){var ue=x[se],he=ue.orientation;return!ue.mirror&&!ue.hide?hr(hr({},ee),{},ei({},he,ee[he]+ue.width)):ee},{left:E.left||0,right:E.right||0}),V=Object.keys(h).reduce(function(ee,se){var ue=h[se],he=ue.orientation;return!ue.mirror&&!ue.hide?hr(hr({},ee),{},ei({},he,Du(ee,"".concat(he))+ue.height)):ee},{top:E.top||0,bottom:E.bottom||0}),H=hr(hr({},V),I),K=H.bottom;D&&(H.bottom+=D.props.height||Xv.defaultProps.height),U&&r&&(H=kCe(H,a,n,r));var Q=w-H.left-H.right,ae=S-H.top-H.bottom;return hr(hr({brushBottom:K},H),{},{width:Math.max(Q,0),height:Math.max(ae,0)})},WDe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},sx=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,c=a===void 0?"axis":a,h=t.validateTooltipEventTypes,i=h===void 0?["axis"]:h,x=t.axisComponents,w=t.legendContent,S=t.formatAxisMap,T=t.defaultProps,E=function(H,K){var Q=K.graphicalItems,ae=K.stackGroups,ee=K.offset,se=K.updateId,ue=K.dataStartIndex,he=K.dataEndIndex,Ce=H.barSize,Ne=H.layout,me=H.barGap,be=H.barCategoryGap,pe=H.maxBarSize,Se=wW(Ne),Ee=Se.numericAxisName,we=Se.cateAxisName,Pe=qDe(Q),Me=[];return Q.forEach(function(Be,Ge){var We=Mj(H.data,{graphicalItems:[Be],dataStartIndex:ue,dataEndIndex:he}),tt=Be.type.defaultProps!==void 0?hr(hr({},Be.type.defaultProps),Be.props):Be.props,nt=tt.dataKey,Dt=tt.maxBarSize,nr=tt["".concat(Ee,"Id")],ir=tt["".concat(we,"Id")],rr={},or=x.reduce(function(Cr,vr){var Sr=K["".concat(vr.axisType,"Map")],pr=tt["".concat(vr.axisType,"Id")];Sr&&Sr[pr]||vr.axisType==="zAxis"||K0();var Mn=Sr[pr];return hr(hr({},Cr),{},ei(ei({},vr.axisType,Mn),"".concat(vr.axisType,"Ticks"),gm(Mn)))},rr),Ft=or[we],ze=or["".concat(we,"Ticks")],Pr=ae&&ae[nr]&&ae[nr].hasStack&&LCe(Be,ae[nr].stackGroups),Kt=_m(Be.type).indexOf("Bar")>=0,on=zA(Ft,ze),Rt=[],En=Pe&&TCe({barSize:Ce,stackGroups:ae,totalSize:WDe(or,we)});if(Kt){var Vn,pi,dt=Yn(Dt)?pe:Dt,Ot=(Vn=(pi=zA(Ft,ze,!0))!==null&&pi!==void 0?pi:dt)!==null&&Vn!==void 0?Vn:0;Rt=jCe({barGap:me,barCategoryGap:be,bandSize:Ot!==on?Ot:on,sizeList:En[ir],maxBarSize:dt}),Ot!==on&&(Rt=Rt.map(function(Cr){return hr(hr({},Cr),{},{position:hr(hr({},Cr.position),{},{offset:Cr.position.offset-Ot/2})})}))}var Zt=Be&&Be.type&&Be.type.getComposedData;Zt&&Me.push({props:hr(hr({},Zt(hr(hr({},or),{},{displayedData:We,props:H,dataKey:nt,item:Be,bandSize:on,barPosition:Rt,offset:ee,stackedData:Pr,layout:Ne,dataStartIndex:ue,dataEndIndex:he}))),{},ei(ei(ei({key:Be.key||"item-".concat(Ge)},Ee,or[Ee]),we,or[we]),"animationId",se)),childIndex:E2e(Be,H.children),item:Be})}),Me},D=function(H,K){var Q=H.props,ae=H.dataStartIndex,ee=H.dataEndIndex,se=H.updateId;if(!T$({props:Q}))return null;var ue=Q.children,he=Q.layout,Ce=Q.stackOffset,Ne=Q.data,me=Q.reverseStackOrder,be=wW(he),pe=be.numericAxisName,Se=be.cateAxisName,Ee=rc(ue,n),we=ICe(Ne,Ee,"".concat(pe,"Id"),"".concat(Se,"Id"),Ce,me),Pe=x.reduce(function(tt,nt){var Dt="".concat(nt.axisType,"Map");return hr(hr({},tt),{},ei({},Dt,UDe(Q,hr(hr({},nt),{},{graphicalItems:Ee,stackGroups:nt.axisType===pe&&we,dataStartIndex:ae,dataEndIndex:ee}))))},{}),Me=GDe(hr(hr({},Pe),{},{props:Q,graphicalItems:Ee}),K==null?void 0:K.legendBBox);Object.keys(Pe).forEach(function(tt){Pe[tt]=S(Q,Pe[tt],Me,tt.replace("Map",""),r)});var Be=Pe["".concat(Se,"Map")],Ge=$De(Be),We=E(Q,hr(hr({},Pe),{},{dataStartIndex:ae,dataEndIndex:ee,updateId:se,graphicalItems:Ee,stackGroups:we,offset:Me}));return hr(hr({formattedGraphicalItems:We,graphicalItems:Ee,offset:Me,stackGroups:we},Ge),Pe)},U=function(V){function H(K){var Q,ae,ee;return ADe(this,H),ee=kDe(this,H,[K]),ei(ee,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),ei(ee,"accessibilityManager",new dDe),ei(ee,"handleLegendBBoxUpdate",function(se){if(se){var ue=ee.state,he=ue.dataStartIndex,Ce=ue.dataEndIndex,Ne=ue.updateId;ee.setState(hr({legendBBox:se},D({props:ee.props,dataStartIndex:he,dataEndIndex:Ce,updateId:Ne},hr(hr({},ee.state),{},{legendBBox:se}))))}}),ei(ee,"handleReceiveSyncEvent",function(se,ue,he){if(ee.props.syncId===se){if(he===ee.eventEmitterSymbol&&typeof ee.props.syncMethod!="function")return;ee.applySyncEvent(ue)}}),ei(ee,"handleBrushChange",function(se){var ue=se.startIndex,he=se.endIndex;if(ue!==ee.state.dataStartIndex||he!==ee.state.dataEndIndex){var Ce=ee.state.updateId;ee.setState(function(){return hr({dataStartIndex:ue,dataEndIndex:he},D({props:ee.props,dataStartIndex:ue,dataEndIndex:he,updateId:Ce},ee.state))}),ee.triggerSyncEvent({dataStartIndex:ue,dataEndIndex:he})}}),ei(ee,"handleMouseEnter",function(se){var ue=ee.getMouseInfo(se);if(ue){var he=hr(hr({},ue),{},{isTooltipActive:!0});ee.setState(he),ee.triggerSyncEvent(he);var Ce=ee.props.onMouseEnter;qn(Ce)&&Ce(he,se)}}),ei(ee,"triggeredAfterMouseMove",function(se){var ue=ee.getMouseInfo(se),he=ue?hr(hr({},ue),{},{isTooltipActive:!0}):{isTooltipActive:!1};ee.setState(he),ee.triggerSyncEvent(he);var Ce=ee.props.onMouseMove;qn(Ce)&&Ce(he,se)}),ei(ee,"handleItemMouseEnter",function(se){ee.setState(function(){return{isTooltipActive:!0,activeItem:se,activePayload:se.tooltipPayload,activeCoordinate:se.tooltipPosition||{x:se.cx,y:se.cy}}})}),ei(ee,"handleItemMouseLeave",function(){ee.setState(function(){return{isTooltipActive:!1}})}),ei(ee,"handleMouseMove",function(se){se.persist(),ee.throttleTriggeredAfterMouseMove(se)}),ei(ee,"handleMouseLeave",function(se){ee.throttleTriggeredAfterMouseMove.cancel();var ue={isTooltipActive:!1};ee.setState(ue),ee.triggerSyncEvent(ue);var he=ee.props.onMouseLeave;qn(he)&&he(ue,se)}),ei(ee,"handleOuterEvent",function(se){var ue=C2e(se),he=Du(ee.props,"".concat(ue));if(ue&&qn(he)){var Ce,Ne;/.*touch.*/i.test(ue)?Ne=ee.getMouseInfo(se.changedTouches[0]):Ne=ee.getMouseInfo(se),he((Ce=Ne)!==null&&Ce!==void 0?Ce:{},se)}}),ei(ee,"handleClick",function(se){var ue=ee.getMouseInfo(se);if(ue){var he=hr(hr({},ue),{},{isTooltipActive:!0});ee.setState(he),ee.triggerSyncEvent(he);var Ce=ee.props.onClick;qn(Ce)&&Ce(he,se)}}),ei(ee,"handleMouseDown",function(se){var ue=ee.props.onMouseDown;if(qn(ue)){var he=ee.getMouseInfo(se);ue(he,se)}}),ei(ee,"handleMouseUp",function(se){var ue=ee.props.onMouseUp;if(qn(ue)){var he=ee.getMouseInfo(se);ue(he,se)}}),ei(ee,"handleTouchMove",function(se){se.changedTouches!=null&&se.changedTouches.length>0&&ee.throttleTriggeredAfterMouseMove(se.changedTouches[0])}),ei(ee,"handleTouchStart",function(se){se.changedTouches!=null&&se.changedTouches.length>0&&ee.handleMouseDown(se.changedTouches[0])}),ei(ee,"handleTouchEnd",function(se){se.changedTouches!=null&&se.changedTouches.length>0&&ee.handleMouseUp(se.changedTouches[0])}),ei(ee,"handleDoubleClick",function(se){var ue=ee.props.onDoubleClick;if(qn(ue)){var he=ee.getMouseInfo(se);ue(he,se)}}),ei(ee,"handleContextMenu",function(se){var ue=ee.props.onContextMenu;if(qn(ue)){var he=ee.getMouseInfo(se);ue(he,se)}}),ei(ee,"triggerSyncEvent",function(se){ee.props.syncId!==void 0&&DO.emit(FO,ee.props.syncId,se,ee.eventEmitterSymbol)}),ei(ee,"applySyncEvent",function(se){var ue=ee.props,he=ue.layout,Ce=ue.syncMethod,Ne=ee.state.updateId,me=se.dataStartIndex,be=se.dataEndIndex;if(se.dataStartIndex!==void 0||se.dataEndIndex!==void 0)ee.setState(hr({dataStartIndex:me,dataEndIndex:be},D({props:ee.props,dataStartIndex:me,dataEndIndex:be,updateId:Ne},ee.state)));else if(se.activeTooltipIndex!==void 0){var pe=se.chartX,Se=se.chartY,Ee=se.activeTooltipIndex,we=ee.state,Pe=we.offset,Me=we.tooltipTicks;if(!Pe)return;if(typeof Ce=="function")Ee=Ce(Me,se);else if(Ce==="value"){Ee=-1;for(var Be=0;Be<Me.length;Be++)if(Me[Be].value===se.activeLabel){Ee=Be;break}}var Ge=hr(hr({},Pe),{},{x:Pe.left,y:Pe.top}),We=Math.min(pe,Ge.x+Ge.width),tt=Math.min(Se,Ge.y+Ge.height),nt=Me[Ee]&&Me[Ee].value,Dt=S3(ee.state,ee.props.data,Ee),nr=Me[Ee]?{x:he==="horizontal"?Me[Ee].coordinate:We,y:he==="horizontal"?tt:Me[Ee].coordinate}:Zte;ee.setState(hr(hr({},se),{},{activeLabel:nt,activeCoordinate:nr,activePayload:Dt,activeTooltipIndex:Ee}))}else ee.setState(se)}),ei(ee,"renderCursor",function(se){var ue,he=ee.state,Ce=he.isTooltipActive,Ne=he.activeCoordinate,me=he.activePayload,be=he.offset,pe=he.activeTooltipIndex,Se=he.tooltipAxisBandSize,Ee=ee.getTooltipEventType(),we=(ue=se.props.active)!==null&&ue!==void 0?ue:Ce,Pe=ee.props.layout,Me=se.key||"_recharts-cursor";return Le.createElement(xDe,{key:Me,activeCoordinate:Ne,activePayload:me,activeTooltipIndex:pe,chartName:r,element:se,isActive:we,layout:Pe,offset:be,tooltipAxisBandSize:Se,tooltipEventType:Ee})}),ei(ee,"renderPolarAxis",function(se,ue,he){var Ce=Du(se,"type.axisType"),Ne=Du(ee.state,"".concat(Ce,"Map")),me=se.type.defaultProps,be=me!==void 0?hr(hr({},me),se.props):se.props,pe=Ne&&Ne[be["".concat(Ce,"Id")]];return G.cloneElement(se,hr(hr({},pe),{},{className:di(Ce,pe.className),key:se.key||"".concat(ue,"-").concat(he),ticks:gm(pe,!0)}))}),ei(ee,"renderPolarGrid",function(se){var ue=se.props,he=ue.radialLines,Ce=ue.polarAngles,Ne=ue.polarRadius,me=ee.state,be=me.radiusAxisMap,pe=me.angleAxisMap,Se=$g(be),Ee=$g(pe),we=Ee.cx,Pe=Ee.cy,Me=Ee.innerRadius,Be=Ee.outerRadius;return G.cloneElement(se,{polarAngles:Array.isArray(Ce)?Ce:gm(Ee,!0).map(function(Ge){return Ge.coordinate}),polarRadius:Array.isArray(Ne)?Ne:gm(Se,!0).map(function(Ge){return Ge.coordinate}),cx:we,cy:Pe,innerRadius:Me,outerRadius:Be,key:se.key||"polar-grid",radialLines:he})}),ei(ee,"renderLegend",function(){var se=ee.state.formattedGraphicalItems,ue=ee.props,he=ue.children,Ce=ue.width,Ne=ue.height,me=ee.props.margin||{},be=Ce-(me.left||0)-(me.right||0),pe=vee({children:he,formattedGraphicalItems:se,legendWidth:be,legendContent:w});if(!pe)return null;var Se=pe.item,Ee=xW(pe,vDe);return G.cloneElement(Se,hr(hr({},Ee),{},{chartWidth:Ce,chartHeight:Ne,margin:me,onBBoxUpdate:ee.handleLegendBBoxUpdate}))}),ei(ee,"renderTooltip",function(){var se,ue=ee.props,he=ue.children,Ce=ue.accessibilityLayer,Ne=Eu(he,zi);if(!Ne)return null;var me=ee.state,be=me.isTooltipActive,pe=me.activeCoordinate,Se=me.activePayload,Ee=me.activeLabel,we=me.offset,Pe=(se=Ne.props.active)!==null&&se!==void 0?se:be;return G.cloneElement(Ne,{viewBox:hr(hr({},we),{},{x:we.left,y:we.top}),active:Pe,label:Ee,payload:Pe?Se:[],coordinate:pe,accessibilityLayer:Ce})}),ei(ee,"renderBrush",function(se){var ue=ee.props,he=ue.margin,Ce=ue.data,Ne=ee.state,me=Ne.offset,be=Ne.dataStartIndex,pe=Ne.dataEndIndex,Se=Ne.updateId;return G.cloneElement(se,{key:se.key||"_recharts-brush",onChange:tN(ee.handleBrushChange,se.props.onChange),data:Ce,x:Dr(se.props.x)?se.props.x:me.left,y:Dr(se.props.y)?se.props.y:me.top+me.height+me.brushBottom-(he.bottom||0),width:Dr(se.props.width)?se.props.width:me.width,startIndex:be,endIndex:pe,updateId:"brush-".concat(Se)})}),ei(ee,"renderReferenceElement",function(se,ue,he){if(!se)return null;var Ce=ee,Ne=Ce.clipPathId,me=ee.state,be=me.xAxisMap,pe=me.yAxisMap,Se=me.offset,Ee=se.type.defaultProps||{},we=se.props,Pe=we.xAxisId,Me=Pe===void 0?Ee.xAxisId:Pe,Be=we.yAxisId,Ge=Be===void 0?Ee.yAxisId:Be;return G.cloneElement(se,{key:se.key||"".concat(ue,"-").concat(he),xAxis:be[Me],yAxis:pe[Ge],viewBox:{x:Se.left,y:Se.top,width:Se.width,height:Se.height},clipPathId:Ne})}),ei(ee,"renderActivePoints",function(se){var ue=se.item,he=se.activePoint,Ce=se.basePoint,Ne=se.childIndex,me=se.isRange,be=[],pe=ue.props.key,Se=ue.item.type.defaultProps!==void 0?hr(hr({},ue.item.type.defaultProps),ue.item.props):ue.item.props,Ee=Se.activeDot,we=Se.dataKey,Pe=hr(hr({index:Ne,dataKey:we,cx:he.x,cy:he.y,r:4,fill:wD(ue.item),strokeWidth:2,stroke:"#fff",payload:he.payload,value:he.value},wn(Ee,!1)),pA(Ee));return be.push(H.renderActiveDot(Ee,Pe,"".concat(pe,"-activePoint-").concat(Ne))),Ce?be.push(H.renderActiveDot(Ee,hr(hr({},Pe),{},{cx:Ce.x,cy:Ce.y}),"".concat(pe,"-basePoint-").concat(Ne))):me&&be.push(null),be}),ei(ee,"renderGraphicChild",function(se,ue,he){var Ce=ee.filterFormatItem(se,ue,he);if(!Ce)return null;var Ne=ee.getTooltipEventType(),me=ee.state,be=me.isTooltipActive,pe=me.tooltipAxis,Se=me.activeTooltipIndex,Ee=me.activeLabel,we=ee.props.children,Pe=Eu(we,zi),Me=Ce.props,Be=Me.points,Ge=Me.isRange,We=Me.baseLine,tt=Ce.item.type.defaultProps!==void 0?hr(hr({},Ce.item.type.defaultProps),Ce.item.props):Ce.item.props,nt=tt.activeDot,Dt=tt.hide,nr=tt.activeBar,ir=tt.activeShape,rr=!!(!Dt&&be&&Pe&&(nt||nr||ir)),or={};Ne!=="axis"&&Pe&&Pe.props.trigger==="click"?or={onClick:tN(ee.handleItemMouseEnter,se.props.onClick)}:Ne!=="axis"&&(or={onMouseLeave:tN(ee.handleItemMouseLeave,se.props.onMouseLeave),onMouseEnter:tN(ee.handleItemMouseEnter,se.props.onMouseEnter)});var Ft=G.cloneElement(se,hr(hr({},Ce.props),or));function ze(vr){return typeof pe.dataKey=="function"?pe.dataKey(vr.payload):null}if(rr)if(Se>=0){var Pr,Kt;if(pe.dataKey&&!pe.allowDuplicatedCategory){var on=typeof pe.dataKey=="function"?ze:"payload.".concat(pe.dataKey.toString());Pr=fA(Be,on,Ee),Kt=Ge&&We&&fA(We,on,Ee)}else Pr=Be==null?void 0:Be[Se],Kt=Ge&&We&&We[Se];if(ir||nr){var Rt=se.props.activeIndex!==void 0?se.props.activeIndex:Se;return[G.cloneElement(se,hr(hr(hr({},Ce.props),or),{},{activeIndex:Rt})),null,null]}if(!Yn(Pr))return[Ft].concat(u_(ee.renderActivePoints({item:Ce,activePoint:Pr,basePoint:Kt,childIndex:Se,isRange:Ge})))}else{var En,Vn=(En=ee.getItemByXY(ee.state.activeCoordinate))!==null&&En!==void 0?En:{graphicalItem:Ft},pi=Vn.graphicalItem,dt=pi.item,Ot=dt===void 0?se:dt,Zt=pi.childIndex,Cr=hr(hr(hr({},Ce.props),or),{},{activeIndex:Zt});return[G.cloneElement(Ot,Cr),null,null]}return Ge?[Ft,null,null]:[Ft,null]}),ei(ee,"renderCustomized",function(se,ue,he){return G.cloneElement(se,hr(hr({key:"recharts-customized-".concat(he)},ee.props),ee.state))}),ei(ee,"renderMap",{CartesianGrid:{handler:sN,once:!0},ReferenceArea:{handler:ee.renderReferenceElement},ReferenceLine:{handler:sN},ReferenceDot:{handler:ee.renderReferenceElement},XAxis:{handler:sN},YAxis:{handler:sN},Brush:{handler:ee.renderBrush,once:!0},Bar:{handler:ee.renderGraphicChild},Line:{handler:ee.renderGraphicChild},Area:{handler:ee.renderGraphicChild},Radar:{handler:ee.renderGraphicChild},RadialBar:{handler:ee.renderGraphicChild},Scatter:{handler:ee.renderGraphicChild},Pie:{handler:ee.renderGraphicChild},Funnel:{handler:ee.renderGraphicChild},Tooltip:{handler:ee.renderCursor,once:!0},PolarGrid:{handler:ee.renderPolarGrid,once:!0},PolarAngleAxis:{handler:ee.renderPolarAxis},PolarRadiusAxis:{handler:ee.renderPolarAxis},Customized:{handler:ee.renderCustomized}}),ee.clipPathId="".concat((Q=K.id)!==null&&Q!==void 0?Q:hy("recharts"),"-clip"),ee.throttleTriggeredAfterMouseMove=xQ(ee.triggeredAfterMouseMove,(ae=K.throttleDelay)!==null&&ae!==void 0?ae:1e3/60),ee.state={},ee}return EDe(H,V),jDe(H,[{key:"componentDidMount",value:function(){var Q,ae;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(Q=this.props.margin.left)!==null&&Q!==void 0?Q:0,top:(ae=this.props.margin.top)!==null&&ae!==void 0?ae:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var Q=this.props,ae=Q.children,ee=Q.data,se=Q.height,ue=Q.layout,he=Eu(ae,zi);if(he){var Ce=he.props.defaultIndex;if(!(typeof Ce!="number"||Ce<0||Ce>this.state.tooltipTicks.length-1)){var Ne=this.state.tooltipTicks[Ce]&&this.state.tooltipTicks[Ce].value,me=S3(this.state,ee,Ce,Ne),be=this.state.tooltipTicks[Ce].coordinate,pe=(this.state.offset.top+se)/2,Se=ue==="horizontal",Ee=Se?{x:be,y:pe}:{y:be,x:pe},we=this.state.formattedGraphicalItems.find(function(Me){var Be=Me.item;return Be.type.name==="Scatter"});we&&(Ee=hr(hr({},Ee),we.props.points[Ce].tooltipPosition),me=we.props.points[Ce].tooltipPayload);var Pe={activeTooltipIndex:Ce,isTooltipActive:!0,activeLabel:Ne,activePayload:me,activeCoordinate:Ee};this.setState(Pe),this.renderCursor(he),this.accessibilityManager.setIndex(Ce)}}}},{key:"getSnapshotBeforeUpdate",value:function(Q,ae){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==ae.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==Q.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==Q.margin){var ee,se;this.accessibilityManager.setDetails({offset:{left:(ee=this.props.margin.left)!==null&&ee!==void 0?ee:0,top:(se=this.props.margin.top)!==null&&se!==void 0?se:0}})}return null}},{key:"componentDidUpdate",value:function(Q){eI([Eu(Q.children,zi)],[Eu(this.props.children,zi)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var Q=Eu(this.props.children,zi);if(Q&&typeof Q.props.shared=="boolean"){var ae=Q.props.shared?"axis":"item";return i.indexOf(ae)>=0?ae:c}return c}},{key:"getMouseInfo",value:function(Q){if(!this.container)return null;var ae=this.container,ee=ae.getBoundingClientRect(),se=yTe(ee),ue={chartX:Math.round(Q.pageX-se.left),chartY:Math.round(Q.pageY-se.top)},he=ee.width/ae.offsetWidth||1,Ce=this.inRange(ue.chartX,ue.chartY,he);if(!Ce)return null;var Ne=this.state,me=Ne.xAxisMap,be=Ne.yAxisMap,pe=this.getTooltipEventType();if(pe!=="axis"&&me&&be){var Se=$g(me).scale,Ee=$g(be).scale,we=Se&&Se.invert?Se.invert(ue.chartX):null,Pe=Ee&&Ee.invert?Ee.invert(ue.chartY):null;return hr(hr({},ue),{},{xValue:we,yValue:Pe})}var Me=_W(this.state,this.props.data,this.props.layout,Ce);return Me?hr(hr({},ue),Me):null}},{key:"inRange",value:function(Q,ae){var ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,se=this.props.layout,ue=Q/ee,he=ae/ee;if(se==="horizontal"||se==="vertical"){var Ce=this.state.offset,Ne=ue>=Ce.left&&ue<=Ce.left+Ce.width&&he>=Ce.top&&he<=Ce.top+Ce.height;return Ne?{x:ue,y:he}:null}var me=this.state,be=me.angleAxisMap,pe=me.radiusAxisMap;if(be&&pe){var Se=$g(be);return fq({x:ue,y:he},Se)}return null}},{key:"parseEventsOfWrapper",value:function(){var Q=this.props.children,ae=this.getTooltipEventType(),ee=Eu(Q,zi),se={};ee&&ae==="axis"&&(ee.props.trigger==="click"?se={onClick:this.handleClick}:se={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var ue=pA(this.props,this.handleOuterEvent);return hr(hr({},ue),se)}},{key:"addListener",value:function(){DO.on(FO,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){DO.removeListener(FO,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(Q,ae,ee){for(var se=this.state.formattedGraphicalItems,ue=0,he=se.length;ue<he;ue++){var Ce=se[ue];if(Ce.item===Q||Ce.props.key===Q.key||ae===_m(Ce.item.type)&&ee===Ce.childIndex)return Ce}return null}},{key:"renderClipPath",value:function(){var Q=this.clipPathId,ae=this.state.offset,ee=ae.left,se=ae.top,ue=ae.height,he=ae.width;return Le.createElement("defs",null,Le.createElement("clipPath",{id:Q},Le.createElement("rect",{x:ee,y:se,height:ue,width:he})))}},{key:"getXScales",value:function(){var Q=this.state.xAxisMap;return Q?Object.entries(Q).reduce(function(ae,ee){var se=yW(ee,2),ue=se[0],he=se[1];return hr(hr({},ae),{},ei({},ue,he.scale))},{}):null}},{key:"getYScales",value:function(){var Q=this.state.yAxisMap;return Q?Object.entries(Q).reduce(function(ae,ee){var se=yW(ee,2),ue=se[0],he=se[1];return hr(hr({},ae),{},ei({},ue,he.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(Q){var ae;return(ae=this.state.xAxisMap)===null||ae===void 0||(ae=ae[Q])===null||ae===void 0?void 0:ae.scale}},{key:"getYScaleByAxisId",value:function(Q){var ae;return(ae=this.state.yAxisMap)===null||ae===void 0||(ae=ae[Q])===null||ae===void 0?void 0:ae.scale}},{key:"getItemByXY",value:function(Q){var ae=this.state,ee=ae.formattedGraphicalItems,se=ae.activeItem;if(ee&&ee.length)for(var ue=0,he=ee.length;ue<he;ue++){var Ce=ee[ue],Ne=Ce.props,me=Ce.item,be=me.type.defaultProps!==void 0?hr(hr({},me.type.defaultProps),me.props):me.props,pe=_m(me.type);if(pe==="Bar"){var Se=(Ne.data||[]).find(function(Me){return COe(Q,Me)});if(Se)return{graphicalItem:Ce,payload:Se}}else if(pe==="RadialBar"){var Ee=(Ne.data||[]).find(function(Me){return fq(Q,Me)});if(Ee)return{graphicalItem:Ce,payload:Ee}}else if(Aj(Ce,se)||Tj(Ce,se)||Cw(Ce,se)){var we=eIe({graphicalItem:Ce,activeTooltipItem:se,itemData:be.data}),Pe=be.activeIndex===void 0?we:be.activeIndex;return{graphicalItem:hr(hr({},Ce),{},{childIndex:Pe}),payload:Cw(Ce,se)?be.data[we]:Ce.props.data[we]}}}return null}},{key:"render",value:function(){var Q=this;if(!T$(this))return null;var ae=this.props,ee=ae.children,se=ae.className,ue=ae.width,he=ae.height,Ce=ae.style,Ne=ae.compact,me=ae.title,be=ae.desc,pe=xW(ae,_De),Se=wn(pe,!1);if(Ne)return Le.createElement(KG,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Le.createElement(rI,xv({},Se,{width:ue,height:he,title:me,desc:be}),this.renderClipPath(),k$(ee,this.renderMap)));if(this.props.accessibilityLayer){var Ee,we;Se.tabIndex=(Ee=this.props.tabIndex)!==null&&Ee!==void 0?Ee:0,Se.role=(we=this.props.role)!==null&&we!==void 0?we:"application",Se.onKeyDown=function(Me){Q.accessibilityManager.keyboardEvent(Me)},Se.onFocus=function(){Q.accessibilityManager.focus()}}var Pe=this.parseEventsOfWrapper();return Le.createElement(KG,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Le.createElement("div",xv({className:di("recharts-wrapper",se),style:hr({position:"relative",cursor:"default",width:ue,height:he},Ce)},Pe,{ref:function(Be){Q.container=Be}}),Le.createElement(rI,xv({},Se,{width:ue,height:he,title:me,desc:be,style:DDe}),this.renderClipPath(),k$(ee,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(G.Component);ei(U,"displayName",r),ei(U,"defaultProps",hr({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},T)),ei(U,"getDerivedStateFromProps",function(V,H){var K=V.dataKey,Q=V.data,ae=V.children,ee=V.width,se=V.height,ue=V.layout,he=V.stackOffset,Ce=V.margin,Ne=H.dataStartIndex,me=H.dataEndIndex;if(H.updateId===void 0){var be=bW(V);return hr(hr(hr({},be),{},{updateId:0},D(hr(hr({props:V},be),{},{updateId:0}),H)),{},{prevDataKey:K,prevData:Q,prevWidth:ee,prevHeight:se,prevLayout:ue,prevStackOffset:he,prevMargin:Ce,prevChildren:ae})}if(K!==H.prevDataKey||Q!==H.prevData||ee!==H.prevWidth||se!==H.prevHeight||ue!==H.prevLayout||he!==H.prevStackOffset||!Sv(Ce,H.prevMargin)){var pe=bW(V),Se={chartX:H.chartX,chartY:H.chartY,isTooltipActive:H.isTooltipActive},Ee=hr(hr({},_W(H,Q,ue)),{},{updateId:H.updateId+1}),we=hr(hr(hr({},pe),Se),Ee);return hr(hr(hr({},we),D(hr({props:V},we),H)),{},{prevDataKey:K,prevData:Q,prevWidth:ee,prevHeight:se,prevLayout:ue,prevStackOffset:he,prevMargin:Ce,prevChildren:ae})}if(!eI(ae,H.prevChildren)){var Pe,Me,Be,Ge,We=Eu(ae,Xv),tt=We&&(Pe=(Me=We.props)===null||Me===void 0?void 0:Me.startIndex)!==null&&Pe!==void 0?Pe:Ne,nt=We&&(Be=(Ge=We.props)===null||Ge===void 0?void 0:Ge.endIndex)!==null&&Be!==void 0?Be:me,Dt=tt!==Ne||nt!==me,nr=!Yn(Q),ir=nr&&!Dt?H.updateId:H.updateId+1;return hr(hr({updateId:ir},D(hr(hr({props:V},H),{},{updateId:ir,dataStartIndex:tt,dataEndIndex:nt}),H)),{},{prevChildren:ae,dataStartIndex:tt,dataEndIndex:nt})}return null}),ei(U,"renderActiveDot",function(V,H,K){var Q;return G.isValidElement(V)?Q=G.cloneElement(V,H):qn(V)?Q=V(H):Q=Le.createElement(w2,H),Le.createElement(fi,{className:"recharts-active-dot",key:K},Q)});var I=G.forwardRef(function(H,K){return Le.createElement(U,xv({},H,{ref:K}))});return I.displayName=U.displayName,I},Fw=sx({chartName:"LineChart",GraphicalChild:Ud,axisComponents:[{axisType:"xAxis",AxisComp:ga},{axisType:"yAxis",AxisComp:ya}],formatAxisMap:T2}),Xc=sx({chartName:"BarChart",GraphicalChild:rs,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:ga},{axisType:"yAxis",AxisComp:ya}],formatAxisMap:T2}),Xte=sx({chartName:"PieChart",GraphicalChild:vp,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:N2},{axisType:"radiusAxis",AxisComp:S2}],formatAxisMap:Oee,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),HDe=sx({chartName:"ScatterChart",GraphicalChild:F_,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:ga},{axisType:"yAxis",AxisComp:ya},{axisType:"zAxis",AxisComp:j2}],formatAxisMap:T2}),KDe=sx({chartName:"AreaChart",GraphicalChild:Sc,axisComponents:[{axisType:"xAxis",AxisComp:ga},{axisType:"yAxis",AxisComp:ya}],formatAxisMap:T2}),ZDe=sx({chartName:"RadialBarChart",GraphicalChild:A2,legendContent:"children",defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"angleAxis",AxisComp:N2},{axisType:"radiusAxis",AxisComp:S2}],formatAxisMap:Oee,defaultProps:{layout:"radial",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),RD=sx({chartName:"ComposedChart",GraphicalChild:[Ud,Sc,rs,F_],axisComponents:[{axisType:"xAxis",AxisComp:ga},{axisType:"yAxis",AxisComp:ya},{axisType:"zAxis",AxisComp:j2}],formatAxisMap:T2});function SW(e,[t,r]){return Math.min(r,Math.max(t,e))}function YDe(e){const t=G.useRef({value:e,previous:e});return G.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var XDe="VisuallyHidden",ID=G.forwardRef((e,t)=>o.jsx(gi.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));ID.displayName=XDe;var JDe=ID,QDe=[" ","Enter","ArrowUp","ArrowDown"],e5e=[" ","Enter"],k2="Select",[Oj,Rj,t5e]=d4(k2),[z_,t8e]=qd(k2,[t5e,cy]),Ij=cy(),[r5e,gy]=z_(k2),[n5e,i5e]=z_(k2),Jte=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:c,value:h,defaultValue:i,onValueChange:x,dir:w,name:S,autoComplete:T,disabled:E,required:D,form:U}=e,I=Ij(t),[V,H]=G.useState(null),[K,Q]=G.useState(null),[ae,ee]=G.useState(!1),se=h4(w),[ue=!1,he]=Jg({prop:n,defaultProp:a,onChange:c}),[Ce,Ne]=Jg({prop:h,defaultProp:i,onChange:x}),me=G.useRef(null),be=V?U||!!V.closest("form"):!0,[pe,Se]=G.useState(new Set),Ee=Array.from(pe).map(we=>we.props.value).join(";");return o.jsx(ET,{...I,children:o.jsxs(r5e,{required:D,scope:t,trigger:V,onTriggerChange:H,valueNode:K,onValueNodeChange:Q,valueNodeHasChildren:ae,onValueNodeHasChildrenChange:ee,contentId:Ld(),value:Ce,onValueChange:Ne,open:ue,onOpenChange:he,dir:se,triggerPointerDownPosRef:me,disabled:E,children:[o.jsx(Oj.Provider,{scope:t,children:o.jsx(n5e,{scope:e.__scopeSelect,onNativeOptionAdd:G.useCallback(we=>{Se(Pe=>new Set(Pe).add(we))},[]),onNativeOptionRemove:G.useCallback(we=>{Se(Pe=>{const Me=new Set(Pe);return Me.delete(we),Me})},[]),children:r})}),be?o.jsxs(Nre,{"aria-hidden":!0,required:D,tabIndex:-1,name:S,autoComplete:T,value:Ce,onChange:we=>Ne(we.target.value),disabled:E,form:U,children:[Ce===void 0?o.jsx("option",{value:""}):null,Array.from(pe)]},Ee):null]})})};Jte.displayName=k2;var Qte="SelectTrigger",ere=G.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=e,c=Ij(r),h=gy(Qte,r),i=h.disabled||n,x=ta(t,h.onTriggerChange),w=Rj(r),S=G.useRef("touch"),[T,E,D]=Are(I=>{const V=w().filter(Q=>!Q.disabled),H=V.find(Q=>Q.value===h.value),K=Tre(V,I,H);K!==void 0&&h.onValueChange(K.value)}),U=I=>{i||(h.onOpenChange(!0),D()),I&&(h.triggerPointerDownPosRef.current={x:Math.round(I.pageX),y:Math.round(I.pageY)})};return o.jsx(Xw,{asChild:!0,...c,children:o.jsx(gi.button,{type:"button",role:"combobox","aria-controls":h.contentId,"aria-expanded":h.open,"aria-required":h.required,"aria-autocomplete":"none",dir:h.dir,"data-state":h.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":Sre(h.value)?"":void 0,...a,ref:x,onClick:dn(a.onClick,I=>{I.currentTarget.focus(),S.current!=="mouse"&&U(I)}),onPointerDown:dn(a.onPointerDown,I=>{S.current=I.pointerType;const V=I.target;V.hasPointerCapture(I.pointerId)&&V.releasePointerCapture(I.pointerId),I.button===0&&I.ctrlKey===!1&&I.pointerType==="mouse"&&(U(I),I.preventDefault())}),onKeyDown:dn(a.onKeyDown,I=>{const V=T.current!=="";!(I.ctrlKey||I.altKey||I.metaKey)&&I.key.length===1&&E(I.key),!(V&&I.key===" ")&&QDe.includes(I.key)&&(U(),I.preventDefault())})})})});ere.displayName=Qte;var tre="SelectValue",rre=G.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,children:c,placeholder:h="",...i}=e,x=gy(tre,r),{onValueNodeHasChildrenChange:w}=x,S=c!==void 0,T=ta(t,x.onValueNodeChange);return pl(()=>{w(S)},[w,S]),o.jsx(gi.span,{...i,ref:T,style:{pointerEvents:"none"},children:Sre(x.value)?o.jsx(o.Fragment,{children:h}):c})});rre.displayName=tre;var a5e="SelectIcon",nre=G.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...a}=e;return o.jsx(gi.span,{"aria-hidden":!0,...a,ref:t,children:n||""})});nre.displayName=a5e;var s5e="SelectPortal",ire=e=>o.jsx(S_,{asChild:!0,...e});ire.displayName=s5e;var Y0="SelectContent",are=G.forwardRef((e,t)=>{const r=gy(Y0,e.__scopeSelect),[n,a]=G.useState();if(pl(()=>{a(new DocumentFragment)},[]),!r.open){const c=n;return c?$w.createPortal(o.jsx(sre,{scope:e.__scopeSelect,children:o.jsx(Oj.Slot,{scope:e.__scopeSelect,children:o.jsx("div",{children:e.children})})}),c):null}return o.jsx(ore,{...e,ref:t})});are.displayName=Y0;var Dh=10,[sre,yy]=z_(Y0),o5e="SelectContentImpl",ore=G.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:c,onPointerDownOutside:h,side:i,sideOffset:x,align:w,alignOffset:S,arrowPadding:T,collisionBoundary:E,collisionPadding:D,sticky:U,hideWhenDetached:I,avoidCollisions:V,...H}=e,K=gy(Y0,r),[Q,ae]=G.useState(null),[ee,se]=G.useState(null),ue=ta(t,rr=>ae(rr)),[he,Ce]=G.useState(null),[Ne,me]=G.useState(null),be=Rj(r),[pe,Se]=G.useState(!1),Ee=G.useRef(!1);G.useEffect(()=>{if(Q)return IT(Q)},[Q]),jT();const we=G.useCallback(rr=>{const[or,...Ft]=be().map(Kt=>Kt.ref.current),[ze]=Ft.slice(-1),Pr=document.activeElement;for(const Kt of rr)if(Kt===Pr||(Kt==null||Kt.scrollIntoView({block:"nearest"}),Kt===or&&ee&&(ee.scrollTop=0),Kt===ze&&ee&&(ee.scrollTop=ee.scrollHeight),Kt==null||Kt.focus(),document.activeElement!==Pr))return},[be,ee]),Pe=G.useCallback(()=>we([he,Q]),[we,he,Q]);G.useEffect(()=>{pe&&Pe()},[pe,Pe]);const{onOpenChange:Me,triggerPointerDownPosRef:Be}=K;G.useEffect(()=>{if(Q){let rr={x:0,y:0};const or=ze=>{var Pr,Kt;rr={x:Math.abs(Math.round(ze.pageX)-(((Pr=Be.current)==null?void 0:Pr.x)??0)),y:Math.abs(Math.round(ze.pageY)-(((Kt=Be.current)==null?void 0:Kt.y)??0))}},Ft=ze=>{rr.x<=10&&rr.y<=10?ze.preventDefault():Q.contains(ze.target)||Me(!1),document.removeEventListener("pointermove",or),Be.current=null};return Be.current!==null&&(document.addEventListener("pointermove",or),document.addEventListener("pointerup",Ft,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",or),document.removeEventListener("pointerup",Ft,{capture:!0})}}},[Q,Me,Be]),G.useEffect(()=>{const rr=()=>Me(!1);return window.addEventListener("blur",rr),window.addEventListener("resize",rr),()=>{window.removeEventListener("blur",rr),window.removeEventListener("resize",rr)}},[Me]);const[Ge,We]=Are(rr=>{const or=be().filter(Pr=>!Pr.disabled),Ft=or.find(Pr=>Pr.ref.current===document.activeElement),ze=Tre(or,rr,Ft);ze&&setTimeout(()=>ze.ref.current.focus())}),tt=G.useCallback((rr,or,Ft)=>{const ze=!Ee.current&&!Ft;(K.value!==void 0&&K.value===or||ze)&&(Ce(rr),ze&&(Ee.current=!0))},[K.value]),nt=G.useCallback(()=>Q==null?void 0:Q.focus(),[Q]),Dt=G.useCallback((rr,or,Ft)=>{const ze=!Ee.current&&!Ft;(K.value!==void 0&&K.value===or||ze)&&me(rr)},[K.value]),nr=n==="popper"?N3:lre,ir=nr===N3?{side:i,sideOffset:x,align:w,alignOffset:S,arrowPadding:T,collisionBoundary:E,collisionPadding:D,sticky:U,hideWhenDetached:I,avoidCollisions:V}:{};return o.jsx(sre,{scope:r,content:Q,viewport:ee,onViewportChange:se,itemRefCallback:tt,selectedItem:he,onItemLeave:nt,itemTextRefCallback:Dt,focusSelectedItem:Pe,selectedItemText:Ne,position:n,isPositioned:pe,searchRef:Ge,children:o.jsx(Jw,{as:nc,allowPinchZoom:!0,children:o.jsx(Zw,{asChild:!0,trapped:K.open,onMountAutoFocus:rr=>{rr.preventDefault()},onUnmountAutoFocus:dn(a,rr=>{var or;(or=K.trigger)==null||or.focus({preventScroll:!0}),rr.preventDefault()}),children:o.jsx(__,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:c,onPointerDownOutside:h,onFocusOutside:rr=>rr.preventDefault(),onDismiss:()=>K.onOpenChange(!1),children:o.jsx(nr,{role:"listbox",id:K.contentId,"data-state":K.open?"open":"closed",dir:K.dir,onContextMenu:rr=>rr.preventDefault(),...H,...ir,onPlaced:()=>Se(!0),ref:ue,style:{display:"flex",flexDirection:"column",outline:"none",...H.style},onKeyDown:dn(H.onKeyDown,rr=>{const or=rr.ctrlKey||rr.altKey||rr.metaKey;if(rr.key==="Tab"&&rr.preventDefault(),!or&&rr.key.length===1&&We(rr.key),["ArrowUp","ArrowDown","Home","End"].includes(rr.key)){let ze=be().filter(Pr=>!Pr.disabled).map(Pr=>Pr.ref.current);if(["ArrowUp","End"].includes(rr.key)&&(ze=ze.slice().reverse()),["ArrowUp","ArrowDown"].includes(rr.key)){const Pr=rr.target,Kt=ze.indexOf(Pr);ze=ze.slice(Kt+1)}setTimeout(()=>we(ze)),rr.preventDefault()}})})})})})})});ore.displayName=o5e;var l5e="SelectItemAlignedPosition",lre=G.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=e,c=gy(Y0,r),h=yy(Y0,r),[i,x]=G.useState(null),[w,S]=G.useState(null),T=ta(t,ue=>S(ue)),E=Rj(r),D=G.useRef(!1),U=G.useRef(!0),{viewport:I,selectedItem:V,selectedItemText:H,focusSelectedItem:K}=h,Q=G.useCallback(()=>{if(c.trigger&&c.valueNode&&i&&w&&I&&V&&H){const ue=c.trigger.getBoundingClientRect(),he=w.getBoundingClientRect(),Ce=c.valueNode.getBoundingClientRect(),Ne=H.getBoundingClientRect();if(c.dir!=="rtl"){const Pr=Ne.left-he.left,Kt=Ce.left-Pr,on=ue.left-Kt,Rt=ue.width+on,En=Math.max(Rt,he.width),Vn=window.innerWidth-Dh,pi=SW(Kt,[Dh,Math.max(Dh,Vn-En)]);i.style.minWidth=Rt+"px",i.style.left=pi+"px"}else{const Pr=he.right-Ne.right,Kt=window.innerWidth-Ce.right-Pr,on=window.innerWidth-ue.right-Kt,Rt=ue.width+on,En=Math.max(Rt,he.width),Vn=window.innerWidth-Dh,pi=SW(Kt,[Dh,Math.max(Dh,Vn-En)]);i.style.minWidth=Rt+"px",i.style.right=pi+"px"}const me=E(),be=window.innerHeight-Dh*2,pe=I.scrollHeight,Se=window.getComputedStyle(w),Ee=parseInt(Se.borderTopWidth,10),we=parseInt(Se.paddingTop,10),Pe=parseInt(Se.borderBottomWidth,10),Me=parseInt(Se.paddingBottom,10),Be=Ee+we+pe+Me+Pe,Ge=Math.min(V.offsetHeight*5,Be),We=window.getComputedStyle(I),tt=parseInt(We.paddingTop,10),nt=parseInt(We.paddingBottom,10),Dt=ue.top+ue.height/2-Dh,nr=be-Dt,ir=V.offsetHeight/2,rr=V.offsetTop+ir,or=Ee+we+rr,Ft=Be-or;if(or<=Dt){const Pr=me.length>0&&V===me[me.length-1].ref.current;i.style.bottom="0px";const Kt=w.clientHeight-I.offsetTop-I.offsetHeight,on=Math.max(nr,ir+(Pr?nt:0)+Kt+Pe),Rt=or+on;i.style.height=Rt+"px"}else{const Pr=me.length>0&&V===me[0].ref.current;i.style.top="0px";const on=Math.max(Dt,Ee+I.offsetTop+(Pr?tt:0)+ir)+Ft;i.style.height=on+"px",I.scrollTop=or-Dt+I.offsetTop}i.style.margin=`${Dh}px 0`,i.style.minHeight=Ge+"px",i.style.maxHeight=be+"px",n==null||n(),requestAnimationFrame(()=>D.current=!0)}},[E,c.trigger,c.valueNode,i,w,I,V,H,c.dir,n]);pl(()=>Q(),[Q]);const[ae,ee]=G.useState();pl(()=>{w&&ee(window.getComputedStyle(w).zIndex)},[w]);const se=G.useCallback(ue=>{ue&&U.current===!0&&(Q(),K==null||K(),U.current=!1)},[Q,K]);return o.jsx(u5e,{scope:r,contentWrapper:i,shouldExpandOnScrollRef:D,onScrollButtonChange:se,children:o.jsx("div",{ref:x,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:ae},children:o.jsx(gi.div,{...a,ref:T,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});lre.displayName=l5e;var c5e="SelectPopperPosition",N3=G.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=Dh,...c}=e,h=Ij(r);return o.jsx(MT,{...h,...c,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...c.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});N3.displayName=c5e;var[u5e,LD]=z_(Y0,{}),A3="SelectViewport",cre=G.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...a}=e,c=yy(A3,r),h=LD(A3,r),i=ta(t,c.onViewportChange),x=G.useRef(0);return o.jsxs(o.Fragment,{children:[o.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),o.jsx(Oj.Slot,{scope:r,children:o.jsx(gi.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:dn(a.onScroll,w=>{const S=w.currentTarget,{contentWrapper:T,shouldExpandOnScrollRef:E}=h;if(E!=null&&E.current&&T){const D=Math.abs(x.current-S.scrollTop);if(D>0){const U=window.innerHeight-Dh*2,I=parseFloat(T.style.minHeight),V=parseFloat(T.style.height),H=Math.max(I,V);if(H<U){const K=H+D,Q=Math.min(U,K),ae=K-Q;T.style.height=Q+"px",T.style.bottom==="0px"&&(S.scrollTop=ae>0?ae:0,T.style.justifyContent="flex-end")}}}x.current=S.scrollTop})})})]})});cre.displayName=A3;var ure="SelectGroup",[d5e,h5e]=z_(ure),dre=G.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=Ld();return o.jsx(d5e,{scope:r,id:a,children:o.jsx(gi.div,{role:"group","aria-labelledby":a,...n,ref:t})})});dre.displayName=ure;var hre="SelectLabel",fre=G.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=h5e(hre,r);return o.jsx(gi.div,{id:a.id,...n,ref:t})});fre.displayName=hre;var gT="SelectItem",[f5e,pre]=z_(gT),mre=G.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:c,...h}=e,i=gy(gT,r),x=yy(gT,r),w=i.value===n,[S,T]=G.useState(c??""),[E,D]=G.useState(!1),U=ta(t,K=>{var Q;return(Q=x.itemRefCallback)==null?void 0:Q.call(x,K,n,a)}),I=Ld(),V=G.useRef("touch"),H=()=>{a||(i.onValueChange(n),i.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return o.jsx(f5e,{scope:r,value:n,disabled:a,textId:I,isSelected:w,onItemTextChange:G.useCallback(K=>{T(Q=>Q||((K==null?void 0:K.textContent)??"").trim())},[]),children:o.jsx(Oj.ItemSlot,{scope:r,value:n,disabled:a,textValue:S,children:o.jsx(gi.div,{role:"option","aria-labelledby":I,"data-highlighted":E?"":void 0,"aria-selected":w&&E,"data-state":w?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...h,ref:U,onFocus:dn(h.onFocus,()=>D(!0)),onBlur:dn(h.onBlur,()=>D(!1)),onClick:dn(h.onClick,()=>{V.current!=="mouse"&&H()}),onPointerUp:dn(h.onPointerUp,()=>{V.current==="mouse"&&H()}),onPointerDown:dn(h.onPointerDown,K=>{V.current=K.pointerType}),onPointerMove:dn(h.onPointerMove,K=>{var Q;V.current=K.pointerType,a?(Q=x.onItemLeave)==null||Q.call(x):V.current==="mouse"&&K.currentTarget.focus({preventScroll:!0})}),onPointerLeave:dn(h.onPointerLeave,K=>{var Q;K.currentTarget===document.activeElement&&((Q=x.onItemLeave)==null||Q.call(x))}),onKeyDown:dn(h.onKeyDown,K=>{var ae;((ae=x.searchRef)==null?void 0:ae.current)!==""&&K.key===" "||(e5e.includes(K.key)&&H(),K.key===" "&&K.preventDefault())})})})})});mre.displayName=gT;var l1="SelectItemText",gre=G.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,...c}=e,h=gy(l1,r),i=yy(l1,r),x=pre(l1,r),w=i5e(l1,r),[S,T]=G.useState(null),E=ta(t,H=>T(H),x.onItemTextChange,H=>{var K;return(K=i.itemTextRefCallback)==null?void 0:K.call(i,H,x.value,x.disabled)}),D=S==null?void 0:S.textContent,U=G.useMemo(()=>o.jsx("option",{value:x.value,disabled:x.disabled,children:D},x.value),[x.disabled,x.value,D]),{onNativeOptionAdd:I,onNativeOptionRemove:V}=w;return pl(()=>(I(U),()=>V(U)),[I,V,U]),o.jsxs(o.Fragment,{children:[o.jsx(gi.span,{id:x.textId,...c,ref:E}),x.isSelected&&h.valueNode&&!h.valueNodeHasChildren?$w.createPortal(c.children,h.valueNode):null]})});gre.displayName=l1;var yre="SelectItemIndicator",xre=G.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return pre(yre,r).isSelected?o.jsx(gi.span,{"aria-hidden":!0,...n,ref:t}):null});xre.displayName=yre;var T3="SelectScrollUpButton",vre=G.forwardRef((e,t)=>{const r=yy(T3,e.__scopeSelect),n=LD(T3,e.__scopeSelect),[a,c]=G.useState(!1),h=ta(t,n.onScrollButtonChange);return pl(()=>{if(r.viewport&&r.isPositioned){let i=function(){const w=x.scrollTop>0;c(w)};const x=r.viewport;return i(),x.addEventListener("scroll",i),()=>x.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),a?o.jsx(bre,{...e,ref:h,onAutoScroll:()=>{const{viewport:i,selectedItem:x}=r;i&&x&&(i.scrollTop=i.scrollTop-x.offsetHeight)}}):null});vre.displayName=T3;var j3="SelectScrollDownButton",_re=G.forwardRef((e,t)=>{const r=yy(j3,e.__scopeSelect),n=LD(j3,e.__scopeSelect),[a,c]=G.useState(!1),h=ta(t,n.onScrollButtonChange);return pl(()=>{if(r.viewport&&r.isPositioned){let i=function(){const w=x.scrollHeight-x.clientHeight,S=Math.ceil(x.scrollTop)<w;c(S)};const x=r.viewport;return i(),x.addEventListener("scroll",i),()=>x.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),a?o.jsx(bre,{...e,ref:h,onAutoScroll:()=>{const{viewport:i,selectedItem:x}=r;i&&x&&(i.scrollTop=i.scrollTop+x.offsetHeight)}}):null});_re.displayName=j3;var bre=G.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=e,c=yy("SelectScrollButton",r),h=G.useRef(null),i=Rj(r),x=G.useCallback(()=>{h.current!==null&&(window.clearInterval(h.current),h.current=null)},[]);return G.useEffect(()=>()=>x(),[x]),pl(()=>{var S;const w=i().find(T=>T.ref.current===document.activeElement);(S=w==null?void 0:w.ref.current)==null||S.scrollIntoView({block:"nearest"})},[i]),o.jsx(gi.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:dn(a.onPointerDown,()=>{h.current===null&&(h.current=window.setInterval(n,50))}),onPointerMove:dn(a.onPointerMove,()=>{var w;(w=c.onItemLeave)==null||w.call(c),h.current===null&&(h.current=window.setInterval(n,50))}),onPointerLeave:dn(a.onPointerLeave,()=>{x()})})}),p5e="SelectSeparator",wre=G.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return o.jsx(gi.div,{"aria-hidden":!0,...n,ref:t})});wre.displayName=p5e;var k3="SelectArrow",m5e=G.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=Ij(r),c=gy(k3,r),h=yy(k3,r);return c.open&&h.position==="popper"?o.jsx(OT,{...a,...n,ref:t}):null});m5e.displayName=k3;function Sre(e){return e===""||e===void 0}var Nre=G.forwardRef((e,t)=>{const{value:r,...n}=e,a=G.useRef(null),c=ta(t,a),h=YDe(r);return G.useEffect(()=>{const i=a.current,x=window.HTMLSelectElement.prototype,S=Object.getOwnPropertyDescriptor(x,"value").set;if(h!==r&&S){const T=new Event("change",{bubbles:!0});S.call(i,r),i.dispatchEvent(T)}},[h,r]),o.jsx(ID,{asChild:!0,children:o.jsx("select",{...n,ref:c,defaultValue:r})})});Nre.displayName="BubbleSelect";function Are(e){const t=zu(e),r=G.useRef(""),n=G.useRef(0),a=G.useCallback(h=>{const i=r.current+h;t(i),function x(w){r.current=w,window.clearTimeout(n.current),w!==""&&(n.current=window.setTimeout(()=>x(""),1e3))}(i)},[t]),c=G.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return G.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,c]}function Tre(e,t,r){const a=t.length>1&&Array.from(t).every(w=>w===t[0])?t[0]:t,c=r?e.indexOf(r):-1;let h=g5e(e,Math.max(c,0));a.length===1&&(h=h.filter(w=>w!==r));const x=h.find(w=>w.textValue.toLowerCase().startsWith(a.toLowerCase()));return x!==r?x:void 0}function g5e(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var y5e=Jte,jre=ere,x5e=rre,v5e=nre,_5e=ire,kre=are,b5e=cre,w5e=dre,Pre=fre,Cre=mre,S5e=gre,N5e=xre,Ere=vre,Mre=_re,Ore=wre;const Js=y5e,P3=w5e,yo=x5e,Vs=G.forwardRef(({className:e,children:t,...r},n)=>o.jsxs(jre,{ref:n,className:zt("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,o.jsx(v5e,{asChild:!0,children:o.jsx(wH,{className:"h-4 w-4 opacity-50"})})]}));Vs.displayName=jre.displayName;const Rre=G.forwardRef(({className:e,...t},r)=>o.jsx(Ere,{ref:r,className:zt("flex cursor-default items-center justify-center py-1",e),...t,children:o.jsx(Hue,{className:"h-4 w-4"})}));Rre.displayName=Ere.displayName;const Ire=G.forwardRef(({className:e,...t},r)=>o.jsx(Mre,{ref:r,className:zt("flex cursor-default items-center justify-center py-1",e),...t,children:o.jsx(wH,{className:"h-4 w-4"})}));Ire.displayName=Mre.displayName;const Us=G.forwardRef(({className:e,children:t,position:r="popper",...n},a)=>o.jsx(_5e,{children:o.jsxs(kre,{ref:a,className:zt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[o.jsx(Rre,{}),o.jsx(b5e,{className:zt("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),o.jsx(Ire,{})]})}));Us.displayName=kre.displayName;const C3=G.forwardRef(({className:e,...t},r)=>o.jsx(Pre,{ref:r,className:zt("px-2 py-1.5 text-sm font-semibold",e),...t}));C3.displayName=Pre.displayName;const An=G.forwardRef(({className:e,children:t,...r},n)=>o.jsxs(Cre,{ref:n,className:zt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[o.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(N5e,{children:o.jsx(a4,{className:"h-4 w-4"})})}),o.jsx(S5e,{children:t})]}));An.displayName=Cre.displayName;const A5e=G.forwardRef(({className:e,...t},r)=>o.jsx(Ore,{ref:r,className:zt("-mx-1 my-1 h-px bg-muted",e),...t}));A5e.displayName=Ore.displayName;const Ri=G.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:zt("rounded-xl md:border bg-card text-card-foreground md:shadow",e),...t}));Ri.displayName="Card";const Ki=G.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:zt("flex flex-col space-y-1.5 p-6",e),...t}));Ki.displayName="CardHeader";const Zi=G.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:zt("font-semibold leading-none tracking-tight",e),...t}));Zi.displayName="CardTitle";const As=G.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:zt("text-sm text-muted-foreground",e),...t}));As.displayName="CardDescription";const Fi=G.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:zt("p-6 pt-0",e),...t}));Fi.displayName="CardContent";const Lre=G.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:zt("flex items-center p-6 pt-0",e),...t}));Lre.displayName="CardFooter";const T5e={light:"",dark:".dark"},Dre=G.createContext(null);function Fre(){const e=G.useContext(Dre);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const zre=G.forwardRef(({id:e,className:t,children:r,config:n,...a},c)=>{const h=G.useId(),i=`chart-${e||h.replace(/:/g,"")}`;return o.jsx(Dre.Provider,{value:{config:n},children:o.jsxs("div",{"data-chart":i,ref:c,className:zt("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",t),...a,children:[o.jsx(j5e,{id:i,config:n}),o.jsx(uo,{children:r})]})})});zre.displayName="Chart";const j5e=({id:e,config:t})=>{const r=Object.entries(t).filter(([,n])=>n.theme||n.color);return r.length?o.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(T5e).map(([n,a])=>`
${a} [data-chart=${e}] {
${r.map(([c,h])=>{var x;const i=((x=h.theme)==null?void 0:x[n])||h.color;return i?`  --color-${c}: ${i};`:null}).join(`
`)}
}
`).join(`
`)}}):null},k5e=zi,Bre=G.forwardRef(({active:e,payload:t,className:r,indicator:n="dot",hideLabel:a=!1,hideIndicator:c=!1,label:h,labelFormatter:i,labelClassName:x,formatter:w,color:S,nameKey:T,labelKey:E},D)=>{const{config:U}=Fre(),I=G.useMemo(()=>{var ee;if(a||!(t!=null&&t.length))return null;const[H]=t,K=`${E||(H==null?void 0:H.dataKey)||(H==null?void 0:H.name)||"value"}`,Q=E3(U,H,K),ae=!E&&typeof h=="string"?((ee=U[h])==null?void 0:ee.label)||h:Q==null?void 0:Q.label;return i?o.jsx("div",{className:zt("font-medium",x),children:i(ae,t)}):ae?o.jsx("div",{className:zt("font-medium",x),children:ae}):null},[h,i,t,a,x,U,E]);if(!e||!(t!=null&&t.length))return null;const V=t.length===1&&n!=="dot";return o.jsxs("div",{ref:D,className:zt("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",r),children:[V?null:I,o.jsx("div",{className:"grid gap-1.5",children:t.map((H,K)=>{const Q=`${T||H.name||H.dataKey||"value"}`,ae=E3(U,H,Q),ee=S||H.payload.fill||H.color;return o.jsx("div",{className:zt("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",n==="dot"&&"items-center"),children:w&&(H==null?void 0:H.value)!==void 0&&H.name?w(H.value,H.name,H,K,H.payload):o.jsxs(o.Fragment,{children:[ae!=null&&ae.icon?o.jsx(ae.icon,{}):!c&&o.jsx("div",{className:zt("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":n==="dot","w-1":n==="line","w-0 border-[1.5px] border-dashed bg-transparent":n==="dashed","my-0.5":V&&n==="dashed"}),style:{"--color-bg":ee,"--color-border":ee}}),o.jsxs("div",{className:zt("flex flex-1 justify-between leading-none",V?"items-end":"items-center"),children:[o.jsxs("div",{className:"grid gap-1.5",children:[V?I:null,o.jsx("span",{className:"text-muted-foreground",children:(ae==null?void 0:ae.label)||H.name})]}),H.value&&o.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:H.value.toLocaleString()})]})]})},H.dataKey)})})]})});Bre.displayName="ChartTooltip";const P5e=G.forwardRef(({className:e,hideIcon:t=!1,payload:r,verticalAlign:n="bottom",nameKey:a},c)=>{const{config:h}=Fre();return r!=null&&r.length?o.jsx("div",{ref:c,className:zt("flex items-center justify-center gap-4",n==="top"?"pb-3":"pt-3",e),children:r.map(i=>{const x=`${a||i.dataKey||"value"}`,w=E3(h,i,x);return o.jsxs("div",{className:zt("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[w!=null&&w.icon&&!t?o.jsx(w.icon,{}):o.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:i.color}}),w==null?void 0:w.label]},i.value)})}):null});P5e.displayName="ChartLegend";function E3(e,t,r){if(typeof t!="object"||t===null)return;const n="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=r;return r in t&&typeof t[r]=="string"?a=t[r]:n&&r in n&&typeof n[r]=="string"&&(a=n[r]),a in e?e[a]:e[r]}const NW={views:{label:"Page Views"},violations:{label:"Violations",color:"hsl(var(--chart-1))"},accidents:{label:"Accidents",color:"hsl(var(--chart-2))"}};function C5e(){const[e,t]=G.useState("violations"),[r,n]=G.useState("all"),[a,c]=G.useState([]),[h,i]=G.useState(!0),[x,w]=G.useState(null),S=Ei(),{token:T}=S||{};G.useEffect(()=>{E()},[r]);const E=async()=>{try{i(!0),w(null);const{data:I}=await mn.get(`/dashboard/chart?period=${r}`,{headers:{Authorization:T}});if(I.success){const V=I.data.chartData.map(H=>{let K="";return r==="week"?K=`${H.year}-${String(H.month).padStart(2,"0")}-${String(H.day).padStart(2,"0")}`:r==="years"?K=`${H.year}-01-01`:K=`${H.year}-${String(H.month).padStart(2,"0")}-01`,{date:K,violations:H.violations||0,accidents:H.accidents||0}});c(V)}}catch(I){console.error("Error fetching chart data:",I),w("Failed to load chart data")}finally{i(!1)}},D=G.useMemo(()=>({violations:a.reduce((I,V)=>I+V.violations,0),accidents:a.reduce((I,V)=>I+V.accidents,0)}),[a]),U=I=>{switch(I){case"week":return"Last Week";case"3months":return"Last 3 Months";case"6months":return"Last 6 Months";case"months":return"Last 12 Months";case"year":return"Last Year";case"years":return"Last 5 Years";case"all":return"All Time";default:return"All Time"}};return o.jsxs(Ri,{className:"md:shadow-none border",children:[o.jsxs(Ki,{className:"flex flex-col items-stretch space-y-0 border-b p-0 sm:flex-row",children:[o.jsxs("div",{className:"flex flex-1 flex-col justify-center gap-1 px-6 py-5 sm:py-6",children:[o.jsx(Zi,{children:"Violation & Accidents Overview"}),o.jsxs(As,{children:["Showing violation and accident frequency for ",U(r)]}),o.jsx("div",{className:"mt-2",children:o.jsxs(Js,{value:r,onValueChange:n,children:[o.jsx(Vs,{className:"w-[180px]",children:o.jsx(yo,{placeholder:"Select time period"})}),o.jsxs(Us,{children:[o.jsx(An,{value:"week",children:"Last Week"}),o.jsx(An,{value:"3months",children:"Last 3 Months"}),o.jsx(An,{value:"6months",children:"Last 6 Months"}),o.jsx(An,{value:"months",children:"Last 12 Months"}),o.jsx(An,{value:"year",children:"Last Year"}),o.jsx(An,{value:"years",children:"Last 5 Years"}),o.jsx(An,{value:"all",children:"All Time"})]})]})})]}),o.jsx("div",{className:"flex",children:["violations","accidents"].map(I=>o.jsxs("button",{"data-active":e===I,className:"relative z-30 flex flex-1 flex-col justify-center gap-1 border-t px-6 py-4 text-left even:border-l data-[active=true]:bg-muted/50 sm:border-l sm:border-t-0 sm:px-8 sm:py-6",onClick:()=>t(I),children:[o.jsx("span",{className:"text-xs text-muted-foreground",children:NW[I].label}),o.jsx("span",{className:"text-lg font-bold leading-none sm:text-3xl",children:h?"...":D[I].toLocaleString()})]},I))})]}),o.jsx(Fi,{className:"px-2 sm:p-6",children:h?o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded w-48 mb-4"}),o.jsx("div",{className:"h-[250px] bg-muted rounded"})]}):x?o.jsx("div",{className:"flex items-center justify-center h-[250px]",children:o.jsx("div",{className:"text-red-500",children:x})}):a.length===0?o.jsx("div",{className:"flex items-center justify-center h-[250px]",children:o.jsx("div",{className:"text-muted-foreground",children:"No data available for the selected period"})}):o.jsx(zre,{config:NW,className:"aspect-auto h-[250px] w-full",children:o.jsxs(Xc,{accessibilityLayer:!0,data:a,margin:{left:12,right:12},children:[o.jsx(ms,{vertical:!1}),o.jsx(ga,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:32,tickFormatter:I=>{const V=new Date(I);return r==="week"?V.toLocaleDateString("en-US",{month:"short",day:"numeric"}):r==="years"?V.toLocaleDateString("en-US",{year:"numeric"}):V.toLocaleDateString("en-US",{month:"short",year:"numeric"})}}),o.jsx(k5e,{content:o.jsx(Bre,{className:"w-[150px]",nameKey:"views",labelFormatter:I=>{const V=new Date(I);return r==="week"?V.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):r==="years"?V.toLocaleDateString("en-US",{year:"numeric"}):V.toLocaleDateString("en-US",{month:"short",year:"numeric"})}})}),o.jsx(rs,{dataKey:e,fill:`var(--color-${e})`})]})})})]})}function E5e(e,t=[]){let r=[];function n(c,h){const i=G.createContext(h),x=r.length;r=[...r,h];const w=T=>{var H;const{scope:E,children:D,...U}=T,I=((H=E==null?void 0:E[e])==null?void 0:H[x])||i,V=G.useMemo(()=>U,Object.values(U));return o.jsx(I.Provider,{value:V,children:D})};w.displayName=c+"Provider";function S(T,E){var I;const D=((I=E==null?void 0:E[e])==null?void 0:I[x])||i,U=G.useContext(D);if(U)return U;if(h!==void 0)return h;throw new Error(`\`${T}\` must be used within \`${c}\``)}return[w,S]}const a=()=>{const c=r.map(h=>G.createContext(h));return function(i){const x=(i==null?void 0:i[e])||c;return G.useMemo(()=>({[`__scope${e}`]:{...i,[e]:x}}),[i,x])}};return a.scopeName=e,[n,M5e(a,...t)]}function M5e(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const h=n.reduce((i,{useScope:x,scopeName:w})=>{const T=x(c)[`__scope${w}`];return{...i,...T}},{});return G.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}function AW(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function O5e(...e){return t=>{let r=!1;const n=e.map(a=>{const c=AW(a,t);return!r&&typeof c=="function"&&(r=!0),c});if(r)return()=>{for(let a=0;a<n.length;a++){const c=n[a];typeof c=="function"?c():AW(e[a],null)}}}}function R5e(e){const t=I5e(e),r=G.forwardRef((n,a)=>{const{children:c,...h}=n,i=G.Children.toArray(c),x=i.find(D5e);if(x){const w=x.props.children,S=i.map(T=>T===x?G.Children.count(w)>1?G.Children.only(null):G.isValidElement(w)?w.props.children:null:T);return o.jsx(t,{...h,ref:a,children:G.isValidElement(w)?G.cloneElement(w,void 0,S):null})}return o.jsx(t,{...h,ref:a,children:c})});return r.displayName=`${e}.Slot`,r}function I5e(e){const t=G.forwardRef((r,n)=>{const{children:a,...c}=r;if(G.isValidElement(a)){const h=z5e(a),i=F5e(c,a.props);return a.type!==G.Fragment&&(i.ref=n?O5e(n,h):h),G.cloneElement(a,i)}return G.Children.count(a)>1?G.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var L5e=Symbol("radix.slottable");function D5e(e){return G.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===L5e}function F5e(e,t){const r={...t};for(const n in t){const a=e[n],c=t[n];/^on[A-Z]/.test(n)?a&&c?r[n]=(...i)=>{const x=c(...i);return a(...i),x}:a&&(r[n]=a):n==="style"?r[n]={...a,...c}:n==="className"&&(r[n]=[a,c].filter(Boolean).join(" "))}return{...e,...r}}function z5e(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var B5e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Vre=B5e.reduce((e,t)=>{const r=R5e(`Primitive.${t}`),n=G.forwardRef((a,c)=>{const{asChild:h,...i}=a,x=h?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(x,{...i,ref:c})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{}),DD="Progress",FD=100,[V5e,r8e]=E5e(DD),[U5e,$5e]=V5e(DD),Ure=G.forwardRef((e,t)=>{const{__scopeProgress:r,value:n=null,max:a,getValueLabel:c=q5e,...h}=e;(a||a===0)&&!TW(a)&&console.error(G5e(`${a}`,"Progress"));const i=TW(a)?a:FD;n!==null&&!jW(n,i)&&console.error(W5e(`${n}`,"Progress"));const x=jW(n,i)?n:null,w=yT(x)?c(x,i):void 0;return o.jsx(U5e,{scope:r,value:x,max:i,children:o.jsx(Vre.div,{"aria-valuemax":i,"aria-valuemin":0,"aria-valuenow":yT(x)?x:void 0,"aria-valuetext":w,role:"progressbar","data-state":Gre(x,i),"data-value":x??void 0,"data-max":i,...h,ref:t})})});Ure.displayName=DD;var $re="ProgressIndicator",qre=G.forwardRef((e,t)=>{const{__scopeProgress:r,...n}=e,a=$5e($re,r);return o.jsx(Vre.div,{"data-state":Gre(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...n,ref:t})});qre.displayName=$re;function q5e(e,t){return`${Math.round(e/t*100)}%`}function Gre(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function yT(e){return typeof e=="number"}function TW(e){return yT(e)&&!isNaN(e)&&e>0}function jW(e,t){return yT(e)&&!isNaN(e)&&e<=t&&e>=0}function G5e(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${FD}\`.`}function W5e(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${FD} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Wre=Ure,H5e=qre;const c1=G.forwardRef(({className:e,value:t,...r},n)=>o.jsx(Wre,{ref:n,className:zt("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...r,children:o.jsx(H5e,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));c1.displayName=Wre.displayName;const kW=()=>{const[e,t]=G.useState(!0),[r,n]=G.useState({vehicles:{total:0,active:0,expired:0},drivers:{total:0},violations:{total:0,recent:0,byType:[]},accidents:{total:0},trends:{monthlyViolations:[]}}),{token:a}=Ei();G.useEffect(()=>{c()},[]);const c=async()=>{try{t(!0);const{data:x}=await mn.get("/dashboard/stats",{headers:{Authorization:a}});x.success&&n(x.data)}catch(x){console.error("Error fetching dashboard stats:",x)}finally{t(!1)}},i=(()=>{const x=r.drivers.total>0?(r.violations.total/r.drivers.total).toFixed(2):0,w=r.vehicles.total>0?(r.violations.total/r.vehicles.total).toFixed(2):0,S=r.drivers.total>0?(r.accidents.total/r.drivers.total).toFixed(2):0,T=r.vehicles.total>0?(r.vehicles.active/r.vehicles.total*100).toFixed(1):0,E=r.vehicles.total>0?(r.vehicles.expired/r.vehicles.total*100).toFixed(1):0,D=r.violations.recent>0&&r.violations.total>0?(r.violations.recent/30/(r.violations.total/365)*100-100).toFixed(1):0,U=r.violations.total>0?(r.accidents.total/r.violations.total*100).toFixed(2):0,I=Math.max(0,Math.min(100,100-parseFloat(x)*10-parseFloat(S)*20)).toFixed(0);return{violationsPerDriver:x,violationsPerVehicle:w,accidentsPerDriver:S,activeVehicleRate:T,expiredVehicleRate:E,violationGrowthRate:D,accidentToViolationRatio:U,safetyScore:I}})();return o.jsxs("div",{className:"container mx-auto p-4 md:p-6 bg-white dark:bg-black min-h-screen space-y-4 md:space-y-6 rounded-lg",children:[o.jsx("section",{className:"text-2xl md:text-3xl font-bold",children:"Dashboard"}),e?o.jsxs("div",{className:"space-y-4",children:[o.jsx("section",{className:"max-h-full w-full grid grid-flow-row lg:grid-flow-col grid-cols-1 gap-4 md:gap-5 md:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(x=>o.jsx("div",{className:"bg-card shadow-sm border border-border overflow-hidden rounded-xl p-6",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("div",{className:"h-4 bg-muted rounded w-32"}),o.jsx("div",{className:"w-5 h-5 bg-muted rounded"})]}),o.jsx("div",{className:"h-8 bg-muted rounded w-16 mb-2"}),o.jsx("div",{className:"h-3 bg-muted rounded w-20"})]})},x))}),o.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded w-48 mb-4"}),o.jsx("div",{className:"h-64 bg-muted rounded"})]})})]}):o.jsxs(o.Fragment,{children:[o.jsxs("section",{className:"max-h-full w-full grid grid-flow-row lg:grid-flow-col grid-cols-1 gap-4 md:gap-5 md:grid-cols-2 lg:grid-cols-4",children:[o.jsx(HS,{name:"Registered Vehicles",value:r.vehicles.total.toString(),icon:fo,statuses:[{label:`${r.vehicles.active} Active`,color:"#047857",bgColor:"#d1fae5"},{label:`${r.vehicles.expired} Expired`,color:"#dc2626",bgColor:"#fee2e2"}]}),o.jsx(HS,{name:"Registered Drivers",value:r.drivers.total.toString(),icon:u4}),o.jsx(HS,{name:"Violations",value:r.violations.total.toString(),icon:Vue}),o.jsx(HS,{name:"Accidents",value:r.accidents.total.toString(),icon:k1})]}),o.jsx(C5e,{}),o.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-5",children:[o.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950 dark:to-blue-900 border border-blue-200 dark:border-blue-800 rounded-xl p-6 shadow-sm",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:"Violations Analytics"}),o.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-1",children:"Comprehensive violation metrics"})]}),o.jsx("div",{className:"p-2 bg-blue-200 dark:bg-blue-800 rounded-lg",children:o.jsx(ko,{className:"w-6 h-6 text-blue-700 dark:text-blue-200"})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-3 border border-blue-100 dark:border-blue-800",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Total Violations"}),o.jsx("span",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:r.violations.total.toLocaleString()})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Last 30 days:"}),o.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:r.violations.recent}),parseFloat(i.violationGrowthRate)!==0&&o.jsxs("span",{className:`flex items-center gap-1 ${parseFloat(i.violationGrowthRate)>0?"text-red-600":"text-green-600"}`,children:[parseFloat(i.violationGrowthRate)>0?o.jsx(P1,{className:"w-3 h-3"}):o.jsx(mR,{className:"w-3 h-3"}),Math.abs(parseFloat(i.violationGrowthRate)),"%"]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Per Driver"}),o.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:i.violationsPerDriver})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Per Vehicle"}),o.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:i.violationsPerVehicle})]})]}),r.violations.byType.length>0&&o.jsxs("div",{className:"pt-3 border-t border-blue-200 dark:border-blue-800",children:[o.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2 uppercase",children:"Top Violation Types"}),o.jsx("div",{className:"space-y-2",children:r.violations.byType.sort((x,w)=>w.count-x.count).slice(0,3).map((x,w)=>{const S=(x.count/r.violations.total*100).toFixed(1);return o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex items-center justify-between text-xs",children:[o.jsx("span",{className:"text-gray-700 dark:text-gray-300 truncate flex-1",children:x._id||"Unknown"}),o.jsxs("span",{className:"font-bold text-gray-900 dark:text-white ml-2",children:[x.count," (",S,"%)"]})]}),o.jsx(c1,{value:parseFloat(S),className:"h-1.5"})]},w)})})]})]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-950 dark:to-orange-900 border border-orange-200 dark:border-orange-800 rounded-xl p-6 shadow-sm",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-orange-900 dark:text-orange-100",children:"Accidents Analytics"}),o.jsx("p",{className:"text-xs text-orange-700 dark:text-orange-300 mt-1",children:"Safety and incident metrics"})]}),o.jsx("div",{className:"p-2 bg-orange-200 dark:bg-orange-800 rounded-lg",children:o.jsx(dR,{className:"w-6 h-6 text-orange-700 dark:text-orange-200"})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-3 border border-orange-100 dark:border-orange-800",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Total Accidents"}),o.jsx("span",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:r.accidents.total.toLocaleString()})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[o.jsx(c4,{className:"w-3 h-3"}),o.jsxs("span",{children:["Accident-to-Violation Ratio: ",o.jsxs("span",{className:"font-semibold text-orange-600 dark:text-orange-400",children:[i.accidentToViolationRatio,"%"]})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Per Driver"}),o.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:i.accidentsPerDriver})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Per 1000 Vehicles"}),o.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:r.vehicles.total>0?(r.accidents.total/r.vehicles.total*1e3).toFixed(2):"0"})]})]}),o.jsxs("div",{className:"pt-3 border-t border-orange-200 dark:border-orange-800",children:[o.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-3 uppercase",children:"Risk Assessment"}),o.jsx("div",{className:"space-y-3",children:o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[o.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Accident Severity Index"}),o.jsx("span",{className:`font-bold ${parseFloat(i.accidentToViolationRatio)>5?"text-red-600":parseFloat(i.accidentToViolationRatio)>2?"text-orange-600":"text-green-600"}`,children:parseFloat(i.accidentToViolationRatio)>5?"High":parseFloat(i.accidentToViolationRatio)>2?"Medium":"Low"})]}),o.jsx(c1,{value:Math.min(parseFloat(i.accidentToViolationRatio)*10,100),className:"h-2"})]})})]})]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-100 dark:from-green-950 dark:to-emerald-900 border border-green-200 dark:border-green-800 rounded-xl p-6 shadow-sm",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-green-900 dark:text-green-100",children:"System Health"}),o.jsx("p",{className:"text-xs text-green-700 dark:text-green-300 mt-1",children:"Overall safety metrics"})]}),o.jsx("div",{className:"p-2 bg-green-200 dark:bg-green-800 rounded-lg",children:o.jsx(Xg,{className:"w-6 h-6 text-green-700 dark:text-green-200"})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-4 border border-green-100 dark:border-green-800",children:o.jsxs("div",{className:"text-center mb-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Safety Score"}),o.jsxs("div",{className:"relative inline-flex items-center justify-center",children:[o.jsxs("svg",{className:"w-24 h-24 transform -rotate-90",children:[o.jsx("circle",{cx:"48",cy:"48",r:"40",stroke:"currentColor",strokeWidth:"8",fill:"none",className:"text-gray-200 dark:text-gray-700"}),o.jsx("circle",{cx:"48",cy:"48",r:"40",stroke:"currentColor",strokeWidth:"8",fill:"none",strokeDasharray:`${2*Math.PI*40}`,strokeDashoffset:`${2*Math.PI*40*(1-i.safetyScore/100)}`,className:`${i.safetyScore>=80?"text-green-500":i.safetyScore>=60?"text-yellow-500":i.safetyScore>=40?"text-orange-500":"text-red-500"} transition-all duration-1000`,strokeLinecap:"round"})]}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:o.jsx("span",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:i.safetyScore})})]}),o.jsx("p",{className:`text-xs font-semibold mt-2 ${i.safetyScore>=80?"text-green-600":i.safetyScore>=60?"text-yellow-600":i.safetyScore>=40?"text-orange-600":"text-red-600"}`,children:i.safetyScore>=80?"Excellent":i.safetyScore>=60?"Good":i.safetyScore>=40?"Fair":"Needs Improvement"})]})}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-3 border border-green-100 dark:border-green-800",children:[o.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Vehicle Status"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Active Vehicles"}),o.jsxs("span",{className:"font-bold text-green-600 dark:text-green-400",children:[i.activeVehicleRate,"%"]})]}),o.jsx(c1,{value:parseFloat(i.activeVehicleRate),className:"h-1.5 bg-gray-200 dark:bg-gray-700"})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Expired Vehicles"}),o.jsxs("span",{className:"font-bold text-red-600 dark:text-red-400",children:[i.expiredVehicleRate,"%"]})]}),o.jsx(c1,{value:parseFloat(i.expiredVehicleRate),className:"h-1.5 bg-gray-200 dark:bg-gray-700"})]})]})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg p-3 border border-green-100 dark:border-green-800",children:[o.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Key Ratios"}),o.jsxs("div",{className:"space-y-1.5 text-xs",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Drivers per Vehicle"}),o.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:r.vehicles.total>0?(r.drivers.total/r.vehicles.total).toFixed(2):"0"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Violations per 100 Drivers"}),o.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:r.drivers.total>0?(r.violations.total/r.drivers.total*100).toFixed(1):"0"})]})]})]})]})]})]})]})]})]})},K5e=({allowedRoles:e})=>{const t={employee:"2",admin:"1",superadmin:"0"},{isAuthenticated:r,isLoading:n,userData:a}=Ei(),c=Co(),h=a==null?void 0:a.role;if(n)return o.jsx("div",{className:"h-screen flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const i=e.map(x=>t[x]);return r&&i.includes(h)?o.jsx(sH,{}):o.jsx(X3,{to:"/login",state:{from:c},replace:!0})},BO=({allowedRoles:e,children:t})=>{const{userData:r,loading:n}=Ei(),a=Co(),c=r==null?void 0:r.role;if(n)return o.jsx("div",{children:"Loading..."});const h={employee:"2",admin:"1",superadmin:"0"};return e.map(x=>h[x]).includes(c)?t:o.jsx(X3,{to:"/",state:{from:a},replace:!0})};var zD="Avatar",[Z5e,n8e]=qd(zD),[Y5e,Hre]=Z5e(zD),Kre=G.forwardRef((e,t)=>{const{__scopeAvatar:r,...n}=e,[a,c]=G.useState("idle");return o.jsx(Y5e,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:c,children:o.jsx(gi.span,{...n,ref:t})})});Kre.displayName=zD;var Zre="AvatarImage",Yre=G.forwardRef((e,t)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:a=()=>{},...c}=e,h=Hre(Zre,r),i=X5e(n,c.referrerPolicy),x=zu(w=>{a(w),h.onImageLoadingStatusChange(w)});return pl(()=>{i!=="idle"&&x(i)},[i,x]),i==="loaded"?o.jsx(gi.img,{...c,ref:t,src:n}):null});Yre.displayName=Zre;var Xre="AvatarFallback",Jre=G.forwardRef((e,t)=>{const{__scopeAvatar:r,delayMs:n,...a}=e,c=Hre(Xre,r),[h,i]=G.useState(n===void 0);return G.useEffect(()=>{if(n!==void 0){const x=window.setTimeout(()=>i(!0),n);return()=>window.clearTimeout(x)}},[n]),h&&c.imageLoadingStatus!=="loaded"?o.jsx(gi.span,{...a,ref:t}):null});Jre.displayName=Xre;function X5e(e,t){const[r,n]=G.useState("idle");return pl(()=>{if(!e){n("error");return}let a=!0;const c=new window.Image,h=i=>()=>{a&&n(i)};return n("loading"),c.onload=h("loaded"),c.onerror=h("error"),c.src=e,t&&(c.referrerPolicy=t),()=>{a=!1}},[e,t]),r}var Qre=Kre,ene=Yre,tne=Jre;const zw=G.forwardRef(({className:e,...t},r)=>o.jsx(Qre,{ref:r,className:zt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));zw.displayName=Qre.displayName;const Bw=G.forwardRef(({className:e,...t},r)=>o.jsx(ene,{ref:r,className:zt("aspect-square h-full w-full",e),...t}));Bw.displayName=ene.displayName;const Vw=G.forwardRef(({className:e,...t},r)=>o.jsx(tne,{ref:r,className:zt("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));Vw.displayName=tne.displayName;const VO=768;function J5e(){const[e,t]=G.useState(void 0);return G.useEffect(()=>{const r=window.matchMedia(`(max-width: ${VO-1}px)`),n=()=>{t(window.innerWidth<VO)};return r.addEventListener("change",n),t(window.innerWidth<VO),()=>r.removeEventListener("change",n)},[]),!!e}var Q5e="Separator",PW="horizontal",eFe=["horizontal","vertical"],rne=G.forwardRef((e,t)=>{const{decorative:r,orientation:n=PW,...a}=e,c=tFe(n)?n:PW,i=r?{role:"none"}:{"aria-orientation":c==="vertical"?c:void 0,role:"separator"};return o.jsx(gi.div,{"data-orientation":c,...i,...a,ref:t})});rne.displayName=Q5e;function tFe(e){return eFe.includes(e)}var nne=rne;const B_=G.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...n},a)=>o.jsx(nne,{ref:a,decorative:r,orientation:t,className:zt("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...n}));B_.displayName=nne.displayName;const rFe=X4,nFe=J4,ine=G.forwardRef(({className:e,...t},r)=>o.jsx(o2,{className:zt("fixed inset-0 z-50 bg-black/60 backdrop-blur-[5px] data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));ine.displayName=o2.displayName;const iFe=Ww("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),ane=G.forwardRef(({side:e="right",className:t,children:r,...n},a)=>o.jsxs(nFe,{children:[o.jsx(ine,{}),o.jsxs(l2,{ref:a,className:zt(iFe({side:e}),t),...n,children:[o.jsxs(ZT,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[o.jsx(zd,{className:"h-4 w-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]}),r]})]}));ane.displayName=l2.displayName;const sne=({className:e,...t})=>o.jsx("div",{className:zt("flex flex-col space-y-2 text-center sm:text-left",e),...t});sne.displayName="SheetHeader";const one=G.forwardRef(({className:e,...t},r)=>o.jsx(c2,{ref:r,className:zt("text-lg font-semibold text-foreground",e),...t}));one.displayName=c2.displayName;const lne=G.forwardRef(({className:e,...t},r)=>o.jsx(u2,{ref:r,className:zt("text-sm text-muted-foreground",e),...t}));lne.displayName=u2.displayName;var[Lj,i8e]=qd("Tooltip",[cy]),Dj=cy(),cne="TooltipProvider",aFe=700,M3="tooltip.open",[sFe,BD]=Lj(cne),une=e=>{const{__scopeTooltip:t,delayDuration:r=aFe,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:c}=e,[h,i]=G.useState(!0),x=G.useRef(!1),w=G.useRef(0);return G.useEffect(()=>{const S=w.current;return()=>window.clearTimeout(S)},[]),o.jsx(sFe,{scope:t,isOpenDelayed:h,delayDuration:r,onOpen:G.useCallback(()=>{window.clearTimeout(w.current),i(!1)},[]),onClose:G.useCallback(()=>{window.clearTimeout(w.current),w.current=window.setTimeout(()=>i(!0),n)},[n]),isPointerInTransitRef:x,onPointerInTransitChange:G.useCallback(S=>{x.current=S},[]),disableHoverableContent:a,children:c})};une.displayName=cne;var Fj="Tooltip",[oFe,P2]=Lj(Fj),dne=e=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:a=!1,onOpenChange:c,disableHoverableContent:h,delayDuration:i}=e,x=BD(Fj,e.__scopeTooltip),w=Dj(t),[S,T]=G.useState(null),E=Ld(),D=G.useRef(0),U=h??x.disableHoverableContent,I=i??x.delayDuration,V=G.useRef(!1),[H=!1,K]=Jg({prop:n,defaultProp:a,onChange:ue=>{ue?(x.onOpen(),document.dispatchEvent(new CustomEvent(M3))):x.onClose(),c==null||c(ue)}}),Q=G.useMemo(()=>H?V.current?"delayed-open":"instant-open":"closed",[H]),ae=G.useCallback(()=>{window.clearTimeout(D.current),D.current=0,V.current=!1,K(!0)},[K]),ee=G.useCallback(()=>{window.clearTimeout(D.current),D.current=0,K(!1)},[K]),se=G.useCallback(()=>{window.clearTimeout(D.current),D.current=window.setTimeout(()=>{V.current=!0,K(!0),D.current=0},I)},[I,K]);return G.useEffect(()=>()=>{D.current&&(window.clearTimeout(D.current),D.current=0)},[]),o.jsx(ET,{...w,children:o.jsx(oFe,{scope:t,contentId:E,open:H,stateAttribute:Q,trigger:S,onTriggerChange:T,onTriggerEnter:G.useCallback(()=>{x.isOpenDelayed?se():ae()},[x.isOpenDelayed,se,ae]),onTriggerLeave:G.useCallback(()=>{U?ee():(window.clearTimeout(D.current),D.current=0)},[ee,U]),onOpen:ae,onClose:ee,disableHoverableContent:U,children:r})})};dne.displayName=Fj;var O3="TooltipTrigger",hne=G.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=P2(O3,r),c=BD(O3,r),h=Dj(r),i=G.useRef(null),x=ta(t,i,a.onTriggerChange),w=G.useRef(!1),S=G.useRef(!1),T=G.useCallback(()=>w.current=!1,[]);return G.useEffect(()=>()=>document.removeEventListener("pointerup",T),[T]),o.jsx(Xw,{asChild:!0,...h,children:o.jsx(gi.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:x,onPointerMove:dn(e.onPointerMove,E=>{E.pointerType!=="touch"&&!S.current&&!c.isPointerInTransitRef.current&&(a.onTriggerEnter(),S.current=!0)}),onPointerLeave:dn(e.onPointerLeave,()=>{a.onTriggerLeave(),S.current=!1}),onPointerDown:dn(e.onPointerDown,()=>{w.current=!0,document.addEventListener("pointerup",T,{once:!0})}),onFocus:dn(e.onFocus,()=>{w.current||a.onOpen()}),onBlur:dn(e.onBlur,a.onClose),onClick:dn(e.onClick,a.onClose)})})});hne.displayName=O3;var VD="TooltipPortal",[lFe,cFe]=Lj(VD,{forceMount:void 0}),fne=e=>{const{__scopeTooltip:t,forceMount:r,children:n,container:a}=e,c=P2(VD,t);return o.jsx(lFe,{scope:t,forceMount:r,children:o.jsx($u,{present:r||c.open,children:o.jsx(S_,{asChild:!0,container:a,children:n})})})};fne.displayName=VD;var d_="TooltipContent",pne=G.forwardRef((e,t)=>{const r=cFe(d_,e.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...c}=e,h=P2(d_,e.__scopeTooltip);return o.jsx($u,{present:n||h.open,children:h.disableHoverableContent?o.jsx(mne,{side:a,...c,ref:t}):o.jsx(uFe,{side:a,...c,ref:t})})}),uFe=G.forwardRef((e,t)=>{const r=P2(d_,e.__scopeTooltip),n=BD(d_,e.__scopeTooltip),a=G.useRef(null),c=ta(t,a),[h,i]=G.useState(null),{trigger:x,onClose:w}=r,S=a.current,{onPointerInTransitChange:T}=n,E=G.useCallback(()=>{i(null),T(!1)},[T]),D=G.useCallback((U,I)=>{const V=U.currentTarget,H={x:U.clientX,y:U.clientY},K=pFe(H,V.getBoundingClientRect()),Q=mFe(H,K),ae=gFe(I.getBoundingClientRect()),ee=xFe([...Q,...ae]);i(ee),T(!0)},[T]);return G.useEffect(()=>()=>E(),[E]),G.useEffect(()=>{if(x&&S){const U=V=>D(V,S),I=V=>D(V,x);return x.addEventListener("pointerleave",U),S.addEventListener("pointerleave",I),()=>{x.removeEventListener("pointerleave",U),S.removeEventListener("pointerleave",I)}}},[x,S,D,E]),G.useEffect(()=>{if(h){const U=I=>{const V=I.target,H={x:I.clientX,y:I.clientY},K=(x==null?void 0:x.contains(V))||(S==null?void 0:S.contains(V)),Q=!yFe(H,h);K?E():Q&&(E(),w())};return document.addEventListener("pointermove",U),()=>document.removeEventListener("pointermove",U)}},[x,S,h,w,E]),o.jsx(mne,{...e,ref:c})}),[dFe,hFe]=Lj(Fj,{isInside:!1}),mne=G.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:c,onPointerDownOutside:h,...i}=e,x=P2(d_,r),w=Dj(r),{onClose:S}=x;return G.useEffect(()=>(document.addEventListener(M3,S),()=>document.removeEventListener(M3,S)),[S]),G.useEffect(()=>{if(x.trigger){const T=E=>{const D=E.target;D!=null&&D.contains(x.trigger)&&S()};return window.addEventListener("scroll",T,{capture:!0}),()=>window.removeEventListener("scroll",T,{capture:!0})}},[x.trigger,S]),o.jsx(__,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:c,onPointerDownOutside:h,onFocusOutside:T=>T.preventDefault(),onDismiss:S,children:o.jsxs(MT,{"data-state":x.stateAttribute,...w,...i,ref:t,style:{...i.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[o.jsx(e4,{children:n}),o.jsx(dFe,{scope:r,isInside:!0,children:o.jsx(JDe,{id:x.contentId,role:"tooltip",children:a||n})})]})})});pne.displayName=d_;var gne="TooltipArrow",fFe=G.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=Dj(r);return hFe(gne,r).isInside?null:o.jsx(OT,{...a,...n,ref:t})});fFe.displayName=gne;function pFe(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),c=Math.abs(t.left-e.x);switch(Math.min(r,n,a,c)){case c:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function mFe(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function gFe(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function yFe(e,t){const{x:r,y:n}=e;let a=!1;for(let c=0,h=t.length-1;c<t.length;h=c++){const i=t[c].x,x=t[c].y,w=t[h].x,S=t[h].y;x>n!=S>n&&r<(w-i)*(n-x)/(S-x)+i&&(a=!a)}return a}function xFe(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),vFe(t)}function vFe(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const c=t[t.length-1],h=t[t.length-2];if((c.x-h.x)*(a.y-h.y)>=(c.y-h.y)*(a.x-h.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const c=r[r.length-1],h=r[r.length-2];if((c.x-h.x)*(a.y-h.y)>=(c.y-h.y)*(a.x-h.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var _Fe=une,bFe=dne,wFe=hne,SFe=fne,yne=pne;const NFe=_Fe,AFe=bFe,TFe=wFe,xne=G.forwardRef(({className:e,sideOffset:t=4,...r},n)=>o.jsx(SFe,{children:o.jsx(yne,{ref:n,sideOffset:t,className:zt("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));xne.displayName=yne.displayName;const jFe="sidebar_state",kFe=60*60*24*7,PFe="16rem",CFe="18rem",EFe="3rem",MFe="b",vne=G.createContext(null);function V_(){const e=G.useContext(vne);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const _ne=G.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:r,className:n,style:a,children:c,...h},i)=>{const x=J5e(),[w,S]=G.useState(!1),[T,E]=G.useState(e),D=t??T,U=G.useCallback(K=>{const Q=typeof K=="function"?K(D):K;r?r(Q):E(Q),document.cookie=`${jFe}=${Q}; path=/; max-age=${kFe}`},[r,D]),I=G.useCallback(()=>x?S(K=>!K):U(K=>!K),[x,U,S]);G.useEffect(()=>{const K=Q=>{Q.key===MFe&&(Q.metaKey||Q.ctrlKey)&&(Q.preventDefault(),I())};return window.addEventListener("keydown",K),()=>window.removeEventListener("keydown",K)},[I]);const V=D?"expanded":"collapsed",H=G.useMemo(()=>({state:V,open:D,setOpen:U,isMobile:x,openMobile:w,setOpenMobile:S,toggleSidebar:I}),[V,D,U,x,w,S,I]);return o.jsx(vne.Provider,{value:H,children:o.jsx(NFe,{delayDuration:0,children:o.jsx("div",{style:{"--sidebar-width":PFe,"--sidebar-width-icon":EFe,...a},className:zt("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",n),ref:i,...h,children:c})})})});_ne.displayName="SidebarProvider";const bne=G.forwardRef(({side:e="left",variant:t="sidebar",collapsible:r="offcanvas",className:n,children:a,...c},h)=>{const{isMobile:i,state:x,openMobile:w,setOpenMobile:S}=V_();return r==="none"?o.jsx("div",{className:zt("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",n),ref:h,...c,children:a}):i?o.jsx(rFe,{open:w,onOpenChange:S,...c,children:o.jsxs(ane,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":CFe},side:e,children:[o.jsxs(sne,{className:"sr-only",children:[o.jsx(one,{children:"Sidebar"}),o.jsx(lne,{children:"Displays the mobile sidebar."})]}),o.jsx("div",{className:"flex h-full w-full flex-col",children:a})]})}):o.jsxs("div",{ref:h,className:"group peer hidden text-sidebar-foreground md:block","data-state":x,"data-collapsible":x==="collapsed"?r:"","data-variant":t,"data-side":e,children:[o.jsx("div",{className:zt("relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),o.jsx("div",{className:zt("fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",n),...c,children:o.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});bne.displayName="Sidebar";const wne=G.forwardRef(({className:e,onClick:t,...r},n)=>{const{toggleSidebar:a}=V_();return o.jsxs(ur,{ref:n,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:zt("h-7 w-7",e),onClick:c=>{t==null||t(c),a()},...r,children:[o.jsx(Rde,{}),o.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})});wne.displayName="SidebarTrigger";const Sne=G.forwardRef(({className:e,...t},r)=>{const{toggleSidebar:n}=V_();return o.jsx("button",{ref:r,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:n,title:"Toggle Sidebar",className:zt("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});Sne.displayName="SidebarRail";const Nne=G.forwardRef(({className:e,...t},r)=>o.jsx("main",{ref:r,className:zt("relative flex w-full flex-1 flex-col bg-background","md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));Nne.displayName="SidebarInset";const OFe=G.forwardRef(({className:e,...t},r)=>o.jsx(Yr,{ref:r,"data-sidebar":"input",className:zt("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));OFe.displayName="SidebarInput";const Ane=G.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,"data-sidebar":"header",className:zt("flex flex-col gap-2 p-2",e),...t}));Ane.displayName="SidebarHeader";const Tne=G.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,"data-sidebar":"footer",className:zt("flex flex-col gap-2 p-2",e),...t}));Tne.displayName="SidebarFooter";const RFe=G.forwardRef(({className:e,...t},r)=>o.jsx(B_,{ref:r,"data-sidebar":"separator",className:zt("mx-2 w-auto bg-sidebar-border",e),...t}));RFe.displayName="SidebarSeparator";const jne=G.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,"data-sidebar":"content",className:zt("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));jne.displayName="SidebarContent";const EN=G.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,"data-sidebar":"group",className:zt("relative flex w-full min-w-0 flex-col p-2",e),...t}));EN.displayName="SidebarGroup";const MN=G.forwardRef(({className:e,asChild:t=!1,...r},n)=>{const a=t?nc:"div";return o.jsx(a,{ref:n,"data-sidebar":"group-label",className:zt("flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...r})});MN.displayName="SidebarGroupLabel";const IFe=G.forwardRef(({className:e,asChild:t=!1,...r},n)=>{const a=t?nc:"button";return o.jsx(a,{ref:n,"data-sidebar":"group-action",className:zt("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...r})});IFe.displayName="SidebarGroupAction";const LFe=G.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,"data-sidebar":"group-content",className:zt("w-full text-sm",e),...t}));LFe.displayName="SidebarGroupContent";const vv=G.forwardRef(({className:e,...t},r)=>o.jsx("ul",{ref:r,"data-sidebar":"menu",className:zt("flex w-full min-w-0 flex-col gap-1",e),...t}));vv.displayName="SidebarMenu";const Pd=G.forwardRef(({className:e,...t},r)=>o.jsx("li",{ref:r,"data-sidebar":"menu-item",className:zt("group/menu-item relative",e),...t}));Pd.displayName="SidebarMenuItem";const DFe=Ww("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),Cd=G.forwardRef(({asChild:e=!1,isActive:t=!1,variant:r="default",size:n="default",tooltip:a,className:c,...h},i)=>{const x=e?nc:"button",{isMobile:w,state:S}=V_(),T=o.jsx(x,{ref:i,"data-sidebar":"menu-button","data-size":n,"data-active":t,className:zt(DFe({variant:r,size:n}),c),...h});return a?(typeof a=="string"&&(a={children:a}),o.jsxs(AFe,{children:[o.jsx(TFe,{asChild:!0,children:T}),o.jsx(xne,{side:"right",align:"center",hidden:S!=="collapsed"||w,...a})]})):T});Cd.displayName="SidebarMenuButton";const FFe=G.forwardRef(({className:e,asChild:t=!1,showOnHover:r=!1,...n},a)=>{const c=t?nc:"button";return o.jsx(c,{ref:a,"data-sidebar":"menu-action",className:zt("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",r&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...n})});FFe.displayName="SidebarMenuAction";const zFe=G.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,"data-sidebar":"menu-badge",className:zt("pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));zFe.displayName="SidebarMenuBadge";const BFe=G.forwardRef(({className:e,showIcon:t=!1,...r},n)=>{const a=G.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return o.jsxs("div",{ref:n,"data-sidebar":"menu-skeleton",className:zt("flex h-8 items-center gap-2 rounded-md px-2",e),...r,children:[t&&o.jsx(hA,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),o.jsx(hA,{className:"h-4 max-w-[--skeleton-width] flex-1","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});BFe.displayName="SidebarMenuSkeleton";const R3=G.forwardRef(({className:e,...t},r)=>o.jsx("ul",{ref:r,"data-sidebar":"menu-sub",className:zt("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));R3.displayName="SidebarMenuSub";const v0=G.forwardRef(({...e},t)=>o.jsx("li",{ref:t,...e}));v0.displayName="SidebarMenuSubItem";const _0=G.forwardRef(({asChild:e=!1,size:t="md",isActive:r,className:n,...a},c)=>{const h=e?nc:"a";return o.jsx(h,{ref:c,"data-sidebar":"menu-sub-button","data-size":t,"data-active":r,className:zt("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",n),...a})});_0.displayName="SidebarMenuSubButton";var UD="Collapsible",[VFe,a8e]=qd(UD),[UFe,$D]=VFe(UD),kne=G.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:a,disabled:c,onOpenChange:h,...i}=e,[x=!1,w]=Jg({prop:n,defaultProp:a,onChange:h});return o.jsx(UFe,{scope:r,disabled:c,contentId:Ld(),open:x,onOpenToggle:G.useCallback(()=>w(S=>!S),[w]),children:o.jsx(gi.div,{"data-state":GD(x),"data-disabled":c?"":void 0,...i,ref:t})})});kne.displayName=UD;var Pne="CollapsibleTrigger",Cne=G.forwardRef((e,t)=>{const{__scopeCollapsible:r,...n}=e,a=$D(Pne,r);return o.jsx(gi.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":GD(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...n,ref:t,onClick:dn(e.onClick,a.onOpenToggle)})});Cne.displayName=Pne;var qD="CollapsibleContent",Ene=G.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=$D(qD,e.__scopeCollapsible);return o.jsx($u,{present:r||a.open,children:({present:c})=>o.jsx($Fe,{...n,ref:t,present:c})})});Ene.displayName=qD;var $Fe=G.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:n,children:a,...c}=e,h=$D(qD,r),[i,x]=G.useState(n),w=G.useRef(null),S=ta(t,w),T=G.useRef(0),E=T.current,D=G.useRef(0),U=D.current,I=h.open||i,V=G.useRef(I),H=G.useRef(void 0);return G.useEffect(()=>{const K=requestAnimationFrame(()=>V.current=!1);return()=>cancelAnimationFrame(K)},[]),pl(()=>{const K=w.current;if(K){H.current=H.current||{transitionDuration:K.style.transitionDuration,animationName:K.style.animationName},K.style.transitionDuration="0s",K.style.animationName="none";const Q=K.getBoundingClientRect();T.current=Q.height,D.current=Q.width,V.current||(K.style.transitionDuration=H.current.transitionDuration,K.style.animationName=H.current.animationName),x(n)}},[h.open,n]),o.jsx(gi.div,{"data-state":GD(h.open),"data-disabled":h.disabled?"":void 0,id:h.contentId,hidden:!I,...c,ref:S,style:{"--radix-collapsible-content-height":E?`${E}px`:void 0,"--radix-collapsible-content-width":U?`${U}px`:void 0,...e.style},children:I&&a})});function GD(e){return e?"open":"closed"}var qFe=kne;const CW=qFe,EW=Cne,MW=Ene;function GFe(){const{isMobile:e}=V_(),t=Ei(),{logout:r,userData:n}=t||{},a=()=>{r()};return o.jsx(vv,{children:o.jsx(Pd,{children:o.jsxs(Yh,{children:[o.jsx(op,{asChild:!0,children:o.jsxs(Cd,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[o.jsxs(zw,{className:"h-8 w-8 rounded-lg",children:[o.jsx(Bw,{src:n.avatar,alt:n.email},`nav-${(n==null?void 0:n.avatar)||"default-img"}`),o.jsx(Vw,{className:"rounded-lg font-bold",children:n.email.charAt(0)})]},(n==null?void 0:n.avatar)||"default"),o.jsx("div",{className:"grid flex-1 text-left text-sm leading-tight",children:o.jsx("span",{className:"truncate font-semibold",children:n.email})}),o.jsx(SH,{className:"ml-auto size-4"})]})}),o.jsxs(Bd,{className:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:e?"bottom":"right",align:"end",sideOffset:4,children:[o.jsx(N_,{className:"p-0 font-normal",children:o.jsxs("div",{className:"flex items-center gap-2 px-1 py-1.5 text-left text-sm",children:[o.jsxs(zw,{className:"h-8 w-8 rounded-lg",children:[o.jsx(Bw,{src:n.avatar,alt:n.email},`dropdown-${(n==null?void 0:n.avatar)||"default-img"}`),o.jsx(Vw,{className:"rounded-lg font-bold",children:n.email.charAt(0)})]},(n==null?void 0:n.avatar)||"default"),o.jsx("div",{className:"grid flex-1 text-left text-sm leading-tight",children:o.jsx("span",{className:"truncate font-semibold",children:n.email})})]})}),o.jsx(Am,{}),o.jsx(Qme,{children:o.jsx(es,{asChild:!0,children:o.jsxs(To,{to:"/account",className:"flex items-center gap-2",children:[o.jsx(Pue,{}),"Account"]})})}),o.jsx(Am,{}),o.jsxs(es,{onSelect:a,children:[o.jsx(kde,{}),"Log out"]})]})]})})})}function WFe(e){const t=Co(),r=Ei(),{userData:n}=r||{},{state:a}=V_(),[c,h]=G.useState(!1),[i,x]=G.useState(!1),w=a==="collapsed",S=D=>{h(D),D&&x(!1)},T=D=>{x(D),D&&h(!1)},E=(n==null?void 0:n.role)==="0"||(n==null?void 0:n.role)==="1";return n==null||n.role,o.jsxs(bne,{collapsible:"icon",...e,children:[o.jsx(Ane,{className:"group-data-[collapsible=icon]:flex group-data-[collapsible=icon]:justify-center",children:o.jsx(vv,{children:o.jsx(Pd,{children:o.jsxs(Cd,{tooltip:"LTO WebSystem",className:"group-data-[collapsible=icon]:justify-center",children:[o.jsx("div",{className:"flex aspect-square size-8 items-center justify-center rounded-lg text-sidebar-primary-foreground group-data-[collapsible=icon]:size-6",children:o.jsx("img",{src:H1,className:"h-7 w-7 object-contain group-data-[collapsible=icon]:h-6 group-data-[collapsible=icon]:w-6",alt:"LTO Logo"})}),o.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight group-data-[collapsible=icon]:hidden",children:[o.jsx("span",{className:"truncate font-semibold",children:"LTO WebSystem"}),o.jsx("span",{className:"truncate text-xs",children:"Land Transportation Office"})]})]})})})}),o.jsxs(jne,{children:[o.jsxs(EN,{children:[o.jsx(MN,{children:"Menu"}),o.jsxs(vv,{className:"",children:[o.jsx(Pd,{children:o.jsx(Cd,{isActive:t.pathname==="/dashboard"||t.pathname==="/",asChild:!0,children:o.jsxs(To,{to:"/dashboard",children:[o.jsx(Yde,{}),o.jsx("span",{children:"Dashboard"})]})})}),o.jsx(Pd,{children:o.jsx(Cd,{isActive:t.pathname==="/vehicle",asChild:!0,children:o.jsxs(To,{to:"/vehicle",children:[o.jsx(fo,{}),o.jsx("span",{children:"Manage Vehicles"})]})})}),o.jsx(Pd,{children:o.jsx(Cd,{isActive:t.pathname==="/driver",asChild:!0,children:o.jsxs(To,{to:"/driver",children:[o.jsx(u4,{}),o.jsx("span",{children:"Manage Drivers"})]})})}),o.jsx(Pd,{children:o.jsx(Cd,{isActive:t.pathname==="/violation",asChild:!0,children:o.jsxs(To,{to:"/violation",children:[o.jsx(lP,{}),o.jsx("span",{children:"Manage Violations"})]})})}),o.jsx(Pd,{children:o.jsx(Cd,{isActive:t.pathname==="/accident",asChild:!0,children:o.jsxs(To,{to:"/accident",children:[o.jsx(oP,{}),o.jsx("span",{children:"Manage Accidents"})]})})})]})]}),o.jsxs(EN,{children:[o.jsx(MN,{children:"Analytics"}),o.jsx(vv,{children:w?o.jsx(Pd,{children:o.jsxs(Yh,{children:[o.jsx(op,{asChild:!0,children:o.jsxs(Cd,{tooltip:"Analytics",children:[o.jsx(k1,{}),o.jsx("span",{children:"Analytics"})]})}),o.jsxs(Bd,{side:"right",align:"start",className:"w-48",children:[o.jsx(es,{asChild:!0,children:o.jsxs(To,{to:"/analytics/registration",className:"flex items-center gap-2",children:[o.jsx(ZB,{className:"h-4 w-4"}),o.jsx("span",{children:"Registration"})]})}),o.jsx(es,{asChild:!0,children:o.jsxs(To,{to:"/analytics/violation",className:"flex items-center gap-2",children:[o.jsx(lP,{className:"h-4 w-4"}),o.jsx("span",{children:"Violation"})]})}),o.jsx(es,{asChild:!0,children:o.jsxs(To,{to:"/analytics/accident",className:"flex items-center gap-2",children:[o.jsx(oP,{className:"h-4 w-4"}),o.jsx("span",{children:"Accident"})]})})]})]})}):o.jsx(CW,{asChild:!0,className:"group/collapsible",open:c,onOpenChange:S,children:o.jsxs(Pd,{children:[o.jsx(EW,{asChild:!0,children:o.jsxs(Cd,{children:[o.jsx(k1,{}),o.jsx("span",{children:"Analytics"}),o.jsx(z0,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),o.jsx(MW,{children:o.jsxs(R3,{children:[o.jsx(v0,{children:o.jsx(_0,{isActive:t.pathname==="/analytics/registration",asChild:!0,children:o.jsxs(To,{to:"/analytics/registration",children:[o.jsx(ZB,{}),o.jsx("span",{children:"Registration"})]})})}),o.jsx(v0,{children:o.jsx(_0,{isActive:t.pathname==="/analytics/violation",asChild:!0,children:o.jsxs(To,{to:"/analytics/violation",children:[o.jsx(lP,{}),o.jsx("span",{children:"Violation"})]})})}),o.jsx(v0,{children:o.jsx(_0,{isActive:t.pathname==="/analytics/accident",asChild:!0,children:o.jsxs(To,{to:"/analytics/accident",children:[o.jsx(oP,{}),o.jsx("span",{children:"Accident"})]})})})]})})]})})})]}),E&&o.jsxs(EN,{children:[o.jsx(MN,{children:"Account Management"}),o.jsx(vv,{children:w?o.jsx(Pd,{children:o.jsxs(Yh,{children:[o.jsx(op,{asChild:!0,children:o.jsxs(Cd,{tooltip:"Manage Account",children:[o.jsx(fl,{}),o.jsx("span",{children:"Manage Account"})]})}),o.jsxs(Bd,{side:"right",align:"start",className:"w-48",children:[o.jsx(es,{asChild:!0,children:o.jsxs(To,{to:"/account/register",className:"flex items-center gap-2",children:[o.jsx(zN,{className:"h-4 w-4"}),o.jsx("span",{children:"Register Account"})]})}),o.jsx(es,{asChild:!0,children:o.jsxs(To,{to:"/account/update",className:"flex items-center gap-2",children:[o.jsx(za,{className:"h-4 w-4"}),o.jsx("span",{children:"Update Account"})]})}),o.jsx(es,{asChild:!0,children:o.jsxs(To,{to:"/account/logs",className:"flex items-center gap-2",children:[o.jsx(ho,{className:"h-4 w-4"}),o.jsx("span",{children:"View Account Logs"})]})})]})]})}):o.jsx(CW,{asChild:!0,className:"group/collapsible",open:i,onOpenChange:T,children:o.jsxs(Pd,{children:[o.jsx(EW,{asChild:!0,children:o.jsxs(Cd,{children:[o.jsx(fl,{}),o.jsx("span",{children:"Manage Account"}),o.jsx(z0,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),o.jsx(MW,{children:o.jsxs(R3,{children:[o.jsx(v0,{children:o.jsx(_0,{isActive:t.pathname==="/account/register",asChild:!0,children:o.jsxs(To,{to:"/account/register",children:[o.jsx(zN,{}),o.jsx("span",{children:"Register Account"})]})})}),o.jsx(v0,{children:o.jsx(_0,{isActive:t.pathname==="/account/update",asChild:!0,children:o.jsxs(To,{to:"/account/update",children:[o.jsx(za,{}),o.jsx("span",{children:"Update Account"})]})})}),o.jsx(v0,{children:o.jsx(_0,{isActive:t.pathname==="/account/logs",asChild:!0,children:o.jsxs(To,{to:"/account/logs",children:[o.jsx(ho,{}),o.jsx("span",{children:"View Account Logs"})]})})})]})})]})})})]})]}),o.jsx(Tne,{children:o.jsx(GFe,{})}),o.jsx(Sne,{})]})}const Mne=G.forwardRef(({...e},t)=>o.jsx("nav",{ref:t,"aria-label":"breadcrumb",...e}));Mne.displayName="Breadcrumb";const One=G.forwardRef(({className:e,...t},r)=>o.jsx("ol",{ref:r,className:zt("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",e),...t}));One.displayName="BreadcrumbList";const I3=G.forwardRef(({className:e,...t},r)=>o.jsx("li",{ref:r,className:zt("inline-flex items-center gap-1.5",e),...t}));I3.displayName="BreadcrumbItem";const Rne=G.forwardRef(({asChild:e,className:t,...r},n)=>{const a=e?nc:"a";return o.jsx(a,{ref:n,className:zt("transition-colors hover:text-foreground",t),...r})});Rne.displayName="BreadcrumbLink";const Ine=G.forwardRef(({className:e,...t},r)=>o.jsx("span",{ref:r,role:"link","aria-disabled":"true","aria-current":"page",className:zt("font-normal text-foreground",e),...t}));Ine.displayName="BreadcrumbPage";const Lne=({children:e,className:t,...r})=>o.jsx("li",{role:"presentation","aria-hidden":"true",className:zt("[&>svg]:w-3.5 [&>svg]:h-3.5",t),...r,children:e??o.jsx(z0,{})});Lne.displayName="BreadcrumbSeparator";const HFe=()=>{Ba();const e=Co(),t=()=>{const r=e.pathname;if(r.includes("/driver/")&&r.includes("/edit"))return"Edit Driver";if(r.includes("/vehicle/")&&r.includes("/edit"))return"Edit Vehicle";if(r.includes("/violation/")&&r.includes("/edit"))return"Edit Violation";if(r.includes("/accident/")&&r.includes("/edit"))return"Edit Accident";if(r.match(/^\/driver\/[a-zA-Z0-9]+$/))return null;switch(r){case"/":return"Overview";case"/driver":return"Drivers";case"/vehicle":return"Vehicles";case"/violation":return"Violations";case"/accident":return"Accidents";case"/analytics/registration":return"Registration Analytics";case"/analytics/violation":return"Violation Analytics";case"/analytics/accident":return"Accident Analytics";case"/account":return"Account";case"/account/register":return"Register Account";case"/account/update":return"Update Account";case"/account/logs":return"Account Logs";default:return"Overview"}};return o.jsx(o.Fragment,{children:o.jsxs(_ne,{children:[o.jsx(WFe,{}),o.jsxs(Nne,{children:[o.jsxs("header",{className:"flex justify-between border-b h-16 shrink-0 items-center gap-2 transition-[width,height] ease-linear group-has-[[data-collapsible=icon]]/sidebar-wrapper:h-12 bg-white dark:bg-black border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center gap-2 px-4",children:[o.jsx(wne,{className:"-ml-1"}),o.jsx(B_,{orientation:"vertical",className:"mr-2 h-4"}),t()&&o.jsx(Mne,{children:o.jsxs(One,{children:[o.jsx(I3,{className:"hidden md:block",children:o.jsx(Rne,{href:"/dashboard",children:"Dashboard"})}),o.jsx(Lne,{className:"hidden md:block"}),o.jsx(I3,{children:o.jsx(Ine,{children:t()})})]})})]}),o.jsx("div",{className:"px-4 md:px-8",children:o.jsx(ige,{})})]}),o.jsx("main",{className:"md:p-4 h-full flex flex-col overflow-hidden",children:o.jsx(sH,{})})]})]})})};function KFe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,c;for(c=0;c<n.length;c++)a=n[c],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var ZFe=["color"],WD=G.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=KFe(e,ZFe);return G.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a,{ref:t}),G.createElement("path",{d:"M3.625 7.5C3.625 8.12132 3.12132 8.625 2.5 8.625C1.87868 8.625 1.375 8.12132 1.375 7.5C1.375 6.87868 1.87868 6.375 2.5 6.375C3.12132 6.375 3.625 6.87868 3.625 7.5ZM8.625 7.5C8.625 8.12132 8.12132 8.625 7.5 8.625C6.87868 8.625 6.375 8.12132 6.375 7.5C6.375 6.87868 6.87868 6.375 7.5 6.375C8.12132 6.375 8.625 6.87868 8.625 7.5ZM12.5 8.625C13.1213 8.625 13.625 8.12132 13.625 7.5C13.625 6.87868 13.1213 6.375 12.5 6.375C11.8787 6.375 11.375 6.87868 11.375 7.5C11.375 8.12132 11.8787 8.625 12.5 8.625Z",fill:n,fillRule:"evenodd",clipRule:"evenodd"}))});function xT({column:e,title:t,className:r,disableHide:n=!1}){return e.getCanSort()?o.jsx("div",{className:zt("flex items-center space-x-2",r),children:o.jsxs(Yh,{children:[o.jsx(op,{asChild:!0,children:o.jsxs(ur,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[o.jsx("span",{children:t}),e.getIsSorted()==="desc"?o.jsx(HB,{}):e.getIsSorted()==="asc"?o.jsx(KB,{}):o.jsx(SH,{})]})}),o.jsxs(Bd,{align:"start",children:[o.jsxs(es,{onClick:()=>e.toggleSorting(!1),children:[o.jsx(KB,{className:"h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),o.jsxs(es,{onClick:()=>e.toggleSorting(!0),children:[o.jsx(HB,{className:"h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),!n&&o.jsxs(o.Fragment,{children:[o.jsx(Am,{}),o.jsxs(es,{onClick:()=>e.toggleVisibility(!1),children:[o.jsx(DN,{className:"h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})]})}):o.jsx("div",{className:zt(r),children:t})}const YFe=Ww("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Qa({className:e,variant:t,...r}){return o.jsx("div",{className:zt(YFe({variant:t}),e),...r})}const jc=e=>new Date(e).toLocaleString("en-PH",{weekday:"long",year:"numeric",month:"long",day:"2-digit",hour:"numeric",minute:"numeric",hour12:!0,timeZone:"Asia/Manila"}),zj=e=>new Date(e).toLocaleString("en-PH",{year:"numeric",month:"long",day:"2-digit",timeZone:"Asia/Manila"}),XFe=(e,t,r)=>[{accessorKey:"blotterNo",header:"Blotter No.",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:n.getValue("blotterNo")})},{accessorKey:"vehiclePlateNo",header:"Vehicle Plate No.",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("vehiclePlateNo")||"N/A"})},{accessorKey:"incidentType",header:"Incident Type",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("incidentType")||"N/A"})},{accessorKey:"suspect",header:"Suspect",cell:({row:n})=>o.jsx("div",{className:"text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("suspect")||"N/A"})},{accessorKey:"dateCommited",header:"Date Committed",cell:({row:n})=>o.jsx("div",{className:"text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("dateCommited")})},{accessorKey:"caseStatus",header:"Case Status",cell:({row:n})=>{const a=n.getValue("caseStatus"),c={pending:"text-yellow-600 bg-yellow-100",ongoing:"text-blue-600 bg-blue-100",solved:"text-green-600 bg-green-100",closed:"text-gray-600 bg-gray-100"};return o.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium inline-block ${c[a==null?void 0:a.toLowerCase()]||"text-gray-600 bg-gray-100"}`,children:a||"N/A"})}},{accessorKey:"municipality",header:"Municipality",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("municipality")||"N/A"})},{accessorKey:"barangay",header:"Barangay",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("barangay")||"N/A"})},{id:"actions",enableHiding:!1,cell:({row:n})=>{const a=n.original,c=h=>{h.stopPropagation(),e(a._id)};return o.jsxs(Yh,{children:[o.jsx(op,{asChild:!0,children:o.jsxs(ur,{variant:"ghost",className:"h-5 w-5 p-0",children:[o.jsx("span",{className:"sr-only",children:"Open menu"}),o.jsx(WD,{className:"h-4 w-4"})]})}),o.jsxs(Bd,{align:"end",className:"w-24",children:[o.jsx(N_,{className:"text-xs py-1",children:"Actions"}),o.jsx(Am,{}),o.jsxs(es,{onClick:c,className:"text-xs py-1",children:[o.jsx(za,{className:"h-3 w-3 mr-2"}),"Edit"]})]})]})}}],JFe=e=>[{accessorKey:"plateNo",header:"Plate No.",cell:({row:t})=>o.jsx("div",{className:"",children:t.getValue("plateNo")})},{accessorKey:"ownerRepresentativeName",header:({column:t})=>o.jsx(xT,{column:t,title:"Owner/Representative Name"}),cell:({row:t})=>o.jsx("div",{className:"",children:t.getValue("ownerRepresentativeName")})},{accessorKey:"hasDriversLicense",header:"Driver's License",cell:({row:t})=>{const r=t.getValue("hasDriversLicense"),n=t.original.driversLicenseNumber;return o.jsx("div",{className:"flex items-center gap-2 flex-nowrap whitespace-nowrap",children:r?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"font-semibold text-green-600 whitespace-nowrap",children:"Yes"}),n&&o.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:n})]}):o.jsx("span",{className:"font-semibold text-red-600 whitespace-nowrap",children:"No"})})}},{accessorKey:"birthDate",header:"Birthday",cell:({row:t})=>{const r=t.getValue("birthDate");return o.jsx("div",{className:"",children:r?new Date(r).toLocaleDateString():"None"})}},{accessorKey:"contactNumber",header:"Contact Number",cell:({row:t})=>{const r=t.getValue("contactNumber");return o.jsx("div",{className:"",children:r||"None"})}},{accessorKey:"emailAddress",header:"Email Address",cell:({row:t})=>{const r=t.getValue("emailAddress");return o.jsx("div",{className:"",children:r||"None"})}},{id:"actions",enableHiding:!1,cell:({row:t})=>{const r=t.original,n=a=>{a.stopPropagation(),e(r._id)};return o.jsxs(Yh,{children:[o.jsx(op,{asChild:!0,children:o.jsxs(ur,{variant:"ghost",className:"h-5 w-5 p-0",children:[o.jsx("span",{className:"sr-only",children:"Open menu"}),o.jsx(WD,{className:"h-4 w-4"})]})}),o.jsxs(Bd,{align:"end",children:[o.jsx(N_,{children:"Actions"}),o.jsx(Am,{}),o.jsxs(es,{onClick:n,children:["Activate",o.jsx(v_,{})]})]})]})}}],QFe=(e,t,r)=>[{accessorKey:"ownerRepresentativeName",header:({column:n})=>o.jsx(xT,{column:n,title:"Owner",disableHide:!0}),cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs max-w-sm break-words whitespace-normal leading-tight",children:n.getValue("ownerRepresentativeName")}),size:300},{accessorKey:"vehicleCount",header:({column:n})=>o.jsx(xT,{column:n,title:"No. of Vehicles",disableHide:!0}),cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs text-center",children:n.getValue("vehicleCount")||0}),size:80},{accessorKey:"emailAddress",header:"Email Address",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("emailAddress")||"N/A"})},{accessorKey:"province",header:"Province",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("province")||"N/A"})},{accessorKey:"municipality",header:"Municipality",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("municipality")||"N/A"})},{accessorKey:"barangay",header:"Barangay",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("barangay")||"N/A"})},{accessorKey:"birthDate",header:"Birthdate",cell:({row:n})=>{const a=n.getValue("birthDate");if(!a)return o.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"None"});const c=new Date(a);return isNaN(c.getTime())?o.jsx("div",{className:"text-red-500 text-xs",children:"Invalid Date"}):o.jsx("div",{className:"text-gray-700 dark:text-gray-200 text-xs",children:c.toLocaleDateString()})}},{accessorKey:"hasDriversLicense",header:"Driver's License",cell:({row:n})=>{const a=n.getValue("hasDriversLicense"),c=n.original.driversLicenseNumber;return o.jsx("div",{className:"flex items-center gap-2 flex-nowrap whitespace-nowrap",children:a?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"font-semibold text-green-600 text-xs whitespace-nowrap",children:"Yes"}),c&&o.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap",children:c})]}):o.jsx("span",{className:"font-semibold text-red-600 text-xs whitespace-nowrap",children:"No"})})}},{id:"actions",header:"Action",enableHiding:!1,cell:({row:n})=>{const a=n.original,c=h=>{h.stopPropagation(),e(a._id)};return o.jsx(ur,{variant:"ghost",size:"sm",onClick:c,className:"h-8 w-8 p-0 hover:bg-blue-50 hover:text-blue-600",children:o.jsx(za,{className:"h-4 w-4"})})}}],eze=(e,t,r)=>[{accessorKey:"topNo",header:"TOP NO.",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:n.getValue("topNo")})},{accessorKey:"firstName",header:"Full Name",cell:({row:n})=>{const a=n.getValue("firstName"),c=n.original.middleInitial,h=n.original.lastName,i=n.original.suffix;if((a==="None"||!a)&&(c==="None"||!c)&&(h==="None"||!h)&&(i==="None"||!i))return o.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"None"});const x=[a];return c&&c!=="None"&&x.push(c),h&&h!=="None"&&x.push(h),i&&i!=="None"&&x.push(i),o.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:x.join(" ")})}},{accessorKey:"violations",header:"Violations",cell:({row:n})=>{const a=n.getValue("violations");return o.jsx("div",{className:"max-w-xs text-xs text-gray-900 dark:text-gray-200",children:a&&a.length>0&&a[0]!=="None"?Array.isArray(a)?a.join(", "):a:"None"})}},{accessorKey:"violationType",header:"Type",cell:({row:n})=>{const a=n.getValue("violationType"),c=i=>{switch(i){case"confiscated":return"Confiscated";case"alarm":return"Alarm";case"impounded":return"Impounded";default:return"Unknown"}},h=i=>{switch(i){case"confiscated":return"bg-red-100 text-red-800";case"alarm":return"bg-yellow-100 text-yellow-800";case"impounded":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}};return o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${h(a)}`,children:c(a)})}},{accessorKey:"licenseType",header:"License Type",cell:({row:n})=>{const a=n.getValue("licenseType");return o.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:a&&a!=="None"&&a!=="N/A"?a:"N/A"})}},{accessorKey:"plateNo",header:"Plate No.",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("plateNo")})},{accessorKey:"dateOfApprehension",header:({column:n})=>o.jsx(xT,{column:n,title:"Date of Apprehension"}),cell:({row:n})=>{const a=n.getValue("dateOfApprehension");return o.jsx("div",{className:"text-gray-700 dark:text-gray-200 text-xs",children:a?new Date(a).toLocaleDateString():"None"})}},{accessorKey:"apprehendingOfficer",header:"Officer",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("apprehendingOfficer")||"None"})},{id:"actions",enableHiding:!1,cell:({row:n})=>{const a=n.original,c=h=>{h.stopPropagation(),e(a._id)};return o.jsxs(Yh,{children:[o.jsx(op,{asChild:!0,children:o.jsxs(ur,{variant:"ghost",className:"h-5 w-5 p-0",children:[o.jsx("span",{className:"sr-only",children:"Open menu"}),o.jsx(WD,{className:"h-4 w-4"})]})}),o.jsxs(Bd,{align:"end",className:"w-24",children:[o.jsx(N_,{className:"text-xs py-1",children:"Actions"}),o.jsx(Am,{}),o.jsxs(es,{onClick:c,className:"text-xs py-1",children:[o.jsx(za,{className:"h-3 w-3 mr-2"}),"Edit"]})]})]})}}],tze=(e,t,r)=>[{accessorKey:"plateNo",header:"Plate No.",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:n.getValue("plateNo")})},{accessorKey:"fileNo",header:"File No.",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:n.getValue("fileNo")||"N/A"})},{accessorKey:"engineNo",header:"Engine No.",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:n.getValue("engineNo")||"N/A"})},{accessorKey:"chassisNo",header:"Chassis No.",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:n.getValue("chassisNo")||"N/A"})},{accessorKey:"dateOfRenewal",header:"Date of Renewal",cell:({row:n})=>{const a=n.getValue("dateOfRenewal");if(!a||Array.isArray(a)&&a.length===0)return o.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:"Not set"});const c=Array.isArray(a)?a:[a],h=c[c.length-1],i=(h==null?void 0:h.date)||h;return o.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:[i?new Date(i).toLocaleDateString():"Not set",c.length>1&&o.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",c.length," renewals)"]})]})}},{accessorKey:"classification",header:"Classification",cell:({row:n})=>o.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:n.getValue("classification")||"N/A"})},{accessorKey:"status",header:"Status",cell:({row:n})=>{const a=n.original.status,c=n.original.expirationInfo,h=a==="1"||a===1;return o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 rounded-sm",children:[h?o.jsx(hR,{className:"h-3 w-3 text-green-600"}):o.jsx(Hf,{className:"h-3 w-3 text-red-600"}),o.jsx("span",{className:`text-xs font-medium ${h?"text-green-700":"text-red-700"}`,children:h?"Active":"Expired"})]}),c&&o.jsxs("div",{className:"text-xs text-muted-foreground px-2",children:[o.jsxs("div",{children:["Last 2 digits: ",c.lastTwoDigits]}),o.jsxs("div",{children:[c.week," week of ",c.month]}),c.expirationDate&&o.jsxs("div",{children:["Expires: ",new Date(c.expirationDate).toLocaleDateString()]})]})]})}},{id:"actions",header:"Actions",enableHiding:!1,cell:({row:n})=>{const a=n.original,c=i=>{i.stopPropagation(),e(a._id)},h=i=>{i.stopPropagation(),t(a)};return o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsxs("div",{className:"relative group",children:[o.jsx(ur,{variant:"ghost",size:"sm",onClick:c,className:"h-8 w-8 p-0 text-gray-600 hover:bg-gray-100 hover:text-gray-700",disabled:r,children:o.jsx(za,{className:"h-4 w-4"})}),o.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:"Edit"})]}),o.jsxs("div",{className:"relative group",children:[o.jsx(ur,{variant:"ghost",size:"sm",onClick:h,className:"h-8 w-8 p-0 text-blue-600 hover:bg-blue-50 hover:text-blue-700",disabled:r,children:o.jsx(sv,{className:"h-4 w-4"})}),o.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:"Renew"})]})]})}}],UO=e=>e.charAt(0).toUpperCase()+e.slice(1);/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Hg(e,t){return typeof e=="function"?e(t):e}function Vu(e,t){return r=>{t.setState(n=>({...n,[e]:Hg(r,n[e])}))}}function Bj(e){return e instanceof Function}function rze(e){return Array.isArray(e)&&e.every(t=>typeof t=="number")}function nze(e,t){const r=[],n=a=>{a.forEach(c=>{r.push(c);const h=t(c);h!=null&&h.length&&n(h)})};return n(e),r}function ri(e,t,r){let n=[],a;return c=>{let h;r.key&&r.debug&&(h=Date.now());const i=e(c);if(!(i.length!==n.length||i.some((S,T)=>n[T]!==S)))return a;n=i;let w;if(r.key&&r.debug&&(w=Date.now()),a=t(...i),r==null||r.onChange==null||r.onChange(a),r.key&&r.debug&&r!=null&&r.debug()){const S=Math.round((Date.now()-h)*100)/100,T=Math.round((Date.now()-w)*100)/100,E=T/16,D=(U,I)=>{for(U=String(U);U.length<I;)U=" "+U;return U};console.info(`%c ${D(T,5)} /${D(S,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*E,120))}deg 100% 31%);`,r==null?void 0:r.key)}return a}}function ni(e,t,r,n){return{debug:()=>{var a;return(a=e==null?void 0:e.debugAll)!=null?a:e[t]},key:!1,onChange:n}}function ize(e,t,r,n){const a=()=>{var h;return(h=c.getValue())!=null?h:e.options.renderFallbackValue},c={id:`${t.id}_${r.id}`,row:t,column:r,getValue:()=>t.getValue(n),renderValue:a,getContext:ri(()=>[e,r,t,c],(h,i,x,w)=>({table:h,column:i,row:x,cell:w,getValue:w.getValue,renderValue:w.renderValue}),ni(e.options,"debugCells"))};return e._features.forEach(h=>{h.createCell==null||h.createCell(c,r,t,e)},{}),c}function aze(e,t,r,n){var a,c;const i={...e._getDefaultColumnDef(),...t},x=i.accessorKey;let w=(a=(c=i.id)!=null?c:x?typeof String.prototype.replaceAll=="function"?x.replaceAll(".","_"):x.replace(/\./g,"_"):void 0)!=null?a:typeof i.header=="string"?i.header:void 0,S;if(i.accessorFn?S=i.accessorFn:x&&(x.includes(".")?S=E=>{let D=E;for(const I of x.split(".")){var U;D=(U=D)==null?void 0:U[I]}return D}:S=E=>E[i.accessorKey]),!w)throw new Error;let T={id:`${String(w)}`,accessorFn:S,parent:n,depth:r,columnDef:i,columns:[],getFlatColumns:ri(()=>[!0],()=>{var E;return[T,...(E=T.columns)==null?void 0:E.flatMap(D=>D.getFlatColumns())]},ni(e.options,"debugColumns")),getLeafColumns:ri(()=>[e._getOrderColumnsFn()],E=>{var D;if((D=T.columns)!=null&&D.length){let U=T.columns.flatMap(I=>I.getLeafColumns());return E(U)}return[T]},ni(e.options,"debugColumns"))};for(const E of e._features)E.createColumn==null||E.createColumn(T,e);return T}const Yl="debugHeaders";function OW(e,t,r){var n;let c={id:(n=r.id)!=null?n:t.id,column:t,index:r.index,isPlaceholder:!!r.isPlaceholder,placeholderId:r.placeholderId,depth:r.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const h=[],i=x=>{x.subHeaders&&x.subHeaders.length&&x.subHeaders.map(i),h.push(x)};return i(c),h},getContext:()=>({table:e,header:c,column:t})};return e._features.forEach(h=>{h.createHeader==null||h.createHeader(c,e)}),c}const sze={createTable:e=>{e.getHeaderGroups=ri(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n,a)=>{var c,h;const i=(c=n==null?void 0:n.map(T=>r.find(E=>E.id===T)).filter(Boolean))!=null?c:[],x=(h=a==null?void 0:a.map(T=>r.find(E=>E.id===T)).filter(Boolean))!=null?h:[],w=r.filter(T=>!(n!=null&&n.includes(T.id))&&!(a!=null&&a.includes(T.id)));return oN(t,[...i,...w,...x],e)},ni(e.options,Yl)),e.getCenterHeaderGroups=ri(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n,a)=>(r=r.filter(c=>!(n!=null&&n.includes(c.id))&&!(a!=null&&a.includes(c.id))),oN(t,r,e,"center")),ni(e.options,Yl)),e.getLeftHeaderGroups=ri(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(t,r,n)=>{var a;const c=(a=n==null?void 0:n.map(h=>r.find(i=>i.id===h)).filter(Boolean))!=null?a:[];return oN(t,c,e,"left")},ni(e.options,Yl)),e.getRightHeaderGroups=ri(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(t,r,n)=>{var a;const c=(a=n==null?void 0:n.map(h=>r.find(i=>i.id===h)).filter(Boolean))!=null?a:[];return oN(t,c,e,"right")},ni(e.options,Yl)),e.getFooterGroups=ri(()=>[e.getHeaderGroups()],t=>[...t].reverse(),ni(e.options,Yl)),e.getLeftFooterGroups=ri(()=>[e.getLeftHeaderGroups()],t=>[...t].reverse(),ni(e.options,Yl)),e.getCenterFooterGroups=ri(()=>[e.getCenterHeaderGroups()],t=>[...t].reverse(),ni(e.options,Yl)),e.getRightFooterGroups=ri(()=>[e.getRightHeaderGroups()],t=>[...t].reverse(),ni(e.options,Yl)),e.getFlatHeaders=ri(()=>[e.getHeaderGroups()],t=>t.map(r=>r.headers).flat(),ni(e.options,Yl)),e.getLeftFlatHeaders=ri(()=>[e.getLeftHeaderGroups()],t=>t.map(r=>r.headers).flat(),ni(e.options,Yl)),e.getCenterFlatHeaders=ri(()=>[e.getCenterHeaderGroups()],t=>t.map(r=>r.headers).flat(),ni(e.options,Yl)),e.getRightFlatHeaders=ri(()=>[e.getRightHeaderGroups()],t=>t.map(r=>r.headers).flat(),ni(e.options,Yl)),e.getCenterLeafHeaders=ri(()=>[e.getCenterFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),ni(e.options,Yl)),e.getLeftLeafHeaders=ri(()=>[e.getLeftFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),ni(e.options,Yl)),e.getRightLeafHeaders=ri(()=>[e.getRightFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),ni(e.options,Yl)),e.getLeafHeaders=ri(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(t,r,n)=>{var a,c,h,i,x,w;return[...(a=(c=t[0])==null?void 0:c.headers)!=null?a:[],...(h=(i=r[0])==null?void 0:i.headers)!=null?h:[],...(x=(w=n[0])==null?void 0:w.headers)!=null?x:[]].map(S=>S.getLeafHeaders()).flat()},ni(e.options,Yl))}};function oN(e,t,r,n){var a,c;let h=0;const i=function(E,D){D===void 0&&(D=1),h=Math.max(h,D),E.filter(U=>U.getIsVisible()).forEach(U=>{var I;(I=U.columns)!=null&&I.length&&i(U.columns,D+1)},0)};i(e);let x=[];const w=(E,D)=>{const U={depth:D,id:[n,`${D}`].filter(Boolean).join("_"),headers:[]},I=[];E.forEach(V=>{const H=[...I].reverse()[0],K=V.column.depth===U.depth;let Q,ae=!1;if(K&&V.column.parent?Q=V.column.parent:(Q=V.column,ae=!0),H&&(H==null?void 0:H.column)===Q)H.subHeaders.push(V);else{const ee=OW(r,Q,{id:[n,D,Q.id,V==null?void 0:V.id].filter(Boolean).join("_"),isPlaceholder:ae,placeholderId:ae?`${I.filter(se=>se.column===Q).length}`:void 0,depth:D,index:I.length});ee.subHeaders.push(V),I.push(ee)}U.headers.push(V),V.headerGroup=U}),x.push(U),D>0&&w(I,D-1)},S=t.map((E,D)=>OW(r,E,{depth:h,index:D}));w(S,h-1),x.reverse();const T=E=>E.filter(U=>U.column.getIsVisible()).map(U=>{let I=0,V=0,H=[0];U.subHeaders&&U.subHeaders.length?(H=[],T(U.subHeaders).forEach(Q=>{let{colSpan:ae,rowSpan:ee}=Q;I+=ae,H.push(ee)})):I=1;const K=Math.min(...H);return V=V+K,U.colSpan=I,U.rowSpan=V,{colSpan:I,rowSpan:V}});return T((a=(c=x[0])==null?void 0:c.headers)!=null?a:[]),x}const HD=(e,t,r,n,a,c,h)=>{let i={id:t,index:n,original:r,depth:a,parentId:h,_valuesCache:{},_uniqueValuesCache:{},getValue:x=>{if(i._valuesCache.hasOwnProperty(x))return i._valuesCache[x];const w=e.getColumn(x);if(w!=null&&w.accessorFn)return i._valuesCache[x]=w.accessorFn(i.original,n),i._valuesCache[x]},getUniqueValues:x=>{if(i._uniqueValuesCache.hasOwnProperty(x))return i._uniqueValuesCache[x];const w=e.getColumn(x);if(w!=null&&w.accessorFn)return w.columnDef.getUniqueValues?(i._uniqueValuesCache[x]=w.columnDef.getUniqueValues(i.original,n),i._uniqueValuesCache[x]):(i._uniqueValuesCache[x]=[i.getValue(x)],i._uniqueValuesCache[x])},renderValue:x=>{var w;return(w=i.getValue(x))!=null?w:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>nze(i.subRows,x=>x.subRows),getParentRow:()=>i.parentId?e.getRow(i.parentId,!0):void 0,getParentRows:()=>{let x=[],w=i;for(;;){const S=w.getParentRow();if(!S)break;x.push(S),w=S}return x.reverse()},getAllCells:ri(()=>[e.getAllLeafColumns()],x=>x.map(w=>ize(e,i,w,w.id)),ni(e.options,"debugRows")),_getAllCellsByColumnId:ri(()=>[i.getAllCells()],x=>x.reduce((w,S)=>(w[S.column.id]=S,w),{}),ni(e.options,"debugRows"))};for(let x=0;x<e._features.length;x++){const w=e._features[x];w==null||w.createRow==null||w.createRow(i,e)}return i},oze={createColumn:(e,t)=>{e._getFacetedRowModel=t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():t.getPreFilteredRowModel(),e._getFacetedUniqueValues=t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},Dne=(e,t,r)=>{var n,a;const c=r==null||(n=r.toString())==null?void 0:n.toLowerCase();return!!(!((a=e.getValue(t))==null||(a=a.toString())==null||(a=a.toLowerCase())==null)&&a.includes(c))};Dne.autoRemove=e=>Gh(e);const Fne=(e,t,r)=>{var n;return!!(!((n=e.getValue(t))==null||(n=n.toString())==null)&&n.includes(r))};Fne.autoRemove=e=>Gh(e);const zne=(e,t,r)=>{var n;return((n=e.getValue(t))==null||(n=n.toString())==null?void 0:n.toLowerCase())===(r==null?void 0:r.toLowerCase())};zne.autoRemove=e=>Gh(e);const Bne=(e,t,r)=>{var n;return(n=e.getValue(t))==null?void 0:n.includes(r)};Bne.autoRemove=e=>Gh(e);const Vne=(e,t,r)=>!r.some(n=>{var a;return!((a=e.getValue(t))!=null&&a.includes(n))});Vne.autoRemove=e=>Gh(e)||!(e!=null&&e.length);const Une=(e,t,r)=>r.some(n=>{var a;return(a=e.getValue(t))==null?void 0:a.includes(n)});Une.autoRemove=e=>Gh(e)||!(e!=null&&e.length);const $ne=(e,t,r)=>e.getValue(t)===r;$ne.autoRemove=e=>Gh(e);const qne=(e,t,r)=>e.getValue(t)==r;qne.autoRemove=e=>Gh(e);const KD=(e,t,r)=>{let[n,a]=r;const c=e.getValue(t);return c>=n&&c<=a};KD.resolveFilterValue=e=>{let[t,r]=e,n=typeof t!="number"?parseFloat(t):t,a=typeof r!="number"?parseFloat(r):r,c=t===null||Number.isNaN(n)?-1/0:n,h=r===null||Number.isNaN(a)?1/0:a;if(c>h){const i=c;c=h,h=i}return[c,h]};KD.autoRemove=e=>Gh(e)||Gh(e[0])&&Gh(e[1]);const hm={includesString:Dne,includesStringSensitive:Fne,equalsString:zne,arrIncludes:Bne,arrIncludesAll:Vne,arrIncludesSome:Une,equals:$ne,weakEquals:qne,inNumberRange:KD};function Gh(e){return e==null||e===""}const lze={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:Vu("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,t)=>{e.getAutoFilterFn=()=>{const r=t.getCoreRowModel().flatRows[0],n=r==null?void 0:r.getValue(e.id);return typeof n=="string"?hm.includesString:typeof n=="number"?hm.inNumberRange:typeof n=="boolean"||n!==null&&typeof n=="object"?hm.equals:Array.isArray(n)?hm.arrIncludes:hm.weakEquals},e.getFilterFn=()=>{var r,n;return Bj(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(r=(n=t.options.filterFns)==null?void 0:n[e.columnDef.filterFn])!=null?r:hm[e.columnDef.filterFn]},e.getCanFilter=()=>{var r,n,a;return((r=e.columnDef.enableColumnFilter)!=null?r:!0)&&((n=t.options.enableColumnFilters)!=null?n:!0)&&((a=t.options.enableFilters)!=null?a:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var r;return(r=t.getState().columnFilters)==null||(r=r.find(n=>n.id===e.id))==null?void 0:r.value},e.getFilterIndex=()=>{var r,n;return(r=(n=t.getState().columnFilters)==null?void 0:n.findIndex(a=>a.id===e.id))!=null?r:-1},e.setFilterValue=r=>{t.setColumnFilters(n=>{const a=e.getFilterFn(),c=n==null?void 0:n.find(S=>S.id===e.id),h=Hg(r,c?c.value:void 0);if(RW(a,h,e)){var i;return(i=n==null?void 0:n.filter(S=>S.id!==e.id))!=null?i:[]}const x={id:e.id,value:h};if(c){var w;return(w=n==null?void 0:n.map(S=>S.id===e.id?x:S))!=null?w:[]}return n!=null&&n.length?[...n,x]:[x]})}},createRow:(e,t)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=t=>{const r=e.getAllLeafColumns(),n=a=>{var c;return(c=Hg(t,a))==null?void 0:c.filter(h=>{const i=r.find(x=>x.id===h.id);if(i){const x=i.getFilterFn();if(RW(x,h.value,i))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(n)},e.resetColumnFilters=t=>{var r,n;e.setColumnFilters(t?[]:(r=(n=e.initialState)==null?void 0:n.columnFilters)!=null?r:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function RW(e,t,r){return(e&&e.autoRemove?e.autoRemove(t,r):!1)||typeof t>"u"||typeof t=="string"&&!t}const cze=(e,t,r)=>r.reduce((n,a)=>{const c=a.getValue(e);return n+(typeof c=="number"?c:0)},0),uze=(e,t,r)=>{let n;return r.forEach(a=>{const c=a.getValue(e);c!=null&&(n>c||n===void 0&&c>=c)&&(n=c)}),n},dze=(e,t,r)=>{let n;return r.forEach(a=>{const c=a.getValue(e);c!=null&&(n<c||n===void 0&&c>=c)&&(n=c)}),n},hze=(e,t,r)=>{let n,a;return r.forEach(c=>{const h=c.getValue(e);h!=null&&(n===void 0?h>=h&&(n=a=h):(n>h&&(n=h),a<h&&(a=h)))}),[n,a]},fze=(e,t)=>{let r=0,n=0;if(t.forEach(a=>{let c=a.getValue(e);c!=null&&(c=+c)>=c&&(++r,n+=c)}),r)return n/r},pze=(e,t)=>{if(!t.length)return;const r=t.map(c=>c.getValue(e));if(!rze(r))return;if(r.length===1)return r[0];const n=Math.floor(r.length/2),a=r.sort((c,h)=>c-h);return r.length%2!==0?a[n]:(a[n-1]+a[n])/2},mze=(e,t)=>Array.from(new Set(t.map(r=>r.getValue(e))).values()),gze=(e,t)=>new Set(t.map(r=>r.getValue(e))).size,yze=(e,t)=>t.length,$O={sum:cze,min:uze,max:dze,extent:hze,mean:fze,median:pze,unique:mze,uniqueCount:gze,count:yze},xze={getDefaultColumnDef:()=>({aggregatedCell:e=>{var t,r;return(t=(r=e.getValue())==null||r.toString==null?void 0:r.toString())!=null?t:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:Vu("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,t)=>{e.toggleGrouping=()=>{t.setGrouping(r=>r!=null&&r.includes(e.id)?r.filter(n=>n!==e.id):[...r??[],e.id])},e.getCanGroup=()=>{var r,n;return((r=e.columnDef.enableGrouping)!=null?r:!0)&&((n=t.options.enableGrouping)!=null?n:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var r;return(r=t.getState().grouping)==null?void 0:r.includes(e.id)},e.getGroupedIndex=()=>{var r;return(r=t.getState().grouping)==null?void 0:r.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const r=e.getCanGroup();return()=>{r&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const r=t.getCoreRowModel().flatRows[0],n=r==null?void 0:r.getValue(e.id);if(typeof n=="number")return $O.sum;if(Object.prototype.toString.call(n)==="[object Date]")return $O.extent},e.getAggregationFn=()=>{var r,n;if(!e)throw new Error;return Bj(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(r=(n=t.options.aggregationFns)==null?void 0:n[e.columnDef.aggregationFn])!=null?r:$O[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=t=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(t),e.resetGrouping=t=>{var r,n;e.setGrouping(t?[]:(r=(n=e.initialState)==null?void 0:n.grouping)!=null?r:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,t)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=r=>{if(e._groupingValuesCache.hasOwnProperty(r))return e._groupingValuesCache[r];const n=t.getColumn(r);return n!=null&&n.columnDef.getGroupingValue?(e._groupingValuesCache[r]=n.columnDef.getGroupingValue(e.original),e._groupingValuesCache[r]):e.getValue(r)},e._groupingValuesCache={}},createCell:(e,t,r,n)=>{e.getIsGrouped=()=>t.getIsGrouped()&&t.id===r.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&t.getIsGrouped(),e.getIsAggregated=()=>{var a;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((a=r.subRows)!=null&&a.length)}}};function vze(e,t,r){if(!(t!=null&&t.length)||!r)return e;const n=e.filter(c=>!t.includes(c.id));return r==="remove"?n:[...t.map(c=>e.find(h=>h.id===c)).filter(Boolean),...n]}const _ze={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:Vu("columnOrder",e)}),createColumn:(e,t)=>{e.getIndex=ri(r=>[A1(t,r)],r=>r.findIndex(n=>n.id===e.id),ni(t.options,"debugColumns")),e.getIsFirstColumn=r=>{var n;return((n=A1(t,r)[0])==null?void 0:n.id)===e.id},e.getIsLastColumn=r=>{var n;const a=A1(t,r);return((n=a[a.length-1])==null?void 0:n.id)===e.id}},createTable:e=>{e.setColumnOrder=t=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(t),e.resetColumnOrder=t=>{var r;e.setColumnOrder(t?[]:(r=e.initialState.columnOrder)!=null?r:[])},e._getOrderColumnsFn=ri(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(t,r,n)=>a=>{let c=[];if(!(t!=null&&t.length))c=a;else{const h=[...t],i=[...a];for(;i.length&&h.length;){const x=h.shift(),w=i.findIndex(S=>S.id===x);w>-1&&c.push(i.splice(w,1)[0])}c=[...c,...i]}return vze(c,r,n)},ni(e.options,"debugTable"))}},qO=()=>({left:[],right:[]}),bze={getInitialState:e=>({columnPinning:qO(),...e}),getDefaultOptions:e=>({onColumnPinningChange:Vu("columnPinning",e)}),createColumn:(e,t)=>{e.pin=r=>{const n=e.getLeafColumns().map(a=>a.id).filter(Boolean);t.setColumnPinning(a=>{var c,h;if(r==="right"){var i,x;return{left:((i=a==null?void 0:a.left)!=null?i:[]).filter(T=>!(n!=null&&n.includes(T))),right:[...((x=a==null?void 0:a.right)!=null?x:[]).filter(T=>!(n!=null&&n.includes(T))),...n]}}if(r==="left"){var w,S;return{left:[...((w=a==null?void 0:a.left)!=null?w:[]).filter(T=>!(n!=null&&n.includes(T))),...n],right:((S=a==null?void 0:a.right)!=null?S:[]).filter(T=>!(n!=null&&n.includes(T)))}}return{left:((c=a==null?void 0:a.left)!=null?c:[]).filter(T=>!(n!=null&&n.includes(T))),right:((h=a==null?void 0:a.right)!=null?h:[]).filter(T=>!(n!=null&&n.includes(T)))}})},e.getCanPin=()=>e.getLeafColumns().some(n=>{var a,c,h;return((a=n.columnDef.enablePinning)!=null?a:!0)&&((c=(h=t.options.enableColumnPinning)!=null?h:t.options.enablePinning)!=null?c:!0)}),e.getIsPinned=()=>{const r=e.getLeafColumns().map(i=>i.id),{left:n,right:a}=t.getState().columnPinning,c=r.some(i=>n==null?void 0:n.includes(i)),h=r.some(i=>a==null?void 0:a.includes(i));return c?"left":h?"right":!1},e.getPinnedIndex=()=>{var r,n;const a=e.getIsPinned();return a?(r=(n=t.getState().columnPinning)==null||(n=n[a])==null?void 0:n.indexOf(e.id))!=null?r:-1:0}},createRow:(e,t)=>{e.getCenterVisibleCells=ri(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,t.getState().columnPinning.right],(r,n,a)=>{const c=[...n??[],...a??[]];return r.filter(h=>!c.includes(h.column.id))},ni(t.options,"debugRows")),e.getLeftVisibleCells=ri(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left],(r,n)=>(n??[]).map(c=>r.find(h=>h.column.id===c)).filter(Boolean).map(c=>({...c,position:"left"})),ni(t.options,"debugRows")),e.getRightVisibleCells=ri(()=>[e._getAllVisibleCells(),t.getState().columnPinning.right],(r,n)=>(n??[]).map(c=>r.find(h=>h.column.id===c)).filter(Boolean).map(c=>({...c,position:"right"})),ni(t.options,"debugRows"))},createTable:e=>{e.setColumnPinning=t=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(t),e.resetColumnPinning=t=>{var r,n;return e.setColumnPinning(t?qO():(r=(n=e.initialState)==null?void 0:n.columnPinning)!=null?r:qO())},e.getIsSomeColumnsPinned=t=>{var r;const n=e.getState().columnPinning;if(!t){var a,c;return!!((a=n.left)!=null&&a.length||(c=n.right)!=null&&c.length)}return!!((r=n[t])!=null&&r.length)},e.getLeftLeafColumns=ri(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(t,r)=>(r??[]).map(n=>t.find(a=>a.id===n)).filter(Boolean),ni(e.options,"debugColumns")),e.getRightLeafColumns=ri(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(t,r)=>(r??[]).map(n=>t.find(a=>a.id===n)).filter(Boolean),ni(e.options,"debugColumns")),e.getCenterLeafColumns=ri(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n)=>{const a=[...r??[],...n??[]];return t.filter(c=>!a.includes(c.id))},ni(e.options,"debugColumns"))}},lN={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},GO=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),wze={getDefaultColumnDef:()=>lN,getInitialState:e=>({columnSizing:{},columnSizingInfo:GO(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:Vu("columnSizing",e),onColumnSizingInfoChange:Vu("columnSizingInfo",e)}),createColumn:(e,t)=>{e.getSize=()=>{var r,n,a;const c=t.getState().columnSizing[e.id];return Math.min(Math.max((r=e.columnDef.minSize)!=null?r:lN.minSize,(n=c??e.columnDef.size)!=null?n:lN.size),(a=e.columnDef.maxSize)!=null?a:lN.maxSize)},e.getStart=ri(r=>[r,A1(t,r),t.getState().columnSizing],(r,n)=>n.slice(0,e.getIndex(r)).reduce((a,c)=>a+c.getSize(),0),ni(t.options,"debugColumns")),e.getAfter=ri(r=>[r,A1(t,r),t.getState().columnSizing],(r,n)=>n.slice(e.getIndex(r)+1).reduce((a,c)=>a+c.getSize(),0),ni(t.options,"debugColumns")),e.resetSize=()=>{t.setColumnSizing(r=>{let{[e.id]:n,...a}=r;return a})},e.getCanResize=()=>{var r,n;return((r=e.columnDef.enableResizing)!=null?r:!0)&&((n=t.options.enableColumnResizing)!=null?n:!0)},e.getIsResizing=()=>t.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,t)=>{e.getSize=()=>{let r=0;const n=a=>{if(a.subHeaders.length)a.subHeaders.forEach(n);else{var c;r+=(c=a.column.getSize())!=null?c:0}};return n(e),r},e.getStart=()=>{if(e.index>0){const r=e.headerGroup.headers[e.index-1];return r.getStart()+r.getSize()}return 0},e.getResizeHandler=r=>{const n=t.getColumn(e.column.id),a=n==null?void 0:n.getCanResize();return c=>{if(!n||!a||(c.persist==null||c.persist(),WO(c)&&c.touches&&c.touches.length>1))return;const h=e.getSize(),i=e?e.getLeafHeaders().map(H=>[H.column.id,H.column.getSize()]):[[n.id,n.getSize()]],x=WO(c)?Math.round(c.touches[0].clientX):c.clientX,w={},S=(H,K)=>{typeof K=="number"&&(t.setColumnSizingInfo(Q=>{var ae,ee;const se=t.options.columnResizeDirection==="rtl"?-1:1,ue=(K-((ae=Q==null?void 0:Q.startOffset)!=null?ae:0))*se,he=Math.max(ue/((ee=Q==null?void 0:Q.startSize)!=null?ee:0),-.999999);return Q.columnSizingStart.forEach(Ce=>{let[Ne,me]=Ce;w[Ne]=Math.round(Math.max(me+me*he,0)*100)/100}),{...Q,deltaOffset:ue,deltaPercentage:he}}),(t.options.columnResizeMode==="onChange"||H==="end")&&t.setColumnSizing(Q=>({...Q,...w})))},T=H=>S("move",H),E=H=>{S("end",H),t.setColumnSizingInfo(K=>({...K,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},D=r||typeof document<"u"?document:null,U={moveHandler:H=>T(H.clientX),upHandler:H=>{D==null||D.removeEventListener("mousemove",U.moveHandler),D==null||D.removeEventListener("mouseup",U.upHandler),E(H.clientX)}},I={moveHandler:H=>(H.cancelable&&(H.preventDefault(),H.stopPropagation()),T(H.touches[0].clientX),!1),upHandler:H=>{var K;D==null||D.removeEventListener("touchmove",I.moveHandler),D==null||D.removeEventListener("touchend",I.upHandler),H.cancelable&&(H.preventDefault(),H.stopPropagation()),E((K=H.touches[0])==null?void 0:K.clientX)}},V=Sze()?{passive:!1}:!1;WO(c)?(D==null||D.addEventListener("touchmove",I.moveHandler,V),D==null||D.addEventListener("touchend",I.upHandler,V)):(D==null||D.addEventListener("mousemove",U.moveHandler,V),D==null||D.addEventListener("mouseup",U.upHandler,V)),t.setColumnSizingInfo(H=>({...H,startOffset:x,startSize:h,deltaOffset:0,deltaPercentage:0,columnSizingStart:i,isResizingColumn:n.id}))}}},createTable:e=>{e.setColumnSizing=t=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(t),e.setColumnSizingInfo=t=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(t),e.resetColumnSizing=t=>{var r;e.setColumnSizing(t?{}:(r=e.initialState.columnSizing)!=null?r:{})},e.resetHeaderSizeInfo=t=>{var r;e.setColumnSizingInfo(t?GO():(r=e.initialState.columnSizingInfo)!=null?r:GO())},e.getTotalSize=()=>{var t,r;return(t=(r=e.getHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0},e.getLeftTotalSize=()=>{var t,r;return(t=(r=e.getLeftHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0},e.getCenterTotalSize=()=>{var t,r;return(t=(r=e.getCenterHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0},e.getRightTotalSize=()=>{var t,r;return(t=(r=e.getRightHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0}}};let cN=null;function Sze(){if(typeof cN=="boolean")return cN;let e=!1;try{const t={get passive(){return e=!0,!1}},r=()=>{};window.addEventListener("test",r,t),window.removeEventListener("test",r)}catch{e=!1}return cN=e,cN}function WO(e){return e.type==="touchstart"}const Nze={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:Vu("columnVisibility",e)}),createColumn:(e,t)=>{e.toggleVisibility=r=>{e.getCanHide()&&t.setColumnVisibility(n=>({...n,[e.id]:r??!e.getIsVisible()}))},e.getIsVisible=()=>{var r,n;const a=e.columns;return(r=a.length?a.some(c=>c.getIsVisible()):(n=t.getState().columnVisibility)==null?void 0:n[e.id])!=null?r:!0},e.getCanHide=()=>{var r,n;return((r=e.columnDef.enableHiding)!=null?r:!0)&&((n=t.options.enableHiding)!=null?n:!0)},e.getToggleVisibilityHandler=()=>r=>{e.toggleVisibility==null||e.toggleVisibility(r.target.checked)}},createRow:(e,t)=>{e._getAllVisibleCells=ri(()=>[e.getAllCells(),t.getState().columnVisibility],r=>r.filter(n=>n.column.getIsVisible()),ni(t.options,"debugRows")),e.getVisibleCells=ri(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(r,n,a)=>[...r,...n,...a],ni(t.options,"debugRows"))},createTable:e=>{const t=(r,n)=>ri(()=>[n(),n().filter(a=>a.getIsVisible()).map(a=>a.id).join("_")],a=>a.filter(c=>c.getIsVisible==null?void 0:c.getIsVisible()),ni(e.options,"debugColumns"));e.getVisibleFlatColumns=t("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=t("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=t("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=t("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=t("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=r=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(r),e.resetColumnVisibility=r=>{var n;e.setColumnVisibility(r?{}:(n=e.initialState.columnVisibility)!=null?n:{})},e.toggleAllColumnsVisible=r=>{var n;r=(n=r)!=null?n:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((a,c)=>({...a,[c.id]:r||!(c.getCanHide!=null&&c.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(r=>!(r.getIsVisible!=null&&r.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(r=>r.getIsVisible==null?void 0:r.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>r=>{var n;e.toggleAllColumnsVisible((n=r.target)==null?void 0:n.checked)}}};function A1(e,t){return t?t==="center"?e.getCenterVisibleLeafColumns():t==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const Aze={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},Tze={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:Vu("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:t=>{var r;const n=(r=e.getCoreRowModel().flatRows[0])==null||(r=r._getAllCellsByColumnId()[t.id])==null?void 0:r.getValue();return typeof n=="string"||typeof n=="number"}}),createColumn:(e,t)=>{e.getCanGlobalFilter=()=>{var r,n,a,c;return((r=e.columnDef.enableGlobalFilter)!=null?r:!0)&&((n=t.options.enableGlobalFilter)!=null?n:!0)&&((a=t.options.enableFilters)!=null?a:!0)&&((c=t.options.getColumnCanGlobalFilter==null?void 0:t.options.getColumnCanGlobalFilter(e))!=null?c:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>hm.includesString,e.getGlobalFilterFn=()=>{var t,r;const{globalFilterFn:n}=e.options;return Bj(n)?n:n==="auto"?e.getGlobalAutoFilterFn():(t=(r=e.options.filterFns)==null?void 0:r[n])!=null?t:hm[n]},e.setGlobalFilter=t=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(t)},e.resetGlobalFilter=t=>{e.setGlobalFilter(t?void 0:e.initialState.globalFilter)}}},jze={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:Vu("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let t=!1,r=!1;e._autoResetExpanded=()=>{var n,a;if(!t){e._queue(()=>{t=!0});return}if((n=(a=e.options.autoResetAll)!=null?a:e.options.autoResetExpanded)!=null?n:!e.options.manualExpanding){if(r)return;r=!0,e._queue(()=>{e.resetExpanded(),r=!1})}},e.setExpanded=n=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(n),e.toggleAllRowsExpanded=n=>{n??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=n=>{var a,c;e.setExpanded(n?{}:(a=(c=e.initialState)==null?void 0:c.expanded)!=null?a:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(n=>n.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>n=>{n.persist==null||n.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const n=e.getState().expanded;return n===!0||Object.values(n).some(Boolean)},e.getIsAllRowsExpanded=()=>{const n=e.getState().expanded;return typeof n=="boolean"?n===!0:!(!Object.keys(n).length||e.getRowModel().flatRows.some(a=>!a.getIsExpanded()))},e.getExpandedDepth=()=>{let n=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(c=>{const h=c.split(".");n=Math.max(n,h.length)}),n},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,t)=>{e.toggleExpanded=r=>{t.setExpanded(n=>{var a;const c=n===!0?!0:!!(n!=null&&n[e.id]);let h={};if(n===!0?Object.keys(t.getRowModel().rowsById).forEach(i=>{h[i]=!0}):h=n,r=(a=r)!=null?a:!c,!c&&r)return{...h,[e.id]:!0};if(c&&!r){const{[e.id]:i,...x}=h;return x}return n})},e.getIsExpanded=()=>{var r;const n=t.getState().expanded;return!!((r=t.options.getIsRowExpanded==null?void 0:t.options.getIsRowExpanded(e))!=null?r:n===!0||n!=null&&n[e.id])},e.getCanExpand=()=>{var r,n,a;return(r=t.options.getRowCanExpand==null?void 0:t.options.getRowCanExpand(e))!=null?r:((n=t.options.enableExpanding)!=null?n:!0)&&!!((a=e.subRows)!=null&&a.length)},e.getIsAllParentsExpanded=()=>{let r=!0,n=e;for(;r&&n.parentId;)n=t.getRow(n.parentId,!0),r=n.getIsExpanded();return r},e.getToggleExpandedHandler=()=>{const r=e.getCanExpand();return()=>{r&&e.toggleExpanded()}}}},L3=0,D3=10,HO=()=>({pageIndex:L3,pageSize:D3}),kze={getInitialState:e=>({...e,pagination:{...HO(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:Vu("pagination",e)}),createTable:e=>{let t=!1,r=!1;e._autoResetPageIndex=()=>{var n,a;if(!t){e._queue(()=>{t=!0});return}if((n=(a=e.options.autoResetAll)!=null?a:e.options.autoResetPageIndex)!=null?n:!e.options.manualPagination){if(r)return;r=!0,e._queue(()=>{e.resetPageIndex(),r=!1})}},e.setPagination=n=>{const a=c=>Hg(n,c);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(a)},e.resetPagination=n=>{var a;e.setPagination(n?HO():(a=e.initialState.pagination)!=null?a:HO())},e.setPageIndex=n=>{e.setPagination(a=>{let c=Hg(n,a.pageIndex);const h=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return c=Math.max(0,Math.min(c,h)),{...a,pageIndex:c}})},e.resetPageIndex=n=>{var a,c;e.setPageIndex(n?L3:(a=(c=e.initialState)==null||(c=c.pagination)==null?void 0:c.pageIndex)!=null?a:L3)},e.resetPageSize=n=>{var a,c;e.setPageSize(n?D3:(a=(c=e.initialState)==null||(c=c.pagination)==null?void 0:c.pageSize)!=null?a:D3)},e.setPageSize=n=>{e.setPagination(a=>{const c=Math.max(1,Hg(n,a.pageSize)),h=a.pageSize*a.pageIndex,i=Math.floor(h/c);return{...a,pageIndex:i,pageSize:c}})},e.setPageCount=n=>e.setPagination(a=>{var c;let h=Hg(n,(c=e.options.pageCount)!=null?c:-1);return typeof h=="number"&&(h=Math.max(-1,h)),{...a,pageCount:h}}),e.getPageOptions=ri(()=>[e.getPageCount()],n=>{let a=[];return n&&n>0&&(a=[...new Array(n)].fill(null).map((c,h)=>h)),a},ni(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:n}=e.getState().pagination,a=e.getPageCount();return a===-1?!0:a===0?!1:n<a-1},e.previousPage=()=>e.setPageIndex(n=>n-1),e.nextPage=()=>e.setPageIndex(n=>n+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var n;return(n=e.options.pageCount)!=null?n:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var n;return(n=e.options.rowCount)!=null?n:e.getPrePaginationRowModel().rows.length}}},KO=()=>({top:[],bottom:[]}),Pze={getInitialState:e=>({rowPinning:KO(),...e}),getDefaultOptions:e=>({onRowPinningChange:Vu("rowPinning",e)}),createRow:(e,t)=>{e.pin=(r,n,a)=>{const c=n?e.getLeafRows().map(x=>{let{id:w}=x;return w}):[],h=a?e.getParentRows().map(x=>{let{id:w}=x;return w}):[],i=new Set([...h,e.id,...c]);t.setRowPinning(x=>{var w,S;if(r==="bottom"){var T,E;return{top:((T=x==null?void 0:x.top)!=null?T:[]).filter(I=>!(i!=null&&i.has(I))),bottom:[...((E=x==null?void 0:x.bottom)!=null?E:[]).filter(I=>!(i!=null&&i.has(I))),...Array.from(i)]}}if(r==="top"){var D,U;return{top:[...((D=x==null?void 0:x.top)!=null?D:[]).filter(I=>!(i!=null&&i.has(I))),...Array.from(i)],bottom:((U=x==null?void 0:x.bottom)!=null?U:[]).filter(I=>!(i!=null&&i.has(I)))}}return{top:((w=x==null?void 0:x.top)!=null?w:[]).filter(I=>!(i!=null&&i.has(I))),bottom:((S=x==null?void 0:x.bottom)!=null?S:[]).filter(I=>!(i!=null&&i.has(I)))}})},e.getCanPin=()=>{var r;const{enableRowPinning:n,enablePinning:a}=t.options;return typeof n=="function"?n(e):(r=n??a)!=null?r:!0},e.getIsPinned=()=>{const r=[e.id],{top:n,bottom:a}=t.getState().rowPinning,c=r.some(i=>n==null?void 0:n.includes(i)),h=r.some(i=>a==null?void 0:a.includes(i));return c?"top":h?"bottom":!1},e.getPinnedIndex=()=>{var r,n;const a=e.getIsPinned();if(!a)return-1;const c=(r=a==="top"?t.getTopRows():t.getBottomRows())==null?void 0:r.map(h=>{let{id:i}=h;return i});return(n=c==null?void 0:c.indexOf(e.id))!=null?n:-1}},createTable:e=>{e.setRowPinning=t=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(t),e.resetRowPinning=t=>{var r,n;return e.setRowPinning(t?KO():(r=(n=e.initialState)==null?void 0:n.rowPinning)!=null?r:KO())},e.getIsSomeRowsPinned=t=>{var r;const n=e.getState().rowPinning;if(!t){var a,c;return!!((a=n.top)!=null&&a.length||(c=n.bottom)!=null&&c.length)}return!!((r=n[t])!=null&&r.length)},e._getPinnedRows=(t,r,n)=>{var a;return((a=e.options.keepPinnedRows)==null||a?(r??[]).map(h=>{const i=e.getRow(h,!0);return i.getIsAllParentsExpanded()?i:null}):(r??[]).map(h=>t.find(i=>i.id===h))).filter(Boolean).map(h=>({...h,position:n}))},e.getTopRows=ri(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(t,r)=>e._getPinnedRows(t,r,"top"),ni(e.options,"debugRows")),e.getBottomRows=ri(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(t,r)=>e._getPinnedRows(t,r,"bottom"),ni(e.options,"debugRows")),e.getCenterRows=ri(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(t,r,n)=>{const a=new Set([...r??[],...n??[]]);return t.filter(c=>!a.has(c.id))},ni(e.options,"debugRows"))}},Cze={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:Vu("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=t=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(t),e.resetRowSelection=t=>{var r;return e.setRowSelection(t?{}:(r=e.initialState.rowSelection)!=null?r:{})},e.toggleAllRowsSelected=t=>{e.setRowSelection(r=>{t=typeof t<"u"?t:!e.getIsAllRowsSelected();const n={...r},a=e.getPreGroupedRowModel().flatRows;return t?a.forEach(c=>{c.getCanSelect()&&(n[c.id]=!0)}):a.forEach(c=>{delete n[c.id]}),n})},e.toggleAllPageRowsSelected=t=>e.setRowSelection(r=>{const n=typeof t<"u"?t:!e.getIsAllPageRowsSelected(),a={...r};return e.getRowModel().rows.forEach(c=>{F3(a,c.id,n,!0,e)}),a}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=ri(()=>[e.getState().rowSelection,e.getCoreRowModel()],(t,r)=>Object.keys(t).length?ZO(e,r):{rows:[],flatRows:[],rowsById:{}},ni(e.options,"debugTable")),e.getFilteredSelectedRowModel=ri(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(t,r)=>Object.keys(t).length?ZO(e,r):{rows:[],flatRows:[],rowsById:{}},ni(e.options,"debugTable")),e.getGroupedSelectedRowModel=ri(()=>[e.getState().rowSelection,e.getSortedRowModel()],(t,r)=>Object.keys(t).length?ZO(e,r):{rows:[],flatRows:[],rowsById:{}},ni(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const t=e.getFilteredRowModel().flatRows,{rowSelection:r}=e.getState();let n=!!(t.length&&Object.keys(r).length);return n&&t.some(a=>a.getCanSelect()&&!r[a.id])&&(n=!1),n},e.getIsAllPageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows.filter(a=>a.getCanSelect()),{rowSelection:r}=e.getState();let n=!!t.length;return n&&t.some(a=>!r[a.id])&&(n=!1),n},e.getIsSomeRowsSelected=()=>{var t;const r=Object.keys((t=e.getState().rowSelection)!=null?t:{}).length;return r>0&&r<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:t.filter(r=>r.getCanSelect()).some(r=>r.getIsSelected()||r.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>t=>{e.toggleAllRowsSelected(t.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>t=>{e.toggleAllPageRowsSelected(t.target.checked)}},createRow:(e,t)=>{e.toggleSelected=(r,n)=>{const a=e.getIsSelected();t.setRowSelection(c=>{var h;if(r=typeof r<"u"?r:!a,e.getCanSelect()&&a===r)return c;const i={...c};return F3(i,e.id,r,(h=n==null?void 0:n.selectChildren)!=null?h:!0,t),i})},e.getIsSelected=()=>{const{rowSelection:r}=t.getState();return ZD(e,r)},e.getIsSomeSelected=()=>{const{rowSelection:r}=t.getState();return z3(e,r)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:r}=t.getState();return z3(e,r)==="all"},e.getCanSelect=()=>{var r;return typeof t.options.enableRowSelection=="function"?t.options.enableRowSelection(e):(r=t.options.enableRowSelection)!=null?r:!0},e.getCanSelectSubRows=()=>{var r;return typeof t.options.enableSubRowSelection=="function"?t.options.enableSubRowSelection(e):(r=t.options.enableSubRowSelection)!=null?r:!0},e.getCanMultiSelect=()=>{var r;return typeof t.options.enableMultiRowSelection=="function"?t.options.enableMultiRowSelection(e):(r=t.options.enableMultiRowSelection)!=null?r:!0},e.getToggleSelectedHandler=()=>{const r=e.getCanSelect();return n=>{var a;r&&e.toggleSelected((a=n.target)==null?void 0:a.checked)}}}},F3=(e,t,r,n,a)=>{var c;const h=a.getRow(t,!0);r?(h.getCanMultiSelect()||Object.keys(e).forEach(i=>delete e[i]),h.getCanSelect()&&(e[t]=!0)):delete e[t],n&&(c=h.subRows)!=null&&c.length&&h.getCanSelectSubRows()&&h.subRows.forEach(i=>F3(e,i.id,r,n,a))};function ZO(e,t){const r=e.getState().rowSelection,n=[],a={},c=function(h,i){return h.map(x=>{var w;const S=ZD(x,r);if(S&&(n.push(x),a[x.id]=x),(w=x.subRows)!=null&&w.length&&(x={...x,subRows:c(x.subRows)}),S)return x}).filter(Boolean)};return{rows:c(t.rows),flatRows:n,rowsById:a}}function ZD(e,t){var r;return(r=t[e.id])!=null?r:!1}function z3(e,t,r){var n;if(!((n=e.subRows)!=null&&n.length))return!1;let a=!0,c=!1;return e.subRows.forEach(h=>{if(!(c&&!a)&&(h.getCanSelect()&&(ZD(h,t)?c=!0:a=!1),h.subRows&&h.subRows.length)){const i=z3(h,t);i==="all"?c=!0:(i==="some"&&(c=!0),a=!1)}}),a?"all":c?"some":!1}const B3=/([0-9]+)/gm,Eze=(e,t,r)=>Gne(ly(e.getValue(r)).toLowerCase(),ly(t.getValue(r)).toLowerCase()),Mze=(e,t,r)=>Gne(ly(e.getValue(r)),ly(t.getValue(r))),Oze=(e,t,r)=>YD(ly(e.getValue(r)).toLowerCase(),ly(t.getValue(r)).toLowerCase()),Rze=(e,t,r)=>YD(ly(e.getValue(r)),ly(t.getValue(r))),Ize=(e,t,r)=>{const n=e.getValue(r),a=t.getValue(r);return n>a?1:n<a?-1:0},Lze=(e,t,r)=>YD(e.getValue(r),t.getValue(r));function YD(e,t){return e===t?0:e>t?1:-1}function ly(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function Gne(e,t){const r=e.split(B3).filter(Boolean),n=t.split(B3).filter(Boolean);for(;r.length&&n.length;){const a=r.shift(),c=n.shift(),h=parseInt(a,10),i=parseInt(c,10),x=[h,i].sort();if(isNaN(x[0])){if(a>c)return 1;if(c>a)return-1;continue}if(isNaN(x[1]))return isNaN(h)?-1:1;if(h>i)return 1;if(i>h)return-1}return r.length-n.length}const Zb={alphanumeric:Eze,alphanumericCaseSensitive:Mze,text:Oze,textCaseSensitive:Rze,datetime:Ize,basic:Lze},Dze={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:Vu("sorting",e),isMultiSortEvent:t=>t.shiftKey}),createColumn:(e,t)=>{e.getAutoSortingFn=()=>{const r=t.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const a of r){const c=a==null?void 0:a.getValue(e.id);if(Object.prototype.toString.call(c)==="[object Date]")return Zb.datetime;if(typeof c=="string"&&(n=!0,c.split(B3).length>1))return Zb.alphanumeric}return n?Zb.text:Zb.basic},e.getAutoSortDir=()=>{const r=t.getFilteredRowModel().flatRows[0];return typeof(r==null?void 0:r.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var r,n;if(!e)throw new Error;return Bj(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(r=(n=t.options.sortingFns)==null?void 0:n[e.columnDef.sortingFn])!=null?r:Zb[e.columnDef.sortingFn]},e.toggleSorting=(r,n)=>{const a=e.getNextSortingOrder(),c=typeof r<"u"&&r!==null;t.setSorting(h=>{const i=h==null?void 0:h.find(D=>D.id===e.id),x=h==null?void 0:h.findIndex(D=>D.id===e.id);let w=[],S,T=c?r:a==="desc";if(h!=null&&h.length&&e.getCanMultiSort()&&n?i?S="toggle":S="add":h!=null&&h.length&&x!==h.length-1?S="replace":i?S="toggle":S="replace",S==="toggle"&&(c||a||(S="remove")),S==="add"){var E;w=[...h,{id:e.id,desc:T}],w.splice(0,w.length-((E=t.options.maxMultiSortColCount)!=null?E:Number.MAX_SAFE_INTEGER))}else S==="toggle"?w=h.map(D=>D.id===e.id?{...D,desc:T}:D):S==="remove"?w=h.filter(D=>D.id!==e.id):w=[{id:e.id,desc:T}];return w})},e.getFirstSortDir=()=>{var r,n;return((r=(n=e.columnDef.sortDescFirst)!=null?n:t.options.sortDescFirst)!=null?r:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=r=>{var n,a;const c=e.getFirstSortDir(),h=e.getIsSorted();return h?h!==c&&((n=t.options.enableSortingRemoval)==null||n)&&(!(r&&(a=t.options.enableMultiRemove)!=null)||a)?!1:h==="desc"?"asc":"desc":c},e.getCanSort=()=>{var r,n;return((r=e.columnDef.enableSorting)!=null?r:!0)&&((n=t.options.enableSorting)!=null?n:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var r,n;return(r=(n=e.columnDef.enableMultiSort)!=null?n:t.options.enableMultiSort)!=null?r:!!e.accessorFn},e.getIsSorted=()=>{var r;const n=(r=t.getState().sorting)==null?void 0:r.find(a=>a.id===e.id);return n?n.desc?"desc":"asc":!1},e.getSortIndex=()=>{var r,n;return(r=(n=t.getState().sorting)==null?void 0:n.findIndex(a=>a.id===e.id))!=null?r:-1},e.clearSorting=()=>{t.setSorting(r=>r!=null&&r.length?r.filter(n=>n.id!==e.id):[])},e.getToggleSortingHandler=()=>{const r=e.getCanSort();return n=>{r&&(n.persist==null||n.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?t.options.isMultiSortEvent==null?void 0:t.options.isMultiSortEvent(n):!1))}}},createTable:e=>{e.setSorting=t=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(t),e.resetSorting=t=>{var r,n;e.setSorting(t?[]:(r=(n=e.initialState)==null?void 0:n.sorting)!=null?r:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},Fze=[sze,Nze,_ze,bze,oze,lze,Aze,Tze,Dze,xze,jze,kze,Pze,Cze,wze];function zze(e){var t,r;const n=[...Fze,...(t=e._features)!=null?t:[]];let a={_features:n};const c=a._features.reduce((E,D)=>Object.assign(E,D.getDefaultOptions==null?void 0:D.getDefaultOptions(a)),{}),h=E=>a.options.mergeOptions?a.options.mergeOptions(c,E):{...c,...E};let x={...{},...(r=e.initialState)!=null?r:{}};a._features.forEach(E=>{var D;x=(D=E.getInitialState==null?void 0:E.getInitialState(x))!=null?D:x});const w=[];let S=!1;const T={_features:n,options:{...c,...e},initialState:x,_queue:E=>{w.push(E),S||(S=!0,Promise.resolve().then(()=>{for(;w.length;)w.shift()();S=!1}).catch(D=>setTimeout(()=>{throw D})))},reset:()=>{a.setState(a.initialState)},setOptions:E=>{const D=Hg(E,a.options);a.options=h(D)},getState:()=>a.options.state,setState:E=>{a.options.onStateChange==null||a.options.onStateChange(E)},_getRowId:(E,D,U)=>{var I;return(I=a.options.getRowId==null?void 0:a.options.getRowId(E,D,U))!=null?I:`${U?[U.id,D].join("."):D}`},getCoreRowModel:()=>(a._getCoreRowModel||(a._getCoreRowModel=a.options.getCoreRowModel(a)),a._getCoreRowModel()),getRowModel:()=>a.getPaginationRowModel(),getRow:(E,D)=>{let U=(D?a.getPrePaginationRowModel():a.getRowModel()).rowsById[E];if(!U&&(U=a.getCoreRowModel().rowsById[E],!U))throw new Error;return U},_getDefaultColumnDef:ri(()=>[a.options.defaultColumn],E=>{var D;return E=(D=E)!=null?D:{},{header:U=>{const I=U.header.column.columnDef;return I.accessorKey?I.accessorKey:I.accessorFn?I.id:null},cell:U=>{var I,V;return(I=(V=U.renderValue())==null||V.toString==null?void 0:V.toString())!=null?I:null},...a._features.reduce((U,I)=>Object.assign(U,I.getDefaultColumnDef==null?void 0:I.getDefaultColumnDef()),{}),...E}},ni(e,"debugColumns")),_getColumnDefs:()=>a.options.columns,getAllColumns:ri(()=>[a._getColumnDefs()],E=>{const D=function(U,I,V){return V===void 0&&(V=0),U.map(H=>{const K=aze(a,H,V,I),Q=H;return K.columns=Q.columns?D(Q.columns,K,V+1):[],K})};return D(E)},ni(e,"debugColumns")),getAllFlatColumns:ri(()=>[a.getAllColumns()],E=>E.flatMap(D=>D.getFlatColumns()),ni(e,"debugColumns")),_getAllFlatColumnsById:ri(()=>[a.getAllFlatColumns()],E=>E.reduce((D,U)=>(D[U.id]=U,D),{}),ni(e,"debugColumns")),getAllLeafColumns:ri(()=>[a.getAllColumns(),a._getOrderColumnsFn()],(E,D)=>{let U=E.flatMap(I=>I.getLeafColumns());return D(U)},ni(e,"debugColumns")),getColumn:E=>a._getAllFlatColumnsById()[E]};Object.assign(a,T);for(let E=0;E<a._features.length;E++){const D=a._features[E];D==null||D.createTable==null||D.createTable(a)}return a}function C2(){return e=>ri(()=>[e.options.data],t=>{const r={rows:[],flatRows:[],rowsById:{}},n=function(a,c,h){c===void 0&&(c=0);const i=[];for(let w=0;w<a.length;w++){const S=HD(e,e._getRowId(a[w],w,h),a[w],w,c,void 0,h==null?void 0:h.id);if(r.flatRows.push(S),r.rowsById[S.id]=S,i.push(S),e.options.getSubRows){var x;S.originalSubRows=e.options.getSubRows(a[w],w),(x=S.originalSubRows)!=null&&x.length&&(S.subRows=n(S.originalSubRows,c+1,S))}}return i};return r.rows=n(t),r},ni(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function Bze(e){const t=[],r=n=>{var a;t.push(n),(a=n.subRows)!=null&&a.length&&n.getIsExpanded()&&n.subRows.forEach(r)};return e.rows.forEach(r),{rows:t,flatRows:e.flatRows,rowsById:e.rowsById}}function Vze(e,t,r){return r.options.filterFromLeafRows?Uze(e,t,r):$ze(e,t,r)}function Uze(e,t,r){var n;const a=[],c={},h=(n=r.options.maxLeafRowFilterDepth)!=null?n:100,i=function(x,w){w===void 0&&(w=0);const S=[];for(let E=0;E<x.length;E++){var T;let D=x[E];const U=HD(r,D.id,D.original,D.index,D.depth,void 0,D.parentId);if(U.columnFilters=D.columnFilters,(T=D.subRows)!=null&&T.length&&w<h){if(U.subRows=i(D.subRows,w+1),D=U,t(D)&&!U.subRows.length){S.push(D),c[D.id]=D,a.push(D);continue}if(t(D)||U.subRows.length){S.push(D),c[D.id]=D,a.push(D);continue}}else D=U,t(D)&&(S.push(D),c[D.id]=D,a.push(D))}return S};return{rows:i(e),flatRows:a,rowsById:c}}function $ze(e,t,r){var n;const a=[],c={},h=(n=r.options.maxLeafRowFilterDepth)!=null?n:100,i=function(x,w){w===void 0&&(w=0);const S=[];for(let E=0;E<x.length;E++){let D=x[E];if(t(D)){var T;if((T=D.subRows)!=null&&T.length&&w<h){const I=HD(r,D.id,D.original,D.index,D.depth,void 0,D.parentId);I.subRows=i(D.subRows,w+1),D=I}S.push(D),a.push(D),c[D.id]=D}}return S};return{rows:i(e),flatRows:a,rowsById:c}}function E2(){return e=>ri(()=>[e.getPreFilteredRowModel(),e.getState().columnFilters,e.getState().globalFilter],(t,r,n)=>{if(!t.rows.length||!(r!=null&&r.length)&&!n){for(let E=0;E<t.flatRows.length;E++)t.flatRows[E].columnFilters={},t.flatRows[E].columnFiltersMeta={};return t}const a=[],c=[];(r??[]).forEach(E=>{var D;const U=e.getColumn(E.id);if(!U)return;const I=U.getFilterFn();I&&a.push({id:E.id,filterFn:I,resolvedValue:(D=I.resolveFilterValue==null?void 0:I.resolveFilterValue(E.value))!=null?D:E.value})});const h=(r??[]).map(E=>E.id),i=e.getGlobalFilterFn(),x=e.getAllLeafColumns().filter(E=>E.getCanGlobalFilter());n&&i&&x.length&&(h.push("__global__"),x.forEach(E=>{var D;c.push({id:E.id,filterFn:i,resolvedValue:(D=i.resolveFilterValue==null?void 0:i.resolveFilterValue(n))!=null?D:n})}));let w,S;for(let E=0;E<t.flatRows.length;E++){const D=t.flatRows[E];if(D.columnFilters={},a.length)for(let U=0;U<a.length;U++){w=a[U];const I=w.id;D.columnFilters[I]=w.filterFn(D,I,w.resolvedValue,V=>{D.columnFiltersMeta[I]=V})}if(c.length){for(let U=0;U<c.length;U++){S=c[U];const I=S.id;if(S.filterFn(D,I,S.resolvedValue,V=>{D.columnFiltersMeta[I]=V})){D.columnFilters.__global__=!0;break}}D.columnFilters.__global__!==!0&&(D.columnFilters.__global__=!1)}}const T=E=>{for(let D=0;D<h.length;D++)if(E.columnFilters[h[D]]===!1)return!1;return!0};return Vze(t.rows,T,e)},ni(e.options,"debugTable","getFilteredRowModel",()=>e._autoResetPageIndex()))}function M2(e){return t=>ri(()=>[t.getState().pagination,t.getPrePaginationRowModel(),t.options.paginateExpandedRows?void 0:t.getState().expanded],(r,n)=>{if(!n.rows.length)return n;const{pageSize:a,pageIndex:c}=r;let{rows:h,flatRows:i,rowsById:x}=n;const w=a*c,S=w+a;h=h.slice(w,S);let T;t.options.paginateExpandedRows?T={rows:h,flatRows:i,rowsById:x}:T=Bze({rows:h,flatRows:i,rowsById:x}),T.flatRows=[];const E=D=>{T.flatRows.push(D),D.subRows.length&&D.subRows.forEach(E)};return T.rows.forEach(E),T},ni(t.options,"debugTable"))}function O2(){return e=>ri(()=>[e.getState().sorting,e.getPreSortedRowModel()],(t,r)=>{if(!r.rows.length||!(t!=null&&t.length))return r;const n=e.getState().sorting,a=[],c=n.filter(x=>{var w;return(w=e.getColumn(x.id))==null?void 0:w.getCanSort()}),h={};c.forEach(x=>{const w=e.getColumn(x.id);w&&(h[x.id]={sortUndefined:w.columnDef.sortUndefined,invertSorting:w.columnDef.invertSorting,sortingFn:w.getSortingFn()})});const i=x=>{const w=x.map(S=>({...S}));return w.sort((S,T)=>{for(let D=0;D<c.length;D+=1){var E;const U=c[D],I=h[U.id],V=I.sortUndefined,H=(E=U==null?void 0:U.desc)!=null?E:!1;let K=0;if(V){const Q=S.getValue(U.id),ae=T.getValue(U.id),ee=Q===void 0,se=ae===void 0;if(ee||se){if(V==="first")return ee?-1:1;if(V==="last")return ee?1:-1;K=ee&&se?0:ee?V:-V}}if(K===0&&(K=I.sortingFn(S,T,U.id)),K!==0)return H&&(K*=-1),I.invertSorting&&(K*=-1),K}return S.index-T.index}),w.forEach(S=>{var T;a.push(S),(T=S.subRows)!=null&&T.length&&(S.subRows=i(S.subRows))}),w};return{rows:i(r.rows),flatRows:a,rowsById:r.rowsById}},ni(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function fp(e,t){return e?qze(e)?G.createElement(e,t):e:null}function qze(e){return Gze(e)||typeof e=="function"||Wze(e)}function Gze(e){return typeof e=="function"&&(()=>{const t=Object.getPrototypeOf(e);return t.prototype&&t.prototype.isReactComponent})()}function Wze(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function R2(e){const t={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[r]=G.useState(()=>({current:zze(t)})),[n,a]=G.useState(()=>r.current.initialState);return r.current.setOptions(c=>({...c,...e,state:{...n,...e.state},onStateChange:h=>{a(h),e.onStateChange==null||e.onStateChange(h)}})),r.current}const Im=G.forwardRef(({className:e,...t},r)=>o.jsx("div",{className:"relative w-full overflow-auto",children:o.jsx("table",{ref:r,className:zt("w-full caption-bottom text-sm",e),...t})}));Im.displayName="Table";const Lm=G.forwardRef(({className:e,...t},r)=>o.jsx("thead",{ref:r,className:zt("[&_tr]:border-b [&_tr]:dark:border-[#424242]",e),...t}));Lm.displayName="TableHeader";const Dm=G.forwardRef(({className:e,...t},r)=>o.jsx("tbody",{ref:r,className:zt("[&_tr:last-child]:border-0",e),...t}));Dm.displayName="TableBody";const Hze=G.forwardRef(({className:e,...t},r)=>o.jsx("tfoot",{ref:r,className:zt("border-t dark:border-[#424242] bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Hze.displayName="TableFooter";const Ps=G.forwardRef(({className:e,...t},r)=>o.jsx("tr",{ref:r,className:zt("border-b dark:border-[#424242] transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));Ps.displayName="TableRow";const Ts=G.forwardRef(({className:e,...t},r)=>o.jsx("th",{ref:r,className:zt("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));Ts.displayName="TableHead";const xa=G.forwardRef(({className:e,...t},r)=>o.jsx("td",{ref:r,className:zt("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));xa.displayName="TableCell";const Kze=G.forwardRef(({className:e,...t},r)=>o.jsx("caption",{ref:r,className:zt("mt-4 text-sm text-muted-foreground",e),...t}));Kze.displayName="TableCaption";const I2=({rowCount:e,cellCount:t})=>o.jsx(o.Fragment,{children:Array.from({length:e}).map((r,n)=>o.jsx(Ps,{children:Array.from({length:t}).map((a,c)=>o.jsx(xa,{children:o.jsx(hA,{className:"h-5"})},c))},n))});function L2({table:e}){return o.jsxs(Yh,{children:[o.jsx(C4,{asChild:!0,children:o.jsxs(ur,{size:"sm",className:"ml-auto hidden h-8 lg:flex bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-gray-600 dark:hover:bg-gray-800",children:[o.jsx(qde,{}),"View"]})}),o.jsxs(Bd,{align:"end",className:"w-[150px]",children:[o.jsx(N_,{children:"Toggle columns"}),o.jsx(Am,{}),e.getAllColumns().filter(t=>typeof t.accessorFn<"u"&&t.getCanHide()).map(t=>o.jsx(oZ,{className:"capitalize",checked:t.getIsVisible(),onCheckedChange:r=>t.toggleVisibility(!!r),children:typeof t.columnDef.header=="string"?t.columnDef.header:t.id},t.id))]})]})}function D2({table:e}){return o.jsx("div",{className:"flex items-center justify-end px-2",children:o.jsxs("div",{className:"flex items-center space-x-4 lg:space-x-5",children:[o.jsxs("div",{className:"flex w-[100px] items-center justify-center text-xs font-medium",children:["Page ",e.getState().pagination.pageIndex+1," of"," ",e.getPageCount()]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs(ur,{variant:"outline",className:"hidden h-7 w-7 rounded-sm p-0 lg:flex",onClick:()=>e.setPageIndex(0),disabled:!e.getCanPreviousPage(),children:[o.jsx("span",{className:"sr-only",children:"Go to first page"}),o.jsx(Zue,{className:"w-4 h-4"})]}),o.jsxs(ur,{variant:"outline",className:"h-7 w-7 rounded-sm p-0",onClick:()=>e.previousPage(),disabled:!e.getCanPreviousPage(),children:[o.jsx("span",{className:"sr-only",children:"Go to previous page"}),o.jsx(s4,{className:"w-4 h-4"})]}),o.jsxs(ur,{variant:"outline",className:"h-7 w-7 rounded-sm p-0",onClick:()=>e.nextPage(),disabled:!e.getCanNextPage(),children:[o.jsx("span",{className:"sr-only",children:"Go to next page"}),o.jsx(z0,{className:"w-4 h-4"})]}),o.jsxs(ur,{variant:"outline",className:"hidden h-7 w-7 rounded-sm p-0 lg:flex",onClick:()=>e.setPageIndex(e.getPageCount()-1),disabled:!e.getCanNextPage(),children:[o.jsx("span",{className:"sr-only",children:"Go to last page"}),o.jsx(Xue,{className:"w-4 h-4"})]})]})]})})}const Zze=({searchPlaceholder:e=null,title:t,filters:r,description:n,tableColumn:a,data:c,loading:h,onNavigate:i,onAdd:x,onRowClick:w,onEdit:S,onDelete:T,onFileNumberClick:E})=>{var me;const[D,U]=Le.useState([]),[I,V]=Le.useState([]),[H,K]=Le.useState({emailAddress:!1}),[Q,ae]=Le.useState({}),[ee,se]=Le.useState({pageIndex:0,pageSize:9}),[ue,he]=Le.useState(""),Ce=r,Ne=R2({data:c,columns:a(S,T,E),onSortingChange:U,onColumnFiltersChange:V,onPaginationChange:se,getCoreRowModel:C2(),getPaginationRowModel:M2(),getSortedRowModel:O2(),getFilteredRowModel:E2(),onColumnVisibilityChange:K,onColumnSizingChange:ae,onGlobalFilterChange:he,globalFilterFn:(be,pe,Se)=>Ce.some(Ee=>{const we=be.getValue(Ee);return String(we).toLowerCase().includes(Se.toLowerCase())}),state:{pagination:ee,sorting:D,columnFilters:I,columnVisibility:H,columnSizing:Q,globalFilter:ue},enableColumnResizing:!0,columnResizeMode:"onChange"});return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsx(Ml,{className:"font-semibold",children:t}),o.jsxs("div",{className:`md:flex items-center justify-between py-3 flex-shrink-0
        `,children:[o.jsxs("div",{className:"relative hidden md:inline md:max-w-sm flex-shrink",children:[o.jsx(Kw,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx(Yr,{placeholder:"Search Driver...",value:ue??"",onChange:be=>he(be.target.value),className:"pl-10 pr-10 bg-white text-black border-gray-300 dark:bg-black dark:text-white dark:border-[#424242]"}),ue&&o.jsx("button",{onClick:()=>he(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:o.jsx(zd,{className:"h-4 w-4"})})]}),o.jsx("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:o.jsx(L2,{table:Ne})})]}),o.jsx("div",{className:"border flex-1 overflow-hidden shadow-sm bg-white dark:bg-transparent border-gray-300 dark:border-[#424242] min-h-0",children:o.jsx("div",{className:"overflow-x-auto overflow-y-auto h-full",children:o.jsx("div",{className:"px-0 min-w-full",children:o.jsxs(Im,{className:"min-w-full",children:[o.jsx(Lm,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 dark:bg-[#18181B] border-b-2 border-gray-300 dark:border-[#424242]",children:Ne.getHeaderGroups().map(be=>o.jsx(Ps,{className:"hover:bg-gray-100/50 dark:hover:bg-[#18181B] dark:bg-[#18181B]",children:be.headers.map(pe=>o.jsx(Ts,{className:"text-xs font-semibold text-gray-800 dark:text-gray-200 px-3 py-2 whitespace-nowrap text-left",style:{width:pe.getSize()},children:fp(pe.column.columnDef.header,pe.getContext())},pe.id))},be.id))}),o.jsx(Dm,{className:"text-xs bg-white dark:bg-transparent",children:h?o.jsx(I2,{rowCount:5,cellCount:Ne.getAllColumns().length}):(me=Ne.getRowModel().rows)!=null&&me.length?Ne.getRowModel().rows.map(be=>o.jsx(Ps,{onClick:()=>w(be.original),"data-state":be.getIsSelected()&&"selected",className:"hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors duration-150 border-b border-gray-100 dark:border-gray-700 cursor-pointer",children:be.getVisibleCells().map(pe=>o.jsx(xa,{className:"px-3 py-2 text-gray-800 dark:text-gray-200 text-left max-w-0",style:{width:pe.column.getSize()},children:fp(pe.column.columnDef.cell,pe.getContext())},pe.id))},be.id)):o.jsx(Ps,{className:"hover:bg-transparent",children:o.jsx(xa,{colSpan:Ne.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:o.jsxs("div",{className:"flex flex-col items-center justify-center",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),o.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),o.jsx("div",{className:"mt-2 mb-2 flex-shrink-0",children:o.jsx(D2,{table:Ne})})]})};var Wne="AlertDialog",[Yze,s8e]=qd(Wne,[NY]),Fm=NY(),Hne=e=>{const{__scopeAlertDialog:t,...r}=e,n=Fm(t);return o.jsx(X4,{...n,...r,modal:!0})};Hne.displayName=Wne;var Xze="AlertDialogTrigger",Jze=G.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Fm(r);return o.jsx(Hxe,{...a,...n,ref:t})});Jze.displayName=Xze;var Qze="AlertDialogPortal",Kne=e=>{const{__scopeAlertDialog:t,...r}=e,n=Fm(t);return o.jsx(J4,{...n,...r})};Kne.displayName=Qze;var eBe="AlertDialogOverlay",Zne=G.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Fm(r);return o.jsx(o2,{...a,...n,ref:t})});Zne.displayName=eBe;var Tv="AlertDialogContent",[tBe,rBe]=Yze(Tv),Yne=G.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...a}=e,c=Fm(r),h=G.useRef(null),i=ta(t,h),x=G.useRef(null);return o.jsx($xe,{contentName:Tv,titleName:Xne,docsSlug:"alert-dialog",children:o.jsx(tBe,{scope:r,cancelRef:x,children:o.jsxs(l2,{role:"alertdialog",...c,...a,ref:i,onOpenAutoFocus:dn(a.onOpenAutoFocus,w=>{var S;w.preventDefault(),(S=x.current)==null||S.focus({preventScroll:!0})}),onPointerDownOutside:w=>w.preventDefault(),onInteractOutside:w=>w.preventDefault(),children:[o.jsx(e4,{children:n}),o.jsx(iBe,{contentRef:h})]})})})});Yne.displayName=Tv;var Xne="AlertDialogTitle",Jne=G.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Fm(r);return o.jsx(c2,{...a,...n,ref:t})});Jne.displayName=Xne;var Qne="AlertDialogDescription",eie=G.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Fm(r);return o.jsx(u2,{...a,...n,ref:t})});eie.displayName=Qne;var nBe="AlertDialogAction",tie=G.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Fm(r);return o.jsx(ZT,{...a,...n,ref:t})});tie.displayName=nBe;var rie="AlertDialogCancel",nie=G.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:a}=rBe(rie,r),c=Fm(r),h=ta(t,a);return o.jsx(ZT,{...c,...n,ref:h})});nie.displayName=rie;var iBe=({contentRef:e})=>{const t=`\`${Tv}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Tv}\` by passing a \`${Qne}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Tv}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return G.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},aBe=Hne,sBe=Kne,iie=Zne,aie=Yne,sie=tie,oie=nie,lie=Jne,cie=eie;const uie=aBe,oBe=sBe,die=G.forwardRef(({className:e,...t},r)=>o.jsx(iie,{className:zt("fixed inset-0 z-50 bg-black/60 backdrop-blur-[5px] data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));die.displayName=iie.displayName;const XD=G.forwardRef(({className:e,...t},r)=>o.jsxs(oBe,{children:[o.jsx(die,{}),o.jsx(aie,{ref:r,className:zt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));XD.displayName=aie.displayName;const JD=({className:e,...t})=>o.jsx("div",{className:zt("flex flex-col space-y-2 text-center sm:text-left",e),...t});JD.displayName="AlertDialogHeader";const QD=({className:e,...t})=>o.jsx("div",{className:zt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});QD.displayName="AlertDialogFooter";const e5=G.forwardRef(({className:e,...t},r)=>o.jsx(lie,{ref:r,className:zt("text-lg font-semibold",e),...t}));e5.displayName=lie.displayName;const t5=G.forwardRef(({className:e,...t},r)=>o.jsx(cie,{ref:r,className:zt("text-sm text-muted-foreground",e),...t}));t5.displayName=cie.displayName;const r5=G.forwardRef(({className:e,...t},r)=>o.jsx(sie,{ref:r,className:zt(j1({variant:"outline"}),e),...t}));r5.displayName=sie.displayName;const n5=G.forwardRef(({className:e,...t},r)=>o.jsx(oie,{ref:r,className:zt(j1(),"mt-2 sm:mt-0",e),...t}));n5.displayName=oie.displayName;const hie=({open:e,onOpenChange:t,confirm:r,cancel:n,title:a,description:c})=>o.jsx(uie,{open:e,onOpenChange:t,children:o.jsxs(XD,{className:"",children:[o.jsxs(JD,{children:[o.jsx(e5,{children:a}),o.jsx(t5,{children:c})]}),o.jsxs(QD,{children:[o.jsx(n5,{onClick:n,children:"Cancel"}),o.jsx(r5,{onClick:r,children:"Continue"})]})]})});function sa(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Uu(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function vc(e,t){const r=sa(e);return isNaN(t)?Uu(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Qh(e,t){const r=sa(e);if(isNaN(t))return Uu(e,NaN);if(!t)return r;const n=r.getDate(),a=Uu(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const c=a.getDate();return n>=c?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const i5=6048e5,lBe=864e5;let cBe={};function F2(){return cBe}function pp(e,t){var i,x,w,S;const r=F2(),n=(t==null?void 0:t.weekStartsOn)??((x=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:x.weekStartsOn)??r.weekStartsOn??((S=(w=r.locale)==null?void 0:w.options)==null?void 0:S.weekStartsOn)??0,a=sa(e),c=a.getDay(),h=(c<n?7:0)+c-n;return a.setDate(a.getDate()-h),a.setHours(0,0,0,0),a}function X0(e){return pp(e,{weekStartsOn:1})}function fie(e){const t=sa(e),r=t.getFullYear(),n=Uu(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=X0(n),c=Uu(e,0);c.setFullYear(r,0,4),c.setHours(0,0,0,0);const h=X0(c);return t.getTime()>=a.getTime()?r+1:t.getTime()>=h.getTime()?r:r-1}function h_(e){const t=sa(e);return t.setHours(0,0,0,0),t}function vT(e){const t=sa(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Xf(e,t){const r=h_(e),n=h_(t),a=+r-vT(r),c=+n-vT(n);return Math.round((a-c)/lBe)}function uBe(e){const t=fie(e),r=Uu(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),X0(r)}function V3(e,t){const r=t*7;return vc(e,r)}function dBe(e,t){return Qh(e,t*12)}function hBe(e){let t;return e.forEach(function(r){const n=sa(r);(t===void 0||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function fBe(e){let t;return e.forEach(r=>{const n=sa(r);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function Qc(e,t){const r=h_(e),n=h_(t);return+r==+n}function a5(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function pBe(e){if(!a5(e)&&typeof e!="number")return!1;const t=sa(e);return!isNaN(Number(t))}function Uw(e,t){const r=sa(e),n=sa(t),a=r.getFullYear()-n.getFullYear(),c=r.getMonth()-n.getMonth();return a*12+c}function mBe(e,t,r){const n=pp(e,r),a=pp(t,r),c=+n-vT(n),h=+a-vT(a);return Math.round((c-h)/i5)}function s5(e){const t=sa(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function ru(e){const t=sa(e);return t.setDate(1),t.setHours(0,0,0,0),t}function pie(e){const t=sa(e),r=Uu(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function o5(e,t){var i,x,w,S;const r=F2(),n=(t==null?void 0:t.weekStartsOn)??((x=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:x.weekStartsOn)??r.weekStartsOn??((S=(w=r.locale)==null?void 0:w.options)==null?void 0:S.weekStartsOn)??0,a=sa(e),c=a.getDay(),h=(c<n?-7:0)+6-(c-n);return a.setDate(a.getDate()+h),a.setHours(23,59,59,999),a}function mie(e){return o5(e,{weekStartsOn:1})}const gBe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},yBe=(e,t,r)=>{let n;const a=gBe[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function YO(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const xBe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},vBe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},_Be={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},bBe={date:YO({formats:xBe,defaultWidth:"full"}),time:YO({formats:vBe,defaultWidth:"full"}),dateTime:YO({formats:_Be,defaultWidth:"full"})},wBe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},SBe=(e,t,r,n)=>wBe[e];function Yb(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const h=e.defaultFormattingWidth||e.defaultWidth,i=r!=null&&r.width?String(r.width):h;a=e.formattingValues[i]||e.formattingValues[h]}else{const h=e.defaultWidth,i=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[i]||e.values[h]}const c=e.argumentCallback?e.argumentCallback(t):t;return a[c]}}const NBe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ABe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},TBe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},jBe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},kBe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},PBe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},CBe=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},EBe={ordinalNumber:CBe,era:Yb({values:NBe,defaultWidth:"wide"}),quarter:Yb({values:ABe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Yb({values:TBe,defaultWidth:"wide"}),day:Yb({values:jBe,defaultWidth:"wide"}),dayPeriod:Yb({values:kBe,defaultWidth:"wide",formattingValues:PBe,defaultFormattingWidth:"wide"})};function Xb(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],c=t.match(a);if(!c)return null;const h=c[0],i=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],x=Array.isArray(i)?OBe(i,T=>T.test(h)):MBe(i,T=>T.test(h));let w;w=e.valueCallback?e.valueCallback(x):x,w=r.valueCallback?r.valueCallback(w):w;const S=t.slice(h.length);return{value:w,rest:S}}}function MBe(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function OBe(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function RBe(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],c=t.match(e.parsePattern);if(!c)return null;let h=e.valueCallback?e.valueCallback(c[0]):c[0];h=r.valueCallback?r.valueCallback(h):h;const i=t.slice(a.length);return{value:h,rest:i}}}const IBe=/^(\d+)(th|st|nd|rd)?/i,LBe=/\d+/i,DBe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},FBe={any:[/^b/i,/^(a|c)/i]},zBe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},BBe={any:[/1/i,/2/i,/3/i,/4/i]},VBe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},UBe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},$Be={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},qBe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},GBe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},WBe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},HBe={ordinalNumber:RBe({matchPattern:IBe,parsePattern:LBe,valueCallback:e=>parseInt(e,10)}),era:Xb({matchPatterns:DBe,defaultMatchWidth:"wide",parsePatterns:FBe,defaultParseWidth:"any"}),quarter:Xb({matchPatterns:zBe,defaultMatchWidth:"wide",parsePatterns:BBe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Xb({matchPatterns:VBe,defaultMatchWidth:"wide",parsePatterns:UBe,defaultParseWidth:"any"}),day:Xb({matchPatterns:$Be,defaultMatchWidth:"wide",parsePatterns:qBe,defaultParseWidth:"any"}),dayPeriod:Xb({matchPatterns:GBe,defaultMatchWidth:"any",parsePatterns:WBe,defaultParseWidth:"any"})},gie={code:"en-US",formatDistance:yBe,formatLong:bBe,formatRelative:SBe,localize:EBe,match:HBe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function KBe(e){const t=sa(e);return Xf(t,pie(t))+1}function yie(e){const t=sa(e),r=+X0(t)-+uBe(t);return Math.round(r/i5)+1}function xie(e,t){var S,T,E,D;const r=sa(e),n=r.getFullYear(),a=F2(),c=(t==null?void 0:t.firstWeekContainsDate)??((T=(S=t==null?void 0:t.locale)==null?void 0:S.options)==null?void 0:T.firstWeekContainsDate)??a.firstWeekContainsDate??((D=(E=a.locale)==null?void 0:E.options)==null?void 0:D.firstWeekContainsDate)??1,h=Uu(e,0);h.setFullYear(n+1,0,c),h.setHours(0,0,0,0);const i=pp(h,t),x=Uu(e,0);x.setFullYear(n,0,c),x.setHours(0,0,0,0);const w=pp(x,t);return r.getTime()>=i.getTime()?n+1:r.getTime()>=w.getTime()?n:n-1}function ZBe(e,t){var i,x,w,S;const r=F2(),n=(t==null?void 0:t.firstWeekContainsDate)??((x=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:x.firstWeekContainsDate)??r.firstWeekContainsDate??((S=(w=r.locale)==null?void 0:w.options)==null?void 0:S.firstWeekContainsDate)??1,a=xie(e,t),c=Uu(e,0);return c.setFullYear(a,0,n),c.setHours(0,0,0,0),pp(c,t)}function vie(e,t){const r=sa(e),n=+pp(r,t)-+ZBe(r,t);return Math.round(n/i5)+1}function Ca(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Lg={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Ca(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Ca(r+1,2)},d(e,t){return Ca(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Ca(e.getHours()%12||12,t.length)},H(e,t){return Ca(e.getHours(),t.length)},m(e,t){return Ca(e.getMinutes(),t.length)},s(e,t){return Ca(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Ca(a,t.length)}},iv={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},IW={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Lg.y(e,t)},Y:function(e,t,r,n){const a=xie(e,n),c=a>0?a:1-a;if(t==="YY"){const h=c%100;return Ca(h,2)}return t==="Yo"?r.ordinalNumber(c,{unit:"year"}):Ca(c,t.length)},R:function(e,t){const r=fie(e);return Ca(r,t.length)},u:function(e,t){const r=e.getFullYear();return Ca(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Ca(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Ca(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Lg.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Ca(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=vie(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Ca(a,t.length)},I:function(e,t,r){const n=yie(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Ca(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Lg.d(e,t)},D:function(e,t,r){const n=KBe(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Ca(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),c=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(c);case"ee":return Ca(c,2);case"eo":return r.ordinalNumber(c,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),c=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(c);case"cc":return Ca(c,t.length);case"co":return r.ordinalNumber(c,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Ca(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=iv.noon:n===0?a=iv.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=iv.evening:n>=12?a=iv.afternoon:n>=4?a=iv.morning:a=iv.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Lg.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Lg.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Ca(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Ca(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Lg.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Lg.s(e,t)},S:function(e,t){return Lg.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return DW(n);case"XXXX":case"XX":return b0(n);case"XXXXX":case"XXX":default:return b0(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return DW(n);case"xxxx":case"xx":return b0(n);case"xxxxx":case"xxx":default:return b0(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+LW(n,":");case"OOOO":default:return"GMT"+b0(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+LW(n,":");case"zzzz":default:return"GMT"+b0(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Ca(n,t.length)},T:function(e,t,r){const n=e.getTime();return Ca(n,t.length)}};function LW(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),c=n%60;return c===0?r+String(a):r+String(a)+t+Ca(c,2)}function DW(e,t){return e%60===0?(e>0?"-":"+")+Ca(Math.abs(e)/60,2):b0(e,t)}function b0(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Ca(Math.trunc(n/60),2),c=Ca(n%60,2);return r+a+t+c}const FW=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},_ie=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},YBe=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return FW(e,t);let c;switch(n){case"P":c=t.dateTime({width:"short"});break;case"PP":c=t.dateTime({width:"medium"});break;case"PPP":c=t.dateTime({width:"long"});break;case"PPPP":default:c=t.dateTime({width:"full"});break}return c.replace("{{date}}",FW(n,t)).replace("{{time}}",_ie(a,t))},XBe={p:_ie,P:YBe},JBe=/^D+$/,QBe=/^Y+$/,e6e=["D","DD","YY","YYYY"];function t6e(e){return JBe.test(e)}function r6e(e){return QBe.test(e)}function n6e(e,t,r){const n=i6e(e,t,r);if(console.warn(n),e6e.includes(e))throw new RangeError(n)}function i6e(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const a6e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,s6e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,o6e=/^'([^]*?)'?$/,l6e=/''/g,c6e=/[a-zA-Z]/;function Ol(e,t,r){var S,T,E,D,U,I,V,H;const n=F2(),a=(r==null?void 0:r.locale)??n.locale??gie,c=(r==null?void 0:r.firstWeekContainsDate)??((T=(S=r==null?void 0:r.locale)==null?void 0:S.options)==null?void 0:T.firstWeekContainsDate)??n.firstWeekContainsDate??((D=(E=n.locale)==null?void 0:E.options)==null?void 0:D.firstWeekContainsDate)??1,h=(r==null?void 0:r.weekStartsOn)??((I=(U=r==null?void 0:r.locale)==null?void 0:U.options)==null?void 0:I.weekStartsOn)??n.weekStartsOn??((H=(V=n.locale)==null?void 0:V.options)==null?void 0:H.weekStartsOn)??0,i=sa(e);if(!pBe(i))throw new RangeError("Invalid time value");let x=t.match(s6e).map(K=>{const Q=K[0];if(Q==="p"||Q==="P"){const ae=XBe[Q];return ae(K,a.formatLong)}return K}).join("").match(a6e).map(K=>{if(K==="''")return{isToken:!1,value:"'"};const Q=K[0];if(Q==="'")return{isToken:!1,value:u6e(K)};if(IW[Q])return{isToken:!0,value:K};if(Q.match(c6e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Q+"`");return{isToken:!1,value:K}});a.localize.preprocessor&&(x=a.localize.preprocessor(i,x));const w={firstWeekContainsDate:c,weekStartsOn:h,locale:a};return x.map(K=>{if(!K.isToken)return K.value;const Q=K.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&r6e(Q)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&t6e(Q))&&n6e(Q,t,String(e));const ae=IW[Q[0]];return ae(i,Q,a.localize,w)}).join("")}function u6e(e){const t=e.match(o6e);return t?t[1].replace(l6e,"'"):e}function d6e(e){const t=sa(e),r=t.getFullYear(),n=t.getMonth(),a=Uu(e,0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function h6e(e){return Math.trunc(+sa(e)/1e3)}function f6e(e){const t=sa(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function p6e(e,t){return mBe(f6e(e),ru(e),t)+1}function U3(e,t){const r=sa(e),n=sa(t);return r.getTime()>n.getTime()}function bie(e,t){const r=sa(e),n=sa(t);return+r<+n}function l5(e,t){const r=sa(e),n=sa(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function m6e(e,t){const r=sa(e),n=sa(t);return r.getFullYear()===n.getFullYear()}function XO(e,t){return vc(e,-t)}function ON(e,t){const r=sa(e),n=r.getFullYear(),a=r.getDate(),c=Uu(e,0);c.setFullYear(n,t,15),c.setHours(0,0,0,0);const h=d6e(c);return r.setMonth(t,Math.min(a,h)),r}function $3(e,t){const r=sa(e);return isNaN(+r)?Uu(e,NaN):(r.setFullYear(t),r)}var c5="Popover",[wie,o8e]=qd(c5,[cy]),z2=cy(),[g6e,xy]=wie(c5),Sie=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:c,modal:h=!1}=e,i=z2(t),x=G.useRef(null),[w,S]=G.useState(!1),[T=!1,E]=Jg({prop:n,defaultProp:a,onChange:c});return o.jsx(ET,{...i,children:o.jsx(g6e,{scope:t,contentId:Ld(),triggerRef:x,open:T,onOpenChange:E,onOpenToggle:G.useCallback(()=>E(D=>!D),[E]),hasCustomAnchor:w,onCustomAnchorAdd:G.useCallback(()=>S(!0),[]),onCustomAnchorRemove:G.useCallback(()=>S(!1),[]),modal:h,children:r})})};Sie.displayName=c5;var Nie="PopoverAnchor",y6e=G.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=xy(Nie,r),c=z2(r),{onCustomAnchorAdd:h,onCustomAnchorRemove:i}=a;return G.useEffect(()=>(h(),()=>i()),[h,i]),o.jsx(Xw,{...c,...n,ref:t})});y6e.displayName=Nie;var Aie="PopoverTrigger",Tie=G.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=xy(Aie,r),c=z2(r),h=ta(t,a.triggerRef),i=o.jsx(gi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Eie(a.open),...n,ref:h,onClick:dn(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?i:o.jsx(Xw,{asChild:!0,...c,children:i})});Tie.displayName=Aie;var u5="PopoverPortal",[x6e,v6e]=wie(u5,{forceMount:void 0}),jie=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,c=xy(u5,t);return o.jsx(x6e,{scope:t,forceMount:r,children:o.jsx($u,{present:r||c.open,children:o.jsx(S_,{asChild:!0,container:a,children:n})})})};jie.displayName=u5;var f_="PopoverContent",kie=G.forwardRef((e,t)=>{const r=v6e(f_,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,c=xy(f_,e.__scopePopover);return o.jsx($u,{present:n||c.open,children:c.modal?o.jsx(_6e,{...a,ref:t}):o.jsx(b6e,{...a,ref:t})})});kie.displayName=f_;var _6e=G.forwardRef((e,t)=>{const r=xy(f_,e.__scopePopover),n=G.useRef(null),a=ta(t,n),c=G.useRef(!1);return G.useEffect(()=>{const h=n.current;if(h)return IT(h)},[]),o.jsx(Jw,{as:nc,allowPinchZoom:!0,children:o.jsx(Pie,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:dn(e.onCloseAutoFocus,h=>{var i;h.preventDefault(),c.current||(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:dn(e.onPointerDownOutside,h=>{const i=h.detail.originalEvent,x=i.button===0&&i.ctrlKey===!0,w=i.button===2||x;c.current=w},{checkForDefaultPrevented:!1}),onFocusOutside:dn(e.onFocusOutside,h=>h.preventDefault(),{checkForDefaultPrevented:!1})})})}),b6e=G.forwardRef((e,t)=>{const r=xy(f_,e.__scopePopover),n=G.useRef(!1),a=G.useRef(!1);return o.jsx(Pie,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var h,i;(h=e.onCloseAutoFocus)==null||h.call(e,c),c.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),c.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:c=>{var x,w;(x=e.onInteractOutside)==null||x.call(e,c),c.defaultPrevented||(n.current=!0,c.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const h=c.target;((w=r.triggerRef.current)==null?void 0:w.contains(h))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&a.current&&c.preventDefault()}})}),Pie=G.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:c,disableOutsidePointerEvents:h,onEscapeKeyDown:i,onPointerDownOutside:x,onFocusOutside:w,onInteractOutside:S,...T}=e,E=xy(f_,r),D=z2(r);return jT(),o.jsx(Zw,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:c,children:o.jsx(__,{asChild:!0,disableOutsidePointerEvents:h,onInteractOutside:S,onEscapeKeyDown:i,onPointerDownOutside:x,onFocusOutside:w,onDismiss:()=>E.onOpenChange(!1),children:o.jsx(MT,{"data-state":Eie(E.open),role:"dialog",id:E.contentId,...D,...T,ref:t,style:{...T.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Cie="PopoverClose",w6e=G.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=xy(Cie,r);return o.jsx(gi.button,{type:"button",...n,ref:t,onClick:dn(e.onClick,()=>a.onOpenChange(!1))})});w6e.displayName=Cie;var S6e="PopoverArrow",N6e=G.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=z2(r);return o.jsx(OT,{...a,...n,ref:t})});N6e.displayName=S6e;function Eie(e){return e?"open":"closed"}var A6e=Sie,T6e=Tie,j6e=jie,Mie=kie;const ip=A6e,ap=T6e,Wh=G.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},a)=>o.jsx(j6e,{children:o.jsx(Mie,{ref:a,align:t,sideOffset:r,className:zt("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Wh.displayName=Mie.displayName;var li=function(){return li=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},li.apply(this,arguments)};function k6e(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Oie(e,t,r){for(var n=0,a=t.length,c;n<a;n++)(c||!(n in t))&&(c||(c=Array.prototype.slice.call(t,0,n)),c[n]=t[n]);return e.concat(c||Array.prototype.slice.call(t))}function B2(e){return e.mode==="multiple"}function V2(e){return e.mode==="range"}function Vj(e){return e.mode==="single"}var P6e={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function C6e(e,t){return Ol(e,"LLLL y",t)}function E6e(e,t){return Ol(e,"d",t)}function M6e(e,t){return Ol(e,"LLLL",t)}function O6e(e){return"".concat(e)}function R6e(e,t){return Ol(e,"cccccc",t)}function I6e(e,t){return Ol(e,"yyyy",t)}var L6e=Object.freeze({__proto__:null,formatCaption:C6e,formatDay:E6e,formatMonthCaption:M6e,formatWeekNumber:O6e,formatWeekdayName:R6e,formatYearCaption:I6e}),D6e=function(e,t,r){return Ol(e,"do MMMM (EEEE)",r)},F6e=function(){return"Month: "},z6e=function(){return"Go to next month"},B6e=function(){return"Go to previous month"},V6e=function(e,t){return Ol(e,"cccc",t)},U6e=function(e){return"Week n. ".concat(e)},$6e=function(){return"Year: "},q6e=Object.freeze({__proto__:null,labelDay:D6e,labelMonthDropdown:F6e,labelNext:z6e,labelPrevious:B6e,labelWeekNumber:U6e,labelWeekday:V6e,labelYearDropdown:$6e});function G6e(){var e="buttons",t=P6e,r=gie,n={},a={},c=1,h={},i=new Date;return{captionLayout:e,classNames:t,formatters:L6e,labels:q6e,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:c,styles:h,today:i,mode:"default"}}function W6e(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,a=e.toMonth,c=e.fromDate,h=e.toDate;return n?c=ru(n):t&&(c=new Date(t,0,1)),a?h=s5(a):r&&(h=new Date(r,11,31)),{fromDate:c?h_(c):void 0,toDate:h?h_(h):void 0}}var Rie=G.createContext(void 0);function H6e(e){var t,r=e.initialProps,n=G6e(),a=W6e(r),c=a.fromDate,h=a.toDate,i=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;i!=="buttons"&&(!c||!h)&&(i="buttons");var x;(Vj(r)||B2(r)||V2(r))&&(x=r.onSelect);var w=li(li(li({},n),r),{captionLayout:i,classNames:li(li({},n.classNames),r.classNames),components:li({},r.components),formatters:li(li({},n.formatters),r.formatters),fromDate:c,labels:li(li({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:li(li({},n.modifiers),r.modifiers),modifiersClassNames:li(li({},n.modifiersClassNames),r.modifiersClassNames),onSelect:x,styles:li(li({},n.styles),r.styles),toDate:h});return o.jsx(Rie.Provider,{value:w,children:e.children})}function as(){var e=G.useContext(Rie);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function Iie(e){var t=as(),r=t.locale,n=t.classNames,a=t.styles,c=t.formatters.formatCaption;return o.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:c(e.displayMonth,{locale:r})})}function K6e(e){return o.jsx("svg",li({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:o.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Lie(e){var t,r,n=e.onChange,a=e.value,c=e.children,h=e.caption,i=e.className,x=e.style,w=as(),S=(r=(t=w.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:K6e;return o.jsxs("div",{className:i,style:x,children:[o.jsx("span",{className:w.classNames.vhidden,children:e["aria-label"]}),o.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:w.classNames.dropdown,style:w.styles.dropdown,value:a,onChange:n,children:c}),o.jsxs("div",{className:w.classNames.caption_label,style:w.styles.caption_label,"aria-hidden":"true",children:[h,o.jsx(S,{className:w.classNames.dropdown_icon,style:w.styles.dropdown_icon})]})]})}function Z6e(e){var t,r=as(),n=r.fromDate,a=r.toDate,c=r.styles,h=r.locale,i=r.formatters.formatMonthCaption,x=r.classNames,w=r.components,S=r.labels.labelMonthDropdown;if(!n)return o.jsx(o.Fragment,{});if(!a)return o.jsx(o.Fragment,{});var T=[];if(m6e(n,a))for(var E=ru(n),D=n.getMonth();D<=a.getMonth();D++)T.push(ON(E,D));else for(var E=ru(new Date),D=0;D<=11;D++)T.push(ON(E,D));var U=function(V){var H=Number(V.target.value),K=ON(ru(e.displayMonth),H);e.onChange(K)},I=(t=w==null?void 0:w.Dropdown)!==null&&t!==void 0?t:Lie;return o.jsx(I,{name:"months","aria-label":S(),className:x.dropdown_month,style:c.dropdown_month,onChange:U,value:e.displayMonth.getMonth(),caption:i(e.displayMonth,{locale:h}),children:T.map(function(V){return o.jsx("option",{value:V.getMonth(),children:i(V,{locale:h})},V.getMonth())})})}function Y6e(e){var t,r=e.displayMonth,n=as(),a=n.fromDate,c=n.toDate,h=n.locale,i=n.styles,x=n.classNames,w=n.components,S=n.formatters.formatYearCaption,T=n.labels.labelYearDropdown,E=[];if(!a)return o.jsx(o.Fragment,{});if(!c)return o.jsx(o.Fragment,{});for(var D=a.getFullYear(),U=c.getFullYear(),I=D;I<=U;I++)E.push($3(pie(new Date),I));var V=function(K){var Q=$3(ru(r),Number(K.target.value));e.onChange(Q)},H=(t=w==null?void 0:w.Dropdown)!==null&&t!==void 0?t:Lie;return o.jsx(H,{name:"years","aria-label":T(),className:x.dropdown_year,style:i.dropdown_year,onChange:V,value:r.getFullYear(),caption:S(r,{locale:h}),children:E.map(function(K){return o.jsx("option",{value:K.getFullYear(),children:S(K,{locale:h})},K.getFullYear())})})}function X6e(e,t){var r=G.useState(e),n=r[0],a=r[1],c=t===void 0?n:t;return[c,a]}function J6e(e){var t=e.month,r=e.defaultMonth,n=e.today,a=t||r||n||new Date,c=e.toDate,h=e.fromDate,i=e.numberOfMonths,x=i===void 0?1:i;if(c&&Uw(c,a)<0){var w=-1*(x-1);a=Qh(c,w)}return h&&Uw(a,h)<0&&(a=h),ru(a)}function Q6e(){var e=as(),t=J6e(e),r=X6e(t,e.month),n=r[0],a=r[1],c=function(h){var i;if(!e.disableNavigation){var x=ru(h);a(x),(i=e.onMonthChange)===null||i===void 0||i.call(e,x)}};return[n,c]}function eVe(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,a=ru(e),c=ru(Qh(a,n)),h=Uw(c,a),i=[],x=0;x<h;x++){var w=Qh(a,x);i.push(w)}return r&&(i=i.reverse()),i}function tVe(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,a=t.numberOfMonths,c=a===void 0?1:a,h=n?c:1,i=ru(e);if(!r)return Qh(i,h);var x=Uw(r,e);if(!(x<c))return Qh(i,h)}}function rVe(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,a=t.numberOfMonths,c=a===void 0?1:a,h=n?c:1,i=ru(e);if(!r)return Qh(i,-h);var x=Uw(i,r);if(!(x<=0))return Qh(i,-h)}}var Die=G.createContext(void 0);function nVe(e){var t=as(),r=Q6e(),n=r[0],a=r[1],c=eVe(n,t),h=tVe(n,t),i=rVe(n,t),x=function(T){return c.some(function(E){return l5(T,E)})},w=function(T,E){x(T)||(E&&bie(T,E)?a(Qh(T,1+t.numberOfMonths*-1)):a(T))},S={currentMonth:n,displayMonths:c,goToMonth:a,goToDate:w,previousMonth:i,nextMonth:h,isDateDisplayed:x};return o.jsx(Die.Provider,{value:S,children:e.children})}function U2(){var e=G.useContext(Die);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function zW(e){var t,r=as(),n=r.classNames,a=r.styles,c=r.components,h=U2().goToMonth,i=function(S){h(Qh(S,e.displayIndex?-e.displayIndex:0))},x=(t=c==null?void 0:c.CaptionLabel)!==null&&t!==void 0?t:Iie,w=o.jsx(x,{id:e.id,displayMonth:e.displayMonth});return o.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[o.jsx("div",{className:n.vhidden,children:w}),o.jsx(Z6e,{onChange:i,displayMonth:e.displayMonth}),o.jsx(Y6e,{onChange:i,displayMonth:e.displayMonth})]})}function iVe(e){return o.jsx("svg",li({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:o.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function aVe(e){return o.jsx("svg",li({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:o.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var _T=G.forwardRef(function(e,t){var r=as(),n=r.classNames,a=r.styles,c=[n.button_reset,n.button];e.className&&c.push(e.className);var h=c.join(" "),i=li(li({},a.button_reset),a.button);return e.style&&Object.assign(i,e.style),o.jsx("button",li({},e,{ref:t,type:"button",className:h,style:i}))});function sVe(e){var t,r,n=as(),a=n.dir,c=n.locale,h=n.classNames,i=n.styles,x=n.labels,w=x.labelPrevious,S=x.labelNext,T=n.components;if(!e.nextMonth&&!e.previousMonth)return o.jsx(o.Fragment,{});var E=w(e.previousMonth,{locale:c}),D=[h.nav_button,h.nav_button_previous].join(" "),U=S(e.nextMonth,{locale:c}),I=[h.nav_button,h.nav_button_next].join(" "),V=(t=T==null?void 0:T.IconRight)!==null&&t!==void 0?t:aVe,H=(r=T==null?void 0:T.IconLeft)!==null&&r!==void 0?r:iVe;return o.jsxs("div",{className:h.nav,style:i.nav,children:[!e.hidePrevious&&o.jsx(_T,{name:"previous-month","aria-label":E,className:D,style:i.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?o.jsx(V,{className:h.nav_icon,style:i.nav_icon}):o.jsx(H,{className:h.nav_icon,style:i.nav_icon})}),!e.hideNext&&o.jsx(_T,{name:"next-month","aria-label":U,className:I,style:i.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?o.jsx(H,{className:h.nav_icon,style:i.nav_icon}):o.jsx(V,{className:h.nav_icon,style:i.nav_icon})})]})}function BW(e){var t=as().numberOfMonths,r=U2(),n=r.previousMonth,a=r.nextMonth,c=r.goToMonth,h=r.displayMonths,i=h.findIndex(function(U){return l5(e.displayMonth,U)}),x=i===0,w=i===h.length-1,S=t>1&&(x||!w),T=t>1&&(w||!x),E=function(){n&&c(n)},D=function(){a&&c(a)};return o.jsx(sVe,{displayMonth:e.displayMonth,hideNext:S,hidePrevious:T,nextMonth:a,previousMonth:n,onPreviousClick:E,onNextClick:D})}function oVe(e){var t,r=as(),n=r.classNames,a=r.disableNavigation,c=r.styles,h=r.captionLayout,i=r.components,x=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:Iie,w;return a?w=o.jsx(x,{id:e.id,displayMonth:e.displayMonth}):h==="dropdown"?w=o.jsx(zW,{displayMonth:e.displayMonth,id:e.id}):h==="dropdown-buttons"?w=o.jsxs(o.Fragment,{children:[o.jsx(zW,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),o.jsx(BW,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):w=o.jsxs(o.Fragment,{children:[o.jsx(x,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),o.jsx(BW,{displayMonth:e.displayMonth,id:e.id})]}),o.jsx("div",{className:n.caption,style:c.caption,children:w})}function lVe(e){var t=as(),r=t.footer,n=t.styles,a=t.classNames.tfoot;return r?o.jsx("tfoot",{className:a,style:n.tfoot,children:o.jsx("tr",{children:o.jsx("td",{colSpan:8,children:r})})}):o.jsx(o.Fragment,{})}function cVe(e,t,r){for(var n=r?X0(new Date):pp(new Date,{locale:e,weekStartsOn:t}),a=[],c=0;c<7;c++){var h=vc(n,c);a.push(h)}return a}function uVe(){var e=as(),t=e.classNames,r=e.styles,n=e.showWeekNumber,a=e.locale,c=e.weekStartsOn,h=e.ISOWeek,i=e.formatters.formatWeekdayName,x=e.labels.labelWeekday,w=cVe(a,c,h);return o.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&o.jsx("td",{style:r.head_cell,className:t.head_cell}),w.map(function(S,T){return o.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":x(S,{locale:a}),children:i(S,{locale:a})},T)})]})}function dVe(){var e,t=as(),r=t.classNames,n=t.styles,a=t.components,c=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:uVe;return o.jsx("thead",{style:n.head,className:r.head,children:o.jsx(c,{})})}function hVe(e){var t=as(),r=t.locale,n=t.formatters.formatDay;return o.jsx(o.Fragment,{children:n(e.date,{locale:r})})}var d5=G.createContext(void 0);function fVe(e){if(!B2(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return o.jsx(d5.Provider,{value:t,children:e.children})}return o.jsx(pVe,{initialProps:e.initialProps,children:e.children})}function pVe(e){var t=e.initialProps,r=e.children,n=t.selected,a=t.min,c=t.max,h=function(w,S,T){var E,D;(E=t.onDayClick)===null||E===void 0||E.call(t,w,S,T);var U=!!(S.selected&&a&&(n==null?void 0:n.length)===a);if(!U){var I=!!(!S.selected&&c&&(n==null?void 0:n.length)===c);if(!I){var V=n?Oie([],n):[];if(S.selected){var H=V.findIndex(function(K){return Qc(w,K)});V.splice(H,1)}else V.push(w);(D=t.onSelect)===null||D===void 0||D.call(t,V,w,S,T)}}},i={disabled:[]};n&&i.disabled.push(function(w){var S=c&&n.length>c-1,T=n.some(function(E){return Qc(E,w)});return!!(S&&!T)});var x={selected:n,onDayClick:h,modifiers:i};return o.jsx(d5.Provider,{value:x,children:r})}function h5(){var e=G.useContext(d5);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function mVe(e,t){var r=t||{},n=r.from,a=r.to;return n&&a?Qc(a,e)&&Qc(n,e)?void 0:Qc(a,e)?{from:a,to:void 0}:Qc(n,e)?void 0:U3(n,e)?{from:e,to:a}:{from:n,to:e}:a?U3(e,a)?{from:a,to:e}:{from:e,to:a}:n?bie(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var f5=G.createContext(void 0);function gVe(e){if(!V2(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return o.jsx(f5.Provider,{value:t,children:e.children})}return o.jsx(yVe,{initialProps:e.initialProps,children:e.children})}function yVe(e){var t=e.initialProps,r=e.children,n=t.selected,a=n||{},c=a.from,h=a.to,i=t.min,x=t.max,w=function(D,U,I){var V,H;(V=t.onDayClick)===null||V===void 0||V.call(t,D,U,I);var K=mVe(D,n);(H=t.onSelect)===null||H===void 0||H.call(t,K,D,U,I)},S={range_start:[],range_end:[],range_middle:[],disabled:[]};if(c?(S.range_start=[c],h?(S.range_end=[h],Qc(c,h)||(S.range_middle=[{after:c,before:h}])):S.range_end=[c]):h&&(S.range_start=[h],S.range_end=[h]),i&&(c&&!h&&S.disabled.push({after:XO(c,i-1),before:vc(c,i-1)}),c&&h&&S.disabled.push({after:c,before:vc(c,i-1)}),!c&&h&&S.disabled.push({after:XO(h,i-1),before:vc(h,i-1)})),x){if(c&&!h&&(S.disabled.push({before:vc(c,-x+1)}),S.disabled.push({after:vc(c,x-1)})),c&&h){var T=Xf(h,c)+1,E=x-T;S.disabled.push({before:XO(c,E)}),S.disabled.push({after:vc(h,E)})}!c&&h&&(S.disabled.push({before:vc(h,-x+1)}),S.disabled.push({after:vc(h,x-1)}))}return o.jsx(f5.Provider,{value:{selected:n,onDayClick:w,modifiers:S},children:r})}function p5(){var e=G.useContext(f5);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function RN(e){return Array.isArray(e)?Oie([],e):e!==void 0?[e]:[]}function xVe(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],a=r[1];t[n]=RN(a)}),t}var ef;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(ef||(ef={}));var vVe=ef.Selected,lm=ef.Disabled,_Ve=ef.Hidden,bVe=ef.Today,JO=ef.RangeEnd,QO=ef.RangeMiddle,eR=ef.RangeStart,wVe=ef.Outside;function SVe(e,t,r){var n,a=(n={},n[vVe]=RN(e.selected),n[lm]=RN(e.disabled),n[_Ve]=RN(e.hidden),n[bVe]=[e.today],n[JO]=[],n[QO]=[],n[eR]=[],n[wVe]=[],n);return e.fromDate&&a[lm].push({before:e.fromDate}),e.toDate&&a[lm].push({after:e.toDate}),B2(e)?a[lm]=a[lm].concat(t.modifiers[lm]):V2(e)&&(a[lm]=a[lm].concat(r.modifiers[lm]),a[eR]=r.modifiers[eR],a[QO]=r.modifiers[QO],a[JO]=r.modifiers[JO]),a}var Fie=G.createContext(void 0);function NVe(e){var t=as(),r=h5(),n=p5(),a=SVe(t,r,n),c=xVe(t.modifiers),h=li(li({},a),c);return o.jsx(Fie.Provider,{value:h,children:e.children})}function zie(){var e=G.useContext(Fie);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function AVe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function TVe(e){return!!(e&&typeof e=="object"&&"from"in e)}function jVe(e){return!!(e&&typeof e=="object"&&"after"in e)}function kVe(e){return!!(e&&typeof e=="object"&&"before"in e)}function PVe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function CVe(e,t){var r,n=t.from,a=t.to;if(n&&a){var c=Xf(a,n)<0;c&&(r=[a,n],n=r[0],a=r[1]);var h=Xf(e,n)>=0&&Xf(a,e)>=0;return h}return a?Qc(a,e):n?Qc(n,e):!1}function EVe(e){return a5(e)}function MVe(e){return Array.isArray(e)&&e.every(a5)}function OVe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(EVe(r))return Qc(e,r);if(MVe(r))return r.includes(e);if(TVe(r))return CVe(e,r);if(PVe(r))return r.dayOfWeek.includes(e.getDay());if(AVe(r)){var n=Xf(r.before,e),a=Xf(r.after,e),c=n>0,h=a<0,i=U3(r.before,r.after);return i?h&&c:c||h}return jVe(r)?Xf(e,r.after)>0:kVe(r)?Xf(r.before,e)>0:typeof r=="function"?r(e):!1})}function m5(e,t,r){var n=Object.keys(t).reduce(function(c,h){var i=t[h];return OVe(e,i)&&c.push(h),c},[]),a={};return n.forEach(function(c){return a[c]=!0}),r&&!l5(e,r)&&(a.outside=!0),a}function RVe(e,t){for(var r=ru(e[0]),n=s5(e[e.length-1]),a,c,h=r;h<=n;){var i=m5(h,t),x=!i.disabled&&!i.hidden;if(!x){h=vc(h,1);continue}if(i.selected)return h;i.today&&!c&&(c=h),a||(a=h),h=vc(h,1)}return c||a}var IVe=365;function Bie(e,t){var r=t.moveBy,n=t.direction,a=t.context,c=t.modifiers,h=t.retry,i=h===void 0?{count:0,lastFocused:e}:h,x=a.weekStartsOn,w=a.fromDate,S=a.toDate,T=a.locale,E={day:vc,week:V3,month:Qh,year:dBe,startOfWeek:function(V){return a.ISOWeek?X0(V):pp(V,{locale:T,weekStartsOn:x})},endOfWeek:function(V){return a.ISOWeek?mie(V):o5(V,{locale:T,weekStartsOn:x})}},D=E[r](e,n==="after"?1:-1);n==="before"&&w?D=hBe([w,D]):n==="after"&&S&&(D=fBe([S,D]));var U=!0;if(c){var I=m5(D,c);U=!I.disabled&&!I.hidden}return U?D:i.count>IVe?i.lastFocused:Bie(D,{moveBy:r,direction:n,context:a,modifiers:c,retry:li(li({},i),{count:i.count+1})})}var Vie=G.createContext(void 0);function LVe(e){var t=U2(),r=zie(),n=G.useState(),a=n[0],c=n[1],h=G.useState(),i=h[0],x=h[1],w=RVe(t.displayMonths,r),S=a??(i&&t.isDateDisplayed(i))?i:w,T=function(){x(a),c(void 0)},E=function(V){c(V)},D=as(),U=function(V,H){if(a){var K=Bie(a,{moveBy:V,direction:H,context:D,modifiers:r});Qc(a,K)||(t.goToDate(K,a),E(K))}},I={focusedDay:a,focusTarget:S,blur:T,focus:E,focusDayAfter:function(){return U("day","after")},focusDayBefore:function(){return U("day","before")},focusWeekAfter:function(){return U("week","after")},focusWeekBefore:function(){return U("week","before")},focusMonthBefore:function(){return U("month","before")},focusMonthAfter:function(){return U("month","after")},focusYearBefore:function(){return U("year","before")},focusYearAfter:function(){return U("year","after")},focusStartOfWeek:function(){return U("startOfWeek","before")},focusEndOfWeek:function(){return U("endOfWeek","after")}};return o.jsx(Vie.Provider,{value:I,children:e.children})}function g5(){var e=G.useContext(Vie);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function DVe(e,t){var r=zie(),n=m5(e,r,t);return n}var y5=G.createContext(void 0);function FVe(e){if(!Vj(e.initialProps)){var t={selected:void 0};return o.jsx(y5.Provider,{value:t,children:e.children})}return o.jsx(zVe,{initialProps:e.initialProps,children:e.children})}function zVe(e){var t=e.initialProps,r=e.children,n=function(c,h,i){var x,w,S;if((x=t.onDayClick)===null||x===void 0||x.call(t,c,h,i),h.selected&&!t.required){(w=t.onSelect)===null||w===void 0||w.call(t,void 0,c,h,i);return}(S=t.onSelect)===null||S===void 0||S.call(t,c,c,h,i)},a={selected:t.selected,onDayClick:n};return o.jsx(y5.Provider,{value:a,children:r})}function Uie(){var e=G.useContext(y5);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function BVe(e,t){var r=as(),n=Uie(),a=h5(),c=p5(),h=g5(),i=h.focusDayAfter,x=h.focusDayBefore,w=h.focusWeekAfter,S=h.focusWeekBefore,T=h.blur,E=h.focus,D=h.focusMonthBefore,U=h.focusMonthAfter,I=h.focusYearBefore,V=h.focusYearAfter,H=h.focusStartOfWeek,K=h.focusEndOfWeek,Q=function(Pe){var Me,Be,Ge,We;Vj(r)?(Me=n.onDayClick)===null||Me===void 0||Me.call(n,e,t,Pe):B2(r)?(Be=a.onDayClick)===null||Be===void 0||Be.call(a,e,t,Pe):V2(r)?(Ge=c.onDayClick)===null||Ge===void 0||Ge.call(c,e,t,Pe):(We=r.onDayClick)===null||We===void 0||We.call(r,e,t,Pe)},ae=function(Pe){var Me;E(e),(Me=r.onDayFocus)===null||Me===void 0||Me.call(r,e,t,Pe)},ee=function(Pe){var Me;T(),(Me=r.onDayBlur)===null||Me===void 0||Me.call(r,e,t,Pe)},se=function(Pe){var Me;(Me=r.onDayMouseEnter)===null||Me===void 0||Me.call(r,e,t,Pe)},ue=function(Pe){var Me;(Me=r.onDayMouseLeave)===null||Me===void 0||Me.call(r,e,t,Pe)},he=function(Pe){var Me;(Me=r.onDayPointerEnter)===null||Me===void 0||Me.call(r,e,t,Pe)},Ce=function(Pe){var Me;(Me=r.onDayPointerLeave)===null||Me===void 0||Me.call(r,e,t,Pe)},Ne=function(Pe){var Me;(Me=r.onDayTouchCancel)===null||Me===void 0||Me.call(r,e,t,Pe)},me=function(Pe){var Me;(Me=r.onDayTouchEnd)===null||Me===void 0||Me.call(r,e,t,Pe)},be=function(Pe){var Me;(Me=r.onDayTouchMove)===null||Me===void 0||Me.call(r,e,t,Pe)},pe=function(Pe){var Me;(Me=r.onDayTouchStart)===null||Me===void 0||Me.call(r,e,t,Pe)},Se=function(Pe){var Me;(Me=r.onDayKeyUp)===null||Me===void 0||Me.call(r,e,t,Pe)},Ee=function(Pe){var Me;switch(Pe.key){case"ArrowLeft":Pe.preventDefault(),Pe.stopPropagation(),r.dir==="rtl"?i():x();break;case"ArrowRight":Pe.preventDefault(),Pe.stopPropagation(),r.dir==="rtl"?x():i();break;case"ArrowDown":Pe.preventDefault(),Pe.stopPropagation(),w();break;case"ArrowUp":Pe.preventDefault(),Pe.stopPropagation(),S();break;case"PageUp":Pe.preventDefault(),Pe.stopPropagation(),Pe.shiftKey?I():D();break;case"PageDown":Pe.preventDefault(),Pe.stopPropagation(),Pe.shiftKey?V():U();break;case"Home":Pe.preventDefault(),Pe.stopPropagation(),H();break;case"End":Pe.preventDefault(),Pe.stopPropagation(),K();break}(Me=r.onDayKeyDown)===null||Me===void 0||Me.call(r,e,t,Pe)},we={onClick:Q,onFocus:ae,onBlur:ee,onKeyDown:Ee,onKeyUp:Se,onMouseEnter:se,onMouseLeave:ue,onPointerEnter:he,onPointerLeave:Ce,onTouchCancel:Ne,onTouchEnd:me,onTouchMove:be,onTouchStart:pe};return we}function VVe(){var e=as(),t=Uie(),r=h5(),n=p5(),a=Vj(e)?t.selected:B2(e)?r.selected:V2(e)?n.selected:void 0;return a}function UVe(e){return Object.values(ef).includes(e)}function $Ve(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var a=e.modifiersClassNames[n];if(a)r.push(a);else if(UVe(n)){var c=e.classNames["day_".concat(n)];c&&r.push(c)}}),r}function qVe(e,t){var r=li({},e.styles.day);return Object.keys(t).forEach(function(n){var a;r=li(li({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function GVe(e,t,r){var n,a,c,h=as(),i=g5(),x=DVe(e,t),w=BVe(e,x),S=VVe(),T=!!(h.onDayClick||h.mode!=="default");G.useEffect(function(){var se;x.outside||i.focusedDay&&T&&Qc(i.focusedDay,e)&&((se=r.current)===null||se===void 0||se.focus())},[i.focusedDay,e,r,T,x.outside]);var E=$Ve(h,x).join(" "),D=qVe(h,x),U=!!(x.outside&&!h.showOutsideDays||x.hidden),I=(c=(a=h.components)===null||a===void 0?void 0:a.DayContent)!==null&&c!==void 0?c:hVe,V=o.jsx(I,{date:e,displayMonth:t,activeModifiers:x}),H={style:D,className:E,children:V,role:"gridcell"},K=i.focusTarget&&Qc(i.focusTarget,e)&&!x.outside,Q=i.focusedDay&&Qc(i.focusedDay,e),ae=li(li(li({},H),(n={disabled:x.disabled,role:"gridcell"},n["aria-selected"]=x.selected,n.tabIndex=Q||K?0:-1,n)),w),ee={isButton:T,isHidden:U,activeModifiers:x,selectedDays:S,buttonProps:ae,divProps:H};return ee}function WVe(e){var t=G.useRef(null),r=GVe(e.date,e.displayMonth,t);return r.isHidden?o.jsx("div",{role:"gridcell"}):r.isButton?o.jsx(_T,li({name:"day",ref:t},r.buttonProps)):o.jsx("div",li({},r.divProps))}function HVe(e){var t=e.number,r=e.dates,n=as(),a=n.onWeekNumberClick,c=n.styles,h=n.classNames,i=n.locale,x=n.labels.labelWeekNumber,w=n.formatters.formatWeekNumber,S=w(Number(t),{locale:i});if(!a)return o.jsx("span",{className:h.weeknumber,style:c.weeknumber,children:S});var T=x(Number(t),{locale:i}),E=function(D){a(t,r,D)};return o.jsx(_T,{name:"week-number","aria-label":T,className:h.weeknumber,style:c.weeknumber,onClick:E,children:S})}function KVe(e){var t,r,n=as(),a=n.styles,c=n.classNames,h=n.showWeekNumber,i=n.components,x=(t=i==null?void 0:i.Day)!==null&&t!==void 0?t:WVe,w=(r=i==null?void 0:i.WeekNumber)!==null&&r!==void 0?r:HVe,S;return h&&(S=o.jsx("td",{className:c.cell,style:a.cell,children:o.jsx(w,{number:e.weekNumber,dates:e.dates})})),o.jsxs("tr",{className:c.row,style:a.row,children:[S,e.dates.map(function(T){return o.jsx("td",{className:c.cell,style:a.cell,role:"presentation",children:o.jsx(x,{displayMonth:e.displayMonth,date:T})},h6e(T))})]})}function VW(e,t,r){for(var n=r!=null&&r.ISOWeek?mie(t):o5(t,r),a=r!=null&&r.ISOWeek?X0(e):pp(e,r),c=Xf(n,a),h=[],i=0;i<=c;i++)h.push(vc(a,i));var x=h.reduce(function(w,S){var T=r!=null&&r.ISOWeek?yie(S):vie(S,r),E=w.find(function(D){return D.weekNumber===T});return E?(E.dates.push(S),w):(w.push({weekNumber:T,dates:[S]}),w)},[]);return x}function ZVe(e,t){var r=VW(ru(e),s5(e),t);if(t!=null&&t.useFixedWeeks){var n=p6e(e,t);if(n<6){var a=r[r.length-1],c=a.dates[a.dates.length-1],h=V3(c,6-n),i=VW(V3(c,1),h,t);r.push.apply(r,i)}}return r}function YVe(e){var t,r,n,a=as(),c=a.locale,h=a.classNames,i=a.styles,x=a.hideHead,w=a.fixedWeeks,S=a.components,T=a.weekStartsOn,E=a.firstWeekContainsDate,D=a.ISOWeek,U=ZVe(e.displayMonth,{useFixedWeeks:!!w,ISOWeek:D,locale:c,weekStartsOn:T,firstWeekContainsDate:E}),I=(t=S==null?void 0:S.Head)!==null&&t!==void 0?t:dVe,V=(r=S==null?void 0:S.Row)!==null&&r!==void 0?r:KVe,H=(n=S==null?void 0:S.Footer)!==null&&n!==void 0?n:lVe;return o.jsxs("table",{id:e.id,className:h.table,style:i.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!x&&o.jsx(I,{}),o.jsx("tbody",{className:h.tbody,style:i.tbody,children:U.map(function(K){return o.jsx(V,{displayMonth:e.displayMonth,dates:K.dates,weekNumber:K.weekNumber},K.weekNumber)})}),o.jsx(H,{displayMonth:e.displayMonth})]})}function XVe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var JVe=XVe()?G.useLayoutEffect:G.useEffect,tR=!1,QVe=0;function UW(){return"react-day-picker-".concat(++QVe)}function eUe(e){var t,r=e??(tR?UW():null),n=G.useState(r),a=n[0],c=n[1];return JVe(function(){a===null&&c(UW())},[]),G.useEffect(function(){tR===!1&&(tR=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function tUe(e){var t,r,n=as(),a=n.dir,c=n.classNames,h=n.styles,i=n.components,x=U2().displayMonths,w=eUe(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),S=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,T=[c.month],E=h.month,D=e.displayIndex===0,U=e.displayIndex===x.length-1,I=!D&&!U;a==="rtl"&&(t=[D,U],U=t[0],D=t[1]),D&&(T.push(c.caption_start),E=li(li({},E),h.caption_start)),U&&(T.push(c.caption_end),E=li(li({},E),h.caption_end)),I&&(T.push(c.caption_between),E=li(li({},E),h.caption_between));var V=(r=i==null?void 0:i.Caption)!==null&&r!==void 0?r:oVe;return o.jsxs("div",{className:T.join(" "),style:E,children:[o.jsx(V,{id:w,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),o.jsx(YVe,{id:S,"aria-labelledby":w,displayMonth:e.displayMonth})]},e.displayIndex)}function rUe(e){var t=as(),r=t.classNames,n=t.styles;return o.jsx("div",{className:r.months,style:n.months,children:e.children})}function nUe(e){var t,r,n=e.initialProps,a=as(),c=g5(),h=U2(),i=G.useState(!1),x=i[0],w=i[1];G.useEffect(function(){a.initialFocus&&c.focusTarget&&(x||(c.focus(c.focusTarget),w(!0)))},[a.initialFocus,x,c.focus,c.focusTarget,c]);var S=[a.classNames.root,a.className];a.numberOfMonths>1&&S.push(a.classNames.multiple_months),a.showWeekNumber&&S.push(a.classNames.with_weeknumber);var T=li(li({},a.styles.root),a.style),E=Object.keys(n).filter(function(U){return U.startsWith("data-")}).reduce(function(U,I){var V;return li(li({},U),(V={},V[I]=n[I],V))},{}),D=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:rUe;return o.jsx("div",li({className:S.join(" "),style:T,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},E,{children:o.jsx(D,{children:h.displayMonths.map(function(U,I){return o.jsx(tUe,{displayIndex:I,displayMonth:U},I)})})}))}function iUe(e){var t=e.children,r=k6e(e,["children"]);return o.jsx(H6e,{initialProps:r,children:o.jsx(nVe,{children:o.jsx(FVe,{initialProps:r,children:o.jsx(fVe,{initialProps:r,children:o.jsx(gVe,{initialProps:r,children:o.jsx(NVe,{children:o.jsx(LVe,{children:t})})})})})})})}function aUe(e){return o.jsx(iUe,li({},e,{children:o.jsx(nUe,{initialProps:e})}))}function bT({className:e,classNames:t,showOutsideDays:r=!0,...n}){return o.jsx(aUe,{showOutsideDays:r,className:zt("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-start pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:zt(j1({variant:"outline"}),"h-7 w-7 bg-transparent hidden p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:zt("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md",n.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:zt(j1({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({className:a,...c})=>o.jsx(s4,{className:zt("h-4 w-4",a),...c}),IconRight:({className:a,...c})=>o.jsx(z0,{className:zt("h-4 w-4",a),...c})},...n})}bT.displayName="Calendar";const F0=({fieldValue:e,dateValue:t})=>{const r=new Date,[n,a]=G.useState(e||r),[c,h]=G.useState((e||r).getFullYear()),[i,x]=G.useState((e||r).getMonth()),w=E=>{h(E);const D=$3(n,E);a(D),t&&t(D)},S=E=>{x(E);const D=ON(n,E);a(D),t&&t(D)},T=E=>{E&&(a(E),h(E.getFullYear()),x(E.getMonth()),t&&t(E))};return G.useEffect(()=>{e&&(a(e),h(e.getFullYear()),x(e.getMonth()))},[e]),o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(Js,{onValueChange:E=>S(parseInt(E,10)),value:i.toString(),children:[o.jsx(Vs,{children:o.jsx(yo,{placeholder:"Select Month"})}),o.jsx(Us,{children:Array.from({length:12},(E,D)=>o.jsx(An,{value:D.toString(),children:Ol(new Date(2e3,D,1),"MMMM")},D))})]}),o.jsxs(Js,{onValueChange:E=>w(parseInt(E,10)),value:c.toString(),children:[o.jsx(Vs,{children:o.jsx(yo,{placeholder:"Select Year"})}),o.jsx(Us,{children:Array.from({length:150},(E,D)=>{const U=new Date().getFullYear()-50+D;return o.jsx(An,{value:U.toString(),children:U},U)})})]})]}),o.jsx("div",{className:"border rounded-md",children:o.jsx(bT,{mode:"single",selected:n,onSelect:T,disabled:E=>E<new Date("1900-01-01"),fromYear:1900,toYear:new Date().getFullYear()+10,month:n,onMonthChange:E=>{a(E),h(E.getFullYear()),x(E.getMonth())}})}),o.jsx("div",{className:"flex justify-end",children:o.jsx(ur,{type:"button",variant:"outline",onClick:()=>{x(r.getMonth()),h(r.getFullYear()),a(r),t&&t(r)},children:"Today"})})]})},$f={region:"DAVAO ORIENTAL",municipalities:{BANAYBANAY:{barangays:{CABANGCALAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},CAGANGANAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CALUBIHAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CAUSWAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAHAYAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAPUTI:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MOGBONGCOGON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},PANIKIAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},PINTATAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"PISO PROPER":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},"PUNTA LINAO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"RANG-AY":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN VICENTE":{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},BOSTON:{barangays:{CAATIHAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CABASAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CARMEN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CAWAYANAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},"SAN JOSE":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SIBAJAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SIMULAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},BAGANGA:{barangays:{BACULIN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BANAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BATAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BATIANO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BINONDO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BOBONAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CAMPAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},DAPNAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},KINABLANGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAMBAJON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LUCOD:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAHANUB:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MIKIT:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SALINGCOMOT:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ISIDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN VICTOR":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SAOQUEGUE:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}},CARAGA:{barangays:{ALVAR:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CANINGAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DON LEON BALANTE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAMIAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MANORIGAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MERCEDES:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"PALMA GIL":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},PICHON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},"SAN ANTONIO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN JOSE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN LUIS":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN MIGUEL":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN PEDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SANTA FE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SANTIAGO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SOBRECAREY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}},CATEEL:{barangays:{ABIJOD:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},ALEGRIA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},ALIWAGWAG:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},ARAGON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BAYBAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGLAHUS:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAINIT:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MALIBAGO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ALFONSO":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN ANTONIO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN MIGUEL":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN RAFAEL":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN VICENTE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SANTA FILOMENA":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAYTAYAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]}}},"GOVERNOR GENEROSO":{barangays:{ANITAP:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"CRISPIN DELA CRUZ":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DON AURELIO CHICOTE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAVIGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LUZON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGDUG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"MANUEL ROXAS":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MONTSERRAT:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},NANGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},OREGON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},PUNDAGUITAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SERGIO OSMEA":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SUROP:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGABEBE:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAMBAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"TANDANG SORA":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TIBANBAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TIBLAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"UPPER TIBANBAN":{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},LUPON:{barangays:{BAGUMBAYAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CABADIANGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CALAPAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},COCORNON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CORPORACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"DON MARIANO MARCOS":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},ILANGAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LANGKA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LANTAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LIMBAHAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MACANGAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGSAYSAY:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAHAYAHAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MARAGATAS:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MARAYAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"NEW VISAYAS":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ISIDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN JOSE":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGBOA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAGUGPO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},MANAY:{barangays:{CAPASNAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CAYAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},CONCEPCION:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DEL PILAR":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},GUZA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"HOLY CROSS":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAMBOG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MABINI:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MANREZA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"NEW TAOKANGA":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"OLD MACOPA":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},RIZAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN FERMIN":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN IGNACIO":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN ISIDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},ZARAGOSA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}},"CITY OF MATI":{barangays:{BADAS:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BOBON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BUSO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CABUAYA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},CULIAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},DAHICAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},DANAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},DAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"DON ENRIQUE LOPEZ":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DON MARTIN MARUNDAN":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"DON SALVADOR LOPEZ, SR.":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LANGKA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAWIGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LIBUDON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LUBAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MACAMBOL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAMALI:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MATIAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAYO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SAINZ:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SANGHAY:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGABAKID:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAGBINONGA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGUIBO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAMISAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},"SAN ISIDRO":{barangays:{BAON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BATOBATO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BITAOGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CAMBALEON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},DUGMANON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},IBA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"LA UNION":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"LAPU-LAPU":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MANIKLING:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAPUTI:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN MIGUEL":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ROQUE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SANTO ROSARIO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SUDLON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TALISAY:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},TARRAGONA:{barangays:{CABAGAYAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},DADONG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},JOVELLAR:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LIMOT:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LUCATAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGANDA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},OMPAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TOMOAONG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TUBAON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}}}},sUe=({form:e,isEditMode:t=!1,onLocationChange:r})=>{const[n,a]=G.useState(""),[c,h]=G.useState(""),[i,x]=G.useState(""),[w,S]=G.useState(""),[T,E]=G.useState(""),[D,U]=G.useState(""),V=Object.keys($f.municipalities).filter(he=>he.toLowerCase().includes(w.toLowerCase())),K=(n?Object.keys($f.municipalities[n].barangays):[]).filter(he=>he.toLowerCase().includes(T.toLowerCase())),ae=(n&&c?$f.municipalities[n].barangays[c].puroks:[]).filter(he=>he.toLowerCase().includes(D.toLowerCase())),ee=he=>{console.log("Setting municipality:",he),a(he),h(""),x(""),S(""),E(""),U(""),console.log("=== SETTING MUNICIPALITY ==="),console.log("Setting municipality to:",he),e.setValue("municipality",he,{shouldValidate:!0,shouldDirty:!0}),e.setValue("barangay","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("province",$f.region,{shouldValidate:!0,shouldDirty:!0}),console.log("Form values after municipality change:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")}),setTimeout(()=>{console.log("Form values after 100ms delay:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")})},100),r&&r({region:$f.region,municipality:he,barangay:"",purok:""})},se=he=>{console.log("Setting barangay:",he),h(he),x(""),E(""),U(""),console.log("=== SETTING BARANGAY ==="),console.log("Setting barangay to:",he),e.setValue("barangay",he,{shouldValidate:!0,shouldDirty:!0}),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}),console.log("Form values after barangay change:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")}),setTimeout(()=>{console.log("Form values after barangay 100ms delay:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")})},100),r&&r({region:$f.region,municipality:n,barangay:he,purok:""})},ue=he=>{x(he),U(""),e.setValue("purok",he,{shouldValidate:!0,shouldDirty:!0}),r&&r({region:$f.region,municipality:n,barangay:c,purok:he})};return G.useEffect(()=>{console.log("Initializing province:",$f.region),e.setValue("province",$f.region,{shouldValidate:!0,shouldDirty:!0}),console.log("Form values after province initialization:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")})},[e]),G.useEffect(()=>{const he=e.getValues("municipality"),Ce=e.getValues("barangay"),Ne=e.getValues("purok");console.log("=== INITIALIZING LOCATION SELECTOR ==="),console.log("Current form values:",{currentMunicipality:he,currentBarangay:Ce,currentPurok:Ne}),he&&he!==n&&(console.log("Setting municipality to:",he),a(he)),Ce&&Ce!==c&&(console.log("Setting barangay to:",Ce),h(Ce)),Ne&&Ne!==i&&(console.log("Setting purok to:",Ne),x(Ne))},[e.watch("municipality"),e.watch("barangay"),e.watch("purok")]),G.useEffect(()=>{const he=Ce=>{(w||T||D)&&!Ce.target.closest(".relative")&&(S(""),E(""),U(""))};return document.addEventListener("mousedown",he),()=>{document.removeEventListener("mousedown",he)}},[w,T,D]),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"space-y-0",children:[o.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-0",children:"Province"}),o.jsx("div",{className:"mt-0 p-3 bg-muted rounded-md border",children:o.jsx("span",{className:"text-sm font-medium",children:$f.region})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"space-y-0",children:[o.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-0",children:"Municipality"}),o.jsxs("div",{className:"relative mt-0",children:[o.jsx(Yr,{type:"text",autoFocus:!1,placeholder:"Type to search municipality...",value:n||w,onChange:he=>{const Ce=he.target.value.toUpperCase();S(Ce),n&&Ce!==n&&(a(""),h(""),x(""),e.setValue("municipality","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("barangay","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}))},className:zt("mt-1",e.formState.errors.municipality&&"border-red-400",t&&"text-[8px]")}),w&&o.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-60 overflow-y-auto scrollbar-transparent",children:V.length>0?V.map(he=>o.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-accent text-sm text-foreground",onClick:()=>ee(he),children:he},he)):o.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No municipalities found"})})]}),e.formState.errors.municipality&&o.jsx("p",{className:"text-xs text-red-400 mt-1",children:e.formState.errors.municipality.message})]}),o.jsxs("div",{className:"space-y-0",children:[o.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-0",children:"Barangay"}),o.jsxs("div",{className:"relative mt-0",children:[o.jsx(Yr,{type:"text",autoFocus:!1,placeholder:n?"Type to search barangay...":"Select municipality first",value:c||T,onChange:he=>{const Ce=he.target.value.toUpperCase();E(Ce),c&&Ce!==c&&(h(""),e.setValue("barangay","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}))},disabled:!n,className:zt("mt-1",!n&&"opacity-50 cursor-not-allowed",e.formState.errors.barangay&&"border-red-400",t&&"text-[8px]")}),n&&T&&o.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-60 overflow-y-auto scrollbar-transparent",children:K.length>0?K.map(he=>o.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-accent text-sm text-foreground",onClick:()=>se(he),children:he},he)):o.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No barangays found"})})]}),e.formState.errors.barangay&&o.jsx("p",{className:"text-xs text-red-400 mt-1",children:e.formState.errors.barangay.message})]}),o.jsxs("div",{className:"space-y-0",children:[o.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-0",children:"Purok"}),o.jsxs("div",{className:"relative mt-0",children:[o.jsx(Yr,{type:"text",autoFocus:!1,placeholder:c?"Type to search purok...":"Select barangay first",value:i||D,onChange:he=>{const Ce=he.target.value.toUpperCase();U(Ce),i&&Ce!==i&&(x(""),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}))},disabled:!c,className:zt("mt-1",!c&&"opacity-50 cursor-not-allowed",e.formState.errors.purok&&"border-red-400",t&&"text-[8px]")}),c&&D&&o.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-60 overflow-y-auto scrollbar-transparent",children:ae.length>0?ae.map(he=>o.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-accent text-sm text-foreground",onClick:()=>ue(he),children:he},he)):o.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No puroks found"})})]}),e.formState.errors.purok&&o.jsx("p",{className:"text-xs text-red-400 mt-1",children:e.formState.errors.purok.message})]})]})]})},x5=({onSubmit:e,form:t,submitting:r,onCancel:n,isEditMode:a=!1})=>(Ba(),o.jsx(up,{...t,children:o.jsx("form",{id:"driver-form",onSubmit:t.handleSubmit(e),children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Ml,{className:"text-sm font-medium",children:"Vehicle Information"}),o.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-x-3",children:[o.jsx(an,{control:t.control,name:"plateNo",render:({field:c})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:zt("text-muted-foreground text-xs mb-0",t.formState.errors.plateNo&&"text-red-400"),children:"Plate No."}),o.jsx(Hr,{children:o.jsx(Yr,{...c,type:"text",autoFocus:!1,placeholder:"ABC-123, DEF-456",value:Array.isArray(c.value)?c.value.join(", "):c.value||"",onChange:h=>{if(!a){const i=h.target.value.toUpperCase(),x=i.split(",").map(w=>w.trim()).filter(w=>w.length>0);c.onChange(x.length>0?x:i)}},disabled:a,className:zt("border border-input focus:ring-0 text-black dark:text-white",t.formState.errors.plateNo&&"border-red-400",a&&"bg-gray-100 dark:bg-gray-700 cursor-not-allowed text-[8px] text-gray-600 dark:text-gray-300")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:t.control,name:"fileNo",render:({field:c})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:zt("text-muted-foreground text-xs mb-0",t.formState.errors.fileNo&&"text-red-400"),children:"File No."}),o.jsx(Hr,{className:"mt-0",children:o.jsx(Yr,{...c,type:"text",autoFocus:!1,onChange:h=>{if(!a){const i=h.target.value.toUpperCase();c.onChange(i)}},disabled:a,className:zt("border border-input focus:ring-0 text-black dark:text-white",t.formState.errors.fileNo&&"border-red-400",a&&"bg-gray-100 dark:bg-gray-700 cursor-not-allowed text-[8px] text-gray-600 dark:text-gray-300")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:t.control,name:"ownerRepresentativeName",render:({field:c})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:zt("text-muted-foreground text-xs mb-0",t.formState.errors.ownerRepresentativeName&&"text-red-400"),children:"Owner's Name"}),o.jsx(Hr,{children:o.jsx(Yr,{...c,type:"text",autoFocus:!1,onChange:h=>{const i=h.target.value.toUpperCase();c.onChange(i)},className:zt("border border-input focus:ring-0 text-black dark:text-white",t.formState.errors.ownerRepresentativeName&&"border-red-400",a&&"text-[8px]")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]})]}),o.jsx("div",{children:o.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-9 gap-x-3",children:[o.jsx(an,{control:t.control,name:"birthDate",render:({field:c})=>o.jsxs(nn,{className:"lg:col-span-3 space-y-0",children:[o.jsx(pn,{className:zt("text-muted-foreground text-xs mb-0",t.formState.errors.birthDate&&"text-red-400"),children:"Birthday (Optional)"}),o.jsxs(ip,{children:[o.jsx(ap,{asChild:!0,children:o.jsx(Hr,{children:o.jsxs(ur,{variant:"outline",className:zt("w-full text-left font-normal justify-start",!c.value&&"text-muted-foreground",t.formState.errors.birthDate&&"border-red-400"),children:[o.jsx(Xs,{className:"h-4 w-4 opacity-50"}),c.value?Ol(c.value,"PPP"):o.jsx("span",{children:"Pick a date"})]})})}),o.jsx(Wh,{className:"w-auto p-2 space-y-2",align:"start",children:o.jsx(F0,{fieldValue:c.value,dateValue:h=>t.setValue("birthDate",h,{shouldValidate:!0})})})]}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:t.control,name:"contactNumber",render:({field:c})=>o.jsxs(nn,{className:"lg:col-span-3 space-y-0",children:[o.jsx(pn,{className:zt("text-muted-foreground text-xs mb-0",t.formState.errors.contactNumber&&"text-red-400"),children:"Contact Number (Optional)"}),o.jsx(Hr,{children:o.jsx(Yr,{...c,type:"tel",autoFocus:!1,className:zt("text-black dark:text-white",t.formState.errors.contactNumber&&"border-red-400",a&&"text-[8px]")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:t.control,name:"emailAddress",render:({field:c})=>o.jsxs(nn,{className:"lg:col-span-3 space-y-0",children:[o.jsx(pn,{className:zt("text-muted-foreground text-xs mb-0",t.formState.errors.emailAddress&&"text-red-400"),children:"Email Address (Optional)"}),o.jsx(Hr,{children:o.jsx(Yr,{...c,type:"email",autoFocus:!1,className:zt("text-black dark:text-white",t.formState.errors.emailAddress&&"border-red-400",a&&"text-[8px]")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]})}),o.jsx("div",{children:o.jsx("div",{className:"mt-4",children:o.jsx(sUe,{form:t,isEditMode:a,onLocationChange:c=>{console.log("Location changed:",c)}})})}),o.jsx("div",{children:o.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-9 gap-x-3",children:[o.jsx(an,{control:t.control,name:"hasDriversLicense",render:({field:c})=>{var h;return o.jsxs(nn,{className:"lg:col-span-3 space-y-0",children:[o.jsx(pn,{className:zt("text-muted-foreground text-xs",t.formState.errors.hasDriversLicense&&"text-red-400"),children:"Do you have Driver's License?"}),o.jsxs(Js,{onValueChange:i=>c.onChange(i==="true"),value:((h=c.value)==null?void 0:h.toString())||"",children:[o.jsx(Hr,{children:o.jsx(Vs,{className:zt("text-black dark:text-white",t.formState.errors.hasDriversLicense&&"border-red-400",a&&"text-xs"),children:o.jsx(yo,{placeholder:"Choose option",className:a?"text-xs":""})})}),o.jsx(Us,{className:a?"text-xs":"",children:o.jsxs(P3,{children:[o.jsx(An,{value:"true",className:a?"text-xs":"",children:"Yes"}),o.jsx(An,{value:"false",className:a?"text-xs":"",children:"No"})]})})]}),o.jsx(cn,{className:"text-xs text-red-400"})]})}}),o.jsx(an,{control:t.control,name:"driversLicenseNumber",render:({field:c})=>o.jsxs(nn,{className:"lg:col-span-3 space-y-0",children:[o.jsx(pn,{className:zt("text-muted-foreground text-xs mb-0",t.formState.errors.driversLicenseNumber&&"text-red-400"),children:"Driver's License Number"}),o.jsx(Hr,{children:o.jsx(Yr,{...c,type:"text",autoFocus:!1,onChange:h=>{const i=h.target.value.toUpperCase();c.onChange(i)},className:zt("text-black dark:text-white",t.formState.errors.driversLicenseNumber&&"border-red-400",a&&"text-[8px]")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx("div",{className:"lg:col-span-6"})]})})]})})})),$ie=({open:e,onOpenChange:t,driverData:r,onDriverUpdated:n})=>{const[a,c]=G.useState(!1),[h,i]=G.useState(!1),[x,w]=G.useState(!1),[S,T]=G.useState(null),{token:E}=Ei(),D=jc(Date.now()),U=Ba(),I=ml({resolver:Rl(WZ),defaultValues:{plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0},mode:"onChange"});G.useEffect(()=>{var ee,se,ue,he,Ce,Ne;if(console.log("=== EDIT MODAL USEEFFECT ==="),console.log("Modal open:",e),console.log("Driver data:",r),console.log("Driver data _id:",r==null?void 0:r._id),e&&r){const me=((ee=r.vehicleIds)==null?void 0:ee.map(Se=>Se.plateNo).filter(Boolean))||[],be=((se=r.vehicleIds)==null?void 0:se.map(Se=>Se.fileNo).filter(Boolean))||[];console.log("=== POPULATING EDIT FORM ==="),console.log("Driver data:",r),console.log("Address data:",r.address),console.log("Plate numbers:",me),console.log("File numbers:",be);const pe={plateNo:me.length>0?me:"",fileNo:be.length>0?be.join(", "):"",ownerRepresentativeName:r.ownerRepresentativeName||"",purok:((ue=r.address)==null?void 0:ue.purok)||"",barangay:((he=r.address)==null?void 0:he.barangay)||"",municipality:((Ce=r.address)==null?void 0:Ce.municipality)||"",province:((Ne=r.address)==null?void 0:Ne.province)||"Davao Oriental",contactNumber:r.contactNumber||"",emailAddress:r.emailAddress||"",hasDriversLicense:r.hasDriversLicense||!1,driversLicenseNumber:r.driversLicenseNumber||"",birthDate:r.birthDate?new Date(r.birthDate):void 0};console.log("Form data being set:",pe),I.reset(pe),setTimeout(()=>{console.log("Form values after reset:",I.getValues()),pe.plateNo&&I.setValue("plateNo",pe.plateNo,{shouldValidate:!0,shouldDirty:!0}),pe.fileNo&&I.setValue("fileNo",pe.fileNo,{shouldValidate:!0,shouldDirty:!0}),pe.municipality&&I.setValue("municipality",pe.municipality,{shouldValidate:!0,shouldDirty:!0}),pe.barangay&&I.setValue("barangay",pe.barangay,{shouldValidate:!0,shouldDirty:!0}),pe.purok&&I.setValue("purok",pe.purok,{shouldValidate:!0,shouldDirty:!0}),console.log("Form values after individual set:",I.getValues())},200)}},[e,r,I]);const V=ee=>{var ue,he,Ce,Ne;if(!r)return!1;const se={ownerRepresentativeName:r.ownerRepresentativeName||"",purok:((ue=r.address)==null?void 0:ue.purok)||"",barangay:((he=r.address)==null?void 0:he.barangay)||"",municipality:((Ce=r.address)==null?void 0:Ce.municipality)||"",province:((Ne=r.address)==null?void 0:Ne.province)||"Davao Oriental",contactNumber:r.contactNumber||"",emailAddress:r.emailAddress||"",hasDriversLicense:r.hasDriversLicense||!1,driversLicenseNumber:r.driversLicenseNumber||"",birthDate:r.birthDate?new Date(r.birthDate):void 0};for(const me in se)if(me==="birthDate"){const be=se[me],pe=ee[me];if(be&&pe){if(be.getTime()!==pe.getTime())return!0}else if(be!==pe)return!0}else if(se[me]!==ee[me])return!0;return!1},H=async ee=>{const se=I.getValues();if(console.log("=== EDIT DRIVER FORM SUBMISSION DEBUG ==="),console.log("Form values at submission:",se),!V(se)){w(!0),t(!1);return}const he=[];if((!se.ownerRepresentativeName||se.ownerRepresentativeName.trim()==="")&&he.push("Owner/Representative name is required"),(!se.barangay||se.barangay.trim()==="")&&he.push("Barangay is required"),(!se.municipality||se.municipality.trim()==="")&&he.push("Municipality is required"),(!se.province||se.province.trim()==="")&&he.push("Province is required"),se.hasDriversLicense&&(!se.driversLicenseNumber||se.driversLicenseNumber.trim()==="")&&he.push("Driver's license number is required when you have a driver's license"),se.emailAddress&&se.emailAddress.trim()!==""&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(se.emailAddress)||he.push("Invalid email format")),he.length>0){console.log("Validation errors:",he),Xr.error("Please fill in all required fields",{description:he.join(", ")});return}T(se),i(!0),t(!1)},K=async()=>{var ee,se,ue;c(!0),i(!1);try{if(!r||!r._id){console.error("Invalid driver data:",r),Xr.error("Invalid driver data",{description:"Driver information is missing or invalid."});return}if(!S){console.error("No confirmation data available"),Xr.error("No data to update",{description:"Please try editing the driver again."});return}const he=S,Ce={ownerRepresentativeName:he.ownerRepresentativeName,address:{purok:he.purok,barangay:he.barangay,municipality:he.municipality,province:he.province},contactNumber:he.contactNumber,emailAddress:he.emailAddress,hasDriversLicense:he.hasDriversLicense,driversLicenseNumber:he.driversLicenseNumber};he.birthDate&&(Ce.birthDate=he.birthDate),console.log("=== SENDING TO SERVER ==="),console.log("Content being sent:",Ce),console.log("Address object:",Ce.address),console.log("Driver ID:",r._id),console.log("=== END SERVER DATA ===");const{data:Ne}=await mn.patch(`/driver/${r._id}`,Ce,{headers:{Authorization:E}});if(Ne.success){if(console.log("Server response:",Ne),console.log("Driver data before update:",r),n){const me={...r,ownerRepresentativeName:S.ownerRepresentativeName,address:{purok:S.purok,barangay:S.barangay,municipality:S.municipality,province:S.province},contactNumber:S.contactNumber,emailAddress:S.emailAddress,hasDriversLicense:S.hasDriversLicense,driversLicenseNumber:S.driversLicenseNumber,birthDate:S.birthDate};console.log("Updated driver data being passed:",me),n(me)}t(!1),Xr.success("Driver updated successfully",{description:"The driver information has been updated."}),U("/driver")}}catch(he){console.error("Error updating driver:",he),console.error("Error response:",he.response),console.error("Error response data:",(ee=he.response)==null?void 0:ee.data);let Ce="Failed to update driver";(ue=(se=he.response)==null?void 0:se.data)!=null&&ue.message?Ce=he.response.data.message:he.message&&(Ce=he.message),Xr.error(Ce,{description:D})}finally{c(!1)}},Q=ee=>{!ee&&!a&&I.reset({plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}),t(ee)},ae=()=>{Q(!1)};return o.jsxs(o.Fragment,{children:[o.jsx(Yi,{open:e,onOpenChange:Q,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent animate-in fade-in-0 zoom-in-95 duration-300",children:[o.jsxs(ia,{children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(za,{className:"h-5 w-5"}),"Edit Driver"]}),o.jsx(js,{children:"Update the driver information. Plate number and file number cannot be modified."})]}),o.jsx("div",{className:"space-y-6",children:o.jsx(x5,{form:I,onSubmit:H,submitting:a,onCancel:ae,isEditMode:!0})}),o.jsx(mo,{className:"flex justify-end gap-3 pt-6",children:o.jsxs(ur,{type:"submit",form:"driver-form",disabled:a,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",children:[a&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a?"Updating...":"Update Driver"]})})]})}),o.jsx(Yi,{open:h,onOpenChange:ee=>{i(ee),ee||t(!1)},children:o.jsxs(Bi,{className:"max-w-lg border border-gray-200 animate-in fade-in-0 zoom-in-95 duration-300",children:[o.jsxs(ia,{children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(za,{className:"h-5 w-5"}),"Confirm Driver Information"]}),o.jsx(js,{children:"Please review the updated driver information before submitting."})]}),S&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Vehicle Information (Read-only)"}),o.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600",children:"Plate No:"}),o.jsx("div",{className:"col-span-3",children:Array.isArray(S.plateNo)?S.plateNo.join(", "):S.plateNo}),o.jsx("div",{className:"font-medium text-gray-600",children:"File No:"}),o.jsx("div",{className:"col-span-3 break-all text-xs",children:S.fileNo||"Not provided"}),o.jsx("div",{className:"font-medium text-gray-600",children:"Owner:"}),o.jsx("div",{className:"col-span-3",children:S.ownerRepresentativeName})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Personal Information"}),o.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600",children:"Contact:"}),o.jsx("div",{className:"col-span-3",children:S.contactNumber||"Not provided"}),o.jsx("div",{className:"font-medium text-gray-600",children:"Email:"}),o.jsx("div",{className:"col-span-3",children:S.emailAddress||"Not provided"}),o.jsx("div",{className:"font-medium text-gray-600",children:"Birth Date:"}),o.jsx("div",{className:"col-span-3",children:S.birthDate?new Date(S.birthDate).toLocaleDateString():"Not provided"})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Address Information"}),o.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600",children:"Province:"}),o.jsx("div",{className:"col-span-3",children:S.province}),o.jsx("div",{className:"font-medium text-gray-600",children:"Municipality:"}),o.jsx("div",{className:"col-span-3",children:S.municipality}),o.jsx("div",{className:"font-medium text-gray-600",children:"Barangay:"}),o.jsx("div",{className:"col-span-3",children:S.barangay}),o.jsx("div",{className:"font-medium text-gray-600",children:"Purok:"}),o.jsx("div",{className:"col-span-3",children:S.purok||"Not provided"})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Driver's License"}),o.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600",children:"Has License:"}),o.jsx("div",{className:"col-span-3",children:S.hasDriversLicense?"Yes":"No"}),S.hasDriversLicense&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-medium text-gray-600",children:"License Number:"}),o.jsx("div",{className:"col-span-3",children:S.driversLicenseNumber})]})]})})]})]}),o.jsxs(mo,{className:"flex justify-end gap-3 pt-6",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:()=>{i(!1),t(!0),I.clearErrors()},disabled:a,className:"min-w-[100px] bg-white border-gray-300 text-gray-700 hover:bg-gray-50",children:"Back to Edit"}),o.jsxs(ur,{onClick:K,disabled:a,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",children:[a&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a?"Updating...":"Confirm & Update Driver"]})]})]})}),o.jsx(Yi,{open:x,onOpenChange:ee=>{w(ee),ee||t(!1)},children:o.jsxs(Bi,{className:"max-w-md border border-gray-200 animate-in fade-in-0 zoom-in-95 duration-300",children:[o.jsxs(ia,{children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(za,{className:"h-5 w-5"}),"No Changes Detected"]}),o.jsx(js,{children:"No changes were made to the driver information. Would you like to continue editing?"})]}),o.jsxs(mo,{className:"flex justify-end gap-3 pt-6",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:()=>{w(!1),U("/driver")},className:"min-w-[100px] bg-white border-gray-300 text-gray-700 hover:bg-gray-50",children:"No"}),o.jsx(ur,{onClick:()=>{w(!1),t(!0)},className:"flex items-center gap-2 min-w-[100px] bg-blue-600 hover:bg-blue-700 text-white",children:"Yes"})]})]})})]})},qie=({open:e,onOpenChange:t,driverData:r,onFileNumberClick:n,onDriverUpdated:a})=>{var ue,he,Ce,Ne,me;J0();const[c,h]=G.useState(!1),[i,x]=G.useState(null),[w,S]=G.useState(!1),[T,E]=G.useState(!1),[D,U]=G.useState("personal"),[I,V]=G.useState({});Co(),Ba();const H=Ei(),{token:K}=H||{};G.useEffect(()=>{if(e&&r&&(console.log("=== DRIVER MODAL DEBUG ==="),console.log("Full driverData:",r),console.log("createdBy:",r.createdBy),console.log("createdBy type:",typeof r.createdBy),console.log("createdAt:",r.createdAt),console.log("updatedBy:",r.updatedBy),console.log("updatedBy type:",typeof r.updatedBy),console.log("updatedAt:",r.updatedAt),console.log("=== END DEBUG ===")),!e||!r)return;const pe=[r.createdBy,r.updatedBy].map(Se=>typeof Se=="object"?Se==null?void 0:Se._id:Se).filter(Boolean).filter(Se=>!(Se in I));pe.length&&(async()=>{try{const Se=await Promise.allSettled(pe.map(async Ee=>{try{const{data:we}=await mn.get(`/user/${Ee}`,{headers:{Authorization:K}}),Pe=(we==null?void 0:we.data)||{},Me=Pe.fullname||`${Pe.firstName||""} ${Pe.middleName?Pe.middleName+" ":""}${Pe.lastName||""}`.trim()||Ee;return{id:Ee,name:Me}}catch{return{id:Ee,name:Ee}}}));V(Ee=>{const we={...Ee};return Se.forEach(Pe=>{Pe.status==="fulfilled"&&(we[Pe.value.id]=Pe.value.name)}),we})}catch{}})()},[e,r,K]);const Q=be=>{if(!be)return"Unknown";try{return new Date(be).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return String(be)}},ae=be=>{if(be==null)return"Not indicated";if(typeof be=="string"){const pe=be.trim();return!pe||pe.toLowerCase()==="none"?"Not indicated":pe}return be},ee=async be=>{if(be)if(n)n(be);else{S(!0),h(!0);try{const{data:pe}=await mn.get(`/vehicle/file/${be}`,{headers:{Authorization:K}});pe.success&&x(pe.data)}catch(pe){console.error("Error fetching vehicle data:",pe),Xr.error("Failed to fetch vehicle information")}finally{S(!1)}}},se=be=>{if(!be)return null;const pe=we=>{const Pe=we&&typeof we=="object"&&"date"in we?we.date:we,Me=new Date(Pe);return isNaN(Me.getTime())?null:Me},Ee=(Array.isArray(be)?be:[be]).map(pe).filter(Boolean).sort((we,Pe)=>Pe.getTime()-we.getTime());return Ee.length?Ee[0]:null};return r?o.jsxs(o.Fragment,{children:[o.jsx(Yi,{open:e,onOpenChange:t,children:o.jsxs(Bi,{className:"max-w-2xl h-[80vh] bg-gradient-to-br from-slate-50 to-blue-50 dark:from-gray-900 dark:to-gray-800 border-0 shadow-2xl w-full p-0 overflow-hidden flex flex-col",children:[o.jsx("div",{className:"bg-white dark:bg-transparent px-6 py-4 border-b dark:border-[#424242]",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:((ue=r.ownerRepresentativeName)==null?void 0:ue.charAt(0))||"D"}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r.ownerRepresentativeName}),o.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Driver Profile"})]})]})}),o.jsxs("div",{className:"p-6 bg-white/90 dark:bg-transparent backdrop-blur-sm border border-gray-200 dark:border-[#424242] rounded-lg m-4 mt-2 flex-1 min-h-0 flex flex-col",children:[o.jsx("div",{className:"flex mb-4 sticky top-0 z-10 bg-white/90 dark:bg-transparent backdrop-blur-sm pb-2 -mx-6 px-6 -mt-6 pt-6 border-b border-gray-200 dark:border-[#424242]",children:o.jsxs("div",{className:"flex-1 flex space-x-1 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm p-1 rounded-lg shadow-lg border border-gray-200 dark:border-[#424242]",children:[o.jsxs(ur,{variant:"ghost",onClick:()=>U("personal"),className:`flex-1 flex items-center gap-1 text-xs font-medium transition-all duration-200 ${D==="personal"?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-600 dark:text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-gray-700"}`,children:[o.jsx(fl,{className:"h-3 w-3"}),o.jsx("span",{className:"hidden sm:inline",children:"Personal Information"})]}),o.jsxs(ur,{variant:"ghost",onClick:()=>U("vehicles"),className:`flex-1 flex items-center gap-1 text-xs font-medium transition-all duration-200 ${D==="vehicles"?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-600 dark:text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-gray-700"}`,children:[o.jsx(Nde,{className:"h-3 w-3"}),o.jsx("span",{className:"hidden sm:inline",children:"Assigned Vehicles"})]})]})}),D==="personal"&&o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 flex-1",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(fo,{className:"h-3 w-3"}),"No. of Vehicles"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:Array.isArray(r.vehicleIds)?r.vehicleIds.length:0})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(fl,{className:"h-3 w-3"}),"Owner"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r.ownerRepresentativeName||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Xs,{className:"h-3 w-3"}),"Date of Birth"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r.birthDate?zj(r.birthDate):"None"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(l4,{className:"h-3 w-3"}),"Contact Number"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r.contactNumber||"None"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Hw,{className:"h-3 w-3"}),"Email Address"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 ml-4 truncate",children:r.emailAddress||"None"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(kH,{className:"h-3 w-3"}),"Created By"]}),o.jsxs("div",{className:"ml-4 flex items-center gap-2 text-xs",children:[o.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:(()=>{const be=r==null?void 0:r.createdBy;return be?typeof be=="object"?be.name?be.name:be.fullname||`${be.firstName||""} ${be.middleName?be.middleName+" ":""}${be.lastName||""}`.trim()||"Unknown":I[be]||be:"Unknown"})()}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:""}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:Q(r==null?void 0:r.createdAt)})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(TT,{className:"h-3 w-3"}),"Driver's License"]}),o.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[o.jsx("span",{className:`text-xs font-semibold ${r.hasDriversLicense?"text-blue-600":"text-red-600"}`,children:r.hasDriversLicense?"Yes":"No"}),r.hasDriversLicense&&r.driversLicenseNumber&&o.jsx("span",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100",children:r.driversLicenseNumber})]})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Rd,{className:"h-3 w-3"}),"Purok"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:ae((he=r.address)==null?void 0:he.purok)})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Rd,{className:"h-3 w-3"}),"Barangay"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:ae((Ce=r.address)==null?void 0:Ce.barangay)})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Rd,{className:"h-3 w-3"}),"Municipality"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:ae((Ne=r.address)==null?void 0:Ne.municipality)})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Rd,{className:"h-3 w-3"}),"Province"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:ae((me=r.address)==null?void 0:me.province)})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(za,{className:"h-3 w-3"}),"Last Updated By"]}),o.jsxs("div",{className:"ml-4 flex items-center gap-2 text-xs",children:[o.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:(()=>{const be=r==null?void 0:r.updatedBy;return be?typeof be=="object"?be.name?be.name:be.fullname||`${be.firstName||""} ${be.middleName?be.middleName+" ":""}${be.lastName||""}`.trim()||"Not yet updated":I[be]||be:"Not yet updated"})()}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:""}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:r!=null&&r.updatedAt&&(r!=null&&r.updatedBy)?Q(r.updatedAt):"Not yet updated"})]})]})]})]}),D==="vehicles"&&o.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[o.jsx(fo,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),o.jsx("h3",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:"Assigned Vehicles"})]}),o.jsx("div",{className:"flex-1 overflow-y-auto min-h-0 pr-1 [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400",children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:r.vehicleIds&&r.vehicleIds.length>0?r.vehicleIds.map((be,pe)=>o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] hover:border-blue-300 dark:hover:border-blue-600 shadow-sm",children:[o.jsxs("div",{className:"text-[10px] text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(ho,{className:"h-3 w-3"})," File Number"]}),o.jsx("button",{onClick:()=>ee(be.fileNo),className:"text-sm font-semibold text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:underline break-all mt-0.5",title:`View vehicle details for ${be.fileNo}`,children:be.fileNo}),be.plateNo&&o.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Plate: ",be.plateNo]})]},pe)):o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No vehicles assigned."})})})]})]}),o.jsx("div",{className:"flex-shrink-0 border-t bg-white dark:bg-transparent border-gray-200 dark:border-[#424242] px-6 py-3",children:o.jsx("div",{className:"flex justify-end gap-2",children:o.jsxs(ur,{variant:"outline",size:"sm",onClick:()=>E(!0),className:"text-xs",children:[o.jsx(za,{className:"h-3 w-3 mr-1"}),"Edit Driver"]})})})]})}),o.jsx($ie,{open:T,onOpenChange:E,driverData:r,onDriverUpdated:a}),o.jsx(Yi,{open:c,onOpenChange:h,children:o.jsxs(Bi,{className:"max-w-2xl",children:[o.jsxs(ia,{children:[o.jsxs(aa,{className:"text-xl font-bold flex items-center gap-2",children:[o.jsx(fo,{className:"h-5 w-5 text-blue-600"}),"Vehicle Information"]}),o.jsxs(js,{children:["Vehicle details for file number: ",r==null?void 0:r.fileNo]})]}),w?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i?o.jsx("div",{className:"space-y-4",children:o.jsx(Ri,{children:o.jsxs(Fi,{className:"pt-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Plate Number"}),o.jsx("p",{className:"font-medium text-sm",children:i.plateNo||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"File Number"}),o.jsx("p",{className:"font-medium text-sm",children:i.fileNo||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Engine Number"}),o.jsx("p",{className:"font-medium text-sm",children:i.engineNo||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Chassis Number"}),o.jsx("p",{className:"font-medium text-sm",children:i.chassisNo||"N/A"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Make"}),o.jsx("p",{className:"font-medium text-sm",children:i.make||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Body Type"}),o.jsx("p",{className:"font-medium text-sm",children:i.bodyType||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Color"}),o.jsx("p",{className:"font-medium text-sm",children:i.color||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Classification"}),o.jsx("p",{className:"font-medium text-sm",children:i.classification||"N/A"})]})]})]}),o.jsx(B_,{className:"my-4"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Date of Renewal"}),o.jsx("p",{className:"font-medium text-sm",children:(()=>{const be=se(i.dateOfRenewal);return be?be.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"})()})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Status"}),o.jsx(Qa,{variant:i.status==="Active"?"default":"destructive",children:i.status||"N/A"})]})]})]})})}):o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:"No vehicle information found for this file number."})})]})})]}):null},Gie=({open:e,onOpenChange:t,fileNumber:r})=>{const[n,a]=G.useState(null),[c,h]=G.useState(!1),{token:i}=Ei();G.useEffect(()=>{e&&r&&x()},[e,r]);const x=async()=>{h(!0);try{const{data:S}=await mn.get(`/vehicle/file/${r}`,{headers:{Authorization:i}});S.success&&a(S.data)}catch(S){console.error("Error fetching vehicle data:",S),Xr.error("Failed to fetch vehicle information")}finally{h(!1)}},w=S=>{if(!S)return null;const T=U=>{const I=U&&typeof U=="object"&&"date"in U?U.date:U,V=new Date(I);return isNaN(V.getTime())?null:V},D=(Array.isArray(S)?S:[S]).map(T).filter(Boolean).sort((U,I)=>I.getTime()-U.getTime());return D.length?D[0]:null};return o.jsx(Yi,{open:e,onOpenChange:t,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[90vh] overflow-y-auto animate-in fade-in-0 zoom-in-95 duration-300",children:[o.jsxs(ia,{children:[o.jsxs(aa,{className:"text-xl font-bold flex items-center gap-2",children:[o.jsx(fo,{className:"h-5 w-5 text-blue-600"}),"Vehicle Information"]}),o.jsxs(js,{children:["Vehicle details for file number: ",r]})]}),c?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n?o.jsx("div",{className:"space-y-4",children:o.jsx(Ri,{children:o.jsxs(Fi,{className:"pt-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(ho,{className:"h-4 w-4 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"File Number"}),o.jsx("p",{className:"font-medium text-sm",children:n.fileNo||"N/A"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(fo,{className:"h-4 w-4 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Plate Number"}),o.jsx("p",{className:"font-medium text-sm",children:n.plateNo||"N/A"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(PH,{className:"h-4 w-4 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Engine Number"}),o.jsx("p",{className:"font-medium text-sm",children:n.engineNo||"N/A"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Jb,{className:"h-4 w-4 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Chassis Number"}),o.jsx("p",{className:"font-medium text-sm",children:n.chassisNo||"N/A"})]})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(fo,{className:"h-4 w-4 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Make"}),o.jsx("p",{className:"font-medium text-sm",children:n.make||"N/A"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Jb,{className:"h-4 w-4 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Body Type"}),o.jsx("p",{className:"font-medium text-sm",children:n.bodyType||"N/A"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(TH,{className:"h-4 w-4 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Color"}),o.jsx("p",{className:"font-medium text-sm",children:n.color||"N/A"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Jb,{className:"h-4 w-4 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Classification"}),o.jsx("p",{className:"font-medium text-sm",children:n.classification||"N/A"})]})]})]})]}),o.jsx(B_,{className:"my-4"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Xs,{className:"h-4 w-4 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Date of Renewal"}),o.jsx("p",{className:"font-medium text-sm",children:(()=>{const S=w(n.dateOfRenewal);return S?S.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"})()})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Jb,{className:"h-4 w-4 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Vehicle Status Type"}),o.jsx("p",{className:"font-medium text-sm",children:n.vehicleStatusType||"N/A"})]})]})]}),o.jsx("div",{className:"space-y-3",children:o.jsxs("div",{className:"flex items-center gap-3",children:[n.status==="1"||n.status===1?o.jsx(NH,{className:"h-4 w-4 text-green-500"}):o.jsx(nde,{className:"h-4 w-4 text-red-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Status"}),o.jsx(Qa,{variant:n.status==="1"||n.status===1?"default":"destructive",children:n.status==="1"||n.status===1?"Active":"Inactive"})]})]})})]})]})})}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(fo,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"No vehicle information found"})]})]})})},oUe=()=>{const[e,t]=G.useState([]),{token:r}=Ei(),n=Ba(),a=Co(),[c,h]=G.useState(!0),[i,x]=G.useState(!1),[w,S]=G.useState(null),[T,E]=G.useState(!1),[D,U]=G.useState(!1),[I,V]=G.useState(!1),[H,K]=G.useState("");G.useEffect(()=>{Q()},[]);const Q=async()=>{var pe,Se,Ee,we;try{h(!0),console.log("=== FETCHING DRIVERS ===");const{data:Pe}=await mn.get("/driver",{headers:{Authorization:r}});if(console.log("=== DRIVERS API RESPONSE ==="),console.log("Response success:",Pe.success),console.log("Total drivers received:",((pe=Pe.data)==null?void 0:pe.length)||0),console.log("First driver sample:",(Se=Pe.data)==null?void 0:Se[0]),!Pe.data||!Array.isArray(Pe.data)){console.error("API response does not contain data array:",Pe),t([]);return}const Me=Pe.data.map(Ge=>{var nt,Dt,nr,ir,rr,or,Ft;const We=((nt=Ge.vehicleIds)==null?void 0:nt.map(ze=>ze.plateNo).filter(Boolean))||[],tt=((Dt=Ge.vehicleIds)==null?void 0:Dt.map(ze=>ze.fileNo).filter(Boolean))||[];return{_id:Ge._id,plateNo:We,fileNo:tt,vehicleIds:Ge.vehicleIds||[],vehicleCount:((nr=Ge.vehicleIds)==null?void 0:nr.length)||0,ownerRepresentativeName:Ge.ownerRepresentativeName,fullname:Ge.fullname,birthDate:Ge.birthDate,contactNumber:Ge.contactNumber,emailAddress:Ge.emailAddress,address:Ge.address||{},province:((ir=Ge.address)==null?void 0:ir.province)||Ge.province,municipality:((rr=Ge.address)==null?void 0:rr.municipality)||Ge.municipality,barangay:((or=Ge.address)==null?void 0:or.barangay)||Ge.barangay,purok:(Ft=Ge.address)==null?void 0:Ft.purok,hasDriversLicense:Ge.hasDriversLicense,driversLicenseNumber:Ge.driversLicenseNumber,isActive:Ge.isActive,createdBy:Ge.createdBy,createdAt:Ge.createdAt,updatedBy:Ge.updatedBy,updatedAt:Ge.updatedAt}});console.log("=== PROCESSED DRIVERS ==="),console.log("Total processed:",Me.length),console.log("Active drivers:",Me.filter(Ge=>Ge.isActive).length),console.log("Inactive drivers:",Me.filter(Ge=>!Ge.isActive).length);const Be=Me.filter(Ge=>Ge.isActive);console.log("Setting active drivers in state:",Be.length),t(Be),h(!1)}catch(Pe){console.error("=== ERROR FETCHING DRIVERS ==="),console.error("Error:",Pe),console.error("Error response:",(Ee=Pe.response)==null?void 0:Ee.data),console.error("Error status:",(we=Pe.response)==null?void 0:we.status),t([]),h(!1)}},ae=pe=>{S(pe),U(!0)},ee=pe=>{console.log("=== ONEDIT FUNCTION ==="),console.log("Driver ID:",pe),console.log("Driver data array:",e);const Se=e.find(Ee=>Ee._id===pe);console.log("Found driver:",Se),Se?(S(Se),E(!0)):(console.error("Driver not found with ID:",pe),Xr.error("Driver not found",{description:"The selected driver could not be found."}))},se=()=>{n(`${a.pathname}/inactive`)},ue=pe=>{x(!0),S(pe)},he=()=>{be(!1),x(!1)},Ce=()=>{x(!1)},Ne=pe=>{K(pe),V(!0)},me=pe=>{if(!pe||!pe._id){console.error("Invalid updated driver data:",pe),Xr.error("Failed to update driver data",{description:"The updated driver information is invalid."});return}t(Se=>Se.map(Ee=>{var we,Pe,Me;return Ee._id===pe._id?{...Ee,...pe,vehicleIds:pe.vehicleIds||Ee.vehicleIds||[],plateNo:((we=pe.vehicleIds)==null?void 0:we.map(Be=>Be.plateNo).filter(Boolean))||Ee.plateNo||[],fileNo:((Pe=pe.vehicleIds)==null?void 0:Pe.map(Be=>Be.fileNo).filter(Boolean))||Ee.fileNo||[],vehicleCount:((Me=pe.vehicleIds)==null?void 0:Me.length)||Ee.vehicleCount||0}:Ee})),U(!1),Xr.success("Driver updated successfully",{description:"The driver information has been updated in the table."})},be=async pe=>{const Se=async()=>{var Ee,we;try{return(await mn.patch(`/driver/${w}`,{isActive:pe},{headers:{Authorization:r}})).data}catch(Pe){const Me=((we=(Ee=Pe.response)==null?void 0:Ee.data)==null?void 0:we.message)||"An error occurred";throw new Error(Me)}finally{await Q()}};Xr.promise(Se(),{loading:"Loading...",success:"Driver deactivated",error:Ee=>Ee.message||"Failed to update driver"})};return o.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"bg-white dark:bg-transparent rounded-lg shadow-sm border border-gray-200 dark:border-0 px-4 md:px-6 pt-4 md:pt-6 pb-2 flex-1 flex flex-col min-h-0 overflow-hidden",children:[o.jsx("header",{className:"text-xl md:text-2xl lg:text-3xl font-bold mb-3 md:mb-4 flex-shrink-0",children:"Drivers"}),o.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:o.jsx(Zze,{data:e,filters:["fullname","plateNo","ownerRepresentativeName","municipality","barangay"],tableColumn:QFe,loading:c,onRowClick:ae,onEdit:ee,onDelete:ue,onNavigate:se,onFileNumberClick:Ne})})]}),o.jsx(hie,{open:i,onOpenChange:x,confirm:he,cancel:Ce,title:"Are you sure?",description:"This action cannot be undone. This will deactivate the driver."}),o.jsx(qie,{open:D,onOpenChange:U,driverData:w,onFileNumberClick:Ne,onDriverUpdated:me}),o.jsx($ie,{open:T,onOpenChange:E,driverData:w,onDriverUpdated:me}),o.jsx(Gie,{open:I,onOpenChange:V,fileNumber:H})]})},lUe=()=>{const e=J0(),t=Ba(),[r,n]=G.useState(null),[a,c]=G.useState(!0),[h,i]=G.useState(!1),[x,w]=G.useState(!1),[S,T]=G.useState(""),{token:E}=Ei();G.useEffect(()=>{D()},[]);const D=async()=>{try{const{data:V}=await mn.get(`/driver/${e.id}`,{headers:{Authorization:E}});V&&(n(V.data),i(!0))}catch(V){console.error("Error fetching driver:",V),t("/404")}finally{c(!1)}};if(a)return o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const U=V=>{T(V),w(!0)},I=V=>{n(V)};return o.jsxs(o.Fragment,{children:[o.jsx(qie,{open:h,onOpenChange:V=>{i(V),V||t(-1)},driverData:r,onFileNumberClick:U,onDriverUpdated:I}),o.jsx(Gie,{open:x,onOpenChange:w,fileNumber:S})]})},cUe=()=>{const e=Ba();return o.jsxs("div",{className:"flex flex-col justify-center items-center h-screen",children:[o.jsx("h1",{className:"font-bold text-[80px] md:text-[100px] lg:text-[300px] text-muted-foreground leading-none",children:"404"}),o.jsx("p",{className:"text-lg mb-5",children:"Oops... Page not found."}),o.jsx(ur,{variant:"outline",size:"lg",onClick:()=>e("/"),children:"Go to Home"})]})},uUe=()=>{const[e,t]=G.useState(!1),{token:r}=Ei(),n=J0(),a=jc(Date.now()),[c,h]=G.useState({}),i=Ba(),x=ml({resolver:Rl(WZ),defaultValues:{plateNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}}),{reset:w}=x;G.useEffect(()=>{Object.keys(c).length>0&&w(c)},[c,w]),G.useEffect(()=>{S()},[n.id,r]);const S=async()=>{var D,U,I,V,H,K,Q,ae,ee,se,ue,he,Ce,Ne,me;const E=n.id;try{const{data:be}=await mn.get(`/driver/${E}`,{headers:{Authorization:r}});if(be){const pe={plateNo:(D=be.data)==null?void 0:D.plateNo,ownerRepresentativeName:(U=be.data)==null?void 0:U.ownerRepresentativeName,purok:(V=(I=be.data)==null?void 0:I.address)==null?void 0:V.purok,barangay:(K=(H=be.data)==null?void 0:H.address)==null?void 0:K.barangay,municipality:(ae=(Q=be.data)==null?void 0:Q.address)==null?void 0:ae.municipality,province:((se=(ee=be.data)==null?void 0:ee.address)==null?void 0:se.province)||"Davao Oriental",contactNumber:(ue=be.data)==null?void 0:ue.contactNumber,emailAddress:(he=be.data)==null?void 0:he.emailAddress,hasDriversLicense:(Ce=be.data)==null?void 0:Ce.hasDriversLicense,driversLicenseNumber:(Ne=be.data)==null?void 0:Ne.driversLicenseNumber,birthDate:new Date((me=be.data)==null?void 0:me.birthDate)};h(pe)}}catch(be){console.log(be)}},T=async E=>{t(!0);try{const D={plateNo:E.plateNo,ownerRepresentativeName:E.ownerRepresentativeName,address:{purok:E.purok,barangay:E.barangay,municipality:E.municipality,province:E.province},contactNumber:E.contactNumber,emailAddress:E.emailAddress,hasDriversLicense:E.hasDriversLicense,driversLicenseNumber:E.driversLicenseNumber,birthDate:E.birthDate},{data:U}=await mn.patch(`/driver/${n.id}`,D,{headers:{Authorization:r}});U.success&&(Xr.success("Driver updated",{description:a}),i(-1))}catch(D){console.log(D);const U=D.response.data.message;Xr.error(U,{description:`${a}`})}finally{t(!1)}};return o.jsx(o.Fragment,{children:o.jsxs(Ri,{children:[o.jsxs(Ki,{children:[o.jsx(Zi,{className:"text-xl md:text-3xl font-bold",children:"Edit Driver"}),o.jsx(As,{children:"Fill in required fields to edit driver."})]}),o.jsx(Fi,{children:o.jsx(x5,{form:x,onSubmit:T,submitting:e})})]})})},dUe=({searchPlaceholder:e=null,title:t,filters:r,description:n,tableColumn:a,data:c,loading:h,showAddButton:i=!1,onAdd:x,onAction:w})=>{var se;const[S,T]=Le.useState([]),[E,D]=Le.useState([]),[U,I]=Le.useState({}),[V,H]=Le.useState({pageIndex:0,pageSize:8}),[K,Q]=Le.useState(""),ae=r,ee=R2({data:c,columns:a(w),onSortingChange:T,onColumnFiltersChange:D,onPaginationChange:H,getCoreRowModel:C2(),getPaginationRowModel:M2(),getSortedRowModel:O2(),getFilteredRowModel:E2(),onColumnVisibilityChange:I,onGlobalFilterChange:Q,globalFilterFn:(ue,he,Ce)=>ae.some(Ne=>{const me=ue.getValue(Ne);return String(me).toLowerCase().includes(Ce.toLowerCase())}),state:{pagination:V,sorting:S,columnFilters:E,columnVisibility:U,globalFilter:K}});return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsx(Ml,{className:"font-semibold",children:t}),o.jsxs("div",{className:`md:flex items-center flex-shrink-0 ${e?"justify-between py-3":"justify-end pb-3"}`,children:[o.jsx(Yr,{placeholder:e,value:K??"",onChange:ue=>Q(ue.target.value),className:e?"hidden md:inline md:max-w-sm flex-shrink":"hidden"}),o.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[o.jsxs(ur,{onClick:x,size:"sm",className:i?"w-min flex items-center gap-2":"hidden",children:[o.jsx(v_,{}),o.jsx("span",{className:"hidden lg:inline",children:i})]}),o.jsx(L2,{table:ee})]})]}),o.jsx("div",{className:"rounded-lg border flex-1 overflow-hidden shadow-sm bg-white min-h-0",children:o.jsx("div",{className:"overflow-auto h-full",children:o.jsx("div",{className:"px-4",children:o.jsxs(Im,{children:[o.jsx(Lm,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 border-b-2 border-gray-300",children:ee.getHeaderGroups().map(ue=>o.jsx(Ps,{className:"hover:bg-gray-100/50",children:ue.headers.map(he=>o.jsx(Ts,{className:"text-xs font-semibold text-gray-800 px-3 py-2 whitespace-nowrap",children:fp(he.column.columnDef.header,he.getContext())},he.id))},ue.id))}),o.jsx(Dm,{className:"text-xs",children:h?o.jsx(I2,{rowCount:5,cellCount:ee.getAllColumns().length}):(se=ee.getRowModel().rows)!=null&&se.length?ee.getRowModel().rows.map(ue=>o.jsx(Ps,{"data-state":ue.getIsSelected()&&"selected",className:"hover:bg-gray-100 transition-colors duration-150 border-b border-gray-100",children:ue.getVisibleCells().map(he=>o.jsx(xa,{className:"px-3 py-2 text-gray-800",children:fp(he.column.columnDef.cell,he.getContext())},he.id))},ue.id)):o.jsx(Ps,{className:"hover:bg-transparent",children:o.jsx(xa,{colSpan:ee.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:o.jsxs("div",{className:"flex flex-col items-center justify-center",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),o.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),o.jsx("div",{className:"mt-3 flex-shrink-0",children:o.jsx(D2,{table:ee})})]})},hUe=()=>{const[e,t]=G.useState([]),[r,n]=G.useState(!1),[a,c]=G.useState(""),[h,i]=G.useState(!0),x=Ba(),{token:w}=Ei();G.useEffect(()=>{S()},[]);const S=async()=>{try{const{data:I}=await mn.get("/driver",{headers:{Authorization:w}}),H=I.data.map(K=>({_id:K._id,plateNo:K.plateNo,fileNo:K.fileNo,ownerRepresentativeName:K.ownerRepresentativeName,fullname:K.fullname,birthDate:zj(K.birthDate),contactNumber:K.contactNumber,emailAddress:K.emailAddress,hasDriversLicense:K.hasDriversLicense,driversLicenseNumber:K.driversLicenseNumber,isActive:K.isActive})).filter(K=>K.isActive===!1);t(H),i(!1)}catch(I){i(!1),console.log(I)}},T=I=>{n(!0),c(I)},E=()=>{U(!0),n(!1)},D=()=>{n(!1)},U=async I=>{const V=async()=>{var H,K;try{return(await mn.patch(`/driver/${a}`,{isActive:I},{headers:{Authorization:w}})).data}catch(Q){const ae=((K=(H=Q.response)==null?void 0:H.data)==null?void 0:K.message)||"An error occurred";throw new Error(ae)}finally{await S()}};Xr.promise(V(),{loading:"Loading...",success:"Driver activated",error:H=>H.message||"Failed to update driver"})};return o.jsxs("div",{className:"p-4",children:[o.jsx("header",{className:"text-xl md:text-3xl font-bold mb-5",children:"Deleted Drivers"}),o.jsx("div",{className:" pt-4 md:px-0 md:pt-0",children:o.jsxs(ur,{variant:"outline",className:"shadow-none",onClick:()=>x(-1),children:[o.jsx(n4,{})," Back"]})}),o.jsx("section",{children:o.jsx(dUe,{data:e,searchPlaceholder:"Search Driver...",filters:["fullname","plateNo","ownerRepresentativeName"],tableColumn:JFe,loading:h,onAction:T})}),o.jsx(hie,{open:r,onOpenChange:n,cancel:D,confirm:E,title:"Are you sure?",description:"This action cannot be undone. This will activate the driver."})]})},fUe=()=>{const[e,t]=G.useState(!1),[r,n]=G.useState(1),[a,c]=G.useState(""),[h,i]=G.useState(""),[x,w]=G.useState(""),[S,T]=G.useState(!1),[E,D]=G.useState(!1),{token:U}=Ei(),I=G.useRef(null),V=new Date().getFullYear(),H=Array.from({length:13},(se,ue)=>V-10+ue).reverse(),K=[{value:"1",label:"January"},{value:"2",label:"February"},{value:"3",label:"March"},{value:"4",label:"April"},{value:"5",label:"May"},{value:"6",label:"June"},{value:"7",label:"July"},{value:"8",label:"August"},{value:"9",label:"September"},{value:"10",label:"October"},{value:"11",label:"November"},{value:"12",label:"December"}];G.useEffect(()=>{e||(n(1),c(""),i(""),w(""),D(!1))},[e]);const Q=se=>{c(se),n(2)},ae=()=>{t(!1)},ee=async()=>{var se,ue,he,Ce;if(!a||!h||!x){Xr.error("Please select format, year, and month");return}T(!0);try{const Ne=await mn.get(`/vehicle/export?format=${a}&year=${h}&month=${x}`,{headers:{Authorization:U},responseType:"blob"});if(Ne.status<200||Ne.status>=300){const Me=await Ne.data.text();try{const Be=JSON.parse(Me);Xr.error(Be.message||"Failed to export vehicle data")}catch{Xr.error("Failed to export vehicle data")}return}const me=await Ne.data.text();let be=!1;if(a==="json")try{const Me=JSON.parse(me);Array.isArray(Me)&&Me.length===0&&(be=!0)}catch{(me.trim()===""||me.trim()==="[]")&&(be=!0)}else me.replace(/^\ufeff/,"").split(`
`).filter(Ge=>Ge.trim()!=="").length<=1&&(be=!0);if(be){D(!0),T(!1);return}const pe=new Blob([me],{type:a==="csv"?"text/csv;charset=utf-8;":"application/json;charset=utf-8;"}),Se=window.URL.createObjectURL(pe),Ee=document.createElement("a");Ee.href=Se;const Pe=`vehicles_${((se=K.find(Me=>Me.value===x))==null?void 0:se.label)||x}_${h}.${a}`;Ee.setAttribute("download",Pe),document.body.appendChild(Ee),Ee.click(),document.body.removeChild(Ee),window.URL.revokeObjectURL(Se),Xr.success(`Vehicle data exported successfully as ${a.toUpperCase()}`),t(!1)}catch(Ne){if(console.error("Export error:",Ne),((ue=Ne.response)==null?void 0:ue.data)instanceof Blob)try{const me=await Ne.response.data.text(),be=JSON.parse(me);Xr.error(be.message||"Failed to export vehicle data")}catch{Xr.error("Failed to export vehicle data")}else Xr.error(((Ce=(he=Ne.response)==null?void 0:he.data)==null?void 0:Ce.message)||"Failed to export vehicle data")}finally{T(!1)}};return o.jsxs(ip,{open:e,onOpenChange:t,children:[o.jsx(ap,{asChild:!0,children:o.jsxs(ur,{ref:I,className:"w-min flex items-center gap-2 bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-[#424242] dark:hover:bg-gray-800",children:[o.jsx(o4,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden lg:inline",children:"Export"})]})}),o.jsx(Wh,{className:"w-80 p-4",align:"end",side:"bottom",sideOffset:8,children:r===1?o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"font-semibold text-sm",children:"Select Export Format"}),o.jsx(ur,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>t(!1),children:o.jsx(zd,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(ur,{variant:"outline",className:"w-full justify-start gap-3 h-auto py-3",onClick:()=>Q("csv"),children:[o.jsx(ho,{className:"h-5 w-5"}),o.jsxs("div",{className:"flex flex-col items-start",children:[o.jsx("span",{className:"font-medium",children:"CSV"}),o.jsx("span",{className:"text-xs text-gray-500",children:"Comma-separated values"})]})]}),o.jsxs(ur,{variant:"outline",className:"w-full justify-start gap-3 h-auto py-3",onClick:()=>Q("json"),children:[o.jsx(gde,{className:"h-5 w-5"}),o.jsxs("div",{className:"flex flex-col items-start",children:[o.jsx("span",{className:"font-medium",children:"JSON"}),o.jsx("span",{className:"text-xs text-gray-500",children:"JavaScript Object Notation"})]})]})]})]}):o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"font-semibold text-sm",children:"Select Date Range"}),o.jsx(ur,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>n(1),children:o.jsx(zd,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ml,{htmlFor:"year",className:"text-sm",children:"Year"}),o.jsxs(Js,{value:h,onValueChange:i,children:[o.jsx(Vs,{id:"year",className:"w-full",children:o.jsx(yo,{placeholder:"Select year"})}),o.jsx(Us,{children:H.map(se=>o.jsx(An,{value:se.toString(),children:se},se))})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ml,{htmlFor:"month",className:"text-sm",children:"Month"}),o.jsxs(Js,{value:x,onValueChange:w,children:[o.jsx(Vs,{id:"month",className:"w-full",children:o.jsx(yo,{placeholder:"Select month"})}),o.jsx(Us,{children:K.map(se=>o.jsx(An,{value:se.value,children:se.label},se.value))})]})]})]}),o.jsxs("div",{className:"flex gap-2 pt-2",children:[o.jsx(ur,{variant:"outline",className:"flex-1",onClick:ae,disabled:S,children:"Cancel"}),o.jsx(ur,{className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",onClick:ee,disabled:S||!h||!x,children:S?o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Exporting..."]}):"Export"})]})]})}),o.jsx(Yi,{open:E,onOpenChange:D,children:o.jsxs(Bi,{className:"max-w-md bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[o.jsx(ia,{children:o.jsxs(aa,{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[o.jsx(Hf,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"}),"No Data Available"]})}),o.jsxs("div",{className:"pt-2 pb-3",children:[o.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"No data yet for this selected date range."}),o.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"Please select a different month and year that contains vehicle data."})]}),o.jsx(mo,{children:o.jsx(ur,{onClick:()=>D(!1),className:"bg-blue-600 hover:bg-blue-700 text-white",children:"OK"})})]})})]})},pUe=({title:e,filters:t,tableColumn:r,data:n,loading:a,onRowClick:c,onAdd:h,onEdit:i,onRenew:x,submitting:w})=>{var se;const[S,T]=Le.useState([]),[E,D]=Le.useState([]),[U,I]=Le.useState({}),[V,H]=Le.useState({pageIndex:0,pageSize:9}),[K,Q]=Le.useState(""),ae=t;Le.useEffect(()=>{console.log("=== VEHICLES TABLE DEBUG ==="),console.log("Data prop received:",n),console.log("Data length:",(n==null?void 0:n.length)||0),console.log("Data is array:",Array.isArray(n)),console.log("Loading state:",a),console.log("First 3 vehicles:",n==null?void 0:n.slice(0,3)),console.log("=== END TABLE DEBUG ===")},[n,a]);const ee=R2({data:n,columns:r(i,x,w),onSortingChange:T,onColumnFiltersChange:D,onPaginationChange:H,getCoreRowModel:C2(),getPaginationRowModel:M2(),getSortedRowModel:O2(),getFilteredRowModel:E2(),onColumnVisibilityChange:I,onGlobalFilterChange:Q,globalFilterFn:(ue,he,Ce)=>ae.some(Ne=>{const me=ue.getValue(Ne);return String(me).toLowerCase().includes(Ce.toLowerCase())}),state:{pagination:V,sorting:S,columnFilters:E,columnVisibility:U,globalFilter:K}});return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsx(Ml,{className:"font-semibold",children:e}),o.jsxs("div",{className:`md:flex items-center justify-between py-3 flex-shrink-0
        `,children:[o.jsxs("div",{className:"relative hidden md:inline md:max-w-sm flex-shrink",children:[o.jsx(Kw,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx(Yr,{placeholder:"Search Vehicle...",value:K??"",onChange:ue=>Q(ue.target.value),className:"pl-10 pr-10 bg-white text-black border-gray-300 dark:bg-black dark:text-white dark:border-[#424242]"}),K&&o.jsx("button",{onClick:()=>Q(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:o.jsx(zd,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[o.jsxs(ur,{onClick:h,className:"w-min flex items-center gap-2 bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-[#424242] dark:hover:bg-gray-800",children:[o.jsx(v_,{}),o.jsx("span",{className:"hidden lg:inline",children:"Add Vehicle"})]}),o.jsx(fUe,{}),o.jsx(L2,{table:ee})]})]}),o.jsx("div",{className:"border flex-1 overflow-hidden shadow-sm bg-white dark:bg-transparent border-gray-300 dark:border-[#424242] min-h-0",children:o.jsx("div",{className:"overflow-x-auto overflow-y-auto h-full",children:o.jsx("div",{className:"px-0 min-w-full",children:o.jsxs(Im,{className:"min-w-full",children:[o.jsx(Lm,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 dark:bg-[#18181B] border-b-2 border-gray-300 dark:border-[#424242]",children:ee.getHeaderGroups().map(ue=>o.jsx(Ps,{className:"hover:bg-gray-100/50 dark:hover:bg-[#18181B] dark:bg-[#18181B]",children:ue.headers.map(he=>o.jsx(Ts,{className:"text-xs font-semibold text-gray-800 dark:text-gray-200 px-3 py-2 whitespace-nowrap text-left",children:fp(he.column.columnDef.header,he.getContext())},he.id))},ue.id))}),o.jsx(Dm,{className:"text-xs bg-white dark:bg-transparent",children:a?o.jsx(I2,{rowCount:5,cellCount:ee.getAllColumns().length}):(se=ee.getRowModel().rows)!=null&&se.length?ee.getRowModel().rows.map(ue=>o.jsx(Ps,{onClick:()=>c(ue.original),"data-state":ue.getIsSelected()&&"selected",className:"hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors duration-150 border-b border-gray-100 dark:border-gray-700 cursor-pointer",children:ue.getVisibleCells().map(he=>o.jsx(xa,{className:"px-3 py-2 text-gray-800 dark:text-gray-200 text-left",children:fp(he.column.columnDef.cell,he.getContext())},he.id))},ue.id)):o.jsx(Ps,{className:"hover:bg-transparent",children:o.jsx(xa,{colSpan:ee.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:o.jsxs("div",{className:"flex flex-col items-center justify-center",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),o.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),o.jsx("div",{className:"mt-2 mb-2 flex-shrink-0",children:o.jsx(D2,{table:ee})})]})},q3=({open:e,onOpenChange:t,vehicleData:r,onVehicleUpdated:n})=>{const[a,c]=G.useState(null),[h,i]=G.useState(!1),[x,w]=G.useState(""),[S,T]=G.useState(!1),[E,D]=G.useState(null),[U,I]=G.useState(!1),[V,H]=G.useState(!1),[K,Q]=G.useState(!1),[ae,ee]=G.useState(""),{token:se}=Ei();G.useEffect(()=>{e&&r&&(c(new Date),T(!1),w(""),r.driverId&&ue())},[e,r]);const ue=async()=>{if(r!=null&&r.driverId){I(!0);try{const{data:be}=await mn.get(`/driver/${r.driverId}`,{headers:{Authorization:se}});D(be.data)}catch(be){console.error("Error fetching owner data:",be)}finally{I(!1)}}},he=async()=>{var Pe,Me;if(!r||!a){ee("Please select a renewal date"),Q(!0);return}const be=r.dateOfRenewal||[],pe=Array.isArray(be)?be:[be].filter(Boolean),Se=pe.length?pe[pe.length-1]:null,Ee=Se&&typeof Se=="object"&&Se.date?Se.date:Se;if(Ee&&((Be,Ge)=>{if(!Be||!Ge)return!1;const We=new Date(Be),tt=new Date(Ge);return We.getFullYear()===tt.getFullYear()&&We.getMonth()===tt.getMonth()&&We.getDate()===tt.getDate()})(a,Ee)){ee("The selected date matches the current renewal date. Please choose a different date."),Q(!0);return}i(!0);try{const Ge=[...pe.map(tt=>tt&&typeof tt=="object"&&tt.date?tt.date:tt).filter(Boolean),a.toISOString()],{data:We}=await mn.patch(`/vehicle/${r._id}`,{dateOfRenewal:Ge},{headers:{Authorization:se}});We.success?(T(!0),Xr.success("Vehicle Renewed Successfully",{description:`Renewal date added for ${r.plateNo}`}),n&&n()):(ee(We.message||"Failed to update renewal date"),Q(!0))}catch(Be){console.error("Error updating renewal date:",Be),ee(((Me=(Pe=Be.response)==null?void 0:Pe.data)==null?void 0:Me.message)||"Failed to update renewal date"),Q(!0)}finally{i(!1)}},Ce=be=>be==="1"?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 border-green-200 dark:border-green-700":"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300 border-red-200 dark:border-red-700",Ne=be=>be==="1"?"Active":"Expired",me=()=>{const be=r==null?void 0:r.dateOfRenewal;if(!be)return null;const pe=Array.isArray(be)?be:[be],Se=pe[pe.length-1],Ee=Se&&typeof Se=="object"&&Se.date?Se.date:Se;return Ee?new Date(Ee):null};return r?o.jsxs(o.Fragment,{children:[o.jsx(Yi,{open:e,onOpenChange:t,children:o.jsxs(Bi,{className:"max-w-2xl h-[80vh] bg-gradient-to-br from-slate-50 to-blue-50 dark:from-gray-900 dark:to-gray-800 border-0 shadow-2xl flex flex-col",onPointerDownOutside:be=>be.preventDefault(),onEscapeKeyDown:be=>be.preventDefault(),children:[o.jsx(ia,{className:"pb-3 flex-shrink-0",children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsxs(aa,{className:"text-lg font-bold flex items-center gap-2",children:[o.jsx(fo,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),o.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 dark:from-blue-400 dark:to-purple-400 bg-clip-text text-transparent",children:"Vehicle Renewal"})]}),o.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 mt-1",children:"Update renewal date for vehicle registration"}),o.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-300 mt-1 flex items-center gap-1",children:[o.jsx(ho,{className:"h-3 w-3 text-blue-500 dark:text-blue-400"}),"File Number: ",o.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400 ml-1",children:r.fileNo||"N/A"})]})]})})}),o.jsx("div",{className:"flex flex-col flex-1 min-h-0",children:o.jsxs("div",{className:"space-y-3 mb-4",children:[o.jsxs(Ri,{className:"bg-white dark:bg-gray-800/50 border-gray-200 dark:border-gray-700",children:[o.jsx(Ki,{children:o.jsxs(Zi,{className:"flex items-center justify-between text-gray-900 dark:text-gray-100",children:[o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(fo,{className:"h-4 w-4 text-gray-700 dark:text-gray-300"}),"Vehicle & Owner Information"]}),o.jsx(Qa,{className:Ce(r.status),children:Ne(r.status)})]})}),o.jsx(Fi,{children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800/70 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(qf,{className:"h-3 w-3 text-gray-600 dark:text-gray-400"}),"Plate Number"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r.plateNo})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800/70 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(ho,{className:"h-3 w-3 text-gray-600 dark:text-gray-400"}),"File Number"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r.fileNo||"N/A"})]}),E&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800/70 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(fl,{className:"h-3 w-3 text-gray-600 dark:text-gray-400"}),"Owner Name"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:E.ownerRepresentativeName||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800/70 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm md:col-start-2",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Xs,{className:"h-3 w-3 text-gray-600 dark:text-gray-400"}),"Current Renewal Date"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(()=>{const be=me();return be?be.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set"})()})]}),E.address&&o.jsxs("div",{className:"bg-white dark:bg-gray-800/70 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm md:col-span-2",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Rd,{className:"h-3 w-3 text-gray-600 dark:text-gray-400"}),"Address"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:[E.address.barangay,E.address.municipality,E.address.province].filter(Boolean).join(", ")})]})]})]})})]}),o.jsxs(Ri,{className:"bg-white dark:bg-gray-800/50 border-gray-200 dark:border-gray-700",children:[o.jsx(Ki,{children:o.jsxs(Zi,{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[o.jsx(Xs,{className:"h-4 w-4 text-gray-700 dark:text-gray-300"}),"Vehicle Renewal Date"]})}),o.jsxs(Fi,{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Ml,{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"New Renewal Date"}),o.jsx("div",{className:"mt-2",children:o.jsxs(ip,{children:[o.jsx(ap,{asChild:!0,children:o.jsxs(ur,{variant:"outline",className:zt("w-full justify-start text-left font-normal dark:bg-[#18181B] dark:text-white dark:border-gray-700 dark:hover:bg-[#18181B]",!a&&"text-muted-foreground"),children:[o.jsx(Xs,{className:"mr-2 h-4 w-4"}),a?jc(a):"Pick a date"]})}),o.jsx(Wh,{className:"w-auto p-0",align:"start",children:o.jsx(F0,{fieldValue:a,dateValue:c})})]})})]}),S&&o.jsx("div",{className:"p-3 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md",children:o.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Vehicle renewed successfully!"})}),o.jsx("div",{className:"flex justify-end",children:o.jsxs(ur,{onClick:()=>{w("");const be=r.dateOfRenewal||[],pe=Array.isArray(be)?be:[be].filter(Boolean),Se=pe.length?pe[pe.length-1]:null,Ee=Se&&typeof Se=="object"&&Se.date?Se.date:Se;if(Ee&&((Pe,Me)=>{if(!Pe||!Me)return!1;const Be=new Date(Pe),Ge=new Date(Me);return Be.getFullYear()===Ge.getFullYear()&&Be.getMonth()===Ge.getMonth()&&Be.getDate()===Ge.getDate()})(a,Ee)){ee("The selected date matches the current renewal date. Please choose a different date."),Q(!0);return}H(!0)},disabled:h||!a,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white",children:[h?o.jsx(Nc,{className:"h-4 w-4 animate-spin"}):o.jsx(jH,{className:"h-4 w-4"}),h?"Adding Renewal...":"Click to renew vehicle"]})})]})]})]})})]})}),o.jsx(Yi,{open:V,onOpenChange:H,children:o.jsxs(Bi,{className:"max-w-md bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 animate-in fade-in-0 zoom-in-95 duration-300",children:[o.jsx(ia,{children:o.jsxs(aa,{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[o.jsx(Oue,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),"Renewal Confirmation"]})}),o.jsxs("div",{className:"pt-2 pb-3",children:[o.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Are you sure you want to renew this vehicle?"}),o.jsx("p",{className:"mt-1 text-gray-600 dark:text-gray-300",children:"Please review the details below before confirming."}),o.jsxs("p",{className:"mt-3 text-gray-600 dark:text-gray-300",children:[o.jsx("span",{className:"font-medium",children:"File Number:"})," ",r.fileNo||"N/A"]}),o.jsxs("p",{className:"text-gray-600 dark:text-gray-300",children:[o.jsx("span",{className:"font-medium",children:"Renewal Date:"})," ",a?new Date(a).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):"N/A"]})]}),o.jsxs(mo,{className:"flex justify-end gap-3",children:[o.jsx(ur,{variant:"outline",onClick:()=>H(!1),className:"min-w-[80px] bg-white dark:bg-gray-800 border-gray-300 dark:border-[#424242] text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700",children:"No"}),o.jsx(ur,{onClick:async()=>{H(!1),await he()},className:"min-w-[80px] bg-blue-600 hover:bg-blue-700 text-white",children:"Yes"})]})]})}),o.jsx(Yi,{open:K,onOpenChange:Q,children:o.jsxs(Bi,{className:"max-w-md bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 animate-in fade-in-0 zoom-in-95 duration-300",children:[o.jsx(ia,{children:o.jsxs(aa,{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[o.jsx(Hf,{className:"h-5 w-5 text-red-600 dark:text-red-400"}),"Error"]})}),o.jsx("div",{className:"pt-2 pb-3",children:o.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:ae})}),o.jsx(mo,{className:"flex justify-end gap-3",children:o.jsx(ur,{variant:"outline",onClick:()=>Q(!1),className:"min-w-[80px] bg-white dark:bg-gray-800 border-gray-300 dark:border-[#424242] text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700",children:"OK"})})]})})]}):null},mUe=({open:e,onOpenChange:t,onDriverAdded:r})=>{const[n,a]=G.useState(!1),[c,h]=G.useState(!1),[i,x]=G.useState(null),{token:w}=Ei(),S=jc(Date.now());Ba();const T=ml({defaultValues:{plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0},mode:"onChange"});G.useEffect(()=>{if(e){const V=sessionStorage.getItem("vehicleFormData");if(V){const H=JSON.parse(V);T.reset({plateNo:H.plateNo||"",fileNo:H.fileNo||"",ownerRepresentativeName:H.ownerRepresentativeName||"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0})}else T.reset({plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0});setTimeout(()=>{T.setValue("province","Davao Oriental"),console.log("Province set to:",T.getValues("province")),T.trigger()},100)}},[e,T]);const E=async V=>{const H=T.getValues();console.log("=== FORM SUBMISSION DEBUG ==="),console.log("Form values at submission:",H),console.log("Specific address values:"),console.log("  - barangay:",H.barangay,"(type:",typeof H.barangay,")"),console.log("  - municipality:",H.municipality,"(type:",typeof H.municipality,")"),console.log("  - province:",H.province,"(type:",typeof H.province,")"),console.log("  - purok:",H.purok,"(type:",typeof H.purok,")"),console.log("Value checks:"),console.log("  - barangay empty?",!H.barangay||H.barangay.trim()===""),console.log("  - municipality empty?",!H.municipality||H.municipality.trim()===""),console.log("  - province empty?",!H.province||H.province.trim()===""),console.log("=== END DEBUG ===");const K=[];if((!H.plateNo||Array.isArray(H.plateNo)&&H.plateNo.length===0)&&K.push("Plate number is required"),(!H.ownerRepresentativeName||H.ownerRepresentativeName.trim()==="")&&K.push("Owner/Representative name is required"),(!H.barangay||H.barangay.trim()==="")&&K.push("Barangay is required"),(!H.municipality||H.municipality.trim()==="")&&K.push("Municipality is required"),(!H.province||H.province.trim()==="")&&K.push("Province is required"),H.hasDriversLicense&&(!H.driversLicenseNumber||H.driversLicenseNumber.trim()==="")&&K.push("Driver's license number is required when you have a driver's license"),H.emailAddress&&H.emailAddress.trim()!==""&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(H.emailAddress)||K.push("Invalid email format")),K.length>0){console.log("Validation errors:",K),Xr.error("Please fill in all required fields",{description:K.join(", ")});return}x(H),h(!0),t(!1)},D=async()=>{var V,H;a(!0),h(!1);try{const K=i,Q={plateNo:K.plateNo,fileNo:K.fileNo,ownerRepresentativeName:K.ownerRepresentativeName,address:{purok:K.purok,barangay:K.barangay,municipality:K.municipality,province:K.province},contactNumber:K.contactNumber,emailAddress:K.emailAddress,hasDriversLicense:K.hasDriversLicense,driversLicenseNumber:K.driversLicenseNumber};K.birthDate&&(Q.birthDate=K.birthDate),console.log("=== SENDING TO SERVER ==="),console.log("Content being sent:",Q),console.log("Address object:",Q.address),console.log("=== END SERVER DATA ===");const{data:ae}=await mn.post("/driver",Q,{headers:{Authorization:w}});ae.success&&(Xr.success("Driver has been added",{description:S}),T.reset({plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}),sessionStorage.removeItem("vehicleFormData"),t(!1),r&&r(ae.data))}catch(K){console.log(K);const Q=((H=(V=K.response)==null?void 0:V.data)==null?void 0:H.message)||"Failed to add driver";Xr.error(Q,{description:S})}finally{a(!1)}},U=V=>{!V&&!n&&T.reset({plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}),t(V)},I=()=>{sessionStorage.removeItem("vehicleFormData"),U(!1)};return o.jsxs(o.Fragment,{children:[o.jsx(Yi,{open:e,onOpenChange:U,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent animate-in fade-in-0 zoom-in-95 duration-300",children:[o.jsxs(ia,{children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(fl,{className:"h-5 w-5"}),"Add New Driver"]}),o.jsx(js,{children:"Fill in the required fields to add a new driver record to the system."})]}),o.jsx("div",{className:"space-y-6",children:o.jsx(x5,{form:T,onSubmit:E,submitting:n,onCancel:I})}),o.jsxs(mo,{className:"flex justify-start gap-3 pt-6",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:I,disabled:n,className:"min-w-[100px]",children:"Cancel"}),o.jsxs(ur,{type:"submit",form:"driver-form",disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",children:[n&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Driver"]})]})]})}),o.jsx(Yi,{open:c,onOpenChange:V=>{h(V),V||t(!1)},children:o.jsxs(Bi,{className:"max-w-lg border border-gray-200 animate-in fade-in-0 zoom-in-95 duration-300",children:[o.jsxs(ia,{children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(fl,{className:"h-5 w-5"}),"Confirm Driver Information"]}),o.jsx(js,{children:"Please review the driver information before submitting."})]}),i&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Vehicle Information"}),o.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600",children:"Plate No:"}),o.jsx("div",{className:"col-span-3",children:Array.isArray(i.plateNo)?i.plateNo.join(", "):i.plateNo}),o.jsx("div",{className:"font-medium text-gray-600",children:"File No:"}),o.jsx("div",{className:"col-span-3",children:i.fileNo||"Not provided"}),o.jsx("div",{className:"font-medium text-gray-600",children:"Owner:"}),o.jsx("div",{className:"col-span-3",children:i.ownerRepresentativeName})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Personal Information"}),o.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600",children:"Contact:"}),o.jsx("div",{className:"col-span-3",children:i.contactNumber||"Not provided"}),o.jsx("div",{className:"font-medium text-gray-600",children:"Email:"}),o.jsx("div",{className:"col-span-3",children:i.emailAddress||"Not provided"}),o.jsx("div",{className:"font-medium text-gray-600",children:"Birth Date:"}),o.jsx("div",{className:"col-span-3",children:i.birthDate?new Date(i.birthDate).toLocaleDateString():"Not provided"})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Address Information"}),o.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600",children:"Province:"}),o.jsx("div",{className:"col-span-3",children:i.province}),o.jsx("div",{className:"font-medium text-gray-600",children:"Municipality:"}),o.jsx("div",{className:"col-span-3",children:i.municipality}),o.jsx("div",{className:"font-medium text-gray-600",children:"Barangay:"}),o.jsx("div",{className:"col-span-3",children:i.barangay}),o.jsx("div",{className:"font-medium text-gray-600",children:"Purok:"}),o.jsx("div",{className:"col-span-3",children:i.purok||"Not provided"})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Driver's License"}),o.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600",children:"Has License:"}),o.jsx("div",{className:"col-span-3",children:i.hasDriversLicense?"Yes":"No"}),i.hasDriversLicense&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"font-medium text-gray-600",children:"License Number:"}),o.jsx("div",{className:"col-span-3",children:i.driversLicenseNumber})]})]})})]})]}),o.jsxs(mo,{className:"flex justify-end gap-3 pt-6",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:()=>{h(!1),t(!0),T.clearErrors()},disabled:n,className:"min-w-[100px] bg-white border-gray-300 text-gray-700 hover:bg-gray-50",children:"Back to Edit"}),o.jsxs(ur,{onClick:D,disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-gradient-to-b from-blue-500 to-blue-700 hover:from-blue-600 hover:to-blue-800 text-white shadow-lg border border-blue-600 relative overflow-hidden",children:[n&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Confirm & Add Driver",o.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 bg-gradient-to-br from-blue-300 to-blue-500 transform rotate-45 translate-x-2 -translate-y-2 opacity-60"})]})]})]})})]})},gUe=({open:e,onOpenChange:t,ownerId:r})=>{const[n,a]=G.useState(null),[c,h]=G.useState(!1),{token:i}=Ei();G.useEffect(()=>{e&&r&&x()},[e,r]);const x=async()=>{var T,E;if(!r){console.log("No ownerId found, skipping fetch");return}h(!0);try{console.log(`Fetching owner data for ID: ${r}`);const{data:D}=await mn.get(`/driver/${r}`,{headers:{Authorization:i}});console.log("Owner data received:",D),a(D.data)}catch(D){console.error("Error fetching owner data:",D),console.error("Error response:",(T=D.response)==null?void 0:T.data),console.error("Error status:",(E=D.response)==null?void 0:E.status)}finally{h(!1)}},w=T=>T?new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set",S=()=>c?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Nc,{className:"h-4 w-4 animate-spin text-blue-600"}),o.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Loading owner information..."})]})}):n?o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(fl,{className:"h-3 w-3"}),"Owner/Representative Name"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(n==null?void 0:n.ownerRepresentativeName)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(l4,{className:"h-3 w-3"}),"Contact Number"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(n==null?void 0:n.contactNumber)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Hw,{className:"h-3 w-3"}),"Email Address"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(n==null?void 0:n.emailAddress)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Xs,{className:"h-3 w-3"}),"Birth Date"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:w(n==null?void 0:n.birthDate)})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(TT,{className:"h-3 w-3"}),"Driver's License"]}),o.jsx("div",{className:"ml-4",children:n!=null&&n.hasDriversLicense?o.jsxs("div",{children:[o.jsx(Qa,{variant:"outline",className:"text-green-600 border-green-600 text-xs",children:"Yes"}),(n==null?void 0:n.driversLicenseNumber)&&o.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["License No: ",n.driversLicenseNumber]})]}):o.jsx(Qa,{variant:"outline",className:"text-red-600 border-red-600 text-xs",children:"No"})})]}),(n==null?void 0:n.address)&&o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Rd,{className:"h-3 w-3"}),"Address"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:[n.address.barangay,n.address.municipality,n.address.province].filter(Boolean).join(", ")})]})]}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Hf,{className:"h-8 w-8 text-red-400 mx-auto mb-3"}),o.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mb-2",children:"Failed to load owner information"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Unable to retrieve owner details"})]});return o.jsx(Yi,{open:e,onOpenChange:t,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[80vh] bg-gradient-to-br from-slate-50 to-blue-50 dark:from-gray-900 dark:to-gray-800 border-0 shadow-2xl flex flex-col",onPointerDownOutside:T=>T.preventDefault(),onEscapeKeyDown:T=>T.preventDefault(),children:[o.jsx(ia,{className:"pb-3 flex-shrink-0",children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx(aa,{className:"text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Owner Information"}),o.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Comprehensive owner information including contact details, license status, and address"})]})})}),o.jsx("div",{className:"flex flex-col flex-1 min-h-0",children:o.jsx("div",{className:"flex-1 overflow-y-auto bg-white/90 dark:bg-gray-900/90 backdrop-blur-sm p-3 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:o.jsx(S,{})})})]})})},v5=({onSubmit:e,form:t,submitting:r,hideDateOfRenewal:n=!1,isEditMode:a=!1,readOnlyFields:c=[],prePopulatedOwner:h=""})=>{Ba(),Co();const{token:i}=Ei(),[x,w]=G.useState(""),[S,T]=G.useState([]),[E,D]=G.useState(!1),[U,I]=G.useState(null),[V,H]=G.useState(!1),[K,Q]=G.useState(!1),[ae,ee]=G.useState(!1),[se,ue]=G.useState(!1),[he,Ce]=G.useState(null),Ne=G.useRef(null);G.useEffect(()=>{a&&h&&h.trim()!==""&&(w(h),h&&h!=="Not selected"&&I({_id:t.getValues("driver")||"",ownerRepresentativeName:h}))},[a,h,t]),G.useEffect(()=>{const Pe=setTimeout(async()=>{var Me,Be,Ge,We,tt;if(x.length>=2&&ae){D(!0),H(!1);try{const{data:nt}=await mn.get(`/driver/search?name=${encodeURIComponent(x)}`,{headers:{Authorization:i}});nt.success&&(console.log("Driver search results:",nt.data),console.log("First driver address:",(Me=nt.data[0])==null?void 0:Me.address),console.log("Municipality:",(Ge=(Be=nt.data[0])==null?void 0:Be.address)==null?void 0:Ge.municipality),console.log("Barangay:",(tt=(We=nt.data[0])==null?void 0:We.address)==null?void 0:tt.barangay),T(nt.data),nt.data.length===0&&x.length>=3&&H(!0))}catch(nt){console.error("Error searching drivers:",nt),T([]),x.length>=3&&H(!0)}finally{D(!1)}}else T([]),H(!1)},300);return()=>clearTimeout(Pe)},[x,i,ae]),G.useEffect(()=>{(S.length>0||V)&&setTimeout(()=>{Ne.current&&Ne.current.scrollIntoView({behavior:"smooth",block:"center"})},100)},[S,V]);const me=we=>{I(we),t.setValue("driver",we._id),w(we.ownerRepresentativeName),T([]),H(!1),ee(!1)},be=we=>{Ce(we._id),ue(!0)},pe=()=>{I(null),t.setValue("driver",null),w(""),T([]),H(!1),ee(!1)},Se=()=>{const we=t.getValues();sessionStorage.setItem("vehicleFormData",JSON.stringify({plateNo:we.plateNo||"",fileNo:we.fileNo||"",ownerRepresentativeName:we.ownerRepresentativeName||x||""})),Q(!0)},Ee=we=>{I(we),t.setValue("driver",we._id),w(we.ownerRepresentativeName),T([]),H(!1),Q(!1),ee(!1),Xr.success("Driver added successfully",{description:"The driver has been selected for this vehicle."})};return o.jsxs(up,{...t,children:[o.jsx("form",{id:"vehicle-form",onSubmit:t.handleSubmit(we=>{console.log("Selected driver:",U),console.log("Form data:",we);let Pe=we.driver;a&&!ae&&!U?Pe=we.driver||t.getValues("driver"):U?Pe=U._id:a&&h&&h!=="No driver assigned"&&(Pe=t.getValues("driver")||we.driver);const Me=(U==null?void 0:U.ownerRepresentativeName)||(x&&x!==""?x:h||"Not selected"),Be={...we,driver:Pe,ownerName:Me};console.log("Form data with owner:",Be),e(Be)}),children:o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{children:o.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-3",children:[o.jsx(an,{control:t.control,name:"plateNo",render:({field:we})=>o.jsxs(nn,{className:"lg:col-span-2",children:[o.jsx(pn,{className:zt("text-muted-foreground mb-0",t.formState.errors.plateNo&&"text-red-400"),children:"Plate No."}),o.jsx(Hr,{children:o.jsx(Yr,{...we,type:"text",placeholder:"ABC-123",onChange:Pe=>{const Me=Pe.target.value.toUpperCase();we.onChange(Me)},className:zt("text-black dark:text-white text-sm",t.formState.errors.plateNo&&"border-red-400")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:t.control,name:"fileNo",render:({field:we})=>o.jsxs(nn,{className:"lg:col-span-2",children:[o.jsx(pn,{className:zt("text-muted-foreground mb-0",t.formState.errors.fileNo&&"text-red-400"),children:"File No."}),o.jsx(Hr,{children:o.jsx(Yr,{...we,type:"text",readOnly:a&&c.includes("fileNo"),onChange:Pe=>{if(!(a&&c.includes("fileNo"))){const Me=Pe.target.value.toUpperCase();we.onChange(Me)}},className:zt("text-black dark:text-white text-sm",t.formState.errors.fileNo&&"border-red-400",a&&c.includes("fileNo")&&"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 cursor-not-allowed border-gray-300 dark:border-[#424242]")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:t.control,name:"engineNo",render:({field:we})=>o.jsxs(nn,{className:"lg:col-span-2",children:[o.jsx(pn,{className:zt("text-muted-foreground mb-0",t.formState.errors.engineNo&&"text-red-400"),children:"Engine No."}),o.jsx(Hr,{children:o.jsx(Yr,{...we,type:"text",onChange:Pe=>{const Me=Pe.target.value.toUpperCase();we.onChange(Me)},className:zt("text-black dark:text-white text-sm",t.formState.errors.engineNo&&"border-red-400")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]})}),o.jsx("div",{children:o.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-3",children:[o.jsx(an,{control:t.control,name:"chassisNo",render:({field:we})=>o.jsxs(nn,{className:"lg:col-span-2",children:[o.jsx(pn,{className:zt("text-muted-foreground mb-0",t.formState.errors.chassisNo&&"text-red-400"),children:"Chassis No."}),o.jsx(Hr,{children:o.jsx(Yr,{...we,type:"text",onChange:Pe=>{const Me=Pe.target.value.toUpperCase();we.onChange(Me)},className:zt("text-black dark:text-white text-sm",t.formState.errors.chassisNo&&"border-red-400")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:t.control,name:"make",render:({field:we})=>o.jsxs(nn,{className:"lg:col-span-2",children:[o.jsx(pn,{className:zt("text-muted-foreground mb-0",t.formState.errors.make&&"text-red-400"),children:"Make"}),o.jsx(Hr,{children:o.jsx(Yr,{...we,type:"text",onChange:Pe=>{const Me=Pe.target.value.toUpperCase();we.onChange(Me)},className:zt("text-black dark:text-white text-sm",t.formState.errors.make&&"border-red-400")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:t.control,name:"bodyType",render:({field:we})=>o.jsxs(nn,{className:"lg:col-span-2",children:[o.jsx(pn,{className:zt("text-muted-foreground mb-0",t.formState.errors.bodyType&&"text-red-400"),children:"Body Type"}),o.jsx(Hr,{children:o.jsx(Yr,{...we,type:"text",onChange:Pe=>{const Me=Pe.target.value.toUpperCase();we.onChange(Me)},className:zt("text-black dark:text-white text-sm",t.formState.errors.bodyType&&"border-red-400")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]})}),o.jsx("div",{children:o.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-3",children:[o.jsx(an,{control:t.control,name:"color",render:({field:we})=>o.jsxs(nn,{className:"lg:col-span-2",children:[o.jsx(pn,{className:zt("text-muted-foreground mb-0",t.formState.errors.color&&"text-red-400"),children:"Color"}),o.jsx(Hr,{children:o.jsx(Yr,{...we,type:"text",onChange:Pe=>{const Me=Pe.target.value.toUpperCase();we.onChange(Me)},className:zt("text-black dark:text-white text-sm",t.formState.errors.color&&"border-red-400")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:t.control,name:"classification",render:({field:we})=>o.jsxs(nn,{className:"lg:col-span-2",children:[o.jsx(pn,{className:zt("text-muted-foreground mb-0",t.formState.errors.classification&&"text-red-400"),children:"Classification"}),o.jsxs(Js,{onValueChange:we.onChange,value:we.value,children:[o.jsx(Hr,{children:o.jsx(Vs,{className:zt("text-black dark:text-white text-sm",t.formState.errors.classification&&"border-red-400"),children:o.jsx(yo,{placeholder:"Select classification"})})}),o.jsx(Us,{children:o.jsxs(P3,{children:[o.jsx(C3,{children:"Classifications"}),o.jsx(An,{value:"Private",children:"PRIVATE"}),o.jsx(An,{value:"For Hire",children:"FOR HIRE"}),o.jsx(An,{value:"Government",children:"GOVERNMENT"})]})})]}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:t.control,name:"vehicleStatusType",render:({field:we})=>o.jsxs(nn,{className:"lg:col-span-2",children:[o.jsx(pn,{className:zt("text-muted-foreground mb-0",t.formState.errors.vehicleStatusType&&"text-red-400"),children:"Vehicle Status Type"}),o.jsxs(Js,{onValueChange:we.onChange,value:we.value,children:[o.jsx(Hr,{children:o.jsx(Vs,{className:zt("text-black dark:text-white text-sm",t.formState.errors.vehicleStatusType&&"border-red-400"),children:o.jsx(yo,{placeholder:"Select vehicle status type"})})}),o.jsx(Us,{children:o.jsxs(P3,{children:[o.jsx(C3,{children:"Vehicle Status"}),o.jsx(An,{value:"New",children:"New Vehicle"}),o.jsx(An,{value:"Old",children:"Old Vehicle"})]})})]}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),!n&&o.jsx(an,{control:t.control,name:"dateOfRenewal",render:({field:we})=>o.jsxs(nn,{className:"lg:col-span-2",children:[o.jsx(pn,{className:zt("text-muted-foreground mb-0",t.formState.errors.dateOfRenewal&&"text-red-400"),children:"Date of Renewal"}),a&&c.includes("dateOfRenewal")?o.jsx(Yr,{value:we.value?Ol(we.value,"PPP"):"Not set",readOnly:!0,className:"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 cursor-not-allowed border-gray-300 dark:border-[#424242] text-sm"}):o.jsxs(ip,{children:[o.jsx(ap,{asChild:!0,children:o.jsx(Hr,{children:o.jsxs(ur,{variant:"outline",className:zt("w-full pl-3 text-left font-normal text-black dark:text-white text-sm",!we.value&&"text-muted-foreground",t.formState.errors.dateOfRenewal&&"border-red-400"),children:[we.value?Ol(we.value,"PPP"):o.jsx("span",{children:"Pick a date"}),o.jsx(Xs,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),o.jsx(Wh,{className:"w-auto p-0",align:"start",children:o.jsx(F0,{fieldValue:we.value,dateValue:we.onChange})})]}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]})}),o.jsxs("div",{children:[o.jsx(Ml,{children:"Driver/Owner Information"}),o.jsx("div",{className:"mt-1",children:o.jsx(an,{control:t.control,name:"driver",render:({field:we})=>o.jsxs(nn,{children:[o.jsx(pn,{className:"text-muted-foreground mb-0",children:"Search and Select Driver/Owner"}),o.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Format: Surname Suffix (Optional), FirstName, Middle Initial"}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"flex gap-2",children:o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(Yr,{ref:Ne,placeholder:"Type driver/owner name to search...",value:x,onChange:Pe=>{const Me=Pe.target.value.toUpperCase();w(Me),ae||ee(!0)},onFocus:()=>{ae||ee(!0)},className:zt("pr-10 text-sm",a&&!ae&&"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 cursor-not-allowed border-gray-300 dark:border-[#424242]"),readOnly:a&&!ae}),E&&o.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:o.jsx(Nc,{className:"h-4 w-4 animate-spin text-muted-foreground"})}),!E&&a&&!ae&&o.jsx("button",{type:"button",onClick:()=>ee(!0),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-blue-600 hover:text-blue-800",children:o.jsx(pR,{className:"h-4 w-4"})}),!E&&x&&ae&&o.jsx("button",{type:"button",onClick:pe,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",children:o.jsx(zd,{className:"h-4 w-4"})})]})}),(S.length>0||V)&&ae&&o.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-96 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent hover:scrollbar-thumb-gray-400",children:[S.map(Pe=>o.jsxs("div",{className:"p-3 hover:bg-accent border-b border-border last:border-b-0 transition-colors flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>me(Pe),children:[o.jsx("div",{className:"text-sm font-medium text-foreground",children:Pe.ownerRepresentativeName}),o.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Current vehicles: ",Pe.plateNo||"None"]})]}),o.jsx(ur,{type:"button",variant:"ghost",size:"sm",onClick:Me=>{Me.stopPropagation(),be(Pe)},className:"ml-2 h-6 w-6 p-0 text-blue-600 hover:text-blue-800 hover:bg-blue-50",children:o.jsx(FN,{className:"h-3 w-3"})})]},Pe._id)),V&&S.length===0&&!U&&o.jsxs("div",{className:"p-3 hover:bg-accent cursor-pointer border-b border-border last:border-b-0 bg-accent/50 transition-colors",onClick:Se,children:[o.jsxs("div",{className:"text-sm font-medium text-primary",children:['+ Add "',x,'" as new driver']}),o.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Click to create a new driver record"})]})]}),U&&!ae&&o.jsx("div",{className:"mt-2 p-2 bg-green-50 dark:bg-[#18181B] border border-green-200 dark:border-[#424242] rounded-md",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"text-sm font-medium text-green-800 dark:text-gray-200",children:["Selected: ",o.jsx("span",{className:"dark:text-white dark:font-semibold",children:U.ownerRepresentativeName})]}),o.jsxs("div",{className:"text-xs text-green-600 dark:text-gray-400",children:["Current vehicles: ",U.plateNo||"None"]})]}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx(ur,{type:"button",variant:"ghost",size:"sm",onClick:()=>ee(!0),className:"text-blue-600 hover:text-blue-800 h-6 w-6 p-0",children:o.jsx(pR,{className:"h-3 w-3"})}),o.jsx(ur,{type:"button",variant:"ghost",size:"sm",onClick:pe,className:"text-green-600 hover:text-green-800 h-6 w-6 p-0",children:o.jsx(zd,{className:"h-3 w-3"})})]})]})})]}),o.jsx(cn,{className:"text-xs text-red-400"})]})})})]})]})}),o.jsx(mUe,{open:K,onOpenChange:Q,onDriverAdded:Ee}),o.jsx(gUe,{open:se,onOpenChange:ue,ownerId:he})]})},yUe=({open:e,onOpenChange:t,onVehicleAdded:r})=>{const[n,a]=G.useState(!1),[c,h]=G.useState(!1),[i,x]=G.useState(null),{token:w}=Ei(),S=jc(Date.now()),T=ml({resolver:Rl(HZ),defaultValues:{plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,dateOfRenewal:void 0,vehicleStatusType:"",driver:""}}),E=async I=>{console.log("Received form data in AddVehicleModal:",I),console.log("Owner name:",I.ownerName),x(I),h(!0)},D=async()=>{var I,V;a(!0),h(!1);try{const H=i;console.log("Form data in handleConfirmSubmission:",H),console.log("vehicleStatusType in formData:",H.vehicleStatusType);const K={plateNo:H.plateNo,fileNo:H.fileNo,engineNo:H.engineNo,serialChassisNumber:H.chassisNo,make:H.make,bodyType:H.bodyType,color:H.color,classification:H.classification,vehicleStatusType:H.vehicleStatusType,driverId:H.driver};H.dateOfRenewal&&(K.dateOfRenewal=H.dateOfRenewal),console.log("Content being sent to API:",K),console.log("vehicleStatusType in content:",K.vehicleStatusType),console.log("driverId in content:",K.driverId),console.log("driverId type:",typeof K.driverId),console.log("plateNo in content:",K.plateNo),console.log("fileNo in content:",K.fileNo);const{data:Q}=await mn.post("/vehicle",K,{headers:{Authorization:w}});Q.success&&(Xr.success("Vehicle has been added",{description:S}),T.reset({plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,dateOfRenewal:void 0,driver:""}),t(!1),r&&r())}catch(H){console.log(H);const K=((V=(I=H.response)==null?void 0:I.data)==null?void 0:V.message)||"Failed to add vehicle";Xr.error(K,{description:S})}finally{a(!1)}},U=I=>{!I&&!n&&T.reset({plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,dateOfRenewal:void 0,driver:""}),t(I)};return o.jsxs(o.Fragment,{children:[o.jsx(Yi,{open:e,onOpenChange:U,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[o.jsxs(ia,{className:"flex-shrink-0",children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(fo,{className:"h-5 w-5"}),"Add New Vehicle"]}),o.jsx(js,{children:"Fill in the required fields to add a new vehicle record to the system."})]}),o.jsx("div",{className:"flex-1 overflow-y-auto px-1 py-2",children:o.jsx(v5,{form:T,onSubmit:E,submitting:n})}),o.jsxs(mo,{className:"flex-shrink-0 flex justify-start gap-3 pt-4 border-t",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:()=>U(!1),disabled:n,className:"min-w-[100px]",children:"Cancel"}),o.jsxs(ur,{type:"submit",form:"vehicle-form",disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white shadow-lg",children:[n&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Vehicle"]})]})]})}),o.jsx(Yi,{open:c,onOpenChange:h,children:o.jsxs(Bi,{className:"max-w-lg border-0 dark:border-0 bg-white dark:bg-[#212121]",children:[o.jsxs(ia,{children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(fo,{className:"h-5 w-5"}),"Confirm Vehicle Information"]}),o.jsx(js,{children:"Please review the vehicle information before submitting."})]}),i&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black dark:text-white mb-2 pl-3",children:"Vehicle Details"}),o.jsx("div",{className:"bg-gray-50 dark:bg-[#171717] rounded-md p-3 border border-gray-200 dark:border-[#424242]",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Plate No:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:i.plateNo}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"File No:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:i.fileNo||"Not provided"}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Engine No:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:i.engineNo}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Chassis No:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:i.chassisNo})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black dark:text-white mb-2 pl-3",children:"Vehicle Specifications"}),o.jsx("div",{className:"bg-gray-50 dark:bg-[#171717] rounded-md p-3 border border-gray-200 dark:border-[#424242]",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Make:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:i.make}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Body Type:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:i.bodyType}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Color:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:i.color}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Classification:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:i.classification})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black dark:text-white mb-2 pl-3",children:"Renewal"}),o.jsx("div",{className:"bg-gray-50 dark:bg-[#171717] rounded-md p-3 border border-gray-200 dark:border-[#424242]",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Date of Renewal:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:i.dateOfRenewal?new Date(i.dateOfRenewal).toLocaleDateString():"Not provided"}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Vehicle Status:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:i.vehicleStatusType||"Not selected"})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black dark:text-white mb-2 pl-3",children:"Owner"}),o.jsx("div",{className:"bg-gray-50 dark:bg-[#171717] rounded-md p-3 border border-gray-200 dark:border-[#424242]",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Owner Name:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:i.ownerName||"Not selected"})]})})]})]}),o.jsxs(mo,{className:"flex justify-end gap-3 pt-6",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:()=>{h(!1),T.clearErrors()},disabled:n,className:"min-w-[100px] bg-white dark:bg-[#212121] border-gray-300 dark:border-[#424242] text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-[#171717]",children:"Cancel"}),o.jsxs(ur,{onClick:D,disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-gradient-to-b from-blue-500 to-blue-700 hover:from-blue-600 hover:to-blue-800 text-white shadow-lg border border-blue-600 relative overflow-hidden",children:[n&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Confirm & Add Vehicle",o.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 bg-gradient-to-br from-blue-300 to-blue-500 transform rotate-45 translate-x-2 -translate-y-2 opacity-60"})]})]})]})})]})},xUe=({open:e,onOpenChange:t,onContinue:r,onCancel:n})=>o.jsx(Yi,{open:e,onOpenChange:t,children:o.jsxs(Bi,{className:"max-w-md",children:[o.jsx(ia,{children:o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(pR,{className:"h-5 w-5"}),"No Changes Detected"]})}),o.jsx("div",{className:"py-4",children:o.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"No changes were made to the vehicle information. Would you like to continue editing?"})}),o.jsxs(mo,{className:"flex justify-end gap-3",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:n,className:"min-w-[80px] bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700",children:"No"}),o.jsx(ur,{type:"button",onClick:r,className:"min-w-[80px] bg-blue-600 hover:bg-blue-700 text-white",children:"Yes"})]})]})}),Wie=({open:e,onOpenChange:t,vehicleId:r,onVehicleUpdated:n})=>{const[a,c]=G.useState(!1),[h,i]=G.useState({}),[x,w]=G.useState({}),[S,T]=G.useState(!1),[E,D]=G.useState(!1),[U,I]=G.useState(!1),[V,H]=G.useState(null),{token:K}=Ei(),Q=jc(Date.now()),ae=ml({resolver:Rl(Qye),defaultValues:{plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,vehicleStatusType:"",dateOfRenewal:void 0,driver:"",ownerName:""}}),{reset:ee}=ae;G.useEffect(()=>{e&&r&&se()},[e,r,K]),G.useEffect(()=>{Object.keys(h).length>0&&ee(h)},[h,ee]);const se=async()=>{var Se,Ee,we,Pe,Me,Be,Ge,We,tt,nt,Dt,nr,ir,rr,or;T(!0);try{const{data:Ft}=await mn.get(`/vehicle/${r}`,{headers:{Authorization:K}});if(Ft){console.log("Classification from database:",(Se=Ft.data)==null?void 0:Se.classification),console.log("Full vehicle data:",Ft.data);const ze=on=>on?{PRIVATE:"Private","FOR HIRE":"For Hire",GOVERNMENT:"Government",Private:"Private","For Hire":"For Hire",Government:"Government"}[on]||on:void 0,Pr=on=>{if(!on)return;const Rt=En=>{const Vn=En&&typeof En=="object"&&"date"in En?En.date:En,pi=new Date(Vn);return isNaN(pi.getTime())?null:pi};if(Array.isArray(on)){const En=on.map(Rt).filter(Boolean).sort((Vn,pi)=>pi.getTime()-Vn.getTime());return En.length?En[0]:void 0}return Rt(on)||void 0},Kt={plateNo:((Ee=Ft.data)==null?void 0:Ee.plateNo)||"",fileNo:((we=Ft.data)==null?void 0:we.fileNo)||"",engineNo:((Pe=Ft.data)==null?void 0:Pe.engineNo)||"",chassisNo:((Me=Ft.data)==null?void 0:Me.serialChassisNumber)||"",make:((Be=Ft.data)==null?void 0:Be.make)||"",bodyType:((Ge=Ft.data)==null?void 0:Ge.bodyType)||"",color:((We=Ft.data)==null?void 0:We.color)||"",classification:ze((tt=Ft.data)==null?void 0:tt.classification),vehicleStatusType:((nt=Ft.data)==null?void 0:nt.vehicleStatusType)||"Old",dateOfRenewal:Pr((Dt=Ft.data)==null?void 0:Dt.dateOfRenewal),driver:((ir=(nr=Ft.data)==null?void 0:nr.driverId)==null?void 0:ir._id)||"",ownerName:((or=(rr=Ft.data)==null?void 0:rr.driverId)==null?void 0:or.ownerRepresentativeName)||"No driver assigned"};i(Kt),w(Kt)}}catch(Ft){console.log(Ft),Xr.error("Failed to load vehicle data",{description:Q})}finally{T(!1)}},ue=Se=>{const Ee={plateNo:Se.plateNo,engineNo:Se.engineNo,chassisNo:Se.chassisNo,make:Se.make,bodyType:Se.bodyType,color:Se.color,classification:Se.classification,vehicleStatusType:Se.vehicleStatusType,driver:Se.driver},we={plateNo:x.plateNo,engineNo:x.engineNo,chassisNo:x.chassisNo,make:x.make,bodyType:x.bodyType,color:x.color,classification:x.classification,vehicleStatusType:x.vehicleStatusType,driver:x.driver};return JSON.stringify(Ee)!==JSON.stringify(we)},he=async Se=>{if(!ue(Se)){D(!0);return}H(Se),I(!0)},Ce=async()=>{var Se,Ee;if(V){I(!1),c(!0);try{const we={plateNo:V.plateNo,fileNo:V.fileNo,engineNo:V.engineNo,serialChassisNumber:V.chassisNo,make:V.make,bodyType:V.bodyType,color:V.color,classification:V.classification,vehicleStatusType:V.vehicleStatusType,...V.driver&&V.driver!==x.driver&&{driverId:V.driver}},{data:Pe}=await mn.patch(`/vehicle/${r}`,we,{headers:{Authorization:K}});Pe.success&&(Xr.success("Vehicle updated successfully",{description:Q}),t(!1),n&&n())}catch(we){console.log(we);const Pe=((Ee=(Se=we.response)==null?void 0:Se.data)==null?void 0:Ee.message)||"An error occurred";Xr.error(Pe,{description:Q})}finally{c(!1),H(null)}}},Ne=()=>{I(!1),H(null)},me=Se=>{!Se&&!a&&(ae.reset({plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,vehicleStatusType:"",dateOfRenewal:void 0,driver:"",ownerName:""}),i({})),t(Se)},be=()=>{D(!1)},pe=()=>{D(!1),t(!1)};return S?o.jsx(Yi,{open:e,onOpenChange:me,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[o.jsxs(ia,{className:"flex-shrink-0",children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(fo,{className:"h-5 w-5"}),"Edit Vehicle"]}),o.jsx(js,{children:"Loading vehicle data..."})]}),o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})]})}):o.jsxs(o.Fragment,{children:[o.jsx(Yi,{open:e,onOpenChange:me,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[o.jsxs(ia,{className:"flex-shrink-0",children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(fo,{className:"h-5 w-5"}),"Edit Vehicle"]}),o.jsx(js,{children:"Fill in the required fields to edit vehicle information."})]}),o.jsx("div",{className:"flex-1 overflow-y-auto px-1 py-2",children:o.jsx(v5,{form:ae,onSubmit:he,submitting:a,hideDateOfRenewal:!1,isEditMode:!0,readOnlyFields:["fileNo","dateOfRenewal"],prePopulatedOwner:h.ownerName})}),o.jsxs(mo,{className:"flex-shrink-0 flex justify-start gap-3 pt-4 border-t",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:()=>me(!1),disabled:a,className:"min-w-[100px]",children:"Cancel"}),o.jsxs(ur,{type:"submit",form:"vehicle-form",disabled:a,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white shadow-lg",children:[a&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a?"Updating...":"Update Vehicle"]})]})]})}),o.jsx(xUe,{open:E,onOpenChange:D,onContinue:be,onCancel:pe}),o.jsx(Yi,{open:U,onOpenChange:I,children:o.jsxs(Bi,{className:"max-w-lg border-0 dark:border-0 bg-white dark:bg-[#212121]",children:[o.jsxs(ia,{children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(fo,{className:"h-5 w-5"}),"Confirm Vehicle Update"]}),o.jsx(js,{children:"Please review the updated vehicle information before submitting."})]}),V&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black dark:text-white mb-2 pl-3",children:"Vehicle Details"}),o.jsx("div",{className:"bg-gray-50 dark:bg-[#171717] rounded-md p-3 border border-gray-200 dark:border-[#424242]",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Plate No:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:V.plateNo}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"File No:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:V.fileNo||"Not provided"}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Engine No:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:V.engineNo||"Not provided"}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Chassis No:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:V.chassisNo||"Not provided"})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black dark:text-white mb-2 pl-3",children:"Vehicle Specifications"}),o.jsx("div",{className:"bg-gray-50 dark:bg-[#171717] rounded-md p-3 border border-gray-200 dark:border-[#424242]",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Make:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:V.make}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Body Type:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:V.bodyType}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Color:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:V.color||"Not provided"}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Classification:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:V.classification})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black dark:text-white mb-2 pl-3",children:"Renewal"}),o.jsx("div",{className:"bg-gray-50 dark:bg-[#171717] rounded-md p-3 border border-gray-200 dark:border-[#424242]",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Date of Renewal:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:V.dateOfRenewal?new Date(V.dateOfRenewal).toLocaleDateString():"Not provided"}),o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Vehicle Status:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:V.vehicleStatusType||"Not selected"})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-xs text-black dark:text-white mb-2 pl-3",children:"Owner"}),o.jsx("div",{className:"bg-gray-50 dark:bg-[#171717] rounded-md p-3 border border-gray-200 dark:border-[#424242]",children:o.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[o.jsx("div",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Owner Name:"}),o.jsx("div",{className:"col-span-3 text-gray-900 dark:text-gray-100",children:V.ownerName||h.ownerName||"Not selected"})]})})]})]}),o.jsxs(mo,{className:"flex justify-end gap-3 pt-6",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:Ne,disabled:a,className:"min-w-[100px] bg-white dark:bg-[#212121] border-gray-300 dark:border-[#424242] text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-[#171717]",children:"Cancel"}),o.jsxs(ur,{onClick:Ce,disabled:a,className:"flex items-center gap-2 min-w-[120px] bg-gradient-to-b from-blue-500 to-blue-700 hover:from-blue-600 hover:to-blue-800 text-white shadow-lg border border-blue-600 relative overflow-hidden",children:[a&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a?"Updating...":"Confirm & Update Vehicle",o.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 bg-gradient-to-br from-blue-300 to-blue-500 transform rotate-45 translate-x-2 -translate-y-2 opacity-60"})]})]})]})})]})},vUe=({open:e,onOpenChange:t,vehicleData:r,onVehicleUpdated:n})=>{const[a,c]=G.useState("vehicle"),[h,i]=G.useState(null),[x,w]=G.useState(!1),[S,T]=G.useState([]),[E,D]=G.useState(!1),[U,I]=G.useState(null),[V,H]=G.useState({}),[K,Q]=G.useState(!1),[ae,ee]=G.useState(!1),{token:se}=Ei();G.useEffect(()=>{e&&r&&(console.log("=== VEHICLE DETAILS MODAL DEBUG ==="),console.log("Full vehicleData:",r),console.log("createdBy:",r.createdBy),console.log("createdBy type:",typeof r.createdBy),console.log("createdAt:",r.createdAt),console.log("updatedBy:",r.updatedBy),console.log("updatedBy type:",typeof r.updatedBy),console.log("updatedAt:",r.updatedAt),console.log("=== END DEBUG ===")),e&&(r!=null&&r.driverId)&&ue(),e&&(r!=null&&r._id)&&me()},[e,r]);const ue=async()=>{var Ge,We;if(console.log("=== FETCHING OWNER DATA ==="),console.log("vehicleData:",r),console.log("driverId:",r==null?void 0:r.driverId),console.log("driverId type:",typeof(r==null?void 0:r.driverId)),console.log("driverId value:",r==null?void 0:r.driverId),!(r!=null&&r.driverId)){console.log("No driverId found, skipping fetch");return}w(!0);try{console.log(`Fetching driver data for ID: ${r.driverId}`);const{data:tt}=await mn.get(`/driver/${r.driverId}`,{headers:{Authorization:se}});console.log("Driver data received:",tt),i(tt.data)}catch(tt){console.error("Error fetching owner data:",tt),console.error("Error response:",(Ge=tt.response)==null?void 0:Ge.data),console.error("Error status:",(We=tt.response)==null?void 0:We.status)}finally{w(!1)}};G.useEffect(()=>{if(!e||!r)return;const We=[r.createdBy,r.updatedBy].map(tt=>typeof tt=="object"?tt==null?void 0:tt._id:tt).filter(Boolean).filter(tt=>!(tt in V));We.length&&(async()=>{try{const tt=await Promise.allSettled(We.map(async Dt=>{try{const{data:nr}=await mn.get(`/user/${Dt}`,{headers:{Authorization:se}}),ir=(nr==null?void 0:nr.data)||{},rr=ir.fullname||`${ir.firstName||""} ${ir.lastName||""}`.trim()||Dt;return{id:Dt,name:rr}}catch{return{id:Dt,name:Dt}}})),nt={...V};tt.forEach(Dt=>{Dt.status==="fulfilled"&&(nt[Dt.value.id]=Dt.value.name)}),H(nt)}catch{}})()},[e,r]);const he=Ge=>Ge?Ge.name?Ge.name:Ge.fullname||`${Ge.firstName||""} ${Ge.middleName?Ge.middleName+" ":""}${Ge.lastName||""}`.replace(/\s+/g," ").trim():"",Ce=Ge=>{if(!Ge||typeof Ge!="string")return null;const We=Ge.match(/\d/g)||[];if(!We.length)return null;const tt=We[We.length-1];return{1:0,2:1,3:2,4:3,5:4,6:5,7:6,8:7,9:8,0:9}[tt]??null},Ne=(Ge,We)=>{try{const tt=Ce(Ge);if(tt===null)return"On-Time Renewal";const nt=new Date(We).getMonth();return nt===tt?"On-Time Renewal":nt<tt?"Early Renewal":"Late Renewal"}catch{return"On-Time Renewal"}},me=async()=>{if(r){D(!0),I(null);try{const Ge=r.dateOfRenewal,tt=(Array.isArray(Ge)?Ge:Ge?[Ge]:[]).map(nr=>({renewalDate:(nr==null?void 0:nr.date)||nr,processedBy:(nr==null?void 0:nr.processedBy)||null,status:Ne(r.plateNo,(nr==null?void 0:nr.date)||nr)})).sort((nr,ir)=>new Date(ir.renewalDate)-new Date(nr.renewalDate));T(tt);const Dt=Array.from(new Set(tt.map(nr=>{var ir;return typeof nr.processedBy=="string"?nr.processedBy:((ir=nr.processedBy)==null?void 0:ir._id)||null}).filter(Boolean))).filter(nr=>!(nr in V));if(Dt.length){const nr=await Promise.allSettled(Dt.map(async rr=>{try{const{data:or}=await mn.get(`/user/${rr}`,{headers:{Authorization:se}}),Ft=(or==null?void 0:or.data)||{},ze=Ft.fullname||`${Ft.firstName||""} ${Ft.lastName||""}`.trim()||rr;return{id:rr,name:ze}}catch{return{id:rr,name:rr}}})),ir={...V};nr.forEach(rr=>{rr.status==="fulfilled"&&(ir[rr.value.id]=rr.value.name)}),H(ir)}}catch(Ge){console.error("Error deriving renewal history from vehicle data:",Ge),I("Failed to derive renewal history")}finally{D(!1)}}},be=Ge=>{if(!Ge)return"Not set";try{return new Date(Ge).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return String(Ge)}},pe=Ge=>Ge?new Date(Ge).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set",Se=Ge=>{const We=Ge==="1"||Ge===1;return o.jsxs("div",{className:"flex items-center gap-1",children:[We?o.jsx(hR,{className:"h-3 w-3 text-green-500"}):o.jsx(Hf,{className:"h-3 w-3 text-red-500"}),o.jsx("span",{className:`text-xs font-semibold ${We?"text-green-600":"text-red-600"}`,children:We?"Active":"Expired"})]})},Ee=Ge=>{let We,tt;switch(Ge){case"Early Renewal":We="bg-blue-100 text-blue-800 border-blue-200",tt=o.jsx(Xs,{className:"h-3 w-3"});break;case"On-Time Renewal":We="bg-green-100 text-green-800 border-green-200",tt=o.jsx(hR,{className:"h-3 w-3"});break;case"Late Renewal":We="bg-red-100 text-red-800 border-red-200",tt=o.jsx(Hf,{className:"h-3 w-3"});break;default:We="bg-gray-100 text-gray-800 border-gray-200",tt=o.jsx(Hf,{className:"h-3 w-3"})}return o.jsx(Qa,{variant:"outline",className:`text-xs font-medium ${We}`,children:o.jsxs("div",{className:"flex items-center gap-1",children:[tt,Ge]})})},we=()=>o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(qf,{className:"h-3 w-3"}),"Plate Number"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.plateNo)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(ho,{className:"h-3 w-3"}),"File Number"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.fileNo)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(PH,{className:"h-3 w-3"}),"Engine Number"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.engineNo)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(qf,{className:"h-3 w-3"}),"Chassis Number"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.chassisNo)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Jb,{className:"h-3 w-3"}),"Make"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.make)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(fo,{className:"h-3 w-3"}),"Body Type"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.bodyType)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(TH,{className:"h-3 w-3"}),"Color"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.color)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(the,{className:"h-3 w-3"}),"Classification"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.classification)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(AT,{className:"h-3 w-3"}),"Vehicle Status Type"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.vehicleStatusType)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Xg,{className:"h-3 w-3"}),"Status"]}),o.jsx("div",{className:"ml-4",children:Se(r==null?void 0:r.status)})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(kH,{className:"h-3 w-3"}),"Created By"]}),o.jsxs("div",{className:"ml-4 flex items-center gap-2 text-xs",children:[o.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:(()=>{const Ge=r==null?void 0:r.createdBy;return Ge?typeof Ge=="object"?he(Ge)||"Unknown":V[Ge]||Ge:"Unknown"})()}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:""}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:r!=null&&r.createdAt?be(r.createdAt):"Unknown"})]})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(za,{className:"h-3 w-3"}),"Last Updated By"]}),o.jsx("div",{className:"ml-4 flex items-center gap-2 text-xs",children:(()=>{const Ge=r==null?void 0:r.updatedBy;return Ge&&(typeof Ge=="object"?he(Ge):V[Ge]||Ge)?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:typeof Ge=="object"?he(Ge):V[Ge]||Ge}),(r==null?void 0:r.updatedAt)&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:""}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:be(r.updatedAt)})]})]}):o.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Not yet updated"})})()})]})]})]}),Pe=()=>x?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})}):h?o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(fl,{className:"h-3 w-3"}),"Owner/Representative Name"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(h==null?void 0:h.ownerRepresentativeName)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(l4,{className:"h-3 w-3"}),"Contact Number"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(h==null?void 0:h.contactNumber)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Hw,{className:"h-3 w-3"}),"Email Address"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(h==null?void 0:h.emailAddress)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Xs,{className:"h-3 w-3"}),"Birth Date"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:pe(h==null?void 0:h.birthDate)})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(TT,{className:"h-3 w-3"}),"Driver's License"]}),o.jsx("div",{className:"ml-4",children:h!=null&&h.hasDriversLicense?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Qa,{variant:"outline",className:"text-green-600 border-green-600 text-xs",children:"Yes"}),(h==null?void 0:h.driversLicenseNumber)&&o.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:h.driversLicenseNumber})]}):o.jsx(Qa,{variant:"outline",className:"text-red-600 border-red-600 text-xs",children:"No"})})]}),(h==null?void 0:h.address)&&o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-[#424242] shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Rd,{className:"h-3 w-3"}),"Address"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:[h.address.barangay,h.address.municipality,h.address.province].filter(Boolean).join(", ")})]})]}):o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No owner information available"})}),Me=()=>E?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Nc,{className:"h-4 w-4 animate-spin text-blue-600"}),o.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Loading renewal history..."})]})}):U?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Hf,{className:"h-8 w-8 text-red-400 mx-auto mb-3"}),o.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mb-2",children:"Failed to load renewal history"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:U}),o.jsxs(ur,{variant:"outline",size:"sm",onClick:me,className:"text-xs",children:[o.jsx(sv,{className:"h-3 w-3 mr-1"}),"Retry"]})]}):!S||S.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(sv,{className:"h-8 w-8 text-gray-400 mx-auto mb-3"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"No renewal history found"}),o.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Renewal records will appear here when the vehicle is renewed"})]}):o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:(()=>{const Ge=S.length||0,We=Ge===1?"record":"records",tt=(r==null?void 0:r.plateNo)||"N/A";return o.jsxs(o.Fragment,{children:[`Renewal History (${Ge} ${We})  Plate: `,o.jsx("span",{className:"font-normal",children:tt})]})})()}),o.jsxs(ur,{variant:"outline",size:"sm",onClick:me,className:"text-xs",children:[o.jsx(sv,{className:"h-3 w-3 mr-1"}),"Refresh"]})]}),o.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-[#424242] max-h-[50vh] overflow-y-auto",children:o.jsxs(Im,{children:[o.jsx(Lm,{children:o.jsxs(Ps,{className:"bg-gray-50 dark:bg-gray-700 sticky top-0 z-10",children:[o.jsx(Ts,{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 text-center",children:"Date"}),o.jsx(Ts,{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 text-center",children:"Status"}),o.jsx(Ts,{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 text-center",children:"Processed By"})]})}),o.jsx(Dm,{children:S.map((Ge,We)=>o.jsxs(Ps,{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[o.jsx(xa,{className:"text-xs text-gray-900 dark:text-gray-100 text-center",children:be(Ge.renewalDate)}),o.jsx(xa,{className:"text-xs text-center",children:o.jsx("div",{className:"flex justify-center",children:Ee(Ge.status)})}),o.jsx(xa,{className:"text-xs text-gray-600 dark:text-gray-400 text-center",children:(()=>{if(!Ge.processedBy)return"System";if(typeof Ge.processedBy=="object")return Ge.processedBy.fullname||`${Ge.processedBy.firstName||""} ${Ge.processedBy.lastName||""}`.trim()||"System";const tt=Ge.processedBy;return V[tt]||tt})()})]},Ge._id||We))})]})})]}),Be=[{id:"vehicle",label:"Vehicle Information",icon:fo},{id:"owner",label:"Owner Information",icon:fl},{id:"renewal",label:"Renewal History",icon:sv}];return o.jsxs(o.Fragment,{children:[o.jsx(Yi,{open:e,onOpenChange:t,children:o.jsxs(Bi,{className:"max-w-2xl h-[80vh] bg-gradient-to-br from-slate-50 to-blue-50 dark:from-gray-900 dark:to-gray-800 border-0 shadow-2xl flex flex-col",onPointerDownOutside:Ge=>Ge.preventDefault(),onEscapeKeyDown:Ge=>Ge.preventDefault(),children:[o.jsx(ia,{className:"pb-3 flex-shrink-0",children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx(aa,{className:"text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Vehicle Details"}),o.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Comprehensive vehicle information including registration details, specifications, and current status"}),o.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 flex items-center gap-1",children:[o.jsx(ho,{className:"h-3 w-3 text-blue-500"}),"File Number: ",o.jsx("span",{className:"font-semibold text-blue-600",children:(r==null?void 0:r.fileNo)||"N/A"})]})]})})}),o.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[o.jsx("div",{className:"flex-shrink-0 mb-3",children:o.jsx("div",{className:"flex space-x-1 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm p-1 rounded-lg shadow-lg border border-gray-200 dark:border-[#424242]",children:Be.map(Ge=>{const We=Ge.icon;return o.jsxs(ur,{variant:"ghost",onClick:()=>c(Ge.id),className:`flex-1 flex items-center gap-1 text-xs font-medium transition-all duration-200 ${a===Ge.id?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-600 dark:text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-gray-700"}`,children:[o.jsx(We,{className:"h-3 w-3"}),o.jsx("span",{className:"hidden sm:inline",children:Ge.label})]},Ge.id)})})}),o.jsxs("div",{className:"flex-1 overflow-y-auto bg-white/90 dark:bg-gray-900/90 backdrop-blur-sm p-3 rounded-lg shadow-lg border border-gray-200 dark:border-[#424242]",children:[a==="vehicle"&&o.jsx(we,{}),a==="owner"&&o.jsx(Pe,{}),a==="renewal"&&o.jsx(Me,{})]})]}),o.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[o.jsxs(ur,{variant:"outline",size:"sm",onClick:()=>Q(!0),className:"text-xs",children:[o.jsx(za,{className:"h-3 w-3 mr-1"}),"Edit Vehicle"]}),o.jsxs(ur,{variant:"default",size:"sm",onClick:()=>ee(!0),className:"text-xs bg-blue-600 hover:bg-blue-700 text-white",children:[o.jsx(sv,{className:"h-3 w-3 mr-1"}),"Renew Vehicle"]})]})]})}),o.jsx(Wie,{open:K,onOpenChange:Q,vehicleId:r==null?void 0:r._id,onVehicleUpdated:n}),o.jsx(q3,{open:ae,onOpenChange:ee,vehicleData:r,onVehicleUpdated:n})]})},_Ue=()=>{const[e,t]=G.useState([]),{token:r}=Ei();Ba(),Co();const[n,a]=G.useState(!0);jc(Date.now());const[c,h]=G.useState(!1),[i,x]=G.useState(!1),[w,S]=G.useState(!1),[T,E]=G.useState(!1),[D,U]=G.useState(!1),[I,V]=G.useState(!1),[H,K]=G.useState(null),[Q,ae]=G.useState(null),[ee,se]=G.useState(null);G.useEffect(()=>{ue()},[]);const ue=async()=>{var Se,Ee,we,Pe,Me,Be,Ge,We;try{a(!0),console.log("=== FETCHING VEHICLES ===");const{data:tt}=await mn.get("/vehicle?fetchAll=true",{headers:{Authorization:r}});if(console.log("=== API RESPONSE ==="),console.log("Response success:",tt.success),console.log("Total vehicles received:",((Se=tt.data)==null?void 0:Se.length)||0),console.log("Pagination info:",tt.pagination),console.log("Pagination total in DB:",(Ee=tt.pagination)==null?void 0:Ee.total),console.log("FetchAll mode:",(we=tt.pagination)==null?void 0:we.fetchAll),console.log("First vehicle sample:",(Pe=tt.data)==null?void 0:Pe[0]),console.log("Last vehicle sample:",(Be=tt.data)==null?void 0:Be[((Me=tt.data)==null?void 0:Me.length)-1]),!tt.data||!Array.isArray(tt.data)){console.error("API response does not contain data array:",tt),t([]);return}const nt=tt.data.map(Dt=>{var ir;const nr=typeof Dt.driverId=="object"&&((ir=Dt.driverId)!=null&&ir._id)?Dt.driverId._id:Dt.driverId;return{_id:Dt._id,plateNo:Dt.plateNo,fileNo:Dt.fileNo,engineNo:Dt.engineNo,chassisNo:Dt.serialChassisNumber,make:Dt.make,bodyType:Dt.bodyType,color:Dt.color,classification:Dt.classification,dateOfRenewal:Dt.dateOfRenewal,status:Dt.status,driverId:nr,vehicleStatusType:Dt.vehicleStatusType,createdBy:Dt.createdBy,createdAt:Dt.createdAt,updatedBy:Dt.updatedBy,updatedAt:Dt.updatedAt}});console.log("=== PROCESSED VEHICLES ==="),console.log("Total processed:",nt.length),console.log("Vehicles with plateNo:",nt.filter(Dt=>Dt.plateNo).length),console.log("Vehicles with fileNo:",nt.filter(Dt=>Dt.fileNo).length),console.log("Vehicles with status:",nt.filter(Dt=>Dt.status).length),console.log("Sample processed vehicle:",nt[0]),t(nt)}catch(tt){console.error("=== ERROR FETCHING VEHICLES ==="),console.error("Error:",tt),console.error("Error response:",(Ge=tt.response)==null?void 0:Ge.data),console.error("Error status:",(We=tt.response)==null?void 0:We.status),t([])}finally{a(!1)}},he=async()=>{E(!0)},Ce=Se=>{console.log("=== VEHICLE ROW CLICKED ==="),console.log("Vehicle data:",Se),console.log("DriverId:",Se==null?void 0:Se.driverId),K(Se),U(!0)},Ne=Se=>{ae(Se),V(!0)},me=Se=>{se(Se),S(!0)},be=()=>{ue()},pe=()=>{ue()};return o.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"bg-white dark:bg-transparent rounded-lg shadow-sm border border-gray-200 dark:border-0 px-4 md:px-6 pt-4 md:pt-6 pb-2 flex-1 flex flex-col min-h-0 overflow-hidden",children:[o.jsx("header",{className:"text-xl md:text-2xl lg:text-3xl font-bold mb-3 md:mb-4 flex-shrink-0",children:"Vehicles"}),o.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:o.jsx(pUe,{data:e,filters:["plateNo","fileNo","engineNo","chassisNo","classification","status"],tableColumn:tze,onAdd:he,loading:n,onRowClick:Ce,onEdit:Ne,onRenew:me,submitting:c})})]}),o.jsx(q3,{open:i,onOpenChange:x,onVehicleUpdated:be}),o.jsx(q3,{open:w,onOpenChange:S,vehicleData:ee,onVehicleUpdated:be}),o.jsx(yUe,{open:T,onOpenChange:E,onVehicleAdded:pe}),o.jsx(vUe,{open:D,onOpenChange:U,vehicleData:H}),o.jsx(Wie,{open:I,onOpenChange:V,vehicleId:Q,onVehicleUpdated:be})]})},bUe=()=>{const e=J0(),[t,r]=G.useState(!0),{token:n}=Ei(),[a,c]=G.useState(),[h,i]=G.useState(!1),[x,w]=G.useState(!1),S=Co(),T=Ba(),E=async()=>{try{r(!0);const{data:D}=await mn.get(`/vehicle/${e.id}`,{headers:{Authorization:n}});D&&c(D.data)}catch(D){console.error("Error fetching vehicle:",D),Xr.error("Failed to load vehicle data")}finally{r(!1)}};return G.useEffect(()=>{E()},[]),t?o.jsx(Ri,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:o.jsx(Fi,{className:"p-6",children:o.jsx("div",{className:"flex items-center justify-center",children:o.jsx("div",{className:"text-muted-foreground",children:"Loading vehicle data..."})})})}):o.jsx(o.Fragment,{children:o.jsxs(Ri,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:[o.jsxs(Ki,{className:"border-b",children:[o.jsx(Zi,{className:"text-3xl font-bold",children:a!=null&&a.make?UO(a.make):"N/A"}),o.jsx(As,{children:(a==null?void 0:a.plateNo)||"N/A"})]}),o.jsx(Fi,{className:"p-0 pb-6",children:o.jsxs("div",{className:"grid grid-cols-2 text-sm gap-4 mb-2",children:[o.jsx("h1",{className:"font-bold col-span-2 border-b px-6 py-1",children:"Vehicle Information"}),o.jsx("h2",{className:"text-muted-foreground px-6",children:"Plate Number:"}),o.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.plateNo)||"N/A"}),o.jsx("h2",{className:"text-muted-foreground px-6",children:"File Number:"}),o.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.fileNo)||"N/A"}),o.jsx("h2",{className:"text-muted-foreground px-6",children:"Engine Number:"}),o.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.engineNo)||"N/A"}),o.jsx("h2",{className:"text-muted-foreground px-6",children:"Chassis Number:"}),o.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.chassisNo)||"N/A"}),o.jsx("h2",{className:"text-muted-foreground px-6",children:"Make:"}),o.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.make?UO(a.make):"N/A"}),o.jsx("h2",{className:"text-muted-foreground px-6",children:"Body Type:"}),o.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.bodyType)||"N/A"}),o.jsx("h2",{className:"text-muted-foreground px-6",children:"Color:"}),o.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.color?UO(a.color):"N/A"}),o.jsx("h2",{className:"text-muted-foreground px-6",children:"Classification:"}),o.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.classification)||"N/A"}),o.jsx("h2",{className:"text-muted-foreground px-6",children:"Date of Renewal:"}),o.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.dateOfRenewal?zj(a.dateOfRenewal):"Not set"}),o.jsx("h2",{className:"text-muted-foreground px-6",children:"Status:"}),o.jsx("p",{className:"font-semibold w-full",children:o.jsx("span",{className:`px-2 py-1 rounded text-xs ${(a==null?void 0:a.status)==="1"||(a==null?void 0:a.status)===1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:(a==null?void 0:a.status)==="1"||(a==null?void 0:a.status)===1?"Active":"Expired"})})]})}),o.jsx(Lre,{className:"gap-2 text-sm ",children:o.jsxs(ur,{onClick:()=>T(`${S.pathname}/edit`),size:"sm",className:"font-semibold",variant:"outline",children:[o.jsx(za,{}),"Edit"]})})]})})},wUe=()=>{const e=Ba();return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"px-4 pt-4 md:px-0 md:pt-0 md:mb-4",children:o.jsxs(ur,{variant:"outline",className:"shadow-none",onClick:()=>e(-1),children:[o.jsx(n4,{})," Back"]})}),o.jsx("div",{className:"p-4 md:p-0",children:o.jsx(bUe,{})})]})},SUe=()=>{const[e,t]=G.useState(!1),{token:r}=Ei(),n=J0(),a=jc(Date.now()),[c,h]=G.useState({}),i=Ba(),x=ml({resolver:Rl(HZ),defaultValues:{plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0}}),{reset:w}=x;G.useEffect(()=>{Object.keys(c).length>0&&w(c)},[c,w]),G.useEffect(()=>{S()},[n.id,r]);const S=async()=>{var D,U,I,V,H,K,Q,ae;const E=n.id;try{const{data:ee}=await mn.get(`/vehicle/${E}`,{headers:{Authorization:r}});if(ee){const se={plateNo:(D=ee.data)==null?void 0:D.plateNo,fileNo:(U=ee.data)==null?void 0:U.fileNo,engineNo:(I=ee.data)==null?void 0:I.engineNo,chassisNo:(V=ee.data)==null?void 0:V.chassisNo,make:(H=ee.data)==null?void 0:H.make,bodyType:(K=ee.data)==null?void 0:K.bodyType,color:(Q=ee.data)==null?void 0:Q.color,classification:(ae=ee.data)==null?void 0:ae.classification};h(se)}}catch(ee){console.log(ee)}},T=async E=>{var D,U;t(!0);try{const I={plateNo:E.plateNo,fileNo:E.fileNo,engineNo:E.engineNo,serialChassisNumber:E.chassisNo,make:E.make,bodyType:E.bodyType,color:E.color,classification:E.classification},{data:V}=await mn.patch(`/vehicle/${n.id}`,I,{headers:{Authorization:r}});V.success&&(Xr.success("Vehicle updated",{description:a}),i(-1))}catch(I){console.log(I);const V=((U=(D=I.response)==null?void 0:D.data)==null?void 0:U.message)||"An error occurred";Xr.error(V,{description:`${a}`})}finally{t(!1)}};return o.jsxs(Ri,{children:[o.jsxs(Ki,{children:[o.jsx(Zi,{className:"text-xl md:text-3xl font-bold",children:"Edit Vehicle"}),o.jsx(As,{children:"Fill in required fields to edit vehicle."})]}),o.jsx(Fi,{children:o.jsx(v5,{form:x,onSubmit:T,submitting:e,hideDateOfRenewal:!0})})]})},NUe=({title:e,filters:t,tableColumn:r,data:n,loading:a,onRowClick:c,onAdd:h,onEdit:i,onUpdateStatus:x,submitting:w})=>{var Ce;const[S,T]=Le.useState([]),[E,D]=Le.useState([]),[U,I]=Le.useState({}),[V,H]=Le.useState({pageIndex:0,pageSize:8}),[K,Q]=Le.useState(""),[ae,ee]=Le.useState("all"),se=t,ue=R2({data:n,columns:r(i,x,w),onSortingChange:T,onColumnFiltersChange:D,onPaginationChange:H,getCoreRowModel:C2(),getPaginationRowModel:M2(),getSortedRowModel:O2(),getFilteredRowModel:E2(),onColumnVisibilityChange:I,onGlobalFilterChange:Q,globalFilterFn:(Ne,me,be)=>se.some(pe=>{const Se=Ne.getValue(pe);return String(Se).toLowerCase().includes(be.toLowerCase())}),state:{pagination:V,sorting:S,columnFilters:E,columnVisibility:U,globalFilter:K}});Le.useEffect(()=>{const Ne=ue.getColumn("violationType");Ne&&(ae==="all"?Ne.setFilterValue(""):Ne.setFilterValue(ae))},[ae,ue]);const he=Ne=>{switch(Ne){case"confiscated":return{label:"Confiscated",icon:null};case"impounded":return{label:"Impounded",icon:null};case"alarm":return{label:"Alarm",icon:null};default:return{label:"All Types",icon:o.jsx(JB,{className:"h-3 w-3"})}}};return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsx(Ml,{className:"font-semibold",children:e}),o.jsxs("div",{className:"md:flex items-center justify-between py-3 flex-shrink-0",children:[o.jsxs("div",{className:"relative hidden md:inline md:max-w-sm flex-shrink",children:[o.jsx(Kw,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx(Yr,{placeholder:"Search Violation...",value:K??"",onChange:Ne=>Q(Ne.target.value),className:"pl-10 pr-10 bg-white text-black border-gray-300 dark:bg-black dark:text-white dark:border-[#424242]"}),K&&o.jsx("button",{onClick:()=>Q(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:o.jsx(zd,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[o.jsx("div",{className:"w-40",children:o.jsxs(Js,{value:ae,onValueChange:ee,children:[o.jsx(Vs,{className:"bg-white text-black border border-gray-300 dark:bg-black dark:text-white dark:border-[#424242] h-8 px-2 text-xs",children:o.jsxs("div",{className:"flex items-center gap-2",children:[he(ae).icon&&he(ae).icon,o.jsx("span",{className:"hidden lg:inline",children:he(ae).label})]})}),o.jsxs(Us,{children:[o.jsx(An,{value:"all",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(JB,{className:"h-3 w-3"}),o.jsx("span",{children:"All Types"})]})}),o.jsx(An,{value:"confiscated",children:"Confiscated"}),o.jsx(An,{value:"impounded",children:"Impounded"}),o.jsx(An,{value:"alarm",children:"Alarm"})]})]})}),o.jsxs(ur,{onClick:h,className:"w-min flex items-center gap-2 bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-[#424242] dark:hover:bg-gray-800",children:[o.jsx(v_,{}),o.jsx("span",{className:"hidden lg:inline",children:"Add Violation"})]}),o.jsx(L2,{table:ue})]})]}),o.jsx("div",{className:"border flex-1 overflow-hidden shadow-sm bg-white dark:bg-transparent border-gray-300 dark:border-[#424242] min-h-0",children:o.jsx("div",{className:"overflow-x-auto overflow-y-auto h-full",children:o.jsx("div",{className:"px-0 min-w-full",children:o.jsxs(Im,{className:"min-w-full",children:[o.jsx(Lm,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 dark:bg-[#18181B] border-b-2 border-gray-300 dark:border-[#424242]",children:ue.getHeaderGroups().map(Ne=>o.jsx(Ps,{className:"hover:bg-gray-100/50 dark:hover:bg-[#18181B] dark:bg-[#18181B]",children:Ne.headers.map(me=>o.jsx(Ts,{className:"text-xs font-semibold text-gray-800 dark:text-gray-200 px-3 py-2 whitespace-nowrap text-left",children:fp(me.column.columnDef.header,me.getContext())},me.id))},Ne.id))}),o.jsx(Dm,{className:"text-xs bg-white dark:bg-transparent",children:a?o.jsx(I2,{rowCount:5,cellCount:ue.getAllColumns().length}):(Ce=ue.getRowModel().rows)!=null&&Ce.length?ue.getRowModel().rows.map(Ne=>o.jsx(Ps,{onClick:()=>c(Ne.original),"data-state":Ne.getIsSelected()&&"selected",className:"hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors duration-150 border-b border-gray-100 dark:border-gray-700 cursor-pointer",children:Ne.getVisibleCells().map(me=>o.jsx(xa,{className:"px-3 py-3 text-gray-800 dark:text-gray-200 text-left",children:fp(me.column.columnDef.cell,me.getContext())},me.id))},Ne.id)):o.jsx(Ps,{className:"hover:bg-transparent",children:o.jsx(xa,{colSpan:ue.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:o.jsxs("div",{className:"flex flex-col items-center justify-center",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),o.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),o.jsx("div",{className:"mt-2 mb-2 flex-shrink-0",children:o.jsx(D2,{table:ue})})]})},_5=({form:e,onSubmit:t,submitting:r,isEditMode:n=!1})=>{Ba();const[a,c]=G.useState([]),[h,i]=G.useState(!1),[x,w]=G.useState(null),S=SR({control:e.control,name:"violationType",defaultValue:"confiscated"});G.useEffect(()=>{!n&&S!=="confiscated"&&e.setValue("licenseType",void 0,{shouldValidate:!0,shouldDirty:!0})},[S,n,e]);const T=SR({control:e.control,name:"violations",defaultValue:[]});G.useEffect(()=>{console.log("=== VIOLATIONS USEEFFECT TRIGGERED ==="),console.log("formViolations:",T),console.log("violations.length:",a.length),console.log("current violations state:",a),T&&T.length>0?(console.log("Setting violations to formViolations:",T),c(T)):a.length===0&&(console.log('No form violations, setting to [""]'),c([""]),e.setValue("violations",[""]))},[T,e]);const E=()=>{console.log("=== ADD VIOLATION CLICKED ==="),console.log("Current violations state:",a),console.log("Current form violations:",T);const K=[...a,""];console.log("New violations array:",K),c(K),e.setValue("violations",K),console.log("After setViolations and setValue"),console.log("Updated violations state:",K)},D=K=>{if(a.length>1)if(n&&a[K]&&a[K].trim()!=="")w(K),i(!0);else{const Q=a.filter((ae,ee)=>ee!==K);c(Q),e.setValue("violations",Q)}},U=()=>{if(x!==null){const K=a.filter((Q,ae)=>ae!==x);c(K),e.setValue("violations",K)}i(!1),w(null)},I=()=>{i(!1),w(null)},V=(K,Q)=>{const ae=[...a];ae[K]=Q,c(ae),e.setValue("violations",ae)},H=K=>{console.log("=== FORM COMPONENT SUBMIT ==="),console.log("Form submitted with data:",K),console.log("Form state:",e.formState),console.log("Form errors:",e.formState.errors),t(K)};return o.jsxs(up,{...e,children:[o.jsxs("form",{id:"violation-form",onSubmit:e.handleSubmit(H),className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx(an,{control:e.control,name:"violationType",render:({field:K})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Violation Type"}),o.jsxs(Js,{onValueChange:K.onChange,defaultValue:K.value,children:[o.jsx(Hr,{children:o.jsx(Vs,{className:"text-xs",children:o.jsx(yo,{placeholder:"Select violation type"})})}),o.jsxs(Us,{children:[o.jsx(An,{value:"confiscated",children:"Confiscated"}),o.jsx(An,{value:"alarm",children:"Alarm"}),o.jsx(An,{value:"impounded",children:"Impounded"})]})]}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"topNo",render:({field:K})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"TOP NO."}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"TOP-0001",...K,value:K.value==="null"?"null":K.value||"",readOnly:n,className:zt("text-xs",n&&"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 cursor-not-allowed border-gray-300 dark:border-gray-600")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"apprehendingOfficer",render:({field:K})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Apprehending Officer"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Officer Name",...K,value:K.value==="null"?"null":K.value||"",className:zt("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]}),!n||S==="confiscated"||S==="impounded"?o.jsxs("div",{className:"space-y-0",children:[o.jsx("h6",{className:"text-sm font-semibold",children:"Violater's Details"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[o.jsx(an,{control:e.control,name:"firstName",render:({field:K})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"First Name"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"John",...K,value:K.value==="null"?"null":K.value||"",className:zt("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"middleInitial",render:({field:K})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Middle Initial"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"D",maxLength:1,...K,value:K.value==="null"?"null":K.value||"",className:zt("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"lastName",render:({field:K})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Last Name"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Doe",...K,value:K.value==="null"?"null":K.value||"",className:zt("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"suffix",render:({field:K})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Suffix"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Jr.",...K,value:K.value==="null"?"null":K.value||"",className:zt("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]})]}):null,!n||S==="confiscated"||S==="impounded"?o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs text-gray-600",children:"Violation/s"}),console.log("=== RENDERING VIOLATIONS ===",a),a.map((K,Q)=>(console.log(`Rendering violation ${Q}:`,K),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(Yr,{placeholder:`Violation ${Q+1}`,value:K||"",onChange:ae=>V(Q,ae.target.value),className:"text-xs"}),a.length>1&&o.jsx(ur,{type:"button",variant:"outline",size:"icon",onClick:()=>D(Q),children:o.jsx(zd,{className:"h-4 w-4"})})]},Q))),o.jsxs(ur,{type:"button",variant:"outline",onClick:E,className:"w-full text-xs",children:[o.jsx(v_,{className:"h-4 w-4 mr-2"}),"Add Violation"]})]})}):null,!n||S==="confiscated"?o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx(an,{control:e.control,name:"licenseType",render:({field:K})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"License Type"}),o.jsxs(Js,{onValueChange:K.onChange,value:K.value||void 0,children:[o.jsx(Hr,{children:o.jsx(Vs,{disabled:!n&&S!=="confiscated",className:`text-xs ${!n&&S!=="confiscated"?"bg-gray-100 text-gray-400 cursor-not-allowed":""}`,children:o.jsx(yo,{placeholder:K.value==="null"?"null":"Select license type"})})}),o.jsxs(Us,{children:[o.jsx(An,{value:"SP",children:"SP (Student Permit)"}),o.jsx(An,{value:"DL",children:"DL (Driver's License)"}),o.jsx(An,{value:"CL",children:"CL (Commercial License)"}),o.jsx(An,{value:"PLATE",children:"PLATE"}),o.jsx(An,{value:"SP RECEIPT",children:"SP RECEIPT"}),o.jsx(An,{value:"DL RECEIPT",children:"DL RECEIPT"}),o.jsx(An,{value:"REFUSE TO SUR.",children:"REFUSE TO SUR."}),o.jsx(An,{value:"DL TEMPORARY",children:"DL TEMPORARY"}),o.jsx(An,{value:"-",children:"-"}),o.jsx(An,{value:"null",children:"null"})]})]}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx("div",{})]})}):null,o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx(an,{control:e.control,name:"plateNo",render:({field:K})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Plate No."}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"ABC-1234",...K,value:K.value==="null"?"null":K.value||"",className:zt("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"chassisNo",render:({field:K})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Chassis No. (Optional)"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Chassis Number",...K,value:K.value==="null"?"null":K.value||"",className:zt("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"engineNo",render:({field:K})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Engine No. (Optional)"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Engine Number",...K,value:K.value==="null"?"null":K.value||"",className:zt("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]})}),o.jsx("div",{className:"space-y-4",children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.jsx(an,{control:e.control,name:"dateOfApprehension",render:({field:K})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Date of Apprehension"}),o.jsx(Hr,{children:o.jsxs(ip,{children:[o.jsx(ap,{asChild:!0,children:o.jsx(Hr,{children:o.jsxs(ur,{variant:"outline",className:zt("w-full pl-3 text-left font-normal text-xs",!K.value&&"text-muted-foreground"),children:[K.value?Ol(K.value,"PPP"):o.jsx("span",{children:"Pick a date"}),o.jsx(Xs,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),o.jsx(Wh,{className:"w-auto p-0",align:"start",children:o.jsx(F0,{fieldValue:K.value,dateValue:K.onChange})})]})}),o.jsx(cn,{})]})})})})]}),o.jsx(Yi,{open:h,onOpenChange:i,children:o.jsxs(Bi,{className:"max-w-md",children:[o.jsxs(ia,{children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(ko,{className:"h-5 w-5 text-orange-500"}),"Remove Violation"]}),o.jsx(js,{children:"Are you sure you want to remove this violation from this driver? This action cannot be undone."})]}),o.jsxs(mo,{className:"flex justify-end gap-3",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:I,className:"min-w-[80px]",children:"Cancel"}),o.jsx(ur,{type:"button",onClick:U,className:"min-w-[80px] bg-red-600 hover:bg-red-700 text-white",children:"Remove"})]})]})})]})},AUe=({open:e,onOpenChange:t,onViolationAdded:r})=>{const[n,a]=G.useState(!1),{token:c}=Ei(),h=jc(Date.now()),i=ml({resolver:Rl(U4),defaultValues:{topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[""],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}}),x=async S=>{var T,E;a(!0);try{const D={topNo:S.topNo,firstName:S.firstName,middleInitial:S.middleInitial,lastName:S.lastName,suffix:S.suffix,violations:S.violations,violationType:S.violationType,licenseType:S.violationType==="confiscated"?S.licenseType:void 0,plateNo:S.plateNo,apprehendingOfficer:S.apprehendingOfficer,chassisNo:S.chassisNo,engineNo:S.engineNo};S.dateOfApprehension&&(D.dateOfApprehension=S.dateOfApprehension);const{data:U}=await mn.post("/violations",D,{headers:{Authorization:c}});U.success&&(Xr.success("Violation has been added",{description:h}),i.reset({topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[""],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}),t(!1),r&&r())}catch(D){console.log(D);const U=((E=(T=D.response)==null?void 0:T.data)==null?void 0:E.message)||"Failed to add violation";Xr.error(U,{description:h})}finally{a(!1)}},w=S=>{!S&&!n&&i.reset({topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[""],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}),t(S)};return o.jsx(Yi,{open:e,onOpenChange:w,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[o.jsxs(ia,{className:"flex-shrink-0",children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(ko,{className:"h-5 w-5"}),"Add New Violation"]}),o.jsx(js,{children:"Fill in the required fields to add a new violation record to the system."})]}),o.jsx("div",{className:"flex-1 overflow-y-auto px-1 py-2",children:o.jsx(_5,{form:i,onSubmit:x,submitting:n,isEditMode:!1})}),o.jsxs(mo,{className:"flex-shrink-0 flex justify-start gap-3 pt-4 border-t",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:()=>w(!1),disabled:n,className:"min-w-[100px]",children:"Cancel"}),o.jsxs(ur,{type:"submit",form:"violation-form",disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",children:[n&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Violation"]})]})]})})},TUe=({open:e,onOpenChange:t,violationData:r})=>{const[n,a]=G.useState("violation"),[c,h]=G.useState(!1),{token:i}=Ei();Ba(),G.useEffect(()=>{e&&r&&(a("violation"),console.log("ViolationDetailsModal - violationData:",r),console.log("ViolationDetailsModal - createdAt:",r.createdAt),console.log("ViolationDetailsModal - updatedAt:",r.updatedAt))},[e,r]);const x=I=>I?new Date(I).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set",w=I=>I?new Date(I).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"Not set",S=I=>{let V,H;switch(I){case"confiscated":V="bg-red-100 text-red-800 border-red-200",H=o.jsx(ko,{className:"h-3 w-3"});break;case"impounded":V="bg-orange-100 text-orange-800 border-orange-200",H=o.jsx(Xg,{className:"h-3 w-3"});break;case"alarm":V="bg-yellow-100 text-yellow-800 border-yellow-200",H=o.jsx(Hf,{className:"h-3 w-3"});break;default:V="bg-gray-100 text-gray-800 border-gray-200",H=o.jsx(Hf,{className:"h-3 w-3"})}return o.jsx(Qa,{variant:"outline",className:`text-xs font-medium ${V}`,children:o.jsxs("div",{className:"flex items-center gap-1",children:[H,(I==null?void 0:I.charAt(0).toUpperCase())+(I==null?void 0:I.slice(1))||"Unknown"]})})},T=I=>I?o.jsx(Qa,{variant:"outline",className:"text-xs font-medium bg-blue-100 text-blue-800 border-blue-200",children:I}):"N/A",E=()=>{var I;return o.jsx("div",{className:"space-y-2",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(qf,{className:"h-3 w-3"}),"TOP Number"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.topNo)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(ko,{className:"h-3 w-3"}),"Violation Type"]}),o.jsx("div",{className:"ml-4",children:S(r==null?void 0:r.violationType)})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(fl,{className:"h-3 w-3"}),"Driver Name"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r!=null&&r.firstName&&(r!=null&&r.lastName)?`${r.firstName} ${r.middleInitial||""} ${r.lastName} ${r.suffix||""}`.trim():"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(fo,{className:"h-3 w-3"}),"Plate Number"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.plateNo)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Xs,{className:"h-3 w-3"}),"Date of Apprehension"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:x(r==null?void 0:r.dateOfApprehension)})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Xg,{className:"h-3 w-3"}),"Apprehending Officer"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.apprehendingOfficer)||"N/A"})]}),(r==null?void 0:r.licenseType)&&o.jsxs("div",{className:"md:col-span-2 bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(TT,{className:"h-3 w-3"}),"License Type"]}),o.jsx("div",{className:"ml-4",children:T(r==null?void 0:r.licenseType)})]}),o.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-2",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(fl,{className:"h-3 w-3"}),"Created By"]}),o.jsxs("div",{className:"ml-4 flex items-center gap-2 text-[11px]",children:[o.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:((I=r==null?void 0:r.createdBy)==null?void 0:I.name)||"Unknown"}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:""}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:w(r==null?void 0:r.createdAt)})]})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(za,{className:"h-3 w-3"}),"Updated By"]}),o.jsx("div",{className:"ml-4 flex items-center gap-2 text-[11px]",children:(()=>{const V=r==null?void 0:r.updatedBy;return V&&V.name?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:V.name}),(r==null?void 0:r.updatedAt)&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:""}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:w(r.updatedAt)})]})]}):o.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Not yet updated"})})()})]})]})]})})},D=()=>o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o.jsx(ko,{className:"h-5 w-5 text-red-500"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Driver Violations"})]}),r!=null&&r.violations&&r.violations.length>0?o.jsx("div",{className:"space-y-3",children:r.violations.map((I,V)=>o.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 hover:shadow-md transition-all duration-200",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs font-bold",children:V+1}),o.jsx("div",{className:"flex-1",children:o.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200 leading-relaxed",children:I})})]})},V))}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(ko,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"No violations recorded"}),o.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"This driver has no recorded violations"})]})]}),U=[{id:"violation",label:"Violation Details",icon:ho},{id:"violations",label:"Driver Violations",icon:ko}];return o.jsx(Yi,{open:e,onOpenChange:t,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[80vh] bg-gradient-to-br from-slate-50 to-red-50 dark:from-gray-900 dark:to-gray-800 border-0 shadow-2xl flex flex-col",onPointerDownOutside:I=>I.preventDefault(),onEscapeKeyDown:I=>I.preventDefault(),children:[o.jsx(ia,{className:"pb-3 flex-shrink-0",children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx(aa,{className:"text-lg font-bold bg-gradient-to-r from-red-600 to-orange-600 bg-clip-text text-transparent",children:"Violation Details"}),o.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Comprehensive violation information including apprehension details, violations committed, and confiscated items"}),o.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 flex items-center gap-1",children:[o.jsx(qf,{className:"h-3 w-3 text-red-500"}),"TOP Number: ",o.jsx("span",{className:"font-semibold text-red-600",children:(r==null?void 0:r.topNo)||"N/A"})]})]})})}),o.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[o.jsx("div",{className:"flex-shrink-0 mb-3",children:o.jsx("div",{className:"flex space-x-1 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm p-1 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:U.map(I=>{const V=I.icon;return o.jsxs(ur,{variant:"ghost",onClick:()=>a(I.id),className:`flex-1 flex items-center gap-1 text-xs font-medium transition-all duration-200 ${n===I.id?"bg-gradient-to-r from-red-500 to-orange-500 text-white shadow-lg":"text-gray-600 dark:text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-gray-700"}`,children:[o.jsx(V,{className:"h-3 w-3"}),o.jsx("span",{className:"hidden sm:inline",children:I.label})]},I.id)})})}),o.jsxs("div",{className:"flex-1 overflow-y-auto bg-white/90 dark:bg-gray-900/90 backdrop-blur-sm p-3 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:[n==="violation"&&o.jsx(E,{}),n==="violations"&&o.jsx(D,{})]}),o.jsx("div",{className:"flex-shrink-0 pt-4 border-t border-gray-200 dark:border-gray-700",children:o.jsx("div",{className:"flex items-center justify-end",children:o.jsxs(ur,{onClick:()=>{t(!1),window.dispatchEvent(new CustomEvent("editViolation",{detail:r==null?void 0:r._id}))},className:"mt-2 sm:mt-0 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-lg hover:shadow-xl transition-all duration-200 px-6 py-2 text-sm font-semibold",children:[o.jsx(za,{className:"h-4 w-4 mr-2"}),"Edit Violation"]})})})]})]})})},jUe=({open:e,onOpenChange:t,violationId:r,onViolationUpdated:n})=>{const[a,c]=G.useState(!1),[h,i]=G.useState({}),[x,w]=G.useState(!1),[S,T]=G.useState(!1),[E,D]=G.useState(!1),[U,I]=G.useState({}),{token:V}=Ei(),H=jc(Date.now()),K=ml({resolver:Rl(U4),defaultValues:{topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}}),{reset:Q}=K;G.useEffect(()=>{e&&r&&ae()},[e,r,V]),G.useEffect(()=>{Object.keys(h).length>0&&Q(h)},[h,Q]);const ae=async()=>{w(!0);try{const{data:pe}=await mn.get(`/violations/${r}`,{headers:{Authorization:V}});if(pe!=null&&pe.data){const Se=pe.data,Ee={topNo:Se.topNo!==null?Se.topNo:"null",firstName:Se.firstName!==null?Se.firstName:"null",middleInitial:Se.middleInitial!==null?Se.middleInitial:"null",lastName:Se.lastName!==null?Se.lastName:"null",suffix:Se.suffix!==null?Se.suffix:"null",violations:Se.violations&&Se.violations.length>0?Se.violations:[""],violationType:Se.violationType||"confiscated",licenseType:Se.licenseType!==null?Se.licenseType:void 0,plateNo:Se.plateNo!==null?Se.plateNo:"null",dateOfApprehension:Se.dateOfApprehension?new Date(Se.dateOfApprehension):void 0,apprehendingOfficer:Se.apprehendingOfficer!==null?Se.apprehendingOfficer:"null",chassisNo:Se.chassisNo!==null?Se.chassisNo:"null",engineNo:Se.engineNo!==null?Se.engineNo:"null"};i(Ee),I(Ee)}}catch(pe){console.error("Error fetching violation data:",pe),Xr.error("Failed to load violation data",{description:H})}finally{w(!1)}},ee=pe=>{const Se={topNo:pe.topNo,firstName:pe.firstName,middleInitial:pe.middleInitial,lastName:pe.lastName,suffix:pe.suffix,violations:pe.violations,violationType:pe.violationType,licenseType:pe.licenseType,plateNo:pe.plateNo,dateOfApprehension:pe.dateOfApprehension,apprehendingOfficer:pe.apprehendingOfficer,chassisNo:pe.chassisNo,engineNo:pe.engineNo};return JSON.stringify(Se)!==JSON.stringify(U)},se=()=>{const pe=K.getValues();ee(pe)?T(!0):D(!0)},ue=()=>{T(!1),K.handleSubmit(me)()},he=()=>{T(!1)},Ce=()=>{D(!1)},Ne=()=>{D(!1),t(!1)},me=async pe=>{var Se,Ee;c(!0);try{const we={topNo:pe.topNo,violationType:pe.violationType,plateNo:pe.plateNo,dateOfApprehension:pe.dateOfApprehension,apprehendingOfficer:pe.apprehendingOfficer},Pe=Be=>Be==="null"?null:Be;pe.violationType==="confiscated"?(we.firstName=Pe(pe.firstName),we.middleInitial=Pe(pe.middleInitial),we.lastName=Pe(pe.lastName),we.suffix=Pe(pe.suffix),we.violations=pe.violations?pe.violations.filter(Be=>Be.trim()!==""):[],we.licenseType=Pe(pe.licenseType)):pe.violationType==="impounded"?(we.firstName=Pe(pe.firstName),we.middleInitial=Pe(pe.middleInitial),we.lastName=Pe(pe.lastName),we.suffix=Pe(pe.suffix),we.violations=pe.violations?pe.violations.filter(Be=>Be.trim()!==""):[],we.licenseType=null):pe.violationType==="alarm"&&(we.firstName=null,we.middleInitial=null,we.lastName=null,we.suffix=null,we.violations=null,we.licenseType=null);const{data:Me}=await mn.patch(`/violations/${r}`,we,{headers:{Authorization:V}});Me.success&&(Xr.success("Violation updated successfully",{description:H}),t(!1),n&&n())}catch(we){const Pe=((Ee=(Se=we==null?void 0:we.response)==null?void 0:Se.data)==null?void 0:Ee.message)||"Failed to update violation";Xr.error(Pe,{description:H})}finally{c(!1)}},be=pe=>{!pe&&!a&&K.reset({topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}),t(pe)};return x?o.jsx(Yi,{open:e,onOpenChange:be,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[o.jsxs(ia,{className:"flex-shrink-0",children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(za,{className:"h-5 w-5"}),"Edit Violation"]}),o.jsx(js,{children:"Loading violation data..."})]}),o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})]})}):o.jsxs(Yi,{open:e,onOpenChange:be,children:[o.jsxs(Bi,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[o.jsxs(ia,{className:"flex-shrink-0",children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(za,{className:"h-5 w-5"}),"Edit Violation"]}),o.jsx(js,{children:"Update violation details. All data is pre-filled from the existing record."})]}),o.jsx("div",{className:"flex-1 overflow-y-auto px-1 py-2",children:o.jsx(_5,{form:K,onSubmit:me,submitting:a,isEditMode:!0})}),o.jsxs(mo,{className:"flex-shrink-0 flex justify-start gap-3 pt-4 border-t",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:()=>be(!1),disabled:a,className:"min-w-[100px]",children:"Cancel"}),o.jsxs(ur,{type:"button",onClick:se,disabled:a,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",children:[a&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a?"Updating...":"Update Violation"]})]})]}),o.jsx(Yi,{open:S,onOpenChange:T,children:o.jsxs(Bi,{className:"max-w-md",children:[o.jsxs(ia,{children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(za,{className:"h-5 w-5 text-blue-500"}),"Confirm Update"]}),o.jsx(js,{children:"Are you sure you want to update this violation? This action will modify the existing record."})]}),o.jsxs(mo,{className:"flex justify-end gap-3",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:he,className:"min-w-[80px]",children:"Cancel"}),o.jsx(ur,{type:"button",onClick:ue,className:"min-w-[80px] bg-blue-600 hover:bg-blue-700 text-white",children:"Update"})]})]})}),o.jsx(Yi,{open:E,onOpenChange:D,children:o.jsxs(Bi,{className:"max-w-md",children:[o.jsxs(ia,{children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(za,{className:"h-5 w-5"}),"No Changes Detected"]}),o.jsx(js,{children:"No changes were made to the violation information. Would you like to continue editing?"})]}),o.jsxs(mo,{className:"flex justify-end gap-3",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:Ne,className:"min-w-[80px]",children:"No"}),o.jsx(ur,{type:"button",onClick:Ce,className:"min-w-[80px] bg-blue-600 hover:bg-blue-700 text-white",children:"Yes"})]})]})})]})},kUe=()=>{const[e,t]=G.useState([]),{token:r}=Ei();Ba(),Co();const[n,a]=G.useState(!0),[c,h]=G.useState(!1),[i,x]=G.useState(!1),[w,S]=G.useState(!1),[T,E]=G.useState(!1),[D,U]=G.useState(null),[I,V]=G.useState(null);G.useEffect(()=>{H()},[]),G.useEffect(()=>{const ue=he=>{V(he.detail),E(!0)};return window.addEventListener("editViolation",ue),()=>{window.removeEventListener("editViolation",ue)}},[]);const H=async()=>{try{const{data:ue}=await mn.get("/violations",{headers:{Authorization:r}});ue.data&&ue.data.length>0&&(console.log("Sample violation data from API:",ue.data[0]),console.log("Available fields:",Object.keys(ue.data[0])),console.log("CreatedAt:",ue.data[0].createdAt),console.log("UpdatedAt:",ue.data[0].updatedAt));const he=ue.data.map(Ce=>({_id:Ce._id,topNo:Ce.topNo||"N/A",firstName:Ce.firstName||"N/A",middleInitial:Ce.middleInitial||"",lastName:Ce.lastName||"N/A",suffix:Ce.suffix||"",violations:Ce.violations||[],violationType:Ce.violationType||"confiscated",licenseType:Ce.licenseType||null,plateNo:Ce.plateNo||"N/A",dateOfApprehension:Ce.dateOfApprehension,apprehendingOfficer:Ce.apprehendingOfficer||"N/A",createdAt:Ce.createdAt,updatedAt:Ce.updatedAt,createdBy:Ce.createdBy,updatedBy:Ce.updatedBy}));t(he)}catch(ue){console.log(ue)}finally{a(!1)}},K=()=>{x(!0)},Q=ue=>{U(ue),S(!0)},ae=ue=>{V(ue),E(!0)},ee=()=>{H()},se=()=>{H()};return o.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"bg-white dark:bg-transparent rounded-lg shadow-sm border border-gray-200 dark:border-0 px-4 md:px-6 pt-4 md:pt-6 pb-2 flex-1 flex flex-col min-h-0 overflow-hidden",children:[o.jsx("header",{className:"text-xl md:text-2xl lg:text-3xl font-bold mb-3 md:mb-4 flex-shrink-0",children:"Violations"}),o.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:o.jsx(NUe,{data:e,filters:["topNo","firstName","lastName","violations","violationType","licenseType","plateNo","dateOfApprehension","apprehendingOfficer"],tableColumn:eze,onAdd:K,loading:n,onRowClick:Q,onEdit:ae,onUpdateStatus:()=>{},submitting:c})})]}),o.jsx(AUe,{open:i,onOpenChange:x,onViolationAdded:ee}),o.jsx(TUe,{open:w,onOpenChange:S,violationData:D}),o.jsx(jUe,{open:T,onOpenChange:E,violationId:I,onViolationUpdated:se})]})},PUe=({title:e,filters:t,tableColumn:r,data:n,loading:a,onRowClick:c,onAdd:h,onEdit:i,onUpdateStatus:x,submitting:w})=>{var Ce;const[S,T]=Le.useState([]),[E,D]=Le.useState([]),[U,I]=Le.useState({}),[V,H]=Le.useState({pageIndex:0,pageSize:12}),[K,Q]=Le.useState(""),[ae,ee]=Le.useState(0),se=t,ue=Le.useRef(null);Le.useEffect(()=>{let Ne;const me=()=>{if(ue.current){const pe=ue.current.offsetHeight,Se=180,Ee=80,we=60,Pe=52,Me=pe-Se-Ee-we,Be=Math.max(8,Math.floor(Me/Pe)),Ge=Math.min(Be,25);Ge!==V.pageSize&&H(We=>({...We,pageSize:Ge}))}},be=()=>{clearTimeout(Ne),Ne=setTimeout(me,100)};return setTimeout(me,100),window.addEventListener("resize",be),()=>{window.removeEventListener("resize",be),clearTimeout(Ne)}},[V.pageSize]);const he=R2({data:n,columns:r(i,x,w),onSortingChange:T,onColumnFiltersChange:D,onPaginationChange:H,getCoreRowModel:C2(),getPaginationRowModel:M2(),getSortedRowModel:O2(),getFilteredRowModel:E2(),onColumnVisibilityChange:I,onGlobalFilterChange:Q,globalFilterFn:(Ne,me,be)=>se.some(pe=>{const Se=Ne.getValue(pe);return String(Se).toLowerCase().includes(be.toLowerCase())}),state:{pagination:V,sorting:S,columnFilters:E,columnVisibility:U,globalFilter:K}});return o.jsxs("div",{ref:ue,className:"h-full flex flex-col min-h-0",children:[o.jsx(Ml,{className:"font-semibold flex-shrink-0",children:e}),o.jsxs("div",{className:"md:flex items-center justify-between py-3 flex-shrink-0",children:[o.jsxs("div",{className:"relative hidden md:inline md:max-w-sm flex-shrink",children:[o.jsx(Kw,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx(Yr,{placeholder:"Search Accident...",value:K??"",onChange:Ne=>Q(Ne.target.value),className:"pl-10 pr-10 bg-white text-black border-gray-300 dark:bg-black dark:text-white dark:border-[#424242]"}),K&&o.jsx("button",{onClick:()=>Q(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:o.jsx(zd,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[o.jsxs(ur,{onClick:h,className:"w-min flex items-center gap-2 bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-[#424242] dark:hover:bg-gray-800",children:[o.jsx(v_,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden lg:inline",children:"Add Accident"})]}),o.jsx(L2,{table:he})]})]}),o.jsx("div",{className:"border flex-1 overflow-hidden shadow-sm bg-white dark:bg-transparent border-gray-300 dark:border-[#424242] min-h-0 flex flex-col",children:o.jsx("div",{className:"overflow-x-auto overflow-y-auto flex-1",children:o.jsx("div",{className:"px-0 min-w-full",children:o.jsxs(Im,{className:"min-w-full",children:[o.jsx(Lm,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 dark:bg-[#18181B] border-b-2 border-gray-300 dark:border-[#424242]",children:he.getHeaderGroups().map(Ne=>o.jsx(Ps,{className:"hover:bg-gray-100/50 dark:hover:bg-[#18181B] dark:bg-[#18181B]",children:Ne.headers.map(me=>o.jsx(Ts,{className:"text-xs font-semibold text-gray-800 dark:text-gray-200 px-2 py-4 whitespace-nowrap text-left",children:fp(me.column.columnDef.header,me.getContext())},me.id))},Ne.id))}),o.jsx(Dm,{className:"text-xs bg-white dark:bg-transparent",children:a?o.jsx(I2,{rowCount:V.pageSize,cellCount:he.getAllColumns().length}):(Ce=he.getRowModel().rows)!=null&&Ce.length?o.jsxs(o.Fragment,{children:[he.getRowModel().rows.map(Ne=>o.jsx(Ps,{onClick:()=>c(Ne.original),"data-state":Ne.getIsSelected()&&"selected",className:"hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors duration-150 border-b border-gray-100 dark:border-gray-700 cursor-pointer",children:Ne.getVisibleCells().map(me=>o.jsx(xa,{className:"px-3 py-3 text-gray-800 dark:text-gray-200 text-left",children:fp(me.column.columnDef.cell,me.getContext())},me.id))},Ne.id)),Array.from({length:Math.max(0,V.pageSize-he.getRowModel().rows.length)}).map((Ne,me)=>o.jsx(Ps,{className:"hover:bg-transparent",children:he.getVisibleLeafColumns().map(be=>o.jsx(xa,{className:"px-3 py-3 h-12 border-b border-gray-100 dark:border-gray-700",children:""},`empty-${me}-${be.id}`))},`empty-${me}`))]}):o.jsx(Ps,{className:"hover:bg-transparent",children:o.jsx(xa,{colSpan:he.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:o.jsxs("div",{className:"flex flex-col items-center justify-center",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),o.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),o.jsx("div",{className:"mt-2 mb-2 flex-shrink-0",children:o.jsx(D2,{table:he})})]})},Hie=G.forwardRef(({className:e,...t},r)=>o.jsx("textarea",{className:zt("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));Hie.displayName="Textarea";const uN=["(Incident) Vehicular Accident","(Simple) Police Dispatch for Incident Response","(Incident) Accident caused by negligence","(Simple) Police Dispatch to secure and area/checkpoint","(Operation) Buy Bust"],dN=["Crimes Against Persons","Crimes Against Property"],b5=({form:e,onSubmit:t,submitting:r,isEditMode:n=!1})=>{Ba();const[a,c]=G.useState([]),[h,i]=G.useState([]),[x,w]=G.useState(!1),[S,T]=G.useState(!1);G.useEffect(()=>{const V=localStorage.getItem("customIncidentTypes"),H=localStorage.getItem("customOffenseTypes");c(V?[...uN,...JSON.parse(V)]:uN),i(H?[...dN,...JSON.parse(H)]:dN)},[]),G.useEffect(()=>{const V=e.getValues("incidentType"),H=e.getValues("offenseType");V&&!a.includes(V)&&V!=="Others"?w(!1):V==="Others"&&w(!0),H&&!h.includes(H)&&H!=="Others"?T(!1):H==="Others"&&T(!0)},[a,h]);const E=V=>{V==="Others"?(w(!0),e.setValue("incidentType","")):(w(!1),e.setValue("incidentType",V))},D=V=>{V==="Others"?(T(!0),e.setValue("offenseType","")):(T(!1),e.setValue("offenseType",V))},U=()=>{const V=e.getValues("incidentType"),H=e.getValues("offenseType");if(V&&!uN.includes(V)){const K=localStorage.getItem("customIncidentTypes"),Q=K?JSON.parse(K):[];Q.includes(V)||(Q.push(V),localStorage.setItem("customIncidentTypes",JSON.stringify(Q)),c([...uN,...Q]))}if(H&&!dN.includes(H)){const K=localStorage.getItem("customOffenseTypes"),Q=K?JSON.parse(K):[];Q.includes(H)||(Q.push(H),localStorage.setItem("customOffenseTypes",JSON.stringify(Q)),i([...dN,...Q]))}},I=async V=>(U(),t(V));return o.jsx(up,{...e,children:o.jsxs("form",{id:"accident-form",onSubmit:e.handleSubmit(I),className:"space-y-4",children:[o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.jsx(an,{control:e.control,name:"blotterNo",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Blotter No."}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"BLT-0001",...V,className:zt("text-xs",n&&"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 cursor-not-allowed border-gray-300 dark:border-gray-600"),readOnly:n})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx(an,{control:e.control,name:"vehiclePlateNo",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Vehicle Plate No."}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter vehicle plate no.",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"vehicleMCPlateNo",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Vehicle MC Plate No."}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter motorcycle plate no.",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"vehicleChassisNo",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Vehicle Chassis No."}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter chassis no.",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx(an,{control:e.control,name:"suspect",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Suspect"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter suspect name",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"incidentType",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Incident Type"}),x?o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter custom incident type",...V,className:"text-xs",autoFocus:!0})}):o.jsxs(Js,{onValueChange:E,value:V.value,children:[o.jsx(Hr,{children:o.jsx(Vs,{className:"text-xs",children:o.jsx(yo,{placeholder:"Select incident type"})})}),o.jsxs(Us,{children:[a.map(H=>o.jsx(An,{value:H,children:H},H)),o.jsx(An,{value:"Others",children:"Others"})]})]}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx(an,{control:e.control,name:"offense",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Offense"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter offense",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"offenseType",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Offense Type"}),S?o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter custom offense type",...V,className:"text-xs",autoFocus:!0})}):o.jsxs(Js,{onValueChange:D,value:V.value,children:[o.jsx(Hr,{children:o.jsx(Vs,{className:"text-xs",children:o.jsx(yo,{placeholder:"Select offense type"})})}),o.jsxs(Us,{children:[h.map(H=>o.jsx(An,{value:H,children:H},H)),o.jsx(An,{value:"Others",children:"Others"})]})]}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx(an,{control:e.control,name:"stageOfFelony",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Stage of Felony"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter stage of felony",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"caseStatus",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Case Status"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter case status",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx(an,{control:e.control,name:"region",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Region"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter region",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"province",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Province"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter province",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx(an,{control:e.control,name:"municipality",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Municipality"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter municipality",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"barangay",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Barangay"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter barangay",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]}),o.jsx(an,{control:e.control,name:"street",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Street"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter street",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx(an,{control:e.control,name:"lat",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Latitude"}),o.jsx(Hr,{children:o.jsx(Yr,{type:"number",step:"any",placeholder:"Enter latitude",...V,onChange:H=>V.onChange(H.target.value?parseFloat(H.target.value):void 0),className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"lng",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Longitude"}),o.jsx(Hr,{children:o.jsx(Yr,{type:"number",step:"any",placeholder:"Enter longitude",...V,onChange:H=>V.onChange(H.target.value?parseFloat(H.target.value):void 0),className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]}),o.jsx(an,{control:e.control,name:"dateCommited",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Date Committed"}),o.jsx(Hr,{children:o.jsxs(ip,{children:[o.jsx(ap,{asChild:!0,children:o.jsx(Hr,{children:o.jsxs(ur,{variant:"outline",className:zt("w-full text-left font-normal text-xs justify-start",!V.value&&"text-muted-foreground"),children:[o.jsx(Xs,{className:"h-4 w-4 opacity-50"}),V.value?Ol(V.value,"PPP"):o.jsx("span",{children:"Pick a date"})]})})}),o.jsx(Wh,{className:"w-auto p-2 space-y-2",align:"start",children:o.jsx(F0,{fieldValue:V.value,dateValue:H=>e.setValue("dateCommited",H,{shouldValidate:!0})})})]})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"timeCommited",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Time Committed"}),o.jsx(Hr,{children:o.jsx(Yr,{type:"time",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx(an,{control:e.control,name:"dateReported",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Date Reported"}),o.jsx(Hr,{children:o.jsxs(ip,{children:[o.jsx(ap,{asChild:!0,children:o.jsx(Hr,{children:o.jsxs(ur,{variant:"outline",className:zt("w-full text-left font-normal text-xs justify-start",!V.value&&"text-muted-foreground"),children:[o.jsx(Xs,{className:"h-4 w-4 opacity-50"}),V.value?Ol(V.value,"PPP"):o.jsx("span",{children:"Pick a date"})]})})}),o.jsx(Wh,{className:"w-auto p-2 space-y-2",align:"start",children:o.jsx(F0,{fieldValue:V.value,dateValue:H=>e.setValue("dateReported",H,{shouldValidate:!0})})})]})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"timeReported",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Time Reported"}),o.jsx(Hr,{children:o.jsx(Yr,{type:"time",...V,className:"text-xs"})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]}),o.jsx(an,{control:e.control,name:"dateEncoded",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Date Encoded"}),o.jsx(Hr,{children:o.jsxs(ip,{children:[o.jsx(ap,{asChild:!0,children:o.jsx(Hr,{children:o.jsxs(ur,{variant:"outline",className:zt("w-full text-left font-normal text-xs justify-start",!V.value&&"text-muted-foreground"),children:[o.jsx(Xs,{className:"h-4 w-4 opacity-50"}),V.value?Ol(V.value,"PPP"):o.jsx("span",{children:"Pick a date"})]})})}),o.jsx(Wh,{className:"w-auto p-2 space-y-2",align:"start",children:o.jsx(F0,{fieldValue:V.value,dateValue:H=>e.setValue("dateEncoded",H,{shouldValidate:!0})})})]})}),o.jsx(cn,{className:"text-xs text-red-400"})]})}),o.jsx(an,{control:e.control,name:"narrative",render:({field:V})=>o.jsxs(nn,{className:"space-y-0",children:[o.jsx(pn,{className:"text-xs text-gray-600",children:"Narrative"}),o.jsx(Hr,{children:o.jsx(Hie,{placeholder:"Enter narrative details about the incident...",className:"resize-none text-xs",rows:4,...V})}),o.jsx(cn,{className:"text-xs text-red-400"})]})})]})})},CUe=({open:e,onOpenChange:t,onAccidentAdded:r})=>{const[n,a]=G.useState(!1),{token:c}=Ei(),h=jc(Date.now()),i=ml({resolver:Rl(V4),defaultValues:{blotterNo:"",vehiclePlateNo:"",vehicleMCPlateNo:"",vehicleChassisNo:"",suspect:"",stageOfFelony:"",offense:"",offenseType:"",narrative:"",caseStatus:"",region:"",province:"",municipality:"",barangay:"",street:"",lat:void 0,lng:void 0,dateEncoded:void 0,dateReported:void 0,timeReported:"",dateCommited:void 0,timeCommited:"",incidentType:""}}),x=async S=>{var T,E;a(!0);try{const D={blotterNo:S.blotterNo,vehiclePlateNo:S.vehiclePlateNo,vehicleMCPlateNo:S.vehicleMCPlateNo,vehicleChassisNo:S.vehicleChassisNo,suspect:S.suspect,stageOfFelony:S.stageOfFelony,offense:S.offense,offenseType:S.offenseType,narrative:S.narrative,caseStatus:S.caseStatus,region:S.region,province:S.province,municipality:S.municipality,barangay:S.barangay,street:S.street,lat:S.lat,lng:S.lng,dateEncoded:S.dateEncoded?S.dateEncoded.toISOString():null,dateReported:S.dateReported?S.dateReported.toISOString():null,timeReported:S.timeReported,dateCommited:S.dateCommited?S.dateCommited.toISOString():null,timeCommited:S.timeCommited,incidentType:S.incidentType};console.log("Sending incident data:",D);const{data:U}=await mn.post("/accident",D,{headers:{Authorization:c}});U.success&&(Xr.success("Incident has been added",{description:h}),i.reset({blotterNo:"",vehiclePlateNo:"",vehicleMCPlateNo:"",vehicleChassisNo:"",suspect:"",stageOfFelony:"",offense:"",offenseType:"",narrative:"",caseStatus:"",region:"",province:"",municipality:"",barangay:"",street:"",lat:void 0,lng:void 0,dateEncoded:void 0,dateReported:void 0,timeReported:"",dateCommited:void 0,timeCommited:"",incidentType:""}),t(!1),r&&r())}catch(D){const U=((E=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:E.message)||"Failed to add incident";Xr.error(U,{description:h})}finally{a(!1)}},w=S=>{!S&&!n&&i.reset({blotterNo:"",vehiclePlateNo:"",vehicleMCPlateNo:"",vehicleChassisNo:"",suspect:"",stageOfFelony:"",offense:"",offenseType:"",narrative:"",caseStatus:"",region:"",province:"",municipality:"",barangay:"",street:"",lat:void 0,lng:void 0,dateEncoded:void 0,dateReported:void 0,timeReported:"",dateCommited:void 0,timeCommited:"",incidentType:""}),t(S)};return o.jsx(Yi,{open:e,onOpenChange:w,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[o.jsxs(ia,{className:"flex-shrink-0",children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(ko,{className:"h-5 w-5"}),"Add New Incident"]}),o.jsx(js,{children:"Fill in the required fields to add a new incident record to the system."})]}),o.jsx("div",{className:"flex-1 overflow-y-auto px-1 py-2",children:o.jsx(b5,{form:i,onSubmit:x,submitting:n})}),o.jsxs(mo,{className:"flex-shrink-0 flex justify-start gap-3 pt-4 border-t",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:()=>w(!1),disabled:n,className:"min-w-[100px]",children:"Cancel"}),o.jsxs(ur,{type:"submit",form:"accident-form",disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",children:[n&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Accident"]})]})]})})},EUe=({open:e,onOpenChange:t,accidentData:r,onEdit:n})=>{const[a,c]=G.useState(!1);G.useEffect(()=>{e&&r&&c(!1)},[e,r]);const h=E=>E?new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set",i=E=>E?new Date(E).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"Not set",x=E=>{if(!E)return"Unknown";const{firstName:D,middleName:U,lastName:I}=E;return`${D||""} ${U||""} ${I||""}`.trim()||"Unknown"},w=E=>{let D,U;switch(E==null?void 0:E.toLowerCase()){case"pending":D="bg-yellow-100 text-yellow-800 border-yellow-200",U=o.jsx(AT,{className:"h-3 w-3"});break;case"ongoing":D="bg-blue-100 text-blue-800 border-blue-200",U=o.jsx(ko,{className:"h-3 w-3"});break;case"solved":D="bg-green-100 text-green-800 border-green-200",U=o.jsx(ko,{className:"h-3 w-3"});break;case"closed":D="bg-gray-100 text-gray-800 border-gray-200",U=o.jsx(ko,{className:"h-3 w-3"});break;default:D="bg-gray-100 text-gray-800 border-gray-200",U=o.jsx(ko,{className:"h-3 w-3"})}return o.jsx(Qa,{variant:"outline",className:`text-xs font-medium ${D}`,children:o.jsxs("div",{className:"flex items-center gap-1",children:[U,(E==null?void 0:E.charAt(0).toUpperCase())+(E==null?void 0:E.slice(1))||"N/A"]})})},S=()=>o.jsx("div",{className:"space-y-2",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(qf,{className:"h-3 w-3"}),"Blotter No."]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.blotterNo)||"N/A"})]}),(r==null?void 0:r.vehiclePlateNo)&&o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(qf,{className:"h-3 w-3"}),"Vehicle Plate No."]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r.vehiclePlateNo})]}),(r==null?void 0:r.vehicleMCPlateNo)&&o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(qf,{className:"h-3 w-3"}),"Vehicle MC Plate No."]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r.vehicleMCPlateNo})]}),(r==null?void 0:r.vehicleChassisNo)&&o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(qf,{className:"h-3 w-3"}),"Vehicle Chassis No."]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r.vehicleChassisNo})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(fl,{className:"h-3 w-3"}),"Suspect"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.suspect)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(ko,{className:"h-3 w-3"}),"Incident Type"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.incidentType)||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(ho,{className:"h-3 w-3"}),"Case Status"]}),o.jsx("div",{className:"ml-4",children:w(r==null?void 0:r.caseStatus)})]}),(r==null?void 0:r.offense)&&o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(ho,{className:"h-3 w-3"}),"Offense"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r.offense})]}),(r==null?void 0:r.offenseType)&&o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(ho,{className:"h-3 w-3"}),"Offense Type"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r.offenseType})]}),(r==null?void 0:r.stageOfFelony)&&o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(ho,{className:"h-3 w-3"}),"Stage of Felony"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r.stageOfFelony})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600 md:col-span-2",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Rd,{className:"h-3 w-3"}),"Location"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:[r==null?void 0:r.street,r==null?void 0:r.barangay,r==null?void 0:r.municipality,r==null?void 0:r.province,r==null?void 0:r.region].filter(Boolean).join(", ")||"N/A"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Xs,{className:"h-3 w-3"}),"Date Committed"]}),o.jsxs("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:[(r==null?void 0:r.dateCommited)||"N/A",(r==null?void 0:r.timeCommited)&&` at ${r.timeCommited}`]})]}),(r==null?void 0:r.dateReported)&&o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Xs,{className:"h-3 w-3"}),"Date Reported"]}),o.jsxs("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:[h(r.dateReported),(r==null?void 0:r.timeReported)&&` at ${r.timeReported}`]})]}),(r==null?void 0:r.narrative)&&o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600 md:col-span-2",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(ho,{className:"h-3 w-3"}),"Narrative"]}),o.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r.narrative})]}),o.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-2",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(fl,{className:"h-3 w-3"}),"Created By"]}),o.jsxs("div",{className:"ml-4 flex items-center gap-2 text-xs",children:[o.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:x(r==null?void 0:r.createdBy)}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:""}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:i(r==null?void 0:r.createdAt)})]})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm",children:[o.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(za,{className:"h-3 w-3"}),"Updated By"]}),o.jsxs("div",{className:"ml-4 flex items-center gap-2 text-xs",children:[o.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:x((r==null?void 0:r.updatedBy)||(r==null?void 0:r.createdBy))}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:""}),o.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:i((r==null?void 0:r.updatedAt)||(r==null?void 0:r.createdAt))})]})]})]})]})}),T=[{id:"accident",label:"Accident Details",icon:ho}];return a?o.jsx(Yi,{open:e,onOpenChange:t,children:o.jsx(Bi,{className:"max-w-2xl max-h-[80vh] flex flex-col overflow-hidden",children:o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx(Nc,{className:"h-8 w-8 animate-spin"})})})}):o.jsx(Yi,{open:e,onOpenChange:t,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[80vh] bg-gradient-to-br from-slate-50 to-red-50 dark:from-gray-900 dark:to-gray-800 border-0 shadow-2xl flex flex-col",onPointerDownOutside:E=>E.preventDefault(),onEscapeKeyDown:E=>E.preventDefault(),children:[o.jsx(ia,{className:"pb-3 flex-shrink-0",children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx(aa,{className:"text-lg font-bold bg-gradient-to-r from-red-600 to-red-500 bg-clip-text text-transparent",children:"Incident Details"}),o.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Comprehensive incident information including case details, location, and status"}),o.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 flex items-center gap-1",children:[o.jsx(qf,{className:"h-3 w-3 text-red-500"}),"Blotter No: ",o.jsx("span",{className:"font-semibold text-red-600",children:(r==null?void 0:r.blotterNo)||"N/A"})]})]})})}),o.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[o.jsx("div",{className:"flex-shrink-0 mb-3",children:o.jsx("div",{className:"flex space-x-1 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm p-1 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:T.map(E=>{const D=E.icon;return o.jsxs(ur,{variant:"ghost",className:"flex-1 flex items-center gap-1 text-xs font-medium transition-all duration-200 bg-gradient-to-r from-red-500 to-red-400 text-white shadow-lg",children:[o.jsx(D,{className:"h-3 w-3"}),o.jsx("span",{className:"hidden sm:inline",children:E.label})]},E.id)})})}),o.jsx("div",{className:"flex-1 overflow-y-auto bg-white/90 dark:bg-gray-900/90 backdrop-blur-sm p-3 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:o.jsx(S,{})}),o.jsx("div",{className:"flex-shrink-0 pt-4 border-t border-gray-200 dark:border-gray-700",children:o.jsx("div",{className:"flex items-center justify-end",children:o.jsxs(ur,{onClick:()=>{t(!1),window.dispatchEvent(new CustomEvent("editAccident",{detail:r==null?void 0:r._id}))},className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-lg hover:shadow-xl transition-all duration-200 px-6 py-2 text-sm font-semibold",children:[o.jsx(za,{className:"h-4 w-4 mr-2"}),"Edit Accident"]})})})]})]})})},MUe=({open:e,onOpenChange:t,accidentId:r,onAccidentUpdated:n})=>{const[a,c]=G.useState(!1),[h,i]=G.useState(!1),{token:x}=Ei(),w=jc(Date.now()),S=ml({resolver:Rl(V4),defaultValues:{blotterNo:"",vehiclePlateNo:"",vehicleMCPlateNo:"",vehicleChassisNo:"",suspect:"",stageOfFelony:"",offense:"",offenseType:"",narrative:"",caseStatus:"",region:"",province:"",municipality:"",barangay:"",street:"",lat:void 0,lng:void 0,dateEncoded:void 0,dateReported:void 0,timeReported:"",dateCommited:void 0,timeCommited:"",incidentType:""}});G.useEffect(()=>{e&&r&&T()},[e,r]);const T=async()=>{i(!0);try{const{data:U}=await mn.get(`/accident/${r}`,{headers:{Authorization:x}});if(U.success&&U.data){const I=U.data;S.reset({blotterNo:I.blotterNo||"",vehiclePlateNo:I.vehiclePlateNo||"",vehicleMCPlateNo:I.vehicleMCPlateNo||"",vehicleChassisNo:I.vehicleChassisNo||"",suspect:I.suspect||"",stageOfFelony:I.stageOfFelony||"",offense:I.offense||"",offenseType:I.offenseType||"",narrative:I.narrative||"",caseStatus:I.caseStatus||"",region:I.region||"",province:I.province||"",municipality:I.municipality||"",barangay:I.barangay||"",street:I.street||"",lat:I.lat||void 0,lng:I.lng||void 0,dateEncoded:I.dateEncoded?new Date(I.dateEncoded):void 0,dateReported:I.dateReported?new Date(I.dateReported):void 0,timeReported:I.timeReported||"",dateCommited:I.dateCommited?new Date(I.dateCommited):void 0,timeCommited:I.timeCommited||"",incidentType:I.incidentType||""})}}catch(U){console.error("Error fetching accident:",U),Xr.error("Failed to load accident data",{description:w})}finally{i(!1)}},E=async U=>{var I,V;c(!0);try{const H={blotterNo:U.blotterNo,vehiclePlateNo:U.vehiclePlateNo,vehicleMCPlateNo:U.vehicleMCPlateNo,vehicleChassisNo:U.vehicleChassisNo,suspect:U.suspect,stageOfFelony:U.stageOfFelony,offense:U.offense,offenseType:U.offenseType,narrative:U.narrative,caseStatus:U.caseStatus,region:U.region,province:U.province,municipality:U.municipality,barangay:U.barangay,street:U.street,lat:U.lat,lng:U.lng,dateEncoded:U.dateEncoded?U.dateEncoded.toISOString():null,dateReported:U.dateReported?U.dateReported.toISOString():null,timeReported:U.timeReported,dateCommited:U.dateCommited?U.dateCommited.toISOString():null,timeCommited:U.timeCommited,incidentType:U.incidentType};console.log("Updating incident data:",H);const{data:K}=await mn.patch(`/accident/${r}`,H,{headers:{Authorization:x}});K.success&&(Xr.success("Incident has been updated",{description:w}),t(!1),n&&n())}catch(H){const K=((V=(I=H==null?void 0:H.response)==null?void 0:I.data)==null?void 0:V.message)||"Failed to update incident";Xr.error(K,{description:w})}finally{c(!1)}},D=U=>{!U&&!a&&S.reset({blotterNo:"",vehiclePlateNo:"",vehicleMCPlateNo:"",vehicleChassisNo:"",suspect:"",stageOfFelony:"",offense:"",offenseType:"",narrative:"",caseStatus:"",region:"",province:"",municipality:"",barangay:"",street:"",lat:void 0,lng:void 0,dateEncoded:void 0,dateReported:void 0,timeReported:"",dateCommited:void 0,timeCommited:"",incidentType:""}),t(U)};return h?o.jsx(Yi,{open:e,onOpenChange:D,children:o.jsx(Bi,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})})}):o.jsx(Yi,{open:e,onOpenChange:D,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[o.jsxs(ia,{className:"flex-shrink-0",children:[o.jsxs(aa,{className:"flex items-center gap-2",children:[o.jsx(ko,{className:"h-5 w-5"}),"Edit Incident"]}),o.jsx(js,{children:"Update the accident information. Accident ID cannot be modified."})]}),o.jsx("div",{className:"flex-1 overflow-y-auto px-1 py-2",children:o.jsx(b5,{form:S,onSubmit:E,submitting:a,isEditMode:!0})}),o.jsxs(mo,{className:"flex-shrink-0 flex justify-start gap-3 pt-4 border-t",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:()=>D(!1),disabled:a,className:"min-w-[100px]",children:"Cancel"}),o.jsxs(ur,{type:"submit",form:"accident-form",disabled:a,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",children:[a&&o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a?"Updating...":"Update Accident"]})]})]})})},OUe=()=>{const[e,t]=G.useState([]),{token:r}=Ei();Ba(),Co();const[n,a]=G.useState(!0),[c,h]=G.useState(!1),[i,x]=G.useState(!1),[w,S]=G.useState(!1),[T,E]=G.useState(!1),[D,U]=G.useState(null),[I,V]=G.useState(null);G.useEffect(()=>{H()},[]),G.useEffect(()=>{const se=ue=>{V(ue.detail),E(!0)};return window.addEventListener("editAccident",se),()=>{window.removeEventListener("editAccident",se)}},[]);const H=async()=>{try{const{data:se}=await mn.get("/accident",{headers:{Authorization:r}}),ue=se.data.map(he=>({_id:he._id,blotterNo:he.blotterNo,vehiclePlateNo:he.vehiclePlateNo||"",vehicleMCPlateNo:he.vehicleMCPlateNo||"",vehicleChassisNo:he.vehicleChassisNo||"",suspect:he.suspect||"",stageOfFelony:he.stageOfFelony||"",offense:he.offense||"",offenseType:he.offenseType||"",narrative:he.narrative||"",caseStatus:he.caseStatus||"",region:he.region||"",province:he.province||"",municipality:he.municipality,barangay:he.barangay,street:he.street,lat:he.lat,lng:he.lng,dateEncoded:he.dateEncoded,dateReported:he.dateReported,timeReported:he.timeReported||"",dateCommited:zj(he.dateCommited),timeCommited:he.timeCommited||"",incidentType:he.incidentType||"",createdBy:he.createdBy,updatedBy:he.updatedBy,createdAt:he.createdAt,updatedAt:he.updatedAt}));t(ue)}catch(se){console.log(se)}finally{a(!1)}},K=()=>{x(!0)},Q=se=>{U(se),S(!0)},ae=se=>{V(se),E(!0)},ee=()=>{H()};return o.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"bg-white dark:bg-transparent rounded-lg shadow-sm border border-gray-200 dark:border-0 px-4 md:px-6 pt-4 md:pt-6 pb-2 flex-1 flex flex-col min-h-0 overflow-hidden",children:[o.jsx("header",{className:"text-xl md:text-2xl lg:text-3xl font-bold mb-3 md:mb-4 flex-shrink-0",children:"Incidents"}),o.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:o.jsx(PUe,{data:e,filters:["blotterNo","vehiclePlateNo","incidentType","suspect","dateCommited","caseStatus","municipality","barangay"],tableColumn:XFe,onAdd:K,loading:n,onRowClick:Q,onEdit:ae,onUpdateStatus:()=>{},submitting:c})})]}),o.jsx(CUe,{open:i,onOpenChange:x,onAccidentAdded:ee}),o.jsx(EUe,{open:w,onOpenChange:S,accidentData:D,onEdit:ae}),o.jsx(MUe,{open:T,onOpenChange:E,accidentId:I,onAccidentUpdated:ee})]})},RUe=()=>{const[e,t]=G.useState(!1),{token:r}=Ei(),n=J0(),a=jc(Date.now()),c=Ba(),h=ml({resolver:Rl(V4),defaultValues:{blotterNo:"",vehiclePlateNo:"",vehicleMCPlateNo:"",vehicleChassisNo:"",suspect:"",stageOfFelony:"",offense:"",offenseType:"",narrative:"",caseStatus:"",region:"",province:"",municipality:"",barangay:"",street:"",lat:void 0,lng:void 0,dateEncoded:void 0,dateReported:void 0,timeReported:"",dateCommited:void 0,timeCommited:"",incidentType:""}}),{reset:i}=h;G.useEffect(()=>{x()},[n.id,r]);const x=async()=>{const S=n.id;try{const{data:T}=await mn.get(`/accident/${S}`,{headers:{Authorization:r}});if(T!=null&&T.data){const E=T.data;i({blotterNo:E.blotterNo||"",vehiclePlateNo:E.vehiclePlateNo||"",vehicleMCPlateNo:E.vehicleMCPlateNo||"",vehicleChassisNo:E.vehicleChassisNo||"",suspect:E.suspect||"",stageOfFelony:E.stageOfFelony||"",offense:E.offense||"",offenseType:E.offenseType||"",narrative:E.narrative||"",caseStatus:E.caseStatus||"",region:E.region||"",province:E.province||"",municipality:E.municipality||"",barangay:E.barangay||"",street:E.street||"",lat:E.lat||void 0,lng:E.lng||void 0,dateEncoded:E.dateEncoded?new Date(E.dateEncoded):void 0,dateReported:E.dateReported?new Date(E.dateReported):void 0,timeReported:E.timeReported||"",dateCommited:E.dateCommited?new Date(E.dateCommited):void 0,timeCommited:E.timeCommited||"",incidentType:E.incidentType||""})}}catch(T){console.log(T)}},w=async S=>{var T,E;t(!0);try{const D={blotterNo:S.blotterNo,vehiclePlateNo:S.vehiclePlateNo,vehicleMCPlateNo:S.vehicleMCPlateNo,vehicleChassisNo:S.vehicleChassisNo,suspect:S.suspect,stageOfFelony:S.stageOfFelony,offense:S.offense,offenseType:S.offenseType,narrative:S.narrative,caseStatus:S.caseStatus,region:S.region,province:S.province,municipality:S.municipality,barangay:S.barangay,street:S.street,lat:S.lat,lng:S.lng,dateEncoded:S.dateEncoded?S.dateEncoded.toISOString():null,dateReported:S.dateReported?S.dateReported.toISOString():null,timeReported:S.timeReported,dateCommited:S.dateCommited?S.dateCommited.toISOString():null,timeCommited:S.timeCommited,incidentType:S.incidentType},{data:U}=await mn.patch(`/accident/${n.id}`,D,{headers:{Authorization:r}});U.success&&(Xr.success("Incident updated",{description:a}),c(-1))}catch(D){const U=((E=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:E.message)||"Failed to update incident";Xr.error(U,{description:`${a}`})}finally{t(!1)}};return o.jsxs(Ri,{children:[o.jsxs(Ki,{children:[o.jsx(Zi,{className:"text-xl md:text-3xl font-bold",children:"Edit Incident"}),o.jsx(As,{children:"Update incident details."})]}),o.jsx(Fi,{children:o.jsx(b5,{form:h,onSubmit:w,submitting:e})})]})},IUe=()=>{const[e,t]=G.useState(!1),{token:r}=Ei(),n=J0(),a=jc(Date.now()),c=Ba(),h=ml({resolver:Rl(U4),defaultValues:{topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}}),{reset:i}=h;G.useEffect(()=>{x()},[n.id,r]);const x=async()=>{const S=n.id;try{const{data:T}=await mn.get(`/violations/${S}`,{headers:{Authorization:r}});if(T!=null&&T.data){const E=T.data,D=E.violationType||"confiscated";i({topNo:E.topNo||"",firstName:E.firstName||"",middleInitial:E.middleInitial||"",lastName:E.lastName||"",suffix:E.suffix||"",violations:E.violations||[""],violationType:D,licenseType:E.licenseType||void 0,plateNo:E.plateNo||"",dateOfApprehension:E.dateOfApprehension?new Date(E.dateOfApprehension):void 0,apprehendingOfficer:E.apprehendingOfficer||""})}}catch(T){console.log(T)}},w=async S=>{var T,E;t(!0);try{const D={topNo:S.topNo,violationType:S.violationType,plateNo:S.plateNo,dateOfApprehension:S.dateOfApprehension,apprehendingOfficer:S.apprehendingOfficer};S.violationType==="confiscated"?(D.firstName=S.firstName,D.middleInitial=S.middleInitial,D.lastName=S.lastName,D.suffix=S.suffix,D.violations=S.violations?S.violations.filter(I=>I.trim()!==""):[],D.licenseType=S.licenseType):S.violationType==="impounded"?(D.firstName=S.firstName,D.middleInitial=S.middleInitial,D.lastName=S.lastName,D.suffix=S.suffix,D.violations=S.violations?S.violations.filter(I=>I.trim()!==""):[],D.licenseType=null):S.violationType==="alarm"&&(D.firstName=null,D.middleInitial=null,D.lastName=null,D.suffix=null,D.violations=null,D.licenseType=null);const{data:U}=await mn.patch(`/violations/${n.id}`,D,{headers:{Authorization:r}});U.success&&(Xr.success("Violation updated",{description:a}),c(-1))}catch(D){const U=((E=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:E.message)||"Failed to update violation";Xr.error(U,{description:`${a}`})}finally{t(!1)}};return o.jsxs(Ri,{children:[o.jsxs(Ki,{children:[o.jsx(Zi,{className:"text-xl md:text-3xl font-bold",children:"Edit Violation"}),o.jsx(As,{children:"Update violation details."})]}),o.jsx(Fi,{children:o.jsx(_5,{form:h,onSubmit:w,submitting:e})})]})},LUe=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await mn.get("/dashboard/registration-analytics",{params:r})).data}catch(r){throw console.error("Error fetching registration analytics:",r),r}},Uj=e=>["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(e)+1,DUe=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await mn.get("/dashboard/municipality-registration-totals",{params:r})).data}catch(r){throw console.error("Error fetching municipality registration totals:",r),r}},FUe=async(e,t=null,r=null)=>{try{const n={municipality:e};return t&&(n.month=t),r&&(n.year=r),(await mn.get("/dashboard/barangay-registration-totals",{params:n})).data}catch(n){throw console.error("Error fetching barangay registration totals:",n),n}},zUe=async(e=null,t=null,r=null)=>{try{const n={};return e&&(n.startYear=e),t&&(n.endYear=t),r&&(n.municipality=r),(await mn.get("/dashboard/yearly-vehicle-trends",{params:n})).data}catch(n){throw console.error("Error fetching yearly vehicle trends:",n),n}},BUe=async(e,t=null)=>{try{const r={year:e};return t&&(r.municipality=t),(await mn.get("/dashboard/monthly-vehicle-trends",{params:r})).data}catch(r){throw console.error("Error fetching monthly vehicle trends:",r),r}},VUe=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await mn.get("/dashboard/owner-municipality-data",{params:r})).data}catch(r){throw console.error("Error fetching owner municipality data:",r),r}},UUe=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await mn.get("/dashboard/vehicle-classification-data",{params:r})).data}catch(r){throw console.error("Error fetching vehicle classification data:",r),r}},$Ue=({isOpen:e,onClose:t,municipality:r,selectedMonth:n,selectedYear:a,municipalitiesList:c=[]})=>{var Se,Ee;const[h,i]=G.useState([]),[x,w]=G.useState(!1),[S,T]=G.useState(null),[E,D]=G.useState("desc"),[U,I]=G.useState(!1),[V,H]=G.useState(!1),[K,Q]=G.useState(0),[ae,ee]=G.useState("right"),[se,ue]=G.useState(!1);G.useEffect(()=>{if(e&&r&&c.length>0){const we=c.findIndex(Pe=>Pe.municipality===r);Q(we>=0?we:0)}},[e,r,c]),G.useEffect(()=>{e&&r&&he()},[e,r,n,a]),G.useEffect(()=>{H(!!e)},[e]);const he=async(we=r)=>{try{w(!0),T(null);let Pe=null,Me=null;n&&n!=="All"&&(Pe=["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(n)+1),a&&a!=="All"&&(Me=a),console.log("Fetching barangay data for",we,"with:",{monthNumber:Pe,yearValue:Me,selectedMonth:n,selectedYear:a});const Be=await FUe(we,Pe,Me);i(Be.data||[])}catch(Pe){console.error("Error fetching barangay data:",Pe),T("Error loading barangay data")}finally{w(!1)}},Ce=()=>{K>0&&(ee("left"),ue(!0),setTimeout(()=>{const we=K-1;Q(we);const Pe=c[we].municipality;he(Pe),setTimeout(()=>ue(!1),100)},200))},Ne=()=>{K<c.length-1&&(ee("right"),ue(!0),setTimeout(()=>{const we=K+1;Q(we);const Pe=c[we].municipality;he(Pe),setTimeout(()=>ue(!1),100)},200))},me=we=>we.toLocaleString(),be=()=>{I(!0),D(we=>we==="desc"?"asc":"desc"),setTimeout(()=>I(!1),300)},pe=[...h].sort((we,Pe)=>E==="desc"?Pe.vehicles-we.vehicles:we.vehicles-Pe.vehicles);return e?o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-2 sm:p-4",children:o.jsxs("div",{className:`bg-gray-100 border border-gray-200/50 rounded-2xl p-4 sm:p-6 w-full max-w-4xl h-[90vh] sm:h-[85vh] overflow-hidden dark:!bg-gradient-to-br dark:!from-[#1a1a2e] dark:!via-[#16213e] dark:!to-[#0f3460] dark:!border-[#2A2A3E]/50 dark:!shadow-2xl flex flex-col transition-all duration-500 ease-out transform ${V?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 translate-y-4"}`,children:[o.jsxs("div",{className:"bg-gray-100 dark:!bg-gradient-to-br dark:!from-[#1a1a2e] dark:!via-[#16213e] dark:!to-[#0f3460] border-b border-gray-200/50 dark:border-gray-700/30 pb-4 mb-4 flex-shrink-0",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[o.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl shadow-lg",children:o.jsxs("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[o.jsx("path",{d:"M3 3v18h18"}),o.jsx("path",{d:"M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"}),o.jsx("path",{d:"M16 5l3 3-3 3"})]})}),o.jsxs("div",{className:"flex items-center gap-3",children:[c.length>1&&o.jsx(o.Fragment,{children:o.jsx("button",{onClick:Ce,disabled:K===0,className:`p-2 rounded-xl transition-all duration-300 transform ${K===0?"text-gray-400 cursor-not-allowed scale-95":"text-gray-600 hover:text-blue-600 hover:bg-blue-50 hover:scale-110 active:scale-95 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 shadow-sm hover:shadow-md"}`,title:"Previous Municipality",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})})}),o.jsxs("div",{className:"overflow-hidden",children:[o.jsx("h2",{className:`text-xl sm:text-2xl lg:text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent dark:from-blue-400 dark:to-purple-400 transition-all duration-500 ease-in-out ${se?ae==="left"?"opacity-0 transform translate-x-4 scale-95":"opacity-0 transform -translate-x-4 scale-95":"opacity-100 transform translate-x-0 scale-100"}`,children:((Se=c[K])==null?void 0:Se.municipality)||r}),o.jsxs("p",{className:`text-sm text-muted-foreground mt-1 transition-all duration-500 ease-in-out ${se?"opacity-0 transform translate-y-2":"opacity-100 transform translate-y-0"}`,children:["Barangay Registration Data",a==="All"&&n&&n!=="All"&&o.jsxs("span",{className:"ml-2 text-xs",children:["(",n," across all years)"]})]})]}),c.length>1&&o.jsx("button",{onClick:Ne,disabled:K===c.length-1,className:`p-2 rounded-xl transition-all duration-300 transform ${K===c.length-1?"text-gray-400 cursor-not-allowed scale-95":"text-gray-600 hover:text-blue-600 hover:bg-blue-50 hover:scale-110 active:scale-95 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 shadow-sm hover:shadow-md"}`,title:"Next Municipality",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),o.jsx("button",{onClick:t,className:"p-3 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-all duration-200 hover:scale-105",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl p-3 border border-blue-200/50 dark:border-blue-700/30 shadow-md hover:shadow-lg transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-md flex items-center justify-center",children:o.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),o.jsx("div",{className:"text-xs font-medium text-blue-700 dark:text-blue-300",children:"Total Barangays"})]}),o.jsx("div",{className:"text-xl font-bold text-blue-900 dark:text-blue-100",children:h.length})]}),o.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-xl p-3 border border-green-200/50 dark:border-green-700/30 shadow-md hover:shadow-lg transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-md flex items-center justify-center",children:o.jsxs("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0M15 17a2 2 0 104 0"})]})}),o.jsx("div",{className:"text-xs font-medium text-green-700 dark:text-green-300",children:"Total Vehicles"})]}),o.jsx("div",{className:"text-xl font-bold text-green-900 dark:text-green-100",children:me(h.reduce((we,Pe)=>we+Pe.vehicles,0))})]}),o.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 rounded-xl p-3 border border-orange-200/50 dark:border-orange-700/30 shadow-md hover:shadow-lg transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("div",{className:"w-6 h-6 bg-orange-500 rounded-md flex items-center justify-center",children:o.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),o.jsx("div",{className:"text-xs font-medium text-orange-700 dark:text-orange-300",children:"Zero Registrations"})]}),o.jsx("div",{className:"text-xl font-bold text-orange-900 dark:text-orange-100",children:h.filter(we=>we.vehicles===0).length})]})]})]}),o.jsx("div",{className:"overflow-y-auto flex-1 scrollbar-hide overflow-x-hidden min-h-0",children:o.jsx("div",{className:`transition-all duration-500 ease-in-out ${se?ae==="left"?"opacity-0 transform translate-x-6 scale-98":"opacity-0 transform -translate-x-6 scale-98":"opacity-100 transform translate-x-0 scale-100"}`,children:x?o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):S?o.jsx("div",{className:"flex items-center justify-center min-h-[400px] text-red-500",children:o.jsx("p",{children:S})}):h.length===0?o.jsx("div",{className:"flex items-center justify-center min-h-[400px] text-muted-foreground",children:o.jsxs("p",{children:["No barangay data available for ",((Ee=c[K])==null?void 0:Ee.municipality)||r]})}):o.jsx("div",{children:o.jsx("div",{className:"bg-gray-100 dark:bg-gray-800/50 rounded-2xl border border-gray-200/50 dark:border-gray-700/30 overflow-hidden min-h-[400px] overflow-x-auto",children:o.jsxs("table",{className:"w-full min-w-[600px]",children:[o.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 sm:px-6 py-4 text-left text-xs sm:text-sm font-semibold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:"Barangay Name"}),o.jsx("th",{className:"px-3 sm:px-6 py-4 text-left text-xs sm:text-sm font-semibold text-gray-700 dark:text-gray-200 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 select-none",onClick:be,children:o.jsxs("div",{className:"flex items-center gap-2",children:["Total Registered Vehicles",o.jsxs("div",{className:"flex flex-col",children:[o.jsx("svg",{className:`w-3 h-3 ${E==="desc"?"text-blue-500 dark:text-blue-400":"text-gray-400 dark:text-gray-500"}`,fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z",clipRule:"evenodd"})}),o.jsx("svg",{className:`w-3 h-3 ${E==="asc"?"text-blue-500 dark:text-blue-400":"text-gray-400 dark:text-gray-500"}`,fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})})]})}),o.jsx("tbody",{className:"bg-white dark:bg-gray-800/30 divide-y divide-gray-200/50 dark:divide-gray-700/30",children:pe.map((we,Pe)=>{const Me=we.vehicles===0;return o.jsxs("tr",{className:`hover:bg-gray-50/80 dark:hover:bg-gray-700/50 transition-all duration-200 ${Me?"bg-gradient-to-r from-red-50/80 to-red-100/50 dark:from-red-900/20 dark:to-red-800/10 border-l-4 border-red-500":""}`,style:{animation:`smoothFadeIn 0.6s ease-out ${Pe*.03}s both`},children:[o.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-5 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center mr-4 shadow-sm ${Me?"bg-gradient-to-br from-red-100 to-red-200 dark:from-red-900/40 dark:to-red-800/40":"bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-900/40 dark:to-blue-800/40"}`,children:o.jsx("span",{className:`text-sm font-bold ${Me?"text-red-700 dark:text-red-300":"text-blue-700 dark:text-blue-300"}`,children:Pe+1})}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`text-base font-semibold ${Me?"text-red-800 dark:text-red-200":"text-gray-800 dark:text-gray-200"}`,children:we.barangay}),Me&&o.jsx("span",{className:"px-3 py-1 text-xs font-semibold bg-gradient-to-r from-red-100 to-red-200 text-red-800 dark:from-red-900/40 dark:to-red-800/40 dark:text-red-200 rounded-full shadow-sm",children:"No Registrations"})]})]})}),o.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-5 whitespace-nowrap",children:o.jsx("div",{className:`text-lg font-bold ${Me?"text-red-600 dark:text-red-400":"text-gray-800 dark:text-gray-200"}`,children:me(we.vehicles)})})]},we.barangay)})})]})})})})})]})}):null},qUe=({selectedMonth:e,selectedYear:t,loading:r})=>{const[n,a]=G.useState([]),[c,h]=G.useState(!1),[i,x]=G.useState(null),[w,S]=G.useState(!1),[T,E]=G.useState("desc"),[D,U]=G.useState(!1),[I,V]=G.useState(!1),[H,K]=G.useState(null),[Q,ae]=G.useState(!1);G.useEffect(()=>{const pe=()=>{ae(window.innerWidth<640)};return pe(),window.addEventListener("resize",pe),()=>window.removeEventListener("resize",pe)},[]);const ee=async()=>{try{h(!0),x(null);let pe=null,Se=null;e&&e!=="All"&&(pe=Uj(e)),t&&t!=="All"&&(Se=t);const Ee=await DUe(pe,Se);Ee.success?a(Ee.data):(x("Failed to fetch municipality data"),a([]))}catch(pe){console.error("Error fetching municipality data:",pe),x("Error loading municipality data")}finally{h(!1)}};G.useEffect(()=>{ee(),U(!1)},[]),G.useEffect(()=>{ee(),U(!1)},[e,t]);const se=[...n].sort((pe,Se)=>T==="asc"?pe.vehicles-Se.vehicles:Se.vehicles-pe.vehicles),ue=se.slice(0,5);G.useEffect(()=>{if(n.length>0){const pe=setTimeout(()=>U(!0),100);return()=>clearTimeout(pe)}},[n]);const he=pe=>pe.map((Se,Ee)=>({name:Se.municipality,vehicles:Se.vehicles,index:Ee,totalCount:pe.length})),Ce=(pe,Se)=>{if(T==="asc"){if(pe<5)return pe===0?"#dc2626":pe===1?"#ea580c":pe===2?"#d97706":pe===3?"#ca8a04":"#eab308";if(pe>=5&&pe<Se-5)return"#84cc16";if(pe>=Se-5)return pe===Se-1?"#1d4ed8":pe===Se-2?"#2563eb":pe===Se-3?"#3b82f6":pe===Se-4?"#60a5fa":"#93c5fd"}else{if(pe<5)return pe===0?"#1d4ed8":pe===1?"#2563eb":pe===2?"#3b82f6":pe===3?"#60a5fa":"#93c5fd";if(pe>=5&&pe<Se-5)return"#84cc16";if(pe>=Se-5)return pe===Se-1?"#dc2626":pe===Se-2?"#ea580c":pe===Se-3?"#d97706":pe===Se-4?"#ca8a04":"#eab308"}return"#3b82f6"},Ne=({active:pe,payload:Se,label:Ee})=>{if(pe&&Se&&Se.length){const we=Se[0].value,Pe=se.length>0?(we/Math.max(...se.map(Me=>Me.vehicles))*100).toFixed(1):0;return o.jsx("div",{className:"bg-gray-100/90 dark:bg-gray-700/90 border border-gray-400/40 dark:border-gray-500/40 rounded-xl p-4 shadow-2xl backdrop-blur-sm",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-gradient-to-r from-blue-500 to-purple-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:Ee}),o.jsxs("p",{className:"text-blue-600 dark:text-blue-400 text-xs",children:[o.jsx("span",{className:"font-semibold text-lg",children:we.toLocaleString()})," vehicles"]}),o.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-xs",children:[Pe,"% of highest"]})]})]})})}return null},me=pe=>{K(pe),V(!0)},be=()=>{V(!1),K(null)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 w-full max-w-4xl mx-auto h-fit shadow-sm dark:!bg-transparent dark:!border-gray-700 min-h-[400px] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:o.jsxs("svg",{className:"w-6 h-6 text-orange-500",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[o.jsx("path",{d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),o.jsx("path",{d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),o.jsxs("div",{className:"flex flex-col",children:[o.jsxs("h2",{className:"text-sm font-bold text-foreground",children:["DavOr Vehicle Registration Rankings",t==="All"&&e&&e!=="All"&&o.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&o.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(All months in ",t,")"]})]}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Top performing municipalities by vehicle registration volume"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:()=>E(T==="asc"?"desc":"asc"),className:"px-3 py-1.5 text-sm font-medium text-primary bg-primary/10 hover:bg-primary/20 rounded-md transition-colors flex items-center gap-1",title:`Sort ${T==="asc"?"Highest to Lowest":"Lowest to Highest"}`,children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T==="asc"?o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"}):o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"})}),T==="asc"?"":""]}),o.jsx("button",{onClick:()=>S(!0),className:"px-3 py-1.5 text-sm font-medium text-primary bg-primary/10 hover:bg-primary/20 rounded-md transition-colors",children:"View All"})]})]}),o.jsxs("div",{className:"h-80 w-full min-h-[320px] flex-1",children:[c||r?o.jsx("div",{className:"flex items-center justify-center w-full h-full",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i?o.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:o.jsx("p",{children:i})}):ue.length===0?o.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:o.jsx("p",{children:"No data available"})}):o.jsx(uo,{width:"100%",height:"100%",minHeight:320,children:o.jsxs(Xc,{data:he(ue),margin:{top:10,right:10,left:5,bottom:20},barCategoryGap:"10%",children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),o.jsx(ga,{dataKey:"name",stroke:"#6b7280",fontSize:9,height:20,interval:0,tick:{fill:"#6b7280",fontWeight:500},tickFormatter:pe=>pe.length>12?pe.substring(0,12)+"...":pe}),o.jsx(ya,{stroke:"#6b7280",fontSize:9,tickFormatter:pe=>pe.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:50}),o.jsx(zi,{content:o.jsx(Ne,{})}),o.jsx(rs,{dataKey:"vehicles",radius:[8,8,0,0],onClick:pe=>me(pe.name),style:{cursor:"pointer"},maxBarSize:120,children:he(ue).map((pe,Se)=>{const Ee=Ce(pe.index,pe.totalCount);return o.jsx(Jh,{fill:Ee,stroke:Ee,strokeWidth:2,style:{filter:"drop-shadow(0 4px 8px rgba(0, 0, 0, 0.15))",transition:"all 0.3s ease"}},`cell-${Se}`)})})]})}),ue.length>0&&o.jsxs("div",{className:"flex flex-wrap justify-center gap-4 text-gray-600 dark:text-gray-400",style:{fontSize:Q?"10px":"12px",fontWeight:"500",paddingTop:"0px",paddingBottom:"0px",textAlign:"center"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-700"}),o.jsx("span",{children:"High"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),o.jsx("span",{children:"Medium-high"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),o.jsx("span",{children:"Medium"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),o.jsx("span",{children:"Low"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),o.jsx("span",{children:"Lowest"})]})]})]})]}),w&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 border border-gray-200 rounded-xl p-4 w-full max-w-5xl max-h-[85vh] overflow-hidden shadow-2xl dark:!bg-transparent dark:!border-[#2A2A3E] dark:!shadow-none dark:!from-transparent dark:!to-transparent",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:o.jsxs("svg",{className:"w-6 h-6 text-foreground",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[o.jsx("path",{d:"M3 3v18h18"}),o.jsx("path",{d:"M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"}),o.jsx("path",{d:"M16 5l3 3-3 3"})]})}),o.jsxs("h2",{className:"text-2xl font-bold text-foreground",children:["All Municipalities",t==="All"&&e&&e!=="All"&&o.jsxs("span",{className:"text-lg font-normal text-muted-foreground ml-2",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&o.jsxs("span",{className:"text-lg font-normal text-muted-foreground ml-2",children:["(All months in ",t,")"]})]})]}),o.jsx("button",{onClick:()=>S(!1),className:"p-2 hover:bg-muted rounded-md transition-colors",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsx("div",{className:"h-[500px]",children:o.jsx(uo,{width:"100%",height:"100%",minHeight:320,children:o.jsxs(Xc,{data:he(se),margin:{top:20,right:10,left:10,bottom:60},barCategoryGap:"5%",children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),o.jsx(ga,{dataKey:"name",stroke:"#6b7280",fontSize:9,height:5,interval:0,tick:{fill:"#6b7280",fontWeight:500},tickFormatter:pe=>pe.length>12?pe.substring(0,12)+"...":pe}),o.jsx(ya,{stroke:"#6b7280",fontSize:12,tickFormatter:pe=>pe.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:60}),o.jsx(zi,{content:o.jsx(Ne,{})}),o.jsx(rs,{dataKey:"vehicles",radius:[6,6,0,0],onClick:pe=>me(pe.name),style:{cursor:"pointer"},maxBarSize:80,children:he(se).map((pe,Se)=>{const Ee=Ce(pe.index,pe.totalCount);return o.jsx(Jh,{fill:Ee,stroke:Ee,strokeWidth:1.5,style:{filter:"drop-shadow(0 3px 6px rgba(0, 0, 0, 0.12))",transition:"all 0.3s ease"}},`cell-${Se}`)})})]})})})]})}),o.jsx($Ue,{isOpen:I,onClose:be,municipality:H,selectedMonth:e,selectedYear:t,municipalitiesList:se})]})},GUe=()=>{const[e,t]=G.useState([]),[r,n]=G.useState(!1);G.useEffect(()=>{const nt=()=>{n(window.innerWidth<640)};return nt(),window.addEventListener("resize",nt),()=>window.removeEventListener("resize",nt)},[]),G.useEffect(()=>{const nt=document.createElement("style");return nt.textContent=`
      .scrollbar-hide {
        -ms-overflow-style: none;  /* Internet Explorer 10+ */
        scrollbar-width: none;  /* Firefox */
      }
      .scrollbar-hide::-webkit-scrollbar { 
        display: none;  /* Safari and Chrome */
      }
    `,document.head.appendChild(nt),()=>{document.head.removeChild(nt)}},[]);const[a,c]=G.useState(!1),[h,i]=G.useState(null),[x,w]=G.useState(!1),[S,T]=G.useState(!1),[E,D]=G.useState(""),[U,I]=G.useState(""),[V,H]=G.useState(!1),[K,Q]=G.useState("year"),[ae,ee]=G.useState(!1),[se,ue]=G.useState(""),[he,Ce]=G.useState(()=>localStorage.getItem("vehicleTrendMunicipality")||"All"),[Ne,me]=G.useState(!1),be=new Date().getFullYear(),pe=["All","BAGANGA","BANAYBANAY","BOSTON","CARAGA","CATEEL","GOVERNOR GENEROSO","LUPON","MANAY","SAN ISIDRO","TARRAGONA","CITY OF MATI"],Se=async(nt,Dt,nr=null)=>{try{c(!0),i(null);const rr=await zUe(nt,Dt,nr||he);if(rr.success){const or=rr.data.map((Ft,ze,Pr)=>Ft.total===0?Pr.slice(ze+1).find(on=>on.total>0)?{...Ft,total:0,active:0,expired:0,noRegistration:null}:{...Ft,total:null,active:null,expired:null,noRegistration:0}:{...Ft,noRegistration:null});t(or)}else i("Failed to fetch yearly trend data"),t([])}catch(ir){console.error("Error fetching yearly trend data:",ir),i("Error loading yearly trend data")}finally{c(!1)}},Ee=async(nt,Dt=null)=>{try{c(!0),i(null);const ir=await BUe(nt,Dt||he);if(ir.success){console.log("Raw monthly data:",ir.data);const rr=ir.data.map((or,Ft,ze)=>or.total===0?ze.slice(Ft+1).find(Kt=>Kt.total>0)?{...or,total:0,active:0,expired:0,noRegistration:null}:{...or,total:null,active:null,expired:null,noRegistration:0}:{...or,noRegistration:null});console.log("Processed monthly data:",rr),t(rr)}else i("Failed to fetch monthly trend data"),t([])}catch(nr){console.error("Error fetching monthly trend data:",nr),i("Error loading monthly trend data")}finally{c(!1)}},we=()=>{w(!0)},Pe=()=>{const nt=parseInt(E),Dt=parseInt(U);if(i(null),!nt||!Dt){i("Please enter both start and end years");return}if(nt<2e3){i(`Start year ${nt} is too early. Please enter a year from 2000 onwards`);return}if(Dt>be){i(`End year ${Dt} is in the future. Please enter a year up to ${be}`);return}if(nt>Dt){i(`Start year ${nt} cannot be later than end year ${Dt}`);return}H(!0),localStorage.setItem("vehicleTrendCustomStartYear",nt.toString()),localStorage.setItem("vehicleTrendCustomEndYear",Dt.toString()),localStorage.setItem("vehicleTrendIsCustomRange","true"),K==="year"&&Se(nt,Dt,he),T(!1)},Me=()=>{H(!1),D(""),I(""),i(null),localStorage.removeItem("vehicleTrendCustomStartYear"),localStorage.removeItem("vehicleTrendCustomEndYear"),localStorage.removeItem("vehicleTrendIsCustomRange"),K==="year"&&Se(be-4,be,he),T(!1)},Be=nt=>{Q(nt),localStorage.setItem("vehicleTrendViewType",nt),nt==="year"?(H(!1),D(""),I(""),Se(be-4,be,he),w(!1)):nt==="month"?(ee(!0),w(!1)):nt==="customRange"&&w(!1)},Ge=nt=>{ue(nt),localStorage.setItem("vehicleTrendSelectedYear",nt),i(null),ee(!1),Ee(nt,he)},We=nt=>{Ce(nt),localStorage.setItem("vehicleTrendMunicipality",nt),me(!1),K==="year"?V&&E&&U?Se(parseInt(E),parseInt(U),nt):Se(be-4,be,nt):K==="month"&&se&&Ee(se,nt)};G.useEffect(()=>{const nt=localStorage.getItem("vehicleTrendMunicipality")||"All";Se(be-4,be,nt),localStorage.setItem("vehicleTrendViewType","year"),localStorage.removeItem("vehicleTrendSelectedYear"),localStorage.removeItem("vehicleTrendIsCustomRange"),localStorage.removeItem("vehicleTrendCustomStartYear"),localStorage.removeItem("vehicleTrendCustomEndYear")},[]),G.useEffect(()=>{const nt=Dt=>{x&&!Dt.target.closest(".filter-dropdown")&&w(!1)};return document.addEventListener("mousedown",nt),()=>{document.removeEventListener("mousedown",nt)}},[x]),G.useEffect(()=>{K==="month"&&!se&&(Q("year"),H(!1),D(""),I(""),Se(be-4,be,he))},[K,se]);const tt=({active:nt,payload:Dt,label:nr})=>{if(nt&&Dt&&Dt.length){const ir=Dt.filter(or=>or.value!==null&&or.dataKey!=="noRegistration"&&(or.dataKey==="total"||or.dataKey==="active"||or.dataKey==="expired")),rr=ir.every(or=>or.value===0);return o.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg p-3 shadow-lg",children:[o.jsx("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2",children:nr}),o.jsx("div",{className:"space-y-1",children:ir.map((or,Ft)=>o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:or.color}}),o.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:[or.dataKey==="total"?"Total":or.dataKey==="active"?"Active":"Expired",":",o.jsx("span",{className:"ml-1 font-medium",children:rr?"No Data":or.value.toLocaleString()})]})]},Ft))})]})}return null};return o.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 w-full max-w-4xl mx-auto h-fit shadow-sm dark:!bg-transparent dark:!border-gray-700 min-h-[400px] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:o.jsxs("svg",{className:"w-6 h-6 text-green-500",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[o.jsx("path",{d:"M3 3v18h18"}),o.jsx("path",{d:"M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"}),o.jsx("circle",{cx:"18",cy:"8",r:"2"})]})}),o.jsxs("div",{className:"flex flex-col",children:[o.jsxs("h2",{className:"text-sm font-bold text-foreground",children:["Vehicle Registration Trends",o.jsxs("span",{className:"text-muted-foreground font-normal ml-2",style:{fontSize:"10px"},children:[K==="year"?V?`By Year (${E}-${U})`:"By Year (Last 5 Years)":`By Month (${se||"Select Year"})`,he!=="All"&&o.jsxs("span",{className:"text-primary font-medium",children:[" ",he]})]})]}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Historical registration patterns showing total, active, and expired vehicles"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:we,className:"p-2 bg-primary/10 text-primary hover:bg-primary/20 rounded-md transition-colors",title:"Filter options",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})}),x&&o.jsx("div",{className:"filter-dropdown absolute right-0 top-full mt-2 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50",children:o.jsxs("div",{className:"p-2",children:[o.jsx("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2 px-2",children:"View Type"}),o.jsx("button",{onClick:()=>Be("year"),className:`w-full text-left px-2 py-2 text-sm rounded-md transition-colors ${K==="year"?"bg-blue-500 text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"By Year"}),o.jsx("button",{onClick:()=>Be("month"),className:`w-full text-left px-2 py-2 text-sm rounded-md transition-colors ${K==="month"?"bg-blue-500 text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"By Month"}),o.jsx("div",{className:"border-t border-gray-200 dark:border-gray-600 my-1"}),o.jsx("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2 px-2",children:"Date Range"}),o.jsx("button",{onClick:()=>{w(!1),T(!0)},className:"w-full text-left px-2 py-2 text-sm rounded-md transition-colors text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Custom Range"})]})})]}),o.jsx("button",{onClick:()=>me(!0),className:"p-2 bg-primary/10 text-primary hover:bg-primary/20 rounded-md transition-colors",title:"Location options",children:o.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),o.jsxs("div",{className:"h-80 w-full min-h-[320px] flex-1",children:[a?o.jsx("div",{className:"flex items-center justify-center w-full h-full",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):h?o.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:o.jsx("p",{children:h})}):e.length===0?o.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:o.jsx("p",{children:"No data available"})}):o.jsx(uo,{width:"100%",height:"100%",minHeight:320,children:o.jsxs(RD,{data:e,margin:{top:10,right:20,left:0,bottom:20},children:[o.jsxs("defs",{children:[o.jsxs("linearGradient",{id:"totalGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[o.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:.8}),o.jsx("stop",{offset:"20%",stopColor:"#3b82f6",stopOpacity:.6}),o.jsx("stop",{offset:"40%",stopColor:"#3b82f6",stopOpacity:.4}),o.jsx("stop",{offset:"60%",stopColor:"#3b82f6",stopOpacity:.2}),o.jsx("stop",{offset:"80%",stopColor:"#3b82f6",stopOpacity:.1}),o.jsx("stop",{offset:"100%",stopColor:"#3b82f6",stopOpacity:0})]}),o.jsxs("linearGradient",{id:"activeGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[o.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:.8}),o.jsx("stop",{offset:"20%",stopColor:"#10b981",stopOpacity:.6}),o.jsx("stop",{offset:"40%",stopColor:"#10b981",stopOpacity:.4}),o.jsx("stop",{offset:"60%",stopColor:"#10b981",stopOpacity:.2}),o.jsx("stop",{offset:"80%",stopColor:"#10b981",stopOpacity:.1}),o.jsx("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:0})]}),o.jsxs("linearGradient",{id:"expiredGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[o.jsx("stop",{offset:"0%",stopColor:"#ef4444",stopOpacity:.8}),o.jsx("stop",{offset:"20%",stopColor:"#ef4444",stopOpacity:.6}),o.jsx("stop",{offset:"40%",stopColor:"#ef4444",stopOpacity:.4}),o.jsx("stop",{offset:"60%",stopColor:"#ef4444",stopOpacity:.2}),o.jsx("stop",{offset:"80%",stopColor:"#ef4444",stopOpacity:.1}),o.jsx("stop",{offset:"100%",stopColor:"#ef4444",stopOpacity:0})]})]}),o.jsx(ms,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),o.jsx(ga,{dataKey:K==="year"?"year":"month",stroke:"#6b7280",fontSize:r?10:12,tick:{fill:"#6b7280",fontWeight:500},angle:r?-45:0,textAnchor:r?"end":"middle",height:r?60:30,tickFormatter:nt=>(console.log("X-axis tick value:",nt,"viewType:",K),nt)}),o.jsx(ya,{stroke:"#6b7280",fontSize:r?10:12,tickFormatter:nt=>nt.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:r?60:80}),o.jsx(zi,{content:o.jsx(tt,{})}),o.jsx(Sc,{type:"monotone",dataKey:"total",stroke:"#3b82f6",strokeWidth:3,fill:"url(#totalGradient)",fillOpacity:1,connectNulls:!0,dot:{fill:"white",stroke:"#3b82f6",strokeWidth:2,r:5,filter:"drop-shadow(0 1px 2px rgba(59, 130, 246, 0.3))"},activeDot:{r:7,fill:"white",stroke:"#3b82f6",strokeWidth:2,filter:"drop-shadow(0 2px 4px rgba(59, 130, 246, 0.4))"},name:"Total Vehicles"}),o.jsx(Sc,{type:"monotone",dataKey:"active",stroke:"#10b981",strokeWidth:3,fill:"url(#activeGradient)",fillOpacity:1,connectNulls:!0,dot:{fill:"white",stroke:"#10b981",strokeWidth:2,r:5,filter:"drop-shadow(0 1px 2px rgba(16, 185, 129, 0.3))"},activeDot:{r:7,fill:"white",stroke:"#10b981",strokeWidth:2,filter:"drop-shadow(0 2px 4px rgba(16, 185, 129, 0.4))"},name:"Active Vehicles"}),o.jsx(Sc,{type:"monotone",dataKey:"expired",stroke:"#ef4444",strokeWidth:3,fill:"url(#expiredGradient)",fillOpacity:1,connectNulls:!0,dot:{fill:"white",stroke:"#ef4444",strokeWidth:2,r:5,filter:"drop-shadow(0 1px 2px rgba(239, 68, 68, 0.3))"},activeDot:{r:7,fill:"white",stroke:"#ef4444",strokeWidth:2,filter:"drop-shadow(0 2px 4px rgba(239, 68, 68, 0.4))"},name:"Expired Vehicles"}),o.jsx(Sc,{type:"monotone",dataKey:"noRegistration",stroke:"#9ca3af",strokeWidth:2,strokeDasharray:"3 3",fill:"none",connectNulls:!0,dot:{fill:"#9ca3af",strokeWidth:1,r:3,filter:"drop-shadow(0 1px 2px rgba(156, 163, 175, 0.3))"},activeDot:{r:5,stroke:"#9ca3af",strokeWidth:1,filter:"drop-shadow(0 2px 4px rgba(156, 163, 175, 0.4))"},name:"No Registration",hide:!0})]})}),e.length>0&&o.jsxs("div",{className:"flex flex-wrap justify-center gap-4 text-gray-600 dark:text-gray-400",style:{fontSize:r?"10px":"12px",fontWeight:"500",paddingTop:"0px",textAlign:"center"},children:[e.some(nt=>nt.total!==null)&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),o.jsx("span",{children:"Total Vehicles"})]}),e.some(nt=>nt.active!==null)&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),o.jsx("span",{children:"Active Vehicles"})]}),e.some(nt=>nt.expired!==null)&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),o.jsx("span",{children:"Expired Vehicles"})]})]})]}),S&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-6 w-full max-w-md shadow-2xl",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:o.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})}),o.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Filter Date Range"})]}),o.jsx("button",{onClick:()=>T(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Start Year"}),o.jsx("input",{type:"number",value:E,onChange:nt=>D(nt.target.value),placeholder:"e.g., 2020",min:"2000",max:be,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"End Year"}),o.jsx("input",{type:"number",value:U,onChange:nt=>I(nt.target.value),placeholder:"e.g., 2025",min:"2000",max:be,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"})]})]}),h&&o.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:o.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:h})}),o.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[o.jsx("button",{onClick:Pe,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-md transition-colors",children:"Apply Filter"}),o.jsx("button",{onClick:Me,className:"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:"Reset"})]}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center pt-2",children:"Default range: Last 5 years (2021 - 2025)"})]})]})}),ae&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-6 w-full max-w-md shadow-2xl",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:o.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),o.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Select Year for Monthly View"})]}),o.jsx("button",{onClick:()=>ee(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Enter a year to view monthly vehicle registration trends:"}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Year"}),o.jsx("input",{type:"number",value:se,onChange:nt=>ue(nt.target.value),placeholder:"e.g., 2025",min:"2000",max:be,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",onKeyPress:nt=>{if(nt.key==="Enter"){const Dt=parseInt(se);Dt>=2e3&&Dt<=be&&Ge(Dt)}}})]}),h&&o.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:o.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:h})}),o.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[o.jsx("button",{onClick:()=>{const nt=parseInt(se);nt>=2e3&&nt<=be?Ge(nt):i(`Please enter a valid year between 2000 and ${be}`)},className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-md transition-colors",children:"Apply"}),o.jsx("button",{onClick:()=>ee(!1),className:"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:"Cancel"})]}),o.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center pt-2",children:["Available years: 2000 - ",be]})]})]})}),Ne&&o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:o.jsxs("div",{className:"bg-gradient-to-br from-white via-gray-50 to-white border border-gray-200/50 rounded-2xl p-8 w-full max-w-[600px] shadow-2xl dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 dark:border-gray-700/50 animate-in zoom-in-95 duration-300",children:[o.jsxs("div",{className:"flex items-center justify-between mb-8",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-gradient-to-br from-primary/20 to-primary/10 rounded-xl",children:o.jsxs("svg",{className:"w-7 h-7 text-primary",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[o.jsx("path",{d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),o.jsx("path",{d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Select Municipality"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Filter data by location"})]})]}),o.jsx("button",{onClick:()=>me(!1),className:"p-2.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-all duration-200 group",children:o.jsx("svg",{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-gray-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl p-4 border border-blue-200/50 dark:border-blue-700/50",children:o.jsx("p",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:" Choose a municipality to view its specific vehicle registration trends"})}),o.jsx("div",{className:"grid grid-cols-1 gap-3 max-h-80 overflow-y-auto scrollbar-hide",children:pe.map((nt,Dt)=>o.jsxs("button",{onClick:()=>We(nt),className:`group relative p-4 text-left rounded-xl transition-all duration-300 border-2 ${he===nt?"bg-gradient-to-r from-primary to-primary/80 text-white border-primary shadow-lg shadow-primary/25 transform scale-[1.02]":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-600 hover:border-primary/50 hover:bg-primary/5 dark:hover:bg-primary/10 hover:shadow-md hover:transform hover:scale-[1.01]"}`,style:{animationDelay:`${Dt*50}ms`},children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${he===nt?"bg-white":"bg-primary/60 group-hover:bg-primary"}`}),o.jsx("span",{className:"font-medium",children:nt})]}),he===nt&&o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]}),nt==="All"&&o.jsx("p",{className:"text-xs opacity-75 mt-1",children:"View all municipalities combined"})]},nt))}),o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"}),o.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Currently selected:"}),o.jsx("span",{className:"text-sm font-semibold text-primary",children:he})]})})]})]})})]})},WUe=({selectedMonth:e,selectedYear:t,loading:r})=>{const[n,a]=G.useState([]),[c,h]=G.useState(!1),[i,x]=G.useState(null),[w,S]=G.useState(!1),[T,E]=G.useState(!1);G.useEffect(()=>{const V=()=>{E(window.innerWidth<640)};return V(),window.addEventListener("resize",V),()=>window.removeEventListener("resize",V)},[]);const D=async()=>{try{h(!0),x(null);let V=null,H=null;e&&e!=="All"&&(V=Uj(e)),t&&t!=="All"&&(H=t);const K=await VUe(V,H);K.success?a(K.data):(x("Failed to fetch owner municipality data"),a([]))}catch(V){console.error("Error fetching owner municipality data:",V),x("Error loading owner municipality data")}finally{h(!1)}};G.useEffect(()=>{D(),S(!1)},[]),G.useEffect(()=>{D(),S(!1)},[e,t]),G.useEffect(()=>{if(n.length>0){const V=setTimeout(()=>S(!0),100);return()=>clearTimeout(V)}},[n]);const U=V=>V.map(H=>({name:H.municipality,withLicense:H.withLicense,withoutLicense:H.withoutLicense,total:H.totalOwners})),I=({active:V,payload:H,label:K})=>{var Q,ae;if(V&&H&&H.length){const ee=((Q=H.find(he=>he.dataKey==="withLicense"))==null?void 0:Q.value)||0,se=((ae=H.find(he=>he.dataKey==="withoutLicense"))==null?void 0:ae.value)||0,ue=ee+se;return o.jsx("div",{className:"bg-gray-100/90 dark:bg-gray-700/90 border border-gray-400/40 dark:border-gray-500/40 rounded-xl p-4 shadow-2xl backdrop-blur-sm",children:o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:K}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#22c55e"}}),o.jsxs("span",{className:"text-green-600 dark:text-green-400 text-xs",children:[o.jsx("span",{className:"font-semibold",children:ee.toLocaleString()})," With License"]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#3b82f6"}}),o.jsxs("span",{className:"text-blue-600 dark:text-blue-400 text-xs",children:[o.jsx("span",{className:"font-semibold",children:se.toLocaleString()})," Without License"]})]}),o.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 pt-1",children:o.jsxs("span",{className:"text-gray-700 dark:text-gray-300 text-xs font-semibold",children:["Total: ",ue.toLocaleString()]})})]})]})})}return null};return o.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 w-full max-w-4xl mx-auto h-fit shadow-sm dark:!bg-transparent dark:!border-gray-700 min-h-[400px] flex flex-col",children:[o.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-2 gap-2",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:o.jsxs("svg",{className:"w-6 h-6 text-purple-500",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[o.jsx("path",{d:"M3 3v18h18"}),o.jsx("path",{d:"M8 9v8"}),o.jsx("path",{d:"M8 12v6"}),o.jsx("path",{d:"M8 15v4"}),o.jsx("path",{d:"M12 9v4"}),o.jsx("path",{d:"M12 12v2"}),o.jsx("path",{d:"M12 15v1"})]})}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[o.jsxs("div",{className:"flex flex-col",children:[o.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Registered Owners by Municipality"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Vehicle owners with and without driver's licenses by location"})]}),t==="All"&&e&&e!=="All"&&o.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&o.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(All months in ",t,")"]})]})]})}),o.jsxs("div",{className:"h-80 w-full min-h-[320px] flex-1",children:[c||r?o.jsx("div",{className:"flex items-center justify-center w-full h-full",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i?o.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:o.jsx("p",{children:i})}):n.length===0?o.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:o.jsx("p",{children:"No data available"})}):o.jsx(uo,{width:"100%",height:"100%",minHeight:300,children:o.jsxs(Xc,{data:U(n),margin:{top:0,right:T?5:10,left:T?5:10,bottom:T?40:30},barCategoryGap:"3%",children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),o.jsx(ga,{dataKey:"name",stroke:"#6b7280",fontSize:T?7:9,height:T?35:25,interval:0,angle:-45,textAnchor:"end",tick:{fill:"#6b7280",fontWeight:500},tickFormatter:V=>V.length>10?V.substring(0,10)+"...":V}),o.jsx(ya,{stroke:"#6b7280",fontSize:T?10:12,tickFormatter:V=>V.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:T?50:70}),o.jsx(zi,{content:o.jsx(I,{})}),o.jsx(rs,{dataKey:"withLicense",stackId:"owners",name:"With Driver's License",fill:"#22c55e",radius:[0,0,0,0],maxBarSize:T?150:200}),o.jsx(rs,{dataKey:"withoutLicense",stackId:"owners",name:"Without Driver's License",fill:"#3b82f6",radius:[4,4,0,0],maxBarSize:T?150:200})]})}),n.length>0&&o.jsxs("div",{className:"flex justify-center gap-6 mt-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#22c55e"}}),o.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"With Driver's License"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#3b82f6"}}),o.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Without Driver's License"})]})]})]})]})},HUe=({selectedMonth:e,selectedYear:t,loading:r})=>{const[n,a]=G.useState([]),[c,h]=G.useState(!1),[i,x]=G.useState(null),[w,S]=G.useState(!1),[T,E]=G.useState(!1);G.useEffect(()=>{const K=()=>{E(window.innerWidth<640)};return K(),window.addEventListener("resize",K),()=>window.removeEventListener("resize",K)},[]);const D=async()=>{try{h(!0),x(null);let K=null,Q=null;e&&e!=="All"&&(K=Uj(e)),t&&t!=="All"&&(Q=t);const ae=await UUe(K,Q);if(ae.success&&ae.data){console.log("Raw classification data:",ae.data);const ee=ae.data.filter(se=>se.classification&&se.classification.toUpperCase()==="FOR HRE");ee.length>0?console.warn("Found FOR HRE entries in data:",ee):console.log("No FOR HRE entries found in data - filtering working correctly")}ae.success?a(ae.data):(x("Failed to fetch vehicle classification data"),a([]))}catch(K){console.error("Error fetching vehicle classification data:",K),x("Error loading vehicle classification data")}finally{h(!1)}};G.useEffect(()=>{D(),S(!1)},[]),G.useEffect(()=>{D(),S(!1)},[e,t]),G.useEffect(()=>{if(n.length>0){const K=setTimeout(()=>S(!0),100);return()=>clearTimeout(K)}},[n]);const U=K=>{console.log("formatChartData - Input data:",K);const Q={};K.forEach(se=>{if(console.log("Processing item:",se),se.classification&&se.classification.toUpperCase()==="FOR HRE"||!["PRIVATE","FOR HIRE","GOVERNMENT"].includes(se.classification.toUpperCase()))return;const he=se.classification.toUpperCase();he in Q?Q[he].count+=se.count:Q[he]={classification:he,count:se.count}});const ae=Object.values(Q).reduce((se,ue)=>se+ue.count,0),ee=Object.values(Q).map(se=>({name:se.classification,value:se.count,percentage:ae>0?Math.round(se.count/ae*100):0}));return console.log("formatChartData - Final result:",ee),ee},I=K=>{switch(K){case"PRIVATE":return"#3b82f6";case"FOR HIRE":return"#ef4444";case"GOVERNMENT":return"#10b981";default:return"#6b7280"}},V=({active:K,payload:Q})=>{if(K&&Q&&Q.length){const ae=Q[0];return o.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg p-3 shadow-lg",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:ae.color}}),o.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm",children:ae.name})]}),o.jsxs("div",{className:"mt-1 text-xs text-gray-600 dark:text-gray-400",children:[ae.value.toLocaleString()," vehicles (",ae.payload.percentage,"%)"]})]})}return null},H=({payload:K})=>o.jsx("div",{className:"flex flex-col gap-4",children:K.map((Q,ae)=>{var ee;return o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-4 h-4 rounded-full shadow-sm",style:{backgroundColor:Q.color,border:`2px solid ${Q.color}20`}}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:Q.value}),o.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[((ee=Q.payload)==null?void 0:ee.percentage)||0,"%"]})]})]},ae)})});return o.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 w-full max-w-2xl mx-auto h-fit shadow-sm dark:!bg-transparent dark:!border-gray-700 min-h-[400px] flex flex-col",children:[o.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-2 gap-2",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:o.jsxs("svg",{className:"w-6 h-6 text-blue-500",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[o.jsx("path",{d:"M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2z"}),o.jsx("path",{d:"M12 2v10l8 8"})]})}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[o.jsxs("div",{className:"flex flex-col",children:[o.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Vehicle Classification"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Distribution of vehicles by type (Private, For Hire, Government)"})]}),t==="All"&&e&&e!=="All"&&o.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&o.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(All months in ",t,")"]})]})]})}),o.jsx("div",{className:"h-80 w-full min-h-[320px] flex-1 relative flex flex-col",children:c||r?o.jsx("div",{className:"flex items-center justify-center w-full h-full",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i?o.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:o.jsx("p",{children:i})}):n.length===0?o.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:o.jsx("p",{children:"No data available"})}):o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsxs("div",{className:"flex items-center gap-6",children:[o.jsx("div",{className:"flex-shrink-0 animate-fade-in",children:o.jsx(uo,{width:T?200:280,height:T?200:280,children:o.jsxs(Xte,{children:[o.jsx(vp,{data:U(n),cx:"50%",cy:"50%",labelLine:!1,outerRadius:T?80:100,innerRadius:T?20:40,fill:"#8884d8",dataKey:"value",animationBegin:0,animationDuration:1800,animationEasing:"ease-out",stroke:"#ffffff",strokeWidth:2,startAngle:90,endAngle:450,children:U(n).map((K,Q)=>o.jsx(Jh,{fill:I(K.name),stroke:"#ffffff",strokeWidth:2,style:{filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.15))",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",transformOrigin:"center"},onMouseEnter:ae=>{ae.target.style.filter="drop-shadow(0 4px 8px rgba(0, 0, 0, 0.25)) brightness(1.05)",ae.target.style.transform="scale(1.02)"},onMouseLeave:ae=>{ae.target.style.filter="drop-shadow(0 2px 4px rgba(0, 0, 0, 0.15))",ae.target.style.transform="scale(1)"}},`cell-${K.name}`))}),o.jsx(zi,{content:o.jsx(V,{}),position:{x:0,y:0},offset:20})]})})}),o.jsx("div",{className:"flex-shrink-0 animate-slide-in-right",children:o.jsx(H,{payload:U(n).map(K=>({value:K.name,color:I(K.name),payload:{percentage:K.percentage}}))})})]})})})]})},Vg={"CITY OF MATI":{Jan:1200,Feb:1180,Mar:1300,Apr:1250,May:1400,Jun:1500,Jul:1480,Aug:1420,Sep:1350,Oct:1380,Nov:1400,Dec:1520},MANAY:{Jan:800,Feb:780,Mar:900,Apr:860,May:920,Jun:980,Jul:950,Aug:920,Sep:880,Oct:900,Nov:910,Dec:1e3},BAGANGA:{Jan:650,Feb:680,Mar:720,Apr:700,May:750,Jun:780,Jul:760,Aug:740,Sep:720,Oct:730,Nov:740,Dec:800},BANAYBANAY:{Jan:450,Feb:460,Mar:480,Apr:470,May:500,Jun:520,Jul:510,Aug:490,Sep:480,Oct:485,Nov:490,Dec:530},BOSTON:{Jan:320,Feb:330,Mar:350,Apr:340,May:360,Jun:370,Jul:365,Aug:355,Sep:350,Oct:352,Nov:355,Dec:380},CARAGA:{Jan:280,Feb:290,Mar:310,Apr:300,May:320,Jun:330,Jul:325,Aug:315,Sep:310,Oct:312,Nov:315,Dec:340},CATEEL:{Jan:380,Feb:390,Mar:410,Apr:400,May:420,Jun:430,Jul:425,Aug:415,Sep:410,Oct:412,Nov:415,Dec:440},"GOVERNOR GENEROSO":{Jan:520,Feb:530,Mar:550,Apr:540,May:570,Jun:580,Jul:575,Aug:565,Sep:560,Oct:562,Nov:565,Dec:590},LUPON:{Jan:680,Feb:690,Mar:720,Apr:700,May:740,Jun:760,Jul:750,Aug:730,Sep:720,Oct:725,Nov:730,Dec:780},"SAN ISIDRO":{Jan:420,Feb:430,Mar:450,Apr:440,May:460,Jun:470,Jul:465,Aug:455,Sep:450,Oct:452,Nov:455,Dec:480},TARRAGONA:{Jan:350,Feb:360,Mar:380,Apr:370,May:390,Jun:400,Jul:395,Aug:385,Sep:380,Oct:382,Nov:385,Dec:410}},av=Object.keys(Vg).reduce((e,t)=>{const r=Vg[t],n=Object.values(r).reduce((a,c)=>a+c,0);return e[t]=n,e},{});function KUe(){const[e,t]=G.useState("monthly"),[r,n]=G.useState(!1),a=G.useRef(null),h=new Date().getFullYear()+1;G.useEffect(()=>{const U=I=>{a.current&&!a.current.contains(I.target)&&n(!1)};return document.addEventListener("mousedown",U),()=>{document.removeEventListener("mousedown",U)}},[]);const x=(()=>{const U=Object.values(av).reduce((ae,ee)=>ae+ee,0),I=Object.entries(av).reduce((ae,[ee,se])=>se>ae.total?{municipality:ee,total:se}:ae,{municipality:"",total:0});let V=0,H="",K="";return Object.entries(Vg).forEach(([ae,ee])=>{Object.entries(ee).forEach(([se,ue])=>{ue>V&&(V=ue,H=ae,K=se)})}),{totalPredicted:U,topMunicipalityYear:I,peakMunicipality:H,peakMonth:K,peakValue:V,fastestGrowth:12.5}})(),S=e==="monthly"?["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(V=>{const H={month:V};return Object.entries(Vg).forEach(([K,Q])=>{H[K]=Q[V]}),H}):Object.entries(av).map(([U,I])=>({municipality:U,total:I})),T=["#4E79A7","#F28E2B","#E15759","#76B7B2","#59A14F","#EDC948","#B07AA1","#FF9DA7","#9C755F","#BAB0AC","#4E79A7"],E=({active:U,payload:I,label:V})=>{if(U&&I&&I.length){const H=[...I].sort((K,Q)=>(Q.value||0)-(K.value||0));return o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 border border-blue-200 dark:border-blue-700 rounded-lg shadow-lg max-w-xs",children:[o.jsx("p",{className:"text-sm font-bold text-blue-800 dark:text-blue-300 mb-2 text-center",children:e==="monthly"?`${V}`:`${V}`}),o.jsx("div",{className:"space-y-1",children:H.map((K,Q)=>{var ae;return o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[o.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:K.color}}),o.jsx("span",{className:"text-xs text-gray-700 dark:text-gray-300 truncate",title:K.dataKey,children:K.dataKey})]}),o.jsx("span",{className:"text-xs font-medium flex-shrink-0 ml-2",style:{color:K.color},children:((ae=K.value)==null?void 0:ae.toLocaleString())||0})]},Q)})})]})}return null},D=U=>{let I="",V="",H="";e==="monthly"?U==="csv"?(I=`Municipality,Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec
`,Object.entries(Vg).forEach(([ee,se])=>{const ue=[ee,...Object.values(se)].join(",");I+=ue+`
`}),V=`predictive_analytics_monthly_${new Date().toISOString().split("T")[0]}.csv`,H="text/csv"):U==="json"?(I=JSON.stringify(Vg,null,2),V=`predictive_analytics_monthly_${new Date().toISOString().split("T")[0]}.json`,H="application/json"):U==="excel"&&(I=`Municipality,Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec
`,Object.entries(Vg).forEach(([ee,se])=>{const ue=[ee,...Object.values(se)].join(",");I+=ue+`
`}),V=`predictive_analytics_monthly_${new Date().toISOString().split("T")[0]}.xlsx`,H="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"):U==="csv"?(I=`Municipality,Total
`,Object.entries(av).forEach(([ee,se])=>{I+=`${ee},${se}
`}),V=`predictive_analytics_yearly_${new Date().toISOString().split("T")[0]}.csv`,H="text/csv"):U==="json"?(I=JSON.stringify(av,null,2),V=`predictive_analytics_yearly_${new Date().toISOString().split("T")[0]}.json`,H="application/json"):U==="excel"&&(I=`Municipality,Total
`,Object.entries(av).forEach(([ee,se])=>{I+=`${ee},${se}
`}),V=`predictive_analytics_yearly_${new Date().toISOString().split("T")[0]}.xlsx`,H="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");const K=new Blob([I],{type:H}),Q=window.URL.createObjectURL(K),ae=document.createElement("a");ae.href=Q,ae.download=V,document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),window.URL.revokeObjectURL(Q),n(!1)};return o.jsxs("div",{className:"mt-8 bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-blue-900/20 dark:to-indigo-900/30 border border-blue-200 dark:border-blue-800 rounded-xl shadow-lg",children:[o.jsx("div",{className:"p-6 border-b border-blue-200/50 dark:border-blue-700/50",children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:o.jsx("svg",{className:"w-6 h-6 text-blue-500 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Predictive Analytics"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Uses the SARIMA algorithm to forecast future trends based on historical and current data, providing insights on risks, traffic patterns, and vehicle registrations."}),o.jsxs("div",{className:"mt-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-300",children:["Predicting ",h," (Based on the last data available)"]})]})]})})}),o.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 h-full",children:[o.jsx("div",{className:"xl:col-span-2 p-2 sm:p-4",children:o.jsx("div",{className:"space-y-4 sm:space-y-6",children:o.jsxs("div",{className:"relative bg-gradient-to-br from-green-50/80 via-blue-50/60 to-orange-50/40 dark:from-green-900/20 dark:via-blue-900/20 dark:to-orange-900/20 backdrop-blur-sm rounded-xl p-3 sm:p-6 border border-green-200/30 dark:border-green-700/30 shadow-lg overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 opacity-5",children:o.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 400 300",fill:"none",children:[o.jsx("path",{d:"M0,200 L50,150 L100,180 L150,120 L200,160 L250,100 L300,140 L350,80 L400,120 L400,300 L0,300 Z",fill:"#2E7D32"}),o.jsx("path",{d:"M0,250 Q100,220 200,250 T400,250 L400,300 L0,300 Z",fill:"#1565C0"}),o.jsx("circle",{cx:"80",cy:"80",r:"15",fill:"#81C784"}),o.jsx("circle",{cx:"320",cy:"60",r:"12",fill:"#FBC02D"}),o.jsx("circle",{cx:"150",cy:"200",r:"10",fill:"#F57C00"})]})}),o.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[o.jsx("h4",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white",children:e==="monthly"?"Monthly Trends":"Yearly Totals"}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",style:{pointerEvents:"auto"},children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 hidden sm:inline",children:"View:"}),o.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-600 rounded-md p-0.5",children:[o.jsx("button",{onClick:U=>{U.preventDefault(),U.stopPropagation(),console.log("Monthly button clicked"),t("monthly")},className:`px-2 sm:px-3 py-1.5 text-xs rounded transition-all duration-200 cursor-pointer select-none z-10 relative touch-manipulation ${e==="monthly"?"bg-white dark:bg-gray-500 text-gray-900 dark:text-white shadow-sm font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-500"}`,type:"button",style:{pointerEvents:"auto"},children:"Monthly"}),o.jsx("button",{onClick:U=>{U.preventDefault(),U.stopPropagation(),console.log("Yearly button clicked"),t("yearly")},className:`px-2 sm:px-3 py-1.5 text-xs rounded transition-all duration-200 cursor-pointer select-none z-10 relative touch-manipulation ${e==="yearly"?"bg-white dark:bg-gray-500 text-gray-900 dark:text-white shadow-sm font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-500"}`,type:"button",style:{pointerEvents:"auto"},children:"Yearly"})]})]}),o.jsx("div",{className:"flex items-center gap-2 ml-auto relative",children:o.jsxs("div",{className:"relative",ref:a,children:[o.jsxs("button",{onClick:()=>n(!r),className:"px-2 sm:px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium rounded-md transition-colors duration-200 flex items-center gap-1 touch-manipulation",children:[o.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),o.jsx("span",{className:"hidden sm:inline",children:"Export"}),o.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&o.jsx("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-50",children:o.jsxs("div",{className:"py-1",children:[o.jsxs("button",{onClick:()=>D("csv"),className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export as CSV"]}),o.jsxs("button",{onClick:()=>D("json"),className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Export as JSON"]}),o.jsxs("button",{onClick:()=>D("excel"),className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export as Excel"]})]})})]})})]})]}),o.jsx("div",{className:"h-64 sm:h-80 lg:h-96",children:o.jsx(uo,{width:"100%",height:"100%",children:e==="monthly"?o.jsxs(Fw,{data:S,margin:{top:20,right:30,left:20,bottom:20},"aria-label":"Monthly registration trends chart",children:[o.jsx(ms,{strokeDasharray:"2 4",stroke:"#4E79A7",strokeOpacity:.2,vertical:!1}),o.jsx(ga,{dataKey:"month",stroke:"#4E79A7",fontSize:10,fontWeight:"500",tick:{fill:"#4E79A7"}}),o.jsx(ya,{stroke:"#4E79A7",fontSize:10,fontWeight:"500",tick:{fill:"#4E79A7"},tickFormatter:U=>U.toLocaleString()}),o.jsx(zi,{content:o.jsx(E,{}),cursor:{stroke:"#76B7B2",strokeWidth:1,strokeDasharray:"3 3"}}),o.jsx(Fu,{wrapperStyle:{fontSize:"11px",fontWeight:"500",color:"#4E79A7",paddingTop:"10px"},onClick:U=>{console.log("Legend clicked:",U)}}),Object.keys(Vg).map((U,I)=>o.jsx(Ud,{type:"monotone",dataKey:U,stroke:T[I%T.length],strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",dot:{r:5,fill:T[I%T.length],stroke:"#fff",strokeWidth:2},activeDot:{r:8,fill:T[I%T.length],stroke:"#fff",strokeWidth:3,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},name:U,connectNulls:!1},U))]}):o.jsxs(Xc,{data:S,margin:{top:20,right:20,left:20,bottom:10},"aria-label":"Yearly registration totals chart",children:[o.jsx(ms,{strokeDasharray:"2 4",stroke:"#4E79A7",strokeOpacity:.2,vertical:!1}),o.jsx(ga,{dataKey:"municipality",stroke:"#4E79A7",fontSize:10,fontWeight:"500",angle:-45,textAnchor:"end",height:120,interval:0,tick:{fontSize:9,fill:"#4E79A7",textAnchor:"end"},tickFormatter:U=>U==="GOVERNOR GENEROSO"?["GOVERNOR","GENEROSO"]:U==="CITY OF MATI"?["CITY OF","MATI"]:U}),o.jsx(ya,{stroke:"#4E79A7",fontSize:13,fontWeight:"500",tick:{fill:"#4E79A7"},tickFormatter:U=>U.toLocaleString()}),o.jsx(zi,{content:o.jsx(E,{}),cursor:{fill:"#76B7B2",fillOpacity:.1}}),o.jsx(Fu,{wrapperStyle:{fontSize:"11px",fontWeight:"500",color:"#4E79A7",paddingTop:"10px"}}),o.jsx(rs,{dataKey:"total",fill:"url(#pastelGradient)",name:"Total Registrations",radius:[6,6,0,0],stroke:"#4E79A7",strokeWidth:1}),o.jsx("defs",{children:o.jsxs("linearGradient",{id:"pastelGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"0%",stopColor:"#76B7B2"}),o.jsx("stop",{offset:"50%",stopColor:"#4E79A7"}),o.jsx("stop",{offset:"100%",stopColor:"#B07AA1"})]})})]})})})]})})}),o.jsx("div",{className:"xl:col-span-1 p-2 sm:p-4",children:o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-1 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-blue-100 dark:bg-blue-900/50 rounded-lg flex items-center justify-center",children:o.jsx("svg",{className:"w-3 h-3 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),o.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Total Predicted"})]}),o.jsx("div",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-white",children:x.totalPredicted.toLocaleString()}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Across Davao Oriental"})]}),o.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("div",{className:"w-6 h-6 bg-green-100 dark:bg-green-900/50 rounded-lg flex items-center justify-center",children:o.jsx("svg",{className:"w-3 h-3 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),o.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Top Municipality"})]}),o.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white truncate w-full",children:x.topMunicipalityYear.municipality}),o.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[x.topMunicipalityYear.total.toLocaleString()," registrations"]})]}),o.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("div",{className:"w-6 h-6 bg-purple-100 dark:bg-purple-900/50 rounded-lg flex items-center justify-center",children:o.jsx("svg",{className:"w-3 h-3 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),o.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Peak Month"})]}),o.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white truncate w-full",children:x.peakMunicipality}),o.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[x.peakMonth,": ",x.peakValue.toLocaleString()]})]}),o.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("div",{className:"w-6 h-6 bg-orange-100 dark:bg-orange-900/50 rounded-lg flex items-center justify-center",children:o.jsx("svg",{className:"w-3 h-3 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),o.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Growth Rate"})]}),o.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["+",x.fastestGrowth,"%"]}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Year over Year"})]})]})})]})]})}const cm=(e,t=2e3)=>{const[r,n]=G.useState(0);return G.useEffect(()=>{let a;const h=i=>{a||(a=i);const x=Math.min((i-a)/t,1),w=1-Math.pow(1-x,4),S=Math.floor(0+(e-0)*w);n(S),x<1&&requestAnimationFrame(h)};requestAnimationFrame(h)},[e,t]),r};function ZUe(){var Ce,Ne,me,be,pe,Se,Ee,we,Pe,Me,Be,Ge,We,tt,nt,Dt,nr,ir,rr,or,Ft;const[e,t]=G.useState(""),[r,n]=G.useState(""),[a,c]=G.useState(null),[h,i]=G.useState(!1),[x,w]=G.useState(null),S=cm(((Ce=a==null?void 0:a.vehicles)==null?void 0:Ce.total)||0),T=cm(((Ne=a==null?void 0:a.vehicles)==null?void 0:Ne.active)||0),E=cm(((me=a==null?void 0:a.vehicles)==null?void 0:me.expired)||0),D=cm(((be=a==null?void 0:a.drivers)==null?void 0:be.total)||0),U=cm(((pe=a==null?void 0:a.drivers)==null?void 0:pe.withLicense)||0),I=cm(((Se=a==null?void 0:a.drivers)==null?void 0:Se.withoutLicense)||0),V=cm(((Ee=a==null?void 0:a.plateClassification)==null?void 0:Ee.total)||0),H=cm(((we=a==null?void 0:a.plateClassification)==null?void 0:we.permanent)||0),K=cm(((Pe=a==null?void 0:a.plateClassification)==null?void 0:Pe.temporary)||0),Q=["All","January","February","March","April","May","June","July","August","September","October","November","December"],ae=new Date().getFullYear(),ee=["All",...Array.from({length:7},(ze,Pr)=>(ae+Pr).toString())],se=ze=>{t(ze)},ue=ze=>{n(ze)},he=async(ze,Pr)=>{try{i(!0),w(null);let Kt=null,on=null;ze&&ze!=="All"&&(Kt=Uj(ze)),Pr&&Pr!=="All"&&(on=Pr);const Rt=await LUe(Kt,on);Rt.success?c(Rt.data):w("Failed to fetch analytics data")}catch(Kt){console.error("Error fetching analytics data:",Kt),w("Error loading analytics data")}finally{i(!1)}};return G.useEffect(()=>{he("All","All")},[]),G.useEffect(()=>{e||r?he(e,r):he("All","All")},[e,r]),o.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-transparent min-h-screen rounded-lg",children:[o.jsxs("div",{className:"registration-analytics-header",children:[o.jsxs("div",{children:[o.jsxs("h1",{className:"registration-analytics-title animate-in slide-in-from-top-5 fade-in duration-700 flex items-center gap-2",children:[o.jsx(ho,{className:"h-8 w-8 text-blue-500 animate-pulse"}),"Registration Analytics"]}),o.jsx("p",{className:"registration-analytics-subtitle",children:"Vehicle and Owners Registration Analytics"})]}),h?o.jsxs("div",{className:"registration-analytics-controls",children:[o.jsx("div",{className:"animate-pulse",children:o.jsx("div",{className:"h-8 bg-muted rounded w-32"})}),o.jsx("div",{className:"animate-pulse",children:o.jsx("div",{className:"h-8 bg-muted rounded w-32"})})]}):o.jsxs("div",{className:"registration-analytics-controls",children:[o.jsxs(Js,{value:e||"",onValueChange:se,children:[o.jsx(Vs,{className:"w-[140px]",children:o.jsx(yo,{placeholder:"Month"})}),o.jsx(Us,{children:Q.map(ze=>o.jsx(An,{value:ze,children:ze},ze))})]}),o.jsxs(Js,{value:r||"",onValueChange:ue,children:[o.jsx(Vs,{className:"w-[120px]",children:o.jsx(yo,{placeholder:"Year"})}),o.jsx(Us,{children:ee.map(ze=>o.jsx(An,{value:ze,children:ze},ze))})]})]})]}),x&&o.jsx("div",{className:"mb-4 p-4 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:o.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:x})}),h?o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-card border border-border rounded-lg",children:[o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),o.jsx("div",{className:"h-8 bg-muted rounded w-24"})]}),o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),o.jsx("div",{className:"h-8 bg-muted rounded w-24"})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(ze=>o.jsx("div",{className:"bg-card border border-border rounded-xl p-6",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsx("div",{className:"h-4 bg-muted rounded w-32 mb-2"}),o.jsx("div",{className:"h-8 bg-muted rounded w-16 mb-2"}),o.jsx("div",{className:"h-3 bg-muted rounded w-24"})]}),o.jsx("div",{className:"w-12 h-12 bg-muted rounded"})]}),o.jsx("div",{className:"h-1 bg-muted rounded w-full"})]})},ze))}),o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[1,2].map(ze=>o.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded w-48 mb-4"}),o.jsx("div",{className:"h-64 bg-muted rounded"})]})},ze))}),o.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded w-40 mb-4"}),o.jsx("div",{className:"h-96 bg-muted rounded"})]})})]}):o.jsx("div",{className:"registration-analytics-fade-in animate-in slide-in-from-bottom-5 fade-in duration-700",children:o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[o.jsxs("div",{className:"group relative bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:-translate-y-1 transition-all duration-300 dark:!bg-transparent dark:!border-gray-700 hover:border-red-300 dark:hover:border-red-600 overflow-hidden",children:[o.jsx("div",{className:"absolute -top-8 -right-8 w-24 h-24 bg-pink-100 dark:bg-pink-900/30 rounded-full opacity-60"}),o.jsx("div",{className:"absolute -top-4 -right-4 w-16 h-16 bg-red-200 dark:bg-red-800/40 rounded-full opacity-40"}),o.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-red-400/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),o.jsxs("div",{className:"relative z-10 flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),o.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"REGISTERED VEHICLES"})]}),o.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white drop-shadow-sm",children:h?"...":S})]}),o.jsx("div",{className:"w-12 h-12 flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:o.jsxs("svg",{className:"w-6 h-6 text-red-500 group-hover:text-red-600 transition-colors duration-300",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[o.jsx("path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"}),o.jsx("circle",{cx:"7",cy:"17",r:"2"}),o.jsx("path",{d:"M9 17h6"}),o.jsx("circle",{cx:"17",cy:"17",r:"2"})]})})]}),o.jsxs("div",{className:"relative z-10 flex items-center text-xs text-gray-600 dark:text-gray-400 mb-3",children:[o.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[h?"...":T," Active"]}),o.jsx("span",{className:"mx-2",children:""}),o.jsxs("span",{className:"text-red-600 dark:text-red-400 font-medium",children:[h?"...":E," Expired"]})]}),o.jsxs("div",{className:"relative z-10 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 flex overflow-hidden shadow-inner",children:[o.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-0.5 transition-all duration-1000 ease-out shadow-sm animate-pulse",style:{width:`${Math.min((((Me=a==null?void 0:a.vehicles)==null?void 0:Me.active)||0)/(((Be=a==null?void 0:a.vehicles)==null?void 0:Be.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out"}}),o.jsx("div",{className:"bg-gradient-to-r from-red-400 to-red-600 h-0.5 transition-all duration-1000 ease-out shadow-sm animate-pulse",style:{width:`${Math.min((((Ge=a==null?void 0:a.vehicles)==null?void 0:Ge.expired)||0)/(((We=a==null?void 0:a.vehicles)==null?void 0:We.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out 0.3s both"}})]})]}),o.jsxs("div",{className:"group relative bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:-translate-y-1 transition-all duration-300 dark:!bg-transparent dark:!border-gray-700 hover:border-blue-300 dark:hover:border-blue-600 overflow-hidden",children:[o.jsx("div",{className:"absolute -top-8 -right-8 w-24 h-24 bg-blue-100 dark:bg-blue-900/30 rounded-full opacity-60"}),o.jsx("div",{className:"absolute -top-4 -right-4 w-16 h-16 bg-blue-200 dark:bg-blue-800/40 rounded-full opacity-40"}),o.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),o.jsxs("div",{className:"relative z-10 flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),o.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"REGISTERED OWNERS"})]}),o.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white drop-shadow-sm",children:h?"...":D})]}),o.jsx("div",{className:"w-12 h-12 flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:o.jsx("svg",{className:"w-6 h-6 text-blue-500 group-hover:text-blue-600 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]}),o.jsxs("div",{className:"relative z-10 flex items-center text-xs text-gray-600 dark:text-gray-400 mb-3",children:[o.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[h?"...":U," With License"]}),o.jsx("span",{className:"mx-2",children:""}),o.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:[h?"...":I," Without License"]})]}),o.jsxs("div",{className:"relative z-10 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 flex overflow-hidden shadow-inner",children:[o.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((tt=a==null?void 0:a.drivers)==null?void 0:tt.withLicense)||0)/(((nt=a==null?void 0:a.drivers)==null?void 0:nt.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out"}}),o.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-blue-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((Dt=a==null?void 0:a.drivers)==null?void 0:Dt.withoutLicense)||0)/(((nr=a==null?void 0:a.drivers)==null?void 0:nr.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out 0.3s both"}})]})]}),o.jsxs("div",{className:"group relative bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:-translate-y-1 transition-all duration-300 dark:!bg-transparent dark:!border-gray-700 hover:border-purple-300 dark:hover:border-purple-600 overflow-hidden",children:[o.jsx("div",{className:"absolute -top-8 -right-8 w-24 h-24 bg-purple-100 dark:bg-purple-900/30 rounded-full opacity-60"}),o.jsx("div",{className:"absolute -top-4 -right-4 w-16 h-16 bg-purple-200 dark:bg-purple-800/40 rounded-full opacity-40"}),o.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-purple-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),o.jsxs("div",{className:"relative z-10 flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),o.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"PLATE CLASSIFICATION"})]}),o.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white drop-shadow-sm",children:h?"...":V})]}),o.jsx("div",{className:"w-12 h-12 flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:o.jsxs("svg",{className:"w-6 h-6 text-purple-500 group-hover:text-purple-600 transition-colors duration-300",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[o.jsx("rect",{x:"2",y:"6",width:"20",height:"12",rx:"2",ry:"2"}),o.jsx("rect",{x:"4",y:"8",width:"16",height:"8",rx:"1",ry:"1"}),o.jsx("path",{d:"M8 10h2"}),o.jsx("path",{d:"M12 10h2"}),o.jsx("path",{d:"M16 10h2"}),o.jsx("path",{d:"M8 12h2"}),o.jsx("path",{d:"M12 12h2"}),o.jsx("path",{d:"M16 12h2"})]})})]}),o.jsxs("div",{className:"relative z-10 flex items-center text-xs text-gray-600 dark:text-gray-400 mb-3",children:[o.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[h?"...":H," Permanent"]}),o.jsx("span",{className:"mx-2",children:""}),o.jsxs("span",{className:"text-purple-400 dark:text-purple-400 font-medium",children:[h?"...":K," Temporary"]})]}),o.jsxs("div",{className:"relative z-10 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 flex overflow-hidden shadow-inner",children:[o.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((ir=a==null?void 0:a.plateClassification)==null?void 0:ir.permanent)||0)/(((rr=a==null?void 0:a.plateClassification)==null?void 0:rr.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out"}}),o.jsx("div",{className:"bg-gradient-to-r from-purple-400 to-purple-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((or=a==null?void 0:a.plateClassification)==null?void 0:or.temporary)||0)/(((Ft=a==null?void 0:a.plateClassification)==null?void 0:Ft.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out 0.3s both"}})]})]})]}),o.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 mb-6",children:[o.jsx("div",{className:"flex-1 lg:flex-1",children:o.jsx(qUe,{selectedMonth:e,selectedYear:r,loading:h})}),o.jsx("div",{className:"flex-1 lg:flex-1",children:o.jsx(GUe,{})})]}),o.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[o.jsx("div",{className:"flex-1 lg:flex-1",children:o.jsx(HUe,{selectedMonth:e,selectedYear:r,loading:h})}),o.jsx("div",{className:"flex-1 lg:flex-1",children:o.jsx(WUe,{selectedMonth:e,selectedYear:r,loading:h})})]})]})}),o.jsx(KUe,{})]})}function YUe(){return o.jsx("div",{children:o.jsx(ZUe,{})})}const XUe=async()=>{try{return(await mn.get("/violations/count")).data}catch(e){throw console.error("Error fetching violation count:",e),e}},JUe=async(e={},t=null)=>{try{const r=new URLSearchParams;t&&r.append("year",t),e&&typeof e=="object"&&Object.keys(e).forEach(h=>{e[h]!==null&&e[h]!==void 0&&r.append(h,e[h])});const n=r.toString(),a=`/violations/analytics${n?`?${n}`:""}`;return(await mn.get(a)).data}catch(r){throw console.error("Error fetching violation analytics:",r),r}},hN=({value:e,duration:t=2e3,className:r=""})=>{const[n,a]=G.useState(0),[c,h]=G.useState(!1),i=G.useRef(null);return G.useEffect(()=>{const x=new IntersectionObserver(([w])=>{w.isIntersecting&&h(!0)},{threshold:.1});return i.current&&x.observe(i.current),()=>x.disconnect()},[]),G.useEffect(()=>{if(c){let x;const w=S=>{x||(x=S);const T=Math.min((S-x)/t,1),E=1-Math.pow(1-T,4),D=Math.floor(e*E);a(D),T<1?requestAnimationFrame(w):a(e)};requestAnimationFrame(w)}},[e,t,c]),o.jsx("div",{ref:i,className:`${r} transition-all duration-500 ${c?"opacity-100 transform translate-y-0":"opacity-0 transform translate-y-4"}`,children:n.toLocaleString()})},fN=({percentage:e,color:t="bg-blue-500",delay:r=0})=>{const[n,a]=G.useState(0),[c,h]=G.useState(!1),i=G.useRef(null);return G.useEffect(()=>{const x=new IntersectionObserver(([w])=>{w.isIntersecting&&h(!0)},{threshold:.1});return i.current&&x.observe(i.current),()=>x.disconnect()},[]),G.useEffect(()=>{c&&setTimeout(()=>{a(e)},r)},[c,e,r]),o.jsx("div",{ref:i,className:"mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 overflow-hidden",children:o.jsx("div",{className:`h-full ${t} rounded-full shadow-sm transition-all duration-1000 ease-out`,style:{width:`${n}%`}})})};function QUe({displayData:e,loading:t,totalViolations:r,totalTrafficViolators:n,topOfficer:a,mostCommonViolation:c}){const{theme:h}=cZ(),i=h==="dark"||h==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches;return t?o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((x,w)=>o.jsx("div",{className:`${i?"bg-black border-gray-600":"bg-white border-gray-200"} border rounded-xl p-6 animate-pulse`,children:o.jsxs("div",{className:"flex items-center",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:`h-4 ${i?"bg-gray-700":"bg-gray-200"} rounded mb-2`}),o.jsx("div",{className:`h-8 ${i?"bg-gray-700":"bg-gray-200"} rounded mb-1`}),o.jsx("div",{className:`h-3 ${i?"bg-gray-700":"bg-gray-200"} rounded`})]}),o.jsx("div",{className:"ml-4",children:o.jsx("div",{className:`w-12 h-12 ${i?"bg-gray-700":"bg-gray-200"} rounded-full`})})]})},w))}):o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 animate-in slide-in-from-bottom-5 fade-in duration-700",children:[o.jsxs("div",{className:`${i?"bg-black border-gray-600":"bg-white border-gray-200"} border rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-blue-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden group`,children:[o.jsx("div",{className:`absolute top-0 right-0 w-20 h-20 ${i?"bg-gradient-to-br from-blue-500/30 to-blue-600/15":"bg-gradient-to-br from-blue-500/10 to-blue-600/5"} rounded-full -translate-y-4 translate-x-4 group-hover:scale-110 transition-transform duration-300`}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"flex items-center space-x-2 mb-1",children:o.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Total Violations"})}),o.jsx(hN,{value:r,className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",duration:1500}),o.jsx("p",{className:"text-xs font-medium text-blue-600 dark:text-blue-400",children:"All time recorded violations"}),o.jsx(fN,{percentage:100,color:"bg-gradient-to-r from-blue-500 to-blue-600",delay:200})]}),o.jsx("div",{className:"ml-3",children:o.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:o.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})})})]})]}),o.jsxs("div",{className:`${i?"bg-black border-gray-600":"bg-white border-gray-200"} border rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-green-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden group`,children:[o.jsx("div",{className:`absolute top-0 right-0 w-20 h-20 ${i?"bg-gradient-to-br from-green-500/30 to-green-600/15":"bg-gradient-to-br from-green-500/10 to-green-600/5"} rounded-full -translate-y-4 translate-x-4 group-hover:scale-110 transition-transform duration-300`}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"flex items-center space-x-2 mb-1",children:o.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Traffic Violators"})}),o.jsx(hN,{value:n,className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",duration:1800}),o.jsx("p",{className:"text-xs font-medium text-green-600 dark:text-green-400",children:"People"}),o.jsx(fN,{percentage:100,color:"bg-gradient-to-r from-green-500 to-green-600",delay:400})]}),o.jsx("div",{className:"ml-3",children:o.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:o.jsx("svg",{className:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})})]})]}),o.jsxs("div",{className:`${i?"bg-black border-gray-600":"bg-white border-gray-200"} border rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-red-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden group`,children:[o.jsx("div",{className:`absolute top-0 right-0 w-20 h-20 ${i?"bg-gradient-to-br from-red-500/30 to-red-600/15":"bg-gradient-to-br from-red-500/10 to-red-600/5"} rounded-full -translate-y-4 translate-x-4 group-hover:scale-110 transition-transform duration-300`}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"flex items-center space-x-2 mb-1",children:o.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Most Common Violation"})}),o.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white mb-1 truncate",title:(c==null?void 0:c._id)||"N/A",children:(c==null?void 0:c._id)||"N/A"}),o.jsxs("p",{className:"text-xs font-medium text-red-600 dark:text-red-400",children:[o.jsx(hN,{value:(c==null?void 0:c.count)||0,className:"inline",duration:1600})," ","occurrences"]}),o.jsx(fN,{percentage:Math.min(((c==null?void 0:c.count)||0)/(((c==null?void 0:c.count)||0)+((c==null?void 0:c.count)||0)*.7)*100,100),color:"bg-gradient-to-r from-red-500 to-red-600",delay:600})]}),o.jsx("div",{className:"ml-3",children:o.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:o.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})})]})]}),o.jsxs("div",{className:`${i?"bg-black border-gray-600":"bg-white border-gray-200"} border rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-purple-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden group`,children:[o.jsx("div",{className:`absolute top-0 right-0 w-20 h-20 ${i?"bg-gradient-to-br from-purple-500/30 to-purple-600/15":"bg-gradient-to-br from-purple-500/10 to-purple-600/5"} rounded-full -translate-y-4 translate-x-4 group-hover:scale-110 transition-transform duration-300`}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"flex items-center space-x-2 mb-1",children:o.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Top Officer"})}),o.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white truncate mb-1",children:(a==null?void 0:a.officerName)||"N/A"}),o.jsxs("p",{className:"text-xs font-medium text-purple-600 dark:text-purple-400",children:[o.jsx(hN,{value:(a==null?void 0:a.count)||(a==null?void 0:a.violationCount)||0,className:"inline",duration:2e3})," ","apprehensions"]}),o.jsx(fN,{percentage:Math.min(((a==null?void 0:a.count)||(a==null?void 0:a.violationCount)||0)/(((a==null?void 0:a.count)||(a==null?void 0:a.violationCount)||0)+((a==null?void 0:a.count)||(a==null?void 0:a.violationCount)||0)*.8)*100,100),color:"bg-gradient-to-r from-purple-500 to-purple-600",delay:800})]}),o.jsx("div",{className:"ml-3",children:o.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:o.jsx("svg",{className:"w-6 h-6 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})})]})]})]})}function e$e({data:e,title:t,type:r,loading:n,totalCount:a}){const h=!e||e.length===0?[]:e.slice(0,5).map((x,w)=>({name:r==="officers"?x.officerName||"Unknown Officer":x._id||"Unknown Item",value:x.count||x.violationCount||0,rank:w+1})),i=({active:x,payload:w,label:S})=>{if(x&&w&&w.length){const T=w[0].payload;return o.jsx("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg px-4 py-3 shadow-lg min-w-[180px]",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-xs font-bold text-gray-900 dark:text-white mb-1",children:S}),o.jsxs("div",{className:"flex items-center justify-center space-x-1 mb-1",children:[o.jsx("div",{className:"text-sm font-bold text-violet-600 dark:text-violet-400",children:T.value.toLocaleString()}),o.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:r==="officers"?"apprehensions":"violations"})]}),o.jsxs("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:["Rank #",T.rank]})]})})}return null};return n?o.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-black dark:to-black border-2 border-gray-200 dark:border-gray-800 rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300 h-full flex flex-col",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[o.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"h-6 w-48 bg-gray-200 dark:bg-gray-700 rounded"}),o.jsx("div",{className:"h-4 w-32 bg-gray-200 dark:bg-gray-700 rounded"})]})]}),o.jsx("div",{className:"space-y-4",children:[...Array(5)].map((x,w)=>o.jsxs("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-xl",children:[o.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[o.jsx("div",{className:"w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-full"}),o.jsxs("div",{className:"flex-1 space-y-2",children:[o.jsx("div",{className:"h-4 w-32 bg-gray-200 dark:bg-gray-700 rounded"}),o.jsx("div",{className:"h-3 w-24 bg-gray-200 dark:bg-gray-700 rounded"})]}),o.jsx("div",{className:"w-16 h-8 bg-gray-200 dark:bg-gray-700 rounded"})]}),o.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4"})]},w))})]})}):!e||e.length===0?o.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-black dark:to-black border-2 border-gray-200 dark:border-gray-800 rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300 h-full flex flex-col",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[o.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:o.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:t}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Performance Analytics"})]})]}),o.jsxs("div",{className:"text-center py-16 text-gray-500 dark:text-gray-400 flex-1 flex flex-col justify-center",children:[o.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 rounded-full flex items-center justify-center shadow-lg",children:o.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),o.jsx("h4",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"No Data Available"}),o.jsxs("p",{className:"text-sm",children:["No ",r==="officers"?"officer":"violation"," data to display"]})]})]}):o.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-lg shadow-lg p-4 hover:shadow-xl transition-all duration-300 h-full flex flex-col",style:{minHeight:"400px"},children:[o.jsx("div",{className:"flex items-center mb-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-600 to-pink-500 rounded-lg flex items-center justify-center shadow-md",children:o.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:t}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Performance Rankings"})]})]})}),o.jsx("div",{className:"flex-1 flex flex-col",style:{minHeight:"320px"},children:o.jsx(uo,{width:"100%",height:350,children:o.jsxs(Xc,{data:h,margin:{top:20,right:30,left:20,bottom:40},children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),o.jsx(ga,{dataKey:"name",stroke:"#6b7280",fontSize:11,angle:-45,textAnchor:"end",height:80,interval:0}),o.jsx(ya,{stroke:"#6b7280"}),o.jsx(zi,{content:o.jsx(i,{})}),o.jsx(rs,{dataKey:"value",radius:[4,4,0,0],className:"hover:opacity-80 transition-opacity duration-200",children:h.map((x,w)=>o.jsx(Jh,{fill:"url(#violetPinkGradient)"},`cell-${w}`))}),o.jsx("defs",{children:o.jsxs("linearGradient",{id:"violetPinkGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"0%",stopColor:"#8B5CF6"}),o.jsx("stop",{offset:"50%",stopColor:"#A855F7"}),o.jsx("stop",{offset:"100%",stopColor:"#EC4899"})]})})]})})}),h.length<5&&o.jsx("div",{className:"mt-4 text-center",children:o.jsxs("div",{className:"inline-flex items-center space-x-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-full",children:[o.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-pulse"}),o.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:["Only ",h.length," ",r==="officers"?"officers":"items"," available"]})]})})]})}function t$e({data:e,title:t,loading:r}){const[n,a]=G.useState(null),[c,h]=G.useState([]);if(r)return o.jsx("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-800 rounded-lg shadow-md p-6",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded mb-4"}),o.jsx("div",{className:"flex items-center justify-center",children:o.jsx("div",{className:"w-48 h-48 bg-gray-200 dark:bg-gray-700 rounded-full"})}),o.jsx("div",{className:"mt-6 space-y-3",children:[...Array(5)].map((H,K)=>o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-4 h-4 bg-gray-200 dark:bg-gray-700 rounded"}),o.jsx("div",{className:"flex-1 h-4 bg-gray-200 dark:bg-gray-700 rounded"}),o.jsx("div",{className:"w-12 h-4 bg-gray-200 dark:bg-gray-700 rounded"})]},K))})]})});if(!e||e.length===0)return o.jsxs("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-800 rounded-lg shadow-md p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:t}),o.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[o.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:o.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"})})}),o.jsx("p",{children:"No data available"})]})]});const i=e.reduce((H,K)=>H+(K.count||0),0),x=e.slice(0,5);let w=0;const S=x.map((H,K)=>{const Q=H.count||0,ae=i>0?Q/i*100:0,ee=w,se=w+ae/100*360;return w=se,{...H,percentage:ae,startAngle:ee,endAngle:se,index:K}}),T=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"],E=["url(#gradient1)","url(#gradient2)","url(#gradient3)","url(#gradient4)","url(#gradient5)"],D=H=>T[H]||"#6B7280",U=H=>E[H]||T[H]||"#6B7280";G.useEffect(()=>{const H=setTimeout(()=>{h(S)},100);return()=>clearTimeout(H)},[S]);const I=(H,K,Q=80)=>{const se=V(100,100,Q,K),ue=V(100,100,Q,H),he=K-H<=180?"0":"1";return["M",100,100,"L",se.x,se.y,"A",Q,Q,0,he,0,ue.x,ue.y,"Z"].join(" ")},V=(H,K,Q,ae)=>{const ee=(ae-90)*Math.PI/180;return{x:H+Q*Math.cos(ee),y:K+Q*Math.sin(ee)}};return o.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-900 dark:to-black border-2 border-gray-200 dark:border-gray-800 rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300 relative overflow-hidden h-full flex flex-col",style:{minHeight:"400px"},children:o.jsxs("div",{className:"relative z-10",children:[o.jsxs("h3",{className:"text-base font-bold text-gray-900 dark:text-white mb-6 flex items-center",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center shadow-md mr-3",children:o.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"})})}),t]}),o.jsxs("div",{className:"flex flex-col lg:flex-row items-start space-y-5 lg:space-y-0 lg:space-x-1",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsxs("svg",{width:"220",height:"220",viewBox:"0 0 200 200",className:"mx-auto drop-shadow-lg",children:[o.jsxs("defs",{children:[o.jsxs("linearGradient",{id:"gradient1",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[o.jsx("stop",{offset:"0%",stopColor:"#3B82F6"}),o.jsx("stop",{offset:"100%",stopColor:"#1D4ED8"})]}),o.jsxs("linearGradient",{id:"gradient2",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[o.jsx("stop",{offset:"0%",stopColor:"#10B981"}),o.jsx("stop",{offset:"100%",stopColor:"#047857"})]}),o.jsxs("linearGradient",{id:"gradient3",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[o.jsx("stop",{offset:"0%",stopColor:"#F59E0B"}),o.jsx("stop",{offset:"100%",stopColor:"#D97706"})]}),o.jsxs("linearGradient",{id:"gradient4",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[o.jsx("stop",{offset:"0%",stopColor:"#EF4444"}),o.jsx("stop",{offset:"100%",stopColor:"#DC2626"})]}),o.jsxs("linearGradient",{id:"gradient5",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[o.jsx("stop",{offset:"0%",stopColor:"#8B5CF6"}),o.jsx("stop",{offset:"100%",stopColor:"#7C3AED"})]})]}),c.map((H,K)=>o.jsx("path",{d:I(H.startAngle,H.endAngle),fill:U(K),stroke:"white",strokeWidth:"3",className:`transition-all duration-300 cursor-pointer ${n===K?"opacity-90 transform scale-1.05":"opacity-100 hover:opacity-90"}`,onMouseEnter:()=>a(K),onMouseLeave:()=>a(null),style:{filter:n===K?"drop-shadow(0 4px 8px rgba(0,0,0,0.2))":"none"}},K)),o.jsx("circle",{cx:"100",cy:"100",r:"45",fill:"white",className:"dark:fill-black drop-shadow-md"}),o.jsx("circle",{cx:"100",cy:"100",r:"40",fill:"url(#centerGradient)",className:"drop-shadow-sm"}),o.jsx("defs",{children:o.jsxs("radialGradient",{id:"centerGradient",cx:"50%",cy:"50%",r:"50%",children:[o.jsx("stop",{offset:"0%",stopColor:"#F8FAFC"}),o.jsx("stop",{offset:"100%",stopColor:"#E2E8F0"})]})}),o.jsx("text",{x:"100",y:"93",textAnchor:"middle",className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Total"}),o.jsx("text",{x:"100",y:"118",textAnchor:"middle",className:"text-xl font-black text-gray-900 dark:text-white",children:i.toLocaleString()})]})}),o.jsx("div",{className:"flex-1 space-y-3 min-w-0",children:S.map((H,K)=>{var Q;return o.jsxs("div",{className:`flex items-center justify-between py-1 px-2 border-2 rounded-lg transition-all duration-300 cursor-pointer ${n===K?"border-blue-300 dark:border-blue-600 bg-blue-50 dark:bg-blue-900/20 shadow-lg transform scale-105":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 hover:bg-gray-50 dark:hover:bg-gray-800"}`,onMouseEnter:()=>a(K),onMouseLeave:()=>a(null),children:[o.jsxs("div",{className:"flex items-center space-x-1 min-w-0 flex-1",children:[o.jsxs("div",{className:"relative flex-shrink-0",children:[o.jsx("div",{className:"w-4 h-4 rounded-full shadow-md",style:{backgroundColor:D(K)}}),n===K&&o.jsx("div",{className:"absolute inset-0 w-4 h-4 rounded-full animate-ping opacity-75",style:{backgroundColor:D(K)}})]}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-xs font-bold text-gray-900 dark:text-white break-words",children:H._id||"Unknown"}),o.jsxs("p",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 break-words",style:{fontSize:"0.65rem"},children:[H.percentage.toFixed(1),"% of total"]})]})]}),o.jsxs("div",{className:"text-right flex-shrink-0 ml-1",children:[o.jsx("div",{className:"text-xs font-black text-gray-900 dark:text-white",children:((Q=H.count)==null?void 0:Q.toLocaleString())||0}),o.jsxs("div",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400",style:{fontSize:"0.65rem"},children:["violation",H.count!==1?"s":""]})]})]},K)})})]}),x.length<5&&o.jsx("div",{className:"mt-6 text-center",children:o.jsxs("div",{className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-100 to-purple-100 dark:from-blue-900/30 dark:to-purple-900/30 rounded-lg border border-blue-200 dark:border-blue-700",children:[o.jsx("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsxs("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:["Only ",x.length," violation types available"]})]})})]})})}function r$e({displayData:e,loading:t,currentViolations:r,startIndex:n,endIndex:a,totalViolationItems:c,currentPage:h,totalPages:i,handlePrevPage:x,handleNextPage:w}){return t?o.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded mb-4"}),o.jsx("div",{className:"space-y-3",children:[...Array(5)].map((S,T)=>o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"w-8 h-8 bg-muted rounded"}),o.jsxs("div",{className:"flex-1 space-y-2",children:[o.jsx("div",{className:"h-4 bg-muted rounded"}),o.jsx("div",{className:"h-3 bg-muted rounded w-1/2"})]}),o.jsx("div",{className:"w-16 h-6 bg-muted rounded"})]},T))})]})}):o.jsxs("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-800 rounded-lg shadow-md p-6",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[o.jsx("div",{className:"w-10 h-10 bg-red-600 rounded-lg flex items-center justify-center shadow-md",children:o.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})})}),o.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:"Top Violations Ranking"})]}),r.length>0?o.jsx("div",{className:"space-y-3 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:r.map((S,T)=>{const E=n+T+1,D=I=>"bg-red-600 text-white shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300",U=I=>I;return o.jsxs("div",{className:"flex items-center space-x-4 p-3 border-2 border-gray-300 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-900 hover:border-red-300 dark:hover:border-red-600 hover:shadow-lg transition-all duration-300 bg-white dark:bg-gray-900 group",children:[o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${D()}`,children:U(E)}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate group-hover:text-red-700 dark:group-hover:text-red-300 transition-colors duration-300",children:S._id||"Unknown Violation"}),o.jsxs("p",{className:"text-xs text-red-600 font-medium group-hover:text-red-700 transition-all duration-300",children:[S.count||0," occurrences"]}),o.jsx("div",{className:"mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 overflow-hidden",children:o.jsx("div",{className:"h-full bg-red-600 rounded-full shadow-sm transition-all duration-500 group-hover:shadow-md",style:{width:`${Math.min((S.count||0)/Math.max(...r.map(I=>I.count||0))*100,100)}%`}})})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white group-hover:text-red-700 dark:group-hover:text-red-300 transition-colors duration-300",children:S.count||0}),o.jsx("div",{className:"text-xs text-red-600 font-medium group-hover:text-red-700 transition-all duration-300",children:"violations"})]})]},S._id||T)})}):o.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[o.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:o.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),o.jsx("p",{children:"No violation data available"})]}),r.length>0&&i>1&&o.jsx("div",{className:"mt-6 pt-4 border-t-2 border-gray-300 dark:border-gray-600",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Showing ",n+1," to ",Math.min(a,c)," of ",c," violations"]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Page ",h," of ",i]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs("button",{onClick:x,disabled:h===1,className:"px-3 py-1.5 text-sm font-semibold text-white bg-red-600 hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed rounded-lg shadow-md transition-all duration-200 flex items-center space-x-1",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),o.jsx("span",{children:"Previous"})]}),o.jsxs("button",{onClick:w,disabled:h===i,className:"px-3 py-1.5 text-sm font-semibold text-white bg-red-600 hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed rounded-lg shadow-md transition-all duration-200 flex items-center space-x-1",children:[o.jsx("span",{children:"Next"}),o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]})})]})}function n$e({displayData:e,loading:t,getCombinationRecommendation:r}){const[n,a]=G.useState("combinations"),[c,h]=G.useState(1),i=5;if(t)return o.jsx("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-xl shadow-lg p-6",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded mb-6"}),o.jsxs("div",{className:"overflow-hidden",children:[o.jsx("div",{className:"bg-gray-200 dark:bg-gray-700 rounded h-8 mb-4"}),o.jsx("div",{className:"space-y-3",children:[...Array(5)].map((Q,ae)=>o.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded-lg"}),o.jsxs("div",{className:"flex-1 space-y-2",children:[o.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),o.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]})]})},ae))})]})]})});const x=(e==null?void 0:e.violationCombinations)||[],w=(e==null?void 0:e.violationPatterns)||[],S=n==="combinations"?x.length:w.length,T=Math.ceil(S/i),E=(c-1)*i,D=E+i,U=x.slice(E,D),I=w.slice(E,D),V=()=>{h(Q=>Math.max(Q-1,1))},H=()=>{h(Q=>Math.min(Q+1,T))},K=Q=>{a(Q),h(1)};return o.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-xl shadow-sm overflow-hidden",children:[o.jsx("div",{className:"px-4 py-3 bg-blue-50 dark:bg-blue-900/20 border-b border-blue-200 dark:border-blue-800",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Xg,{className:"w-6 h-6 text-blue-600 dark:text-blue-300"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:"Violation Analysis"}),o.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Combinations & Recommended Actions"})]})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsxs("button",{onClick:()=>K("combinations"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${n==="combinations"?"bg-blue-500 text-white":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[o.jsx(ho,{className:"w-4 h-4 inline mr-1"}),"Combinations"]}),o.jsxs("button",{onClick:()=>K("patterns"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${n==="patterns"?"bg-blue-500 text-white":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[o.jsx(P1,{className:"w-4 h-4 inline mr-1"}),"Patterns"]})]})]})}),o.jsx("div",{className:"p-4",children:x.length>0||w.length>0?o.jsxs("div",{className:"space-y-2",children:[n==="combinations"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/30 rounded-md p-3 border border-blue-200 dark:border-blue-800 shadow-sm",children:o.jsxs("div",{className:"grid grid-cols-12 gap-4 text-xs font-bold text-gray-900 dark:text-white uppercase tracking-wide",children:[o.jsx("div",{className:"col-span-1",children:"#"}),o.jsx("div",{className:"col-span-4",children:"Violation Types"}),o.jsx("div",{className:"col-span-2",children:"Occurrences"}),o.jsx("div",{className:"col-span-2",children:"Severity"}),o.jsx("div",{className:"col-span-3",children:"Recommended Action"})]})}),U.map((Q,ae)=>{const ee=Q.violations||[],se=Q.count||0,ue=r(ee),he=E+ae+1;return o.jsx("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-md p-3 hover:bg-gray-50 dark:hover:bg-gray-900/20 transition-colors",children:o.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[o.jsx("div",{className:"col-span-1",children:o.jsx("div",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-800 rounded-full inline-flex items-center justify-center",children:o.jsx("span",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:he})})}),o.jsx("div",{className:"col-span-4",children:o.jsx("div",{className:"flex flex-wrap gap-1.5",children:ee.map((Ce,Ne)=>o.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border border-red-200 dark:border-red-800 text-red-700 dark:text-red-400 bg-red-50 dark:bg-red-900/20",children:Ce},Ne))})}),o.jsx("div",{className:"col-span-2",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(u4,{className:"w-5 h-5 text-blue-600 dark:text-blue-400",strokeWidth:2.5}),o.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:se.toLocaleString()})]})}),o.jsx("div",{className:"col-span-2",children:o.jsxs("div",{className:"inline-flex items-center gap-2",children:[o.jsx("span",{className:`inline-block w-2.5 h-2.5 rounded-full ${se>=50?"bg-red-500":se>=20?"bg-orange-500":"bg-yellow-500"}`}),o.jsx("span",{className:"text-xs font-semibold text-gray-800 dark:text-gray-200",children:se>=50?"High":se>=20?"Medium":"Low"})]})}),o.jsx("div",{className:"col-span-3",children:o.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300 leading-relaxed",children:ue})})]})},ae)})]}),n==="patterns"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/30 rounded-md p-3 border border-blue-200 dark:border-blue-800 shadow-sm",children:o.jsxs("div",{className:"grid grid-cols-12 gap-4 text-xs font-bold text-gray-900 dark:text-white uppercase tracking-wide",children:[o.jsx("div",{className:"col-span-1",children:"#"}),o.jsx("div",{className:"col-span-4",children:"Pattern Name"}),o.jsx("div",{className:"col-span-2",children:"Frequency"}),o.jsx("div",{className:"col-span-2",children:"Status"}),o.jsx("div",{className:"col-span-3",children:"Analysis"})]})}),I.map((Q,ae)=>{const ee=Q.pattern||"Unknown Pattern",se=Q.frequency||0,ue=Q.description||"No description available",he=E+ae+1;return o.jsx("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-md p-3 hover:bg-gray-50 dark:hover:bg-gray-900/20 transition-colors",children:o.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[o.jsx("div",{className:"col-span-1",children:o.jsx("div",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-800 rounded-full inline-flex items-center justify-center",children:o.jsx("span",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:he})})}),o.jsxs("div",{className:"col-span-4",children:[o.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-1",children:ee}),o.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 leading-relaxed",children:ue})]}),o.jsx("div",{className:"col-span-2",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(P1,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),o.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:se.toLocaleString()})]})}),o.jsx("div",{className:"col-span-2",children:o.jsxs("div",{className:"inline-flex items-center gap-2",children:[o.jsx("span",{className:`inline-block w-2.5 h-2.5 rounded-full ${se>=30?"bg-green-500":se>=15?"bg-yellow-500":"bg-gray-400"}`}),o.jsx("span",{className:"text-xs font-semibold text-gray-800 dark:text-gray-200",children:se>=30?"Active":se>=15?"Moderate":"Low"})]})}),o.jsx("div",{className:"col-span-3",children:o.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-800 rounded-lg p-3",children:[o.jsx("p",{className:"text-xs text-indigo-800 dark:text-indigo-300 font-medium mb-1",children:"Pattern Analysis:"}),o.jsx("p",{className:"text-xs text-indigo-700 dark:text-indigo-400 leading-relaxed",children:"Recurring violation behaviors requiring targeted enforcement strategies."})]})})]})},`pattern-${ae}`)})]}),T>1&&o.jsxs("div",{className:"flex justify-center items-center pt-3 space-x-4",children:[o.jsxs("button",{onClick:V,disabled:c===1,className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 ${c===1?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600 shadow-sm"}`,children:[o.jsx(s4,{className:"w-4 h-4"}),o.jsx("span",{children:"Previous"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Page ",c," of ",T]}),o.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-500",children:["(",S," total items)"]})]}),o.jsxs("button",{onClick:H,disabled:c===T,className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 ${c===T?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600 shadow-sm"}`,children:[o.jsx("span",{children:"Next"}),o.jsx(z0,{className:"w-4 h-4"})]})]})]}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"mx-auto mb-4",children:o.jsx(Xg,{className:"w-10 h-10 text-gray-400"})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No Data Available"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No violation combination data found for the selected period."})]})})]})}function i$e({displayData:e,loading:t,currentViolations:r,startIndex:n,endIndex:a,totalViolationItems:c,currentPage:h,totalPages:i,handlePrevPage:x,handleNextPage:w,getCombinationRecommendation:S}){if(t)return o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[o.jsx("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-lg p-6",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded mb-4"}),o.jsx("div",{className:"h-64 bg-muted rounded"})]})}),o.jsx("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-lg p-6",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded mb-4"}),o.jsx("div",{className:"h-64 bg-muted rounded"})]})})]});const T=(e==null?void 0:e.violationsByType)||[];return T.reduce((E,D)=>E+(D.count||0),0),o.jsxs("div",{className:"space-y-6 mb-8",children:[o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 mb-5",children:[o.jsx("div",{className:"lg:col-span-2 flex",children:o.jsx("div",{className:"w-full",style:{minHeight:"400px"},children:o.jsx(t$e,{data:T,title:"Violation Types Distribution",loading:t})})}),o.jsx("div",{className:"lg:col-span-3 flex",children:o.jsx("div",{className:"w-full",style:{minHeight:"400px"},children:o.jsx(e$e,{data:(e==null?void 0:e.topOfficers)||[],title:"Apprehending Officers",type:"officers",loading:t,totalCount:(e==null?void 0:e.totalOfficers)||0})})})]}),o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-1 gap-6 mb-8",children:o.jsx("div",{className:"lg:col-span-1",children:o.jsx(r$e,{displayData:e,loading:t,currentViolations:r,startIndex:n,endIndex:a,totalViolationItems:c,currentPage:h,totalPages:i,handlePrevPage:x,handleNextPage:w})})}),o.jsx("div",{className:"mb-8",children:o.jsx(n$e,{displayData:e,loading:t,getCombinationRecommendation:S})})]})}function a$e({analyticsData:e}){const[t,r]=G.useState("monthly"),[n,a]=G.useState(!1),[c,h]=G.useState("All Time"),[i,x]=G.useState(2020),[w,S]=G.useState("line"),T=G.useRef(null),E=new Date().getFullYear(),D=new Date().getMonth()+1;G.useEffect(()=>{const Ne=me=>{T.current&&!T.current.contains(me.target)&&a(!1)};return document.addEventListener("mousedown",Ne),()=>{document.removeEventListener("mousedown",Ne)}},[]);const U=()=>{const Ne=[];for(let me=2e3;me<=E;me++)Ne.push(me);return Ne.sort((me,be)=>be-me)},I=()=>[2e3,2005,2010,2015,2020,2025],V=()=>{if(!(e!=null&&e.monthlyTrends)||e.monthlyTrends.length===0)return H();const Ne=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(c==="All Time"){const we={},Pe={};Ne.forEach((Be,Ge)=>{Pe[Ge+1]=0}),e.monthlyTrends.forEach(Be=>{var We;const Ge=((We=Be._id)==null?void 0:We.month)||0;Ge>0&&Ge<=12&&(Pe[Ge]+=Be.count||0)}),Ne.forEach((Be,Ge)=>{we[Be]=Pe[Ge+1]||0});const Me=Object.values(Pe).reduce((Be,Ge)=>Be+Ge,0);return{monthly:we,yearlyTotal:Me,isAllTime:!0}}const me=parseInt(c),be={};Ne.forEach((we,Pe)=>{be[Ne[Pe]]=0}),e.monthlyTrends.forEach(we=>{var Pe,Me;if(((Pe=we._id)==null?void 0:Pe.year)===me){const Be=((Me=we._id)==null?void 0:Me.month)||0;Be>0&&Be<=12&&(be[Ne[Be-1]]=we.count||0)}});const pe=Object.values(be).reduce((we,Pe)=>we+Pe,0),Se={},Ee=me===E?D:12;return Ne.slice(0,Ee).forEach((we,Pe)=>{Se[we]=be[we]||0}),{monthly:Se,yearlyTotal:pe,isAllTime:!1}},H=()=>{if(!(e!=null&&e.yearlyTrends)||e.yearlyTrends.length===0)return null;const Ne=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(c==="All Time"){const Pe=e.yearlyTrends.filter(Ge=>{var tt;const We=((tt=Ge._id)==null?void 0:tt.year)||0;return We>=2e3&&We<=E}).reduce((Ge,We)=>Ge+(We.count||0),0),Me={};let Be=Pe;return Ne.forEach((Ge,We)=>{const tt=Math.sin(We/12*Math.PI)*.3+.7;if(We===Ne.length-1)Me[Ge]=Be;else{const nt=Math.round(Pe/12*tt);Me[Ge]=nt,Be-=nt}}),{monthly:Me,yearlyTotal:Pe,isAllTime:!0}}const me=parseInt(c),be=e.yearlyTrends.find(we=>{var Pe;return((Pe=we._id)==null?void 0:Pe.year)===me});if(!be)return null;const pe=be.count||0,Se=me===E?D:12,Ee={};return Ne.slice(0,Se).forEach((we,Pe)=>{const Me=Math.sin(Pe/12*Math.PI)*.3+.7;Ee[we]=Math.round(pe/12*Me)}),{monthly:Ee,yearlyTotal:pe,isAllTime:!1}},K=V(),ae=(()=>{if(t==="monthly"){if(!K)return{totalViolations:0,topMonth:{month:"N/A",value:0},peakMonth:"N/A",peakValue:0,avgPerMonth:0,peakYear:null,avgPerYear:null};const Ne=Math.round(K.yearlyTotal),me=Object.entries(K.monthly).reduce((Ee,[we,Pe])=>Pe>Ee.value?{month:we,value:Pe}:Ee,{month:"Jan",value:0}),be=me.month,pe=me.value,Se=Math.round(Ne/12);return{totalViolations:Ne,topMonth:me,peakMonth:be,peakValue:pe,avgPerMonth:Se,peakYear:null,avgPerYear:null}}else{const Ne=i,me=Ne+5,be=((e==null?void 0:e.yearlyTrends)||[]).filter(Be=>{var We;const Ge=((We=Be._id)==null?void 0:We.year)||0;return Ge>=Ne&&Ge<=me}).sort((Be,Ge)=>{var We,tt;return(((We=Be._id)==null?void 0:We.year)||0)-(((tt=Ge._id)==null?void 0:tt.year)||0)}).map(Be=>{var Ge;return{year:(Ge=Be._id)==null?void 0:Ge.year,violations:Be.count||0}}),pe=[];for(let Be=Ne;Be<=me;Be++){const Ge=be.find(We=>We.year===Be);pe.push({year:Be,violations:Ge?Ge.violations:0})}if(pe.length===0)return{totalViolations:0,topMonth:{month:"N/A",value:0},peakMonth:null,peakValue:0,avgPerMonth:null,peakYear:"N/A",avgPerYear:0};const Se=pe.reduce((Be,Ge)=>Be+(Ge.violations||0),0),Ee=pe.reduce((Be,Ge)=>(Ge.violations||0)>(Be.violations||0)?Ge:Be,pe[0]||{year:"N/A",violations:0}),we=Ee.year||"N/A",Pe=Ee.violations||0,Me=Math.round(Se/pe.length);return{totalViolations:Se,topMonth:{month:"N/A",value:0},peakMonth:null,peakValue:Pe,avgPerMonth:null,peakYear:we,avgPerYear:Me}}})(),ee=()=>{if(!K)return[];if(t==="monthly")return Object.keys(K.monthly).map(me=>({month:me,violations:K.monthly[me]||0,year:c}));{const Ne=i,me=Ne+5,be=((e==null?void 0:e.yearlyTrends)||[]).filter(Se=>{var we;const Ee=((we=Se._id)==null?void 0:we.year)||0;return Ee>=Ne&&Ee<=me}).sort((Se,Ee)=>{var we,Pe;return(((we=Se._id)==null?void 0:we.year)||0)-(((Pe=Ee._id)==null?void 0:Pe.year)||0)}).map(Se=>{var Ee;return{year:(Ee=Se._id)==null?void 0:Ee.year,violations:Se.count||0}}),pe=[];for(let Se=Ne;Se<=me;Se++){const Ee=be.find(we=>we.year===Se);pe.push({year:Se,violations:Ee?Ee.violations:0})}return pe}},se=U(),ue=ee(),he=({active:Ne,payload:me,label:be})=>{var pe,Se;return Ne&&me&&me.length?o.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 border border-red-200 dark:border-red-700 rounded-lg shadow-lg max-w-xs",children:[o.jsx("p",{className:"text-sm font-bold text-red-800 dark:text-red-300 mb-2 text-center",children:t==="monthly"?`${be} ${c}`:be}),o.jsx("div",{className:"space-y-1",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),o.jsx("span",{className:"text-xs text-gray-700 dark:text-gray-300",children:"Violations"})]}),o.jsx("span",{className:"text-xs font-medium text-red-600 dark:text-red-400",children:((Se=(pe=me[0])==null?void 0:pe.value)==null?void 0:Se.toLocaleString())||0})]})})]}):null},Ce=Ne=>{if(!K)return;let me="",be="",pe="";t==="monthly"?Ne==="csv"?(me=`Month,Violations
`,Object.entries(K.monthly).forEach(([Me,Be])=>{me+=`${Me},${Be}
`}),be=`violation_monitoring_monthly_${c==="All Time"?"all_time":c}_${new Date().toISOString().split("T")[0]}.csv`,pe="text/csv"):Ne==="json"?(me=JSON.stringify(K.monthly,null,2),be=`violation_monitoring_monthly_${c==="All Time"?"all_time":c}_${new Date().toISOString().split("T")[0]}.json`,pe="application/json"):Ne==="excel"&&(me=`Month,Violations
`,Object.entries(K.monthly).forEach(([Me,Be])=>{me+=`${Me},${Be}
`}),be=`violation_monitoring_monthly_${c==="All Time"?"all_time":c}_${new Date().toISOString().split("T")[0]}.xlsx`,pe="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"):Ne==="csv"?(me=`Year,Violations
`,ue.forEach(Pe=>{me+=`${Pe.year},${Pe.violations}
`}),be=`violation_monitoring_yearly_${new Date().toISOString().split("T")[0]}.csv`,pe="text/csv"):Ne==="json"?(me=JSON.stringify(ue,null,2),be=`violation_monitoring_yearly_${new Date().toISOString().split("T")[0]}.json`,pe="application/json"):Ne==="excel"&&(me=`Year,Violations
`,ue.forEach(Pe=>{me+=`${Pe.year},${Pe.violations}
`}),be=`violation_monitoring_yearly_${new Date().toISOString().split("T")[0]}.xlsx`,pe="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");const Se=new Blob([me],{type:pe}),Ee=window.URL.createObjectURL(Se),we=document.createElement("a");we.href=Ee,we.download=be,document.body.appendChild(we),we.click(),document.body.removeChild(we),window.URL.revokeObjectURL(Ee),a(!1)};return K?o.jsxs("div",{className:"mt-8 border border-red-200/70 dark:border-red-800/60 rounded-xl shadow-lg",children:[o.jsx("div",{className:"p-6 border-b border-red-200/50 dark:border-red-700/50",children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"flex items-center justify-center",children:o.jsx("svg",{className:"w-10 h-10 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Violation Monitoring"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Real-time monitoring of violations to track trends, identify patterns, and support data-driven traffic management decisions."}),o.jsx("div",{className:"mt-2 flex items-center gap-2",children:o.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 dark:bg-red-900/50 text-red-800 dark:text-red-300",children:t==="monthly"?c==="All Time"?"All Time (2000-2025)":`Monitoring ${c}`:`Monitoring ${i}-${i+5}`})})]})]})})}),o.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-4 h-full",children:[o.jsx("div",{className:"xl:col-span-3 p-2 sm:p-4",children:o.jsx("div",{className:"space-y-4 sm:space-y-6",children:o.jsxs("div",{className:"relative backdrop-blur-sm rounded-xl p-3 sm:p-6 border border-orange-200/20 dark:border-orange-700/20 shadow-lg overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 opacity-5 flex items-center justify-center",children:o.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 400 300",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsxs("g",{transform:"translate(200, 150)",children:[o.jsx("path",{d:"M-40,-50 Q-40,-60 -30,-60 L30,-60 Q40,-60 40,-50 L40,10 Q40,20 30,20 L20,30 Q10,40 0,40 Q-10,40 -20,30 L-30,20 Q-40,20 -40,10 Z",fill:"#DC2626"}),o.jsx("circle",{cx:"0",cy:"-15",r:"4",fill:"#FFF"}),o.jsx("rect",{x:"-2",y:"-8",width:"4",height:"20",rx:"2",fill:"#FFF"}),o.jsx("circle",{cx:"0",cy:"12",r:"2",fill:"#FFF"})]}),o.jsxs("g",{transform:"translate(80, 80)",children:[o.jsx("path",{d:"M0,-25 L25,25 L-25,25 Z",fill:"#EF4444"}),o.jsx("path",{d:"M0,-15 L12,15 L-12,15 Z",fill:"#FFF"}),o.jsx("path",{d:"M0,-10 L0,5",stroke:"#EF4444",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("circle",{cx:"0",cy:"8",r:"1.5",fill:"#EF4444"})]}),o.jsxs("g",{transform:"translate(320, 80)",children:[o.jsx("path",{d:"M-15,-25 L15,-25 L25,0 L15,25 L-15,25 L-25,0 Z",fill:"#DC2626"}),o.jsx("text",{x:"0",y:"5",textAnchor:"middle",fill:"#FFF",fontSize:"14",fontWeight:"bold",children:"STOP"})]}),o.jsxs("g",{transform:"translate(60, 200)",children:[o.jsx("rect",{x:"-25",y:"-15",width:"50",height:"30",rx:"3",fill:"#FBBF24",stroke:"#DC2626",strokeWidth:"2"}),o.jsx("rect",{x:"-20",y:"-10",width:"40",height:"3",fill:"#DC2626"}),o.jsx("path",{d:"M-10,5 L10,5",stroke:"#DC2626",strokeWidth:"1.5",strokeLinecap:"round"}),o.jsx("path",{d:"M-10,10 L5,10",stroke:"#DC2626",strokeWidth:"1.5",strokeLinecap:"round"}),o.jsx("circle",{cx:"15",cy:"-10",r:"3",fill:"#DC2626"})]}),o.jsxs("g",{transform:"translate(340, 200)",children:[o.jsx("circle",{cx:"0",cy:"0",r:"20",fill:"#FFF",stroke:"#DC2626",strokeWidth:"3"}),o.jsx("text",{x:"0",y:"8",textAnchor:"middle",fill:"#DC2626",fontSize:"16",fontWeight:"bold",children:"60"}),o.jsx("path",{d:"M-15,-15 L-10,-10 M15,-15 L10,-10",stroke:"#DC2626",strokeWidth:"1.5"})]}),o.jsxs("g",{transform:"translate(120, 140)",children:[o.jsx("circle",{cx:"0",cy:"0",r:"15",fill:"#EF4444"}),o.jsx("text",{x:"0",y:"6",textAnchor:"middle",fill:"#FFF",fontSize:"18",fontWeight:"bold",children:"!"})]}),o.jsxs("g",{transform:"translate(280, 140)",children:[o.jsx("circle",{cx:"0",cy:"0",r:"18",fill:"#F97316"}),o.jsx("path",{d:"M-12,-12 L12,12 M12,-12 L-12,12",stroke:"#FFF",strokeWidth:"3",strokeLinecap:"round"})]})]})}),o.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[o.jsx("h4",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white",children:t==="monthly"?"Monthly Trend":"Yearly Trend"}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",style:{pointerEvents:"auto"},children:[o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[t==="monthly"&&o.jsxs("div",{className:"flex items-center gap-2 relative",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 hidden sm:inline",children:"Year:"}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{value:c,onChange:Ne=>h(Ne.target.value),className:"px-3 pr-8 py-1.5 text-xs font-medium bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-gray-900 dark:text-white hover:border-red-300 dark:hover:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-500/20 transition-all duration-200 cursor-pointer shadow-sm hover:shadow-md appearance-none",style:{minWidth:"180px"},children:[o.jsx("option",{value:"All Time",children:"All Time (2000-2025)"}),se.map(Ne=>o.jsx("option",{value:Ne,children:Ne},Ne))]}),o.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none",children:o.jsx("svg",{className:"w-4 h-4 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),t==="yearly"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-2 relative",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 hidden sm:inline",children:"Years:"}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:i,onChange:Ne=>x(parseInt(Ne.target.value)),className:"px-3 pr-8 py-1.5 text-xs font-medium bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-gray-900 dark:text-white hover:border-red-300 dark:hover:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-500/20 transition-all duration-200 cursor-pointer shadow-sm hover:shadow-md appearance-none",style:{minWidth:"160px"},children:I().map(Ne=>o.jsx("option",{value:Ne,children:`${Ne}-${Ne+5}`},Ne))}),o.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none",children:o.jsx("svg",{className:"w-4 h-4 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 hidden sm:inline",children:"Chart:"}),o.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-600 rounded-md p-0.5",children:[o.jsx("button",{onClick:Ne=>{Ne.preventDefault(),Ne.stopPropagation(),S("bar")},className:`px-2 sm:px-3 py-1.5 text-xs rounded transition-all duration-200 cursor-pointer select-none z-10 relative ${w==="bar"?"bg-white dark:bg-gray-500 text-gray-900 dark:text-white shadow-sm font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-500"}`,type:"button",style:{pointerEvents:"auto"},children:"Bar"}),o.jsx("button",{onClick:Ne=>{Ne.preventDefault(),Ne.stopPropagation(),S("line")},className:`px-2 sm:px-3 py-1.5 text-xs rounded transition-all duration-200 cursor-pointer select-none z-10 relative ${w==="line"?"bg-white dark:bg-gray-500 text-gray-900 dark:text-white shadow-sm font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-500"}`,type:"button",style:{pointerEvents:"auto"},children:"Line"})]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 hidden sm:inline",children:"View:"}),o.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-600 rounded-md p-0.5",children:[o.jsx("button",{onClick:Ne=>{Ne.preventDefault(),Ne.stopPropagation(),r("monthly")},className:`px-2 sm:px-3 py-1.5 text-xs rounded transition-all duration-200 cursor-pointer select-none z-10 relative touch-manipulation ${t==="monthly"?"bg-white dark:bg-gray-500 text-gray-900 dark:text-white shadow-sm font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-500"}`,type:"button",style:{pointerEvents:"auto"},children:"Monthly"}),o.jsx("button",{onClick:Ne=>{Ne.preventDefault(),Ne.stopPropagation(),r("yearly")},className:`px-2 sm:px-3 py-1.5 text-xs rounded transition-all duration-200 cursor-pointer select-none z-10 relative touch-manipulation ${t==="yearly"?"bg-white dark:bg-gray-500 text-gray-900 dark:text-white shadow-sm font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-500"}`,type:"button",style:{pointerEvents:"auto"},children:"Yearly"})]})]}),o.jsx("div",{className:"flex items-center gap-2 ml-auto relative",children:o.jsxs("div",{className:"relative",ref:T,children:[o.jsxs("button",{onClick:()=>a(!n),className:"px-2 sm:px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-xs font-medium rounded-md transition-colors duration-200 flex items-center gap-1 touch-manipulation",children:[o.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),o.jsx("span",{className:"hidden sm:inline",children:"Export"}),o.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&o.jsx("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-50",children:o.jsxs("div",{className:"py-1",children:[o.jsxs("button",{onClick:()=>Ce("csv"),className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export as CSV"]}),o.jsxs("button",{onClick:()=>Ce("json"),className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Export as JSON"]}),o.jsxs("button",{onClick:()=>Ce("excel"),className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export as Excel"]})]})})]})})]})]}),o.jsx("div",{className:"h-64 sm:h-80 lg:h-96",children:o.jsx(uo,{width:"100%",height:"100%",children:t==="monthly"?o.jsxs(Fw,{data:ue,margin:{top:20,right:30,left:20,bottom:20},children:[o.jsx("defs",{children:o.jsxs("linearGradient",{id:"colorViolationsMonthly",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"5%",stopColor:"#E15759",stopOpacity:.2}),o.jsx("stop",{offset:"95%",stopColor:"#E15759",stopOpacity:.03})]})}),o.jsx(ms,{strokeDasharray:"2 4",stroke:"#E15759",strokeOpacity:.2,vertical:!1}),o.jsx(ga,{dataKey:"month",stroke:"#E15759",fontSize:12,fontWeight:"600",tick:{fill:"#E15759",fontSize:12}}),o.jsx(ya,{stroke:"#E15759",fontSize:12,fontWeight:"600",tick:{fill:"#E15759",fontSize:12},tickFormatter:Ne=>Ne.toLocaleString()}),o.jsx(zi,{content:o.jsx(he,{}),cursor:{stroke:"#F28E2B",strokeWidth:1,strokeDasharray:"3 3"}}),o.jsx(Fu,{wrapperStyle:{fontSize:"13px",fontWeight:"600",color:"#E15759",paddingTop:"10px"}}),o.jsx(Sc,{type:"monotone",dataKey:"violations",stroke:"none",fill:"url(#colorViolationsMonthly)",fillOpacity:1}),o.jsx(Ud,{type:"monotone",dataKey:"violations",stroke:"#E15759",strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",dot:{r:5,fill:"#E15759",stroke:"#fff",strokeWidth:2},activeDot:{r:8,fill:"#E15759",stroke:"#fff",strokeWidth:3,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},name:"Violations"})]}):w==="bar"?o.jsxs(Xc,{data:ue,margin:{top:20,right:20,left:20,bottom:10},children:[o.jsx(ms,{strokeDasharray:"2 4",stroke:"#E15759",strokeOpacity:.2,vertical:!1}),o.jsx(ga,{dataKey:"year",stroke:"#E15759",fontSize:12,fontWeight:"600",tick:{fill:"#E15759",fontSize:12}}),o.jsx(ya,{stroke:"#E15759",fontSize:12,fontWeight:"600",tick:{fill:"#E15759",fontSize:12},tickFormatter:Ne=>Ne.toLocaleString()}),o.jsx(zi,{content:o.jsx(he,{}),cursor:{fill:"#F28E2B",fillOpacity:.1}}),o.jsx(Fu,{wrapperStyle:{fontSize:"13px",fontWeight:"600",color:"#E15759",paddingTop:"10px"}}),o.jsx(rs,{dataKey:"violations",name:"Violations",fill:"#E15759"})]}):o.jsxs(Fw,{data:ue,margin:{top:20,right:30,left:20,bottom:20},children:[o.jsx("defs",{children:o.jsxs("linearGradient",{id:"colorViolationsYearly",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"5%",stopColor:"#E15759",stopOpacity:.2}),o.jsx("stop",{offset:"95%",stopColor:"#E15759",stopOpacity:.03})]})}),o.jsx(ms,{strokeDasharray:"2 4",stroke:"#E15759",strokeOpacity:.2,vertical:!1}),o.jsx(ga,{dataKey:"year",stroke:"#E15759",fontSize:12,fontWeight:"600",tick:{fill:"#E15759",fontSize:12}}),o.jsx(ya,{stroke:"#E15759",fontSize:12,fontWeight:"600",tick:{fill:"#E15759",fontSize:12},tickFormatter:Ne=>Ne.toLocaleString()}),o.jsx(zi,{content:o.jsx(he,{}),cursor:{stroke:"#F28E2B",strokeWidth:1,strokeDasharray:"3 3"}}),o.jsx(Fu,{wrapperStyle:{fontSize:"13px",fontWeight:"600",color:"#E15759",paddingTop:"10px"}}),o.jsx(Sc,{type:"monotone",dataKey:"violations",stroke:"none",fill:"url(#colorViolationsYearly)",fillOpacity:1}),o.jsx(Ud,{type:"monotone",dataKey:"violations",stroke:"#E15759",strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",dot:{r:5,fill:"#E15759",stroke:"#fff",strokeWidth:2},activeDot:{r:8,fill:"#E15759",stroke:"#fff",strokeWidth:3,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},name:"Violations"})]})})})]})})}),o.jsx("div",{className:"xl:col-span-1 p-2 sm:p-4",children:o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-1 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-red-100 dark:bg-red-900/50 rounded-lg flex items-center justify-center",children:o.jsx("svg",{className:"w-3 h-3 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),o.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Total Violations"})]}),o.jsx("div",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-white",children:ae.totalViolations.toLocaleString()}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:t==="monthly"?c==="All Time"?"All Time":`Year ${c}`:`${i}-${i+5}`})]}),o.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("div",{className:"w-6 h-6 bg-red-100 dark:bg-red-900/50 rounded-lg flex items-center justify-center",children:o.jsx("svg",{className:"w-3 h-3 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),o.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:t==="monthly"?"Peak Month":"Peak Year"})]}),o.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white truncate w-full",children:t==="monthly"?ae.peakMonth:ae.peakYear}),o.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[ae.peakValue.toLocaleString()," violations"]})]}),o.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("div",{className:"w-6 h-6 bg-orange-100 dark:bg-orange-900/50 rounded-lg flex items-center justify-center",children:o.jsx("svg",{className:"w-3 h-3 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),o.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:t==="monthly"?"Average/Month":"Average/Year"})]}),o.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t==="monthly"?ae.avgPerMonth.toLocaleString():ae.avgPerYear.toLocaleString()}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:t==="monthly"?"Per month average":"Per year average"})]})]})})]})]}):null}const $W=(e,t=2e3)=>{const[r,n]=G.useState(0);return G.useEffect(()=>{let a;const h=i=>{a||(a=i);const x=Math.min((i-a)/t,1),w=1-Math.pow(1-x,4),S=Math.floor(0+(e-0)*w);n(S),x<1&&requestAnimationFrame(h)};requestAnimationFrame(h)},[e,t]),r};function s$e(){var me,be,pe,Se;const[e,t]=G.useState(""),[r,n]=G.useState(!1),[a,c]=G.useState(null),[h,i]=G.useState(!1),[x,w]=G.useState(null),[S,T]=G.useState(null),[E,D]=G.useState(1),U=5,I=G.useRef(null);new Date().getFullYear(),[...Array.from({length:19},(Ee,we)=>(2005+we).toString())];const V=$W((a==null?void 0:a.totalViolations)||0),H=$W((S??(a==null?void 0:a.totalTrafficViolators))||0);G.useEffect(()=>{const Ee=we=>{I.current&&!I.current.contains(we.target)&&n(!1)};return document.addEventListener("mousedown",Ee),()=>{document.removeEventListener("mousedown",Ee)}},[]);const K=async Ee=>{var we,Pe,Me;try{i(!0),w(null);let Be=null;Ee&&Ee!=="All"&&(Be=Ee),console.log(" Fetching violation analytics with filters:",{year:Ee,yearValue:Be}),console.log(" Token in localStorage:",localStorage.getItem("token")?"Present":"Missing");const Ge=await JUe({},Be);try{const We=await XUe(),tt=(we=We==null?void 0:We.data)==null?void 0:we.totalRecords;T(typeof tt=="number"?tt:null)}catch{T(null)}if(console.log(" API Response:",Ge),console.log(" Response success:",Ge==null?void 0:Ge.success),console.log(" Response data:",Ge==null?void 0:Ge.data),Ge&&Ge.success)c(Ge.data),console.log("Analytics data set:",Ge.data),Ee&&Ee!=="All"&&Ge.data.totalViolations===0?w(`No violation data available for year ${Ee}. Please try a different year.`):w(null);else{const We=(Ge==null?void 0:Ge.message)||"Failed to fetch analytics data";w(We),console.error("API returned error:",We)}}catch(Be){console.error("Error fetching analytics data:",Be);const Ge=((Me=(Pe=Be.response)==null?void 0:Pe.data)==null?void 0:Me.message)||Be.message||"Error loading analytics data";w(Ge)}finally{i(!1)}};G.useEffect(()=>{K("All")},[]),G.useEffect(()=>{K(e||"All")},[e]);const Q=((me=a==null?void 0:a.mostCommonViolations)==null?void 0:me.length)||0,ae=Math.ceil(Q/U),ee=(E-1)*U,se=ee+U,ue=((be=a==null?void 0:a.mostCommonViolations)==null?void 0:be.slice(ee,se))||[],he=()=>{D(Ee=>Math.max(Ee-1,1))},Ce=()=>{D(Ee=>Math.min(Ee+1,ae))},Ne=Ee=>{const we=Ee.map(Pe=>Pe.toLowerCase());return we.some(Pe=>Pe.includes("no helmet"))&&we.some(Pe=>Pe.includes("no license"))?"Immediate impoundment - High risk rider without proper documentation":we.some(Pe=>Pe.includes("speeding"))&&we.some(Pe=>Pe.includes("no license"))?"Vehicle impoundment and court hearing - Reckless driving without license":we.some(Pe=>Pe.includes("no registration"))&&we.some(Pe=>Pe.includes("no license"))?"Complete documentation check and vehicle impoundment until compliance":we.some(Pe=>Pe.includes("drunk"))||we.some(Pe=>Pe.includes("alcohol"))?"Immediate arrest and breathalyzer test - Zero tolerance policy":we.some(Pe=>Pe.includes("reckless"))&&we.some(Pe=>Pe.includes("speeding"))?"License suspension and mandatory driver education program":we.some(Pe=>Pe.includes("confiscated"))||we.some(Pe=>Pe.includes("impound"))?"Severe violation - Court hearing and possible vehicle forfeiture":we.some(Pe=>Pe.includes("no license"))||we.some(Pe=>Pe.includes("no registration"))?"Documentation violation - Vehicle impoundment until proper documents provided":we.some(Pe=>Pe.includes("helmet"))||we.some(Pe=>Pe.includes("safety"))?"Safety violation - Fine and safety education requirement":we.some(Pe=>Pe.includes("speeding"))||we.some(Pe=>Pe.includes("traffic"))?"Traffic violation - Fine and license demerit points":"Standard fine and documentation review"};return o.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen rounded-lg",children:[o.jsx("div",{className:"mb-8",children:o.jsx("div",{className:"flex justify-between items-start mb-6",children:o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2 animate-in slide-in-from-top-5 fade-in duration-700",children:"Violation Analytics"}),o.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Traffic Violation Analytics Dashboard",a&&o.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",children:" Live Data"}),!a&&!h&&o.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",children:"No Data"})]})]})})}),x&&o.jsx("div",{className:"mb-4 p-4 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:x}),o.jsx("button",{onClick:()=>K(e||"All"),className:"ml-4 px-3 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors",children:"Retry"})]})}),o.jsx(QUe,{displayData:a,loading:h,totalViolations:V,totalTrafficViolators:H,topOfficer:(pe=a==null?void 0:a.topOfficers)==null?void 0:pe[0],mostCommonViolation:(Se=a==null?void 0:a.mostCommonViolations)==null?void 0:Se[0]}),o.jsx("div",{className:"mb-8",children:o.jsx(a$e,{analyticsData:a})}),o.jsx(i$e,{displayData:a,loading:h,currentViolations:ue,startIndex:ee,endIndex:se,totalViolationItems:Q,currentPage:E,totalPages:ae,handlePrevPage:he,handleNextPage:Ce,getCombinationRecommendation:Ne})]})}function o$e(){return o.jsx("div",{children:o.jsx(s$e,{})})}var IN={exports:{}},l$e=IN.exports,qW;function c$e(){return qW||(qW=1,function(e,t){(function(r,n){e.exports=n()})(l$e,function(){var r,n,a;function c(i,x){if(!r)r=x;else if(!n)n=x;else{var w="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",S={};r(S),a=x(S),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(a.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}c(["exports"],function(i){function x(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}var w,S={},T={};function E(){if(w)return T;w=1,Object.defineProperty(T,"__esModule",{value:!0}),T.setMatrixArrayType=function(v){T.ARRAY_TYPE=s=v},T.toRadian=function(v){return v*p},T.equals=function(v,m){return Math.abs(v-m)<=f*Math.max(1,Math.abs(v),Math.abs(m))},T.RANDOM=T.ARRAY_TYPE=T.EPSILON=void 0;var f=1e-6;T.EPSILON=f;var s=typeof Float32Array<"u"?Float32Array:Array;T.ARRAY_TYPE=s;var u=Math.random;T.RANDOM=u;var p=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var v=0,m=arguments.length;m--;)v+=arguments[m]*arguments[m];return Math.sqrt(v)}),T}var D,U={};function I(){if(D)return U;function f(m){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},f(m)}D=1,Object.defineProperty(U,"__esModule",{value:!0}),U.create=function(){var m=new s.ARRAY_TYPE(4);return s.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m},U.clone=function(m){var _=new s.ARRAY_TYPE(4);return _[0]=m[0],_[1]=m[1],_[2]=m[2],_[3]=m[3],_},U.copy=function(m,_){return m[0]=_[0],m[1]=_[1],m[2]=_[2],m[3]=_[3],m},U.identity=function(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=1,m},U.fromValues=function(m,_,P,O){var B=new s.ARRAY_TYPE(4);return B[0]=m,B[1]=_,B[2]=P,B[3]=O,B},U.set=function(m,_,P,O,B){return m[0]=_,m[1]=P,m[2]=O,m[3]=B,m},U.transpose=function(m,_){if(m===_){var P=_[1];m[1]=_[2],m[2]=P}else m[0]=_[0],m[1]=_[2],m[2]=_[1],m[3]=_[3];return m},U.invert=function(m,_){var P=_[0],O=_[1],B=_[2],k=_[3],R=P*k-B*O;return R?(m[0]=k*(R=1/R),m[1]=-O*R,m[2]=-B*R,m[3]=P*R,m):null},U.adjoint=function(m,_){var P=_[0];return m[0]=_[3],m[1]=-_[1],m[2]=-_[2],m[3]=P,m},U.determinant=function(m){return m[0]*m[3]-m[2]*m[1]},U.multiply=p,U.rotate=function(m,_,P){var O=_[0],B=_[1],k=_[2],R=_[3],z=Math.sin(P),M=Math.cos(P);return m[0]=O*M+k*z,m[1]=B*M+R*z,m[2]=O*-z+k*M,m[3]=B*-z+R*M,m},U.scale=function(m,_,P){var O=_[1],B=_[2],k=_[3],R=P[0],z=P[1];return m[0]=_[0]*R,m[1]=O*R,m[2]=B*z,m[3]=k*z,m},U.fromRotation=function(m,_){var P=Math.sin(_),O=Math.cos(_);return m[0]=O,m[1]=P,m[2]=-P,m[3]=O,m},U.fromScaling=function(m,_){return m[0]=_[0],m[1]=0,m[2]=0,m[3]=_[1],m},U.str=function(m){return"mat2("+m[0]+", "+m[1]+", "+m[2]+", "+m[3]+")"},U.frob=function(m){return Math.hypot(m[0],m[1],m[2],m[3])},U.LDU=function(m,_,P,O){return m[2]=O[2]/O[0],P[0]=O[0],P[1]=O[1],P[3]=O[3]-m[2]*P[1],[m,_,P]},U.add=function(m,_,P){return m[0]=_[0]+P[0],m[1]=_[1]+P[1],m[2]=_[2]+P[2],m[3]=_[3]+P[3],m},U.subtract=v,U.exactEquals=function(m,_){return m[0]===_[0]&&m[1]===_[1]&&m[2]===_[2]&&m[3]===_[3]},U.equals=function(m,_){var P=m[0],O=m[1],B=m[2],k=m[3],R=_[0],z=_[1],M=_[2],L=_[3];return Math.abs(P-R)<=s.EPSILON*Math.max(1,Math.abs(P),Math.abs(R))&&Math.abs(O-z)<=s.EPSILON*Math.max(1,Math.abs(O),Math.abs(z))&&Math.abs(B-M)<=s.EPSILON*Math.max(1,Math.abs(B),Math.abs(M))&&Math.abs(k-L)<=s.EPSILON*Math.max(1,Math.abs(k),Math.abs(L))},U.multiplyScalar=function(m,_,P){return m[0]=_[0]*P,m[1]=_[1]*P,m[2]=_[2]*P,m[3]=_[3]*P,m},U.multiplyScalarAndAdd=function(m,_,P,O){return m[0]=_[0]+P[0]*O,m[1]=_[1]+P[1]*O,m[2]=_[2]+P[2]*O,m[3]=_[3]+P[3]*O,m},U.sub=U.mul=void 0;var s=function(m,_){if(m&&m.__esModule)return m;if(m===null||f(m)!=="object"&&typeof m!="function")return{default:m};var P=u(void 0);if(P&&P.has(m))return P.get(m);var O={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var k in m)if(k!=="default"&&Object.prototype.hasOwnProperty.call(m,k)){var R=B?Object.getOwnPropertyDescriptor(m,k):null;R&&(R.get||R.set)?Object.defineProperty(O,k,R):O[k]=m[k]}return O.default=m,P&&P.set(m,O),O}(E());function u(m){if(typeof WeakMap!="function")return null;var _=new WeakMap,P=new WeakMap;return(u=function(O){return O?P:_})(m)}function p(m,_,P){var O=_[0],B=_[1],k=_[2],R=_[3],z=P[0],M=P[1],L=P[2],q=P[3];return m[0]=O*z+k*M,m[1]=B*z+R*M,m[2]=O*L+k*q,m[3]=B*L+R*q,m}function v(m,_,P){return m[0]=_[0]-P[0],m[1]=_[1]-P[1],m[2]=_[2]-P[2],m[3]=_[3]-P[3],m}return U.mul=p,U.sub=v,U}var V,H={};function K(){if(V)return H;function f(m){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},f(m)}V=1,Object.defineProperty(H,"__esModule",{value:!0}),H.create=function(){var m=new s.ARRAY_TYPE(6);return s.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0,m[4]=0,m[5]=0),m[0]=1,m[3]=1,m},H.clone=function(m){var _=new s.ARRAY_TYPE(6);return _[0]=m[0],_[1]=m[1],_[2]=m[2],_[3]=m[3],_[4]=m[4],_[5]=m[5],_},H.copy=function(m,_){return m[0]=_[0],m[1]=_[1],m[2]=_[2],m[3]=_[3],m[4]=_[4],m[5]=_[5],m},H.identity=function(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=1,m[4]=0,m[5]=0,m},H.fromValues=function(m,_,P,O,B,k){var R=new s.ARRAY_TYPE(6);return R[0]=m,R[1]=_,R[2]=P,R[3]=O,R[4]=B,R[5]=k,R},H.set=function(m,_,P,O,B,k,R){return m[0]=_,m[1]=P,m[2]=O,m[3]=B,m[4]=k,m[5]=R,m},H.invert=function(m,_){var P=_[0],O=_[1],B=_[2],k=_[3],R=_[4],z=_[5],M=P*k-O*B;return M?(m[0]=k*(M=1/M),m[1]=-O*M,m[2]=-B*M,m[3]=P*M,m[4]=(B*z-k*R)*M,m[5]=(O*R-P*z)*M,m):null},H.determinant=function(m){return m[0]*m[3]-m[1]*m[2]},H.multiply=p,H.rotate=function(m,_,P){var O=_[0],B=_[1],k=_[2],R=_[3],z=_[4],M=_[5],L=Math.sin(P),q=Math.cos(P);return m[0]=O*q+k*L,m[1]=B*q+R*L,m[2]=O*-L+k*q,m[3]=B*-L+R*q,m[4]=z,m[5]=M,m},H.scale=function(m,_,P){var O=_[1],B=_[2],k=_[3],R=_[4],z=_[5],M=P[0],L=P[1];return m[0]=_[0]*M,m[1]=O*M,m[2]=B*L,m[3]=k*L,m[4]=R,m[5]=z,m},H.translate=function(m,_,P){var O=_[0],B=_[1],k=_[2],R=_[3],z=_[4],M=_[5],L=P[0],q=P[1];return m[0]=O,m[1]=B,m[2]=k,m[3]=R,m[4]=O*L+k*q+z,m[5]=B*L+R*q+M,m},H.fromRotation=function(m,_){var P=Math.sin(_),O=Math.cos(_);return m[0]=O,m[1]=P,m[2]=-P,m[3]=O,m[4]=0,m[5]=0,m},H.fromScaling=function(m,_){return m[0]=_[0],m[1]=0,m[2]=0,m[3]=_[1],m[4]=0,m[5]=0,m},H.fromTranslation=function(m,_){return m[0]=1,m[1]=0,m[2]=0,m[3]=1,m[4]=_[0],m[5]=_[1],m},H.str=function(m){return"mat2d("+m[0]+", "+m[1]+", "+m[2]+", "+m[3]+", "+m[4]+", "+m[5]+")"},H.frob=function(m){return Math.hypot(m[0],m[1],m[2],m[3],m[4],m[5],1)},H.add=function(m,_,P){return m[0]=_[0]+P[0],m[1]=_[1]+P[1],m[2]=_[2]+P[2],m[3]=_[3]+P[3],m[4]=_[4]+P[4],m[5]=_[5]+P[5],m},H.subtract=v,H.multiplyScalar=function(m,_,P){return m[0]=_[0]*P,m[1]=_[1]*P,m[2]=_[2]*P,m[3]=_[3]*P,m[4]=_[4]*P,m[5]=_[5]*P,m},H.multiplyScalarAndAdd=function(m,_,P,O){return m[0]=_[0]+P[0]*O,m[1]=_[1]+P[1]*O,m[2]=_[2]+P[2]*O,m[3]=_[3]+P[3]*O,m[4]=_[4]+P[4]*O,m[5]=_[5]+P[5]*O,m},H.exactEquals=function(m,_){return m[0]===_[0]&&m[1]===_[1]&&m[2]===_[2]&&m[3]===_[3]&&m[4]===_[4]&&m[5]===_[5]},H.equals=function(m,_){var P=m[0],O=m[1],B=m[2],k=m[3],R=m[4],z=m[5],M=_[0],L=_[1],q=_[2],X=_[3],te=_[4],le=_[5];return Math.abs(P-M)<=s.EPSILON*Math.max(1,Math.abs(P),Math.abs(M))&&Math.abs(O-L)<=s.EPSILON*Math.max(1,Math.abs(O),Math.abs(L))&&Math.abs(B-q)<=s.EPSILON*Math.max(1,Math.abs(B),Math.abs(q))&&Math.abs(k-X)<=s.EPSILON*Math.max(1,Math.abs(k),Math.abs(X))&&Math.abs(R-te)<=s.EPSILON*Math.max(1,Math.abs(R),Math.abs(te))&&Math.abs(z-le)<=s.EPSILON*Math.max(1,Math.abs(z),Math.abs(le))},H.sub=H.mul=void 0;var s=function(m,_){if(m&&m.__esModule)return m;if(m===null||f(m)!=="object"&&typeof m!="function")return{default:m};var P=u(void 0);if(P&&P.has(m))return P.get(m);var O={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var k in m)if(k!=="default"&&Object.prototype.hasOwnProperty.call(m,k)){var R=B?Object.getOwnPropertyDescriptor(m,k):null;R&&(R.get||R.set)?Object.defineProperty(O,k,R):O[k]=m[k]}return O.default=m,P&&P.set(m,O),O}(E());function u(m){if(typeof WeakMap!="function")return null;var _=new WeakMap,P=new WeakMap;return(u=function(O){return O?P:_})(m)}function p(m,_,P){var O=_[0],B=_[1],k=_[2],R=_[3],z=_[4],M=_[5],L=P[0],q=P[1],X=P[2],te=P[3],le=P[4],ce=P[5];return m[0]=O*L+k*q,m[1]=B*L+R*q,m[2]=O*X+k*te,m[3]=B*X+R*te,m[4]=O*le+k*ce+z,m[5]=B*le+R*ce+M,m}function v(m,_,P){return m[0]=_[0]-P[0],m[1]=_[1]-P[1],m[2]=_[2]-P[2],m[3]=_[3]-P[3],m[4]=_[4]-P[4],m[5]=_[5]-P[5],m}return H.mul=p,H.sub=v,H}var Q,ae={};function ee(){if(Q)return ae;function f(m){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},f(m)}Q=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.create=function(){var m=new s.ARRAY_TYPE(9);return s.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0,m[3]=0,m[5]=0,m[6]=0,m[7]=0),m[0]=1,m[4]=1,m[8]=1,m},ae.fromMat4=function(m,_){return m[0]=_[0],m[1]=_[1],m[2]=_[2],m[3]=_[4],m[4]=_[5],m[5]=_[6],m[6]=_[8],m[7]=_[9],m[8]=_[10],m},ae.clone=function(m){var _=new s.ARRAY_TYPE(9);return _[0]=m[0],_[1]=m[1],_[2]=m[2],_[3]=m[3],_[4]=m[4],_[5]=m[5],_[6]=m[6],_[7]=m[7],_[8]=m[8],_},ae.copy=function(m,_){return m[0]=_[0],m[1]=_[1],m[2]=_[2],m[3]=_[3],m[4]=_[4],m[5]=_[5],m[6]=_[6],m[7]=_[7],m[8]=_[8],m},ae.fromValues=function(m,_,P,O,B,k,R,z,M){var L=new s.ARRAY_TYPE(9);return L[0]=m,L[1]=_,L[2]=P,L[3]=O,L[4]=B,L[5]=k,L[6]=R,L[7]=z,L[8]=M,L},ae.set=function(m,_,P,O,B,k,R,z,M,L){return m[0]=_,m[1]=P,m[2]=O,m[3]=B,m[4]=k,m[5]=R,m[6]=z,m[7]=M,m[8]=L,m},ae.identity=function(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=1,m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},ae.transpose=function(m,_){if(m===_){var P=_[1],O=_[2],B=_[5];m[1]=_[3],m[2]=_[6],m[3]=P,m[5]=_[7],m[6]=O,m[7]=B}else m[0]=_[0],m[1]=_[3],m[2]=_[6],m[3]=_[1],m[4]=_[4],m[5]=_[7],m[6]=_[2],m[7]=_[5],m[8]=_[8];return m},ae.invert=function(m,_){var P=_[0],O=_[1],B=_[2],k=_[3],R=_[4],z=_[5],M=_[6],L=_[7],q=_[8],X=q*R-z*L,te=-q*k+z*M,le=L*k-R*M,ce=P*X+O*te+B*le;return ce?(m[0]=X*(ce=1/ce),m[1]=(-q*O+B*L)*ce,m[2]=(z*O-B*R)*ce,m[3]=te*ce,m[4]=(q*P-B*M)*ce,m[5]=(-z*P+B*k)*ce,m[6]=le*ce,m[7]=(-L*P+O*M)*ce,m[8]=(R*P-O*k)*ce,m):null},ae.adjoint=function(m,_){var P=_[0],O=_[1],B=_[2],k=_[3],R=_[4],z=_[5],M=_[6],L=_[7],q=_[8];return m[0]=R*q-z*L,m[1]=B*L-O*q,m[2]=O*z-B*R,m[3]=z*M-k*q,m[4]=P*q-B*M,m[5]=B*k-P*z,m[6]=k*L-R*M,m[7]=O*M-P*L,m[8]=P*R-O*k,m},ae.determinant=function(m){var _=m[3],P=m[4],O=m[5],B=m[6],k=m[7],R=m[8];return m[0]*(R*P-O*k)+m[1]*(-R*_+O*B)+m[2]*(k*_-P*B)},ae.multiply=p,ae.translate=function(m,_,P){var O=_[0],B=_[1],k=_[2],R=_[3],z=_[4],M=_[5],L=_[6],q=_[7],X=_[8],te=P[0],le=P[1];return m[0]=O,m[1]=B,m[2]=k,m[3]=R,m[4]=z,m[5]=M,m[6]=te*O+le*R+L,m[7]=te*B+le*z+q,m[8]=te*k+le*M+X,m},ae.rotate=function(m,_,P){var O=_[0],B=_[1],k=_[2],R=_[3],z=_[4],M=_[5],L=_[6],q=_[7],X=_[8],te=Math.sin(P),le=Math.cos(P);return m[0]=le*O+te*R,m[1]=le*B+te*z,m[2]=le*k+te*M,m[3]=le*R-te*O,m[4]=le*z-te*B,m[5]=le*M-te*k,m[6]=L,m[7]=q,m[8]=X,m},ae.scale=function(m,_,P){var O=P[0],B=P[1];return m[0]=O*_[0],m[1]=O*_[1],m[2]=O*_[2],m[3]=B*_[3],m[4]=B*_[4],m[5]=B*_[5],m[6]=_[6],m[7]=_[7],m[8]=_[8],m},ae.fromTranslation=function(m,_){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=1,m[5]=0,m[6]=_[0],m[7]=_[1],m[8]=1,m},ae.fromRotation=function(m,_){var P=Math.sin(_),O=Math.cos(_);return m[0]=O,m[1]=P,m[2]=0,m[3]=-P,m[4]=O,m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},ae.fromScaling=function(m,_){return m[0]=_[0],m[1]=0,m[2]=0,m[3]=0,m[4]=_[1],m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},ae.fromMat2d=function(m,_){return m[0]=_[0],m[1]=_[1],m[2]=0,m[3]=_[2],m[4]=_[3],m[5]=0,m[6]=_[4],m[7]=_[5],m[8]=1,m},ae.fromQuat=function(m,_){var P=_[0],O=_[1],B=_[2],k=_[3],R=P+P,z=O+O,M=B+B,L=P*R,q=O*R,X=O*z,te=B*R,le=B*z,ce=B*M,ie=k*R,fe=k*z,xe=k*M;return m[0]=1-X-ce,m[3]=q-xe,m[6]=te+fe,m[1]=q+xe,m[4]=1-L-ce,m[7]=le-ie,m[2]=te-fe,m[5]=le+ie,m[8]=1-L-X,m},ae.normalFromMat4=function(m,_){var P=_[0],O=_[1],B=_[2],k=_[3],R=_[4],z=_[5],M=_[6],L=_[7],q=_[8],X=_[9],te=_[10],le=_[11],ce=_[12],ie=_[13],fe=_[14],xe=_[15],je=P*z-O*R,Fe=P*M-B*R,De=P*L-k*R,Ie=O*M-B*z,et=O*L-k*z,Ve=B*L-k*M,rt=q*ie-X*ce,ot=q*fe-te*ce,it=q*xe-le*ce,ct=X*fe-te*ie,ft=X*xe-le*ie,xt=te*xe-le*fe,ut=je*xt-Fe*ft+De*ct+Ie*it-et*ot+Ve*rt;return ut?(m[0]=(z*xt-M*ft+L*ct)*(ut=1/ut),m[1]=(M*it-R*xt-L*ot)*ut,m[2]=(R*ft-z*it+L*rt)*ut,m[3]=(B*ft-O*xt-k*ct)*ut,m[4]=(P*xt-B*it+k*ot)*ut,m[5]=(O*it-P*ft-k*rt)*ut,m[6]=(ie*Ve-fe*et+xe*Ie)*ut,m[7]=(fe*De-ce*Ve-xe*Fe)*ut,m[8]=(ce*et-ie*De+xe*je)*ut,m):null},ae.projection=function(m,_,P){return m[0]=2/_,m[1]=0,m[2]=0,m[3]=0,m[4]=-2/P,m[5]=0,m[6]=-1,m[7]=1,m[8]=1,m},ae.str=function(m){return"mat3("+m[0]+", "+m[1]+", "+m[2]+", "+m[3]+", "+m[4]+", "+m[5]+", "+m[6]+", "+m[7]+", "+m[8]+")"},ae.frob=function(m){return Math.hypot(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8])},ae.add=function(m,_,P){return m[0]=_[0]+P[0],m[1]=_[1]+P[1],m[2]=_[2]+P[2],m[3]=_[3]+P[3],m[4]=_[4]+P[4],m[5]=_[5]+P[5],m[6]=_[6]+P[6],m[7]=_[7]+P[7],m[8]=_[8]+P[8],m},ae.subtract=v,ae.multiplyScalar=function(m,_,P){return m[0]=_[0]*P,m[1]=_[1]*P,m[2]=_[2]*P,m[3]=_[3]*P,m[4]=_[4]*P,m[5]=_[5]*P,m[6]=_[6]*P,m[7]=_[7]*P,m[8]=_[8]*P,m},ae.multiplyScalarAndAdd=function(m,_,P,O){return m[0]=_[0]+P[0]*O,m[1]=_[1]+P[1]*O,m[2]=_[2]+P[2]*O,m[3]=_[3]+P[3]*O,m[4]=_[4]+P[4]*O,m[5]=_[5]+P[5]*O,m[6]=_[6]+P[6]*O,m[7]=_[7]+P[7]*O,m[8]=_[8]+P[8]*O,m},ae.exactEquals=function(m,_){return m[0]===_[0]&&m[1]===_[1]&&m[2]===_[2]&&m[3]===_[3]&&m[4]===_[4]&&m[5]===_[5]&&m[6]===_[6]&&m[7]===_[7]&&m[8]===_[8]},ae.equals=function(m,_){var P=m[0],O=m[1],B=m[2],k=m[3],R=m[4],z=m[5],M=m[6],L=m[7],q=m[8],X=_[0],te=_[1],le=_[2],ce=_[3],ie=_[4],fe=_[5],xe=_[6],je=_[7],Fe=_[8];return Math.abs(P-X)<=s.EPSILON*Math.max(1,Math.abs(P),Math.abs(X))&&Math.abs(O-te)<=s.EPSILON*Math.max(1,Math.abs(O),Math.abs(te))&&Math.abs(B-le)<=s.EPSILON*Math.max(1,Math.abs(B),Math.abs(le))&&Math.abs(k-ce)<=s.EPSILON*Math.max(1,Math.abs(k),Math.abs(ce))&&Math.abs(R-ie)<=s.EPSILON*Math.max(1,Math.abs(R),Math.abs(ie))&&Math.abs(z-fe)<=s.EPSILON*Math.max(1,Math.abs(z),Math.abs(fe))&&Math.abs(M-xe)<=s.EPSILON*Math.max(1,Math.abs(M),Math.abs(xe))&&Math.abs(L-je)<=s.EPSILON*Math.max(1,Math.abs(L),Math.abs(je))&&Math.abs(q-Fe)<=s.EPSILON*Math.max(1,Math.abs(q),Math.abs(Fe))},ae.sub=ae.mul=void 0;var s=function(m,_){if(m&&m.__esModule)return m;if(m===null||f(m)!=="object"&&typeof m!="function")return{default:m};var P=u(void 0);if(P&&P.has(m))return P.get(m);var O={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var k in m)if(k!=="default"&&Object.prototype.hasOwnProperty.call(m,k)){var R=B?Object.getOwnPropertyDescriptor(m,k):null;R&&(R.get||R.set)?Object.defineProperty(O,k,R):O[k]=m[k]}return O.default=m,P&&P.set(m,O),O}(E());function u(m){if(typeof WeakMap!="function")return null;var _=new WeakMap,P=new WeakMap;return(u=function(O){return O?P:_})(m)}function p(m,_,P){var O=_[0],B=_[1],k=_[2],R=_[3],z=_[4],M=_[5],L=_[6],q=_[7],X=_[8],te=P[0],le=P[1],ce=P[2],ie=P[3],fe=P[4],xe=P[5],je=P[6],Fe=P[7],De=P[8];return m[0]=te*O+le*R+ce*L,m[1]=te*B+le*z+ce*q,m[2]=te*k+le*M+ce*X,m[3]=ie*O+fe*R+xe*L,m[4]=ie*B+fe*z+xe*q,m[5]=ie*k+fe*M+xe*X,m[6]=je*O+Fe*R+De*L,m[7]=je*B+Fe*z+De*q,m[8]=je*k+Fe*M+De*X,m}function v(m,_,P){return m[0]=_[0]-P[0],m[1]=_[1]-P[1],m[2]=_[2]-P[2],m[3]=_[3]-P[3],m[4]=_[4]-P[4],m[5]=_[5]-P[5],m[6]=_[6]-P[6],m[7]=_[7]-P[7],m[8]=_[8]-P[8],m}return ae.mul=p,ae.sub=v,ae}var se,ue={};function he(){if(se)return ue;function f(k){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},f(k)}se=1,Object.defineProperty(ue,"__esModule",{value:!0}),ue.create=function(){var k=new s.ARRAY_TYPE(16);return s.ARRAY_TYPE!=Float32Array&&(k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[11]=0,k[12]=0,k[13]=0,k[14]=0),k[0]=1,k[5]=1,k[10]=1,k[15]=1,k},ue.clone=function(k){var R=new s.ARRAY_TYPE(16);return R[0]=k[0],R[1]=k[1],R[2]=k[2],R[3]=k[3],R[4]=k[4],R[5]=k[5],R[6]=k[6],R[7]=k[7],R[8]=k[8],R[9]=k[9],R[10]=k[10],R[11]=k[11],R[12]=k[12],R[13]=k[13],R[14]=k[14],R[15]=k[15],R},ue.copy=function(k,R){return k[0]=R[0],k[1]=R[1],k[2]=R[2],k[3]=R[3],k[4]=R[4],k[5]=R[5],k[6]=R[6],k[7]=R[7],k[8]=R[8],k[9]=R[9],k[10]=R[10],k[11]=R[11],k[12]=R[12],k[13]=R[13],k[14]=R[14],k[15]=R[15],k},ue.fromValues=function(k,R,z,M,L,q,X,te,le,ce,ie,fe,xe,je,Fe,De){var Ie=new s.ARRAY_TYPE(16);return Ie[0]=k,Ie[1]=R,Ie[2]=z,Ie[3]=M,Ie[4]=L,Ie[5]=q,Ie[6]=X,Ie[7]=te,Ie[8]=le,Ie[9]=ce,Ie[10]=ie,Ie[11]=fe,Ie[12]=xe,Ie[13]=je,Ie[14]=Fe,Ie[15]=De,Ie},ue.set=function(k,R,z,M,L,q,X,te,le,ce,ie,fe,xe,je,Fe,De,Ie){return k[0]=R,k[1]=z,k[2]=M,k[3]=L,k[4]=q,k[5]=X,k[6]=te,k[7]=le,k[8]=ce,k[9]=ie,k[10]=fe,k[11]=xe,k[12]=je,k[13]=Fe,k[14]=De,k[15]=Ie,k},ue.identity=p,ue.transpose=function(k,R){if(k===R){var z=R[1],M=R[2],L=R[3],q=R[6],X=R[7],te=R[11];k[1]=R[4],k[2]=R[8],k[3]=R[12],k[4]=z,k[6]=R[9],k[7]=R[13],k[8]=M,k[9]=q,k[11]=R[14],k[12]=L,k[13]=X,k[14]=te}else k[0]=R[0],k[1]=R[4],k[2]=R[8],k[3]=R[12],k[4]=R[1],k[5]=R[5],k[6]=R[9],k[7]=R[13],k[8]=R[2],k[9]=R[6],k[10]=R[10],k[11]=R[14],k[12]=R[3],k[13]=R[7],k[14]=R[11],k[15]=R[15];return k},ue.invert=function(k,R){var z=R[0],M=R[1],L=R[2],q=R[3],X=R[4],te=R[5],le=R[6],ce=R[7],ie=R[8],fe=R[9],xe=R[10],je=R[11],Fe=R[12],De=R[13],Ie=R[14],et=R[15],Ve=z*te-M*X,rt=z*le-L*X,ot=z*ce-q*X,it=M*le-L*te,ct=M*ce-q*te,ft=L*ce-q*le,xt=ie*De-fe*Fe,ut=ie*Ie-xe*Fe,Mt=ie*et-je*Fe,qt=fe*Ie-xe*De,Et=fe*et-je*De,fr=xe*et-je*Ie,lr=Ve*fr-rt*Et+ot*qt+it*Mt-ct*ut+ft*xt;return lr?(k[0]=(te*fr-le*Et+ce*qt)*(lr=1/lr),k[1]=(L*Et-M*fr-q*qt)*lr,k[2]=(De*ft-Ie*ct+et*it)*lr,k[3]=(xe*ct-fe*ft-je*it)*lr,k[4]=(le*Mt-X*fr-ce*ut)*lr,k[5]=(z*fr-L*Mt+q*ut)*lr,k[6]=(Ie*ot-Fe*ft-et*rt)*lr,k[7]=(ie*ft-xe*ot+je*rt)*lr,k[8]=(X*Et-te*Mt+ce*xt)*lr,k[9]=(M*Mt-z*Et-q*xt)*lr,k[10]=(Fe*ct-De*ot+et*Ve)*lr,k[11]=(fe*ot-ie*ct-je*Ve)*lr,k[12]=(te*ut-X*qt-le*xt)*lr,k[13]=(z*qt-M*ut+L*xt)*lr,k[14]=(De*rt-Fe*it-Ie*Ve)*lr,k[15]=(ie*it-fe*rt+xe*Ve)*lr,k):null},ue.adjoint=function(k,R){var z=R[0],M=R[1],L=R[2],q=R[3],X=R[4],te=R[5],le=R[6],ce=R[7],ie=R[8],fe=R[9],xe=R[10],je=R[11],Fe=R[12],De=R[13],Ie=R[14],et=R[15];return k[0]=te*(xe*et-je*Ie)-fe*(le*et-ce*Ie)+De*(le*je-ce*xe),k[1]=-(M*(xe*et-je*Ie)-fe*(L*et-q*Ie)+De*(L*je-q*xe)),k[2]=M*(le*et-ce*Ie)-te*(L*et-q*Ie)+De*(L*ce-q*le),k[3]=-(M*(le*je-ce*xe)-te*(L*je-q*xe)+fe*(L*ce-q*le)),k[4]=-(X*(xe*et-je*Ie)-ie*(le*et-ce*Ie)+Fe*(le*je-ce*xe)),k[5]=z*(xe*et-je*Ie)-ie*(L*et-q*Ie)+Fe*(L*je-q*xe),k[6]=-(z*(le*et-ce*Ie)-X*(L*et-q*Ie)+Fe*(L*ce-q*le)),k[7]=z*(le*je-ce*xe)-X*(L*je-q*xe)+ie*(L*ce-q*le),k[8]=X*(fe*et-je*De)-ie*(te*et-ce*De)+Fe*(te*je-ce*fe),k[9]=-(z*(fe*et-je*De)-ie*(M*et-q*De)+Fe*(M*je-q*fe)),k[10]=z*(te*et-ce*De)-X*(M*et-q*De)+Fe*(M*ce-q*te),k[11]=-(z*(te*je-ce*fe)-X*(M*je-q*fe)+ie*(M*ce-q*te)),k[12]=-(X*(fe*Ie-xe*De)-ie*(te*Ie-le*De)+Fe*(te*xe-le*fe)),k[13]=z*(fe*Ie-xe*De)-ie*(M*Ie-L*De)+Fe*(M*xe-L*fe),k[14]=-(z*(te*Ie-le*De)-X*(M*Ie-L*De)+Fe*(M*le-L*te)),k[15]=z*(te*xe-le*fe)-X*(M*xe-L*fe)+ie*(M*le-L*te),k},ue.determinant=function(k){var R=k[0],z=k[1],M=k[2],L=k[3],q=k[4],X=k[5],te=k[6],le=k[7],ce=k[8],ie=k[9],fe=k[10],xe=k[11],je=k[12],Fe=k[13],De=k[14],Ie=k[15];return(R*X-z*q)*(fe*Ie-xe*De)-(R*te-M*q)*(ie*Ie-xe*Fe)+(R*le-L*q)*(ie*De-fe*Fe)+(z*te-M*X)*(ce*Ie-xe*je)-(z*le-L*X)*(ce*De-fe*je)+(M*le-L*te)*(ce*Fe-ie*je)},ue.multiply=v,ue.translate=function(k,R,z){var M,L,q,X,te,le,ce,ie,fe,xe,je,Fe,De=z[0],Ie=z[1],et=z[2];return R===k?(k[12]=R[0]*De+R[4]*Ie+R[8]*et+R[12],k[13]=R[1]*De+R[5]*Ie+R[9]*et+R[13],k[14]=R[2]*De+R[6]*Ie+R[10]*et+R[14],k[15]=R[3]*De+R[7]*Ie+R[11]*et+R[15]):(L=R[1],q=R[2],X=R[3],te=R[4],le=R[5],ce=R[6],ie=R[7],fe=R[8],xe=R[9],je=R[10],Fe=R[11],k[0]=M=R[0],k[1]=L,k[2]=q,k[3]=X,k[4]=te,k[5]=le,k[6]=ce,k[7]=ie,k[8]=fe,k[9]=xe,k[10]=je,k[11]=Fe,k[12]=M*De+te*Ie+fe*et+R[12],k[13]=L*De+le*Ie+xe*et+R[13],k[14]=q*De+ce*Ie+je*et+R[14],k[15]=X*De+ie*Ie+Fe*et+R[15]),k},ue.scale=function(k,R,z){var M=z[0],L=z[1],q=z[2];return k[0]=R[0]*M,k[1]=R[1]*M,k[2]=R[2]*M,k[3]=R[3]*M,k[4]=R[4]*L,k[5]=R[5]*L,k[6]=R[6]*L,k[7]=R[7]*L,k[8]=R[8]*q,k[9]=R[9]*q,k[10]=R[10]*q,k[11]=R[11]*q,k[12]=R[12],k[13]=R[13],k[14]=R[14],k[15]=R[15],k},ue.rotate=function(k,R,z,M){var L,q,X,te,le,ce,ie,fe,xe,je,Fe,De,Ie,et,Ve,rt,ot,it,ct,ft,xt,ut,Mt,qt,Et=M[0],fr=M[1],lr=M[2],Qt=Math.hypot(Et,fr,lr);return Qt<s.EPSILON?null:(Et*=Qt=1/Qt,fr*=Qt,lr*=Qt,L=Math.sin(z),q=Math.cos(z),le=R[1],ce=R[2],ie=R[3],xe=R[5],je=R[6],Fe=R[7],Ie=R[9],et=R[10],Ve=R[11],rt=Et*Et*(X=1-q)+q,ct=Et*fr*X-lr*L,ft=fr*fr*X+q,xt=lr*fr*X+Et*L,ut=Et*lr*X+fr*L,Mt=fr*lr*X-Et*L,qt=lr*lr*X+q,k[0]=(te=R[0])*rt+(fe=R[4])*(ot=fr*Et*X+lr*L)+(De=R[8])*(it=lr*Et*X-fr*L),k[1]=le*rt+xe*ot+Ie*it,k[2]=ce*rt+je*ot+et*it,k[3]=ie*rt+Fe*ot+Ve*it,k[4]=te*ct+fe*ft+De*xt,k[5]=le*ct+xe*ft+Ie*xt,k[6]=ce*ct+je*ft+et*xt,k[7]=ie*ct+Fe*ft+Ve*xt,k[8]=te*ut+fe*Mt+De*qt,k[9]=le*ut+xe*Mt+Ie*qt,k[10]=ce*ut+je*Mt+et*qt,k[11]=ie*ut+Fe*Mt+Ve*qt,R!==k&&(k[12]=R[12],k[13]=R[13],k[14]=R[14],k[15]=R[15]),k)},ue.rotateX=function(k,R,z){var M=Math.sin(z),L=Math.cos(z),q=R[4],X=R[5],te=R[6],le=R[7],ce=R[8],ie=R[9],fe=R[10],xe=R[11];return R!==k&&(k[0]=R[0],k[1]=R[1],k[2]=R[2],k[3]=R[3],k[12]=R[12],k[13]=R[13],k[14]=R[14],k[15]=R[15]),k[4]=q*L+ce*M,k[5]=X*L+ie*M,k[6]=te*L+fe*M,k[7]=le*L+xe*M,k[8]=ce*L-q*M,k[9]=ie*L-X*M,k[10]=fe*L-te*M,k[11]=xe*L-le*M,k},ue.rotateY=function(k,R,z){var M=Math.sin(z),L=Math.cos(z),q=R[0],X=R[1],te=R[2],le=R[3],ce=R[8],ie=R[9],fe=R[10],xe=R[11];return R!==k&&(k[4]=R[4],k[5]=R[5],k[6]=R[6],k[7]=R[7],k[12]=R[12],k[13]=R[13],k[14]=R[14],k[15]=R[15]),k[0]=q*L-ce*M,k[1]=X*L-ie*M,k[2]=te*L-fe*M,k[3]=le*L-xe*M,k[8]=q*M+ce*L,k[9]=X*M+ie*L,k[10]=te*M+fe*L,k[11]=le*M+xe*L,k},ue.rotateZ=function(k,R,z){var M=Math.sin(z),L=Math.cos(z),q=R[0],X=R[1],te=R[2],le=R[3],ce=R[4],ie=R[5],fe=R[6],xe=R[7];return R!==k&&(k[8]=R[8],k[9]=R[9],k[10]=R[10],k[11]=R[11],k[12]=R[12],k[13]=R[13],k[14]=R[14],k[15]=R[15]),k[0]=q*L+ce*M,k[1]=X*L+ie*M,k[2]=te*L+fe*M,k[3]=le*L+xe*M,k[4]=ce*L-q*M,k[5]=ie*L-X*M,k[6]=fe*L-te*M,k[7]=xe*L-le*M,k},ue.fromTranslation=function(k,R){return k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=1,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=1,k[11]=0,k[12]=R[0],k[13]=R[1],k[14]=R[2],k[15]=1,k},ue.fromScaling=function(k,R){return k[0]=R[0],k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=R[1],k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=R[2],k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k},ue.fromRotation=function(k,R,z){var M,L,q,X=z[0],te=z[1],le=z[2],ce=Math.hypot(X,te,le);return ce<s.EPSILON?null:(X*=ce=1/ce,te*=ce,le*=ce,M=Math.sin(R),L=Math.cos(R),k[0]=X*X*(q=1-L)+L,k[1]=te*X*q+le*M,k[2]=le*X*q-te*M,k[3]=0,k[4]=X*te*q-le*M,k[5]=te*te*q+L,k[6]=le*te*q+X*M,k[7]=0,k[8]=X*le*q+te*M,k[9]=te*le*q-X*M,k[10]=le*le*q+L,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k)},ue.fromXRotation=function(k,R){var z=Math.sin(R),M=Math.cos(R);return k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=M,k[6]=z,k[7]=0,k[8]=0,k[9]=-z,k[10]=M,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k},ue.fromYRotation=function(k,R){var z=Math.sin(R),M=Math.cos(R);return k[0]=M,k[1]=0,k[2]=-z,k[3]=0,k[4]=0,k[5]=1,k[6]=0,k[7]=0,k[8]=z,k[9]=0,k[10]=M,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k},ue.fromZRotation=function(k,R){var z=Math.sin(R),M=Math.cos(R);return k[0]=M,k[1]=z,k[2]=0,k[3]=0,k[4]=-z,k[5]=M,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=1,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k},ue.fromRotationTranslation=m,ue.fromQuat2=function(k,R){var z=new s.ARRAY_TYPE(3),M=-R[0],L=-R[1],q=-R[2],X=R[3],te=R[4],le=R[5],ce=R[6],ie=R[7],fe=M*M+L*L+q*q+X*X;return fe>0?(z[0]=2*(te*X+ie*M+le*q-ce*L)/fe,z[1]=2*(le*X+ie*L+ce*M-te*q)/fe,z[2]=2*(ce*X+ie*q+te*L-le*M)/fe):(z[0]=2*(te*X+ie*M+le*q-ce*L),z[1]=2*(le*X+ie*L+ce*M-te*q),z[2]=2*(ce*X+ie*q+te*L-le*M)),m(k,R,z),k},ue.getTranslation=function(k,R){return k[0]=R[12],k[1]=R[13],k[2]=R[14],k},ue.getScaling=_,ue.getRotation=function(k,R){var z=new s.ARRAY_TYPE(3);_(z,R);var M=1/z[0],L=1/z[1],q=1/z[2],X=R[0]*M,te=R[1]*L,le=R[2]*q,ce=R[4]*M,ie=R[5]*L,fe=R[6]*q,xe=R[8]*M,je=R[9]*L,Fe=R[10]*q,De=X+ie+Fe,Ie=0;return De>0?(Ie=2*Math.sqrt(De+1),k[3]=.25*Ie,k[0]=(fe-je)/Ie,k[1]=(xe-le)/Ie,k[2]=(te-ce)/Ie):X>ie&&X>Fe?(Ie=2*Math.sqrt(1+X-ie-Fe),k[3]=(fe-je)/Ie,k[0]=.25*Ie,k[1]=(te+ce)/Ie,k[2]=(xe+le)/Ie):ie>Fe?(Ie=2*Math.sqrt(1+ie-X-Fe),k[3]=(xe-le)/Ie,k[0]=(te+ce)/Ie,k[1]=.25*Ie,k[2]=(fe+je)/Ie):(Ie=2*Math.sqrt(1+Fe-X-ie),k[3]=(te-ce)/Ie,k[0]=(xe+le)/Ie,k[1]=(fe+je)/Ie,k[2]=.25*Ie),k},ue.fromRotationTranslationScale=function(k,R,z,M){var L=R[0],q=R[1],X=R[2],te=R[3],le=L+L,ce=q+q,ie=X+X,fe=L*le,xe=L*ce,je=L*ie,Fe=q*ce,De=q*ie,Ie=X*ie,et=te*le,Ve=te*ce,rt=te*ie,ot=M[0],it=M[1],ct=M[2];return k[0]=(1-(Fe+Ie))*ot,k[1]=(xe+rt)*ot,k[2]=(je-Ve)*ot,k[3]=0,k[4]=(xe-rt)*it,k[5]=(1-(fe+Ie))*it,k[6]=(De+et)*it,k[7]=0,k[8]=(je+Ve)*ct,k[9]=(De-et)*ct,k[10]=(1-(fe+Fe))*ct,k[11]=0,k[12]=z[0],k[13]=z[1],k[14]=z[2],k[15]=1,k},ue.fromRotationTranslationScaleOrigin=function(k,R,z,M,L){var q=R[0],X=R[1],te=R[2],le=R[3],ce=q+q,ie=X+X,fe=te+te,xe=q*ce,je=q*ie,Fe=q*fe,De=X*ie,Ie=X*fe,et=te*fe,Ve=le*ce,rt=le*ie,ot=le*fe,it=M[0],ct=M[1],ft=M[2],xt=L[0],ut=L[1],Mt=L[2],qt=(1-(De+et))*it,Et=(je+ot)*it,fr=(Fe-rt)*it,lr=(je-ot)*ct,Qt=(1-(xe+et))*ct,Gt=(Ie+Ve)*ct,kr=(Fe+rt)*ft,yr=(Ie-Ve)*ft,_r=(1-(xe+De))*ft;return k[0]=qt,k[1]=Et,k[2]=fr,k[3]=0,k[4]=lr,k[5]=Qt,k[6]=Gt,k[7]=0,k[8]=kr,k[9]=yr,k[10]=_r,k[11]=0,k[12]=z[0]+xt-(qt*xt+lr*ut+kr*Mt),k[13]=z[1]+ut-(Et*xt+Qt*ut+yr*Mt),k[14]=z[2]+Mt-(fr*xt+Gt*ut+_r*Mt),k[15]=1,k},ue.fromQuat=function(k,R){var z=R[0],M=R[1],L=R[2],q=R[3],X=z+z,te=M+M,le=L+L,ce=z*X,ie=M*X,fe=M*te,xe=L*X,je=L*te,Fe=L*le,De=q*X,Ie=q*te,et=q*le;return k[0]=1-fe-Fe,k[1]=ie+et,k[2]=xe-Ie,k[3]=0,k[4]=ie-et,k[5]=1-ce-Fe,k[6]=je+De,k[7]=0,k[8]=xe+Ie,k[9]=je-De,k[10]=1-ce-fe,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k},ue.frustum=function(k,R,z,M,L,q,X){var te=1/(z-R),le=1/(L-M),ce=1/(q-X);return k[0]=2*q*te,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=2*q*le,k[6]=0,k[7]=0,k[8]=(z+R)*te,k[9]=(L+M)*le,k[10]=(X+q)*ce,k[11]=-1,k[12]=0,k[13]=0,k[14]=X*q*2*ce,k[15]=0,k},ue.perspectiveNO=P,ue.perspectiveZO=function(k,R,z,M,L){var q,X=1/Math.tan(R/2);return k[0]=X/z,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=X,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[11]=-1,k[12]=0,k[13]=0,k[15]=0,L!=null&&L!==1/0?(k[10]=L*(q=1/(M-L)),k[14]=L*M*q):(k[10]=-1,k[14]=-M),k},ue.perspectiveFromFieldOfView=function(k,R,z,M){var L=Math.tan(R.upDegrees*Math.PI/180),q=Math.tan(R.downDegrees*Math.PI/180),X=Math.tan(R.leftDegrees*Math.PI/180),te=Math.tan(R.rightDegrees*Math.PI/180),le=2/(X+te),ce=2/(L+q);return k[0]=le,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=ce,k[6]=0,k[7]=0,k[8]=-(X-te)*le*.5,k[9]=(L-q)*ce*.5,k[10]=M/(z-M),k[11]=-1,k[12]=0,k[13]=0,k[14]=M*z/(z-M),k[15]=0,k},ue.orthoNO=O,ue.orthoZO=function(k,R,z,M,L,q,X){var te=1/(R-z),le=1/(M-L),ce=1/(q-X);return k[0]=-2*te,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=-2*le,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=ce,k[11]=0,k[12]=(R+z)*te,k[13]=(L+M)*le,k[14]=q*ce,k[15]=1,k},ue.lookAt=function(k,R,z,M){var L,q,X,te,le,ce,ie,fe,xe,je,Fe=R[0],De=R[1],Ie=R[2],et=M[0],Ve=M[1],rt=M[2],ot=z[0],it=z[1],ct=z[2];return Math.abs(Fe-ot)<s.EPSILON&&Math.abs(De-it)<s.EPSILON&&Math.abs(Ie-ct)<s.EPSILON?p(k):(ie=Fe-ot,fe=De-it,xe=Ie-ct,L=Ve*(xe*=je=1/Math.hypot(ie,fe,xe))-rt*(fe*=je),q=rt*(ie*=je)-et*xe,X=et*fe-Ve*ie,(je=Math.hypot(L,q,X))?(L*=je=1/je,q*=je,X*=je):(L=0,q=0,X=0),te=fe*X-xe*q,le=xe*L-ie*X,ce=ie*q-fe*L,(je=Math.hypot(te,le,ce))?(te*=je=1/je,le*=je,ce*=je):(te=0,le=0,ce=0),k[0]=L,k[1]=te,k[2]=ie,k[3]=0,k[4]=q,k[5]=le,k[6]=fe,k[7]=0,k[8]=X,k[9]=ce,k[10]=xe,k[11]=0,k[12]=-(L*Fe+q*De+X*Ie),k[13]=-(te*Fe+le*De+ce*Ie),k[14]=-(ie*Fe+fe*De+xe*Ie),k[15]=1,k)},ue.targetTo=function(k,R,z,M){var L=R[0],q=R[1],X=R[2],te=M[0],le=M[1],ce=M[2],ie=L-z[0],fe=q-z[1],xe=X-z[2],je=ie*ie+fe*fe+xe*xe;je>0&&(ie*=je=1/Math.sqrt(je),fe*=je,xe*=je);var Fe=le*xe-ce*fe,De=ce*ie-te*xe,Ie=te*fe-le*ie;return(je=Fe*Fe+De*De+Ie*Ie)>0&&(Fe*=je=1/Math.sqrt(je),De*=je,Ie*=je),k[0]=Fe,k[1]=De,k[2]=Ie,k[3]=0,k[4]=fe*Ie-xe*De,k[5]=xe*Fe-ie*Ie,k[6]=ie*De-fe*Fe,k[7]=0,k[8]=ie,k[9]=fe,k[10]=xe,k[11]=0,k[12]=L,k[13]=q,k[14]=X,k[15]=1,k},ue.str=function(k){return"mat4("+k[0]+", "+k[1]+", "+k[2]+", "+k[3]+", "+k[4]+", "+k[5]+", "+k[6]+", "+k[7]+", "+k[8]+", "+k[9]+", "+k[10]+", "+k[11]+", "+k[12]+", "+k[13]+", "+k[14]+", "+k[15]+")"},ue.frob=function(k){return Math.hypot(k[0],k[1],k[2],k[3],k[4],k[5],k[6],k[7],k[8],k[9],k[10],k[11],k[12],k[13],k[14],k[15])},ue.add=function(k,R,z){return k[0]=R[0]+z[0],k[1]=R[1]+z[1],k[2]=R[2]+z[2],k[3]=R[3]+z[3],k[4]=R[4]+z[4],k[5]=R[5]+z[5],k[6]=R[6]+z[6],k[7]=R[7]+z[7],k[8]=R[8]+z[8],k[9]=R[9]+z[9],k[10]=R[10]+z[10],k[11]=R[11]+z[11],k[12]=R[12]+z[12],k[13]=R[13]+z[13],k[14]=R[14]+z[14],k[15]=R[15]+z[15],k},ue.subtract=B,ue.multiplyScalar=function(k,R,z){return k[0]=R[0]*z,k[1]=R[1]*z,k[2]=R[2]*z,k[3]=R[3]*z,k[4]=R[4]*z,k[5]=R[5]*z,k[6]=R[6]*z,k[7]=R[7]*z,k[8]=R[8]*z,k[9]=R[9]*z,k[10]=R[10]*z,k[11]=R[11]*z,k[12]=R[12]*z,k[13]=R[13]*z,k[14]=R[14]*z,k[15]=R[15]*z,k},ue.multiplyScalarAndAdd=function(k,R,z,M){return k[0]=R[0]+z[0]*M,k[1]=R[1]+z[1]*M,k[2]=R[2]+z[2]*M,k[3]=R[3]+z[3]*M,k[4]=R[4]+z[4]*M,k[5]=R[5]+z[5]*M,k[6]=R[6]+z[6]*M,k[7]=R[7]+z[7]*M,k[8]=R[8]+z[8]*M,k[9]=R[9]+z[9]*M,k[10]=R[10]+z[10]*M,k[11]=R[11]+z[11]*M,k[12]=R[12]+z[12]*M,k[13]=R[13]+z[13]*M,k[14]=R[14]+z[14]*M,k[15]=R[15]+z[15]*M,k},ue.exactEquals=function(k,R){return k[0]===R[0]&&k[1]===R[1]&&k[2]===R[2]&&k[3]===R[3]&&k[4]===R[4]&&k[5]===R[5]&&k[6]===R[6]&&k[7]===R[7]&&k[8]===R[8]&&k[9]===R[9]&&k[10]===R[10]&&k[11]===R[11]&&k[12]===R[12]&&k[13]===R[13]&&k[14]===R[14]&&k[15]===R[15]},ue.equals=function(k,R){var z=k[0],M=k[1],L=k[2],q=k[3],X=k[4],te=k[5],le=k[6],ce=k[7],ie=k[8],fe=k[9],xe=k[10],je=k[11],Fe=k[12],De=k[13],Ie=k[14],et=k[15],Ve=R[0],rt=R[1],ot=R[2],it=R[3],ct=R[4],ft=R[5],xt=R[6],ut=R[7],Mt=R[8],qt=R[9],Et=R[10],fr=R[11],lr=R[12],Qt=R[13],Gt=R[14],kr=R[15];return Math.abs(z-Ve)<=s.EPSILON*Math.max(1,Math.abs(z),Math.abs(Ve))&&Math.abs(M-rt)<=s.EPSILON*Math.max(1,Math.abs(M),Math.abs(rt))&&Math.abs(L-ot)<=s.EPSILON*Math.max(1,Math.abs(L),Math.abs(ot))&&Math.abs(q-it)<=s.EPSILON*Math.max(1,Math.abs(q),Math.abs(it))&&Math.abs(X-ct)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(ct))&&Math.abs(te-ft)<=s.EPSILON*Math.max(1,Math.abs(te),Math.abs(ft))&&Math.abs(le-xt)<=s.EPSILON*Math.max(1,Math.abs(le),Math.abs(xt))&&Math.abs(ce-ut)<=s.EPSILON*Math.max(1,Math.abs(ce),Math.abs(ut))&&Math.abs(ie-Mt)<=s.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Mt))&&Math.abs(fe-qt)<=s.EPSILON*Math.max(1,Math.abs(fe),Math.abs(qt))&&Math.abs(xe-Et)<=s.EPSILON*Math.max(1,Math.abs(xe),Math.abs(Et))&&Math.abs(je-fr)<=s.EPSILON*Math.max(1,Math.abs(je),Math.abs(fr))&&Math.abs(Fe-lr)<=s.EPSILON*Math.max(1,Math.abs(Fe),Math.abs(lr))&&Math.abs(De-Qt)<=s.EPSILON*Math.max(1,Math.abs(De),Math.abs(Qt))&&Math.abs(Ie-Gt)<=s.EPSILON*Math.max(1,Math.abs(Ie),Math.abs(Gt))&&Math.abs(et-kr)<=s.EPSILON*Math.max(1,Math.abs(et),Math.abs(kr))},ue.sub=ue.mul=ue.ortho=ue.perspective=void 0;var s=function(k,R){if(k&&k.__esModule)return k;if(k===null||f(k)!=="object"&&typeof k!="function")return{default:k};var z=u(void 0);if(z&&z.has(k))return z.get(k);var M={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var q in k)if(q!=="default"&&Object.prototype.hasOwnProperty.call(k,q)){var X=L?Object.getOwnPropertyDescriptor(k,q):null;X&&(X.get||X.set)?Object.defineProperty(M,q,X):M[q]=k[q]}return M.default=k,z&&z.set(k,M),M}(E());function u(k){if(typeof WeakMap!="function")return null;var R=new WeakMap,z=new WeakMap;return(u=function(M){return M?z:R})(k)}function p(k){return k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=1,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=1,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k}function v(k,R,z){var M=R[0],L=R[1],q=R[2],X=R[3],te=R[4],le=R[5],ce=R[6],ie=R[7],fe=R[8],xe=R[9],je=R[10],Fe=R[11],De=R[12],Ie=R[13],et=R[14],Ve=R[15],rt=z[0],ot=z[1],it=z[2],ct=z[3];return k[0]=rt*M+ot*te+it*fe+ct*De,k[1]=rt*L+ot*le+it*xe+ct*Ie,k[2]=rt*q+ot*ce+it*je+ct*et,k[3]=rt*X+ot*ie+it*Fe+ct*Ve,k[4]=(rt=z[4])*M+(ot=z[5])*te+(it=z[6])*fe+(ct=z[7])*De,k[5]=rt*L+ot*le+it*xe+ct*Ie,k[6]=rt*q+ot*ce+it*je+ct*et,k[7]=rt*X+ot*ie+it*Fe+ct*Ve,k[8]=(rt=z[8])*M+(ot=z[9])*te+(it=z[10])*fe+(ct=z[11])*De,k[9]=rt*L+ot*le+it*xe+ct*Ie,k[10]=rt*q+ot*ce+it*je+ct*et,k[11]=rt*X+ot*ie+it*Fe+ct*Ve,k[12]=(rt=z[12])*M+(ot=z[13])*te+(it=z[14])*fe+(ct=z[15])*De,k[13]=rt*L+ot*le+it*xe+ct*Ie,k[14]=rt*q+ot*ce+it*je+ct*et,k[15]=rt*X+ot*ie+it*Fe+ct*Ve,k}function m(k,R,z){var M=R[0],L=R[1],q=R[2],X=R[3],te=M+M,le=L+L,ce=q+q,ie=M*te,fe=M*le,xe=M*ce,je=L*le,Fe=L*ce,De=q*ce,Ie=X*te,et=X*le,Ve=X*ce;return k[0]=1-(je+De),k[1]=fe+Ve,k[2]=xe-et,k[3]=0,k[4]=fe-Ve,k[5]=1-(ie+De),k[6]=Fe+Ie,k[7]=0,k[8]=xe+et,k[9]=Fe-Ie,k[10]=1-(ie+je),k[11]=0,k[12]=z[0],k[13]=z[1],k[14]=z[2],k[15]=1,k}function _(k,R){var z=R[4],M=R[5],L=R[6],q=R[8],X=R[9],te=R[10];return k[0]=Math.hypot(R[0],R[1],R[2]),k[1]=Math.hypot(z,M,L),k[2]=Math.hypot(q,X,te),k}function P(k,R,z,M,L){var q,X=1/Math.tan(R/2);return k[0]=X/z,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=X,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[11]=-1,k[12]=0,k[13]=0,k[15]=0,L!=null&&L!==1/0?(k[10]=(L+M)*(q=1/(M-L)),k[14]=2*L*M*q):(k[10]=-1,k[14]=-2*M),k}function O(k,R,z,M,L,q,X){var te=1/(R-z),le=1/(M-L),ce=1/(q-X);return k[0]=-2*te,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=-2*le,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=2*ce,k[11]=0,k[12]=(R+z)*te,k[13]=(L+M)*le,k[14]=(X+q)*ce,k[15]=1,k}function B(k,R,z){return k[0]=R[0]-z[0],k[1]=R[1]-z[1],k[2]=R[2]-z[2],k[3]=R[3]-z[3],k[4]=R[4]-z[4],k[5]=R[5]-z[5],k[6]=R[6]-z[6],k[7]=R[7]-z[7],k[8]=R[8]-z[8],k[9]=R[9]-z[9],k[10]=R[10]-z[10],k[11]=R[11]-z[11],k[12]=R[12]-z[12],k[13]=R[13]-z[13],k[14]=R[14]-z[14],k[15]=R[15]-z[15],k}return ue.perspective=P,ue.ortho=O,ue.mul=v,ue.sub=B,ue}var Ce,Ne={},me={};function be(){if(Ce)return me;function f(L){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},f(L)}Ce=1,Object.defineProperty(me,"__esModule",{value:!0}),me.create=p,me.clone=function(L){var q=new s.ARRAY_TYPE(3);return q[0]=L[0],q[1]=L[1],q[2]=L[2],q},me.length=v,me.fromValues=function(L,q,X){var te=new s.ARRAY_TYPE(3);return te[0]=L,te[1]=q,te[2]=X,te},me.copy=function(L,q){return L[0]=q[0],L[1]=q[1],L[2]=q[2],L},me.set=function(L,q,X,te){return L[0]=q,L[1]=X,L[2]=te,L},me.add=function(L,q,X){return L[0]=q[0]+X[0],L[1]=q[1]+X[1],L[2]=q[2]+X[2],L},me.subtract=m,me.multiply=_,me.divide=P,me.ceil=function(L,q){return L[0]=Math.ceil(q[0]),L[1]=Math.ceil(q[1]),L[2]=Math.ceil(q[2]),L},me.floor=function(L,q){return L[0]=Math.floor(q[0]),L[1]=Math.floor(q[1]),L[2]=Math.floor(q[2]),L},me.min=function(L,q,X){return L[0]=Math.min(q[0],X[0]),L[1]=Math.min(q[1],X[1]),L[2]=Math.min(q[2],X[2]),L},me.max=function(L,q,X){return L[0]=Math.max(q[0],X[0]),L[1]=Math.max(q[1],X[1]),L[2]=Math.max(q[2],X[2]),L},me.round=function(L,q){return L[0]=Math.round(q[0]),L[1]=Math.round(q[1]),L[2]=Math.round(q[2]),L},me.scale=function(L,q,X){return L[0]=q[0]*X,L[1]=q[1]*X,L[2]=q[2]*X,L},me.scaleAndAdd=function(L,q,X,te){return L[0]=q[0]+X[0]*te,L[1]=q[1]+X[1]*te,L[2]=q[2]+X[2]*te,L},me.distance=O,me.squaredDistance=B,me.squaredLength=k,me.negate=function(L,q){return L[0]=-q[0],L[1]=-q[1],L[2]=-q[2],L},me.inverse=function(L,q){return L[0]=1/q[0],L[1]=1/q[1],L[2]=1/q[2],L},me.normalize=function(L,q){var X=q[0],te=q[1],le=q[2],ce=X*X+te*te+le*le;return ce>0&&(ce=1/Math.sqrt(ce)),L[0]=q[0]*ce,L[1]=q[1]*ce,L[2]=q[2]*ce,L},me.dot=R,me.cross=function(L,q,X){var te=q[0],le=q[1],ce=q[2],ie=X[0],fe=X[1],xe=X[2];return L[0]=le*xe-ce*fe,L[1]=ce*ie-te*xe,L[2]=te*fe-le*ie,L},me.lerp=function(L,q,X,te){var le=q[0],ce=q[1],ie=q[2];return L[0]=le+te*(X[0]-le),L[1]=ce+te*(X[1]-ce),L[2]=ie+te*(X[2]-ie),L},me.hermite=function(L,q,X,te,le,ce){var ie=ce*ce,fe=ie*(2*ce-3)+1,xe=ie*(ce-2)+ce,je=ie*(ce-1),Fe=ie*(3-2*ce);return L[0]=q[0]*fe+X[0]*xe+te[0]*je+le[0]*Fe,L[1]=q[1]*fe+X[1]*xe+te[1]*je+le[1]*Fe,L[2]=q[2]*fe+X[2]*xe+te[2]*je+le[2]*Fe,L},me.bezier=function(L,q,X,te,le,ce){var ie=1-ce,fe=ie*ie,xe=ce*ce,je=fe*ie,Fe=3*ce*fe,De=3*xe*ie,Ie=xe*ce;return L[0]=q[0]*je+X[0]*Fe+te[0]*De+le[0]*Ie,L[1]=q[1]*je+X[1]*Fe+te[1]*De+le[1]*Ie,L[2]=q[2]*je+X[2]*Fe+te[2]*De+le[2]*Ie,L},me.random=function(L,q){q=q||1;var X=2*s.RANDOM()*Math.PI,te=2*s.RANDOM()-1,le=Math.sqrt(1-te*te)*q;return L[0]=Math.cos(X)*le,L[1]=Math.sin(X)*le,L[2]=te*q,L},me.transformMat4=function(L,q,X){var te=q[0],le=q[1],ce=q[2],ie=X[3]*te+X[7]*le+X[11]*ce+X[15];return L[0]=(X[0]*te+X[4]*le+X[8]*ce+X[12])/(ie=ie||1),L[1]=(X[1]*te+X[5]*le+X[9]*ce+X[13])/ie,L[2]=(X[2]*te+X[6]*le+X[10]*ce+X[14])/ie,L},me.transformMat3=function(L,q,X){var te=q[0],le=q[1],ce=q[2];return L[0]=te*X[0]+le*X[3]+ce*X[6],L[1]=te*X[1]+le*X[4]+ce*X[7],L[2]=te*X[2]+le*X[5]+ce*X[8],L},me.transformQuat=function(L,q,X){var te=X[0],le=X[1],ce=X[2],ie=q[0],fe=q[1],xe=q[2],je=le*xe-ce*fe,Fe=ce*ie-te*xe,De=te*fe-le*ie,Ie=le*De-ce*Fe,et=ce*je-te*De,Ve=te*Fe-le*je,rt=2*X[3];return Fe*=rt,De*=rt,et*=2,Ve*=2,L[0]=ie+(je*=rt)+(Ie*=2),L[1]=fe+Fe+et,L[2]=xe+De+Ve,L},me.rotateX=function(L,q,X,te){var le=[],ce=[];return le[0]=q[0]-X[0],le[1]=q[1]-X[1],le[2]=q[2]-X[2],ce[0]=le[0],ce[1]=le[1]*Math.cos(te)-le[2]*Math.sin(te),ce[2]=le[1]*Math.sin(te)+le[2]*Math.cos(te),L[0]=ce[0]+X[0],L[1]=ce[1]+X[1],L[2]=ce[2]+X[2],L},me.rotateY=function(L,q,X,te){var le=[],ce=[];return le[0]=q[0]-X[0],le[1]=q[1]-X[1],le[2]=q[2]-X[2],ce[0]=le[2]*Math.sin(te)+le[0]*Math.cos(te),ce[1]=le[1],ce[2]=le[2]*Math.cos(te)-le[0]*Math.sin(te),L[0]=ce[0]+X[0],L[1]=ce[1]+X[1],L[2]=ce[2]+X[2],L},me.rotateZ=function(L,q,X,te){var le=[],ce=[];return le[0]=q[0]-X[0],le[1]=q[1]-X[1],le[2]=q[2]-X[2],ce[0]=le[0]*Math.cos(te)-le[1]*Math.sin(te),ce[1]=le[0]*Math.sin(te)+le[1]*Math.cos(te),ce[2]=le[2],L[0]=ce[0]+X[0],L[1]=ce[1]+X[1],L[2]=ce[2]+X[2],L},me.angle=function(L,q){var X=L[0],te=L[1],le=L[2],ce=q[0],ie=q[1],fe=q[2],xe=Math.sqrt(X*X+te*te+le*le)*Math.sqrt(ce*ce+ie*ie+fe*fe),je=xe&&R(L,q)/xe;return Math.acos(Math.min(Math.max(je,-1),1))},me.zero=function(L){return L[0]=0,L[1]=0,L[2]=0,L},me.str=function(L){return"vec3("+L[0]+", "+L[1]+", "+L[2]+")"},me.exactEquals=function(L,q){return L[0]===q[0]&&L[1]===q[1]&&L[2]===q[2]},me.equals=function(L,q){var X=L[0],te=L[1],le=L[2],ce=q[0],ie=q[1],fe=q[2];return Math.abs(X-ce)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(ce))&&Math.abs(te-ie)<=s.EPSILON*Math.max(1,Math.abs(te),Math.abs(ie))&&Math.abs(le-fe)<=s.EPSILON*Math.max(1,Math.abs(le),Math.abs(fe))},me.forEach=me.sqrLen=me.len=me.sqrDist=me.dist=me.div=me.mul=me.sub=void 0;var s=function(L,q){if(L&&L.__esModule)return L;if(L===null||f(L)!=="object"&&typeof L!="function")return{default:L};var X=u(void 0);if(X&&X.has(L))return X.get(L);var te={},le=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ce in L)if(ce!=="default"&&Object.prototype.hasOwnProperty.call(L,ce)){var ie=le?Object.getOwnPropertyDescriptor(L,ce):null;ie&&(ie.get||ie.set)?Object.defineProperty(te,ce,ie):te[ce]=L[ce]}return te.default=L,X&&X.set(L,te),te}(E());function u(L){if(typeof WeakMap!="function")return null;var q=new WeakMap,X=new WeakMap;return(u=function(te){return te?X:q})(L)}function p(){var L=new s.ARRAY_TYPE(3);return s.ARRAY_TYPE!=Float32Array&&(L[0]=0,L[1]=0,L[2]=0),L}function v(L){return Math.hypot(L[0],L[1],L[2])}function m(L,q,X){return L[0]=q[0]-X[0],L[1]=q[1]-X[1],L[2]=q[2]-X[2],L}function _(L,q,X){return L[0]=q[0]*X[0],L[1]=q[1]*X[1],L[2]=q[2]*X[2],L}function P(L,q,X){return L[0]=q[0]/X[0],L[1]=q[1]/X[1],L[2]=q[2]/X[2],L}function O(L,q){return Math.hypot(q[0]-L[0],q[1]-L[1],q[2]-L[2])}function B(L,q){var X=q[0]-L[0],te=q[1]-L[1],le=q[2]-L[2];return X*X+te*te+le*le}function k(L){var q=L[0],X=L[1],te=L[2];return q*q+X*X+te*te}function R(L,q){return L[0]*q[0]+L[1]*q[1]+L[2]*q[2]}me.sub=m,me.mul=_,me.div=P,me.dist=O,me.sqrDist=B,me.len=v,me.sqrLen=k;var z,M=(z=p(),function(L,q,X,te,le,ce){var ie,fe;for(q||(q=3),X||(X=0),fe=te?Math.min(te*q+X,L.length):L.length,ie=X;ie<fe;ie+=q)z[0]=L[ie],z[1]=L[ie+1],z[2]=L[ie+2],le(z,z,ce),L[ie]=z[0],L[ie+1]=z[1],L[ie+2]=z[2];return L});return me.forEach=M,me}var pe,Se,Ee={};function we(){if(pe)return Ee;function f(M){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},f(M)}pe=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.create=p,Ee.clone=function(M){var L=new s.ARRAY_TYPE(4);return L[0]=M[0],L[1]=M[1],L[2]=M[2],L[3]=M[3],L},Ee.fromValues=function(M,L,q,X){var te=new s.ARRAY_TYPE(4);return te[0]=M,te[1]=L,te[2]=q,te[3]=X,te},Ee.copy=function(M,L){return M[0]=L[0],M[1]=L[1],M[2]=L[2],M[3]=L[3],M},Ee.set=function(M,L,q,X,te){return M[0]=L,M[1]=q,M[2]=X,M[3]=te,M},Ee.add=function(M,L,q){return M[0]=L[0]+q[0],M[1]=L[1]+q[1],M[2]=L[2]+q[2],M[3]=L[3]+q[3],M},Ee.subtract=v,Ee.multiply=m,Ee.divide=_,Ee.ceil=function(M,L){return M[0]=Math.ceil(L[0]),M[1]=Math.ceil(L[1]),M[2]=Math.ceil(L[2]),M[3]=Math.ceil(L[3]),M},Ee.floor=function(M,L){return M[0]=Math.floor(L[0]),M[1]=Math.floor(L[1]),M[2]=Math.floor(L[2]),M[3]=Math.floor(L[3]),M},Ee.min=function(M,L,q){return M[0]=Math.min(L[0],q[0]),M[1]=Math.min(L[1],q[1]),M[2]=Math.min(L[2],q[2]),M[3]=Math.min(L[3],q[3]),M},Ee.max=function(M,L,q){return M[0]=Math.max(L[0],q[0]),M[1]=Math.max(L[1],q[1]),M[2]=Math.max(L[2],q[2]),M[3]=Math.max(L[3],q[3]),M},Ee.round=function(M,L){return M[0]=Math.round(L[0]),M[1]=Math.round(L[1]),M[2]=Math.round(L[2]),M[3]=Math.round(L[3]),M},Ee.scale=function(M,L,q){return M[0]=L[0]*q,M[1]=L[1]*q,M[2]=L[2]*q,M[3]=L[3]*q,M},Ee.scaleAndAdd=function(M,L,q,X){return M[0]=L[0]+q[0]*X,M[1]=L[1]+q[1]*X,M[2]=L[2]+q[2]*X,M[3]=L[3]+q[3]*X,M},Ee.distance=P,Ee.squaredDistance=O,Ee.length=B,Ee.squaredLength=k,Ee.negate=function(M,L){return M[0]=-L[0],M[1]=-L[1],M[2]=-L[2],M[3]=-L[3],M},Ee.inverse=function(M,L){return M[0]=1/L[0],M[1]=1/L[1],M[2]=1/L[2],M[3]=1/L[3],M},Ee.normalize=function(M,L){var q=L[0],X=L[1],te=L[2],le=L[3],ce=q*q+X*X+te*te+le*le;return ce>0&&(ce=1/Math.sqrt(ce)),M[0]=q*ce,M[1]=X*ce,M[2]=te*ce,M[3]=le*ce,M},Ee.dot=function(M,L){return M[0]*L[0]+M[1]*L[1]+M[2]*L[2]+M[3]*L[3]},Ee.cross=function(M,L,q,X){var te=q[0]*X[1]-q[1]*X[0],le=q[0]*X[2]-q[2]*X[0],ce=q[0]*X[3]-q[3]*X[0],ie=q[1]*X[2]-q[2]*X[1],fe=q[1]*X[3]-q[3]*X[1],xe=q[2]*X[3]-q[3]*X[2],je=L[0],Fe=L[1],De=L[2],Ie=L[3];return M[0]=Fe*xe-De*fe+Ie*ie,M[1]=-je*xe+De*ce-Ie*le,M[2]=je*fe-Fe*ce+Ie*te,M[3]=-je*ie+Fe*le-De*te,M},Ee.lerp=function(M,L,q,X){var te=L[0],le=L[1],ce=L[2],ie=L[3];return M[0]=te+X*(q[0]-te),M[1]=le+X*(q[1]-le),M[2]=ce+X*(q[2]-ce),M[3]=ie+X*(q[3]-ie),M},Ee.random=function(M,L){var q,X,te,le,ce,ie;L=L||1;do ce=(q=2*s.RANDOM()-1)*q+(X=2*s.RANDOM()-1)*X;while(ce>=1);do ie=(te=2*s.RANDOM()-1)*te+(le=2*s.RANDOM()-1)*le;while(ie>=1);var fe=Math.sqrt((1-ce)/ie);return M[0]=L*q,M[1]=L*X,M[2]=L*te*fe,M[3]=L*le*fe,M},Ee.transformMat4=function(M,L,q){var X=L[0],te=L[1],le=L[2],ce=L[3];return M[0]=q[0]*X+q[4]*te+q[8]*le+q[12]*ce,M[1]=q[1]*X+q[5]*te+q[9]*le+q[13]*ce,M[2]=q[2]*X+q[6]*te+q[10]*le+q[14]*ce,M[3]=q[3]*X+q[7]*te+q[11]*le+q[15]*ce,M},Ee.transformQuat=function(M,L,q){var X=L[0],te=L[1],le=L[2],ce=q[0],ie=q[1],fe=q[2],xe=q[3],je=xe*X+ie*le-fe*te,Fe=xe*te+fe*X-ce*le,De=xe*le+ce*te-ie*X,Ie=-ce*X-ie*te-fe*le;return M[0]=je*xe+Ie*-ce+Fe*-fe-De*-ie,M[1]=Fe*xe+Ie*-ie+De*-ce-je*-fe,M[2]=De*xe+Ie*-fe+je*-ie-Fe*-ce,M[3]=L[3],M},Ee.zero=function(M){return M[0]=0,M[1]=0,M[2]=0,M[3]=0,M},Ee.str=function(M){return"vec4("+M[0]+", "+M[1]+", "+M[2]+", "+M[3]+")"},Ee.exactEquals=function(M,L){return M[0]===L[0]&&M[1]===L[1]&&M[2]===L[2]&&M[3]===L[3]},Ee.equals=function(M,L){var q=M[0],X=M[1],te=M[2],le=M[3],ce=L[0],ie=L[1],fe=L[2],xe=L[3];return Math.abs(q-ce)<=s.EPSILON*Math.max(1,Math.abs(q),Math.abs(ce))&&Math.abs(X-ie)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(ie))&&Math.abs(te-fe)<=s.EPSILON*Math.max(1,Math.abs(te),Math.abs(fe))&&Math.abs(le-xe)<=s.EPSILON*Math.max(1,Math.abs(le),Math.abs(xe))},Ee.forEach=Ee.sqrLen=Ee.len=Ee.sqrDist=Ee.dist=Ee.div=Ee.mul=Ee.sub=void 0;var s=function(M,L){if(M&&M.__esModule)return M;if(M===null||f(M)!=="object"&&typeof M!="function")return{default:M};var q=u(void 0);if(q&&q.has(M))return q.get(M);var X={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var le in M)if(le!=="default"&&Object.prototype.hasOwnProperty.call(M,le)){var ce=te?Object.getOwnPropertyDescriptor(M,le):null;ce&&(ce.get||ce.set)?Object.defineProperty(X,le,ce):X[le]=M[le]}return X.default=M,q&&q.set(M,X),X}(E());function u(M){if(typeof WeakMap!="function")return null;var L=new WeakMap,q=new WeakMap;return(u=function(X){return X?q:L})(M)}function p(){var M=new s.ARRAY_TYPE(4);return s.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0,M[2]=0,M[3]=0),M}function v(M,L,q){return M[0]=L[0]-q[0],M[1]=L[1]-q[1],M[2]=L[2]-q[2],M[3]=L[3]-q[3],M}function m(M,L,q){return M[0]=L[0]*q[0],M[1]=L[1]*q[1],M[2]=L[2]*q[2],M[3]=L[3]*q[3],M}function _(M,L,q){return M[0]=L[0]/q[0],M[1]=L[1]/q[1],M[2]=L[2]/q[2],M[3]=L[3]/q[3],M}function P(M,L){return Math.hypot(L[0]-M[0],L[1]-M[1],L[2]-M[2],L[3]-M[3])}function O(M,L){var q=L[0]-M[0],X=L[1]-M[1],te=L[2]-M[2],le=L[3]-M[3];return q*q+X*X+te*te+le*le}function B(M){return Math.hypot(M[0],M[1],M[2],M[3])}function k(M){var L=M[0],q=M[1],X=M[2],te=M[3];return L*L+q*q+X*X+te*te}Ee.sub=v,Ee.mul=m,Ee.div=_,Ee.dist=P,Ee.sqrDist=O,Ee.len=B,Ee.sqrLen=k;var R,z=(R=p(),function(M,L,q,X,te,le){var ce,ie;for(L||(L=4),q||(q=0),ie=X?Math.min(X*L+q,M.length):M.length,ce=q;ce<ie;ce+=L)R[0]=M[ce],R[1]=M[ce+1],R[2]=M[ce+2],R[3]=M[ce+3],te(R,R,le),M[ce]=R[0],M[ce+1]=R[1],M[ce+2]=R[2],M[ce+3]=R[3];return M});return Ee.forEach=z,Ee}function Pe(){if(Se)return Ne;function f(Ve){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(rt){return typeof rt}:function(rt){return rt&&typeof Symbol=="function"&&rt.constructor===Symbol&&rt!==Symbol.prototype?"symbol":typeof rt},f(Ve)}Se=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.create=P,Ne.identity=function(Ve){return Ve[0]=0,Ve[1]=0,Ve[2]=0,Ve[3]=1,Ve},Ne.setAxisAngle=O,Ne.getAxisAngle=function(Ve,rt){var ot=2*Math.acos(rt[3]),it=Math.sin(ot/2);return it>s.EPSILON?(Ve[0]=rt[0]/it,Ve[1]=rt[1]/it,Ve[2]=rt[2]/it):(Ve[0]=1,Ve[1]=0,Ve[2]=0),ot},Ne.getAngle=function(Ve,rt){var ot=q(Ve,rt);return Math.acos(2*ot*ot-1)},Ne.multiply=B,Ne.rotateX=function(Ve,rt,ot){ot*=.5;var it=rt[0],ct=rt[1],ft=rt[2],xt=rt[3],ut=Math.sin(ot),Mt=Math.cos(ot);return Ve[0]=it*Mt+xt*ut,Ve[1]=ct*Mt+ft*ut,Ve[2]=ft*Mt-ct*ut,Ve[3]=xt*Mt-it*ut,Ve},Ne.rotateY=function(Ve,rt,ot){ot*=.5;var it=rt[0],ct=rt[1],ft=rt[2],xt=rt[3],ut=Math.sin(ot),Mt=Math.cos(ot);return Ve[0]=it*Mt-ft*ut,Ve[1]=ct*Mt+xt*ut,Ve[2]=ft*Mt+it*ut,Ve[3]=xt*Mt-ct*ut,Ve},Ne.rotateZ=function(Ve,rt,ot){ot*=.5;var it=rt[0],ct=rt[1],ft=rt[2],xt=rt[3],ut=Math.sin(ot),Mt=Math.cos(ot);return Ve[0]=it*Mt+ct*ut,Ve[1]=ct*Mt-it*ut,Ve[2]=ft*Mt+xt*ut,Ve[3]=xt*Mt-ft*ut,Ve},Ne.calculateW=function(Ve,rt){var ot=rt[0],it=rt[1],ct=rt[2];return Ve[0]=ot,Ve[1]=it,Ve[2]=ct,Ve[3]=Math.sqrt(Math.abs(1-ot*ot-it*it-ct*ct)),Ve},Ne.exp=k,Ne.ln=R,Ne.pow=function(Ve,rt,ot){return R(Ve,rt),L(Ve,Ve,ot),k(Ve,Ve),Ve},Ne.slerp=z,Ne.random=function(Ve){var rt=s.RANDOM(),ot=s.RANDOM(),it=s.RANDOM(),ct=Math.sqrt(1-rt),ft=Math.sqrt(rt);return Ve[0]=ct*Math.sin(2*Math.PI*ot),Ve[1]=ct*Math.cos(2*Math.PI*ot),Ve[2]=ft*Math.sin(2*Math.PI*it),Ve[3]=ft*Math.cos(2*Math.PI*it),Ve},Ne.invert=function(Ve,rt){var ot=rt[0],it=rt[1],ct=rt[2],ft=rt[3],xt=ot*ot+it*it+ct*ct+ft*ft,ut=xt?1/xt:0;return Ve[0]=-ot*ut,Ve[1]=-it*ut,Ve[2]=-ct*ut,Ve[3]=ft*ut,Ve},Ne.conjugate=function(Ve,rt){return Ve[0]=-rt[0],Ve[1]=-rt[1],Ve[2]=-rt[2],Ve[3]=rt[3],Ve},Ne.fromMat3=M,Ne.fromEuler=function(Ve,rt,ot,it){var ct=.5*Math.PI/180;rt*=ct,ot*=ct,it*=ct;var ft=Math.sin(rt),xt=Math.cos(rt),ut=Math.sin(ot),Mt=Math.cos(ot),qt=Math.sin(it),Et=Math.cos(it);return Ve[0]=ft*Mt*Et-xt*ut*qt,Ve[1]=xt*ut*Et+ft*Mt*qt,Ve[2]=xt*Mt*qt-ft*ut*Et,Ve[3]=xt*Mt*Et+ft*ut*qt,Ve},Ne.str=function(Ve){return"quat("+Ve[0]+", "+Ve[1]+", "+Ve[2]+", "+Ve[3]+")"},Ne.setAxes=Ne.sqlerp=Ne.rotationTo=Ne.equals=Ne.exactEquals=Ne.normalize=Ne.sqrLen=Ne.squaredLength=Ne.len=Ne.length=Ne.lerp=Ne.dot=Ne.scale=Ne.mul=Ne.add=Ne.set=Ne.copy=Ne.fromValues=Ne.clone=void 0;var s=_(E()),u=_(ee()),p=_(be()),v=_(we());function m(Ve){if(typeof WeakMap!="function")return null;var rt=new WeakMap,ot=new WeakMap;return(m=function(it){return it?ot:rt})(Ve)}function _(Ve,rt){if(Ve&&Ve.__esModule)return Ve;if(Ve===null||f(Ve)!=="object"&&typeof Ve!="function")return{default:Ve};var ot=m(rt);if(ot&&ot.has(Ve))return ot.get(Ve);var it={},ct=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ft in Ve)if(ft!=="default"&&Object.prototype.hasOwnProperty.call(Ve,ft)){var xt=ct?Object.getOwnPropertyDescriptor(Ve,ft):null;xt&&(xt.get||xt.set)?Object.defineProperty(it,ft,xt):it[ft]=Ve[ft]}return it.default=Ve,ot&&ot.set(Ve,it),it}function P(){var Ve=new s.ARRAY_TYPE(4);return s.ARRAY_TYPE!=Float32Array&&(Ve[0]=0,Ve[1]=0,Ve[2]=0),Ve[3]=1,Ve}function O(Ve,rt,ot){ot*=.5;var it=Math.sin(ot);return Ve[0]=it*rt[0],Ve[1]=it*rt[1],Ve[2]=it*rt[2],Ve[3]=Math.cos(ot),Ve}function B(Ve,rt,ot){var it=rt[0],ct=rt[1],ft=rt[2],xt=rt[3],ut=ot[0],Mt=ot[1],qt=ot[2],Et=ot[3];return Ve[0]=it*Et+xt*ut+ct*qt-ft*Mt,Ve[1]=ct*Et+xt*Mt+ft*ut-it*qt,Ve[2]=ft*Et+xt*qt+it*Mt-ct*ut,Ve[3]=xt*Et-it*ut-ct*Mt-ft*qt,Ve}function k(Ve,rt){var ot=rt[0],it=rt[1],ct=rt[2],ft=rt[3],xt=Math.sqrt(ot*ot+it*it+ct*ct),ut=Math.exp(ft),Mt=xt>0?ut*Math.sin(xt)/xt:0;return Ve[0]=ot*Mt,Ve[1]=it*Mt,Ve[2]=ct*Mt,Ve[3]=ut*Math.cos(xt),Ve}function R(Ve,rt){var ot=rt[0],it=rt[1],ct=rt[2],ft=rt[3],xt=Math.sqrt(ot*ot+it*it+ct*ct),ut=xt>0?Math.atan2(xt,ft)/xt:0;return Ve[0]=ot*ut,Ve[1]=it*ut,Ve[2]=ct*ut,Ve[3]=.5*Math.log(ot*ot+it*it+ct*ct+ft*ft),Ve}function z(Ve,rt,ot,it){var ct,ft,xt,ut,Mt,qt=rt[0],Et=rt[1],fr=rt[2],lr=rt[3],Qt=ot[0],Gt=ot[1],kr=ot[2],yr=ot[3];return(ft=qt*Qt+Et*Gt+fr*kr+lr*yr)<0&&(ft=-ft,Qt=-Qt,Gt=-Gt,kr=-kr,yr=-yr),1-ft>s.EPSILON?(ct=Math.acos(ft),xt=Math.sin(ct),ut=Math.sin((1-it)*ct)/xt,Mt=Math.sin(it*ct)/xt):(ut=1-it,Mt=it),Ve[0]=ut*qt+Mt*Qt,Ve[1]=ut*Et+Mt*Gt,Ve[2]=ut*fr+Mt*kr,Ve[3]=ut*lr+Mt*yr,Ve}function M(Ve,rt){var ot,it=rt[0]+rt[4]+rt[8];if(it>0)ot=Math.sqrt(it+1),Ve[3]=.5*ot,Ve[0]=(rt[5]-rt[7])*(ot=.5/ot),Ve[1]=(rt[6]-rt[2])*ot,Ve[2]=(rt[1]-rt[3])*ot;else{var ct=0;rt[4]>rt[0]&&(ct=1),rt[8]>rt[3*ct+ct]&&(ct=2);var ft=(ct+1)%3,xt=(ct+2)%3;ot=Math.sqrt(rt[3*ct+ct]-rt[3*ft+ft]-rt[3*xt+xt]+1),Ve[ct]=.5*ot,Ve[3]=(rt[3*ft+xt]-rt[3*xt+ft])*(ot=.5/ot),Ve[ft]=(rt[3*ft+ct]+rt[3*ct+ft])*ot,Ve[xt]=(rt[3*xt+ct]+rt[3*ct+xt])*ot}return Ve}Ne.clone=v.clone,Ne.fromValues=v.fromValues,Ne.copy=v.copy,Ne.set=v.set,Ne.add=v.add,Ne.mul=B;var L=v.scale;Ne.scale=L;var q=v.dot;Ne.dot=q,Ne.lerp=v.lerp;var X=v.length;Ne.length=X,Ne.len=X;var te=v.squaredLength;Ne.squaredLength=te,Ne.sqrLen=te;var le=v.normalize;Ne.normalize=le,Ne.exactEquals=v.exactEquals,Ne.equals=v.equals;var ce,ie,fe,xe=(ce=p.create(),ie=p.fromValues(1,0,0),fe=p.fromValues(0,1,0),function(Ve,rt,ot){var it=p.dot(rt,ot);return it<-.999999?(p.cross(ce,ie,rt),p.len(ce)<1e-6&&p.cross(ce,fe,rt),p.normalize(ce,ce),O(Ve,ce,Math.PI),Ve):it>.999999?(Ve[0]=0,Ve[1]=0,Ve[2]=0,Ve[3]=1,Ve):(p.cross(ce,rt,ot),Ve[0]=ce[0],Ve[1]=ce[1],Ve[2]=ce[2],Ve[3]=1+it,le(Ve,Ve))});Ne.rotationTo=xe;var je,Fe,De=(je=P(),Fe=P(),function(Ve,rt,ot,it,ct,ft){return z(je,rt,ct,ft),z(Fe,ot,it,ft),z(Ve,je,Fe,2*ft*(1-ft)),Ve});Ne.sqlerp=De;var Ie,et=(Ie=u.create(),function(Ve,rt,ot,it){return Ie[0]=ot[0],Ie[3]=ot[1],Ie[6]=ot[2],Ie[1]=it[0],Ie[4]=it[1],Ie[7]=it[2],Ie[2]=-rt[0],Ie[5]=-rt[1],Ie[8]=-rt[2],le(Ve,M(Ve,Ie))});return Ne.setAxes=et,Ne}var Me,Be={};function Ge(){if(Me)return Be;function f(z){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},f(z)}Me=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.create=function(){var z=new s.ARRAY_TYPE(8);return s.ARRAY_TYPE!=Float32Array&&(z[0]=0,z[1]=0,z[2]=0,z[4]=0,z[5]=0,z[6]=0,z[7]=0),z[3]=1,z},Be.clone=function(z){var M=new s.ARRAY_TYPE(8);return M[0]=z[0],M[1]=z[1],M[2]=z[2],M[3]=z[3],M[4]=z[4],M[5]=z[5],M[6]=z[6],M[7]=z[7],M},Be.fromValues=function(z,M,L,q,X,te,le,ce){var ie=new s.ARRAY_TYPE(8);return ie[0]=z,ie[1]=M,ie[2]=L,ie[3]=q,ie[4]=X,ie[5]=te,ie[6]=le,ie[7]=ce,ie},Be.fromRotationTranslationValues=function(z,M,L,q,X,te,le){var ce=new s.ARRAY_TYPE(8);ce[0]=z,ce[1]=M,ce[2]=L,ce[3]=q;var ie=.5*X,fe=.5*te,xe=.5*le;return ce[4]=ie*q+fe*L-xe*M,ce[5]=fe*q+xe*z-ie*L,ce[6]=xe*q+ie*M-fe*z,ce[7]=-ie*z-fe*M-xe*L,ce},Be.fromRotationTranslation=_,Be.fromTranslation=function(z,M){return z[0]=0,z[1]=0,z[2]=0,z[3]=1,z[4]=.5*M[0],z[5]=.5*M[1],z[6]=.5*M[2],z[7]=0,z},Be.fromRotation=function(z,M){return z[0]=M[0],z[1]=M[1],z[2]=M[2],z[3]=M[3],z[4]=0,z[5]=0,z[6]=0,z[7]=0,z},Be.fromMat4=function(z,M){var L=u.create();p.getRotation(L,M);var q=new s.ARRAY_TYPE(3);return p.getTranslation(q,M),_(z,L,q),z},Be.copy=P,Be.identity=function(z){return z[0]=0,z[1]=0,z[2]=0,z[3]=1,z[4]=0,z[5]=0,z[6]=0,z[7]=0,z},Be.set=function(z,M,L,q,X,te,le,ce,ie){return z[0]=M,z[1]=L,z[2]=q,z[3]=X,z[4]=te,z[5]=le,z[6]=ce,z[7]=ie,z},Be.getDual=function(z,M){return z[0]=M[4],z[1]=M[5],z[2]=M[6],z[3]=M[7],z},Be.setDual=function(z,M){return z[4]=M[0],z[5]=M[1],z[6]=M[2],z[7]=M[3],z},Be.getTranslation=function(z,M){var L=M[4],q=M[5],X=M[6],te=M[7],le=-M[0],ce=-M[1],ie=-M[2],fe=M[3];return z[0]=2*(L*fe+te*le+q*ie-X*ce),z[1]=2*(q*fe+te*ce+X*le-L*ie),z[2]=2*(X*fe+te*ie+L*ce-q*le),z},Be.translate=function(z,M,L){var q=M[0],X=M[1],te=M[2],le=M[3],ce=.5*L[0],ie=.5*L[1],fe=.5*L[2],xe=M[4],je=M[5],Fe=M[6],De=M[7];return z[0]=q,z[1]=X,z[2]=te,z[3]=le,z[4]=le*ce+X*fe-te*ie+xe,z[5]=le*ie+te*ce-q*fe+je,z[6]=le*fe+q*ie-X*ce+Fe,z[7]=-q*ce-X*ie-te*fe+De,z},Be.rotateX=function(z,M,L){var q=-M[0],X=-M[1],te=-M[2],le=M[3],ce=M[4],ie=M[5],fe=M[6],xe=M[7],je=ce*le+xe*q+ie*te-fe*X,Fe=ie*le+xe*X+fe*q-ce*te,De=fe*le+xe*te+ce*X-ie*q,Ie=xe*le-ce*q-ie*X-fe*te;return u.rotateX(z,M,L),z[4]=je*(le=z[3])+Ie*(q=z[0])+Fe*(te=z[2])-De*(X=z[1]),z[5]=Fe*le+Ie*X+De*q-je*te,z[6]=De*le+Ie*te+je*X-Fe*q,z[7]=Ie*le-je*q-Fe*X-De*te,z},Be.rotateY=function(z,M,L){var q=-M[0],X=-M[1],te=-M[2],le=M[3],ce=M[4],ie=M[5],fe=M[6],xe=M[7],je=ce*le+xe*q+ie*te-fe*X,Fe=ie*le+xe*X+fe*q-ce*te,De=fe*le+xe*te+ce*X-ie*q,Ie=xe*le-ce*q-ie*X-fe*te;return u.rotateY(z,M,L),z[4]=je*(le=z[3])+Ie*(q=z[0])+Fe*(te=z[2])-De*(X=z[1]),z[5]=Fe*le+Ie*X+De*q-je*te,z[6]=De*le+Ie*te+je*X-Fe*q,z[7]=Ie*le-je*q-Fe*X-De*te,z},Be.rotateZ=function(z,M,L){var q=-M[0],X=-M[1],te=-M[2],le=M[3],ce=M[4],ie=M[5],fe=M[6],xe=M[7],je=ce*le+xe*q+ie*te-fe*X,Fe=ie*le+xe*X+fe*q-ce*te,De=fe*le+xe*te+ce*X-ie*q,Ie=xe*le-ce*q-ie*X-fe*te;return u.rotateZ(z,M,L),z[4]=je*(le=z[3])+Ie*(q=z[0])+Fe*(te=z[2])-De*(X=z[1]),z[5]=Fe*le+Ie*X+De*q-je*te,z[6]=De*le+Ie*te+je*X-Fe*q,z[7]=Ie*le-je*q-Fe*X-De*te,z},Be.rotateByQuatAppend=function(z,M,L){var q=L[0],X=L[1],te=L[2],le=L[3],ce=M[0],ie=M[1],fe=M[2],xe=M[3];return z[0]=ce*le+xe*q+ie*te-fe*X,z[1]=ie*le+xe*X+fe*q-ce*te,z[2]=fe*le+xe*te+ce*X-ie*q,z[3]=xe*le-ce*q-ie*X-fe*te,z[4]=(ce=M[4])*le+(xe=M[7])*q+(ie=M[5])*te-(fe=M[6])*X,z[5]=ie*le+xe*X+fe*q-ce*te,z[6]=fe*le+xe*te+ce*X-ie*q,z[7]=xe*le-ce*q-ie*X-fe*te,z},Be.rotateByQuatPrepend=function(z,M,L){var q=M[0],X=M[1],te=M[2],le=M[3],ce=L[0],ie=L[1],fe=L[2],xe=L[3];return z[0]=q*xe+le*ce+X*fe-te*ie,z[1]=X*xe+le*ie+te*ce-q*fe,z[2]=te*xe+le*fe+q*ie-X*ce,z[3]=le*xe-q*ce-X*ie-te*fe,z[4]=q*(xe=L[7])+le*(ce=L[4])+X*(fe=L[6])-te*(ie=L[5]),z[5]=X*xe+le*ie+te*ce-q*fe,z[6]=te*xe+le*fe+q*ie-X*ce,z[7]=le*xe-q*ce-X*ie-te*fe,z},Be.rotateAroundAxis=function(z,M,L,q){if(Math.abs(q)<s.EPSILON)return P(z,M);var X=Math.hypot(L[0],L[1],L[2]);q*=.5;var te=Math.sin(q),le=te*L[0]/X,ce=te*L[1]/X,ie=te*L[2]/X,fe=Math.cos(q),xe=M[0],je=M[1],Fe=M[2],De=M[3];z[0]=xe*fe+De*le+je*ie-Fe*ce,z[1]=je*fe+De*ce+Fe*le-xe*ie,z[2]=Fe*fe+De*ie+xe*ce-je*le,z[3]=De*fe-xe*le-je*ce-Fe*ie;var Ie=M[4],et=M[5],Ve=M[6],rt=M[7];return z[4]=Ie*fe+rt*le+et*ie-Ve*ce,z[5]=et*fe+rt*ce+Ve*le-Ie*ie,z[6]=Ve*fe+rt*ie+Ie*ce-et*le,z[7]=rt*fe-Ie*le-et*ce-Ve*ie,z},Be.add=function(z,M,L){return z[0]=M[0]+L[0],z[1]=M[1]+L[1],z[2]=M[2]+L[2],z[3]=M[3]+L[3],z[4]=M[4]+L[4],z[5]=M[5]+L[5],z[6]=M[6]+L[6],z[7]=M[7]+L[7],z},Be.multiply=O,Be.scale=function(z,M,L){return z[0]=M[0]*L,z[1]=M[1]*L,z[2]=M[2]*L,z[3]=M[3]*L,z[4]=M[4]*L,z[5]=M[5]*L,z[6]=M[6]*L,z[7]=M[7]*L,z},Be.lerp=function(z,M,L,q){var X=1-q;return B(M,L)<0&&(q=-q),z[0]=M[0]*X+L[0]*q,z[1]=M[1]*X+L[1]*q,z[2]=M[2]*X+L[2]*q,z[3]=M[3]*X+L[3]*q,z[4]=M[4]*X+L[4]*q,z[5]=M[5]*X+L[5]*q,z[6]=M[6]*X+L[6]*q,z[7]=M[7]*X+L[7]*q,z},Be.invert=function(z,M){var L=R(M);return z[0]=-M[0]/L,z[1]=-M[1]/L,z[2]=-M[2]/L,z[3]=M[3]/L,z[4]=-M[4]/L,z[5]=-M[5]/L,z[6]=-M[6]/L,z[7]=M[7]/L,z},Be.conjugate=function(z,M){return z[0]=-M[0],z[1]=-M[1],z[2]=-M[2],z[3]=M[3],z[4]=-M[4],z[5]=-M[5],z[6]=-M[6],z[7]=M[7],z},Be.normalize=function(z,M){var L=R(M);if(L>0){L=Math.sqrt(L);var q=M[0]/L,X=M[1]/L,te=M[2]/L,le=M[3]/L,ce=M[4],ie=M[5],fe=M[6],xe=M[7],je=q*ce+X*ie+te*fe+le*xe;z[0]=q,z[1]=X,z[2]=te,z[3]=le,z[4]=(ce-q*je)/L,z[5]=(ie-X*je)/L,z[6]=(fe-te*je)/L,z[7]=(xe-le*je)/L}return z},Be.str=function(z){return"quat2("+z[0]+", "+z[1]+", "+z[2]+", "+z[3]+", "+z[4]+", "+z[5]+", "+z[6]+", "+z[7]+")"},Be.exactEquals=function(z,M){return z[0]===M[0]&&z[1]===M[1]&&z[2]===M[2]&&z[3]===M[3]&&z[4]===M[4]&&z[5]===M[5]&&z[6]===M[6]&&z[7]===M[7]},Be.equals=function(z,M){var L=z[0],q=z[1],X=z[2],te=z[3],le=z[4],ce=z[5],ie=z[6],fe=z[7],xe=M[0],je=M[1],Fe=M[2],De=M[3],Ie=M[4],et=M[5],Ve=M[6],rt=M[7];return Math.abs(L-xe)<=s.EPSILON*Math.max(1,Math.abs(L),Math.abs(xe))&&Math.abs(q-je)<=s.EPSILON*Math.max(1,Math.abs(q),Math.abs(je))&&Math.abs(X-Fe)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(Fe))&&Math.abs(te-De)<=s.EPSILON*Math.max(1,Math.abs(te),Math.abs(De))&&Math.abs(le-Ie)<=s.EPSILON*Math.max(1,Math.abs(le),Math.abs(Ie))&&Math.abs(ce-et)<=s.EPSILON*Math.max(1,Math.abs(ce),Math.abs(et))&&Math.abs(ie-Ve)<=s.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Ve))&&Math.abs(fe-rt)<=s.EPSILON*Math.max(1,Math.abs(fe),Math.abs(rt))},Be.sqrLen=Be.squaredLength=Be.len=Be.length=Be.dot=Be.mul=Be.setReal=Be.getReal=void 0;var s=m(E()),u=m(Pe()),p=m(he());function v(z){if(typeof WeakMap!="function")return null;var M=new WeakMap,L=new WeakMap;return(v=function(q){return q?L:M})(z)}function m(z,M){if(z&&z.__esModule)return z;if(z===null||f(z)!=="object"&&typeof z!="function")return{default:z};var L=v(M);if(L&&L.has(z))return L.get(z);var q={},X=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in z)if(te!=="default"&&Object.prototype.hasOwnProperty.call(z,te)){var le=X?Object.getOwnPropertyDescriptor(z,te):null;le&&(le.get||le.set)?Object.defineProperty(q,te,le):q[te]=z[te]}return q.default=z,L&&L.set(z,q),q}function _(z,M,L){var q=.5*L[0],X=.5*L[1],te=.5*L[2],le=M[0],ce=M[1],ie=M[2],fe=M[3];return z[0]=le,z[1]=ce,z[2]=ie,z[3]=fe,z[4]=q*fe+X*ie-te*ce,z[5]=X*fe+te*le-q*ie,z[6]=te*fe+q*ce-X*le,z[7]=-q*le-X*ce-te*ie,z}function P(z,M){return z[0]=M[0],z[1]=M[1],z[2]=M[2],z[3]=M[3],z[4]=M[4],z[5]=M[5],z[6]=M[6],z[7]=M[7],z}function O(z,M,L){var q=M[0],X=M[1],te=M[2],le=M[3],ce=L[4],ie=L[5],fe=L[6],xe=L[7],je=M[4],Fe=M[5],De=M[6],Ie=M[7],et=L[0],Ve=L[1],rt=L[2],ot=L[3];return z[0]=q*ot+le*et+X*rt-te*Ve,z[1]=X*ot+le*Ve+te*et-q*rt,z[2]=te*ot+le*rt+q*Ve-X*et,z[3]=le*ot-q*et-X*Ve-te*rt,z[4]=q*xe+le*ce+X*fe-te*ie+je*ot+Ie*et+Fe*rt-De*Ve,z[5]=X*xe+le*ie+te*ce-q*fe+Fe*ot+Ie*Ve+De*et-je*rt,z[6]=te*xe+le*fe+q*ie-X*ce+De*ot+Ie*rt+je*Ve-Fe*et,z[7]=le*xe-q*ce-X*ie-te*fe+Ie*ot-je*et-Fe*Ve-De*rt,z}Be.getReal=u.copy,Be.setReal=u.copy,Be.mul=O;var B=u.dot;Be.dot=B;var k=u.length;Be.length=k,Be.len=k;var R=u.squaredLength;return Be.squaredLength=R,Be.sqrLen=R,Be}var We,tt,nt={};function Dt(){if(We)return nt;function f(M){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},f(M)}We=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.create=p,nt.clone=function(M){var L=new s.ARRAY_TYPE(2);return L[0]=M[0],L[1]=M[1],L},nt.fromValues=function(M,L){var q=new s.ARRAY_TYPE(2);return q[0]=M,q[1]=L,q},nt.copy=function(M,L){return M[0]=L[0],M[1]=L[1],M},nt.set=function(M,L,q){return M[0]=L,M[1]=q,M},nt.add=function(M,L,q){return M[0]=L[0]+q[0],M[1]=L[1]+q[1],M},nt.subtract=v,nt.multiply=m,nt.divide=_,nt.ceil=function(M,L){return M[0]=Math.ceil(L[0]),M[1]=Math.ceil(L[1]),M},nt.floor=function(M,L){return M[0]=Math.floor(L[0]),M[1]=Math.floor(L[1]),M},nt.min=function(M,L,q){return M[0]=Math.min(L[0],q[0]),M[1]=Math.min(L[1],q[1]),M},nt.max=function(M,L,q){return M[0]=Math.max(L[0],q[0]),M[1]=Math.max(L[1],q[1]),M},nt.round=function(M,L){return M[0]=Math.round(L[0]),M[1]=Math.round(L[1]),M},nt.scale=function(M,L,q){return M[0]=L[0]*q,M[1]=L[1]*q,M},nt.scaleAndAdd=function(M,L,q,X){return M[0]=L[0]+q[0]*X,M[1]=L[1]+q[1]*X,M},nt.distance=P,nt.squaredDistance=O,nt.length=B,nt.squaredLength=k,nt.negate=function(M,L){return M[0]=-L[0],M[1]=-L[1],M},nt.inverse=function(M,L){return M[0]=1/L[0],M[1]=1/L[1],M},nt.normalize=function(M,L){var q=L[0],X=L[1],te=q*q+X*X;return te>0&&(te=1/Math.sqrt(te)),M[0]=L[0]*te,M[1]=L[1]*te,M},nt.dot=function(M,L){return M[0]*L[0]+M[1]*L[1]},nt.cross=function(M,L,q){var X=L[0]*q[1]-L[1]*q[0];return M[0]=M[1]=0,M[2]=X,M},nt.lerp=function(M,L,q,X){var te=L[0],le=L[1];return M[0]=te+X*(q[0]-te),M[1]=le+X*(q[1]-le),M},nt.random=function(M,L){L=L||1;var q=2*s.RANDOM()*Math.PI;return M[0]=Math.cos(q)*L,M[1]=Math.sin(q)*L,M},nt.transformMat2=function(M,L,q){var X=L[0],te=L[1];return M[0]=q[0]*X+q[2]*te,M[1]=q[1]*X+q[3]*te,M},nt.transformMat2d=function(M,L,q){var X=L[0],te=L[1];return M[0]=q[0]*X+q[2]*te+q[4],M[1]=q[1]*X+q[3]*te+q[5],M},nt.transformMat3=function(M,L,q){var X=L[0],te=L[1];return M[0]=q[0]*X+q[3]*te+q[6],M[1]=q[1]*X+q[4]*te+q[7],M},nt.transformMat4=function(M,L,q){var X=L[0],te=L[1];return M[0]=q[0]*X+q[4]*te+q[12],M[1]=q[1]*X+q[5]*te+q[13],M},nt.rotate=function(M,L,q,X){var te=L[0]-q[0],le=L[1]-q[1],ce=Math.sin(X),ie=Math.cos(X);return M[0]=te*ie-le*ce+q[0],M[1]=te*ce+le*ie+q[1],M},nt.angle=function(M,L){var q=M[0],X=M[1],te=L[0],le=L[1],ce=Math.sqrt(q*q+X*X)*Math.sqrt(te*te+le*le);return Math.acos(Math.min(Math.max(ce&&(q*te+X*le)/ce,-1),1))},nt.zero=function(M){return M[0]=0,M[1]=0,M},nt.str=function(M){return"vec2("+M[0]+", "+M[1]+")"},nt.exactEquals=function(M,L){return M[0]===L[0]&&M[1]===L[1]},nt.equals=function(M,L){var q=M[0],X=M[1],te=L[0],le=L[1];return Math.abs(q-te)<=s.EPSILON*Math.max(1,Math.abs(q),Math.abs(te))&&Math.abs(X-le)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(le))},nt.forEach=nt.sqrLen=nt.sqrDist=nt.dist=nt.div=nt.mul=nt.sub=nt.len=void 0;var s=function(M,L){if(M&&M.__esModule)return M;if(M===null||f(M)!=="object"&&typeof M!="function")return{default:M};var q=u(void 0);if(q&&q.has(M))return q.get(M);var X={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var le in M)if(le!=="default"&&Object.prototype.hasOwnProperty.call(M,le)){var ce=te?Object.getOwnPropertyDescriptor(M,le):null;ce&&(ce.get||ce.set)?Object.defineProperty(X,le,ce):X[le]=M[le]}return X.default=M,q&&q.set(M,X),X}(E());function u(M){if(typeof WeakMap!="function")return null;var L=new WeakMap,q=new WeakMap;return(u=function(X){return X?q:L})(M)}function p(){var M=new s.ARRAY_TYPE(2);return s.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0),M}function v(M,L,q){return M[0]=L[0]-q[0],M[1]=L[1]-q[1],M}function m(M,L,q){return M[0]=L[0]*q[0],M[1]=L[1]*q[1],M}function _(M,L,q){return M[0]=L[0]/q[0],M[1]=L[1]/q[1],M}function P(M,L){return Math.hypot(L[0]-M[0],L[1]-M[1])}function O(M,L){var q=L[0]-M[0],X=L[1]-M[1];return q*q+X*X}function B(M){return Math.hypot(M[0],M[1])}function k(M){var L=M[0],q=M[1];return L*L+q*q}nt.len=B,nt.sub=v,nt.mul=m,nt.div=_,nt.dist=P,nt.sqrDist=O,nt.sqrLen=k;var R,z=(R=p(),function(M,L,q,X,te,le){var ce,ie;for(L||(L=2),q||(q=0),ie=X?Math.min(X*L+q,M.length):M.length,ce=q;ce<ie;ce+=L)R[0]=M[ce],R[1]=M[ce+1],te(R,R,le),M[ce]=R[0],M[ce+1]=R[1];return M});return nt.forEach=z,nt}function nr(){if(tt)return S;function f(M){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},f(M)}tt=1,Object.defineProperty(S,"__esModule",{value:!0}),S.vec4=S.vec3=S.vec2=S.quat2=S.quat=S.mat4=S.mat3=S.mat2d=S.mat2=S.glMatrix=void 0;var s=z(E());S.glMatrix=s;var u=z(I());S.mat2=u;var p=z(K());S.mat2d=p;var v=z(ee());S.mat3=v;var m=z(he());S.mat4=m;var _=z(Pe());S.quat=_;var P=z(Ge());S.quat2=P;var O=z(Dt());S.vec2=O;var B=z(be());S.vec3=B;var k=z(we());function R(M){if(typeof WeakMap!="function")return null;var L=new WeakMap,q=new WeakMap;return(R=function(X){return X?q:L})(M)}function z(M,L){if(M&&M.__esModule)return M;if(M===null||f(M)!=="object"&&typeof M!="function")return{default:M};var q=R(L);if(q&&q.has(M))return q.get(M);var X={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var le in M)if(le!=="default"&&Object.prototype.hasOwnProperty.call(M,le)){var ce=te?Object.getOwnPropertyDescriptor(M,le):null;ce&&(ce.get||ce.set)?Object.defineProperty(X,le,ce):X[le]=M[le]}return X.default=M,q&&q.set(M,X),X}return S.vec4=k,S}var ir,rr,or,Ft,ze=nr(),Pr=function(){if(rr)return ir;function f(s,u,p,v){this.cx=3*s,this.bx=3*(p-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(v-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=u,this.p2x=p,this.p2y=v}return rr=1,ir=f,f.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,u){if(u===void 0&&(u=1e-6),s<0)return 0;if(s>1)return 1;for(var p=s,v=0;v<8;v++){var m=this.sampleCurveX(p)-s;if(Math.abs(m)<u)return p;var _=this.sampleCurveDerivativeX(p);if(Math.abs(_)<1e-6)break;p-=m/_}var P=0,O=1;for(p=s,v=0;v<20&&(m=this.sampleCurveX(p),!(Math.abs(m-s)<u));v++)s>m?P=p:O=p,p=.5*(O-P)+P;return p},solve:function(s,u){return this.sampleCurveY(this.solveCurveX(s,u))}},ir}(),Kt=x(Pr);function on(){if(Ft)return or;function f(s,u){this.x=s,this.y=u}return Ft=1,or=f,f.prototype={clone:function(){return new f(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,u){return this.clone()._rotateAround(s,u)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var u=s.x-this.x,p=s.y-this.y;return u*u+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,u){return Math.atan2(this.x*u-this.y*s,this.x*s+this.y*u)},_matMult:function(s){var u=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=u,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var u=Math.cos(s),p=Math.sin(s),v=p*this.x+u*this.y;return this.x=u*this.x-p*this.y,this.y=v,this},_rotateAround:function(s,u){var p=Math.cos(s),v=Math.sin(s),m=u.y+v*(this.x-u.x)+p*(this.y-u.y);return this.x=u.x+p*(this.x-u.x)-v*(this.y-u.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},f.convert=function(s){return s instanceof f?s:Array.isArray(s)?new f(s[0],s[1]):s},or}var Rt=x(on());function En(f,s){if(Array.isArray(f)){if(!Array.isArray(s)||f.length!==s.length)return!1;for(let u=0;u<f.length;u++)if(!En(f[u],s[u]))return!1;return!0}if(typeof f=="object"&&f!==null&&s!==null){if(typeof s!="object"||Object.keys(f).length!==Object.keys(s).length)return!1;for(const u in f)if(!En(f[u],s[u]))return!1;return!0}return f===s}const Vn=Math.PI/180,pi=180/Math.PI;function dt(f){return f*Vn}function Ot(f){return f*pi}const Zt=[[0,0],[1,0],[1,1],[0,1]];function Cr(f){if(f<=0)return 0;if(f>=1)return 1;const s=f*f,u=s*f;return 4*(f<.5?u:3*(f-s)+u-.75)}function vr(f,s,u,p){const v=new Kt(f,s,u,p);return function(m){return v.solve(m)}}const Sr=vr(.25,.1,.25,1);function pr(f,s,u){return Math.min(u,Math.max(s,f))}function Mn(f,s,u){return(u=pr((u-f)/(s-f),0,1))*u*(3-2*u)}function Ai(f,s,u){const p=u-s,v=((f-s)%p+p)%p+s;return v===s?u:v}function Vi(f,s,u){if(!f.length)return u(null,[]);let p=f.length;const v=new Array(f.length);let m=null;f.forEach((_,P)=>{s(_,(O,B)=>{O&&(m=O),v[P]=B,--p==0&&u(m,v)})})}function Ui(f,...s){for(const u of s)for(const p in u)f[p]=u[p];return f}let xo=1;function Wa(){return xo++}function Qs(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))}function Eo(f,s){f.forEach(u=>{s[u]&&(s[u]=s[u].bind(s))})}function ss(f,s){return f.indexOf(s,f.length-s.length)!==-1}function ac(f,s,u){const p={};for(const v in f)p[v]=s.call(this,f[v],v,f);return p}function Il(f,s,u){const p={};for(const v in f)s.call(this,f[v],v,f)&&(p[v]=f[v]);return p}function $s(f){return Array.isArray(f)?f.map($s):typeof f=="object"&&f?ac(f,$s):f}const sc={};function ln(f){sc[f]||(typeof console<"u"&&console.warn(f),sc[f]=!0)}function os(f,s,u){return(u.y-f.y)*(s.x-f.x)>(s.y-f.y)*(u.x-f.x)}function qu(f){let s=0;for(let u,p,v=0,m=f.length,_=m-1;v<m;_=v++)u=f[v],p=f[_],s+=(p.x-u.x)*(u.y+p.y);return s}function Ha([f,s,u]){const p=dt(s+90),v=dt(u);return{x:f*Math.cos(p)*Math.sin(v),y:f*Math.sin(p)*Math.sin(v),z:f*Math.cos(v),azimuthal:s,polar:u}}function eo(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Gn(f){const s={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,p,v,m)=>{const _=v||m;return s[p]=!_||_.toLowerCase(),""}),s["max-age"]){const u=parseInt(s["max-age"],10);isNaN(u)?delete s["max-age"]:s["max-age"]=u}return s}let va=null;function Ea(f,s){return[f[4*s],f[4*s+1],f[4*s+2],f[4*s+3]]}function Es(f,s,u,p){for(;s<u;){const v=s+u>>1;f[v]<p?s=v+1:u=v}return s}function Ll(f,s,u,p){for(;s<u;){const v=s+u>>1;f[v]<=p?s=v+1:u=v}return s}function Ma(f){return f>0?1/(1.001-f):1+f}function qs(f){return f>0?1-1/(1.001-f):-f}const $i={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!$i.API_URL)return null;try{const f=new URL($i.API_URL);return f.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":f.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Ms(f){return $i.API_URL_REGEX.test(f)}function gs(f){return $i.API_SPRITE_REGEX.test(f)}let Gu,Xi,Ko,St,ve,ke;function Oe(){return Gu==null&&(Gu=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Gu}const Ye={now:()=>St!==void 0?St:performance.now(),setNow(f){St=f},restoreNow(){St=void 0},frame(f){const s=requestAnimationFrame(f);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(f,s=0){const{width:u,height:p}=f;ve||(ve=document.createElement("canvas"));const v=ve.getContext("2d",{willReadFrequently:!0});if(!v)throw new Error("failed to create canvas 2d context");return(u>ve.width||p>ve.height)&&(ve.width=u,ve.height=p),v.clearRect(-s,-s,u+2*s,p+2*s),v.drawImage(f,0,0,u,p),v.getImageData(-s,-s,u+2*s,p+2*s)},resolveURL:f=>(Xi||(Xi=document.createElement("a")),Xi.href=f,Xi.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Ko==null&&(Ko=window.matchMedia("(prefers-reduced-motion: reduce)")),Ko.matches)},hasCanvasFingerprintNoise(){if(ke!==void 0)return ke;if(!Oe())return ke=!1,!1;const f=new OffscreenCanvas(85,1),s=f.getContext("2d",{willReadFrequently:!0});let u=0;for(let v=0;v<f.width;++v)s.fillStyle=`rgba(${u++},${u++},${u++}, 255)`,s.fillRect(v,0,1,1);const p=s.getImageData(0,0,f.width,f.height);u=0;for(let v=0;v<p.data.length;++v)if(v%4!=3&&u++!==p.data[v])return ke=!0,!0;return ke=!1,!1}};function Je(f,s){const u=f.indexOf("?");if(u<0)return`${f}?${new URLSearchParams(s).toString()}`;const p=new URLSearchParams(f.slice(u));for(const v in s)p.set(v,s[v]);return`${f.slice(0,u)}?${p.toString()}`}function st(f,s={persistentParams:[]}){const u=f.indexOf("?");if(u<0)return f;const p=new URLSearchParams,v=new URLSearchParams(f.slice(u));for(const _ of s.persistentParams){const P=v.get(_);P&&p.set(_,P)}const m=p.toString();return`${f.slice(0,u)}${m.length>0?`?${m}`:""}`}const gt="mapbox-tiles";let lt=500,wt=50;const bt=["language","worldview","jobid"];let Nt,Bt;function ar(){try{return caches}catch{}}function sr(){const f=ar();f&&Nt==null&&(Nt=f.open(gt))}let Nr=1/0;const $r={supported:!1,testSupport:function(f){!On&&Vr&&(Hn?$n(f):Ur=f)}};let Ur,Vr,On=!1,Hn=!1;const Tn=typeof self<"u"?self:{};function $n(f){const s=f.createTexture();f.bindTexture(f.TEXTURE_2D,s);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,Vr),f.isContextLost())return;$r.supported=!0}catch{}f.deleteTexture(s),On=!0}Tn.document&&(Vr=Tn.document.createElement("img"),Vr.onload=function(){Ur&&$n(Ur),Ur=null,Hn=!0},Vr.onerror=function(){On=!0,Ur=null},Vr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Rn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Rn);class Oa extends Error{constructor(s,u,p){u===401&&Ms(p)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=u,this.url=p}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ys=eo()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Ka=function(f,s){if(!(/^file:/.test(u=f.url)||/^file:/.test(ys())&&!/^\w+:/.test(u))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(p,v){const m=new AbortController,_=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:ys(),referrerPolicy:p.referrerPolicy,signal:m.signal});let P=!1,O=!1;const B=(k=_.url).indexOf("sku=")>0&&Ms(k);var k;p.type==="json"&&_.headers.set("Accept","application/json");const R=(M,L,q)=>{if(O)return;if(M&&M.message!=="SecurityError"&&ln(M.toString()),L&&q)return z(L);const X=Date.now();fetch(_).then(te=>{if(te.ok){const le=B?te.clone():null;return z(te,le,X)}return v(new Oa(te.statusText,te.status,p.url))}).catch(te=>{te.name!=="AbortError"&&v(new Error(`${te.message} ${p.url}`))})},z=(M,L,q)=>{(p.type==="arrayBuffer"?M.arrayBuffer():p.type==="json"?M.json():M.text()).then(X=>{O||(L&&q&&function(te,le,ce){if(sr(),Nt==null)return;const ie=Gn(le.headers.get("Cache-Control")||"");if(ie["no-store"])return;const fe={status:le.status,statusText:le.statusText,headers:new Headers};le.headers.forEach((Fe,De)=>fe.headers.set(De,Fe)),ie["max-age"]&&fe.headers.set("Expires",new Date(ce+1e3*ie["max-age"]).toUTCString());const xe=fe.headers.get("Expires");if(!xe||new Date(xe).getTime()-ce<42e4)return;let je=st(te.url,{persistentParams:bt});if(le.status===206){const Fe=te.headers.get("Range");if(!Fe)return;fe.status=200,je=Je(je,{range:Fe})}(function(Fe,De){if(Bt===void 0)try{new Response(new ReadableStream),Bt=!0}catch{Bt=!1}Bt?De(Fe.body):Fe.blob().then(De)})(le,Fe=>{const De=new Response((Ie=le.status)!==200&&Ie!==404&&[101,103,204,205,304].includes(Ie)?null:Fe,fe);var Ie;sr(),Nt!=null&&Nt.then(et=>et.put(je,De)).catch(et=>ln(et.message))})}(_,L,q),P=!0,v(null,X,M.headers.get("Cache-Control"),M.headers.get("Expires")))}).catch(X=>{O||v(new Error(X.message))})};return B?function(M,L){if(sr(),Nt==null)return L(null);Nt.then(q=>{let X=st(M.url,{persistentParams:bt});const te=M.headers.get("Range");te&&(X=Je(X,{range:te})),q.match(X).then(le=>{const ce=function(ie){if(!ie)return!1;const fe=new Date(ie.headers.get("Expires")||0),xe=Gn(ie.headers.get("Cache-Control")||"");return fe>Date.now()&&!xe["no-cache"]}(le);q.delete(X),ce&&q.put(X,le.clone()),L(null,le,ce)}).catch(L)}).catch(L)}(_,R):R(null,null),{cancel:()=>{O=!0,P||m.abort()}}}(f,s);if(eo()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,s,void 0,!0)}var u;return function(p,v){const m=new XMLHttpRequest;m.open(p.method||"GET",p.url,!0),p.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const _ in p.headers)m.setRequestHeader(_,p.headers[_]);return p.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=p.credentials==="include",m.onerror=()=>{v(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let _=m.response;if(p.type==="json")try{_=JSON.parse(m.response)}catch(P){return v(P)}v(null,_,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else v(new Oa(m.statusText,m.status,p.url))},m.send(p.body),{cancel:()=>m.abort()}}(f,s)},ls=function(f,s){return Ka(Ui(f,{type:"arrayBuffer"}),s)};function vo(f){const s=document.createElement("a");return s.href=f,s.protocol===location.protocol&&s.host===location.host}const Wu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Dl,iu;Dl=[],iu=0;const sf=function(f,s){if($r.supported&&(f.headers||(f.headers={}),f.headers.accept="image/webp,*/*"),iu>=$i.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:f,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return Dl.push(m),m}iu++;let u=!1;const p=()=>{if(!u)for(u=!0,iu--;Dl.length&&iu<$i.MAX_PARALLEL_IMAGE_REQUESTS;){const m=Dl.shift(),{requestParameters:_,callback:P,cancelled:O}=m;O||(m.cancel=sf(_,P).cancel)}},v=ls(f,(m,_,P,O)=>{p(),m?s(m):_&&(self.createImageBitmap?function(B,k){const R=new Blob([new Uint8Array(B)],{type:"image/png"});createImageBitmap(R).then(z=>{k(null,z)}).catch(z=>{k(new Error(`Could not load image because of ${z.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(B,k)=>s(B,k,P,O)):function(B,k){const R=new Image;R.onload=()=>{k(null,R),URL.revokeObjectURL(R.src),R.onload=null,requestAnimationFrame(()=>{R.src=Wu})},R.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const z=new Blob([new Uint8Array(B)],{type:"image/png"});R.src=B.byteLength?URL.createObjectURL(z):Wu}(_,(B,k)=>s(B,k,P,O)))});return{cancel:()=>{v.cancel(),p()}}};var ox,vy,_p,to={exports:{}},yl={exports:{}},xl={exports:{}},kc=function(){if(_p)return to.exports;_p=1;var f=(ox||(ox=1,yl.exports=function(u,p){var v,m,_,P,O,B,k,R;for(m=u.length-(v=3&u.length),_=p,O=3432918353,B=461845907,R=0;R<m;)k=255&u.charCodeAt(R)|(255&u.charCodeAt(++R))<<8|(255&u.charCodeAt(++R))<<16|(255&u.charCodeAt(++R))<<24,++R,_=27492+(65535&(P=5*(65535&(_=(_^=k=(65535&(k=(k=(65535&k)*O+(((k>>>16)*O&65535)<<16)&4294967295)<<15|k>>>17))*B+(((k>>>16)*B&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(P>>>16)&65535)<<16);switch(k=0,v){case 3:k^=(255&u.charCodeAt(R+2))<<16;case 2:k^=(255&u.charCodeAt(R+1))<<8;case 1:_^=k=(65535&(k=(k=(65535&(k^=255&u.charCodeAt(R)))*O+(((k>>>16)*O&65535)<<16)&4294967295)<<15|k>>>17))*B+(((k>>>16)*B&65535)<<16)&4294967295}return _^=u.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),yl.exports),s=(vy||(vy=1,xl.exports=function(u,p){for(var v,m=u.length,_=p^m,P=0;m>=4;)v=1540483477*(65535&(v=255&u.charCodeAt(P)|(255&u.charCodeAt(++P))<<8|(255&u.charCodeAt(++P))<<16|(255&u.charCodeAt(++P))<<24))+((1540483477*(v>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),m-=4,++P;switch(m){case 3:_^=(255&u.charCodeAt(P+2))<<16;case 2:_^=(255&u.charCodeAt(P+1))<<8;case 1:_=1540483477*(65535&(_^=255&u.charCodeAt(P)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),xl.exports);return to.exports=f,to.exports.murmur3=f,to.exports.murmur2=s,to.exports}(),vl=x(kc);class xi{constructor(s,...u){Ui(this,u[0]||{}),this.type=s}}class bp extends xi{constructor(s,u={}){super("error",Ui({error:s},u))}}function zm(f,s,u){u[f]&&u[f].indexOf(s)!==-1||(u[f]=u[f]||[],u[f].push(s))}function Pc(f,s,u){if(u&&u[f]){const p=u[f].indexOf(s);p!==-1&&u[f].splice(p,1)}}class au{on(s,u){return this._listeners=this._listeners||{},zm(s,u,this._listeners),this}off(s,u){return Pc(s,u,this._listeners),Pc(s,u,this._oneTimeListeners),this}once(s,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},zm(s,u,this._oneTimeListeners),this):new Promise(p=>this.once(s,p))}fire(s,u){const p=typeof s=="string"?new xi(s,u):s,v=p.type;if(this.listens(v)){p.target=this;const m=this._listeners&&this._listeners[v]?this._listeners[v].slice():[];for(const O of m)O.call(this,p);const _=this._oneTimeListeners&&this._oneTimeListeners[v]?this._oneTimeListeners[v].slice():[];for(const O of _)Pc(v,O,this._oneTimeListeners),O.call(this,p);const P=this._eventedParent;P&&(Ui(p,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),P.fire(p))}else p instanceof bp&&console.error(p.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,u){return this._eventedParent=s,this._eventedParentData=u,this}}var _y,Bm={},Zo=function(){if(_y)return Bm;_y=1;var f={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(m){return(m=Math.round(m))<0?0:m>255?255:m}function u(m){return s(m[m.length-1]==="%"?parseFloat(m)/100*255:parseInt(m))}function p(m){return(_=m[m.length-1]==="%"?parseFloat(m)/100:parseFloat(m))<0?0:_>1?1:_;var _}function v(m,_,P){return P<0?P+=1:P>1&&(P-=1),6*P<1?m+(_-m)*P*6:2*P<1?_:3*P<2?m+(_-m)*(2/3-P)*6:m}try{Bm.parseCSSColor=function(m){var _,P=m.replace(/ /g,"").toLowerCase();if(P in f)return f[P].slice();if(P[0]==="#")return P.length===4?(_=parseInt(P.substr(1),16))>=0&&_<=4095?[(3840&_)>>4|(3840&_)>>8,240&_|(240&_)>>4,15&_|(15&_)<<4,1]:null:P.length===7&&(_=parseInt(P.substr(1),16))>=0&&_<=16777215?[(16711680&_)>>16,(65280&_)>>8,255&_,1]:null;var O=P.indexOf("("),B=P.indexOf(")");if(O!==-1&&B+1===P.length){var k=P.substr(0,O),R=P.substr(O+1,B-(O+1)).split(","),z=1;switch(k){case"rgba":if(R.length!==4)return null;z=p(R.pop());case"rgb":return R.length!==3?null:[u(R[0]),u(R[1]),u(R[2]),z];case"hsla":if(R.length!==4)return null;z=p(R.pop());case"hsl":if(R.length!==3)return null;var M=(parseFloat(R[0])%360+360)%360/360,L=p(R[1]),q=p(R[2]),X=q<=.5?q*(L+1):q+L-q*L,te=2*q-X;return[s(255*v(te,X,M+1/3)),s(255*v(te,X,M)),s(255*v(te,X,M-1/3)),z];default:return null}}return null}}catch{}return Bm}();class Xn{constructor(s,u,p,v=1){this.r=s,this.g=u,this.b=p,this.a=v}static parse(s){if(!s)return;if(s instanceof Xn)return s;if(typeof s!="string")return;const u=Zo.parseCSSColor(s);return u?new Xn(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toStringPremultipliedAlpha(){const[s,u,p,v]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(s)},${Math.round(u)},${Math.round(p)},${v})`}toString(){const[s,u,p,v]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*s)},${Math.round(255*u)},${Math.round(255*p)},${v})`}toRenderColor(s){const{r:u,g:p,b:v,a:m}=this;return new Cc(s,u,p,v,m)}clone(){return new Xn(this.r,this.g,this.b,this.a)}}class Cc{constructor(s,u,p,v,m){if(s){const _=s.image.height,P=_*_;u=m===0?0:u/m*(_-1),p=m===0?0:p/m*(_-1),v=m===0?0:v/m*(_-1);const O=Math.floor(u),B=Math.floor(p),k=Math.floor(v),R=Math.ceil(u),z=Math.ceil(p),M=Math.ceil(v),L=u-O,q=p-B,X=v-k,te=s.image.data,le=4*(O+B*P+k*_),ce=4*(O+B*P+M*_),ie=4*(O+z*P+k*_),fe=4*(O+z*P+M*_),xe=4*(R+B*P+k*_),je=4*(R+B*P+M*_),Fe=4*(R+z*P+k*_),De=4*(R+z*P+M*_);if(le<0||De>=te.length)throw new Error("out of range");this.r=Fr(Fr(Fr(te[le],te[ce],X),Fr(te[ie],te[fe],X),q),Fr(Fr(te[xe],te[je],X),Fr(te[Fe],te[De],X),q),L)/255*m,this.g=Fr(Fr(Fr(te[le+1],te[ce+1],X),Fr(te[ie+1],te[fe+1],X),q),Fr(Fr(te[xe+1],te[je+1],X),Fr(te[Fe+1],te[De+1],X),q),L)/255*m,this.b=Fr(Fr(Fr(te[le+2],te[ce+2],X),Fr(te[ie+2],te[fe+2],X),q),Fr(Fr(te[xe+2],te[je+2],X),Fr(te[Fe+2],te[De+2],X),q),L)/255*m,this.a=m}else this.r=u,this.g=p,this.b=v,this.a=m}toArray(){const{r:s,g:u,b:p,a:v}=this;return v===0?[0,0,0,0]:[255*s/v,255*u/v,255*p/v,v]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:s,g:u,b:p,a:v}=this,m=Math.min(Math.max(s/v,0),1),_=Math.min(Math.max(u/v,0),1),P=Math.min(Math.max(p/v,0),1),O=Math.min(m,_,P),B=Math.max(m,_,P),k=(O+B)/2;if(O===B)return[0,0,100*k,v];const R=B-O,z=k>.5?R/(2-B-O):R/(B+O);let M=0;return B===m?M=(_-P)/R+(_<P?6:0):B===_?M=(P-m)/R+2:B===P&&(M=(m-_)/R+4),M*=60,[Math.min(Math.max(M,0),360),Math.min(Math.max(100*z,0),100),Math.min(Math.max(100*k,0),100),v]}toArray01(){const{r:s,g:u,b:p,a:v}=this;return v===0?[0,0,0,0]:[s/v,u/v,p/v,v]}toArray01Scaled(s){const{r:u,g:p,b:v,a:m}=this;return m===0?[0,0,0]:[u/m*s,p/m*s,v/m*s]}toArray01PremultipliedAlpha(){const{r:s,g:u,b:p,a:v}=this;return[s,u,p,v]}toArray01Linear(){const{r:s,g:u,b:p,a:v}=this;return v===0?[0,0,0,0]:[Math.pow(s/v,2.2),Math.pow(u/v,2.2),Math.pow(p/v,2.2),v]}}function Fr(f,s,u){return f*(1-u)+s*u}function su(f,s,u){return f.map((p,v)=>Fr(p,s[v],u))}Xn.black=new Xn(0,0,0,1),Xn.white=new Xn(1,1,1,1),Xn.transparent=new Xn(0,0,0,0),Xn.red=new Xn(1,0,0,1),Xn.blue=new Xn(0,0,1,1);var Hu=Object.freeze({__proto__:null,array:su,color:function(f,s,u){return new Xn(Fr(f.r,s.r,u),Fr(f.g,s.g,u),Fr(f.b,s.b,u),Fr(f.a,s.a,u))},number:Fr});function Ku(f,...s){for(const u of s)for(const p in u)f[p]=u[p];return f}class xn extends Error{constructor(s,u){super(u),this.message=u,this.key=s}}class Vm{constructor(s,u=[]){this.parent=s,this.bindings={};for(const[p,v]of u)this.bindings[p]=v}concat(s){return new Vm(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const Zu={kind:"null"},br={kind:"number"},mi={kind:"string"},Wn={kind:"boolean"},xs={kind:"color"},Ec={kind:"object"},ii={kind:"value"},ou={kind:"collator"},Yo={kind:"formatted"},Mc={kind:"resolvedImage"};function Za(f,s){return{kind:"array",itemType:f,N:s}}function _a(f){if(f.kind==="array"){const s=_a(f.itemType);return typeof f.N=="number"?`array<${s}, ${f.N}>`:f.itemType.kind==="value"?"array":`array<${s}>`}return f.kind}const by=[Zu,br,mi,Wn,xs,Yo,Ec,Za(ii),Mc];function ro(f,s){if(s.kind==="error")return null;if(f.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!ro(f.itemType,s.itemType))&&(typeof f.N!="number"||f.N===s.N))return null}else{if(f.kind===s.kind)return null;if(f.kind==="value"){for(const u of by)if(!ro(u,s))return null}}return`Expected ${_a(f)} but found ${_a(s)} instead.`}function Wd(f,s){return s.some(u=>u.kind===f.kind)}function Hd(f,s){return s.some(u=>u==="null"?f===null:u==="array"?Array.isArray(f):u==="object"?f&&!Array.isArray(f)&&typeof f=="object":u===typeof f)}class wp{constructor(s,u,p){this.sensitivity=s?u?"variant":"case":u?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,u){return this.collator.compare(s,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Fl{constructor(s,u,p,v,m){this.text=s.normalize?s.normalize():s,this.image=u,this.scale=p,this.fontStack=v,this.textColor=m}}class Os{constructor(s){this.sections=s}static fromString(s){return new Os([new Fl(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.namePrimary)}static factory(s){return s instanceof Os?s:Os.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const u of this.sections){if(u.image){s.push(["image",u.image.namePrimary]);continue}s.push(u.text);const p={};u.fontStack&&(p["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(p["font-scale"]=u.scale),u.textColor&&(p["text-color"]=["rgba"].concat(u.textColor.toRenderColor(null).toArray())),s.push(p)}return s}}class _l{constructor(s,u){if(this.id=s,this.options=u||{params:{}},this.options.transform){const{a:p,b:v,c:m,d:_,e:P,f:O}=this.options.transform;this.options.transform=new DOMMatrix([p,v,m,_,P,O])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeId(s){return JSON.parse(s).id}static deserializeFromString(s){const u=JSON.parse(s),{a:p,b:v,c:m,d:_,e:P,f:O}=u.options.transform;return new DOMMatrix([p,v,m,_,P,O]),new _l(u.id,u.options)}scaleSelf(s){return this.options.transform=this.options.transform.scale(s),this}serialize(){const s={id:this.id};this.options&&(s.options=this.options);const{a:u,b:p,c:v,d:m,e:_,f:P}=this.options.transform;return s.options.transform={a:u,b:p,c:v,d:m,e:_,f:P},JSON.stringify(s)}}class Rs{constructor(s){this.namePrimary=s.namePrimary,s.nameSecondary&&(this.nameSecondary=s.nameSecondary),s.optionsPrimary&&(this.optionsPrimary=s.optionsPrimary),s.optionsSecondary&&(this.optionsSecondary=s.optionsSecondary),this.available=s.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new _l(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new _l(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(s){return typeof s=="string"?Rs.build(s):s}static build(s,u,p,v){return s?new Rs({namePrimary:s,nameSecondary:u,optionsPrimary:p,optionsSecondary:v,available:!1}):null}}function of(f,s,u,p){return typeof f=="number"&&f>=0&&f<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof u=="number"&&u>=0&&u<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[f,s,u,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[f,s,u,p]:[f,s,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function zl(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof Xn||f instanceof wp||f instanceof Os||f instanceof Rs)return!0;if(Array.isArray(f)){for(const s of f)if(!zl(s))return!1;return!0}if(typeof f=="object"){for(const s in f)if(!zl(f[s]))return!1;return!0}return!1}function oa(f){if(f===null)return Zu;if(typeof f=="string")return mi;if(typeof f=="boolean")return Wn;if(typeof f=="number")return br;if(f instanceof Xn)return xs;if(f instanceof wp)return ou;if(f instanceof Os)return Yo;if(f instanceof Rs)return Mc;if(Array.isArray(f)){const s=f.length;let u;for(const p of f){const v=oa(p);if(u){if(u===v)continue;u=ii;break}u=v}return Za(u||ii,s)}return Ec}function Ra(f){const s=typeof f;return f===null?"":s==="string"||s==="number"||s==="boolean"?String(f):f instanceof Xn?f.toStringPremultipliedAlpha():f instanceof Os||f instanceof Rs?f.toString():JSON.stringify(f)}class Ia{constructor(s,u){this.type=s,this.value=u}static parse(s,u){if(s.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!zl(s[1]))return u.error("invalid value");const p=s[1];let v=oa(p);const m=u.expectedType;return v.kind!=="array"||v.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(v=m),new Ia(v,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Xn?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Os?this.value.serialize():this.value}}class ba{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const lu={string:mi,number:br,boolean:Wn,object:Ec};class oc{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");let p,v=1;const m=s[0];if(m==="array"){let P,O;if(s.length>2){const B=s[1];if(typeof B!="string"||!(B in lu)||B==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);P=lu[B],v++}else P=ii;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return u.error('The length argument to "array" must be a positive integer literal',2);O=s[2],v++}p=Za(P,O)}else p=lu[m];const _=[];for(;v<s.length;v++){const P=u.parse(s[v],v,ii);if(!P)return null;_.push(P)}return new oc(p,_)}evaluate(s){for(let u=0;u<this.args.length;u++){const p=this.args[u].evaluate(s);if(!ro(this.type,oa(p)))return p;if(u===this.args.length-1)throw new ba(`The expression ${JSON.stringify(this.args[u].serialize())} evaluated to ${_a(oa(p))} but was expected to be of type ${_a(this.type)}.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,u=[s.kind];if(s.kind==="array"){const p=s.itemType;if(p.kind==="string"||p.kind==="number"||p.kind==="boolean"){u.push(p.kind);const v=s.N;(typeof v=="number"||this.args.length>1)&&u.push(v)}}return u.concat(this.args.map(p=>p.serialize()))}}class cu{constructor(s){this.type=Yo,this.sections=s}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");const p=s[1];if(!Array.isArray(p)&&typeof p=="object")return u.error("First argument must be an image or text section.");const v=[];let m=!1;for(let _=1;_<=s.length-1;++_){const P=s[_];if(m&&typeof P=="object"&&!Array.isArray(P)){m=!1;let O=null;if(P["font-scale"]&&(O=u.parseObjectValue(P["font-scale"],_,"font-scale",br),!O))return null;let B=null;if(P["text-font"]&&(B=u.parseObjectValue(P["text-font"],_,"text-font",Za(mi)),!B))return null;let k=null;if(P["text-color"]&&(k=u.parseObjectValue(P["text-color"],_,"text-color",xs),!k))return null;const R=v[v.length-1];R.scale=O,R.font=B,R.textColor=k}else{const O=u.parse(s[_],_,ii);if(!O)return null;const B=O.type.kind;if(B!=="string"&&B!=="value"&&B!=="null"&&B!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,v.push({content:O,scale:null,font:null,textColor:null})}}return new cu(v)}evaluate(s){return new Os(this.sections.map(u=>{const p=u.content.evaluate(s);return oa(p)===Mc?new Fl("",p,null,null,null):new Fl(Ra(p),null,u.scale?u.scale.evaluate(s):null,u.font?u.font.evaluate(s).join(","):null,u.textColor?u.textColor.evaluate(s):null)}))}eachChild(s){for(const u of this.sections)s(u.content),u.scale&&s(u.scale),u.font&&s(u.font),u.textColor&&s(u.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const u of this.sections){s.push(u.content.serialize());const p={};u.scale&&(p["font-scale"]=u.scale.serialize()),u.font&&(p["text-font"]=u.font.serialize()),u.textColor&&(p["text-color"]=u.textColor.serialize()),s.push(p)}return s}}class Kd{constructor(s,u,p,v){this._imageWarnHistory={},this.type=Mc,this.inputPrimary=s,this.inputSecondary=u,this.inputPrimaryParams=p,this.inputSecondaryParams=v}static parse(s,u){if(s.length<2)return u.error("Expected two or more arguments.");let p=1;const v=[];function m(){if(p<s.length){const P=u.parse(s[p],p++,mi);return P?(v.push({image:P,options:void 0}),!0):(u.error(v.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function _(){if(p<s.length){if((P=s[p])===null||typeof P!="object"||Array.isArray(P))return!0;const O=s[p].params,B=u.concat(p);if(!O)return p++,!0;if(typeof O!="object"||O.constructor!==Object)return B.error('Image options "params" should be an object'),!1;const k={},R=B.concat(void 0,"params");for(const z in O){if(!z)return R.error("Image parameter name should be non-empty"),!1;const M=R.concat(void 0,z).parse(O[z],void 0,xs,void 0,{typeAnnotation:"coerce"});if(!M)return!1;k[z]=M}return v[v.length-1].options=k,p++,!0}var P;return!0}for(let P=0;P<2;P++)if(!m()||!_())return;return new Kd(v[0].image,v[1]?v[1].image:void 0,v[0].options,v[1]?v[1].options:void 0)}evaluateParams(s,u){const p={};if(u){for(const v in u)if(u[v])try{const m=u[v].evaluate(s),_=`Ignoring image parameter "${v}" with semi-transparent color ${m.toString()}`;if(m.a!==1){this._imageWarnHistory[_]||(console.warn(_),this._imageWarnHistory[_]=!0);continue}p[v]=m}catch{continue}if(Object.keys(p).length!==0)return{params:p}}}evaluate(s){const u=Rs.build(this.inputPrimary.evaluate(s),this.inputSecondary?this.inputSecondary.evaluate(s):void 0,this.inputPrimaryParams?this.evaluateParams(s,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(s,this.inputSecondaryParams):void 0);return u&&s.availableImages&&(u.available=s.availableImages.indexOf(u.namePrimary)>-1,u.nameSecondary&&u.available&&s.availableImages&&(u.available=s.availableImages.indexOf(u.nameSecondary)>-1)),u}eachChild(s){if(s(this.inputPrimary),this.inputPrimaryParams)for(const u in this.inputPrimaryParams)this.inputPrimaryParams[u]&&s(this.inputPrimaryParams[u]);if(this.inputSecondary&&(s(this.inputSecondary),this.inputSecondaryParams))for(const u in this.inputSecondaryParams)this.inputSecondaryParams[u]&&s(this.inputSecondaryParams[u])}outputDefined(){return!1}serializeParams(s){const u={};if(s){for(const p in s)s[p]&&(u[p]=s[p].serialize());return{params:u}}}serialize(){const s=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&s.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(s.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&s.push(this.serializeParams(this.inputSecondaryParams))),s}}function Mo(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}const lf={"to-boolean":Wn,"to-color":xs,"to-number":br,"to-string":mi};class Oc{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");const p=s[0],v=[];let m=Zu;if(p==="to-array"){if(!Array.isArray(s[1]))return null;const _=s[1].length;if(u.expectedType){if(u.expectedType.kind!=="array")return u.error(`Expected ${u.expectedType.kind} but found array.`);m=Za(u.expectedType.itemType,_)}else{if(!(_>0&&zl(s[1][0])))return null;m=Za(oa(s[1][0]),_)}for(let P=0;P<_;P++){const O=s[1][P];let B;if(Mo(O)==="array")B=u.parse(O,void 0,m.itemType);else{const k=Mo(O);if(k!==m.itemType.kind)return u.error(`Expected ${m.itemType.kind} but found ${k}.`);B=u.registry.literal.parse(["literal",O===void 0?null:O],u)}if(!B)return null;v.push(B)}}else{if((p==="to-boolean"||p==="to-string")&&s.length!==2)return u.error("Expected one argument.");m=lf[p];for(let _=1;_<s.length;_++){const P=u.parse(s[_],_,ii);if(!P)return null;v.push(P)}}return new Oc(m,v)}evaluate(s){if(this.type.kind==="boolean")return!!this.args[0].evaluate(s);if(this.type.kind==="color"){let u,p;for(const v of this.args){if(u=v.evaluate(s),p=null,u instanceof Xn)return u;if(typeof u=="string"){const m=s.parseColor(u);if(m)return m}else if(Array.isArray(u)&&(p=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:of(u[0],u[1],u[2],u[3]),!p))return new Xn(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new ba(p||`Could not parse color from value '${typeof u=="string"?u:String(JSON.stringify(u))}'`)}if(this.type.kind==="number"){let u=null;for(const p of this.args){if(u=p.evaluate(s),u===null)return 0;const v=Number(u);if(!isNaN(v))return v}throw new ba(`Could not convert ${JSON.stringify(u)} to number.`)}return this.type.kind==="formatted"?Os.fromString(Ra(this.args[0].evaluate(s))):this.type.kind==="resolvedImage"?Rs.build(Ra(this.args[0].evaluate(s))):this.type.kind==="array"?this.args.map(u=>u.evaluate(s)):Ra(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if(this.type.kind==="formatted")return new cu([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Kd(this.args[0]).serialize();const s=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(u=>{s.push(u.serialize())}),s}}const U_=["Unknown","Point","LineString","Polygon"];class wy{constructor(s,u){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=s,this.options=u}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?U_[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(s){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const s=this.featureDistanceData.center,u=this.featureDistanceData.scale,{x:p,y:v}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(p*u-s[0])+this.featureDistanceData.bearing[1]*(v*u-s[1])}return 0}parseColor(s){let u=this._parseColorCache[s];return u||(u=this._parseColorCache[s]=Xn.parse(s)),u}getConfig(s){return this.options?this.options.get(s):null}}class Oo{constructor(s,u,p,v,m){this.name=s,this.type=u,this._evaluate=p,this.args=v,this._overloadIndex=m}evaluate(s){if(!this._evaluate){const u=Oo.definitions[this.name];this._evaluate=Array.isArray(u)?u[2]:u.overloads[this._overloadIndex][1]}return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,u){const p=s[0],v=Oo.definitions[p];if(!v)return u.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(v)?v[0]:v.type,_=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,P=[];let O=null,B=-1;for(const[k,R]of _){if(Array.isArray(k)&&k.length!==s.length-1)continue;P.push(k),B++,O=new pf(u.registry,u.path,null,u.scope,void 0,u._scope,u.options);const z=[];let M=!1;for(let L=1;L<s.length;L++){const q=s[L],X=Array.isArray(k)?k[L-1]:k.type,te=O.parse(q,1+z.length,X);if(!te){M=!0;break}z.push(te)}if(!M)if(Array.isArray(k)&&k.length!==z.length)O.error(`Expected ${k.length} arguments, but found ${z.length} instead.`);else{for(let L=0;L<z.length;L++){const q=Array.isArray(k)?k[L]:k.type,X=z[L];O.concat(L+1).checkSubtype(q,X.type)}if(O.errors.length===0)return new Oo(p,m,R,z,B)}}if(P.length===1)u.errors.push(...O.errors);else{const k=(P.length?P:_.map(([z])=>z)).map(Sp).join(" | "),R=[];for(let z=1;z<s.length;z++){const M=u.parse(s[z],1+R.length);if(!M)return null;R.push(_a(M.type))}u.error(`Expected arguments of type ${k}, but found (${R.join(", ")}) instead.`)}return null}static register(s,u){Oo.definitions=u;for(const p in u)s[p]=Oo}}function Sp(f){return Array.isArray(f)?`(${f.map(_a).join(", ")})`:`(${_a(f.type)}...)`}class Um{constructor(s,u,p){this.type=ou,this.locale=p,this.caseSensitive=s,this.diacriticSensitive=u}static parse(s,u){if(s.length!==2)return u.error("Expected one argument.");const p=s[1];if(typeof p!="object"||Array.isArray(p))return u.error("Collator options argument must be an object.");const v=p["case-sensitive"]===void 0?u.parse(!1,1,Wn):u.parseObjectValue(p["case-sensitive"],1,"case-sensitive",Wn);if(!v)return null;const m=p["diacritic-sensitive"]===void 0?u.parse(!1,1,Wn):u.parseObjectValue(p["diacritic-sensitive"],1,"diacritic-sensitive",Wn);if(!m)return null;let _=null;return p.locale&&(_=u.parseObjectValue(p.locale,1,"locale",mi),!_)?null:new Um(v,m,_)}evaluate(s){return new wp(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}function Np(f,s,u=0,p=f.length-1,v=$_){for(;p>u;){if(p-u>600){const O=p-u+1,B=s-u+1,k=Math.log(O),R=.5*Math.exp(2*k/3),z=.5*Math.sqrt(k*R*(O-R)/O)*(B-O/2<0?-1:1);Np(f,s,Math.max(u,Math.floor(s-B*R/O+z)),Math.min(p,Math.floor(s+(O-B)*R/O+z)),v)}const m=f[s];let _=u,P=p;for(Ap(f,u,s),v(f[p],m)>0&&Ap(f,u,p);_<P;){for(Ap(f,_,P),_++,P--;v(f[_],m)<0;)_++;for(;v(f[P],m)>0;)P--}v(f[u],m)===0?Ap(f,u,P):(P++,Ap(f,P,p)),P<=s&&(u=P+1),s<=P&&(p=P-1)}}function Ap(f,s,u){const p=f[s];f[s]=f[u],f[u]=p}function $_(f,s){return f<s?-1:f>s?1:0}function q_(f){let s=0;for(let u,p,v=0,m=f.length,_=m-1;v<m;_=v++)u=f[v],p=f[_],s+=(p.x-u.x)*(u.y+p.y);return s}function cf(f,s){f[0]=Math.min(f[0],s[0]),f[1]=Math.min(f[1],s[1]),f[2]=Math.max(f[2],s[0]),f[3]=Math.max(f[3],s[1])}function Tp(f,s){return!(f[0]<=s[0]||f[2]>=s[2]||f[1]<=s[1]||f[3]>=s[3])}function G_(f,s,u){const p=f[0]-s[0],v=f[1]-s[1],m=f[0]-u[0],_=f[1]-u[1];return p*_-m*v==0&&p*m<=0&&v*_<=0}function uf(f,s,u=!1){let p=!1;for(let P=0,O=s.length;P<O;P++){const B=s[P];for(let k=0,R=B.length,z=R-1;k<R;z=k++){const M=B[z],L=B[k];if(G_(f,M,L))return u;(m=M)[1]>(v=f)[1]!=(_=L)[1]>v[1]&&v[0]<(_[0]-m[0])*(v[1]-m[1])/(_[1]-m[1])+m[0]&&(p=!p)}}var v,m,_;return p}function Sy(f,s,u,p){const v=p[0]-u[0],m=p[1]-u[1],_=(f[0]-u[0])*m-v*(f[1]-u[1]),P=(s[0]-u[0])*m-v*(s[1]-u[1]);return _>0&&P<0||_<0&&P>0}function lc(f,s,u,p){return(v=[p[0]-u[0],p[1]-u[1]])[0]*(m=[s[0]-f[0],s[1]-f[1]])[1]-v[1]*m[0]!=0&&!(!Sy(f,s,u,p)||!Sy(u,p,f,s));var v,m}const Yu=8192;function W_(f,s){const u=(180+f[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,v=Math.pow(2,s.z);return[Math.round(u*v*Yu),Math.round(p*v*Yu)]}function Ny(f,s){for(let u=0;u<s.length;u++)if(uf(f,s[u]))return!0;return!1}function lx(f,s,u){for(const p of u)for(let v=0,m=p.length,_=m-1;v<m;_=v++)if(lc(f,s,p[_],p[v]))return!0;return!1}function cx(f,s){for(let u=0;u<f.length;++u)if(!uf(f[u],s))return!1;for(let u=0;u<f.length-1;++u)if(lx(f[u],f[u+1],s))return!1;return!0}function H_(f,s){for(let u=0;u<s.length;u++)if(cx(f,s[u]))return!0;return!1}function Ay(f,s,u){const p=[];for(let v=0;v<f.length;v++){const m=[];for(let _=0;_<f[v].length;_++){const P=W_(f[v][_],u);cf(s,P),m.push(P)}p.push(m)}return p}function Zd(f,s,u){const p=[];for(let v=0;v<f.length;v++){const m=Ay(f[v],s,u);p.push(m)}return p}function kn(f,s,u,p){if(f[0]<u[0]||f[0]>u[2]){const v=.5*p;let m=f[0]-u[0]>v?-p:u[0]-f[0]>v?p:0;m===0&&(m=f[0]-u[2]>v?-p:u[2]-f[0]>v?p:0),f[0]+=m}cf(s,f)}function zr(f,s,u,p){const v=Math.pow(2,p.z)*Yu,m=[p.x*Yu,p.y*Yu],_=[];if(!f)return _;for(const P of f)for(const O of P){const B=[O.x+m[0],O.y+m[1]];kn(B,s,u,v),_.push(B)}return _}function $m(f,s,u,p){const v=Math.pow(2,p.z)*Yu,m=[p.x*Yu,p.y*Yu],_=[];if(!f)return _;for(const O of f){const B=[];for(const k of O){const R=[k.x+m[0],k.y+m[1]];cf(s,R),B.push(R)}_.push(B)}if(s[2]-s[0]<=v/2){(P=s)[0]=P[1]=1/0,P[2]=P[3]=-1/0;for(const O of _)for(const B of O)kn(B,s,u,v)}var P;return _}class Wr{constructor(s,u){this.type=Wn,this.geojson=s,this.geometries=u}static parse(s,u){if(s.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(zl(s[1])){const p=s[1];if(p.type==="FeatureCollection")for(let v=0;v<p.features.length;++v){const m=p.features[v].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Wr(p,p.features[v].geometry)}else if(p.type==="Feature"){const v=p.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Wr(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Wr(p,p)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(u,p){const v=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=u.canonicalID();if(!_)return!1;if(p.type==="Polygon"){const P=Ay(p.coordinates,m,_),O=zr(u.geometry(),v,m,_);if(!Tp(v,m))return!1;for(const B of O)if(!uf(B,P))return!1}if(p.type==="MultiPolygon"){const P=Zd(p.coordinates,m,_),O=zr(u.geometry(),v,m,_);if(!Tp(v,m))return!1;for(const B of O)if(!Ny(B,P))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(u,p){const v=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=u.canonicalID();if(!_)return!1;if(p.type==="Polygon"){const P=Ay(p.coordinates,m,_),O=$m(u.geometry(),v,m,_);if(!Tp(v,m))return!1;for(const B of O)if(!cx(B,P))return!1}if(p.type==="MultiPolygon"){const P=Zd(p.coordinates,m,_),O=$m(u.geometry(),v,m,_);if(!Tp(v,m))return!1;for(const B of O)if(!H_(B,P))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Rc={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},qm=1/298.257223563,Jr=qm*(2-qm),Yd=Math.PI/180;class Xu{static fromTile(s,u,p){const v=Math.PI*(1-2*(s+.5)/Math.pow(2,u)),m=Math.atan(.5*(Math.exp(v)-Math.exp(-v)))/Yd;return new Xu(m,p)}static get units(){return Rc}constructor(s,u){if(s===void 0)throw new Error("No latitude given.");if(u&&!Rc[u])throw new Error(`Unknown unit ${u}. Use one of: ${Object.keys(Rc).join(", ")}`);const p=6378.137*Yd*(u?Rc[u]:1),v=Math.cos(s*Yd),m=1/(1-Jr*(1-v*v)),_=Math.sqrt(m);this.kx=p*_*v,this.ky=p*_*m*(1-Jr)}distance(s,u){const p=vs(s[0]-u[0])*this.kx,v=(s[1]-u[1])*this.ky;return Math.sqrt(p*p+v*v)}bearing(s,u){const p=vs(u[0]-s[0])*this.kx;return Math.atan2(p,(u[1]-s[1])*this.ky)/Yd}destination(s,u,p){const v=p*Yd;return this.offset(s,Math.sin(v)*u,Math.cos(v)*u)}offset(s,u,p){return[s[0]+u/this.kx,s[1]+p/this.ky]}lineDistance(s){let u=0;for(let p=0;p<s.length-1;p++)u+=this.distance(s[p],s[p+1]);return u}area(s){let u=0;for(let p=0;p<s.length;p++){const v=s[p];for(let m=0,_=v.length,P=_-1;m<_;P=m++)u+=vs(v[m][0]-v[P][0])*(v[m][1]+v[P][1])*(p?-1:1)}return Math.abs(u)/2*this.kx*this.ky}along(s,u){let p=0;if(u<=0)return s[0];for(let v=0;v<s.length-1;v++){const m=s[v],_=s[v+1],P=this.distance(m,_);if(p+=P,p>u)return jp(m,_,(u-(p-P))/P)}return s[s.length-1]}pointToSegmentDistance(s,u,p){let[v,m]=u,_=vs(p[0]-v)*this.kx,P=(p[1]-m)*this.ky;if(_!==0||P!==0){const O=(vs(s[0]-v)*this.kx*_+(s[1]-m)*this.ky*P)/(_*_+P*P);O>1?(v=p[0],m=p[1]):O>0&&(v+=_/this.kx*O,m+=P/this.ky*O)}return _=vs(s[0]-v)*this.kx,P=(s[1]-m)*this.ky,Math.sqrt(_*_+P*P)}pointOnLine(s,u){let p=1/0,v=s[0][0],m=s[0][1],_=0,P=0;for(let O=0;O<s.length-1;O++){let B=s[O][0],k=s[O][1],R=vs(s[O+1][0]-B)*this.kx,z=(s[O+1][1]-k)*this.ky,M=0;R===0&&z===0||(M=(vs(u[0]-B)*this.kx*R+(u[1]-k)*this.ky*z)/(R*R+z*z),M>1?(B=s[O+1][0],k=s[O+1][1]):M>0&&(B+=R/this.kx*M,k+=z/this.ky*M)),R=vs(u[0]-B)*this.kx,z=(u[1]-k)*this.ky;const L=R*R+z*z;L<p&&(p=L,v=B,m=k,_=O,P=M)}return{point:[v,m],index:_,t:Math.max(0,Math.min(1,P))}}lineSlice(s,u,p){let v=this.pointOnLine(p,s),m=this.pointOnLine(p,u);if(v.index>m.index||v.index===m.index&&v.t>m.t){const B=v;v=m,m=B}const _=[v.point],P=v.index+1,O=m.index;!Gm(p[P],_[0])&&P<=O&&_.push(p[P]);for(let B=P+1;B<=O;B++)_.push(p[B]);return Gm(p[O],m.point)||_.push(m.point),_}lineSliceAlong(s,u,p){let v=0;const m=[];for(let _=0;_<p.length-1;_++){const P=p[_],O=p[_+1],B=this.distance(P,O);if(v+=B,v>s&&m.length===0&&m.push(jp(P,O,(s-(v-B))/B)),v>=u)return m.push(jp(P,O,(u-(v-B))/B)),m;v>s&&m.push(O)}return m}bufferPoint(s,u){const p=u/this.ky,v=u/this.kx;return[s[0]-v,s[1]-p,s[0]+v,s[1]+p]}bufferBBox(s,u){const p=u/this.ky,v=u/this.kx;return[s[0]-v,s[1]-p,s[2]+v,s[3]+p]}insideBBox(s,u){return vs(s[0]-u[0])>=0&&vs(s[0]-u[2])<=0&&s[1]>=u[1]&&s[1]<=u[3]}}function Gm(f,s){return f[0]===s[0]&&f[1]===s[1]}function jp(f,s,u){const p=vs(s[0]-f[0]);return[f[0]+p*u,f[1]+(s[1]-f[1])*u]}function vs(f){for(;f<-180;)f+=360;for(;f>180;)f-=360;return f}class Gs{constructor(s=[],u=(p,v)=>p<v?-1:p>v?1:0){if(this.data=s,this.length=this.data.length,this.compare=u,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],u=this.data.pop();return--this.length>0&&(this.data[0]=u,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:u,compare:p}=this,v=u[s];for(;s>0;){const m=s-1>>1,_=u[m];if(p(v,_)>=0)break;u[s]=_,s=m}u[s]=v}_down(s){const{data:u,compare:p}=this,v=this.length>>1,m=u[s];for(;s<v;){let _=1+(s<<1);const P=_+1;if(P<this.length&&p(u[P],u[_])<0&&(_=P),p(u[_],m)>=0)break;u[s]=u[_],s=_}u[s]=m}}var cr=8192;function Ty(f,s){return s.dist-f.dist}const kp=100,df=50;function Bl(f){const s=[1/0,1/0,-1/0,-1/0];if(s.length!==f.length)return!1;for(let u=0;u<s.length;u++)if(s[u]!==f[u])return!1;return!0}function Va(f){return f[1]-f[0]+1}function uu(f,s){const u=f[1]>=f[0]&&f[1]<s;return u||console.warn("Distance Expression: Index is out of range"),u}function hf(f,s){if(f[0]>f[1])return[null,null];const u=Va(f);if(s){if(u===2)return[f,null];const p=Math.floor(u/2);return[[f[0],f[0]+p],[f[0]+p,f[1]]]}{if(u===1)return[f,null];const p=Math.floor(u/2)-1;return[[f[0],f[0]+p],[f[0]+p+1,f[1]]]}}function Xd(f,s){const u=[1/0,1/0,-1/0,-1/0];if(!uu(s,f.length))return u;for(let p=s[0];p<=s[1];++p)cf(u,f[p]);return u}function Ju(f){const s=[1/0,1/0,-1/0,-1/0];for(let u=0;u<f.length;++u)for(let p=0;p<f[u].length;++p)cf(s,f[u][p]);return s}function du(f,s,u){if(Bl(f)||Bl(s))return NaN;let p=0,v=0;return f[2]<s[0]&&(p=s[0]-f[2]),f[0]>s[2]&&(p=f[0]-s[2]),f[1]>s[3]&&(v=f[1]-s[3]),f[3]<s[1]&&(v=s[1]-f[3]),u.distance([0,0],[p,v])}function Pp(f){return 360*f-180}function ux(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}function Wm(f,s){const u=Math.pow(2,s.z),p=(f.y/cr+s.y)/u;return[Pp((f.x/cr+s.x)/u),ux(p)]}function dx(f,s){const u=[];for(let p=0;p<f.length;++p)u.push(Wm(f[p],s));return u}function hx(f,s,u){const p=u.pointOnLine(s,f).point;return u.distance(f,p)}function jy(f,s,u,p,v){const m=u.slice(p[0],p[1]+1);let _=1/0;for(let P=s[0];P<=s[1];++P)if((_=Math.min(_,hx(f[P],m,v)))===0)return 0;return _}function ky(f,s,u,p,v){const m=Math.min(v.pointToSegmentDistance(f,u,p),v.pointToSegmentDistance(s,u,p)),_=Math.min(v.pointToSegmentDistance(u,f,s),v.pointToSegmentDistance(p,f,s));return Math.min(m,_)}function K_(f,s,u,p,v){if(!uu(s,f.length)||!uu(p,u.length))return NaN;let m=1/0;for(let _=s[0];_<s[1];++_)for(let P=p[0];P<p[1];++P){if(lc(f[_],f[_+1],u[P],u[P+1]))return 0;m=Math.min(m,ky(f[_],f[_+1],u[P],u[P+1],v))}return m}function fx(f,s,u,p,v){if(!uu(s,f.length)||!uu(p,u.length))return NaN;let m=1/0;for(let _=s[0];_<=s[1];++_)for(let P=p[0];P<=p[1];++P)if((m=Math.min(m,v.distance(f[_],u[P])))===0)return m;return m}function no(f,s,u){if(uf(f,s,!0))return 0;let p=1/0;for(const v of s){const m=v.length;if(m<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(v[0]!==v[m-1]&&(p=Math.min(p,u.pointToSegmentDistance(f,v[m-1],v[0])))===0||(p=Math.min(p,hx(f,v,u)))===0)return p}return p}function Cp(f,s,u,p){if(!uu(s,f.length))return NaN;for(let m=s[0];m<=s[1];++m)if(uf(f[m],u,!0))return 0;let v=1/0;for(let m=s[0];m<s[1];++m)for(const _ of u)for(let P=0,O=_.length,B=O-1;P<O;B=P++){if(lc(f[m],f[m+1],_[B],_[P]))return 0;v=Math.min(v,ky(f[m],f[m+1],_[B],_[P],p))}return v}function Py(f,s){for(const u of f)for(let p=0;p<=u.length-1;++p)if(uf(u[p],s,!0))return!0;return!1}function Hm(f,s,u,p=1/0){const v=Ju(f),m=Ju(s);if(p!==1/0&&du(v,m,u)>=p)return p;if(Tp(v,m)){if(Py(f,s))return 0}else if(Py(s,f))return 0;let _=p;for(const P of f)for(let O=0,B=P.length,k=B-1;O<B;k=O++)for(const R of s)for(let z=0,M=R.length,L=M-1;z<M;L=z++){if(lc(P[k],P[O],R[L],R[z]))return 0;_=Math.min(_,ky(P[k],P[O],R[L],R[z],u))}return _}function ff(f,s,u,p,v,m,_){if(m===null||_===null)return;const P=du(Xd(p,m),Xd(v,_),u);P<s&&f.push({dist:P,range1:m,range2:_})}function Cy(f,s,u,p,v=1/0){let m=Math.min(p.distance(f[0],u[0][0]),v);if(m===0)return m;const _=new Gs([{dist:0,range1:[0,f.length-1],range2:[0,0]}],Ty),P=s?df:kp,O=Ju(u);for(;_.length;){const B=_.pop();if(B.dist>=m)continue;const k=B.range1;if(Va(k)<=P){if(!uu(k,f.length))return NaN;if(s){const R=Cp(f,k,u,p);if((m=Math.min(m,R))===0)return m}else for(let R=k[0];R<=k[1];++R){const z=no(f[R],u,p);if((m=Math.min(m,z))===0)return m}}else{const R=hf(k,s);if(R[0]!==null){const z=du(Xd(f,R[0]),O,p);z<m&&_.push({dist:z,range1:R[0],range2:[0,0]})}if(R[1]!==null){const z=du(Xd(f,R[1]),O,p);z<m&&_.push({dist:z,range1:R[1],range2:[0,0]})}}}return m}function Xo(f,s,u,p,v,m=1/0){let _=Math.min(m,v.distance(f[0],u[0]));if(_===0)return _;const P=new Gs([{dist:0,range1:[0,f.length-1],range2:[0,u.length-1]}],Ty),O=s?df:kp,B=p?df:kp;for(;P.length;){const k=P.pop();if(k.dist>=_)continue;const R=k.range1,z=k.range2;if(Va(R)<=O&&Va(z)<=B){if(!uu(R,f.length)||!uu(z,u.length))return NaN;if(s&&p?_=Math.min(_,K_(f,R,u,z,v)):s||p?s&&!p?_=Math.min(_,jy(u,z,f,R,v)):!s&&p&&(_=Math.min(_,jy(f,R,u,z,v))):_=Math.min(_,fx(f,R,u,z,v)),_===0)return _}else{const M=hf(R,s),L=hf(z,p);ff(P,_,v,f,u,M[0],L[0]),ff(P,_,v,f,u,M[0],L[1]),ff(P,_,v,f,u,M[1],L[0]),ff(P,_,v,f,u,M[1],L[1])}}return _}function Km(f,s,u,p,v=1/0){let m=v;const _=Xd(f,[0,f.length-1]);for(const P of u)if(!(m!==1/0&&du(_,Xd(P,[0,P.length-1]),p)>=m)&&(m=Math.min(m,Xo(f,s,P,!0,p,m)),m===0))return m;return m}function Ep(f,s,u,p,v=1/0){let m=v;const _=Xd(f,[0,f.length-1]);for(const P of u){if(m!==1/0&&du(_,Ju(P),p)>=m)continue;const O=Cy(f,s,P,p,m);if(isNaN(O))return O;if((m=Math.min(m,O))===0)return m}return m}function hu(f){return f==="Point"||f==="MultiPoint"||f==="LineString"||f==="MultiLineString"||f==="Polygon"||f==="MultiPolygon"}class Ic{constructor(s,u){this.type=br,this.geojson=s,this.geometries=u}static parse(s,u){if(s.length!==2)return u.error(`'distance' expression requires either one argument, but found ' ${s.length-1} instead.`);if(zl(s[1])){const p=s[1];if(p.type==="FeatureCollection"){for(let v=0;v<p.features.length;++v)if(hu(p.features[v].geometry.type))return new Ic(p,p.features[v].geometry)}else if(p.type==="Feature"){if(hu(p.geometry.type))return new Ic(p,p.geometry)}else if(hu(p.type))return new Ic(p,p)}return u.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(s){const u=s.geometry(),p=s.canonicalID();if(u!=null&&p!=null){if(s.geometryType()==="Point")return function(v,m,_){const P=[];for(const B of v)for(const k of B)P.push(Wm(k,m));const O=new Xu(P[0][1],"meters");return _.type==="Point"||_.type==="MultiPoint"||_.type==="LineString"?Xo(P,!1,_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",O):_.type==="MultiLineString"?Km(P,!1,_.coordinates,O):_.type==="Polygon"||_.type==="MultiPolygon"?Ep(P,!1,_.type==="Polygon"?[_.coordinates]:_.coordinates,O):null}(u,p,this.geometries);if(s.geometryType()==="LineString")return function(v,m,_){const P=[];for(const B of v){const k=[];for(const R of B)k.push(Wm(R,m));P.push(k)}const O=new Xu(P[0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return Km(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",P,O);if(_.type==="MultiLineString"){let B=1/0;for(let k=0;k<_.coordinates.length;k++){const R=Km(_.coordinates[k],!0,P,O,B);if(isNaN(R))return R;if((B=Math.min(B,R))===0)return B}return B}if(_.type==="Polygon"||_.type==="MultiPolygon"){let B=1/0;for(let k=0;k<P.length;k++){const R=Ep(P[k],!0,_.type==="Polygon"?[_.coordinates]:_.coordinates,O,B);if(isNaN(R))return R;if((B=Math.min(B,R))===0)return B}return B}return null}(u,p,this.geometries);if(s.geometryType()==="Polygon")return function(v,m,_){const P=[];for(const B of function(k,R){const z=k.length;if(z<=1)return[k];const M=[];let L,q;for(let X=0;X<z;X++){const te=q_(k[X]);te!==0&&(k[X].area=Math.abs(te),q===void 0&&(q=te<0),q===te<0?(L&&M.push(L),L=[k[X]]):L.push(k[X]))}return L&&M.push(L),M}(v)){const k=[];for(let R=0;R<B.length;++R)k.push(dx(B[R],m));P.push(k)}const O=new Xu(P[0][0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return Ep(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",P,O);if(_.type==="MultiLineString"){let B=1/0;for(let k=0;k<_.coordinates.length;k++){const R=Ep(_.coordinates[k],!0,P,O,B);if(isNaN(R))return R;if((B=Math.min(B,R))===0)return B}return B}return _.type==="Polygon"||_.type==="MultiPolygon"?function(B,k,R){let z=1/0;for(const M of B)for(const L of k){const q=Hm(M,L,R,z);if(isNaN(q))return q;if((z=Math.min(z,q))===0)return z}return z}(_.type==="Polygon"?[_.coordinates]:_.coordinates,P,O):null}(u,p,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Qu(f,s){switch(f){case"string":return Ra(s);case"number":return+s;case"boolean":return!!s;case"color":return Xn.parse(s);case"formatted":return Os.fromString(Ra(s));case"resolvedImage":return Rs.build(Ra(s))}return s}function Mp(f,s,u,p){return p!==void 0&&(f=p*Math.round(f/p)),s!==void 0&&f<s&&(f=s),u!==void 0&&f>u&&(f=u),f}class ed{constructor(s,u,p){this.type=s,this.key=u,this.scope=p}static parse(s,u){let p=u.expectedType;if(p==null&&(p=ii),s.length<2||s.length>3)return u.error("Invalid number of arguments for 'config' expression.");const v=u.parse(s[1],1);if(!(v instanceof Ia))return u.error("Key name of 'config' expression must be a string literal.");if(s.length>=3){const m=u.parse(s[2],2);return m instanceof Ia?new ed(p,Ra(v.value),Ra(m.value)):u.error("Scope of 'config' expression must be a string literal.")}return new ed(p,Ra(v.value))}evaluate(s){const u=[this.key,this.scope,s.scope].filter(Boolean).join(""),p=s.getConfig(u);if(!p)return null;const{type:v,value:m,values:_,minValue:P,maxValue:O,stepValue:B}=p,k=p.default.evaluate(s);let R=k;if(m){const z=s.scope;s.scope=(z||"").split("").slice(1).join(""),R=m.evaluate(s),s.scope=z}return v&&(R=Qu(v,R)),R===void 0||P===void 0&&O===void 0&&B===void 0||(typeof R=="number"?R=Mp(R,P,O,B):Array.isArray(R)&&(R=R.map(z=>typeof z=="number"?Mp(z,P,O,B):z))),m!==void 0&&R!==void 0&&_&&!_.includes(R)&&(R=k,v&&(R=Qu(v,R))),(v&&v!==this.type||R!==void 0&&oa(R)!==this.type)&&(R=Qu(this.type.kind,R)),R}eachChild(){}outputDefined(){return!1}serialize(){const s=["config",this.key];return this.scope&&s.concat(this.key),s}}function fu(f){if(f instanceof Oo&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof Wr||f instanceof Ic)return!1;let s=!0;return f.eachChild(u=>{s&&!fu(u)&&(s=!1)}),s}function Lc(f){if(f instanceof Oo&&f.name==="feature-state")return!1;let s=!0;return f.eachChild(u=>{s&&!Lc(u)&&(s=!1)}),s}function Jd(f){if(f instanceof ed)return new Set([f.key]);let s=new Set;return f.eachChild(u=>{s=new Set([...s,...Jd(u)])}),s}function td(f,s){if(f instanceof Oo&&s.indexOf(f.name)>=0)return!1;let u=!0;return f.eachChild(p=>{u&&!td(p,s)&&(u=!1)}),u}class Dc{constructor(s,u){this.type=u.type,this.name=s,this.boundExpression=u}static parse(s,u){if(s.length!==2||typeof s[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const p=s[1];return u.scope.has(p)?new Dc(p,u.scope.get(p)):u.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Qd{constructor(s,u=[],p,v=new Vm,m=[],_,P){this.registry=s,this.path=u,this.key=u.map(O=>typeof O=="string"?`['${O}']`:`[${O}]`).join(""),this.scope=v,this.errors=m,this.expectedType=p,this._scope=_,this.options=P}parse(s,u,p,v,m={}){return u||p?this.concat(u,null,p,v)._parse(s,m):this._parse(s,m)}parseObjectValue(s,u,p,v,m,_={}){return this.concat(u,p,v,m)._parse(s,_)}_parse(s,u){function p(v,m,_){return _==="assert"?new oc(m,[v]):_==="coerce"?new Oc(m,[v]):v}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=typeof s[0]=="string"?this.registry[s[0]]:void 0;if(v){let m=v.parse(s,this);if(!m)return null;if(this.expectedType){const _=this.expectedType,P=m.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||P.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string"){if(this.checkSubtype(_,P))return null}else m=p(m,_,u.typeAnnotation||"coerce");else m=p(m,_,u.typeAnnotation||"assert")}if(!(m instanceof Ia)&&m.type.kind!=="resolvedImage"&&Op(m)){const _=new wy(this._scope,this.options);try{m=new Ia(m.type,m.evaluate(_))}catch(P){return this.error(P.message),null}}return m}return Oc.parse(["to-array",s],this)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,u,p,v){let m=typeof s=="number"?this.path.concat(s):this.path;m=typeof u=="string"?m.concat(u):m;const _=v?this.scope.concat(v):this.scope;return new Qd(this.registry,m,p||null,_,this.errors,this._scope,this.options)}error(s,...u){const p=`${this.key}${u.map(v=>`[${v}]`).join("")}`;this.errors.push(new xn(p,s))}checkSubtype(s,u){const p=ro(s,u);return p&&this.error(p),p}}var pf=Qd;function Op(f){if(f instanceof Dc)return Op(f.boundExpression);if(f instanceof Oo&&f.name==="error"||f instanceof Um||f instanceof Wr||f instanceof Ic||f instanceof ed)return!1;const s=f instanceof Oc||f instanceof oc;let u=!0;return f.eachChild(p=>{u=s?u&&Op(p):u&&p instanceof Ia}),!!u&&fu(f)&&td(f,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function mf(f,s){const u=f.length-1;let p,v,m=0,_=u,P=0;for(;m<=_;)if(P=Math.floor((m+_)/2),p=f[P],v=f[P+1],p<=s){if(P===u||s<v)return P;m=P+1}else{if(!(p>s))throw new ba("Input is not a number.");_=P-1}return 0}class eh{constructor(s,u,p){this.type=s,this.input=u,this.labels=[],this.outputs=[];for(const[v,m]of p)this.labels.push(v),this.outputs.push(m)}static parse(s,u){if(s.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return u.error("Expected an even number of arguments.");const p=u.parse(s[1],1,br);if(!p)return null;const v=[];let m=null;u.expectedType&&u.expectedType.kind!=="value"&&(m=u.expectedType);for(let _=1;_<s.length;_+=2){const P=_===1?-1/0:s[_],O=s[_+1],B=_,k=_+1;if(typeof P!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(v.length&&v[v.length-1][0]>=P)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',B);const R=u.parse(O,k,m);if(!R)return null;m=m||R.type,v.push([P,R])}return new eh(m,p,v)}evaluate(s){const u=this.labels,p=this.outputs;if(u.length===1)return p[0].evaluate(s);const v=this.input.evaluate(s);if(v<=u[0])return p[0].evaluate(s);const m=u.length;return v>=u[m-1]?p[m-1].evaluate(s):p[mf(u,v)].evaluate(s)}eachChild(s){s(this.input);for(const u of this.outputs)s(u)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let u=0;u<this.labels.length;u++)u>0&&s.push(this.labels[u]),s.push(this.outputs[u].serialize());return s}}const rd=.95047,Pn=1.08883,Zm=4/29,nd=6/29,px=3*nd*nd,mx=nd*nd*nd,Rp=Math.PI/180,Li=180/Math.PI;function Ym(f){return f>mx?Math.pow(f,1/3):f/px+Zm}function Xm(f){return f>nd?f*f*f:px*(f-Zm)}function fa(f){return 255*(f<=.0031308?12.92*f:1.055*Math.pow(f,1/2.4)-.055)}function Ip(f){return(f/=255)<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function Lp(f){const s=Ip(f.r),u=Ip(f.g),p=Ip(f.b),v=Ym((.4124564*s+.3575761*u+.1804375*p)/rd),m=Ym((.2126729*s+.7151522*u+.072175*p)/1);return{l:116*m-16,a:500*(v-m),b:200*(m-Ym((.0193339*s+.119192*u+.9503041*p)/Pn)),alpha:f.a}}function gf(f){let s=(f.l+16)/116,u=isNaN(f.a)?s:s+f.a/500,p=isNaN(f.b)?s:s-f.b/200;return s=1*Xm(s),u=rd*Xm(u),p=Pn*Xm(p),new Xn(fa(3.2404542*u-1.5371385*s-.4985314*p),fa(-.969266*u+1.8760108*s+.041556*p),fa(.0556434*u-.2040259*s+1.0572252*p),f.alpha)}function gx(f,s,u){const p=s-f;return f+u*(p>180||p<-180?p-360*Math.round(p/360):p)}const th={forward:Lp,reverse:gf,interpolate:function(f,s,u){return{l:Fr(f.l,s.l,u),a:Fr(f.a,s.a,u),b:Fr(f.b,s.b,u),alpha:Fr(f.alpha,s.alpha,u)}}},pu={forward:function(f){const{l:s,a:u,b:p}=Lp(f),v=Math.atan2(p,u)*Li;return{h:v<0?v+360:v,c:Math.sqrt(u*u+p*p),l:s,alpha:f.a}},reverse:function(f){const s=f.h*Rp,u=f.c;return gf({l:f.l,a:Math.cos(s)*u,b:Math.sin(s)*u,alpha:f.alpha})},interpolate:function(f,s,u){return{h:gx(f.h,s.h,u),c:Fr(f.c,s.c,u),l:Fr(f.l,s.l,u),alpha:Fr(f.alpha,s.alpha,u)}}};var Dp=Object.freeze({__proto__:null,hcl:pu,lab:th});class Is{constructor(s,u,p,v,m,_){this.type=s,this.operator=u,this.interpolation=p,this.input=v,this.dynamicStops=m,this.labels=[],this.outputs=[];for(const[P,O]of _)this.labels.push(P),this.outputs.push(O)}static interpolationFactor(s,u,p,v){let m=0;if(s.name==="exponential")m=Jm(u,s.base,p,v);else if(s.name==="linear")m=Jm(u,1,p,v);else if(s.name==="cubic-bezier"){const _=s.controlPoints;m=new Kt(_[0],_[1],_[2],_[3]).solve(Jm(u,1,p,v))}return m}static parse(s,u){let[p,v,m,..._]=s;if(!Array.isArray(v)||v.length===0)return u.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){const B=v[1];if(typeof B!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:B}}else{if(v[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const B=v.slice(1);if(B.length!==4||B.some(k=>typeof k!="number"||k<0||k>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:B}}}if(s.length-1<3)return u.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length-1>3&&(s.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(m=u.parse(m,2,br),!m)return null;const P=[];let O=null;if(p==="interpolate-hcl"||p==="interpolate-lab"?O=xs:u.expectedType&&u.expectedType.kind!=="value"&&(O=u.expectedType),s.length-1==3){const B=u.parse(_[0],3,ii);return B?new Is(O,p,v,m,B,P):null}for(let B=0;B<_.length;B+=2){const k=_[B],R=_[B+1],z=B+3,M=B+4;if(typeof k!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(P.length&&P[P.length-1][0]>=k)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',z);const L=u.parse(R,M,O);if(!L)return null;O=O||L.type,P.push([k,L])}return O.kind==="number"||O.kind==="color"||O.kind==="array"&&O.itemType.kind==="number"&&typeof O.N=="number"?new Is(O,p,v,m,null,P):u.error(`Type ${_a(O)} is not interpolatable.`)}evaluate(s){let u=this.labels,p=this.outputs;if(this.dynamicStops){const k=this.dynamicStops.evaluate(s);if(k.length%2!=0)throw new ba("Expected an even number of arguments.");u=[],p=[];for(let R=0;R<k.length;R+=2){const z=k[R],M=new Ia(br,k[R+1]);if(typeof z!="number")throw new ba('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(u.length&&u[u.length-1]>=z)throw new ba('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');u.push(z),p.push(M)}if(u.length===0)throw new ba("Expected at least one input/output pair.")}if(u.length===1)return p[0].evaluate(s);const v=this.input.evaluate(s);if(v<=u[0])return p[0].evaluate(s);const m=u.length;if(v>=u[m-1])return p[m-1].evaluate(s);const _=mf(u,v),P=Is.interpolationFactor(this.interpolation,v,u[_],u[_+1]),O=p[_].evaluate(s),B=p[_+1].evaluate(s);return this.operator==="interpolate"?Hu[this.type.kind.toLowerCase()](O,B,P):this.operator==="interpolate-hcl"?pu.reverse(pu.interpolate(pu.forward(O),pu.forward(B),P)):th.reverse(th.interpolate(th.forward(O),th.forward(B),P))}eachChild(s){s(this.input);for(const u of this.outputs)s(u)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const u=[this.operator,s,this.input.serialize()];if(this.dynamicStops)u.push(this.dynamicStops.serialize());else for(let p=0;p<this.labels.length;p++)u.push(this.labels[p],this.outputs[p].serialize());return u}}function Jm(f,s,u,p){const v=p-u,m=f-u;return v===0?0:s===1?m/v:(Math.pow(s,m)-1)/(Math.pow(s,v)-1)}class Qm{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expectected at least one argument.");let p=null;const v=u.expectedType;v&&v.kind!=="value"&&(p=v);const m=[];for(const P of s.slice(1)){const O=u.parse(P,1+m.length,p,void 0,{typeAnnotation:"omit"});if(!O)return null;p=p||O.type,m.push(O)}const _=v&&m.some(P=>ro(v,P.type));return new Qm(_?ii:p,m)}evaluate(s){let u,p=null,v=0;for(const m of this.args){if(v++,p=m.evaluate(s),p&&p instanceof Rs&&!p.available&&(u||(u=p),p=null,v===this.args.length))return u;if(p!==null)break}return p}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(u=>{s.push(u.serialize())}),s}}class eg{constructor(s,u){this.type=u.type,this.bindings=[].concat(s),this.result=u}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const u of this.bindings)s(u[1]);s(this.result)}static parse(s,u){if(s.length<4)return u.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const p=[];for(let m=1;m<s.length-1;m+=2){const _=s[m];if(typeof _!="string")return u.error(`Expected string, but found ${typeof _} instead.`,m);if(/[^a-zA-Z0-9_]/.test(_))return u.error("Variable names must contain only alphanumeric characters or '_'.",m);const P=u.parse(s[m+1],m+1);if(!P)return null;p.push([_,P])}const v=u.parse(s[s.length-1],s.length-1,u.expectedType,p);return v?new eg(p,v):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[u,p]of this.bindings)s.push(u,p.serialize());return s.push(this.result.serialize()),s}}class tg{constructor(s,u,p){this.type=s,this.index=u,this.input=p}static parse(s,u){if(s.length!==3)return u.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=u.parse(s[1],1,br),v=u.parse(s[2],2,Za(u.expectedType||ii));return p&&v?new tg(v.type.itemType,p,v):null}evaluate(s){const u=this.index.evaluate(s),p=this.input.evaluate(s);if(u<0)throw new ba(`Array index out of bounds: ${u} < 0.`);if(u>p.length-1)throw new ba(`Array index out of bounds: ${u} > ${p.length-1}.`);if(u===Math.floor(u))return p[u];const v=Math.floor(u),m=Math.ceil(u),_=p[v],P=p[m];if(typeof _!="number"||typeof P!="number")throw new ba(`Cannot interpolate between non-number values at index ${u}.`);const O=u-v;return _*(1-O)+P*O}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class yf{constructor(s,u){this.type=Wn,this.needle=s,this.haystack=u}static parse(s,u){if(s.length!==3)return u.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=u.parse(s[1],1,ii),v=u.parse(s[2],2,ii);return p&&v?Wd(p.type,[Wn,mi,br,Zu,ii])?new yf(p,v):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${_a(p.type)} instead`):null}evaluate(s){const u=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(p==null)return!1;if(!Hd(u,["boolean","string","number","null"]))throw new ba(`Expected first argument to be of type boolean, string, number or null, but found ${_a(oa(u))} instead.`);if(!Hd(p,["string","array"]))throw new ba(`Expected second argument to be of type array or string, but found ${_a(oa(p))} instead.`);return p.indexOf(u)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class rh{constructor(s,u,p){this.type=br,this.needle=s,this.haystack=u,this.fromIndex=p}static parse(s,u){if(s.length<=2||s.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=u.parse(s[1],1,ii),v=u.parse(s[2],2,ii);if(!p||!v)return null;if(!Wd(p.type,[Wn,mi,br,Zu,ii]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${_a(p.type)} instead`);if(s.length===4){const m=u.parse(s[3],3,br);return m?new rh(p,v,m):null}return new rh(p,v)}evaluate(s){const u=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(!Hd(u,["boolean","string","number","null"]))throw new ba(`Expected first argument to be of type boolean, string, number or null, but found ${_a(oa(u))} instead.`);if(!Hd(p,["string","array"]))throw new ba(`Expected second argument to be of type array or string, but found ${_a(oa(p))} instead.`);if(this.fromIndex){const v=this.fromIndex.evaluate(s);return p.indexOf(u,v)}return p.indexOf(u)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Fp{constructor(s,u,p,v,m,_){this.inputType=s,this.type=u,this.input=p,this.cases=v,this.outputs=m,this.otherwise=_}static parse(s,u){if(s.length<5)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return u.error("Expected an even number of arguments.");let p,v;u.expectedType&&u.expectedType.kind!=="value"&&(v=u.expectedType);const m={},_=[];for(let B=2;B<s.length-1;B+=2){let k=s[B];const R=s[B+1];Array.isArray(k)||(k=[k]);const z=u.concat(B);if(k.length===0)return z.error("Expected at least one branch label.");for(const L of k){if(typeof L!="number"&&typeof L!="string")return z.error("Branch labels must be numbers or strings.");if(typeof L=="number"&&Math.abs(L)>Number.MAX_SAFE_INTEGER)return z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof L=="number"&&Math.floor(L)!==L)return z.error("Numeric branch labels must be integer values.");if(p){if(z.checkSubtype(p,oa(L)))return null}else p=oa(L);if(m[String(L)]!==void 0)return z.error("Branch labels must be unique.");m[String(L)]=_.length}const M=u.parse(R,B,v);if(!M)return null;v=v||M.type,_.push(M)}const P=u.parse(s[1],1,ii);if(!P)return null;const O=u.parse(s[s.length-1],s.length-1,v);return O?P.type.kind!=="value"&&u.concat(1).checkSubtype(p,P.type)?null:new Fp(p,v,P,m,_,O):null}evaluate(s){const u=this.input.evaluate(s);return(oa(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],u=Object.keys(this.cases).sort(),p=[],v={};for(const _ of u){const P=v[this.cases[_]];P===void 0?(v[this.cases[_]]=p.length,p.push([this.cases[_],[_]])):p[P][1].push(_)}const m=_=>this.inputType.kind==="number"?Number(_):_;for(const[_,P]of p)s.push(P.length===1?m(P[0]):P.map(m)),s.push(this.outputs[_].serialize());return s.push(this.otherwise.serialize()),s}}class zp{constructor(s,u,p){this.type=s,this.branches=u,this.otherwise=p}static parse(s,u){if(s.length<4)return u.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return u.error("Expected an odd number of arguments.");let p;u.expectedType&&u.expectedType.kind!=="value"&&(p=u.expectedType);const v=[];for(let _=1;_<s.length-1;_+=2){const P=u.parse(s[_],_,Wn);if(!P)return null;const O=u.parse(s[_+1],_+1,p);if(!O)return null;v.push([P,O]),p=p||O.type}const m=u.parse(s[s.length-1],s.length-1,p);return m?new zp(p,v,m):null}evaluate(s){for(const[u,p]of this.branches)if(u.evaluate(s))return p.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[u,p]of this.branches)s(u),s(p);s(this.otherwise)}outputDefined(){return this.branches.every(([s,u])=>u.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(u=>{s.push(u.serialize())}),s}}class xf{constructor(s,u,p,v){this.type=s,this.input=u,this.beginIndex=p,this.endIndex=v}static parse(s,u){if(s.length<=2||s.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=u.parse(s[1],1,ii),v=u.parse(s[2],2,br);if(!p||!v)return null;if(!Wd(p.type,[Za(ii),mi,ii]))return u.error(`Expected first argument to be of type array or string, but found ${_a(p.type)} instead`);if(s.length===4){const m=u.parse(s[3],3,br);return m?new xf(p.type,p,v,m):null}return new xf(p.type,p,v)}evaluate(s){const u=this.input.evaluate(s),p=this.beginIndex.evaluate(s);if(!Hd(u,["string","array"]))throw new ba(`Expected first argument to be of type array or string, but found ${_a(oa(u))} instead.`);if(this.endIndex){const v=this.endIndex.evaluate(s);return u.slice(p,v)}return u.slice(p)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function rg(f,s){return f==="=="||f==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function yx(f,s,u,p){return p.compare(s,u)===0}function nh(f,s,u){const p=f!=="=="&&f!=="!=";return class Kie{constructor(m,_,P){this.type=Wn,this.lhs=m,this.rhs=_,this.collator=P,this.hasUntypedArgument=m.type.kind==="value"||_.type.kind==="value"}static parse(m,_){if(m.length!==3&&m.length!==4)return _.error("Expected two or three arguments.");const P=m[0];let O=_.parse(m[1],1,ii);if(!O)return null;if(!rg(P,O.type))return _.concat(1).error(`"${P}" comparisons are not supported for type '${_a(O.type)}'.`);let B=_.parse(m[2],2,ii);if(!B)return null;if(!rg(P,B.type))return _.concat(2).error(`"${P}" comparisons are not supported for type '${_a(B.type)}'.`);if(O.type.kind!==B.type.kind&&O.type.kind!=="value"&&B.type.kind!=="value")return _.error(`Cannot compare types '${_a(O.type)}' and '${_a(B.type)}'.`);p&&(O.type.kind==="value"&&B.type.kind!=="value"?O=new oc(B.type,[O]):O.type.kind!=="value"&&B.type.kind==="value"&&(B=new oc(O.type,[B])));let k=null;if(m.length===4){if(O.type.kind!=="string"&&B.type.kind!=="string"&&O.type.kind!=="value"&&B.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(k=_.parse(m[3],3,ou),!k)return null}return new Kie(O,B,k)}evaluate(m){const _=this.lhs.evaluate(m),P=this.rhs.evaluate(m);if(p&&this.hasUntypedArgument){const O=oa(_),B=oa(P);if(O.kind!==B.kind||O.kind!=="string"&&O.kind!=="number")throw new ba(`Expected arguments for "${f}" to be (string, string) or (number, number), but found (${O.kind}, ${B.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const O=oa(_),B=oa(P);if(O.kind!=="string"||B.kind!=="string")return s(m,_,P)}return this.collator?u(m,_,P,this.collator.evaluate(m)):s(m,_,P)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[f];return this.eachChild(_=>{m.push(_.serialize())}),m}}}const Z_=nh("==",function(f,s,u){return s===u},yx),Y_=nh("!=",function(f,s,u){return s!==u},function(f,s,u,p){return!yx(0,s,u,p)}),Ey=nh("<",function(f,s,u){return s<u},function(f,s,u,p){return p.compare(s,u)<0}),id=nh(">",function(f,s,u){return s>u},function(f,s,u,p){return p.compare(s,u)>0}),xx=nh("<=",function(f,s,u){return s<=u},function(f,s,u,p){return p.compare(s,u)<=0}),vf=nh(">=",function(f,s,u){return s>=u},function(f,s,u,p){return p.compare(s,u)>=0});class Vl{constructor(s,u,p,v,m,_){this.type=mi,this.number=s,this.locale=u,this.currency=p,this.unit=v,this.minFractionDigits=m,this.maxFractionDigits=_}static parse(s,u){if(s.length!==3)return u.error("Expected two arguments.");const p=u.parse(s[1],1,br);if(!p)return null;const v=s[2];if(typeof v!="object"||Array.isArray(v))return u.error("NumberFormat options argument must be an object.");let m=null;if(v.locale&&(m=u.parseObjectValue(v.locale,2,"locale",mi),!m))return null;let _=null;if(v.currency&&(_=u.parseObjectValue(v.currency,2,"currency",mi),!_))return null;let P=null;if(v.unit&&(P=u.parseObjectValue(v.unit,2,"unit",mi),!P))return null;let O=null;if(v["min-fraction-digits"]&&(O=u.parseObjectValue(v["min-fraction-digits"],2,"min-fraction-digits",br),!O))return null;let B=null;return v["max-fraction-digits"]&&(B=u.parseObjectValue(v["max-fraction-digits"],2,"max-fraction-digits",br),!B)?null:new Vl(p,m,_,P,O,B)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class ih{constructor(s){this.type=br,this.input=s}static parse(s,u){if(s.length!==2)return u.error(`Expected 1 argument, but found ${s.length-1} instead.`);const p=u.parse(s[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${_a(p.type)} instead.`):new ih(p):null}evaluate(s){const u=this.input.evaluate(s);if(typeof u=="string"||Array.isArray(u))return u.length;throw new ba(`Expected value to be of type string or array, but found ${_a(oa(u))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(u=>{s.push(u.serialize())}),s}}function Ul(f){return function(){f=1831565813+(f|=0)|0;let s=Math.imul(f^f>>>15,1|f);return s=s+Math.imul(s^s>>>7,61|s)^s,((s^s>>>14)>>>0)/4294967296}}const ad={"==":Z_,"!=":Y_,">":id,"<":Ey,">=":vf,"<=":xx,array:oc,at:tg,boolean:oc,case:zp,coalesce:Qm,collator:Um,format:cu,image:Kd,in:yf,"index-of":rh,interpolate:Is,"interpolate-hcl":Is,"interpolate-lab":Is,length:ih,let:eg,literal:Ia,match:Fp,number:oc,"number-format":Vl,object:oc,slice:xf,step:eh,string:oc,"to-boolean":Oc,"to-color":Oc,"to-number":Oc,"to-string":Oc,var:Dc,within:Wr,distance:Ic,config:ed};function My(f,[s,u,p,v]){s=s.evaluate(f),u=u.evaluate(f),p=p.evaluate(f);const m=v?v.evaluate(f):1,_=of(s,u,p,m);if(_)throw new ba(_);return new Xn(s/255*m,u/255*m,p/255*m,m)}function vx(f,[s,u,p,v]){s=s.evaluate(f),u=u.evaluate(f),p=p.evaluate(f);const m=v?v.evaluate(f):1,_=function(B,k,R,z){return typeof B=="number"&&B>=0&&B<=360?typeof k=="number"&&k>=0&&k<=100&&typeof R=="number"&&R>=0&&R<=100?z===void 0||typeof z=="number"&&z>=0&&z<=1?null:`Invalid hsla value [${[B,k,R,z].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof z=="number"?[B,k,R,z]:[B,k,R]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof z=="number"?[B,k,R,z]:[B,k,R]).join(", ")}]: 'h' must be between 0 and 360.`}(s,u,p,m);if(_)throw new ba(_);const P=`hsla(${s}, ${u}%, ${p}%, ${m})`,O=Xn.parse(P);if(!O)throw new ba(`Failed to parse HSLA color: ${P}`);return O}function sd(f,s){return f in s}function ah(f,s){const u=s[f];return u===void 0?null:u}function bl(f){return{type:f}}function _f(f){return{result:"success",value:f}}function Ro(f){return{result:"error",value:f}}function mu(f,s){return!!f&&!!f.parameters&&f.parameters.indexOf(s)>-1}function $l(f){return f["property-type"]==="data-driven"}function wa(f){return mu(f.expression,"measure-light")}function ra(f){return mu(f.expression,"zoom")}function ql(f){return!!f.expression&&f.expression.interpolated}function Ws(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function Jo(f){return f}function gu(f,s){const u=s.type==="color",p=f.stops&&typeof f.stops[0][0]=="object",v=p||!(p||f.property!==void 0),m=f.type||(ql(s)?"exponential":"interval");if(u&&((f=Ku({},f)).stops&&(f.stops=f.stops.map(B=>[B[0],Xn.parse(B[1])])),f.default=Xn.parse(f.default?f.default:s.default)),f.colorSpace&&f.colorSpace!=="rgb"&&!Dp[f.colorSpace])throw new Error(`Unknown color space: ${f.colorSpace}`);let _,P,O;if(m==="exponential")_=Oy;else if(m==="interval")_=ng;else if(m==="categorical"){_=Qo,P=Object.create(null);for(const B of f.stops)P[B[0]]=B[1];O=typeof f.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);_=Ry}if(p){const B={},k=[];for(let M=0;M<f.stops.length;M++){const L=f.stops[M],q=L[0].zoom;B[q]===void 0&&(B[q]={zoom:q,type:f.type,property:f.property,default:f.default,stops:[]},k.push(q)),B[q].stops.push([L[0].value,L[1]])}const R=[];for(const M of k)R.push([B[M].zoom,gu(B[M],s)]);const z={name:"linear"};return{kind:"composite",interpolationType:z,interpolationFactor:Is.interpolationFactor.bind(void 0,z),zoomStops:R.map(M=>M[0]),evaluate:({zoom:M},L)=>Oy({stops:R,base:f.base},s,M).evaluate(M,L)}}if(v){const B=m==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:B,interpolationFactor:Is.interpolationFactor.bind(void 0,B),zoomStops:f.stops.map(k=>k[0]),evaluate:({zoom:k})=>_(f,s,k,P,O)}}return{kind:"source",evaluate(B,k){const R=k&&k.properties?k.properties[f.property]:void 0;return R===void 0?cc(f.default,s.default):_(f,s,R,P,O)}}}function cc(f,s,u){return f!==void 0?f:s!==void 0?s:u!==void 0?u:void 0}function Qo(f,s,u,p,v){return cc(typeof u===v?p[u]:void 0,f.default,s.default)}function ng(f,s,u){if(Mo(u)!=="number")return cc(f.default,s.default);const p=f.stops.length;if(p===1||u<=f.stops[0][0])return f.stops[0][1];if(u>=f.stops[p-1][0])return f.stops[p-1][1];const v=mf(f.stops.map(m=>m[0]),u);return f.stops[v][1]}function Oy(f,s,u){const p=f.base!==void 0?f.base:1;if(Mo(u)!=="number")return cc(f.default,s.default);const v=f.stops.length;if(v===1||u<=f.stops[0][0])return f.stops[0][1];if(u>=f.stops[v-1][0])return f.stops[v-1][1];const m=mf(f.stops.map(k=>k[0]),u),_=function(k,R,z,M){const L=M-z,q=k-z;return L===0?0:R===1?q/L:(Math.pow(R,q)-1)/(Math.pow(R,L)-1)}(u,p,f.stops[m][0],f.stops[m+1][0]),P=f.stops[m][1],O=f.stops[m+1][1];let B=Hu[s.type]||Jo;if(f.colorSpace&&f.colorSpace!=="rgb"){const k=Dp[f.colorSpace];B=(R,z)=>k.reverse(k.interpolate(k.forward(R),k.forward(z),_))}return typeof P.evaluate=="function"?{evaluate(...k){const R=P.evaluate.apply(void 0,k),z=O.evaluate.apply(void 0,k);if(R!==void 0&&z!==void 0)return B(R,z,_)}}:B(P,O,_)}function Ry(f,s,u){return s.type==="color"?u=Xn.parse(u):s.type==="formatted"?u=Os.fromString(u.toString()):s.type==="resolvedImage"?u=Rs.build(u.toString()):Mo(u)===s.type||s.type==="enum"&&s.values[u]||(u=void 0),cc(u,f.default,s.default)}Oo.register(ad,{error:[{kind:"error"},[mi],(f,[s])=>{throw new ba(s.evaluate(f))}],typeof:[mi,[ii],(f,[s])=>_a(oa(s.evaluate(f)))],"to-rgba":[Za(br,4),[xs],(f,[s])=>s.evaluate(f).toRenderColor(null).toArray()],"to-hsla":[Za(br,4),[xs],(f,[s])=>s.evaluate(f).toRenderColor(null).toHslaArray()],rgb:[xs,[br,br,br],My],rgba:[xs,[br,br,br,br],My],hsl:[xs,[br,br,br],vx],hsla:[xs,[br,br,br,br],vx],has:{type:Wn,overloads:[[[mi],(f,[s])=>sd(s.evaluate(f),f.properties())],[[mi,Ec],(f,[s,u])=>sd(s.evaluate(f),u.evaluate(f))]]},get:{type:ii,overloads:[[[mi],(f,[s])=>ah(s.evaluate(f),f.properties())],[[mi,Ec],(f,[s,u])=>ah(s.evaluate(f),u.evaluate(f))]]},"feature-state":[ii,[mi],(f,[s])=>ah(s.evaluate(f),f.featureState||{})],properties:[Ec,[],f=>f.properties()],"geometry-type":[mi,[],f=>f.geometryType()],id:[ii,[],f=>f.id()],zoom:[br,[],f=>f.globals.zoom],pitch:[br,[],f=>f.globals.pitch||0],"distance-from-center":[br,[],f=>f.distanceFromCenter()],"measure-light":[br,[mi],(f,[s])=>f.measureLight(s.evaluate(f))],"heatmap-density":[br,[],f=>f.globals.heatmapDensity||0],"line-progress":[br,[],f=>f.globals.lineProgress||0],"raster-value":[br,[],f=>f.globals.rasterValue||0],"raster-particle-speed":[br,[],f=>f.globals.rasterParticleSpeed||0],"sky-radial-progress":[br,[],f=>f.globals.skyRadialProgress||0],accumulated:[ii,[],f=>f.globals.accumulated===void 0?null:f.globals.accumulated],"+":[br,bl(br),(f,s)=>{let u=0;for(const p of s)u+=p.evaluate(f);return u}],"*":[br,bl(br),(f,s)=>{let u=1;for(const p of s)u*=p.evaluate(f);return u}],"-":{type:br,overloads:[[[br,br],(f,[s,u])=>s.evaluate(f)-u.evaluate(f)],[[br],(f,[s])=>-s.evaluate(f)]]},"/":[br,[br,br],(f,[s,u])=>s.evaluate(f)/u.evaluate(f)],"%":[br,[br,br],(f,[s,u])=>s.evaluate(f)%u.evaluate(f)],ln2:[br,[],()=>Math.LN2],pi:[br,[],()=>Math.PI],e:[br,[],()=>Math.E],"^":[br,[br,br],(f,[s,u])=>Math.pow(s.evaluate(f),u.evaluate(f))],sqrt:[br,[br],(f,[s])=>Math.sqrt(s.evaluate(f))],log10:[br,[br],(f,[s])=>Math.log(s.evaluate(f))/Math.LN10],ln:[br,[br],(f,[s])=>Math.log(s.evaluate(f))],log2:[br,[br],(f,[s])=>Math.log(s.evaluate(f))/Math.LN2],sin:[br,[br],(f,[s])=>Math.sin(s.evaluate(f))],cos:[br,[br],(f,[s])=>Math.cos(s.evaluate(f))],tan:[br,[br],(f,[s])=>Math.tan(s.evaluate(f))],asin:[br,[br],(f,[s])=>Math.asin(s.evaluate(f))],acos:[br,[br],(f,[s])=>Math.acos(s.evaluate(f))],atan:[br,[br],(f,[s])=>Math.atan(s.evaluate(f))],min:[br,bl(br),(f,s)=>Math.min(...s.map(u=>u.evaluate(f)))],max:[br,bl(br),(f,s)=>Math.max(...s.map(u=>u.evaluate(f)))],abs:[br,[br],(f,[s])=>Math.abs(s.evaluate(f))],round:[br,[br],(f,[s])=>{const u=s.evaluate(f);return u<0?-Math.round(-u):Math.round(u)}],floor:[br,[br],(f,[s])=>Math.floor(s.evaluate(f))],ceil:[br,[br],(f,[s])=>Math.ceil(s.evaluate(f))],"filter-==":[Wn,[mi,ii],(f,[s,u])=>f.properties()[s.value]===u.value],"filter-id-==":[Wn,[ii],(f,[s])=>f.id()===s.value],"filter-type-==":[Wn,[mi],(f,[s])=>f.geometryType()===s.value],"filter-<":[Wn,[mi,ii],(f,[s,u])=>{const p=f.properties()[s.value],v=u.value;return typeof p==typeof v&&p<v}],"filter-id-<":[Wn,[ii],(f,[s])=>{const u=f.id(),p=s.value;return typeof u==typeof p&&u<p}],"filter->":[Wn,[mi,ii],(f,[s,u])=>{const p=f.properties()[s.value],v=u.value;return typeof p==typeof v&&p>v}],"filter-id->":[Wn,[ii],(f,[s])=>{const u=f.id(),p=s.value;return typeof u==typeof p&&u>p}],"filter-<=":[Wn,[mi,ii],(f,[s,u])=>{const p=f.properties()[s.value],v=u.value;return typeof p==typeof v&&p<=v}],"filter-id-<=":[Wn,[ii],(f,[s])=>{const u=f.id(),p=s.value;return typeof u==typeof p&&u<=p}],"filter->=":[Wn,[mi,ii],(f,[s,u])=>{const p=f.properties()[s.value],v=u.value;return typeof p==typeof v&&p>=v}],"filter-id->=":[Wn,[ii],(f,[s])=>{const u=f.id(),p=s.value;return typeof u==typeof p&&u>=p}],"filter-has":[Wn,[ii],(f,[s])=>s.value in f.properties()],"filter-has-id":[Wn,[],f=>f.id()!==null&&f.id()!==void 0],"filter-type-in":[Wn,[Za(mi)],(f,[s])=>s.value.indexOf(f.geometryType())>=0],"filter-id-in":[Wn,[Za(ii)],(f,[s])=>s.value.indexOf(f.id())>=0],"filter-in-small":[Wn,[mi,Za(ii)],(f,[s,u])=>u.value.indexOf(f.properties()[s.value])>=0],"filter-in-large":[Wn,[mi,Za(ii)],(f,[s,u])=>function(p,v,m,_){for(;m<=_;){const P=m+_>>1;if(v[P]===p)return!0;v[P]>p?_=P-1:m=P+1}return!1}(f.properties()[s.value],u.value,0,u.value.length-1)],all:{type:Wn,overloads:[[[Wn,Wn],(f,[s,u])=>s.evaluate(f)&&u.evaluate(f)],[bl(Wn),(f,s)=>{for(const u of s)if(!u.evaluate(f))return!1;return!0}]]},any:{type:Wn,overloads:[[[Wn,Wn],(f,[s,u])=>s.evaluate(f)||u.evaluate(f)],[bl(Wn),(f,s)=>{for(const u of s)if(u.evaluate(f))return!0;return!1}]]},"!":[Wn,[Wn],(f,[s])=>!s.evaluate(f)],"is-supported-script":[Wn,[mi],(f,[s])=>{const u=f.globals&&f.globals.isSupportedScript;return!u||u(s.evaluate(f))}],upcase:[mi,[mi],(f,[s])=>s.evaluate(f).toUpperCase()],downcase:[mi,[mi],(f,[s])=>s.evaluate(f).toLowerCase()],concat:[mi,bl(ii),(f,s)=>s.map(u=>Ra(u.evaluate(f))).join("")],"resolved-locale":[mi,[ou],(f,[s])=>s.evaluate(f).resolvedLocale()],random:[br,[br,br,ii],(f,s)=>{const[u,p,v]=s.map(_=>_.evaluate(f));if(u>p||u===p)return u;let m;if(typeof v=="string")m=function(_){let P=0;if(_.length===0)return P;for(let O=0;O<_.length;O++)P=(P<<5)-P+_.charCodeAt(O),P|=0;return P}(v);else{if(typeof v!="number")throw new ba(`Invalid seed input: ${v}`);m=v}return u+Ul(m)()*(p-u)}]});class sh{constructor(s,u,p,v){this.expression=s,this._warningHistory={},this._evaluator=new wy(p,v),this._defaultValue=u?function(m){return m.type==="color"&&(Ws(m.default)||Array.isArray(m.default))?new Xn(0,0,0,0):m.type==="color"?Xn.parse(m.default)||null:m.default===void 0?null:m.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null,this.configDependencies=Jd(s)}evaluateWithoutErrorHandling(s,u,p,v,m,_,P,O){return this._evaluator.globals=s,this._evaluator.feature=u,this._evaluator.featureState=p,this._evaluator.canonical=v||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=P||null,this._evaluator.featureDistanceData=O||null,this.expression.evaluate(this._evaluator)}evaluate(s,u,p,v,m,_,P,O){this._evaluator.globals=s,this._evaluator.feature=u||null,this._evaluator.featureState=p||null,this._evaluator.canonical=v||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=P||null,this._evaluator.featureDistanceData=O||null;try{const B=this.expression.evaluate(this._evaluator);if(B==null||typeof B=="number"&&B!=B)return this._defaultValue;if(this._enumValues&&!(B in this._enumValues))throw new ba(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(B)} instead.`);return B}catch(B){return this._warningHistory[B.message]||(this._warningHistory[B.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${B.message}`)),this._defaultValue}}}function oh(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in ad}function el(f,s,u,p){const v=new pf(ad,[],s?function(_){const P={color:xs,string:mi,number:br,enum:mi,boolean:Wn,formatted:Yo,resolvedImage:Mc};return _.type==="array"?Za(P[_.value]||ii,_.length):P[_.type]}(s):void 0,void 0,void 0,u,p),m=v.parse(f,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?_f(new sh(m,s,u,p)):Ro(v.errors)}class lh{constructor(s,u,p,v){this.kind=s,this._styleExpression=u,this.isLightConstant=p,this.isLineProgressConstant=v,this.isStateDependent=s!=="constant"&&!Lc(u.expression),this.configDependencies=Jd(u.expression)}evaluateWithoutErrorHandling(s,u,p,v,m,_){return this._styleExpression.evaluateWithoutErrorHandling(s,u,p,v,m,_)}evaluate(s,u,p,v,m,_){return this._styleExpression.evaluate(s,u,p,v,m,_)}}class ch{constructor(s,u,p,v,m,_){this.kind=s,this.zoomStops=p,this._styleExpression=u,this.isStateDependent=s!=="camera"&&!Lc(u.expression),this.isLightConstant=m,this.isLineProgressConstant=_,this.configDependencies=Jd(u.expression),this.interpolationType=v}evaluateWithoutErrorHandling(s,u,p,v,m,_){return this._styleExpression.evaluateWithoutErrorHandling(s,u,p,v,m,_)}evaluate(s,u,p,v,m,_){return this._styleExpression.evaluate(s,u,p,v,m,_)}interpolationFactor(s,u,p){return this.interpolationType?Is.interpolationFactor(this.interpolationType,s,u,p):0}}function Iy(f,s,u,p){if((f=el(f,s,u,p)).result==="error")return f;const v=f.value.expression,m=fu(v);if(!m&&!$l(s))return Ro([new xn("","data expressions not supported")]);const _=td(v,["zoom","pitch","distance-from-center"]);if(!_&&!ra(s))return Ro([new xn("","zoom expressions not supported")]);const P=td(v,["measure-light"]);if(!P&&!wa(s))return Ro([new xn("","measure-light expression not supported")]);const O=td(v,["line-progress"]);if(!O&&!function(R){return mu(R.expression,"line-progress")}(s))return Ro([new xn("","line-progress expression not supported")]);const B=s.expression&&s.expression.relaxZoomRestriction,k=Gl(v);return k||_||B?k instanceof xn?Ro([k]):k instanceof Is&&!ql(s)?Ro([new xn("",'"interpolate" expressions cannot be used with this property')]):_f(k?new ch(m&&O?"camera":"composite",f.value,k.labels,k instanceof Is?k.interpolation:void 0,P,O):new lh(m&&O?"constant":"source",f.value,P,O)):Ro([new xn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Bp{constructor(s,u){this._parameters=s,this._specification=u,Ku(this,gu(this._parameters,this._specification))}static deserialize(s){return new Bp(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Gl(f){let s=null;if(f instanceof eg)s=Gl(f.result);else if(f instanceof Qm){for(const u of f.args)if(s=Gl(u),s)break}else(f instanceof eh||f instanceof Is)&&f.input instanceof Oo&&f.input.name==="zoom"&&(s=f);return s instanceof xn||f.eachChild(u=>{const p=Gl(u);p instanceof xn?s=p:s&&p&&s!==p&&(s=new xn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}var od,uh,ig=function(){if(uh)return od;uh=1,od=s;var f=3;function s(u,p,v){var m=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;var _=new Int32Array(this.arrayBuffer);u=_[0],this.d=(p=_[1])+2*(v=_[2]);for(var P=0;P<this.d*this.d;P++){var O=_[f+P],B=_[f+P+1];m.push(O===B?null:_.subarray(O,B))}var k=_[f+m.length+1];this.keys=_.subarray(_[f+m.length],k),this.bboxes=_.subarray(k),this.insert=this._insertReadonly}else{this.d=p+2*v;for(var R=0;R<this.d*this.d;R++)m.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=u,this.padding=v,this.scale=p/u,this.uid=0;var z=v/p*u;this.min=-z,this.max=u+z}return s.prototype.insert=function(u,p,v,m,_){this._forEachCell(p,v,m,_,this._insertCell,this.uid++),this.keys.push(u),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(m),this.bboxes.push(_)},s.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},s.prototype._insertCell=function(u,p,v,m,_,P){this.cells[_].push(P)},s.prototype.query=function(u,p,v,m,_){var P=this.min,O=this.max;if(u<=P&&p<=P&&O<=v&&O<=m&&!_)return Array.prototype.slice.call(this.keys);var B=[];return this._forEachCell(u,p,v,m,this._queryCell,B,{},_),B},s.prototype._queryCell=function(u,p,v,m,_,P,O,B){var k=this.cells[_];if(k!==null)for(var R=this.keys,z=this.bboxes,M=0;M<k.length;M++){var L=k[M];if(O[L]===void 0){var q=4*L;(B?B(z[q+0],z[q+1],z[q+2],z[q+3]):u<=z[q+2]&&p<=z[q+3]&&v>=z[q+0]&&m>=z[q+1])?(O[L]=!0,P.push(R[L])):O[L]=!1}}},s.prototype._forEachCell=function(u,p,v,m,_,P,O,B){for(var k=this._convertToCellCoord(u),R=this._convertToCellCoord(p),z=this._convertToCellCoord(v),M=this._convertToCellCoord(m),L=k;L<=z;L++)for(var q=R;q<=M;q++){var X=this.d*q+L;if((!B||B(this._convertFromCellCoord(L),this._convertFromCellCoord(q),this._convertFromCellCoord(L+1),this._convertFromCellCoord(q+1)))&&_.call(this,u,p,v,m,X,P,O,B))return}},s.prototype._convertFromCellCoord=function(u){return(u-this.padding)/this.scale},s.prototype._convertToCellCoord=function(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))},s.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var u=this.cells,p=f+this.cells.length+1+1,v=0,m=0;m<this.cells.length;m++)v+=this.cells[m].length;var _=new Int32Array(p+v+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var P=p,O=0;O<u.length;O++){var B=u[O];_[f+O]=P,_.set(B,P),P+=B.length}return _[f+u.length]=P,_.set(this.keys,P),_[f+u.length+1]=P+=this.keys.length,_.set(this.bboxes,P),P+=this.bboxes.length,_.buffer},od}(),Fc=x(ig);const Io={};function mr(f,s,u={}){Object.defineProperty(f,"_classRegistryKey",{value:s,writable:!1}),Io[s]={klass:f,omit:u.omit||[]}}mr(Object,"Object"),Fc.serialize=function(f,s){const u=f.toArrayBuffer();return s&&s.add(u),{buffer:u}},Fc.deserialize=function(f){return new Fc(f.buffer)},Object.defineProperty(Fc,"name",{value:"Grid"}),mr(Fc,"Grid"),typeof DOMMatrix<"u"&&mr(DOMMatrix,"DOMMatrix"),mr(Xn,"Color"),mr(Error,"Error"),mr(Os,"Formatted"),mr(Fl,"FormattedSection"),mr(Oa,"AJAXError"),mr(Rs,"ResolvedImage"),mr(Bp,"StylePropertyFunction"),mr(sh,"StyleExpression",{omit:["_evaluator"]}),mr(_l,"ImageIdWithOptions"),mr(ch,"ZoomDependentExpression"),mr(lh,"ZoomConstantExpression"),mr(Oo,"CompoundExpression",{omit:["_evaluate"]});for(const f in ad)Io[ad[f]._classRegistryKey]||mr(ad[f],`Expression${f}`);function yu(f){return f&&typeof ArrayBuffer<"u"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function uc(f){return self.ImageBitmap&&f instanceof ImageBitmap}function _o(f,s){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp)return f;if(yu(f)||uc(f))return s&&s.add(f),f;if(ArrayBuffer.isView(f))return s&&s.add(f.buffer),f;if(f instanceof ImageData)return s&&s.add(f.data.buffer),f;if(Array.isArray(f)){const u=[];for(const p of f)u.push(_o(p,s));return u}if(f instanceof Map){const u={$name:"Map"};for(const[p,v]of f.entries())u[p]=_o(v);return u}if(f instanceof Set){const u={$name:"Set"};let p=0;for(const v of f.values())u[++p]=_o(v);return u}if(typeof f=="object"){const u=f.constructor,p=u._classRegistryKey;if(!p)throw new Error(`Can't serialize object of unregistered class "${p}".`);const v=u.serialize?u.serialize(f,s):{};if(!u.serialize){for(const m in f)f.hasOwnProperty(m)&&(Io[p].omit.indexOf(m)>=0||(v[m]=_o(f[m],s)));f instanceof Error&&(v.message=f.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(v.$name=p),v}throw new Error("can't serialize object of type "+typeof f)}function wl(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||yu(f)||uc(f)||ArrayBuffer.isView(f)||f instanceof ImageData)return f;if(Array.isArray(f))return f.map(wl);if(typeof f=="object"){const s=f.$name||"Object";if(s==="Map"){const v=new Map;for(const m of Object.keys(f))m!=="$name"&&v.set(m,wl(f[m]));return v}if(s==="Set"){const v=new Set;for(const m of Object.keys(f))m!=="$name"&&v.add(wl(f[m]));return v}const{klass:u}=Io[s];if(!u)throw new Error(`Can't deserialize unregistered class "${s}".`);if(u.deserialize)return u.deserialize(f);const p=Object.create(u.prototype);for(const v of Object.keys(f))v!=="$name"&&(p[v]=wl(f[v]));return p}throw new Error("can't deserialize object of type "+typeof f)}const Er={"Latin-1 Supplement":f=>f>=128&&f<=255,Arabic:f=>f>=1536&&f<=1791,"Arabic Supplement":f=>f>=1872&&f<=1919,"Arabic Extended-A":f=>f>=2208&&f<=2303,"Hangul Jamo":f=>f>=4352&&f<=4607,"Unified Canadian Aboriginal Syllabics":f=>f>=5120&&f<=5759,Khmer:f=>f>=6016&&f<=6143,"Unified Canadian Aboriginal Syllabics Extended":f=>f>=6320&&f<=6399,"General Punctuation":f=>f>=8192&&f<=8303,"Letterlike Symbols":f=>f>=8448&&f<=8527,"Number Forms":f=>f>=8528&&f<=8591,"Miscellaneous Technical":f=>f>=8960&&f<=9215,"Control Pictures":f=>f>=9216&&f<=9279,"Optical Character Recognition":f=>f>=9280&&f<=9311,"Enclosed Alphanumerics":f=>f>=9312&&f<=9471,"Geometric Shapes":f=>f>=9632&&f<=9727,"Miscellaneous Symbols":f=>f>=9728&&f<=9983,"Miscellaneous Symbols and Arrows":f=>f>=11008&&f<=11263,"CJK Radicals Supplement":f=>f>=11904&&f<=12031,"Kangxi Radicals":f=>f>=12032&&f<=12255,"Ideographic Description Characters":f=>f>=12272&&f<=12287,"CJK Symbols and Punctuation":f=>f>=12288&&f<=12351,Hiragana:f=>f>=12352&&f<=12447,Katakana:f=>f>=12448&&f<=12543,Bopomofo:f=>f>=12544&&f<=12591,"Hangul Compatibility Jamo":f=>f>=12592&&f<=12687,Kanbun:f=>f>=12688&&f<=12703,"Bopomofo Extended":f=>f>=12704&&f<=12735,"CJK Strokes":f=>f>=12736&&f<=12783,"Katakana Phonetic Extensions":f=>f>=12784&&f<=12799,"Enclosed CJK Letters and Months":f=>f>=12800&&f<=13055,"CJK Compatibility":f=>f>=13056&&f<=13311,"CJK Unified Ideographs Extension A":f=>f>=13312&&f<=19903,"Yijing Hexagram Symbols":f=>f>=19904&&f<=19967,"CJK Unified Ideographs":f=>f>=19968&&f<=40959,"Yi Syllables":f=>f>=40960&&f<=42127,"Yi Radicals":f=>f>=42128&&f<=42191,"Hangul Jamo Extended-A":f=>f>=43360&&f<=43391,"Hangul Syllables":f=>f>=44032&&f<=55215,"Hangul Jamo Extended-B":f=>f>=55216&&f<=55295,"Private Use Area":f=>f>=57344&&f<=63743,"CJK Compatibility Ideographs":f=>f>=63744&&f<=64255,"Arabic Presentation Forms-A":f=>f>=64336&&f<=65023,"Vertical Forms":f=>f>=65040&&f<=65055,"CJK Compatibility Forms":f=>f>=65072&&f<=65103,"Small Form Variants":f=>f>=65104&&f<=65135,"Arabic Presentation Forms-B":f=>f>=65136&&f<=65279,"Halfwidth and Fullwidth Forms":f=>f>=65280&&f<=65519,Osage:f=>f>=66736&&f<=66815,"CJK Unified Ideographs Extension B":f=>f>=131072&&f<=173791};function Vp(f){for(const s of f)if(bo(s.charCodeAt(0)))return!0;return!1}function Ly(f){for(const s of f)if(!Sl(s.charCodeAt(0)))return!1;return!0}function Sl(f){return!(Er.Arabic(f)||Er["Arabic Supplement"](f)||Er["Arabic Extended-A"](f)||Er["Arabic Presentation Forms-A"](f)||Er["Arabic Presentation Forms-B"](f))}function bo(f){return!(f!==746&&f!==747&&(f<4352||!(Er["Bopomofo Extended"](f)||Er.Bopomofo(f)||Er["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||Er["CJK Compatibility Ideographs"](f)||Er["CJK Compatibility"](f)||Er["CJK Radicals Supplement"](f)||Er["CJK Strokes"](f)||!(!Er["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||Er["CJK Unified Ideographs Extension A"](f)||Er["CJK Unified Ideographs"](f)||Er["Enclosed CJK Letters and Months"](f)||Er["Hangul Compatibility Jamo"](f)||Er["Hangul Jamo Extended-A"](f)||Er["Hangul Jamo Extended-B"](f)||Er["Hangul Jamo"](f)||Er["Hangul Syllables"](f)||Er.Hiragana(f)||Er["Ideographic Description Characters"](f)||Er.Kanbun(f)||Er["Kangxi Radicals"](f)||Er["Katakana Phonetic Extensions"](f)||Er.Katakana(f)&&f!==12540||!(!Er["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!Er["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||Er["Unified Canadian Aboriginal Syllabics"](f)||Er["Unified Canadian Aboriginal Syllabics Extended"](f)||Er["Vertical Forms"](f)||Er["Yijing Hexagram Symbols"](f)||Er["Yi Syllables"](f)||Er["Yi Radicals"](f))))}function Sa(f){return!(bo(f)||function(s){return!!(Er["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||Er["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||Er["Letterlike Symbols"](s)||Er["Number Forms"](s)||Er["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||Er["Control Pictures"](s)&&s!==9251||Er["Optical Character Recognition"](s)||Er["Enclosed Alphanumerics"](s)||Er["Geometric Shapes"](s)||Er["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Er["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Er["CJK Symbols and Punctuation"](s)||Er.Katakana(s)||Er["Private Use Area"](s)||Er["CJK Compatibility Forms"](s)||Er["Small Form Variants"](s)||Er["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(f))}function Nl(f){return f>=1424&&f<=2303||Er["Arabic Presentation Forms-A"](f)||Er["Arabic Presentation Forms-B"](f)}function Dy(f,s){return!(!s&&Nl(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||Er.Khmer(f))}function ag(f){for(const s of f)if(Nl(s.charCodeAt(0)))return!0;return!1}const dh="deferred",bf="loading",sg="loaded";let Al=null,Lo="unavailable",Tl=null;const Up=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(Lo="error"),Al&&Al(f)};function Fy(){zc.fire(new xi("pluginStateChange",{pluginStatus:Lo,pluginURL:Tl}))}const zc=new au,hh=function(){return Lo},wf=function(){if(Lo!==dh||!Tl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Lo=bf,Fy(),Tl&&ls({url:Tl},f=>{f?Up(f):(Lo=sg,Fy())})},tl={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Lo===sg||tl.applyArabicShaping!=null,isLoading:()=>Lo===bf,setState(f){Lo=f.pluginStatus,Tl=f.pluginURL},isParsed:()=>tl.applyArabicShaping!=null&&tl.processBidirectionalText!=null&&tl.processStyledBidirectionalText!=null,getPluginURL:()=>Tl};class vi{constructor(s,u){this.zoom=s,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.transition=u.transition,this.pitch=u.pitch,this.brightness=u.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(s){return function(u,p){for(const v of u)if(!Dy(v.charCodeAt(0),p))return!1;return!0}(s,tl.isLoaded())}}class $p{constructor(s,u,p,v){this.property=s,this.value=u,this.expression=function(m,_,P,O){if(Ws(m))return new Bp(m,_);if(oh(m)||Array.isArray(m)&&m.length>0){const B=Iy(m,_,P,O);if(B.result==="error")throw new Error(B.value.map(k=>`${k.key}: ${k.message}`).join(", "));return B.value}{let B=m;return typeof m=="string"&&_.type==="color"&&(B=Xn.parse(m)),{kind:"constant",configDependencies:new Set,evaluate:()=>B}}}(u===void 0?s.specification.default:u,s.specification,p,v)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,u,p){return this.property.possiblyEvaluate(this,s,u,p)}}class ld{constructor(s,u,p){this.property=s,this.value=new $p(s,void 0,u,p)}transitioned(s,u){return new cd(this.property,this.value,u,Ui({},s.transition,this.transition),s.now)}untransitioned(){return new cd(this.property,this.value,null,{},0)}}class fh{constructor(s,u,p){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues),this._scope=u,this._options=p,this.configDependencies=new Set}getValue(s){return $s(this._values[s].value.value)}setValue(s,u){this._values.hasOwnProperty(s)||(this._values[s]=new ld(this._values[s].property,this._scope,this._options)),this._values[s].value=new $p(this._values[s].property,u===null?void 0:$s(u),this._scope,this._options),this._values[s].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[s].value.expression.configDependencies]))}setTransitionOrValue(s,u){u&&(this._options=u);const p=this._properties.properties;if(s)for(const v in s){const m=s[v];if(ss(v,"-transition")){const _=v.slice(0,-11);p[_]&&this.setTransition(_,m)}else p.hasOwnProperty(v)&&this.setValue(v,m)}}getTransition(s){return $s(this._values[s].transition)}setTransition(s,u){this._values.hasOwnProperty(s)||(this._values[s]=new ld(this._values[s].property)),this._values[s].transition=$s(u)||void 0}serialize(){const s={};for(const u of Object.keys(this._values)){const p=this.getValue(u);p!==void 0&&(s[u]=p);const v=this.getTransition(u);v!==void 0&&(s[`${u}-transition`]=v)}return s}transitioned(s,u){const p=new ph(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].transitioned(s,u._values[v]);return p}untransitioned(){const s=new ph(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].untransitioned();return s}}class cd{constructor(s,u,p,v,m){const _=v.delay||0,P=v.duration||0;m=m||0,this.property=s,this.value=u,this.begin=m+_,this.end=this.begin+P,s.specification.transition&&(v.delay||v.duration)&&(this.prior=p)}possiblyEvaluate(s,u,p){const v=s.now||0,m=this.value.possiblyEvaluate(s,u,p),_=this.prior;if(_){if(v>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(v<this.begin)return _.possiblyEvaluate(s,u,p);{const P=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(s,u,p),m,Cr(P))}}return m}}class ph{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,u,p){const v=new hd(this._properties);for(const m of Object.keys(this._values))v._values[m]=this._values[m].possiblyEvaluate(s,u,p);return v}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class ud{constructor(s,u,p){this._properties=s,this._values=Object.create(s.defaultPropertyValues),this._scope=u,this._options=p,this.configDependencies=new Set}getValue(s){return $s(this._values[s].value)}setValue(s,u){this._values[s]=new $p(this._values[s].property,u===null?void 0:$s(u),this._scope,this._options),this._values[s].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[s].expression.configDependencies]))}serialize(){const s={};for(const u of Object.keys(this._values)){const p=this.getValue(u);p!==void 0&&(s[u]=p)}return s}possiblyEvaluate(s,u,p){const v=new hd(this._properties);for(const m of Object.keys(this._values))v._values[m]=this._values[m].possiblyEvaluate(s,u,p);return v}}class dd{constructor(s,u,p){this.property=s,this.value=u,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,u,p,v){return this.property.evaluate(this.value,this.parameters,s,u,p,v)}}class hd{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class Jt{constructor(s){this.specification=s}possiblyEvaluate(s,u){return s.expression.evaluate(u)}interpolate(s,u,p){const v=Hu[this.specification.type];return v?v(s,u,p):s}}class dr{constructor(s,u){this.specification=s,this.overrides=u}possiblyEvaluate(s,u,p,v){return new dd(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(u,null,{},p,v)}:s.expression,u)}interpolate(s,u,p){if(s.value.kind!=="constant"||u.value.kind!=="constant")return s;if(s.value.value===void 0||u.value.value===void 0)return new dd(this,{kind:"constant",value:void 0},s.parameters);const v=Hu[this.specification.type];return v?new dd(this,{kind:"constant",value:v(s.value.value,u.value.value,p)},s.parameters):s}evaluate(s,u,p,v,m,_){return s.kind==="constant"?s.value:s.evaluate(u,p,v,m,_)}}class Wl{constructor(s){this.specification=s}possiblyEvaluate(s,u,p,v){return!!s.expression.evaluate(u,null,{},p,v)}interpolate(){return!1}}class qi{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const u=new vi(0,{});for(const p in s){const v=s[p];v.specification.overridable&&this.overridableProperties.push(p);const m=this.defaultPropertyValues[p]=new $p(v,void 0),_=this.defaultTransitionablePropertyValues[p]=new ld(v);this.defaultTransitioningPropertyValues[p]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=m.possiblyEvaluate(u)}}}mr(dr,"DataDrivenProperty"),mr(Jt,"DataConstantProperty"),mr(Wl,"ColorRampProperty");var vt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function Bc(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function dc(f){if(Array.isArray(f))return f.map(dc);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){const s={};for(const u in f)s[u]=dc(f[u]);return s}return Bc(f)}function qp(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(const s of f.slice(1))if(!qp(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}function zy(f,s="",u=null,p="fill"){if(f==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};qp(f)||(f=fd(f));const v=f;let m=!0;try{m=function(k){if(!vu(k))return k;let R=dc(k);return xu(R),R=Vc(R),R}(v)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(v,null,2)}
        `)}let _=null,P=null;if(p!=="background"&&p!=="sky"&&p!=="slot"){P=vt[`filter_${p}`];const k=el(m,P,s,u);if(k.result==="error")throw new Error(k.value.map(R=>`${R.key}: ${R.message}`).join(", "));_=(R,z,M)=>k.value.evaluate(R,z,{},M)}let O=null,B=null;if(m!==v){const k=el(v,P,s,u);if(k.result==="error")throw new Error(k.value.map(R=>`${R.key}: ${R.message}`).join(", "));O=(R,z,M,L,q)=>k.value.evaluate(R,z,{},M,void 0,void 0,L,q),B=!fu(k.value.expression)}return{filter:_,dynamicFilter:O||void 0,needGeometry:By(m),needFeature:!!B}}function Vc(f){if(!Array.isArray(f))return f;const s=function(u){if(_x.has(u[0])){for(let p=1;p<u.length;p++)if(vu(u[p]))return!0}return u}(f);return s===!0?s:s.map(u=>Vc(u))}function xu(f){let s=!1;const u=[];if(f[0]==="case"){for(let p=1;p<f.length-1;p+=2)s=s||vu(f[p]),u.push(f[p+1]);u.push(f[f.length-1])}else if(f[0]==="match"){s=s||vu(f[1]);for(let p=2;p<f.length-1;p+=2)u.push(f[p+1]);u.push(f[f.length-1])}else if(f[0]==="step"){s=s||vu(f[1]);for(let p=1;p<f.length-1;p+=2)u.push(f[p+1])}s&&(f.length=0,f.push("any",...u));for(let p=1;p<f.length;p++)xu(f[p])}function vu(f){if(!Array.isArray(f))return!1;if((s=f[0])==="pitch"||s==="distance-from-center")return!0;var s;for(let u=1;u<f.length;u++)if(vu(f[u]))return!0;return!1}const _x=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function og(f,s){return f<s?-1:f>s?1:0}function By(f){if(!Array.isArray(f))return!1;if(f[0]==="within"||f[0]==="distance")return!0;for(let s=1;s<f.length;s++)if(By(f[s]))return!0;return!1}function fd(f){if(!f)return!0;const s=f[0];return f.length<=1?s!=="any":s==="=="?io(f[1],f[2],"=="):s==="!="?jl(io(f[1],f[2],"==")):s==="<"||s===">"||s==="<="||s===">="?io(f[1],f[2],s):s==="any"?(u=f.slice(1),["any"].concat(u.map(fd))):s==="all"?["all"].concat(f.slice(1).map(fd)):s==="none"?["all"].concat(f.slice(1).map(fd).map(jl)):s==="in"?mh(f[1],f.slice(2)):s==="!in"?jl(mh(f[1],f.slice(2))):s==="has"?gh(f[1]):s!=="!has"||jl(gh(f[1]));var u}function io(f,s,u){switch(f){case"$type":return[`filter-type-${u}`,s];case"$id":return[`filter-id-${u}`,s];default:return[`filter-${u}`,f,s]}}function mh(f,s){if(s.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(u=>typeof u!=typeof s[0])?["filter-in-large",f,["literal",s.sort(og)]]:["filter-in-small",f,["literal",s]]}}function gh(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function jl(f){return["!",f]}const Sf="";function Do(f,s){return s?`${f}${Sf}${s}`:f}const Uc="-transition",lg=new Set(["fill","line","background","hillshade","raster"]);class hi extends au{constructor(s,u,p,v,m){if(super(),this.id=s.id,this.fqid=Do(this.id,p),this.type=s.type,this.scope=p,this.lut=v,this.options=m,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,s.type!=="custom"){if(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type&&s.type!=="background"&&s.type!=="sky"&&s.type!=="slot"){this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter;const _=el(this.filter,vt[`filter_${s.type}`]);_.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,..._.value.configDependencies]))}if(s.slot&&(this.slot=s.slot),u.layout&&(this._unevaluatedLayout=new ud(u.layout,this.scope,m),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),u.paint){this._transitionablePaint=new fh(u.paint,this.scope,m);for(const _ in s.paint)this.setPaintProperty(_,s.paint[_]);for(const _ in s.layout)this.setLayoutProperty(_,s.layout[_]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new hd(u.paint)}}}onAdd(s){}onRemove(s){}isDraped(s){return!this.is3D()&&lg.has(this.type)}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,u){if(this.type==="custom"&&s==="visibility")return void(this.visibility=u);const p=this._unevaluatedLayout;p._properties.properties[s]&&(p.setValue(s,u),this.configDependencies=new Set([...this.configDependencies,...p.configDependencies]),s==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(s){return ss(s,Uc)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,u){const p=this._transitionablePaint,v=p._properties.properties;if(ss(s,Uc)){const R=s.slice(0,-11);return v[R]&&p.setTransition(R,u||void 0),!1}if(!v[s])return!1;const m=p._values[s],_=m.value.isDataDriven(),P=m.value;p.setValue(s,u),this.configDependencies=new Set([...this.configDependencies,...p.configDependencies]),this._handleSpecialPaintPropertyUpdate(s);const O=p._values[s].value,B=O.isDataDriven(),k=ss(s,"pattern")||s==="line-dasharray";return B||_||k||this._handleOverridablePaintPropertyUpdate(s,P,O)}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getDefaultProgramParams(s,u,p){return null}_handleOverridablePaintPropertyUpdate(s,u,p){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,u){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,u)}serialize(){return Il({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(s,u)=>!(s===void 0||u==="layout"&&!Object.keys(s).length||u==="paint"&&!Object.keys(s).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const s in this.paint._values){const u=this.paint.get(s);if(u instanceof dd&&$l(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}compileFilter(s){this._filterCompiled||(this._featureFilter=zy(this.filter,this.scope,s),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(s){this._stats&&(s.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(s){}queryIntersectsFeature(s,u,p,v,m,_,P,O,B){}}const cg={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class yh{constructor(s,u){this._structArray=s,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Pi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,u){return s._trim(),u&&(s.isTransferred=!0,u.add(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const u=Object.create(this.prototype);return u.arrayBuffer=s.arrayBuffer,u.length=s.length,u.capacity=s.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...s){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...s){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Jn(f,s=1){let u=0,p=0;return{members:f.map(v=>{const m=cg[v.type].BYTES_PER_ELEMENT,_=u=ug(u,Math.max(s,m)),P=v.components||1;return p=Math.max(p,m),u+=m*P,{name:v.name,type:v.type,components:P,offset:_}}),size:ug(u,Math.max(p,s)),alignment:s}}function ug(f,s){return Math.ceil(f/s)*s}class Fo extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u){const p=this.length;return this.resize(p+1),this.emplace(p,s,u)}emplace(s,u,p){const v=2*s;return this.int16[v+0]=u,this.int16[v+1]=p,s}}Fo.prototype.bytesPerElement=4,mr(Fo,"StructArrayLayout2i4");class la extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,p){const v=this.length;return this.resize(v+1),this.emplace(v,s,u,p)}emplace(s,u,p,v){const m=3*s;return this.int16[m+0]=u,this.int16[m+1]=p,this.int16[m+2]=v,s}}la.prototype.bytesPerElement=6,mr(la,"StructArrayLayout3i6");class pa extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,s,u,p,v)}emplace(s,u,p,v,m){const _=4*s;return this.int16[_+0]=u,this.int16[_+1]=p,this.int16[_+2]=v,this.int16[_+3]=m,s}}pa.prototype.bytesPerElement=8,mr(pa,"StructArrayLayout4i8");class cs extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m){const _=this.length;return this.resize(_+1),this.emplace(_,s,u,p,v,m)}emplace(s,u,p,v,m,_){const P=5*s;return this.int16[P+0]=u,this.int16[P+1]=p,this.int16[P+2]=v,this.int16[P+3]=m,this.int16[P+4]=_,s}}cs.prototype.bytesPerElement=10,mr(cs,"StructArrayLayout5i10");class pd extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,P){const O=this.length;return this.resize(O+1),this.emplace(O,s,u,p,v,m,_,P)}emplace(s,u,p,v,m,_,P,O){const B=6*s,k=12*s,R=3*s;return this.int16[B+0]=u,this.int16[B+1]=p,this.uint8[k+4]=v,this.uint8[k+5]=m,this.uint8[k+6]=_,this.uint8[k+7]=P,this.float32[R+2]=O,s}}pd.prototype.bytesPerElement=12,mr(pd,"StructArrayLayout2i4ub1f12");class rl extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p){const v=this.length;return this.resize(v+1),this.emplace(v,s,u,p)}emplace(s,u,p,v){const m=3*s;return this.float32[m+0]=u,this.float32[m+1]=p,this.float32[m+2]=v,s}}rl.prototype.bytesPerElement=12,mr(rl,"StructArrayLayout3f12");class us extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m){const _=this.length;return this.resize(_+1),this.emplace(_,s,u,p,v,m)}emplace(s,u,p,v,m,_){const P=6*s,O=3*s;return this.uint16[P+0]=u,this.uint16[P+1]=p,this.uint16[P+2]=v,this.uint16[P+3]=m,this.float32[O+2]=_,s}}us.prototype.bytesPerElement=12,mr(us,"StructArrayLayout4ui1f12");class dg extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,s,u,p,v)}emplace(s,u,p,v,m){const _=4*s;return this.uint16[_+0]=u,this.uint16[_+1]=p,this.uint16[_+2]=v,this.uint16[_+3]=m,s}}dg.prototype.bytesPerElement=8,mr(dg,"StructArrayLayout4ui8");class _s extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_){const P=this.length;return this.resize(P+1),this.emplace(P,s,u,p,v,m,_)}emplace(s,u,p,v,m,_,P){const O=6*s;return this.int16[O+0]=u,this.int16[O+1]=p,this.int16[O+2]=v,this.int16[O+3]=m,this.int16[O+4]=_,this.int16[O+5]=P,s}}_s.prototype.bytesPerElement=12,mr(_s,"StructArrayLayout6i12");class Gp extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,P,O,B,k,R,z){const M=this.length;return this.resize(M+1),this.emplace(M,s,u,p,v,m,_,P,O,B,k,R,z)}emplace(s,u,p,v,m,_,P,O,B,k,R,z,M){const L=12*s;return this.int16[L+0]=u,this.int16[L+1]=p,this.int16[L+2]=v,this.int16[L+3]=m,this.uint16[L+4]=_,this.uint16[L+5]=P,this.uint16[L+6]=O,this.uint16[L+7]=B,this.int16[L+8]=k,this.int16[L+9]=R,this.int16[L+10]=z,this.int16[L+11]=M,s}}Gp.prototype.bytesPerElement=24,mr(Gp,"StructArrayLayout4i4ui4i24");class Wp extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_){const P=this.length;return this.resize(P+1),this.emplace(P,s,u,p,v,m,_)}emplace(s,u,p,v,m,_,P){const O=10*s,B=5*s;return this.int16[O+0]=u,this.int16[O+1]=p,this.int16[O+2]=v,this.float32[B+2]=m,this.float32[B+3]=_,this.float32[B+4]=P,s}}Wp.prototype.bytesPerElement=20,mr(Wp,"StructArrayLayout3i3f20");class _u extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,s,u,p,v)}emplace(s,u,p,v,m){const _=4*s;return this.float32[_+0]=u,this.float32[_+1]=p,this.float32[_+2]=v,this.float32[_+3]=m,s}}_u.prototype.bytesPerElement=16,mr(_u,"StructArrayLayout4f16");class Hl extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint32[1*s+0]=u,s}}Hl.prototype.bytesPerElement=4,mr(Hl,"StructArrayLayout1ul4");class Ls extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u){const p=this.length;return this.resize(p+1),this.emplace(p,s,u)}emplace(s,u,p){const v=2*s;return this.uint16[v+0]=u,this.uint16[v+1]=p,s}}Ls.prototype.bytesPerElement=4,mr(Ls,"StructArrayLayout2ui4");class xh extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,P,O,B,k,R,z,M){const L=this.length;return this.resize(L+1),this.emplace(L,s,u,p,v,m,_,P,O,B,k,R,z,M)}emplace(s,u,p,v,m,_,P,O,B,k,R,z,M,L){const q=20*s,X=10*s;return this.int16[q+0]=u,this.int16[q+1]=p,this.int16[q+2]=v,this.int16[q+3]=m,this.int16[q+4]=_,this.float32[X+3]=P,this.float32[X+4]=O,this.float32[X+5]=B,this.float32[X+6]=k,this.int16[q+14]=R,this.uint32[X+8]=z,this.uint16[q+18]=M,this.uint16[q+19]=L,s}}xh.prototype.bytesPerElement=40,mr(xh,"StructArrayLayout5i4f1i1ul2ui40");class Nf extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,P){const O=this.length;return this.resize(O+1),this.emplace(O,s,u,p,v,m,_,P)}emplace(s,u,p,v,m,_,P,O){const B=8*s;return this.int16[B+0]=u,this.int16[B+1]=p,this.int16[B+2]=v,this.int16[B+4]=m,this.int16[B+5]=_,this.int16[B+6]=P,this.int16[B+7]=O,s}}Nf.prototype.bytesPerElement=16,mr(Nf,"StructArrayLayout3i2i2i16");class Hp extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m){const _=this.length;return this.resize(_+1),this.emplace(_,s,u,p,v,m)}emplace(s,u,p,v,m,_){const P=4*s,O=8*s;return this.float32[P+0]=u,this.float32[P+1]=p,this.float32[P+2]=v,this.int16[O+6]=m,this.int16[O+7]=_,s}}Hp.prototype.bytesPerElement=16,mr(Hp,"StructArrayLayout2f1f2i16");class hg extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_){const P=this.length;return this.resize(P+1),this.emplace(P,s,u,p,v,m,_)}emplace(s,u,p,v,m,_,P){const O=20*s,B=5*s;return this.uint8[O+0]=u,this.uint8[O+1]=p,this.float32[B+1]=v,this.float32[B+2]=m,this.float32[B+3]=_,this.float32[B+4]=P,s}}hg.prototype.bytesPerElement=20,mr(hg,"StructArrayLayout2ub4f20");class bs extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,p){const v=this.length;return this.resize(v+1),this.emplace(v,s,u,p)}emplace(s,u,p,v){const m=3*s;return this.uint16[m+0]=u,this.uint16[m+1]=p,this.uint16[m+2]=v,s}}bs.prototype.bytesPerElement=6,mr(bs,"StructArrayLayout3ui6");class fg extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,P,O,B,k,R,z,M,L,q,X,te,le,ce,ie,fe){const xe=this.length;return this.resize(xe+1),this.emplace(xe,s,u,p,v,m,_,P,O,B,k,R,z,M,L,q,X,te,le,ce,ie,fe)}emplace(s,u,p,v,m,_,P,O,B,k,R,z,M,L,q,X,te,le,ce,ie,fe,xe){const je=30*s,Fe=15*s,De=60*s;return this.int16[je+0]=u,this.int16[je+1]=p,this.int16[je+2]=v,this.float32[Fe+2]=m,this.float32[Fe+3]=_,this.uint16[je+8]=P,this.uint16[je+9]=O,this.uint32[Fe+5]=B,this.uint32[Fe+6]=k,this.uint32[Fe+7]=R,this.uint16[je+16]=z,this.uint16[je+17]=M,this.uint16[je+18]=L,this.float32[Fe+10]=q,this.float32[Fe+11]=X,this.uint8[De+48]=te,this.uint8[De+49]=le,this.uint8[De+50]=ce,this.uint32[Fe+13]=ie,this.int16[je+28]=fe,this.uint8[De+58]=xe,s}}fg.prototype.bytesPerElement=60,mr(fg,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class pg extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,P,O,B,k,R,z,M,L,q,X,te,le,ce,ie,fe,xe,je,Fe,De,Ie,et,Ve,rt,ot,it,ct){const ft=this.length;return this.resize(ft+1),this.emplace(ft,s,u,p,v,m,_,P,O,B,k,R,z,M,L,q,X,te,le,ce,ie,fe,xe,je,Fe,De,Ie,et,Ve,rt,ot,it,ct)}emplace(s,u,p,v,m,_,P,O,B,k,R,z,M,L,q,X,te,le,ce,ie,fe,xe,je,Fe,De,Ie,et,Ve,rt,ot,it,ct,ft){const xt=20*s,ut=40*s,Mt=80*s;return this.float32[xt+0]=u,this.float32[xt+1]=p,this.int16[ut+4]=v,this.int16[ut+5]=m,this.int16[ut+6]=_,this.int16[ut+7]=P,this.int16[ut+8]=O,this.int16[ut+9]=B,this.int16[ut+10]=k,this.int16[ut+11]=R,this.int16[ut+12]=z,this.uint16[ut+13]=M,this.uint16[ut+14]=L,this.uint16[ut+15]=q,this.uint16[ut+16]=X,this.uint16[ut+17]=te,this.uint16[ut+18]=le,this.uint16[ut+19]=ce,this.uint16[ut+20]=ie,this.uint16[ut+21]=fe,this.uint16[ut+22]=xe,this.uint16[ut+23]=je,this.uint16[ut+24]=Fe,this.uint16[ut+25]=De,this.uint16[ut+26]=Ie,this.uint16[ut+27]=et,this.uint32[xt+14]=Ve,this.float32[xt+15]=rt,this.float32[xt+16]=ot,this.float32[xt+17]=it,this.float32[xt+18]=ct,this.uint8[Mt+76]=ft,s}}pg.prototype.bytesPerElement=80,mr(pg,"StructArrayLayout2f9i15ui1ul4f1ub80");class Af extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.float32[1*s+0]=u,s}}Af.prototype.bytesPerElement=4,mr(Af,"StructArrayLayout1f4");class bu extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m){const _=this.length;return this.resize(_+1),this.emplace(_,s,u,p,v,m)}emplace(s,u,p,v,m,_){const P=5*s;return this.float32[P+0]=u,this.float32[P+1]=p,this.float32[P+2]=v,this.float32[P+3]=m,this.float32[P+4]=_,s}}bu.prototype.bytesPerElement=20,mr(bu,"StructArrayLayout5f20");class Kp extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,P){const O=this.length;return this.resize(O+1),this.emplace(O,s,u,p,v,m,_,P)}emplace(s,u,p,v,m,_,P,O){const B=7*s;return this.float32[B+0]=u,this.float32[B+1]=p,this.float32[B+2]=v,this.float32[B+3]=m,this.float32[B+4]=_,this.float32[B+5]=P,this.float32[B+6]=O,s}}Kp.prototype.bytesPerElement=28,mr(Kp,"StructArrayLayout7f28");class hc extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,P,O,B,k,R){const z=this.length;return this.resize(z+1),this.emplace(z,s,u,p,v,m,_,P,O,B,k,R)}emplace(s,u,p,v,m,_,P,O,B,k,R,z){const M=11*s;return this.float32[M+0]=u,this.float32[M+1]=p,this.float32[M+2]=v,this.float32[M+3]=m,this.float32[M+4]=_,this.float32[M+5]=P,this.float32[M+6]=O,this.float32[M+7]=B,this.float32[M+8]=k,this.float32[M+9]=R,this.float32[M+10]=z,s}}hc.prototype.bytesPerElement=44,mr(hc,"StructArrayLayout11f44");class md extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,P,O,B){const k=this.length;return this.resize(k+1),this.emplace(k,s,u,p,v,m,_,P,O,B)}emplace(s,u,p,v,m,_,P,O,B,k){const R=9*s;return this.float32[R+0]=u,this.float32[R+1]=p,this.float32[R+2]=v,this.float32[R+3]=m,this.float32[R+4]=_,this.float32[R+5]=P,this.float32[R+6]=O,this.float32[R+7]=B,this.float32[R+8]=k,s}}md.prototype.bytesPerElement=36,mr(md,"StructArrayLayout9f36");class vh extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u){const p=this.length;return this.resize(p+1),this.emplace(p,s,u)}emplace(s,u,p){const v=2*s;return this.float32[v+0]=u,this.float32[v+1]=p,s}}vh.prototype.bytesPerElement=8,mr(vh,"StructArrayLayout2f8");class Tf extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,s,u,p,v)}emplace(s,u,p,v,m){const _=6*s;return this.uint32[3*s+0]=u,this.uint16[_+2]=p,this.uint16[_+3]=v,this.uint16[_+4]=m,s}}Tf.prototype.bytesPerElement=12,mr(Tf,"StructArrayLayout1ul3ui12");class jf extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint16[1*s+0]=u,s}}jf.prototype.bytesPerElement=2,mr(jf,"StructArrayLayout1ui2");class kf extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,P,O,B,k,R,z,M,L,q,X){const te=this.length;return this.resize(te+1),this.emplace(te,s,u,p,v,m,_,P,O,B,k,R,z,M,L,q,X)}emplace(s,u,p,v,m,_,P,O,B,k,R,z,M,L,q,X,te){const le=16*s;return this.float32[le+0]=u,this.float32[le+1]=p,this.float32[le+2]=v,this.float32[le+3]=m,this.float32[le+4]=_,this.float32[le+5]=P,this.float32[le+6]=O,this.float32[le+7]=B,this.float32[le+8]=k,this.float32[le+9]=R,this.float32[le+10]=z,this.float32[le+11]=M,this.float32[le+12]=L,this.float32[le+13]=q,this.float32[le+14]=X,this.float32[le+15]=te,s}}kf.prototype.bytesPerElement=64,mr(kf,"StructArrayLayout16f64");class _h extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,P){const O=this.length;return this.resize(O+1),this.emplace(O,s,u,p,v,m,_,P)}emplace(s,u,p,v,m,_,P,O){const B=10*s,k=5*s;return this.uint16[B+0]=u,this.uint16[B+1]=p,this.uint16[B+2]=v,this.uint16[B+3]=m,this.float32[k+2]=_,this.float32[k+3]=P,this.float32[k+4]=O,s}}_h.prototype.bytesPerElement=20,mr(_h,"StructArrayLayout4ui3f20");class mg extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.int16[1*s+0]=u,s}}mg.prototype.bytesPerElement=2,mr(mg,"StructArrayLayout1i2");class Zp extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint8[1*s+0]=u,s}}Zp.prototype.bytesPerElement=1,mr(Zp,"StructArrayLayout1ub1");class Vy extends yh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Vy.prototype.size=40;class gg extends xh{get(s){return new Vy(this,s)}}mr(gg,"CollisionBoxArray");class bh extends yh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}bh.prototype.size=60;class Uy extends fg{get(s){return new bh(this,s)}}mr(Uy,"PlacedSymbolArray");class $y extends yh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(s){this._structArray.uint32[this._pos4+14]=s}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(s){this._structArray.float32[this._pos4+18]=s}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}$y.prototype.size=80;class qy extends pg{get(s){return new $y(this,s)}}mr(qy,"SymbolInstanceArray");class bx extends Af{getoffsetX(s){return this.float32[1*s+0]}}mr(bx,"GlyphOffsetArray");class Gy extends Fo{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}mr(Gy,"SymbolLineVertexArray");class Yp extends yh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Yp.prototype.size=12;class Xp extends Tf{get(s){return new Yp(this,s)}}mr(Xp,"FeatureIndexArray");class zo extends Ls{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}mr(zo,"FillExtrusionCentroidArray");class Pf extends yh{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Pf.prototype.size=6;class Wy extends la{get(s){return new Pf(this,s)}}mr(Wy,"FillExtrusionWallArray");const yg=Jn([{name:"a_pos",components:2,type:"Int16"}],4),X_=Jn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Na{constructor(s=[]){this.segments=s}_prepareSegment(s,u,p,v){let m=this.segments[this.segments.length-1];return s>Na.MAX_VERTEX_ARRAY_LENGTH&&ln(`Max vertices per segment is ${Na.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!m||m.vertexLength+s>Na.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==v)&&(m={vertexOffset:u,primitiveOffset:p,vertexLength:0,primitiveLength:0},v!==void 0&&(m.sortKey=v),this.segments.push(m)),m}prepareSegment(s,u,p,v){return this._prepareSegment(s,u.length,p.length,v)}get(){return this.segments}destroy(){for(const s of this.segments)for(const u in s.vaos)s.vaos[u].destroy()}static simpleSegment(s,u,p,v){return new Na([{vertexOffset:s,primitiveOffset:u,vertexLength:p,primitiveLength:v,vaos:{},sortKey:0}])}}function xg(f,s){return 256*(f=pr(Math.floor(f),0,255))+pr(Math.floor(s),0,255)}Na.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,mr(Na,"SegmentVector");const fc=Jn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Jp=Jn([{name:"a_dash",components:4,type:"Uint16"}]);class gd{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(s,u,p,v){this.ids.push(Hy(s)),this.positions.push(u,p,v)}eachPosition(s,u){const p=Hy(s);let v=0,m=this.ids.length-1;for(;v<m;){const _=v+m>>1;this.ids[_]>=p?m=_:v=_+1}for(;this.ids[v]===p;)u(this.positions[3*v],this.positions[3*v+1],this.positions[3*v+2]),v++}static serialize(s,u){const p=new Float64Array(s.ids),v=new Uint32Array(s.positions);return Cf(p,v,0,p.length-1),u&&(u.add(p.buffer),u.add(v.buffer)),{ids:p,positions:v}}static deserialize(s){const u=new gd;let p;u.ids=s.ids,u.positions=s.positions;for(const v of u.ids)v!==p&&u.uniqueIds.push(v),p=v;return u.indexed=!0,u}}function Hy(f){const s=+f;return!isNaN(s)&&Number.MIN_SAFE_INTEGER<=s&&s<=Number.MAX_SAFE_INTEGER?s:vl(String(f))}function Cf(f,s,u,p){for(;u<p;){const v=f[u+p>>1];let m=u-1,_=p+1;for(;;){do m++;while(f[m]<v);do _--;while(f[_]>v);if(m>=_)break;Qp(f,m,_),Qp(s,3*m,3*_),Qp(s,3*m+1,3*_+1),Qp(s,3*m+2,3*_+2)}_-u<p-_?(Cf(f,s,u,_),u=_+1):(Cf(f,s,_+1,p),p=_)}}function Qp(f,s,u){const p=f[s];f[s]=f[u],f[u]=p}mr(gd,"FeaturePositionMap");class Kl{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,u){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,u),this.initialized=!0),!!this.location}set(s,u,p){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class $c extends Kl{constructor(s){super(s),this.current=0}set(s,u,p){this.fetchUniformLocation(s,u)&&this.current!==p&&(this.current=p,this.gl.uniform1i(this.location,p))}}class ma extends Kl{constructor(s){super(s),this.current=0}set(s,u,p){this.fetchUniformLocation(s,u)&&this.current!==p&&(this.current=p,this.gl.uniform1f(this.location,p))}}class nl extends Kl{constructor(s){super(s),this.current=[0,0]}set(s,u,p){this.fetchUniformLocation(s,u)&&(p[0]===this.current[0]&&p[1]===this.current[1]||(this.current=p,this.gl.uniform2f(this.location,p[0],p[1])))}}class Ef extends Kl{constructor(s){super(s),this.current=[0,0,0]}set(s,u,p){this.fetchUniformLocation(s,u)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]||(this.current=p,this.gl.uniform3f(this.location,p[0],p[1],p[2])))}}class Mf extends Kl{constructor(s){super(s),this.current=[0,0,0,0]}set(s,u,p){this.fetchUniformLocation(s,u)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]&&p[3]===this.current[3]||(this.current=p,this.gl.uniform4f(this.location,p[0],p[1],p[2],p[3])))}}class Ky extends Kl{constructor(s){super(s),this.current=Xn.transparent.toRenderColor(null)}set(s,u,p){this.fetchUniformLocation(s,u)&&(p.r===this.current.r&&p.g===this.current.g&&p.b===this.current.b&&p.a===this.current.a||(this.current=p,this.gl.uniform4f(this.location,p.r,p.g,p.b,p.a)))}}const Zy=new Float32Array(16);class Of extends Kl{constructor(s){super(s),this.current=Zy}set(s,u,p){if(this.fetchUniformLocation(s,u)){if(p[12]!==this.current[12]||p[0]!==this.current[0])return this.current=p,void this.gl.uniformMatrix4fv(this.location,!1,p);for(let v=1;v<16;v++)if(p[v]!==this.current[v]){this.current=p,this.gl.uniformMatrix4fv(this.location,!1,p);break}}}}const vg=new Float32Array(9),J_=new Float32Array(4);class wo extends Kl{constructor(s){super(s),this.current=J_}set(s,u,p){if(this.fetchUniformLocation(s,u)){for(let v=0;v<4;v++)if(p[v]!==this.current[v]){this.current=p,this.gl.uniformMatrix2fv(this.location,!1,p);break}}}}function ao(f){return[xg(255*f.r,255*f.g),xg(255*f.b,255*f.a)]}class yd{constructor(s,u,p,v){this.value=s,this.uniformNames=u.map(m=>`u_${m}`),this.type=p,this.context=v}setUniform(s,u,p,v,m){const _=v.constantOr(this.value);u.set(s,m,_ instanceof Xn?_.toRenderColor(this.ignoreLut?null:this.context.lut):_)}getBinding(s,u){return this.type==="color"?new Ky(s):new ma(s)}}class xd{constructor(s,u){this.uniformNames=u.map(p=>`u_${p}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(s){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br)}setUniform(s,u,p,v,m){const _=m==="u_pattern"||m==="u_dash"?this.pattern:m==="u_pixel_ratio"?this.pixelRatio:null;_&&u.set(s,m,_)}getBinding(s,u){return u==="u_pattern"||u==="u_dash"?new Mf(s):new ma(s)}}class qc{constructor(s,u,p,v){this.expression=s,this.type=p,this.maxValue=0,this.paintVertexAttributes=u.map(m=>({name:`a_${m}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(s,u,p,v,m,_,P){const O=this.paintVertexArray.length,B=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new vi(0,{brightness:_}),u,{},m,v,P):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new vi(0,{brightness:_}),u,{},m,v,P)==="none"),this.paintVertexArray.resize(s),this._setPaintValue(O,s,B,this.context)}updatePaintArray(s,u,p,v,m,_,P){const O=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:P},p,v,void 0,m):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:0,brightness:P},p,v,void 0,m)==="none"),this._setPaintValue(s,u,O,this.context)}_setPaintValue(s,u,p,v){if(this.type==="color"){const m=ao(p.toRenderColor(this.ignoreLut?null:v.lut));for(let _=s;_<u;_++)this.paintVertexArray.emplace(_,m[0],m[1])}else{for(let m=s;m<u;m++)this.paintVertexArray.emplace(m,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Zl{constructor(s,u,p,v,m,_){this.expression=s,this.uniformNames=u.map(P=>`u_${P}_t`),this.type=p,this.useIntegerZoom=v,this.context=m,this.maxValue=0,this.paintVertexAttributes=u.map(P=>({name:`a_${P}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(s,u,p,v,m,_,P){const O=this.expression.evaluate(new vi(this.context.zoom,{brightness:_}),u,{},m,v,P),B=this.expression.evaluate(new vi(this.context.zoom+1,{brightness:_}),u,{},m,v,P);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new vi(this.context.zoom,{brightness:_}),u,{},m,v,P)==="none");const k=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(k,s,O,B,this.context)}updatePaintArray(s,u,p,v,m,_,P){const O=this.expression.evaluate({zoom:this.context.zoom,brightness:P},p,v,void 0,m),B=this.expression.evaluate({zoom:this.context.zoom+1,brightness:P},p,v,void 0,m);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:this.context.zoom,brightness:P},p,v,void 0,m)==="none"),this._setPaintValue(s,u,O,B,this.context)}_setPaintValue(s,u,p,v,m){if(this.type==="color"){const _=ao(p.toRenderColor(this.ignoreLut?null:m.lut)),P=ao(p.toRenderColor(this.ignoreLut?null:m.lut));for(let O=s;O<u;O++)this.paintVertexArray.emplace(O,_[0],_[1],P[0],P[1])}else{for(let _=s;_<u;_++)this.paintVertexArray.emplace(_,p,v);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(v))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,u,p,v,m){const _=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,P=pr(this.expression.interpolationFactor(_,this.context.zoom,this.context.zoom+1),0,1);u.set(s,m,P)}getBinding(s,u){return new ma(s)}}class wu{constructor(s,u,p,v,m){this.expression=s,this.layerId=m,this.paintVertexAttributes=(p==="array"?Jp:fc).members;for(let _=0;_<u.length;++_);this.paintVertexArray=new v}populatePaintArray(s,u,p,v){const m=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(m,s,u.patterns&&u.patterns[this.layerId],p)}updatePaintArray(s,u,p,v,m,_,P){this._setPaintValues(s,u,p.patterns&&p.patterns[this.layerId],_)}_setPaintValues(s,u,p,v){if(!v||!p)return;const m=v[p];if(!m)return;const{tl:_,br:P,pixelRatio:O}=m;for(let B=s;B<u;B++)this.paintVertexArray.emplace(B,_[0],_[1],P[0],P[1],O)}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Su{constructor(s,u,p=()=>!0){this.binders={},this._buffers=[],this.context=u;const v=[];for(const m in s.paint._values){const _=s.paint.get(m),P=s.paint.get(`${m}-use-theme`);if(m.endsWith("-use-theme")||!p(m)||!(_ instanceof dd&&$l(_.property.specification)))continue;const O=wx(m,s.type),B=_.value,k=_.property.specification.type,R=!!_.property.useIntegerZoom,z=m==="line-dasharray"||m.endsWith("pattern"),M=m==="line-dasharray"&&s.layout.get("line-cap").value.kind!=="constant"||P&&P.value.kind!=="constant";if(B.kind!=="constant"||M)if(B.kind==="source"||M||z){const L=_g(m,k,"source");this.binders[m]=z?new wu(B,O,k,L,s.id):new qc(B,O,k,L),v.push(`/a_${m}`)}else{const L=_g(m,k,"composite");this.binders[m]=new Zl(B,O,k,R,u,L),v.push(`/z_${m}`)}else this.binders[m]=z?new xd(B.value,O):new yd(B.value,O,k,u),v.push(`/u_${m}`);P&&(this.binders[m].ignoreLut=P.constantOr("default")==="none",this.binders[m].lutExpression=P.value,this.binders[m].checkUseTheme=!0)}this.cacheKey=v.sort().join("")}getMaxValue(s){const u=this.binders[s];return u instanceof qc||u instanceof Zl?u.maxValue:0}populatePaintArrays(s,u,p,v,m,_,P){for(const O in this.binders){const B=this.binders[O];B.context=this.context,B instanceof qc||B instanceof Zl||B instanceof wu?B.populatePaintArray(s,u,p,v,m,_,P):B.lutExpression&&B instanceof yd&&B.lutExpression&&(B.lutExpression.kind==="composite"||B.lutExpression.kind==="source")&&(B.ignoreLut=B.lutExpression.evaluate(new vi(0,{brightness:_}),u,{},m,v,P)==="none")}}setConstantPatternPositions(s){for(const u in this.binders){const p=this.binders[u];p instanceof xd&&p.setConstantPatternPositions(s)}}updatePaintArrays(s,u,p,v,m,_,P,O,B){let k=!1;const R=Object.keys(s),z=R.length!==0&&!O,M=z?R:u.uniqueIds;this.context.lut=m.lut;for(const L in this.binders){const q=this.binders[L];if(q.context=this.context,(q instanceof qc||q instanceof Zl||q instanceof wu)&&q.expression&&q.expression.kind&&q.expression.kind!=="constant"&&(q.expression.isStateDependent===!0||q.expression.isLightConstant===!1)){const X=m.paint.get(L);q.expression=X.value;for(const te of M){const le=s[te.toString()];u.eachPosition(te,(ce,ie,fe)=>{const xe=v.feature(ce);q.updatePaintArray(ie,fe,xe,le,_,P,B)})}if(!z)for(const te of p.uniqueIds){const le=s[te.toString()];p.eachPosition(te,(ce,ie,fe)=>{const xe=v.feature(ce);q.updatePaintArray(ie,fe,xe,le,_,P,B)})}k=!0}}return k}defines(){const s=[];for(const u in this.binders){const p=this.binders[u];(p instanceof yd||p instanceof xd)&&s.push(...p.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return s}getBinderAttributes(){const s=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof qc||p instanceof Zl||p instanceof wu)for(let v=0;v<p.paintVertexAttributes.length;v++)s.push(p.paintVertexAttributes[v].name)}return s}getBinderUniforms(){const s=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof yd||p instanceof xd||p instanceof Zl)for(const v of p.uniformNames)s.push(v)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const u=[];for(const p in this.binders){const v=this.binders[p];if(v instanceof yd||v instanceof xd||v instanceof Zl)for(const m of v.uniformNames)u.push({name:m,property:p,binding:v.getBinding(s,m)})}return u}setUniforms(s,u,p,v,m){for(const{name:_,property:P,binding:O}of p){if(this.binders[P].checkUseTheme&&this.binders[P]instanceof yd){const B=v.get(`${P}-use-theme`);B.isConstant()&&(this.binders[P].ignoreLut=B.constantOr("default")==="none")}this.binders[P].setUniform(s,O,m,v.get(P),_)}}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const u=this.binders[s];(u instanceof qc||u instanceof Zl||u instanceof wu)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(s){for(const u in this.binders){const p=this.binders[u];(p instanceof qc||p instanceof Zl||p instanceof wu)&&p.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const u=this.binders[s];(u instanceof qc||u instanceof Zl||u instanceof wu)&&u.destroy()}}}class Nu{constructor(s,u,p=()=>!0){this.programConfigurations={};for(const v of s)this.programConfigurations[v.id]=new Su(v,u,p);this.needsUpload=!1,this._featureMap=new gd,this._featureMapWithoutIds=new gd,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(s,u,p,v,m,_,P,O){for(const B in this.programConfigurations)this.programConfigurations[B].populatePaintArrays(s,u,v,m,_,P,O);u.id!==void 0?this._featureMap.add(u.id,p,this._bufferOffset,s):(this._featureMapWithoutIds.add(this._idlessCounter,p,this._bufferOffset,s),this._idlessCounter+=1),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,u,p,v,m,_,P){for(const O of p)this.needsUpload=this.programConfigurations[O.id].updatePaintArrays(s,this._featureMap,this._featureMapWithoutIds,u,O,v,m,_,P||0)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const Yy={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function wx(f,s){return Yy[f]||[f.replace(`${s}-`,"").replace(/-/g,"_")]}const Sx={"line-pattern":{source:us,composite:us},"fill-pattern":{source:us,composite:us},"fill-extrusion-pattern":{source:us,composite:us},"line-dasharray":{source:dg,composite:dg}},Rf={color:{source:vh,composite:_u},number:{source:Af,composite:vh}};function _g(f,s,u){const p=Sx[f];return p&&p[u]||Rf[s][u]}mr(yd,"ConstantBinder"),mr(xd,"PatternConstantBinder"),mr(qc,"SourceExpressionBinder"),mr(wu,"PatternCompositeBinder"),mr(Zl,"CompositeExpressionBinder"),mr(Su,"ProgramConfiguration",{omit:["_buffers"]}),mr(Nu,"ProgramConfigurationSet");const so=cr/Math.PI/2,vd=5,em=6,Nx=16383,wh=64,If=[wh,32,16],il=-so,So=so;function al(f,s,u,p=so){return u=dt(u),[f*Math.sin(u)*p,-s*p,f*Math.cos(u)*p]}function Sh(f,s,u){return al(Math.cos(dt(f)),Math.sin(dt(f)),s,u)}const _d=63710088e-1,tm=2*Math.PI*_d;class Kn{constructor(s,u){if(isNaN(s)||isNaN(u))throw new Error(`Invalid LngLat object: (${s}, ${u})`);if(this.lng=+s,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Kn(Ai(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const u=Math.PI/180,p=this.lat*u,v=s.lat*u,m=Math.sin(p)*Math.sin(v)+Math.cos(p)*Math.cos(v)*Math.cos((s.lng-this.lng)*u);return _d*Math.acos(Math.min(m,1))}toBounds(s=0){const u=360*s/40075017,p=u/Math.cos(Math.PI/180*this.lat);return new Au({lng:this.lng-p,lat:this.lat-u},{lng:this.lng+p,lat:this.lat+u})}toEcef(s){return Sh(this.lat,this.lng,so+s*so/_d)}static convert(s){if(s instanceof Kn)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new Kn(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new Kn(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Au{constructor(s,u){if(s)if(u)this.setSouthWest(s).setNorthEast(u);else if(s.length===4){const p=s;this.setSouthWest([p[0],p[1]]).setNorthEast([p[2],p[3]])}else{const p=s;this.setSouthWest(p[0]).setNorthEast(p[1])}}setNorthEast(s){return this._ne=s instanceof Kn?new Kn(s.lng,s.lat):Kn.convert(s),this}setSouthWest(s){return this._sw=s instanceof Kn?new Kn(s.lng,s.lat):Kn.convert(s),this}extend(s){const u=this._sw,p=this._ne;let v,m;if(s instanceof Kn)v=s,m=s;else{if(!(s instanceof Au))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(Au.convert(s)):this.extend(Kn.convert(s)):typeof s=="object"&&s!==null&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(Kn.convert(s)):this;if(v=s._sw,m=s._ne,!v||!m)return this}return u||p?(u.lng=Math.min(v.lng,u.lng),u.lat=Math.min(v.lat,u.lat),p.lng=Math.max(m.lng,p.lng),p.lat=Math.max(m.lat,p.lat)):(this._sw=new Kn(v.lng,v.lat),this._ne=new Kn(m.lng,m.lat)),this}getCenter(){return new Kn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Kn(this.getWest(),this.getNorth())}getSouthEast(){return new Kn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:u,lat:p}=Kn.convert(s);let v=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&v}static convert(s){if(s)return s instanceof Au?s:new Au(s)}}const rm=0,No=25.5;function bg(f){return tm*Math.cos(f*Math.PI/180)}function Gc(f){return(180+f)/360}function sl(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function Gi(f,s){return f/bg(s)}function ol(f){return 360*f-180}function Br(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}function Nh(f,s){return f*bg(Br(s))}const oo=85.051129;function wg(f){return Math.cos(dt(pr(f,-85.051129,oo)))}function Lf(f,s){const u=pr(s,rm,No),p=Math.pow(2,u);return wg(f)*tm/(512*p)}function g(f){return 1/Math.cos(f*Math.PI/180)}function l(f,s=0){const u=Math.exp(Math.PI*(1-(f.y+s/cr)/(1<<f.z)*2));return 80150034*u/(u*u+1)/cr/(1<<f.z)}class d{constructor(s,u,p=0){this.x=+s,this.y=+u,this.z=+p}static fromLngLat(s,u=0){const p=Kn.convert(s);return new d(Gc(p.lng),sl(p.lat),Gi(u,p.lat))}toLngLat(){return new Kn(ol(this.x),Br(this.y))}toAltitude(){return Nh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/tm*g(Br(this.y))}}function y(f,s,u,p,v,m,_,P,O){const B=(s+p)/2,k=(u+v)/2,R=new Rt(B,k);P(R),function(z,M,L,q,X,te){const le=L-X,ce=q-te;return Math.abs((q-M)*le-(L-z)*ce)/Math.hypot(le,ce)}(R.x,R.y,m.x,m.y,_.x,_.y)>=O?(y(f,s,u,B,k,m,R,P,O),y(f,B,k,p,v,R,_,P,O)):f.push(_)}function N(f,s,u){let p=f[0],v=p.x,m=p.y;s(p);const _=[p];for(let P=1;P<f.length;P++){const O=f[P],{x:B,y:k}=O;s(O),y(_,v,m,B,k,p,O,s,u),v=B,m=k,p=O}return _}function j(f,s,u,p){if(p(s,u)){const v=s.add(u)._mult(.5);j(f,s,v,p),j(f,v,u,p)}else f.push(u)}function C(f,s){let u=f[0];const p=[u];for(let v=1;v<f.length;v++){const m=f[v];j(p,u,m,s),u=m}return p}const F=Math.pow(2,14)-1,W=-F-1;function Z(f,s){const u=Math.round(f.x*s),p=Math.round(f.y*s);return f.x=pr(u,W,F),f.y=pr(p,W,F),(u<f.x||u>f.x+1||p<f.y||p>f.y+1)&&ln("Geometry exceeds allowed extent, reduce your vector tile buffer size"),f}function Y(f,s,u){const p=f.loadGeometry(),v=f.extent,m=cr/v;if(s&&u&&u.projection.isReprojectedInTileSpace){const _=1<<s.z,{scale:P,x:O,y:B,projection:k}=u,R=z=>{const M=ol((s.x+z.x/v)/_),L=Br((s.y+z.y/v)/_),q=k.project(M,L);z.x=(q.x*P-O)*v,z.y=(q.y*P-B)*v};for(let z=0;z<p.length;z++)if(f.type!==1)p[z]=N(p[z],R,1);else{const M=[];for(const L of p[z])L.x<0||L.x>=v||L.y<0||L.y>=v||(R(L),M.push(L));p[z]=M}}for(const _ of p)for(const P of _)Z(P,m);return p}function re(f,s){return{type:f.type,id:f.id,properties:f.properties,geometry:s?Y(f):[]}}function ne(f,s,u,p,v){f.emplaceBack(2*s+(p+1)/2,2*u+(v+1)/2)}function oe(f,s,u){f.emplaceBack(s.x,s.y,s.z,u[0]*16384,u[1]*16384,u[2]*16384)}class _e{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.fqid),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new Fo,this.indexArray=new bs,this.segments=new Na,this.programConfigurations=new Nu(s.layers,{zoom:s.zoom,lut:s.lut}),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}updateFootprints(s,u){}populate(s,u,p,v){const m=this.layers[0],_=[];let P=null;m.type==="circle"&&(P=m.layout.get("circle-sort-key"));for(const{feature:B,id:k,index:R,sourceLayerIndex:z}of s){const M=this.layers[0]._featureFilter.needGeometry,L=re(B,M);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),L,p))continue;const q=P?P.evaluate(L,{},p):void 0,X={id:k,properties:B.properties,type:B.type,sourceLayerIndex:z,index:R,geometry:M?L.geometry:Y(B,p,v),patterns:{},sortKey:q};_.push(X)}P&&_.sort((B,k)=>B.sortKey-k.sortKey);let O=null;v.projection.name==="globe"&&(this.globeExtVertexArray=new _s,O=v.projection);for(const B of _){const{geometry:k,index:R,sourceLayerIndex:z}=B,M=s[R].feature;this.addFeature(B,k,R,u.availableImages,p,O,u.brightness),u.featureIndex.insert(M,k,R,z,this.index)}}update(s,u,p,v,m,_,P){this.programConfigurations.updatePaintArrays(s,u,m,p,v,_,P)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,yg.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,X_.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(s,u,p,v,m,_,P){for(const O of u)for(const B of O){const k=B.x,R=B.y;if(k<0||k>=cr||R<0||R>=cr)continue;if(_){const L=_.projectTilePoint(k,R,m),q=_.upVector(m,k,R),X=this.globeExtVertexArray;oe(X,L,q),oe(X,L,q),oe(X,L,q),oe(X,L,q)}const z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),M=z.vertexLength;ne(this.layoutVertexArray,k,R,-1,-1),ne(this.layoutVertexArray,k,R,1,-1),ne(this.layoutVertexArray,k,R,1,1),ne(this.layoutVertexArray,k,R,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+2,M+3),z.vertexLength+=4,z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{},v,m,P)}}function ge(f,s){for(let u=0;u<f.length;u++)if(He(s,f[u]))return!0;for(let u=0;u<s.length;u++)if(He(f,s[u]))return!0;return!!qe(f,s)}function Te(f,s,u){return!!He(f,s)||!!Qe(s,f,u)}function Ae(f,s){if(f.length===1)return Ze(s,f[0]);for(let u=0;u<s.length;u++){const p=s[u];for(let v=0;v<p.length;v++)if(He(f,p[v]))return!0}for(let u=0;u<f.length;u++)if(Ze(s,f[u]))return!0;for(let u=0;u<s.length;u++)if(qe(f,s[u]))return!0;return!1}function Re(f,s,u){if(f.length>1){if(qe(f,s))return!0;for(let p=0;p<s.length;p++)if(Qe(s[p],f,u))return!0}for(let p=0;p<f.length;p++)if(Qe(f[p],s,u))return!0;return!1}function qe(f,s){if(f.length===0||s.length===0)return!1;for(let u=0;u<f.length-1;u++){const p=f[u],v=f[u+1];for(let m=0;m<s.length-1;m++)if(Ue(p,v,s[m],s[m+1]))return!0}return!1}function Ue(f,s,u,p){return os(f,u,p)!==os(s,u,p)&&os(f,s,u)!==os(f,s,p)}function Qe(f,s,u){const p=u*u;if(s.length===1)return f.distSqr(s[0])<p;for(let v=1;v<s.length;v++)if(Ke(f,s[v-1],s[v])<p)return!0;return!1}function Ke(f,s,u){const p=s.distSqr(u);if(p===0)return f.distSqr(s);const v=((f.x-s.x)*(u.x-s.x)+(f.y-s.y)*(u.y-s.y))/p;return f.distSqr(v<0?s:v>1?u:u.sub(s)._mult(v)._add(s))}function Ze(f,s){let u,p,v,m=!1;for(let _=0;_<f.length;_++){u=f[_];for(let P=0,O=u.length-1;P<u.length;O=P++)p=u[P],v=u[O],p.y>s.y!=v.y>s.y&&s.x<(v.x-p.x)*(s.y-p.y)/(v.y-p.y)+p.x&&(m=!m)}return m}function He(f,s){let u=!1;for(let p=0,v=f.length-1;p<f.length;v=p++){const m=f[p],_=f[v];m.y>s.y!=_.y>s.y&&s.x<(_.x-m.x)*(s.y-m.y)/(_.y-m.y)+m.x&&(u=!u)}return u}function Xe(f,s,u,p,v){for(const _ of f)if(s<=_.x&&u<=_.y&&p>=_.x&&v>=_.y)return!0;const m=[new Rt(s,u),new Rt(s,v),new Rt(p,v),new Rt(p,u)];if(f.length>2){for(const _ of m)if(He(f,_))return!0}for(let _=0;_<f.length-1;_++)if(at(f[_],f[_+1],m))return!0;return!1}function at(f,s,u){const p=u[0],v=u[2];if(f.x<p.x&&s.x<p.x||f.x>v.x&&s.x>v.x||f.y<p.y&&s.y<p.y||f.y>v.y&&s.y>v.y)return!1;const m=os(f,s,u[0]);return m!==os(f,s,u[1])||m!==os(f,s,u[2])||m!==os(f,s,u[3])}function _t(f,s,u,p,v,m){let _=s.y-f.y,P=f.x-s.x;if(m=m||0){const O=_*_+P*P;if(O===0)return!0;const B=Math.sqrt(O);_/=B,P/=B}return!((u.x-f.x)*_+(u.y-f.y)*P-m<0||(p.x-f.x)*_+(p.y-f.y)*P-m<0||(v.x-f.x)*_+(v.y-f.y)*P-m<0)}function mt(f,s,u,p,v,m,_){return!(_t(f,s,p,v,m,_)||_t(s,u,p,v,m,_)||_t(u,f,p,v,m,_)||_t(p,v,f,s,u,_)||_t(v,m,f,s,u,_)||_t(m,p,f,s,u,_))}function kt(f,s,u){const p=s.paint.get(f).value;return p.kind==="constant"?p.value:u.programConfigurations.get(s.id).getMaxValue(f)}function Pt(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function ht(f,s,u,p,v){if(!s[0]&&!s[1])return f;const m=Rt.convert(s)._mult(v);u==="viewport"&&m._rotate(-p);const _=[];for(let P=0;P<f.length;P++)_.push(f[P].sub(m));return _}function Tt(f,s,u,p){const v=Rt.convert(f)._mult(p);return s==="viewport"&&v._rotate(-u),v}let $t,pt;mr(_e,"CircleBucket",{omit:["layers"]});var Lt,jt={exports:{}},Xt=(Lt||(Lt=1,function(f,s){(function(u){function p(m,_,P){var O=v(256*m,256*(_=Math.pow(2,P)-_-1),P),B=v(256*(m+1),256*(_+1),P);return O[0]+","+O[1]+","+B[0]+","+B[1]}function v(m,_,P){var O=2*Math.PI*6378137/256/Math.pow(2,P);return[m*O-2*Math.PI*6378137/2,_*O-2*Math.PI*6378137/2]}u.getURL=function(m,_,P,O,B,k){return k=k||{},m+"?"+["bbox="+p(P,O,B),"format="+(k.format||"image/png"),"service="+(k.service||"WMS"),"version="+(k.version||"1.1.1"),"request="+(k.request||"GetMap"),"srs="+(k.srs||"EPSG:3857"),"width="+(k.width||256),"height="+(k.height||256),"layers="+_].join("&")},u.getTileBBox=p,u.getMercCoords=v,Object.defineProperty(u,"__esModule",{value:!0})})(s)}(0,jt.exports)),jt.exports);class Vt{constructor(s,u,p){this.z=s,this.x=u,this.y=p,this.key=tr(0,s,s,u,p)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,u){const p=Xt.getTileBBox(this.x,this.y,this.z),v=function(m,_,P){let O,B="";for(let k=m;k>0;k--)O=1<<k-1,B+=(_&O?1:0)+(P&O?2:0);return B}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",v).replace("{bbox-epsg-3857}",p)}toString(){return`${this.z}/${this.x}/${this.y}`}}class It{constructor(s,u){this.wrap=s,this.canonical=u,this.key=tr(s,u.z,u.z,u.x,u.y)}}class Ht{constructor(s,u,p,v,m){this.overscaledZ=s,this.wrap=u,this.canonical=new Vt(p,+v,+m),this.key=u===0&&s===p?this.canonical.key:tr(u,s,p,v,m)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const u=this.canonical.z-s;return s>this.canonical.z?new Ht(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ht(s,this.wrap,s,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(s,u=!0){if(this.overscaledZ===s&&u)return this.key;if(s>this.canonical.z)return tr(this.wrap*+u,s,this.canonical.z,this.canonical.x,this.canonical.y);{const p=this.canonical.z-s;return tr(this.wrap*+u,s,s,this.canonical.x>>p,this.canonical.y>>p)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const u=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.z<this.canonical.z&&s.canonical.x===this.canonical.x>>u&&s.canonical.y===this.canonical.y>>u}children(s){if(this.overscaledZ>=s)return[new Ht(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,p=2*this.canonical.x,v=2*this.canonical.y;return[new Ht(u,this.wrap,u,p,v),new Ht(u,this.wrap,u,p+1,v),new Ht(u,this.wrap,u,p,v+1),new Ht(u,this.wrap,u,p+1,v+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Ht(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Ht(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new It(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function tr(f,s,u,p,v){const m=1<<Math.min(u,22);let _=m*(v%m)+p%m;return f&&u<22&&(_+=m*m*((f<0?-2*f-1:2*f)%(1<<2*(22-u)))),16*(32*_+u)+(s-u)}const gr=[f=>{let s=f.canonical.x-1,u=f.wrap;return s<0&&(s=(1<<f.canonical.z)-1,u--),new Ht(f.overscaledZ,u,f.canonical.z,s,f.canonical.y)},f=>{let s=f.canonical.x+1,u=f.wrap;return s===1<<f.canonical.z&&(s=0,u++),new Ht(f.overscaledZ,u,f.canonical.z,s,f.canonical.y)},f=>new Ht(f.overscaledZ,f.wrap,f.canonical.z,f.canonical.x,(f.canonical.y===0?1<<f.canonical.z:f.canonical.y)-1),f=>new Ht(f.overscaledZ,f.wrap,f.canonical.z,f.canonical.x,f.canonical.y===(1<<f.canonical.z)-1?0:f.canonical.y+1)];mr(Vt,"CanonicalTileID"),mr(Ht,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const xr=Jn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:qr}=xr,Or=Jn([{name:"a_pos_3",components:3,type:"Int16"}]);var Lr=Jn([{name:"a_pos",type:"Int16",components:2}]);class Zr{constructor(s,u){this.pos=s,this.dir=u}intersectsPlane(s,u,p){const v=ze.vec3.dot(u,this.dir);if(Math.abs(v)<1e-6)return!1;const m=((s[0]-this.pos[0])*u[0]+(s[1]-this.pos[1])*u[1]+(s[2]-this.pos[2])*u[2])/v;return p[0]=this.pos[0]+this.dir[0]*m,p[1]=this.pos[1]+this.dir[1]*m,p[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(s,u,p){if(ze.vec3.equals(this.pos,s)||u===0)return p[0]=p[1]=p[2]=0,!1;const[v,m,_]=this.dir,P=this.pos[0]-s[0],O=this.pos[1]-s[1],B=this.pos[2]-s[2],k=v*v+m*m+_*_,R=2*(P*v+O*m+B*_),z=R*R-4*k*(P*P+O*O+B*B-u*u);if(z<0){const M=Math.max(-R/2,0),L=P+v*M,q=O+m*M,X=B+_*M,te=Math.hypot(L,q,X);return p[0]=L*u/te,p[1]=q*u/te,p[2]=X*u/te,!1}{const M=(-R-Math.sqrt(z))/(2*k);if(M<0){const L=Math.hypot(P,O,B);return p[0]=P*u/L,p[1]=O*u/L,p[2]=B*u/L,!1}return p[0]=P+v*M,p[1]=O+m*M,p[2]=B+_*M,!0}}}class Ln{constructor(s,u,p,v,m){this.TL=s,this.TR=u,this.BR=p,this.BL=v,this.horizon=m}static fromInvProjectionMatrix(s,u,p){const v=[-1,1,1],m=[1,1,1],_=[1,-1,1],P=[-1,-1,1],O=ze.vec3.transformMat4(v,v,s),B=ze.vec3.transformMat4(m,m,s),k=ze.vec3.transformMat4(_,_,s),R=ze.vec3.transformMat4(P,P,s);return new Ln(O,B,k,R,u/p)}}function ui(f,s,u){let p=1/0,v=-1/0;const m=[];for(const _ of f){ze.vec3.sub(m,_,s);const P=ze.vec3.dot(m,u);p=Math.min(p,P),v=Math.max(v,P)}return[p,v]}function Wi(f,s){let u=!0;for(let p=0;p<f.planes.length;p++){const v=f.planes[p];let m=0;for(let _=0;_<s.length;_++)m+=ze.vec3.dot(v,s[_])+v[3]>=0;if(m===0)return 0;m!==s.length&&(u=!1)}return u?2:1}function Zn(f,s){for(const u of f.projections){const p=ui(s,f.points[0],u.axis);if(u.projection[1]<p[0]||u.projection[0]>p[1])return 0}return 1}function Qr(f,s){let u=0;const p=[0,0,0,0];for(let v=0;v<f.length;v++)p[0]=f[v][0],p[1]=f[v][1],p[2]=f[v][2],p[3]=1,ze.vec4.dot(p,s)>=0&&u++;return u}class jn{constructor(s,u){this.points=s||new Array(8).fill([0,0,0]),this.planes=u||new Array(6).fill([0,0,0,0]),this.bounds=wr.fromPoints(this.points),this.projections=[],this.frustumEdges=[ze.vec3.sub([],this.points[2],this.points[3]),ze.vec3.sub([],this.points[0],this.points[3]),ze.vec3.sub([],this.points[4],this.points[0]),ze.vec3.sub([],this.points[5],this.points[1]),ze.vec3.sub([],this.points[6],this.points[2]),ze.vec3.sub([],this.points[7],this.points[3])];for(const p of this.frustumEdges){const v=[0,-p[2],p[1]],m=[p[2],0,-p[0]];this.projections.push({axis:v,projection:ui(this.points,this.points[0],v)}),this.projections.push({axis:m,projection:ui(this.points,this.points[0],m)})}}static fromInvProjectionMatrix(s,u,p,v){const m=Math.pow(2,p),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(B=>{const k=ze.vec4.transformMat4([],B,s),R=1/k[3]/u*m;return ze.vec4.mul(k,k,[R,R,v?1/k[3]:R,R])}),P=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(B=>{const k=ze.vec3.sub([],_[B[0]],_[B[1]]),R=ze.vec3.sub([],_[B[2]],_[B[1]]),z=ze.vec3.normalize([],ze.vec3.cross([],k,R)),M=-ze.vec3.dot(z,_[B[1]]);return z.concat(M)}),O=[];for(let B=0;B<_.length;B++)O.push([_[B][0],_[B][1],_[B][2]]);return new jn(O,P)}intersectsPrecise(s,u,p){for(let v=0;v<u.length;v++)if(!Qr(s,u[v]))return 0;for(let v=0;v<this.planes.length;v++)if(!Qr(s,this.planes[v]))return 0;for(const v of p)for(const m of this.frustumEdges){const _=ze.vec3.cross([],v,m),P=ze.vec3.length(_);if(P===0)continue;ze.vec3.scale(_,_,1/P);const O=ui(this.points,this.points[0],_),B=ui(s,this.points[0],_);if(O[0]>B[1]||B[0]>O[1])return 0}return 1}containsPoint(s){for(const u of this.planes){const p=u[3];if(ze.vec3.dot([u[0],u[1],u[2]],s)+p<0)return!1}return!0}}class wr{static fromPoints(s){const u=[1/0,1/0,1/0],p=[-1/0,-1/0,-1/0];for(const v of s)ze.vec3.min(u,u,v),ze.vec3.max(p,p,v);return new wr(u,p)}static fromTileIdAndHeight(s,u,p){const v=1<<s.canonical.z,m=s.canonical.x,_=s.canonical.y;return new wr([m/v,_/v,u],[(m+1)/v,(_+1)/v,p])}static applyTransform(s,u){const p=s.getCorners();for(let v=0;v<p.length;++v)ze.vec3.transformMat4(p[v],p[v],u);return wr.fromPoints(p)}static applyTransformFast(s,u){const p=[u[12],u[13],u[14]],v=[...p];for(let m=0;m<3;m++)for(let _=0;_<3;_++){const P=u[4*_+m],O=P*s.min[_],B=P*s.max[_];p[m]+=Math.min(O,B),v[m]+=Math.max(O,B)}return new wr(p,v)}static projectAabbCorners(s,u){const p=s.getCorners();for(let v=0;v<p.length;++v)ze.vec3.transformMat4(p[v],p[v],u);return p}constructor(s,u){this.min=s,this.max=u,this.center=ze.vec3.scale([],ze.vec3.add([],this.min,this.max),.5)}quadrant(s){const u=[s%2==0,s<2],p=ze.vec3.clone(this.min),v=ze.vec3.clone(this.max);for(let m=0;m<u.length;m++)p[m]=u[m]?this.min[m]:this.center[m],v[m]=u[m]?this.center[m]:this.max[m];return v[2]=this.max[2],new wr(p,v)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,u=this.max;return[[s[0],s[1],s[2]],[u[0],s[1],s[2]],[u[0],u[1],s[2]],[s[0],u[1],s[2]],[s[0],s[1],u[2]],[u[0],s[1],u[2]],[u[0],u[1],u[2]],[s[0],u[1],u[2]]]}intersects(s){return this.intersectsAabb(s.bounds)?Wi(s,this.getCorners()):0}intersectsFlat(s){return this.intersectsAabb(s.bounds)?Wi(s,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(s,u){return u||this.intersects(s)?Zn(s,this.getCorners()):0}intersectsPreciseFlat(s,u){return u||this.intersectsFlat(s)?Zn(s,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(s){for(let u=0;u<3;++u)if(this.min[u]>s.max[u]||s.min[u]>this.max[u])return!1;return!0}intersectsAabbXY(s){return!(this.min[0]>s.max[0]||s.min[0]>this.max[0]||this.min[1]>s.max[1]||s.min[1]>this.max[1])}encapsulate(s){for(let u=0;u<3;u++)this.min[u]=Math.min(this.min[u],s.min[u]),this.max[u]=Math.max(this.max[u],s.max[u])}encapsulatePoint(s){for(let u=0;u<3;u++)this.min[u]=Math.min(this.min[u],s[u]),this.max[u]=Math.max(this.max[u],s[u])}closestPoint(s){return[Math.max(Math.min(this.max[0],s[0]),this.min[0]),Math.max(Math.min(this.max[1],s[1]),this.min[1]),Math.max(Math.min(this.max[2],s[2]),this.min[2])]}}function In(f){return f*so/_d}mr(wr,"Aabb");const Qn=[new wr([il,il,il],[So,So,So]),new wr([il,il,il],[0,0,So]),new wr([0,il,il],[So,0,So]),new wr([il,0,il],[0,So,So]),new wr([0,0,il],[So,So,So])];function ai(f,s,u,p=!0){const v=ze.vec3.scale([],f._camera.position,f.worldSize),m=[s,u,1,1];ze.vec4.transformMat4(m,m,f.pixelMatrixInverse),ze.vec4.scale(m,m,1/m[3]);const _=ze.vec3.sub([],m,v),P=ze.vec3.normalize([],_),O=f.globeMatrix,B=[O[12],O[13],O[14]],k=ze.vec3.sub([],B,v),R=ze.vec3.length(k),z=ze.vec3.normalize([],k),M=f.worldSize/(2*Math.PI),L=ze.vec3.dot(z,P),q=Math.asin(M/R);if(q<Math.acos(L)){if(!p)return null;const et=[],Ve=[];ze.vec3.scale(et,P,R/L),ze.vec3.normalize(Ve,ze.vec3.sub(Ve,et,k)),ze.vec3.normalize(P,ze.vec3.add(P,k,ze.vec3.scale(P,Ve,Math.tan(q)*R)))}const X=[];new Zr(v,P).closestPointOnSphere(B,M,X);const te=ze.vec3.normalize([],Ea(O,0)),le=ze.vec3.normalize([],Ea(O,1)),ce=ze.vec3.normalize([],Ea(O,2)),ie=ze.vec3.dot(te,X),fe=ze.vec3.dot(le,X),xe=ze.vec3.dot(ce,X),je=Ot(Math.asin(-fe/M));let Fe=Ot(Math.atan2(ie,xe));Fe=f.center.lng+function(et,Ve){const rt=(Ve-et+180)%360-180;return rt<-180?rt+360:rt}(f.center.lng,Fe);const De=Gc(Fe),Ie=pr(sl(je),0,1);return new d(De,Ie)}class na{constructor(s,u,p){this.a=ze.vec3.sub([],s,p),this.b=ze.vec3.sub([],u,p),this.center=p;const v=ze.vec3.normalize([],this.a),m=ze.vec3.normalize([],this.b);this.angle=Math.acos(ze.vec3.dot(v,m))}}function ca(f,s){if(f.angle===0)return null;let u;return u=f.a[s]===0?1/f.angle*.5*Math.PI:1/f.angle*Math.atan(f.b[s]/f.a[s]/Math.sin(f.angle)-1/Math.tan(f.angle)),u<0||u>1?null:function(p,v,m,_){const P=Math.sin(m);return p*(Math.sin((1-_)*m)/P)+v*(Math.sin(_*m)/P)}(f.a[s],f.b[s],f.angle,pr(u,0,1))+f.center[s]}function La(f){if(f.z<=1)return Qn[f.z+2*f.y+f.x];const s=Ti(Ci(f));return wr.fromPoints(s)}function ka(f,s,u){return ze.vec3.scale(f,f,1-u),ze.vec3.scaleAndAdd(f,f,s,u)}function Ds(f,s,u){for(const p of f)ze.vec3.transformMat4(p,p,s),ze.vec3.scale(p,p,u)}function Fs(f,s,u,p){const v=s/f.worldSize,m=f.globeMatrix;if(u.z<=1){const De=La(u).getCorners();return Ds(De,m,v),wr.fromPoints(De)}const _=Ci(u,p),P=Ti(_,so+In(f._tileCoverLift));Ds(P,m,v);const O=Number.MAX_VALUE,B=[-O,-O,-O],k=[O,O,O];if(_.contains(f.center)){for(const et of P)ze.vec3.min(k,k,et),ze.vec3.max(B,B,et);B[2]=0;const De=f.point,Ie=[De.x*v,De.y*v,0];return ze.vec3.min(k,k,Ie),ze.vec3.max(B,B,Ie),new wr(k,B)}if(f._tileCoverLift>0){for(const De of P)ze.vec3.min(k,k,De),ze.vec3.max(B,B,De);return new wr(k,B)}const R=[m[12]*v,m[13]*v,m[14]*v],z=_.getCenter(),M=pr(f.center.lat,-85.051129,oo),L=pr(z.lat,-85.051129,oo),q=Gc(f.center.lng),X=sl(M);let te=q-Gc(z.lng);const le=X-sl(L);te>.5?te-=1:te<-.5&&(te+=1);let ce=0;if(Math.abs(te)>Math.abs(le))ce=te>=0?1:3;else{ce=le>=0?0:2;const De=[m[4]*v,m[5]*v,m[6]*v],Ie=-Math.sin(dt(le>=0?_.getSouth():_.getNorth()))*so;ze.vec3.scaleAndAdd(R,R,De,Ie)}const ie=P[ce],fe=P[(ce+1)%4],xe=new na(ie,fe,R),je=[ca(xe,0)||ie[0],ca(xe,1)||ie[1],ca(xe,2)||ie[2]],Fe=Bo(f.zoom);if(Fe>0){const De=function({x:et,y:Ve,z:rt},ot,it,ct,ft){const xt=1/(1<<rt);let ut=et*xt,Mt=ut+xt,qt=Ve*xt,Et=qt+xt,fr=0;const lr=(ut+Mt)/2-ct;return lr>.5?fr=-1:lr<-.5&&(fr=1),ut=((ut+fr)*ot-(ct*=ot))*it+ct,Mt=((Mt+fr)*ot-ct)*it+ct,qt=(qt*ot-(ft*=ot))*it+ft,Et=(Et*ot-ft)*it+ft,[[ut,Et,0],[Mt,Et,0],[Mt,qt,0],[ut,qt,0]]}(u,s,f._pixelsPerMercatorPixel,q,X);for(let et=0;et<P.length;et++)ka(P[et],De[et],Fe);const Ie=ze.vec3.add([],De[ce],De[(ce+1)%4]);ze.vec3.scale(Ie,Ie,.5),ka(je,Ie,Fe)}for(const De of P)ze.vec3.min(k,k,De),ze.vec3.max(B,B,De);return k[2]=Math.min(ie[2],fe[2]),ze.vec3.min(k,k,je),ze.vec3.max(B,B,je),new wr(k,B)}function Ci({x:f,y:s,z:u},p=!1){const v=1/(1<<u),m=new Kn(ol(f*v),s===(1<<u)-1&&p?-90:Br((s+1)*v)),_=new Kn(ol((f+1)*v),s===0&&p?90:Br(s*v));return new Au(m,_)}function Ti(f,s=so){const u=dt(f.getNorth()),p=dt(f.getSouth()),v=Math.cos(u),m=Math.cos(p),_=Math.sin(u),P=Math.sin(p),O=f.getWest(),B=f.getEast();return[al(m,P,O,s),al(m,P,B,s),al(v,_,B,s),al(v,_,O,s)]}function _i(f,s,u,p){const v=1<<u.z,m=(f/cr+u.x)/v;return Sh(Br((s/cr+u.y)/v),ol(m),p)}function Fn({min:f,max:s}){return Nx/Math.max(s[0]-f[0],s[1]-f[1],s[2]-f[2])}const ua=new Float64Array(16);function ds(f){const s=Fn(f),u=ze.mat4.fromScaling(ua,[s,s,s]);return ze.mat4.translate(u,u,ze.vec3.negate([],f.min))}function ji(f){const s=ze.mat4.fromTranslation(ua,f.min),u=1/Fn(f);return ze.mat4.scale(s,s,[u,u,u])}function Hs(f){const s=cr/(2*Math.PI);return f/(2*Math.PI)/s}function kl(f,s){return cr/(512*Math.pow(2,f))*Fn(La(s))}function ws(f,s,u,p,v){const m=Hs(u),_=[f,s,-u/(2*Math.PI)],P=ze.mat4.identity(new Float64Array(16));return ze.mat4.translate(P,P,_),ze.mat4.scale(P,P,[m,m,m]),ze.mat4.rotateX(P,P,dt(-v)),ze.mat4.rotateY(P,P,dt(-p)),P}function Bo(f){return Mn(vd,em,f)}function Vo(f,s){const u=Sh(s.lat,s.lng),p=function(m){const _=Sh(m._center.lat,m._center.lng),P=ze.vec3.fromValues(0,1,0);let O=ze.vec3.cross([],P,_);const B=ze.mat4.fromRotation([],-m.angle,_);O=ze.vec3.transformMat4(O,O,B),ze.mat4.fromRotation(B,-m._pitch,O);const k=ze.vec3.normalize([],_);return ze.vec3.scale(k,k,In(m.cameraToCenterDistance/m.pixelsPerMeter)),ze.vec3.transformMat4(k,k,B),ze.vec3.add([],_,k)}(f),v=ze.vec3.subtract([],p,u);return ze.vec3.angle(v,u)}function Pl(f,s){return Vo(f,s)>Math.PI/2*1.01}const Mi=dt(85),Ah=Math.cos(Mi),pc=Math.sin(Mi),Th=ze.mat4.create(),Df=f=>{const s=[];return f.paint.get("circle-pitch-alignment")==="map"&&s.push("PITCH_WITH_MAP"),f.paint.get("circle-pitch-scale")==="map"&&s.push("SCALE_WITH_MAP"),s};function nm(f,s,u,p,v,m,_,P,O){if(m&&f.queryGeometry.isAboveHorizon)return!1;m&&(O*=f.pixelToTileUnitsFactor);const B=f.tileID.canonical,k=u.projection.upVectorScale(B,u.center.lat,u.worldSize).metersToTile;for(const R of s)for(const z of R){const M=z.add(P),L=v&&u.elevation?u.elevation.exaggeration()*v.getElevationAt(M.x,M.y,!0):0,q=u.projection.projectTilePoint(M.x,M.y,B);if(L>0){const ce=u.projection.upVector(B,M.x,M.y);q.x+=ce[0]*k*L,q.y+=ce[1]*k*L,q.z+=ce[2]*k*L}const X=m?M:Sg(q.x,q.y,q.z,p),te=m?f.tilespaceRays.map(ce=>Q_(ce,L)):f.queryGeometry.screenGeometry,le=ze.vec4.transformMat4([],[q.x,q.y,q.z,1],p);if(!_&&m?O*=le[3]/u.cameraToCenterDistance:_&&!m&&(O*=u.cameraToCenterDistance/le[3]),m){const ce=Br((z.y/cr+B.y)/(1<<B.z));O/=u.projection.pixelsPerMeter(ce,1)/Gi(1,ce)}if(Te(te,X,O))return!0}return!1}function Sg(f,s,u,p){const v=ze.vec4.transformMat4([],[f,s,u,1],p);return new Rt(v[0]/v[3],v[1]/v[3])}const $2=ze.vec3.fromValues(0,0,0),Wc=ze.vec3.fromValues(0,0,1);function Q_(f,s){const u=ze.vec3.create();return $2[2]=s,f.intersectsPlane($2,Wc,u),new Rt(u[0],u[1])}class q2 extends _e{}let jh,Xy,Ff,Jy;function Ax(f,{width:s,height:u},p,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==s*u*p)throw new RangeError("mismatched image size")}else v=new Uint8Array(s*u*p);return f.width=s,f.height=u,f.data=v,f}function Tx(f,s,u){const{width:p,height:v}=s;p===f.width&&v===f.height||(eb(f,s,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,p),height:Math.min(f.height,v)},u,null),f.width=p,f.height=v,f.data=s.data)}function eb(f,s,u,p,v,m,_,P){if(v.width===0||v.height===0)return s;if(v.width>f.width||v.height>f.height||u.x>f.width-v.width||u.y>f.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>s.width||v.height>s.height||p.x>s.width-v.width||p.y>s.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const O=f.data,B=s.data,k=m===4&&P;for(let R=0;R<v.height;R++){const z=((u.y+R)*f.width+u.x)*m,M=((p.y+R)*s.width+p.x)*m;if(k)for(let L=0;L<v.width;L++){const q=z+L*m+3,X=M+L*m;B[X+0]=255,B[X+1]=255,B[X+2]=255,B[X+3]=O[q]}else if(_)for(let L=0;L<v.width;L++){const q=z+L*m,X=M+L*m,te=O[q+3],le=new Xn(O[q+0]/255*te,O[q+1]/255*te,O[q+2]/255*te,te).toRenderColor(_).toArray();B[X+0]=le[0],B[X+1]=le[1],B[X+2]=le[2],B[X+3]=le[3]}else for(let L=0;L<v.width*m;L++)B[M+L]=O[z+L]}return s}mr(q2,"HeatmapBucket",{omit:["layers"]});class bd{constructor(s,u){Ax(this,s,1,u)}resize(s){Tx(this,new bd(s),1)}clone(){return new bd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,u,p,v,m){eb(s,u,p,v,m,1,null)}}class Ks{constructor(s,u){Ax(this,s,4,u)}resize(s){Tx(this,new Ks(s),4)}replace(s,u){u?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new Ks({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,u,p,v,m,_,P){eb(s,u,p,v,m,4,_,P)}}class tb{constructor(s,u){this.width=s.width,this.height=s.height,this.data=u instanceof Uint8Array?new Float32Array(u.buffer):u}}function Ng(f){const s={},u=f.resolution||256,p=f.clips?f.clips.length:1,v=f.image||new Ks({width:u,height:p}),m=(_,P,O)=>{s[f.evaluationKey]=O;const B=f.expression.evaluate(s);B&&(v.data[_+P+0]=Math.floor(255*B.r/B.a),v.data[_+P+1]=Math.floor(255*B.g/B.a),v.data[_+P+2]=Math.floor(255*B.b/B.a),v.data[_+P+3]=Math.floor(255*B.a))};if(f.clips)for(let _=0,P=0;_<p;++_,P+=4*u)for(let O=0,B=0;O<u;O++,B+=4){const k=O/(u-1),{start:R,end:z}=f.clips[_];m(P,B,R*(1-k)+z*k)}else for(let _=0,P=0;_<u;_++,P+=4)m(0,P,_/(u-1));return v}mr(bd,"AlphaImage"),mr(Ks,"RGBAImage");const jx=Jn([{name:"a_pos",components:2,type:"Int16"}],4),{members:kx}=jx;function Ag(f,s,u=2){const p=s&&s.length,v=p?s[0]*u:f.length;let m=Px(f,0,v,u,!0);const _=[];if(!m||m.next===m.prev)return _;let P,O,B;if(p&&(m=function(k,R,z,M){const L=[];for(let q=0,X=R.length;q<X;q++){const te=Px(k,R[q]*M,q<X-1?R[q+1]*M:k.length,M,!1);te===te.next&&(te.steiner=!0),L.push(Qy(te))}L.sort(G2);for(let q=0;q<L.length;q++)z=$j(L[q],z);return z}(f,s,m,u)),f.length>80*u){P=1/0,O=1/0;let k=-1/0,R=-1/0;for(let z=u;z<v;z+=u){const M=f[z],L=f[z+1];M<P&&(P=M),L<O&&(O=L),M>k&&(k=M),L>R&&(R=L)}B=Math.max(k-P,R-O),B=B!==0?32767/B:0}return Tg(m,_,u,P,O,B,0),_}function Px(f,s,u,p,v){let m;if(v===function(_,P,O,B){let k=0;for(let R=P,z=O-B;R<O;R+=B)k+=(_[z]-_[R])*(_[R+1]+_[z+1]),z=R;return k}(f,s,u,p)>0)for(let _=s;_<u;_+=p)m=yt(_/p|0,f[_],f[_+1],m);else for(let _=u-p;_>=s;_-=p)m=yt(_/p|0,f[_],f[_+1],m);return m&&A(m,m.next)&&(At(m),m=m.next),m}function im(f,s){if(!f)return f;s||(s=f);let u,p=f;do if(u=!1,p.steiner||!A(p,p.next)&&b(p.prev,p,p.next)!==0)p=p.next;else{if(At(p),p=s=p.prev,p===p.next)break;u=!0}while(u||p!==s);return s}function Tg(f,s,u,p,v,m,_){if(!f)return;!_&&m&&function(O,B,k,R){let z=O;do z.z===0&&(z.z=ib(z.x,z.y,B,k,R)),z.prevZ=z.prev,z.nextZ=z.next,z=z.next;while(z!==O);z.prevZ.nextZ=null,z.prevZ=null,function(M){let L,q=1;do{let X,te=M;M=null;let le=null;for(L=0;te;){L++;let ce=te,ie=0;for(let xe=0;xe<q&&(ie++,ce=ce.nextZ,ce);xe++);let fe=q;for(;ie>0||fe>0&&ce;)ie!==0&&(fe===0||!ce||te.z<=ce.z)?(X=te,te=te.nextZ,ie--):(X=ce,ce=ce.nextZ,fe--),le?le.nextZ=X:M=X,X.prevZ=le,le=X;te=ce}le.nextZ=null,q*=2}while(L>1)}(z)}(f,p,v,m);let P=f;for(;f.prev!==f.next;){const O=f.prev,B=f.next;if(m?Cx(f,p,v,m):rb(f))s.push(O.i,f.i,B.i),At(f),f=B.next,P=B.next;else if((f=B)===P){_?_===1?Tg(f=nb(im(f),s),s,u,p,v,m,2):_===2&&Ex(f,s,u,p,v,m):Tg(im(f),s,u,p,v,m,1);break}}}function rb(f){const s=f.prev,u=f,p=f.next;if(b(s,u,p)>=0)return!1;const v=s.x,m=u.x,_=p.x,P=s.y,O=u.y,B=p.y,k=v<m?v<_?v:_:m<_?m:_,R=P<O?P<B?P:B:O<B?O:B,z=v>m?v>_?v:_:m>_?m:_,M=P>O?P>B?P:B:O>B?O:B;let L=p.next;for(;L!==s;){if(L.x>=k&&L.x<=z&&L.y>=R&&L.y<=M&&jg(v,P,m,O,_,B,L.x,L.y)&&b(L.prev,L,L.next)>=0)return!1;L=L.next}return!0}function Cx(f,s,u,p){const v=f.prev,m=f,_=f.next;if(b(v,m,_)>=0)return!1;const P=v.x,O=m.x,B=_.x,k=v.y,R=m.y,z=_.y,M=P<O?P<B?P:B:O<B?O:B,L=k<R?k<z?k:z:R<z?R:z,q=P>O?P>B?P:B:O>B?O:B,X=k>R?k>z?k:z:R>z?R:z,te=ib(M,L,s,u,p),le=ib(q,X,s,u,p);let ce=f.prevZ,ie=f.nextZ;for(;ce&&ce.z>=te&&ie&&ie.z<=le;){if(ce.x>=M&&ce.x<=q&&ce.y>=L&&ce.y<=X&&ce!==v&&ce!==_&&jg(P,k,O,R,B,z,ce.x,ce.y)&&b(ce.prev,ce,ce.next)>=0||(ce=ce.prevZ,ie.x>=M&&ie.x<=q&&ie.y>=L&&ie.y<=X&&ie!==v&&ie!==_&&jg(P,k,O,R,B,z,ie.x,ie.y)&&b(ie.prev,ie,ie.next)>=0))return!1;ie=ie.nextZ}for(;ce&&ce.z>=te;){if(ce.x>=M&&ce.x<=q&&ce.y>=L&&ce.y<=X&&ce!==v&&ce!==_&&jg(P,k,O,R,B,z,ce.x,ce.y)&&b(ce.prev,ce,ce.next)>=0)return!1;ce=ce.prevZ}for(;ie&&ie.z<=le;){if(ie.x>=M&&ie.x<=q&&ie.y>=L&&ie.y<=X&&ie!==v&&ie!==_&&jg(P,k,O,R,B,z,ie.x,ie.y)&&b(ie.prev,ie,ie.next)>=0)return!1;ie=ie.nextZ}return!0}function nb(f,s){let u=f;do{const p=u.prev,v=u.next.next;!A(p,v)&&$(p,u,u.next,v)&&ye(p,v)&&ye(v,p)&&(s.push(p.i,u.i,v.i),At(u),At(u.next),u=f=v),u=u.next}while(u!==f);return im(u)}function Ex(f,s,u,p,v,m){let _=f;do{let P=_.next.next;for(;P!==_.prev;){if(_.i!==P.i&&Ox(_,P)){let O=$e(_,P);return _=im(_,_.next),O=im(O,O.next),Tg(_,s,u,p,v,m,0),void Tg(O,s,u,p,v,m,0)}P=P.next}_=_.next}while(_!==f)}function G2(f,s){return f.x-s.x}function $j(f,s){const u=function(v,m){let _=m;const P=v.x,O=v.y;let B,k=-1/0;do{if(O<=_.y&&O>=_.next.y&&_.next.y!==_.y){const q=_.x+(O-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(q<=P&&q>k&&(k=q,B=_.x<_.next.x?_:_.next,q===P))return B}_=_.next}while(_!==m);if(!B)return null;const R=B,z=B.x,M=B.y;let L=1/0;_=B;do{if(P>=_.x&&_.x>=z&&P!==_.x&&jg(O<M?P:k,O,z,M,O<M?k:P,O,_.x,_.y)){const q=Math.abs(O-_.y)/(P-_.x);ye(_,v)&&(q<L||q===L&&(_.x>B.x||_.x===B.x&&Mx(B,_)))&&(B=_,L=q)}_=_.next}while(_!==R);return B}(f,s);if(!u)return s;const p=$e(u,f);return im(p,p.next),im(u,u.next)}function Mx(f,s){return b(f.prev,f,s.prev)<0&&b(s.next,f,f.next)<0}function ib(f,s,u,p,v){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-u)*v|0)|f<<8))|f<<4))|f<<2))|f<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-p)*v|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function Qy(f){let s=f,u=f;do(s.x<u.x||s.x===u.x&&s.y<u.y)&&(u=s),s=s.next;while(s!==f);return u}function jg(f,s,u,p,v,m,_,P){return(v-_)*(s-P)>=(f-_)*(m-P)&&(f-_)*(p-P)>=(u-_)*(s-P)&&(u-_)*(m-P)>=(v-_)*(p-P)}function Ox(f,s){return f.next.i!==s.i&&f.prev.i!==s.i&&!function(u,p){let v=u;do{if(v.i!==u.i&&v.next.i!==u.i&&v.i!==p.i&&v.next.i!==p.i&&$(v,v.next,u,p))return!0;v=v.next}while(v!==u);return!1}(f,s)&&(ye(f,s)&&ye(s,f)&&function(u,p){let v=u,m=!1;const _=(u.x+p.x)/2,P=(u.y+p.y)/2;do v.y>P!=v.next.y>P&&v.next.y!==v.y&&_<(v.next.x-v.x)*(P-v.y)/(v.next.y-v.y)+v.x&&(m=!m),v=v.next;while(v!==u);return m}(f,s)&&(b(f.prev,f,s.prev)||b(f,s.prev,s))||A(f,s)&&b(f.prev,f,f.next)>0&&b(s.prev,s,s.next)>0)}function b(f,s,u){return(s.y-f.y)*(u.x-s.x)-(s.x-f.x)*(u.y-s.y)}function A(f,s){return f.x===s.x&&f.y===s.y}function $(f,s,u,p){const v=de(b(f,s,u)),m=de(b(f,s,p)),_=de(b(u,p,f)),P=de(b(u,p,s));return v!==m&&_!==P||!(v!==0||!J(f,u,s))||!(m!==0||!J(f,p,s))||!(_!==0||!J(u,f,p))||!(P!==0||!J(u,s,p))}function J(f,s,u){return s.x<=Math.max(f.x,u.x)&&s.x>=Math.min(f.x,u.x)&&s.y<=Math.max(f.y,u.y)&&s.y>=Math.min(f.y,u.y)}function de(f){return f>0?1:f<0?-1:0}function ye(f,s){return b(f.prev,f,f.next)<0?b(f,s,f.next)>=0&&b(f,f.prev,s)>=0:b(f,s,f.prev)<0||b(f,f.next,s)<0}function $e(f,s){const u=Yt(f.i,f.x,f.y),p=Yt(s.i,s.x,s.y),v=f.next,m=s.prev;return f.next=s,s.prev=f,u.next=v,v.prev=u,p.next=u,u.prev=p,m.next=p,p.prev=m,p}function yt(f,s,u,p){const v=Yt(f,s,u);return p?(v.next=p.next,v.prev=p,p.next.prev=v,p.next=v):(v.prev=v,v.next=v),v}function At(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function Yt(f,s,u){return{i:f,x:s,y:u,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Tr(f,s){const u=f.length;if(u<=1)return[f];const p=[];let v,m;for(let _=0;_<u;_++){const P=qu(f[_]);P!==0&&(f[_].area=Math.abs(P),m===void 0&&(m=P<0),m===P<0?(v&&p.push(v),v=[f[_]]):v.push(f[_]))}if(v&&p.push(v),s>1)for(let _=0;_<p.length;_++)p[_].length<=s||(Np(p[_],s,1,p[_].length-1,Mr),p[_]=p[_].slice(0,s));return p}function Mr(f,s){return s.area-f.area}function jr(f,s,u=1){if(!f)return null;const p=typeof f=="string"?f:f.getPrimary().id;s[p]||(s[p]=[]);const v=Rs.from(p).getPrimary().scaleSelf(u);return s[p].push(v),v.serialize()}function tn(f,s,u,p){const v=p.patternDependencies;let m=!1;for(const _ of s){const P=_.paint.get(`${f}-pattern`);P.isConstant()||(m=!0),jr(P.constantOr(null),v,u)&&(m=!0)}return m}function hn(f,s,u,p,v,m){const _=m.patternDependencies;for(const P of s){const O=P.paint.get(`${f}-pattern`).value;if(O.kind!=="constant"){let B=O.evaluate({zoom:p},u,{},m.availableImages);B=B&&B.name?B.name:B;const k=jr(B,_,v);k&&(u.patterns[P.id]=k)}}return u}class gn{constructor(s){this.zoom=s.zoom,this.pixelRatio=s.pixelRatio,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.fqid),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Fo,this.indexArray=new bs,this.indexArray2=new Ls,this.programConfigurations=new Nu(s.layers,{zoom:s.zoom,lut:s.lut}),this.segments=new Na,this.segments2=new Na,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.projection=s.projection}updateFootprints(s,u){}populate(s,u,p,v){this.hasPattern=tn("fill",this.layers,this.pixelRatio,u);const m=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:P,id:O,index:B,sourceLayerIndex:k}of s){const R=this.layers[0]._featureFilter.needGeometry,z=re(P,R);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),z,p))continue;const M=m?m.evaluate(z,{},p,u.availableImages):void 0,L={id:O,properties:P.properties,type:P.type,sourceLayerIndex:k,index:B,geometry:R?z.geometry:Y(P,p,v),patterns:{},sortKey:M};_.push(L)}m&&_.sort((P,O)=>P.sortKey-O.sortKey);for(const P of _){const{geometry:O,index:B,sourceLayerIndex:k}=P;if(this.hasPattern){const R=hn("fill",this.layers,P,this.zoom,this.pixelRatio,u);this.patternFeatures.push(R)}else this.addFeature(P,O,B,p,{},u.availableImages,u.brightness,u.elevationFeatures);u.featureIndex.insert(s[B].feature,O,B,k,this.index)}}update(s,u,p,v,m,_,P){this.programConfigurations.updatePaintArrays(s,u,m,p,v,_,P)}addFeatures(s,u,p,v,m,_){for(const P of this.patternFeatures)this.addFeature(P,P.geometry,P.index,u,p,v,_,s.elevationFeatures)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,kx),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,u,p,v,m,_=[],P,O){for(const B of Tr(u,500)){let k=0;for(const X of B)k+=X.length;const R=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),z=R.vertexLength,M=[],L=[];for(const X of B){if(X.length===0)continue;X!==B[0]&&L.push(M.length/2);const te=this.segments2.prepareSegment(X.length,this.layoutVertexArray,this.indexArray2),le=te.vertexLength;this.layoutVertexArray.emplaceBack(X[0].x,X[0].y),this.indexArray2.emplaceBack(le+X.length-1,le),M.push(X[0].x),M.push(X[0].y);for(let ce=1;ce<X.length;ce++)this.layoutVertexArray.emplaceBack(X[ce].x,X[ce].y),this.indexArray2.emplaceBack(le+ce-1,le+ce),M.push(X[ce].x),M.push(X[ce].y);te.vertexLength+=X.length,te.primitiveLength+=X.length}const q=Ag(M,L);for(let X=0;X<q.length;X+=3)this.indexArray.emplaceBack(z+q[X],z+q[X+1],z+q[X+2]);R.vertexLength+=k,R.primitiveLength+=q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,m,_,v,P)}}let Ss,Ut,Ct,Wt;mr(gn,"FillBucket",{omit:["layers","patternFeatures"]});class Ir{constructor(s,u,p,v){if(this.triangleCount=u.length/3,this.min=new Rt(0,0),this.max=new Rt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||s.length===0)return;const[m,_]=[s[0].clone(),s[0].clone()];for(let R=1;R<s.length;++R){const z=s[R];m.x=Math.min(m.x,z.x),m.y=Math.min(m.y,z.y),_.x=Math.max(_.x,z.x),_.y=Math.max(_.y,z.y)}if(v){const R=Math.ceil(Math.max(_.x-m.x,_.y-m.y)/v);p=Math.max(p,R)}if(p===0)return;this.min=m,this.max=_;const P=this.max.sub(this.min);P.x=Math.max(P.x,1),P.y=Math.max(P.y,1);const O=Math.max(P.x,P.y)/p;this.cellsX=Math.max(1,Math.ceil(P.x/O)),this.cellsY=Math.max(1,Math.ceil(P.y/O)),this.xScale=1/O,this.yScale=1/O;const B=[];for(let R=0;R<this.triangleCount;R++){const z=s[u[3*R+0]].sub(this.min),M=s[u[3*R+1]].sub(this.min),L=s[u[3*R+2]].sub(this.min),q=sn(Math.floor(Math.min(z.x,M.x,L.x)),this.xScale,this.cellsX),X=sn(Math.floor(Math.max(z.x,M.x,L.x)),this.xScale,this.cellsX),te=sn(Math.floor(Math.min(z.y,M.y,L.y)),this.yScale,this.cellsY),le=sn(Math.floor(Math.max(z.y,M.y,L.y)),this.yScale,this.cellsY),ce=new Rt(0,0),ie=new Rt(0,0),fe=new Rt(0,0),xe=new Rt(0,0);for(let je=te;je<=le;++je){ce.y=ie.y=je*O,fe.y=xe.y=(je+1)*O;for(let Fe=q;Fe<=X;++Fe)ce.x=fe.x=Fe*O,ie.x=xe.x=(Fe+1)*O,(mt(z,M,L,ce,ie,xe)||mt(z,M,L,ce,xe,fe))&&B.push({cellIdx:je*this.cellsX+Fe,triIdx:R})}}if(B.length===0)return;B.sort((R,z)=>R.cellIdx-z.cellIdx||R.triIdx-z.triIdx);let k=0;for(;k<B.length;){const R=B[k].cellIdx,z={start:this.payload.length,len:0};for(;k<B.length&&B[k].cellIdx===R;)++z.len,this.payload.push(B[k++].triIdx);this.cells[R]=z}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(s,u){if(this.triangleCount===0||this.cells.length===0||s.x>this.max.x||this.min.x>s.x||s.y>this.max.y||this.min.y>s.y)return;const p=sn(s.x-this.min.x,this.xScale,this.cellsX),v=sn(s.y-this.min.y,this.yScale,this.cellsY),m=this.cells[v*this.cellsX+p];if(m){this._lazyInitLookup();for(let _=0;_<m.len;_++){const P=this.payload[m.start+_],O=Math.floor(P/8),B=1<<P%8;if(!(this.lookup[O]&B)&&(this.lookup[O]|=B,u.push(P),u.length===this.triangleCount))return}}}query(s,u,p){if(this.triangleCount===0||this.cells.length===0||s.x>this.max.x||this.min.x>u.x||s.y>this.max.y||this.min.y>u.y)return;this._lazyInitLookup();const v=sn(s.x-this.min.x,this.xScale,this.cellsX),m=sn(u.x-this.min.x,this.xScale,this.cellsX),_=sn(s.y-this.min.y,this.yScale,this.cellsY),P=sn(u.y-this.min.y,this.yScale,this.cellsY);for(let O=_;O<=P;O++)for(let B=v;B<=m;B++){const k=this.cells[O*this.cellsX+B];if(k)for(let R=0;R<k.len;R++){const z=this.payload[k.start+R],M=Math.floor(z/8),L=1<<z%8;if(!(this.lookup[M]&L)&&(this.lookup[M]|=L,p.push(z),p.length===this.triangleCount))return}}}}function sn(f,s,u){return Math.max(0,Math.min(u-1,Math.floor(f*s)))}mr(Ir,"TriangleGridIndex");class zn{constructor(s){this.zoom=s.zoom,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.fqid),this.index=s.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.footprints=[]}updateFootprints(s,u){for(const p of this.footprints)u.push({footprint:p,id:s})}populate(s,u,p,v){const m=[];for(const{feature:_,id:P,index:O,sourceLayerIndex:B}of s){const k=this.layers[0]._featureFilter.needGeometry,R=re(_,k);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),R,p))continue;const z={id:P,properties:_.properties,type:_.type,sourceLayerIndex:B,index:O,geometry:k?R.geometry:Y(_,p,v),patterns:{}};m.push(z)}for(const _ of m){const{geometry:P,index:O,sourceLayerIndex:B}=_;this.addFeature(_,P,O,p,{},u.availableImages,u.brightness),u.featureIndex.insert(s[O].feature,P,O,B,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(s){}update(s,u,p,v,m,_,P){}destroy(){}addFeature(s,u,p,v,m,_=[],P){for(const O of Tr(u,2)){const B=[],k=[],R=[],z=new Rt(1/0,1/0),M=new Rt(-1/0,-1/0);for(const X of O)if(X.length!==0){X!==O[0]&&R.push(k.length/2);for(let te=0;te<X.length;te++)k.push(X[te].x),k.push(X[te].y),B.push(X[te]),z.x=Math.min(z.x,X[te].x),z.y=Math.min(z.y,X[te].y),M.x=Math.max(M.x,X[te].x),M.y=Math.max(M.y,X[te].y)}const L=Ag(k,R),q=new Ir(B,L,8,256);this.footprints.push({vertices:B,indices:L,grid:q,min:z,max:M})}}}mr(zn,"ClipBucket",{omit:["layers"]});const Un=Jn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),si=Jn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Ao=Jn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Ji=Jn([{name:"a_join_normal_inside",components:3,type:"Int16"}]),zf=Jn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),qj=Jn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Zie}=Un;var Gj,w5,Wj,S5,Hj,N5,A5,W2={};function T5(){if(w5)return Gj;w5=1;var f=on();function s(v,m,_,P,O){this.properties={},this.extent=_,this.type=0,this._pbf=v,this._geometry=-1,this._keys=P,this._values=O,v.readFields(u,this,m)}function u(v,m,_){v==1?m.id=_.readVarint():v==2?function(P,O){for(var B=P.readVarint()+P.pos;P.pos<B;){var k=O._keys[P.readVarint()],R=O._values[P.readVarint()];O.properties[k]=R}}(_,m):v==3?m.type=_.readVarint():v==4&&(m._geometry=_.pos)}function p(v){for(var m,_,P=0,O=0,B=v.length,k=B-1;O<B;k=O++)P+=((_=v[k]).x-(m=v[O]).x)*(m.y+_.y);return P}return Gj=s,s.types=["Unknown","Point","LineString","Polygon"],s.prototype.loadGeometry=function(){var v=this._pbf;v.pos=this._geometry;for(var m,_=v.readVarint()+v.pos,P=1,O=0,B=0,k=0,R=[];v.pos<_;){if(O<=0){var z=v.readVarint();P=7&z,O=z>>3}if(O--,P===1||P===2)B+=v.readSVarint(),k+=v.readSVarint(),P===1&&(m&&R.push(m),m=[]),m.push(new f(B,k));else{if(P!==7)throw new Error("unknown command "+P);m&&m.push(m[0].clone())}}return m&&R.push(m),R},s.prototype.bbox=function(){var v=this._pbf;v.pos=this._geometry;for(var m=v.readVarint()+v.pos,_=1,P=0,O=0,B=0,k=1/0,R=-1/0,z=1/0,M=-1/0;v.pos<m;){if(P<=0){var L=v.readVarint();_=7&L,P=L>>3}if(P--,_===1||_===2)(O+=v.readSVarint())<k&&(k=O),O>R&&(R=O),(B+=v.readSVarint())<z&&(z=B),B>M&&(M=B);else if(_!==7)throw new Error("unknown command "+_)}return[k,z,R,M]},s.prototype.toGeoJSON=function(v,m,_){var P,O,B=this.extent*Math.pow(2,_),k=this.extent*v,R=this.extent*m,z=this.loadGeometry(),M=s.types[this.type];function L(te){for(var le=0;le<te.length;le++){var ce=te[le];te[le]=[360*(ce.x+k)/B-180,360/Math.PI*Math.atan(Math.exp((180-360*(ce.y+R)/B)*Math.PI/180))-90]}}switch(this.type){case 1:var q=[];for(P=0;P<z.length;P++)q[P]=z[P][0];L(z=q);break;case 2:for(P=0;P<z.length;P++)L(z[P]);break;case 3:for(z=function(te){var le=te.length;if(le<=1)return[te];for(var ce,ie,fe=[],xe=0;xe<le;xe++){var je=p(te[xe]);je!==0&&(ie===void 0&&(ie=je<0),ie===je<0?(ce&&fe.push(ce),ce=[te[xe]]):ce.push(te[xe]))}return ce&&fe.push(ce),fe}(z),P=0;P<z.length;P++)for(O=0;O<z[P].length;O++)L(z[P][O])}z.length===1?z=z[0]:M="Multi"+M;var X={type:"Feature",geometry:{type:M,coordinates:z},properties:this.properties};return"id"in this&&(X.id=this.id),X},Gj}function j5(){if(S5)return Wj;S5=1;var f=T5();function s(p,v){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=p,this._keys=[],this._values=[],this._features=[],p.readFields(u,this,v),this.length=this._features.length}function u(p,v,m){p===15?v.version=m.readVarint():p===1?v.name=m.readString():p===5?v.extent=m.readVarint():p===2?v._features.push(m.pos):p===3?v._keys.push(m.readString()):p===4&&v._values.push(function(_){for(var P=null,O=_.readVarint()+_.pos;_.pos<O;){var B=_.readVarint()>>3;P=B===1?_.readString():B===2?_.readFloat():B===3?_.readDouble():B===4?_.readVarint64():B===5?_.readVarint():B===6?_.readSVarint():B===7?_.readBoolean():null}return P}(m))}return Wj=s,s.prototype.feature=function(p){if(p<0||p>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[p];var v=this._pbf.readVarint()+this._pbf.pos;return new f(this._pbf,v,this.extent,this._keys,this._values)},Wj}function k5(){return A5||(A5=1,W2.VectorTile=function(){if(N5)return Hj;N5=1;var f=j5();function s(u,p,v){if(u===3){var m=new f(v,v.readVarint()+v.pos);m.length&&(p[m.name]=m)}}return Hj=function(u,p){this.layers=u.readFields(s,{},p)},Hj}(),W2.VectorTileFeature=T5(),W2.VectorTileLayer=j5()),W2}var Rx=k5();class e0 extends Rt{constructor(s,u,p){super(s,u),this.z=p}}class P5 extends e0{constructor(s,u,p,v){super(s,u,p),this.w=v}}function H2(f,s,u,p){const v=[],m=p===0?(_,P,O,B,k,R)=>{_.push(new Rt(R,O+(R-P)/(B-P)*(k-O)))}:(_,P,O,B,k,R)=>{_.push(new Rt(P+(R-O)/(k-O)*(B-P),R))};for(const _ of f){const P=[];for(const O of _){if(O.length<=2)continue;const B=[];for(let z=0;z<O.length-1;z++){const M=O[z].x,L=O[z].y,q=O[z+1].x,X=O[z+1].y,te=p===0?M:L,le=p===0?q:X;te<s?le>s&&m(B,M,L,q,X,s):te>u?le<u&&m(B,M,L,q,X,u):B.push(O[z]),le<s&&te>=s&&m(B,M,L,q,X,s),le>u&&te<=u&&m(B,M,L,q,X,u)}let k=O[O.length-1];const R=p===0?k.x:k.y;R>=s&&R<=u&&B.push(k),B.length&&(k=B[B.length-1],B[0].x===k.x&&B[0].y===k.y||B.push(B[0]),P.push(B))}P.length&&v.push(P)}return v}function C5(f,s,u,p){const v=u==="x"?"y":"x",m=(p-f[u])/(s[u]-f[u]);f[v]=f[v]+(s[v]-f[v])*m,f[u]=p,f.hasOwnProperty("z")&&(f.z=Fr(f.z,s.z,m)),f.hasOwnProperty("w")&&(f.w=Fr(f.w,s.w,m))}function E5(f,s,u,p){const v=u,m=p;for(const _ of["x","y"]){let P=f,O=s;P[_]>=O[_]&&(P=s,O=f),P[_]<v&&O[_]>v&&C5(P,O,_,v),P[_]<m&&O[_]>m&&C5(O,P,_,m)}}const K2=Number.MAX_SAFE_INTEGER;function M5(f,s,u,p){return f.order<s||f.order===K2||!(f.clipMask&u)||function(v,m){return m.length!==0&&m.find(_=>_===v)===void 0}(p,f.clipScope)}function Z2(f,s){return f.x-s.x||f.y-s.y}function O5(f,s){return Z2(f.min,s.min)===0&&Z2(f.max,s.max)===0}function Kj(f,s){return!(f.min.x>s.max.x||f.max.x<s.min.x||f.min.y>s.max.y||f.max.y<s.min.y)}function Zj(f,s){if(f.length!==s.length)return!1;for(let u=0;u<f.length;u++)if(f[u].sourceId!==s[u].sourceId||!O5(f[u],s[u])||f[u].order!==s[u].order||f[u].clipMask!==s[u].clipMask||!En(f[u].clipScope,s[u].clipScope))return!1;return!0}function R5(f,s,u){const p=1/cr,v=1/(1<<u.canonical.z),m=(s.x*p+u.canonical.x)*v+u.wrap,_=(s.y*p+u.canonical.y)*v;return{min:new Rt((f.x*p+u.canonical.x)*v+u.wrap,(f.y*p+u.canonical.y)*v),max:new Rt(m,_)}}function Yie(f,s,u){const p=1<<u.canonical.z,v=((s.x-u.wrap)*p-u.canonical.x)*cr,m=(s.y*p-u.canonical.y)*cr;return{min:new Rt(((f.x-u.wrap)*p-u.canonical.x)*cr,(f.y*p-u.canonical.y)*cr),max:new Rt(v,m)}}function I5(f,s,u,p,v,m,_){const P=f.indices,O=f.vertices,B=[];for(let k=p;k<p+v;k+=3){const R=s[u[k+0]+m],z=s[u[k+1]+m],M=s[u[k+2]+m],L=Math.min(R.x,z.x,M.x),q=Math.max(R.x,z.x,M.x),X=Math.min(R.y,z.y,M.y),te=Math.max(R.y,z.y,M.y);B.length=0,f.grid.query(new Rt(L,X),new Rt(q,te),B);for(let le=0;le<B.length;le++){const ce=B[le];if(mt(O[P[3*ce+0]],O[P[3*ce+1]],O[P[3*ce+2]],R,z,M,_))return!0}}return!1}function L5(f,s,u,p){if(!f||!u)return!1;let v=f.vertices;if(!s.canonical.equals(p.canonical)||s.wrap!==p.wrap){if(u.vertices.length<f.vertices.length)return L5(u,p,f,s);const m=s.canonical,_=p.canonical,P=Math.pow(2,_.z-m.z);v=f.vertices.map(O=>new Rt((O.x+m.x*cr)*P-_.x*cr,(O.y+m.y*cr)*P-_.y*cr))}return I5(u,v,f.indices,0,f.indices.length,0,0)}function D5(f,s,u,p){const v=Math.pow(2,p.z-u.z);return new Rt((f+u.x*cr)*v-p.x*cr,(s+u.y*cr)*v-p.y*cr)}function F5(f,s){const u=[];s.grid.queryPoint(f,u);const p=s.indices,v=s.vertices;for(let m=0;m<u.length;m++){const _=u[m];if(He([v[p[3*_+0]],v[p[3*_+1]],v[p[3*_+2]]],f))return!0}return!1}const Yj=[new Rt(0,0),new Rt(cr,0),new Rt(cr,cr),new Rt(0,cr)];function z5(f,s){const u=[];let p=[];if(!s||f.length<2)return[f];if(f.length===2)return at(f[0],f[1],Yj)?[f]:[];for(let v=0;v<f.length+2;v++){const m=f[v%f.length],_=f[(v+1)%f.length],P=at(v===0?f[f.length-1]:f[(v-1)%f.length],m,Yj),O=at(m,_,Yj),B=P||O;B&&p.push(m),B&&O||p.length>0&&(p.length>1&&u.push(p),p=[])}return p.length>1&&u.push(p),u}const Xj=Rx.VectorTileFeature.types,Xie=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],Jie=["fill-extrusion-flood-light-ground-radius"],Qie=Math.pow(2,13),eae=Math.pow(2,15)-1,B5=new Rt(0,1),kg=2147483648;function ab(f,s,u,p,v,m,_,P){f.emplaceBack((s<<1)+_,(u<<1)+m,(Math.floor(p*Qie)<<1)+v,Math.round(P))}function sb(f,s,u){f.emplaceBack(s.x*cr,s.y*cr,u?1:0)}function Y2(f,s,u,p,v,m){f.emplaceBack(s.x,s.y,(u.x<<1)+p,(u.y<<1)+v,m)}function ob(f,s,u){f.emplaceBack(s.x,s.y,s.z,u[0]*16384,u[1]*16384,u[2]*16384)}class V5{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class U5{constructor(){this.centroidXY=new Rt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Rt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Rt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Rt(this.max.x-this.min.x,this.max.y-this.min.y)}}class $5{constructor(){this.acc=new Rt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(s,u){s.min.x===Number.MAX_VALUE&&(s.min.x=s.max.x=u.x,s.min.y=s.max.y=u.y)}appendEdge(s,u,p){this.accCount++,this.acc._add(u);let v=!!this.borders;u.x<s.min.x?(s.min.x=u.x,v=!0):u.x>s.max.x&&(s.max.x=u.x,v=!0),u.y<s.min.y?(s.min.y=u.y,v=!0):u.y>s.max.y&&(s.max.y=u.y,v=!0),((u.x===0||u.x===cr)&&u.x===p.x)!=((u.y===0||u.y===cr)&&u.y===p.y)&&this.processBorderOverlap(u,p),v&&this.checkBorderIntersection(u,p)}checkBorderIntersection(s,u){u.x<0!=s.x<0&&this.addBorderIntersection(0,Fr(u.y,s.y,(0-u.x)/(s.x-u.x))),u.x>cr!=s.x>cr&&this.addBorderIntersection(1,Fr(u.y,s.y,(cr-u.x)/(s.x-u.x))),u.y<0!=s.y<0&&this.addBorderIntersection(2,Fr(u.x,s.x,(0-u.y)/(s.y-u.y))),u.y>cr!=s.y>cr&&this.addBorderIntersection(3,Fr(u.x,s.x,(cr-u.y)/(s.y-u.y)))}addBorderIntersection(s,u){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const p=this.borders[s];u<p[0]&&(p[0]=u),u>p[1]&&(p[1]=u)}processBorderOverlap(s,u){if(s.x===u.x){if(s.y===u.y)return;const p=s.x===0?0:1;this.addBorderIntersection(p,u.y),this.addBorderIntersection(p,s.y)}else{const p=s.y===0?2:3;this.addBorderIntersection(p,u.x),this.addBorderIntersection(p,s.x)}}centroid(){return this.accCount===0?new Rt(0,0):new Rt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((s,u)=>s+ +(u[0]!==Number.MAX_VALUE),0):0}}function q5(f,s){const u=f.add(s)._unit(),p=pr(f.x*u.x+f.y*u.y,-1,1);var v,m,_;return _=Math.acos(p),Math.min(4,Math.max(-4,Math.tan(_)))/4*eae*((v=f).x*(m=s).y-v.y*m.x<0?-1:1)}const tae=[f=>f.x<0,f=>f.x>cr,f=>f.y<0,f=>f.y>cr];function rae(f,s,u,p){const v=[4];if(p===0)return v;u._mult(p);const m=f.sub(u),_=s.sub(u),P=[f,s,m,_];for(let O=0;O<4;O++)for(const B of P)if(tae[O](B)){v.push(O);break}return v}class G5{constructor(s){this.vertexArray=new cs,this.indexArray=new bs,this.programConfigurations=new Nu(s.layers,{zoom:s.zoom,lut:s.lut},u=>Jie.includes(u)),this._segments=new Na,this.hiddenByLandmarkVertexArray=new Zp,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Na}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(s,u,p,v=!1){const m=s.length;if(m>2){let _=Math.max(0,this._segments.get().length-1);const P=this._segments._prepareSegment(4*m,this.vertexArray.length,2*this._segmentToGroundQuads[_].length);let O;_!==this._segments.get().length-1&&(_++,this._segmentToGroundQuads[_]=[],this._segmentToRegionTriCounts[_]=[0,0,0,0,0]);{const B=s[0],k=s[1];O=q5(B.sub(s[m-1])._perp()._unit(),k.sub(B)._perp()._unit())}for(let B=0;B<m;B++){const k=B===m-1?0:B+1,R=s[B],z=s[k],M=s[k===m-1?0:k+1],L=z.sub(R)._perp()._unit(),q=q5(L,M.sub(z)._perp()._unit()),X=O,te=q;if(Jj(R,z,u)||v&&K5(R,u)&&K5(z,u)){O=q;continue}const le=P.vertexLength;Y2(this.vertexArray,R,z,1,1,X),Y2(this.vertexArray,R,z,1,0,X),Y2(this.vertexArray,R,z,0,1,te),Y2(this.vertexArray,R,z,0,0,te),P.vertexLength+=4;const ce=rae(R,z,L,p);for(const ie of ce)this._segmentToGroundQuads[_].push({id:le,region:ie}),this._segmentToRegionTriCounts[_][ie]+=2,P.primitiveLength+=2;O=q}}}prepareBorderSegments(){if(!this.hasData())return;const s=this._segments.get(),u=s.length;for(let p=0;p<u;p++)this._segmentToGroundQuads[p].sort((v,m)=>v.region-m.region);for(let p=0;p<u;p++){const v=this._segmentToGroundQuads[p],m=s[p],_=this._segmentToRegionTriCounts[p];_.reduce((O,B)=>O+B,0);let P=0;for(let O=0;O<=4;O++){const B=_[O];if(B!==0){let k=this.regionSegments[O];k||(k=this.regionSegments[O]=new Na);const R={vertexOffset:m.vertexOffset,primitiveOffset:m.primitiveOffset+P,vertexLength:m.vertexLength,primitiveLength:B};k.get().push(R)}P+=B}for(let O=0;O<v.length;O++){const B=v[O].id;this.indexArray.emplaceBack(B,B+1,B+3),this.indexArray.emplaceBack(B,B+3,B+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(s,u,p,v,m,_){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,s,u,p,v,m,_)}upload(s){this.hasData()&&(this.vertexBuffer=s.createVertexBuffer(this.vertexArray,si.members),this.indexBuffer=s.createIndexBuffer(this.indexArray))}uploadPaintProperties(s){this.hasData()&&this.programConfigurations.upload(s)}update(s,u,p,v,m,_,P){this.hasData()&&this.programConfigurations.updatePaintArrays(s,u,p,v,m,_,P)}updateHiddenByLandmark(s){if(!this.hasData())return;const u=s.groundVertexCount+s.groundVertexArrayOffset;if(s.groundVertexCount===0)return;const p=s.flags&kg?1:0;for(let v=s.groundVertexArrayOffset;v<u;++v)this.hiddenByLandmarkVertexArray.emplace(v,p);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(s){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=s.createVertexBuffer(this.hiddenByLandmarkVertexArray,zf.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let s=0;s<=4;s++){const u=this.regionSegments[s];u&&u.destroy()}}}}class X2{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.pixelRatio=s.pixelRatio,this.layerIds=this.layers.map(u=>u.fqid),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new bs,this.footprintVertices=new Fo,this.footprintSegments=[],this.layoutVertexArray=new pa,this.centroidVertexArray=new zo,this.wallVertexArray=new Wy,this.indexArray=new bs,this.programConfigurations=new Nu(s.layers,{zoom:s.zoom,lut:s.lut},u=>Xie.includes(u)),this.segments=new Na,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.groundEffect=new G5(s),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(s,u){}populate(s,u,p,v){this.features=[],this.hasPattern=tn("fill-extrusion",this.layers,this.pixelRatio,u),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=l(p),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:m,id:_,index:P,sourceLayerIndex:O}of s){const B=this.layers[0]._featureFilter.needGeometry,k=re(m,B);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),k,p))continue;const R={id:_,sourceLayerIndex:O,index:P,geometry:B?k.geometry:Y(m,p,v),properties:m.properties,type:m.type,patterns:{}},z=this.layoutVertexArray.length,M=Xj[R.type]==="Polygon";if(this.hasPattern)this.features.push(hn("fill-extrusion",this.layers,R,this.zoom,this.pixelRatio,u));else if(this.wallMode)for(const L of R.geometry)for(const q of z5(L,M))this.addFeature(R,[q],P,p,{},u.availableImages,v,u.brightness);else this.addFeature(R,R.geometry,P,p,{},u.availableImages,v,u.brightness);u.featureIndex.insert(m,R.geometry,P,O,this.index,z)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(s,u,p,v,m,_){for(const P of this.features){const O=Xj[P.type]==="Polygon",{geometry:B}=P;if(this.wallMode)for(const k of B)for(const R of z5(k,O))this.addFeature(P,[R],P.index,u,p,v,m,_);else this.addFeature(P,B,P.index,u,p,v,m,_)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(s,u,p,v,m,_,P){this.programConfigurations.updatePaintArrays(s,u,m,p,v,_,P),this.groundEffect.update(s,u,m,p,v,_,P)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Zie),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.wallVertexBuffer=s.createVertexBuffer(this.wallVertexArray,Ji.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,qj.members,!0)),this.groundEffect.upload(s)),this.groundEffect.uploadPaintProperties(s),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){this.groundEffect.uploadHiddenByLandmark(s),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,Ao.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,u,p,v,m,_,P,O){const B=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(s,{})/this.tileToMeter,k=[new Rt(0,0),new Rt(cr,cr)],R=P.projection,z=R.name==="globe",M=this.wallMode||Xj[s.type]==="Polygon",L=new $5;L.centroidDataIndex=this.centroidData.length;const q=new U5,X=this.layers[0].paint.get("fill-extrusion-base").evaluate(s,{},v)<=0,te=this.layers[0].paint.get("fill-extrusion-height").evaluate(s,{},v);let le;if(q.height=te,q.vertexArrayOffset=this.layoutVertexArray.length,q.groundVertexArrayOffset=this.groundEffect.vertexArray.length,z&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new _s),this.wallMode){if(z)return void ln("Non zero fill-extrusion-line-width is not yet supported on globe.");if(u.length!==1)return;le=function(Ie){const et=Ie[0].x===Ie[Ie.length-1].x&&Ie[0].y===Ie[Ie.length-1].y;(function(Qt){let Gt=0;const kr=Qt.length;for(let yr=0;yr<kr;yr++)Gt+=(Qt[(yr+1)%kr].x-Qt[yr].x)*(Qt[(yr+1)%kr].y+Qt[yr].y);return Gt>=0})(Ie)||(Ie=Ie.reverse());const rt={geometry:[],joinNormals:[],indices:[]},ot=[],it=[],ct=[];let ft=Ie.length;for(;ft>=2&&Ie[ft-1].equals(Ie[ft-2]);)ft--;if(ft<(et?3:2))return rt;let xt,ut,Mt,qt,Et,fr=0;for(;fr<ft-1&&Ie[fr].equals(Ie[fr+1]);)fr++;et&&(xt=Ie[ft-2],Et=Ie[fr].sub(xt)._unit()._perp());for(let Qt=fr;Qt<ft;Qt++){if(Mt=Qt===ft-1?et?Ie[fr+1]:void 0:Ie[Qt+1],Mt&&Ie[Qt].equals(Mt))continue;Et&&(qt=Et),xt&&(ut=xt),xt=Ie[Qt],Et=Mt?Mt.sub(xt)._unit()._perp():qt,qt=qt||Et;let Gt=qt.add(Et);Gt.x===0&&Gt.y===0||Gt._unit();const kr=Gt.x*Et.x+Gt.y*Et.y,yr=kr!==0?1/kr:1/0,_r=qt.x*Et.y-qt.y*Et.x>0;let rn="miter";const vn=2;rn==="miter"&&yr>vn&&(rn="bevel"),rn==="bevel"&&(yr>100&&(rn="flipbevel"),yr<vn&&(rn="miter"));const Sn=(Nn,Dn,Bn,Ii)=>{const Ni=new Rt(Nn.x,Nn.y),fn=new Rt(Nn.x,Nn.y);Ni.x+=Dn.x*Ii,Ni.y+=Dn.y*Ii,fn.x-=Dn.x*Math.max(Bn,1),fn.y-=Dn.y*Math.max(Bn,1),ct.push(Dn),ot.push(Ni),it.push(fn)};if(rn==="miter")Gt._mult(yr),Sn(xt,Gt,0,0);else if(rn==="flipbevel")Gt=Et.mult(-1),Sn(xt,Gt,0,0),Sn(xt,Gt.mult(-1),0,0);else{const Nn=-Math.sqrt(yr*yr-1),Dn=_r?Nn:0,Bn=_r?0:Nn;ut&&Sn(xt,qt,Dn,Bn),Mt&&Sn(xt,Et,Dn,Bn)}}rt.geometry=[...ot,...it.reverse(),ot[0]],rt.joinNormals=[...ct,...ct.reverse(),ct[ct.length-1]];const lr=rt.geometry.length-1;for(let Qt=0;Qt<lr/2;Qt++)if(Qt+1<lr/2){let Gt=Qt,kr=Qt+1,yr=lr-1-Qt,_r=lr-2-Qt;Gt=Gt===0?lr-1:Gt-1,kr=kr===0?lr-1:kr-1,yr=yr===0?lr-1:yr-1,_r=_r===0?lr-1:_r-1,rt.indices.push(yr),rt.indices.push(kr),rt.indices.push(Gt),rt.indices.push(yr),rt.indices.push(_r),rt.indices.push(kr)}return rt}(u[0]),u=[le.geometry]}const ce=(Ie,et)=>Ie<(et.length-1)/2||Ie===et.length-1,ie=this.wallMode?[u]:Tr(u,500);for(let Ie=ie.length-1;Ie>=0;Ie--){const et=ie[Ie];(et.length===0||(fe=et[0]).every(Ve=>Ve.x<=0)||fe.every(Ve=>Ve.x>=cr)||fe.every(Ve=>Ve.y<=0)||fe.every(Ve=>Ve.y>=cr))&&ie.splice(Ie,1)}var fe;let xe;if(z)xe=J5(ie,k,v);else{xe=[];for(const Ie of ie)xe.push({polygon:Ie,bounds:k})}const je=M?this.edgeRadius:0,Fe=je>0&&this.zoom<17,De=(Ie,et)=>{if(Ie.length===0)return!1;const Ve=Ie[Ie.length-1];return et.x===Ve.x&&et.y===Ve.y};for(const{polygon:Ie,bounds:et}of xe){let Ve=0,rt=0;for(const ft of Ie)M&&!ft[0].equals(ft[ft.length-1])&&ft.push(ft[0]),rt+=M?ft.length-1:ft.length;const ot=this.segments.prepareSegment((M?5:4)*rt,this.layoutVertexArray,this.indexArray);q.footprintSegIdx<0&&(q.footprintSegIdx=this.footprintSegments.length),q.polygonSegIdx<0&&(q.polygonSegIdx=this.polygonSegments.length);const it={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},ct=new V5;if(ct.vertexOffset=this.footprintVertices.length,ct.indexOffset=3*this.footprintIndices.length,ct.ringIndices=[],M){const ft=[],xt=[];Ve=ot.vertexLength;for(let Mt=0;Mt<Ie.length;Mt++){const qt=Ie[Mt];qt.length&&Mt!==0&&xt.push(ft.length/2);const Et=[];let fr,lr;fr=qt[1].sub(qt[0])._perp()._unit(),ct.ringIndices.push(qt.length-1);for(let Qt=1;Qt<qt.length;Qt++){const Gt=qt[Qt],kr=qt[Qt===qt.length-1?1:Qt+1],yr=Gt.clone();if(je){lr=kr.sub(Gt)._perp()._unit();const _r=fr.add(lr)._unit(),rn=je*Math.min(4,1/(fr.x*_r.x+fr.y*_r.y));yr.x+=rn*_r.x,yr.y+=rn*_r.y,yr.x=Math.round(yr.x),yr.y=Math.round(yr.y),fr=lr}if(!X||je!==0&&!Fe||De(Et,yr)||Et.push(yr),ab(this.layoutVertexArray,yr.x,yr.y,0,0,1,1,0),this.wallMode){const _r=ce(Qt,qt);sb(this.wallVertexArray,le.joinNormals[Qt],!_r)}ot.vertexLength++,this.footprintVertices.emplaceBack(Gt.x,Gt.y),ft.push(Gt.x,Gt.y),z&&ob(this.layoutVertexExtArray,R.projectTilePoint(yr.x,yr.y,v),R.upVector(v,yr.x,yr.y))}X&&(je===0||Fe)&&(Et.length!==0&&De(Et,Et[0])&&Et.pop(),this.groundEffect.addData(Et,et,B))}const ut=this.wallMode?le.indices:Ag(ft,xt);for(let Mt=0;Mt<ut.length;Mt+=3)this.footprintIndices.emplaceBack(ct.vertexOffset+ut[Mt+0],ct.vertexOffset+ut[Mt+1],ct.vertexOffset+ut[Mt+2]),this.indexArray.emplaceBack(Ve+ut[Mt],Ve+ut[Mt+2],Ve+ut[Mt+1]),ot.primitiveLength++;ct.indexCount+=ut.length,ct.vertexCount+=this.footprintVertices.length-ct.vertexOffset}for(let ft=0;ft<Ie.length;ft++){const xt=Ie[ft];L.startRing(q,xt[0]);let ut=xt.length>4&&Z5(xt[xt.length-2],xt[0],xt[1]),Mt=je?nae(xt[xt.length-2],xt[0],xt[1],je):0;const qt=[];let Et,fr,lr;fr=xt[1].sub(xt[0])._perp()._unit();let Qt=!0;for(let Gt=1,kr=0;Gt<xt.length;Gt++){let yr=xt[Gt-1],_r=xt[Gt];const rn=xt[Gt===xt.length-1?1:Gt+1];if(L.appendEdge(q,_r,yr),Jj(_r,yr,et)){je&&(fr=rn.sub(_r)._perp()._unit(),Qt=!Qt);continue}const vn=_r.sub(yr)._perp(),Sn=vn.x/(Math.abs(vn.x)+Math.abs(vn.y)),Nn=vn.y>0?1:0,Dn=yr.dist(_r);if(kr+Dn>32768&&(kr=0),je){lr=rn.sub(_r)._perp()._unit();let fn=H5(yr,_r,rn,W5(fr,lr),je);isNaN(fn)&&(fn=0);const yi=_r.sub(yr)._unit();yr=yr.add(yi.mult(Mt))._round(),_r=_r.add(yi.mult(-fn))._round(),Mt=fn,fr=lr,X&&this.zoom>=17&&(De(qt,yr)||qt.push(yr),De(qt,_r)||qt.push(_r))}const Bn=ot.vertexLength,Ii=xt.length>4&&Z5(yr,_r,rn);let Ni=Y5(kr,ut,Qt);if(ab(this.layoutVertexArray,yr.x,yr.y,Sn,Nn,0,0,Ni),ab(this.layoutVertexArray,yr.x,yr.y,Sn,Nn,0,1,Ni),this.wallMode){const fn=ce(Gt-1,xt),yi=le.joinNormals[Gt-1];sb(this.wallVertexArray,yi,fn),sb(this.wallVertexArray,yi,fn)}if(kr+=Dn,Ni=Y5(kr,Ii,!Qt),ut=Ii,ab(this.layoutVertexArray,_r.x,_r.y,Sn,Nn,0,0,Ni),ab(this.layoutVertexArray,_r.x,_r.y,Sn,Nn,0,1,Ni),this.wallMode){const fn=ce(Gt,xt),yi=le.joinNormals[Gt];sb(this.wallVertexArray,yi,fn),sb(this.wallVertexArray,yi,fn)}if(ot.vertexLength+=4,this.indexArray.emplaceBack(Bn+0,Bn+1,Bn+2),this.indexArray.emplaceBack(Bn+1,Bn+3,Bn+2),ot.primitiveLength+=2,je){const fn=Ve+(Gt===1?xt.length-2:Gt-2),yi=Gt===1?Ve:fn+1;if(this.indexArray.emplaceBack(Bn+1,fn,Bn+3),this.indexArray.emplaceBack(fn,yi,Bn+3),ot.primitiveLength+=2,Et===void 0&&(Et=Bn),!Jj(rn,xt[Gt],et)){const bi=Gt===xt.length-1?Et:ot.vertexLength;this.indexArray.emplaceBack(Bn+2,Bn+3,bi),this.indexArray.emplaceBack(Bn+3,bi+1,bi),this.indexArray.emplaceBack(Bn+3,yi,bi+1),ot.primitiveLength+=3}Qt=!Qt}if(z){const fn=this.layoutVertexExtArray,yi=R.projectTilePoint(yr.x,yr.y,v),bi=R.projectTilePoint(_r.x,_r.y,v),Qi=R.upVector(v,yr.x,yr.y),Ua=R.upVector(v,_r.x,_r.y);ob(fn,yi,Qi),ob(fn,yi,Qi),ob(fn,bi,Ua),ob(fn,bi,Ua)}}M&&(Ve+=xt.length-1),X&&je&&this.zoom>=17&&(qt.length!==0&&De(qt,qt[0])&&qt.pop(),this.groundEffect.addData(qt,et,B,je>0))}this.footprintSegments.push(ct),it.triangleCount=this.indexArray.length-it.triangleArrayOffset,this.polygonSegments.push(it),++q.footprintSegLen,++q.polygonSegLen}if(q.vertexCount=this.layoutVertexArray.length-q.vertexArrayOffset,q.groundVertexCount=this.groundEffect.vertexArray.length-q.groundVertexArrayOffset,q.vertexCount!==0){if(q.centroidXY=L.borders?B5:this.encodeCentroid(L,q),this.centroidData.push(q),L.borders){this.featuresOnBorder.push(L);const Ie=this.featuresOnBorder.length-1;for(let et=0;et<L.borders.length;et++)L.borders[et][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[et].push(Ie)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,m,_,v,O),this.groundEffect.addPaintPropertiesData(s,p,m,_,v,O),this.maxHeight=Math.max(this.maxHeight,te)}}sortBorders(){for(let s=0;s<this.borderFeatureIndices.length;s++)this.borderFeatureIndices[s].sort((u,p)=>this.featuresOnBorder[u].borders[s][0]-this.featuresOnBorder[p].borders[s][0])}splitToSubtiles(){const s=[];for(let P=0;P<this.centroidData.length;P++){const O=this.centroidData[P],B=+(O.min.y+O.max.y>cr),k=2*B+(+(O.min.x+O.max.x>cr)^B);for(let R=0;R<O.polygonSegLen;R++){const z=O.polygonSegIdx+R;s.push({centroidIdx:P,subtile:k,polygonSegmentIdx:z,triangleSegmentIdx:this.polygonSegments[z].triangleSegIdx})}}const u=new bs;s.sort((P,O)=>P.triangleSegmentIdx===O.triangleSegmentIdx?P.subtile-O.subtile:P.triangleSegmentIdx-O.triangleSegmentIdx);let p=0,v=0,m=0;for(const P of s){if(P.triangleSegmentIdx!==p)break;m++}const _=s.length;for(;v!==s.length;){p=s[v].triangleSegmentIdx;let P=0,O=v,B=v;for(let k=O;k<m&&s[k].subtile===P;k++)B++;for(;O!==m;){const k=s[O];P=k.subtile;const R=this.centroidData[k.centroidIdx].min.clone(),z=this.centroidData[k.centroidIdx].max.clone(),M={vertexOffset:this.segments.segments[p].vertexOffset,primitiveOffset:u.length,vertexLength:this.segments.segments[p].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let L=O;L<B;L++){const q=s[L],X=this.polygonSegments[q.polygonSegmentIdx],te=this.centroidData[q.centroidIdx].min,le=this.centroidData[q.centroidIdx].max,ce=this.indexArray.uint16;for(let ie=X.triangleArrayOffset;ie<X.triangleArrayOffset+X.triangleCount;ie++)u.emplaceBack(ce[3*ie],ce[3*ie+1],ce[3*ie+2]);M.primitiveLength+=X.triangleCount,R.x=Math.min(R.x,te.x),R.y=Math.min(R.y,te.y),z.x=Math.max(z.x,le.x),z.y=Math.max(z.y,le.y)}M.primitiveLength>0&&this.triangleSubSegments.push({segment:M,min:R,max:z}),O=B;for(let L=O;L<m&&s[L].subtile===s[O].subtile;L++)B++}v=m;for(let k=v;k<_&&s[k].triangleSegmentIdx===s[v].triangleSegmentIdx;k++)m++}u._trim(),this.indexArray=u}getVisibleSegments(s,u,p){const v=new Na;if(this.wallMode){for(const q of this.triangleSubSegments)v.segments.push(q.segment);return v}let m=0,_=0;const P=1<<s.canonical.z;if(u){const q=u.getMinMaxForTile(s);q&&(m=q.min,_=q.max)}_+=this.maxHeight;const O=s.toUnwrapped();let B;const k=[O.canonical.x/P+O.wrap,O.canonical.y/P],R=[(O.canonical.x+1)/P+O.wrap,(O.canonical.y+1)/P],z=(q,X,te)=>[q[0]*(1-te[0])+X[0]*te[0],q[1]*(1-te[1])+X[1]*te[1]],M=[],L=[];for(const q of this.triangleSubSegments){M[0]=q.min.x/cr,M[1]=q.min.y/cr,L[0]=q.max.x/cr,L[1]=q.max.y/cr;const X=z(k,R,M),te=z(k,R,L);if(new wr([X[0],X[1],m],[te[0],te[1],_]).intersectsPrecise(p)===0){B&&(v.segments.push(B),B=void 0);continue}const le=q.segment;B&&B.vertexOffset!==le.vertexOffset&&(v.segments.push(B),B=void 0),B?(B.vertexLength+=le.vertexLength,B.primitiveLength+=le.primitiveLength):B={vertexOffset:le.vertexOffset,primitiveLength:le.primitiveLength,vertexLength:le.vertexLength,primitiveOffset:le.primitiveOffset,sortKey:void 0,vaos:{}}}return B&&v.segments.push(B),v}encodeCentroid(s,u){const p=s.centroid(),v=u.span(),m=Math.min(7,Math.round(v.x*this.tileToMeter/10)),_=Math.min(7,Math.round(v.y*this.tileToMeter/10));return new Rt(pr(p.x,1,cr-1)<<3|m,pr(p.y,1,cr-1)<<3|_)}encodeBorderCentroid(s){if(!s.borders)return new Rt(0,0);const u=s.borders,p=Number.MAX_VALUE;if(u[0][0]!==p||u[1][0]!==p){const v=u[0][0]!==p?0:1;return new Rt(6|(u[0][0]!==p?0:65528),(u[v][0]+u[v][1])/2<<3|6)}{const v=u[2][0]!==p?2:3;return new Rt((u[v][0]+u[v][1])/2<<3|6,6|(u[2][0]!==p?0:65528))}}showCentroid(s){const u=this.centroidData[s.centroidDataIndex];u.flags&=kg,u.centroidXY.x=0,u.centroidXY.y=0,this.writeCentroidToBuffer(u)}writeCentroidToBuffer(s){this.groundEffect.updateHiddenByLandmark(s);const u=s.vertexArrayOffset,p=s.vertexCount+s.vertexArrayOffset,v=s.flags&kg?B5:s.centroidXY,m=this.centroidVertexArray.geta_centroid_pos0(u);if(this.centroidVertexArray.geta_centroid_pos1(u)!==v.y||m!==v.x){for(let _=u;_<p;++_)this.centroidVertexArray.emplace(_,v.x,v.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const s of this.centroidData)this.writeCentroidToBuffer(s)}updateReplacement(s,u,p){if(u.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=u.updateTime;const v=u.getReplacementRegionsForTile(s.toUnwrapped());if(Zj(this.activeReplacements,v))return;if(this.activeReplacements=v,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const _ of this.centroidData)_.flags&=2147483647;const m=[];for(const _ of this.activeReplacements){if(_.order<p)continue;const P=Math.max(1,Math.pow(2,_.footprintTileId.canonical.z-s.canonical.z));for(const O of this.centroidData)if(!(O.flags&kg||_.min.x>O.max.x||O.min.x>_.max.x||_.min.y>O.max.y||O.min.y>_.max.y))for(let B=0;B<O.footprintSegLen;B++){const k=this.footprintSegments[O.footprintSegIdx+B];if(m.length=0,iae(this.footprintVertices,k.vertexOffset,k.vertexCount,_.footprintTileId.canonical,s.canonical,m),I5(_.footprint,m,this.footprintIndices.uint16,k.indexOffset,k.indexCount,-k.vertexOffset,-P)){O.flags|=kg;break}}}for(const _ of this.centroidData)this.writeCentroidToBuffer(_);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(s,u,p){let v=!1;for(let m=0;m<p.footprintSegLen;m++){const _=this.footprintSegments[p.footprintSegIdx+m];let P=0;for(const O of _.ringIndices){for(let B=P,k=O+P-1;B<O+P;k=B++){const R=this.footprintVertices.int16[2*(B+_.vertexOffset)+0],z=this.footprintVertices.int16[2*(B+_.vertexOffset)+1],M=this.footprintVertices.int16[2*(k+_.vertexOffset)+1];z>u!=M>u&&s<(this.footprintVertices.int16[2*(k+_.vertexOffset)+0]-R)*(u-z)/(M-z)+R&&(v=!v)}P=O}}return v}getHeightAtTileCoord(s,u){let p=Number.NEGATIVE_INFINITY,v=!0;const m=4*(s+cr)*cr+(u+cr);if(this.partLookup.hasOwnProperty(m)){const _=this.partLookup[m];return _?{height:_.height,hidden:!!(_.flags&kg)}:void 0}for(const _ of this.centroidData)s>_.max.x||_.min.x>s||u>_.max.y||_.min.y>u||this.footprintContainsPoint(s,u,_)&&_&&_.height>p&&(p=_.height,this.partLookup[m]=_,v=!!(_.flags&kg));if(p!==Number.NEGATIVE_INFINITY)return{height:p,hidden:v};this.partLookup[m]=void 0}}function W5(f,s){const u=f.add(s)._unit();return f.x*u.x+f.y*u.y}function nae(f,s,u,p){const v=s.sub(f)._perp()._unit(),m=u.sub(s)._perp()._unit();return H5(f,s,u,W5(v,m),p)}function H5(f,s,u,p,v){const m=Math.sqrt(1-p*p);return Math.min(f.dist(s)/3,s.dist(u)/3,v*m/p)}function Jj(f,s,u){return f.x<u[0].x&&s.x<u[0].x||f.x>u[1].x&&s.x>u[1].x||f.y<u[0].y&&s.y<u[0].y||f.y>u[1].y&&s.y>u[1].y}function K5(f,s){return f.x<s[0].x||f.x>s[1].x||f.y<s[0].y||f.y>s[1].y}function Z5(f,s,u){if(f.x<0||f.x>=cr||s.x<0||s.x>=cr||u.x<0||u.x>=cr)return!1;const p=u.sub(s),v=p.perp(),m=f.sub(s);return(p.x*m.x+p.y*m.y)/Math.sqrt((p.x*p.x+p.y*p.y)*(m.x*m.x+m.y*m.y))>-.866&&v.x*m.x+v.y*m.y<0}function Y5(f,s,u){const p=s?2|f:-3&f;return u?1|p:-2&p}function X5(){const f=Math.PI/32,s=Math.tan(f),u=_d;return u*Math.sqrt(1+2*s*s)-u}function J5(f,s,u){const p=1<<u.z,v=ol(u.x/p),m=ol((u.x+1)/p),_=Br(u.y/p),P=Br((u.y+1)/p);return function(O,B,k,R,z=0,M){const L=[];if(!O.length||!k||!R)return L;const q=(xe,je)=>{for(const Fe of xe)L.push({polygon:Fe,bounds:je})},X=Math.ceil(Math.log2(k)),te=Math.ceil(Math.log2(R)),le=X-te,ce=[];for(let xe=0;xe<Math.abs(le);xe++)ce.push(le>0?0:1);for(let xe=0;xe<Math.min(X,te);xe++)ce.push(0),ce.push(1);let ie=O;if(ie=H2(ie,B[0].y-z,B[1].y+z,1),ie=H2(ie,B[0].x-z,B[1].x+z,0),!ie.length)return L;const fe=[];for(ce.length?fe.push({polygons:ie,bounds:B,depth:0}):q(ie,B);fe.length;){const xe=fe.pop(),je=xe.depth,Fe=ce[je],De=xe.bounds[0],Ie=xe.bounds[1],et=Fe===0?De.x:De.y,Ve=Fe===0?Ie.x:Ie.y,rt=M?M(Fe,et,Ve):.5*(et+Ve),ot=H2(xe.polygons,et-z,rt+z,Fe),it=H2(xe.polygons,rt-z,Ve+z,Fe);if(ot.length){const ct=[De,new Rt(Fe===0?rt:Ie.x,Fe===1?rt:Ie.y)];ce.length>je+1?fe.push({polygons:ot,bounds:ct,depth:je+1}):q(ot,ct)}if(it.length){const ct=[new Rt(Fe===0?rt:De.x,Fe===1?rt:De.y),Ie];ce.length>je+1?fe.push({polygons:it,bounds:ct,depth:je+1}):q(it,ct)}}return L}(f,s,Math.ceil((m-v)/11.25),Math.ceil((_-P)/11.25),1,(O,B,k)=>{if(O===0)return .5*(B+k);{const R=Br((u.y+B/cr)/p);return(sl(.5*(Br((u.y+k/cr)/p)+R))*p-u.y)*cr}})}function iae(f,s,u,p,v,m){const _=Math.pow(2,p.z-v.z);for(let P=0;P<u;P++){let O=f.int16[2*(P+s)+0],B=f.int16[2*(P+s)+1];O=(O+v.x*cr)*_-p.x*cr,B=(B+v.y*cr)*_-p.y*cr,m.push(new Rt(O,B))}}let Q5,eF;function lb(f,s){return f.x*s.x+f.y*s.y}function tF(f,s){if(f.length===1){let u=0;const p=s[u++];let v;for(;!v||p.equals(v);)if(v=s[u++],!v)return 1/0;for(;u<s.length;u++){const m=s[u],_=f[0],P=v.sub(p),O=m.sub(p),B=_.sub(p),k=lb(P,P),R=lb(P,O),z=lb(O,O),M=lb(B,P),L=lb(B,O),q=k*z-R*R,X=(z*M-R*L)/q,te=(k*L-R*M)/q,le=p.z*(1-X-te)+v.z*X+m.z*te;if(isFinite(le))return le}return 1/0}{let u=1/0;for(const p of s)u=Math.min(u,p.z);return u}}function rF(f,s,u,p,v,m,_,P){const O=_*v.getElevationAt(f,s,!0,!0),B=m[0]!==0,k=B?m[1]===0?_*(m[0]/7-450):_*function(R,z,M){const L=Math.floor(z[0]/8),q=Math.floor(z[1]/8),X=10*(z[0]-8*L),te=10*(z[1]-8*q),le=R.getElevationAt(L,q,!0,!0),ce=R.getMeterToDEM(M),ie=Math.floor(.5*(X*ce-1)),fe=Math.floor(.5*(te*ce-1)),xe=R.tileCoordToPixel(L,q),je=2*ie+1,Fe=2*fe+1,De=function(it,ct,ft,xt,ut){return[it.getElevationAtPixel(ct,ft,!0),it.getElevationAtPixel(ct+ut,ft,!0),it.getElevationAtPixel(ct,ft+ut,!0),it.getElevationAtPixel(ct+xt,ft+ut,!0)]}(R,xe.x-ie,xe.y-fe,je,Fe),Ie=Math.abs(De[0]-De[1]),et=Math.abs(De[2]-De[3]),Ve=Math.abs(De[0]-De[2])+Math.abs(De[1]-De[3]),rt=Math.min(.25,.5*ce*(Ie+et)/je),ot=Math.min(.25,.5*ce*Ve/Fe);return le+Math.max(rt*X,ot*te)}(v,m,P):O;return{base:O+(u===0?-1:u),top:B?Math.max(k+p,O+u+2):O+p}}mr(X2,"FillExtrusionBucket",{omit:["layers","features"]}),mr(U5,"PartData"),mr(V5,"FootprintSegment"),mr($5,"BorderCentroidData"),mr(G5,"GroundEffect");const aae=Jn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),sae=Jn([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:oae}=aae,lae=Jn([{name:"a_packed",components:3,type:"Float32"}]),{members:cae}=lae,uae=Jn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:dae}=uae;class nF{constructor(s,u){this.width=s,this.height=u,this.nextRow=0,this.image=new bd({width:s,height:u}),this.positions={},this.uploaded=!1}getDash(s,u){const p=this.getKey(s,u);return this.positions[p]}trim(){const s=this.width,u=this.height=Qs(this.nextRow);this.image.resize({width:s,height:u})}getKey(s,u){return s.join(",")+u}getDashRanges(s,u,p){const v=[];let m=s.length%2==1?-s[s.length-1]*p:0,_=s[0]*p,P=!0;v.push({left:m,right:_,isDash:P,zeroLength:s[0]===0});let O=s[0];for(let B=1;B<s.length;B++){P=!P;const k=s[B];m=O*p,O+=k,_=O*p,v.push({left:m,right:_,isDash:P,zeroLength:k===0})}return v}addRoundDash(s,u,p){const v=u/2;for(let m=-p;m<=p;m++){const _=this.width*(this.nextRow+p+m);let P=0,O=s[P];for(let B=0;B<this.width;B++){B/O.right>1&&(O=s[++P]);const k=Math.abs(B-O.left),R=Math.abs(B-O.right),z=Math.min(k,R);let M;const L=m/p*(v+1);if(O.isDash){const q=v-Math.abs(L);M=Math.sqrt(z*z+q*q)}else M=v-Math.sqrt(z*z+L*L);this.image.data[_+B]=Math.max(0,Math.min(255,M+128))}}}addRegularDash(s,u){for(let O=s.length-1;O>=0;--O){const B=s[O],k=s[O+1];B.zeroLength?s.splice(O,1):k&&k.isDash===B.isDash&&(k.left=B.left,s.splice(O,1))}const p=s[0],v=s[s.length-1];p.isDash===v.isDash&&(p.left=v.left-this.width,v.right=p.right+this.width);const m=this.width*this.nextRow;let _=0,P=s[_];for(let O=0;O<this.width;O++){O/P.right>1&&(P=s[++_]);const B=Math.abs(O-P.left),k=Math.abs(O-P.right),R=Math.min(B,k);this.image.data[m+O]=Math.max(0,Math.min(255,(P.isDash?R:-R)+u+128))}}addDash(s,u){const p=this.getKey(s,u);if(this.positions[p])return this.positions[p];const v=u==="round",m=v?7:0,_=2*m+1;if(this.nextRow+_>this.height)return ln("LineAtlas out of space"),null;s.length===0&&s.push(1);let P=0;for(let k=0;k<s.length;k++)s[k]<0&&(ln("Negative value is found in line dasharray, replacing values with 0"),s[k]=0),P+=s[k];if(P!==0){const k=this.width/P,R=this.getDashRanges(s,this.width,k);v?this.addRoundDash(R,k,m):this.addRegularDash(R,u==="square"?.5*k:0)}const O=this.nextRow+m;this.nextRow+=_;const B={tl:[O,m],br:[P,0]};return this.positions[p]=B,B}}mr(nF,"LineAtlas");const hae=Rx.VectorTileFeature.types,fae=Math.cos(Math.PI/180*37.5),pae=Math.cos(Math.PI/180*5);class Qj{constructor(s){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=s.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=s.overscaling,this.pixelRatio=s.pixelRatio,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.fqid),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new pd,this.layoutVertexArray2=new rl,this.patternVertexArray=new rl,this.indexArray=new bs,this.programConfigurations=new Nu(s.layers,{zoom:s.zoom,lut:s.lut}),this.segments=new Na,this.maxLineLength=0,this.zOffsetVertexArray=new rl,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.tessellationStep=s.tessellationStep?s.tessellationStep:cr/64}updateFootprints(s,u){}populate(s,u,p,v){this.hasPattern=tn("line",this.layers,this.pixelRatio,u);const m=this.layers[0].layout.get("line-sort-key");this.tileToMeter=l(p);const _=this.layers[0].layout.get("line-z-offset"),P=_.isConstant()&&!_.constantOr(0),O=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=O==="sea"||O==="ground"||!P&&O==="none",this.hasZOffset&&O==="none"&&ln(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const B=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&B!==void 0;const k=[];for(const{feature:L,id:q,index:X,sourceLayerIndex:te}of s){const le=this.layers[0]._featureFilter.needGeometry,ce=re(L,le);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),ce,p))continue;const ie=m?m.evaluate(ce,{},p):void 0,fe={id:q,properties:L.properties,type:L.type,sourceLayerIndex:te,index:X,geometry:le?ce.geometry:Y(L,p,v),patterns:{},sortKey:ie};k.push(fe)}m&&k.sort((L,q)=>L.sortKey-q.sortKey);const{lineAtlas:R,featureIndex:z}=u,M=this.addConstantDashes(R);for(const L of k){const{geometry:q,index:X,sourceLayerIndex:te}=L;if(M&&this.addFeatureDashes(L,R),this.hasPattern){const le=hn("line",this.layers,L,this.zoom,this.pixelRatio,u);this.patternFeatures.push(le)}else this.addFeature(L,q,X,p,R.positions,u.availableImages,u.brightness);z.insert(s[X].feature,q,X,te,this.index)}}addConstantDashes(s){let u=!1;for(const p of this.layers){const v=p.paint.get("line-dasharray").value,m=p.layout.get("line-cap").value;if(v.kind!=="constant"||m.kind!=="constant")u=!0;else{const _=m.value,P=v.value;if(!P)continue;s.addDash(P,_)}}return u}addFeatureDashes(s,u){const p=this.zoom;for(const v of this.layers){const m=v.paint.get("line-dasharray").value,_=v.layout.get("line-cap").value;if(m.kind==="constant"&&_.kind==="constant")continue;let P,O;if(m.kind==="constant"){if(P=m.value,!P)continue}else P=m.evaluate({zoom:p},s);O=_.kind==="constant"?_.value:_.evaluate({zoom:p},s),u.addDash(P,O),s.patterns[v.id]=u.getKey(P,O)}}update(s,u,p,v,m,_,P){this.programConfigurations.updatePaintArrays(s,u,m,p,v,_,P)}addFeatures(s,u,p,v,m,_){for(const P of this.patternFeatures)this.addFeature(P,P.geometry,P.index,u,p,v,_)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,cae)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=s.createVertexBuffer(this.patternVertexArray,dae)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=s.createVertexBuffer(this.zOffsetVertexArray,sae.members,!0)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,oae),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,u,p,v,m,_,P){const O=this.layers[0].layout,B=O.get("line-join").evaluate(s,{}),k=O.get("line-cap").evaluate(s,{}),R=O.get("line-miter-limit"),z=O.get("line-round-limit");this.lineClips=this.lineFeatureClips(s),this.lineFeature=s,this.zOffsetValue=O.get("line-z-offset").value;const M=this.layers[0].paint.get("line-width").value;M.kind!=="constant"&&M.isLineProgressConstant===!1&&(this.variableWidthValue=M);for(const L of u)this.addLine(L,s,v,B,k,R,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,m,_,v,P)}addLine(s,u,p,v,m,_,P){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const O=v==="none";if(this.patternJoinNone=this.hasPattern&&O,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ce=0;ce<s.length-1;ce++)this.totalDistance+=s[ce].dist(s[ce+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const B=hae[u.type]==="Polygon";let k=s.length;for(;k>=2&&s[k-1].equals(s[k-2]);)k--;let R=0;for(;R<k-1&&s[R].equals(s[R+1]);)R++;if(k<(B?3:2))return;v==="bevel"&&(_=1.05);const z=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray);let M,L,q,X,te,le;this.e1=this.e2=-1,B&&(M=s[k-2],te=s[R].sub(M)._unit()._perp());for(let ce=R;ce<k;ce++){if(q=ce===k-1?B?s[R+1]:void 0:s[ce+1],q&&s[ce].equals(q))continue;te&&(X=te),M&&(L=M),M=s[ce],le=this.evaluateLineProgressFeatures(L?L.dist(M):0),te=q?q.sub(M)._unit()._perp():X,X=X||te;const ie=L&&q;let fe=ie?v:B||O?"butt":m;const xe=X.x*te.x+X.y*te.y;if(O){const ot=function(it){if(it.patternJoinNone){const ct=it.segmentPoints.length/2,ft=it.lineSoFar-it.segmentStart;for(let xt=0;xt<ct;++xt){const ut=it.segmentPoints[2*xt+1],Mt=Math.round(it.segmentPoints[2*xt])+.5+.25*ut;it.patternVertexArray.emplaceBack(Mt,ft,it.segmentStart),it.patternVertexArray.emplaceBack(Mt,ft,it.segmentStart)}it.segmentPoints.length=0}it.e1=it.e2=-1};if(ie&&xe<pae){this.updateDistance(L,M),this.addCurrentVertex(M,X,1,1,z,le),ot(this),this.addCurrentVertex(M,te,-1,-1,z,le);continue}if(L){if(!q){this.updateDistance(L,M),this.addCurrentVertex(M,X,1,1,z,le),ot(this);continue}fe="miter"}}let je=X.add(te);je.x===0&&je.y===0||je._unit();const Fe=je.x*te.x+je.y*te.y,De=Fe!==0?1/Fe:1/0,Ie=2*Math.sqrt(2-2*Fe),et=Fe<fae&&L&&q,Ve=X.x*te.y-X.y*te.x>0,rt=this.overscaling<=16?15*cr/(512*this.overscaling):0;if(ie&&fe==="round"){if(De<P)fe="miter";else if(De<=2){const ot=ek(M,-10,cr+10);fe=this.hasZOffset&&(ot||this.hasCrossSlope)?"miter":"fakeround"}}if(fe==="miter"&&De>_&&(fe="bevel"),fe==="bevel"&&(De>2&&(fe="flipbevel"),De<_&&(fe="miter")),L&&!(fe==="miter"&&et)&&this.updateDistance(L,M),fe==="miter")if(et){const ot=M.dist(L);if(ot>2*rt){const ct=M.sub(M.sub(L)._mult(rt/ot)._round());this.updateDistance(L,ct),this.addCurrentVertex(ct,X,0,0,z,le),L=ct}this.updateDistance(L,M),je._mult(De),this.addCurrentVertex(M,je,0,0,z,le);const it=M.dist(q);if(it>2*rt){const ct=M.add(q.sub(M)._mult(rt/it)._round());this.updateDistance(M,ct),this.addCurrentVertex(ct,te,0,0,z,le),M=ct}}else je._mult(De),this.addCurrentVertex(M,je,0,0,z,le);else if(fe==="flipbevel"){if(De>100)je=te.mult(-1);else{const ot=De*X.add(te).mag()/X.sub(te).mag();je._perp()._mult(ot*(Ve?-1:1))}this.addCurrentVertex(M,je,0,0,z,le),this.addCurrentVertex(M,je.mult(-1),0,0,z,le)}else if(fe==="bevel"||fe==="fakeround"){le!=null&&L&&this.addCurrentVertex(M,X,-1,-1,z,le);const ot=M.dist(L)<=2*rt&&fe!=="bevel",it=je.mult(Ve?1:-1);it._mult(De);const ct=te.mult(Ve?-1:1),ft=X.mult(Ve?-1:1),xt=this.evaluateLineProgressFeatures(this.distance);if(le==null&&(this.addHalfVertex(M,it.x,it.y,!1,!Ve,0,z,xt),ot||this.addHalfVertex(M,it.x+2*ft.x,it.y+2*ft.y,!1,Ve,0,z,xt)),fe==="fakeround"){const ut=Math.round(180*Ie/Math.PI/20);this.addHalfVertex(M,ft.x,ft.y,!1,Ve,0,z,xt);for(let Mt=0;Mt<ut;Mt++){let qt=Mt/ut;if(qt!==.5){const fr=qt-.5;qt+=qt*fr*(qt-1)*((1.0904+xe*(xe*(3.55645-1.43519*xe)-3.2452))*fr*fr+(.848013+xe*(.215638*xe-1.06021)))}const Et=ct.sub(ft)._mult(qt)._add(ft)._unit();this.addHalfVertex(M,Et.x,Et.y,!1,Ve,0,z,xt)}this.addHalfVertex(M,ct.x,ct.y,!1,Ve,0,z,xt)}ot||le!=null||this.addHalfVertex(M,it.x+2*ct.x,it.y+2*ct.y,!1,Ve,0,z,xt),le!=null&&q&&this.addCurrentVertex(M,te,1,1,z,le)}else fe==="butt"?this.addCurrentVertex(M,je,0,0,z,le):fe==="square"?(L||this.addCurrentVertex(M,je,-1,-1,z,le),this.addCurrentVertex(M,je,0,0,z,le),L&&this.addCurrentVertex(M,je,1,1,z,le)):fe==="round"&&(L&&(this.addCurrentVertex(M,X,0,0,z,le),this.addCurrentVertex(M,X,1,1,z,le,!0)),q&&(this.addCurrentVertex(M,te,-1,-1,z,le,!0),this.addCurrentVertex(M,te,0,0,z,le)))}}addVerticesTo(s,u,p,v,m,_,P,O,B,k){const R=(u.w-s.w)/this.tessellationStep|0;let z=0;const M=this.scaledDistance;if(R>1){this.lineSoFar=s.w;const q=(u.x-s.x)/R,X=(u.y-s.y)/R,te=(u.z-s.z)/R,le=(u.w-s.w)/R;for(let ce=1;ce<R;++ce){s.x+=q,s.y+=X,s.z+=te,this.lineSoFar+=le,z+=le;const ie=this.evaluateLineProgressFeatures(this.prevDistance+z);this.scaledDistance=(this.prevDistance+z)/this.totalDistance,this.addHalfVertex(s,p,v,k,!1,P,B,ie),this.addHalfVertex(s,m,_,k,!0,-O,B,ie)}}this.lineSoFar=u.w,this.scaledDistance=M;const L=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(u,p,v,k,!1,P,B,L),this.addHalfVertex(u,m,_,k,!0,-O,B,L)}evaluateLineProgressFeatures(s){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+s)/this.totalFeatureLength):ln(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let u=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(u=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:u}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:u}:{zOffset:0,variableWidth:u}}addCurrentVertex(s,u,p,v,m,_,P=!1){const O=u.x+u.y*p,B=u.y-u.x*p,k=u.y*v-u.x,R=-u.y-u.x*v;if(_!=null){const z=this.hasZOffset,M=-10,L=cr+10,q=_.zOffset,X=new P5(s.x,s.y,q,this.lineSoFar),te=!!z&&ek(s,M,L),le=this.lineSoFar,ce=this.distance;if(this.currentVertex)if(te){const ie=this.currentVertexIsOutside,fe=this.currentVertex,xe=new P5(s.x,s.y,q,this.lineSoFar);if(E5(fe,xe,M,L),!ek(xe,M,L)){if(ie){this.e1=this.e2=-1,this.distance-=fe.dist(X),this.lineSoFar=fe.w;const je=this.evaluateLineProgressFeatures(fe.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(fe,O,B,P,!1,p,m,je),this.addHalfVertex(fe,k,R,P,!0,-v,m,je),this.prevDistance=this.distance}this.distance=this.prevDistance+fe.dist(xe),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(fe,xe,O,B,k,R,p,v,m,P),this.distance=ce,this.scaledDistance=this.distance/this.totalDistance}}else{const ie=this.currentVertex;if(this.currentVertexIsOutside){E5(ie,X,M,L),this.e1=this.e2=-1,this.distance-=ie.dist(X),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=ie.w;const fe=this.evaluateLineProgressFeatures(ie.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ie,O,B,P,!1,p,m,fe),this.addHalfVertex(ie,k,R,P,!0,-v,m,fe),this.prevDistance=this.distance,this.distance=ce,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(ie,X,O,B,k,R,p,v,m,P)}else te||(this.addHalfVertex(s,O,B,P,!1,p,m,_),this.addHalfVertex(s,k,R,P,!0,-v,m,_));this.currentVertex=X,this.currentVertexIsOutside=te,this.lineSoFar=le}else this.addHalfVertex(s,O,B,P,!1,p,m,_),this.addHalfVertex(s,k,R,P,!0,-v,m,_)}addHalfVertex({x:s,y:u},p,v,m,_,P,O,B){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),_||this.segmentPoints.push(this.lineSoFar-this.segmentStart,P)),this.layoutVertexArray.emplaceBack((s<<1)+(m?1:0),(u<<1)+(_?1:0),Math.round(63*p)+128,Math.round(63*v)+128,1+(P===0?0:P<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const R=Fr(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,R)}const k=O.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),O.primitiveLength++),_?this.e2=k:this.e1=k,B!=null&&this.zOffsetVertexArray.emplaceBack(B.zOffset,B.variableWidth,B.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(s,u){this.prevDistance=this.distance,this.distance+=s.dist(u),this.updateScaledDistance()}}function ek(f,s,u){return f.x<s||f.x>u||f.y<s||f.y>u}let iF,aF;function sF(f,s,u){return s*(cr/(f.tileSize*Math.pow(2,u-f.tileID.overscaledZ)))}mr(Qj,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const oF=(f,s,u)=>(1-u)*f+u*s;function lF(f,s){return 1/sF(f,1,s.tileZoom)}function cF(f,s,u,p){return f.translatePosMatrix(p||s.tileID.projMatrix,s,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const uF=f=>{const s=[];dF(f)&&s.push("RENDER_LINE_DASH"),f.paint.get("line-gradient")&&s.push("RENDER_LINE_GRADIENT");const u=f.paint.get("line-trim-offset");u[0]===0&&u[1]===0||s.push("RENDER_LINE_TRIM_OFFSET"),f.paint.get("line-border-width").constantOr(1)!==0&&s.push("RENDER_LINE_BORDER");const p=f.layout.get("line-join").constantOr("miter")==="none",v=!!f.paint.get("line-pattern").constantOr(1);return p&&v&&s.push("LINE_JOIN_NONE"),s};function dF(f){const s=f.paint.get("line-dasharray").value;return s.value||s.kind!=="constant"}let tk;const hF=()=>tk||(tk={layout:iF||(iF=new qi({"line-cap":new dr(vt.layout_line["line-cap"]),"line-join":new dr(vt.layout_line["line-join"]),"line-miter-limit":new Jt(vt.layout_line["line-miter-limit"]),"line-round-limit":new Jt(vt.layout_line["line-round-limit"]),"line-sort-key":new dr(vt.layout_line["line-sort-key"]),"line-z-offset":new dr(vt.layout_line["line-z-offset"]),"line-elevation-reference":new Jt(vt.layout_line["line-elevation-reference"]),"line-cross-slope":new Jt(vt.layout_line["line-cross-slope"]),visibility:new Jt(vt.layout_line.visibility),"line-width-unit":new Jt(vt.layout_line["line-width-unit"])})),paint:aF||(aF=new qi({"line-opacity":new dr(vt.paint_line["line-opacity"]),"line-color":new dr(vt.paint_line["line-color"]),"line-translate":new Jt(vt.paint_line["line-translate"]),"line-translate-anchor":new Jt(vt.paint_line["line-translate-anchor"]),"line-width":new dr(vt.paint_line["line-width"]),"line-gap-width":new dr(vt.paint_line["line-gap-width"]),"line-offset":new dr(vt.paint_line["line-offset"]),"line-blur":new dr(vt.paint_line["line-blur"]),"line-dasharray":new dr(vt.paint_line["line-dasharray"]),"line-pattern":new dr(vt.paint_line["line-pattern"]),"line-gradient":new Wl(vt.paint_line["line-gradient"]),"line-trim-offset":new Jt(vt.paint_line["line-trim-offset"]),"line-trim-fade-range":new Jt(vt.paint_line["line-trim-fade-range"]),"line-trim-color":new Jt(vt.paint_line["line-trim-color"]),"line-emissive-strength":new Jt(vt.paint_line["line-emissive-strength"]),"line-border-width":new dr(vt.paint_line["line-border-width"]),"line-border-color":new dr(vt.paint_line["line-border-color"]),"line-occlusion-opacity":new Jt(vt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"})}))},tk);class mae extends dr{possiblyEvaluate(s,u){return u=new vi(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,transition:u.transition}),super.possiblyEvaluate(s,u)}evaluate(s,u,p,v){return u=Ui({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(s,u,p,v)}}let cb;function fF(f,s){return s>0?s+2*f:f}const gae=Jn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),yae=Jn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),xae=Jn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Jn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const vae=Jn([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),_ae=Jn([{name:"a_texb",components:2,type:"Uint16"}]),bae=Jn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),wae=Jn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Jn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const pF=Jn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Sae=Jn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Jn([{name:"triangle",components:3,type:"Uint16"}]),Jn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Jn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Jn([{type:"Float32",name:"offsetX"}]),Jn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Uo=24;const kh=128;function rk(f,s,u,p,v){if(f.kind==="camera")return f.maxSize;if(f.kind==="composite"){const m=s.possiblyEvaluate(new vi(f.maxZoom),u).evaluate(v,{},u),_=s.possiblyEvaluate(new vi(f.minZoom),u).evaluate(v,{},u);return Math.max(m,_)}return s.possiblyEvaluate(new vi(p)).evaluate(v,{},u)}function nk(f,s){const{expression:u}=s;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new vi(f+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:v}=u;let m=0;for(;m<p.length&&p[m]<=f;)m++;m=Math.max(0,m-1);let _=m;for(;_<p.length&&p[_]<f+1;)_++;_=Math.min(p.length-1,_);const P=p[m],O=p[_];return u.kind==="composite"?{kind:"composite",minZoom:P,maxZoom:O,interpolationType:v}:{kind:"camera",minZoom:P,maxZoom:O,minSize:u.evaluate(new vi(P)),maxSize:u.evaluate(new vi(O)),interpolationType:v}}}function J2(f,{uSize:s,uSizeT:u},{lowerSize:p,upperSize:v}){return f.kind==="source"?p/kh:f.kind==="composite"?Fr(p/kh,v/kh,u):s}function Ix(f,s,u=1){let p=0,v=0;if(f.kind==="constant")v=f.layoutSize*u;else if(f.kind!=="source"){const{interpolationType:m,minZoom:_,maxZoom:P}=f,O=m?pr(Is.interpolationFactor(m,s,_,P),0,1):0;f.kind==="camera"?v=Fr(f.minSize,f.maxSize,O)*u:p=O*u}return{uSizeT:p,uSize:v}}var Nae=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:kh,evaluateSizeForFeature:J2,evaluateSizeForZoom:Ix,getRasterizedIconSize:rk,getSizeData:nk});function Aae(f,s,u){return f.sections.forEach(p=>{p.text=function(v,m,_){const P=m.layout.get("text-transform").evaluate(_,{});return P==="uppercase"?v=v.toLocaleUpperCase():P==="lowercase"&&(v=v.toLocaleLowerCase()),tl.applyArabicShaping&&(v=tl.applyArabicShaping(v)),v}(p.text,s,u)}),f}const ub={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function Tae(f){return f===""||f===""||f===""||f===""||f===""||f===""||f===""||f===""||f===""||f===""||f===""||f===""||f===""||f===""||f===""||f===""||f===""}function jae(f){return f===""||f===""||f===""||f===""||f===""||f===""||f===""||f===""||f===""||f===""}var mF,ik,gF,ak={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function kae(){return mF||(mF=1,ak.read=function(f,s,u,p,v){var m,_,P=8*v-p-1,O=(1<<P)-1,B=O>>1,k=-7,R=u?v-1:0,z=u?-1:1,M=f[s+R];for(R+=z,m=M&(1<<-k)-1,M>>=-k,k+=P;k>0;m=256*m+f[s+R],R+=z,k-=8);for(_=m&(1<<-k)-1,m>>=-k,k+=p;k>0;_=256*_+f[s+R],R+=z,k-=8);if(m===0)m=1-B;else{if(m===O)return _?NaN:1/0*(M?-1:1);_+=Math.pow(2,p),m-=B}return(M?-1:1)*_*Math.pow(2,m-p)},ak.write=function(f,s,u,p,v,m){var _,P,O,B=8*m-v-1,k=(1<<B)-1,R=k>>1,z=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=p?0:m-1,L=p?1:-1,q=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(P=isNaN(s)?1:0,_=k):(_=Math.floor(Math.log(s)/Math.LN2),s*(O=Math.pow(2,-_))<1&&(_--,O*=2),(s+=_+R>=1?z/O:z*Math.pow(2,1-R))*O>=2&&(_++,O/=2),_+R>=k?(P=0,_=k):_+R>=1?(P=(s*O-1)*Math.pow(2,v),_+=R):(P=s*Math.pow(2,R-1)*Math.pow(2,v),_=0));v>=8;f[u+M]=255&P,M+=L,P/=256,v-=8);for(_=_<<v|P,B+=v;B>0;f[u+M]=255&_,M+=L,_/=256,B-=8);f[u+M-L]|=128*q}),ak}function yF(){if(gF)return ik;gF=1,ik=s;var f=kae();function s(ie){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ie)?ie:new Uint8Array(ie||0),this.pos=0,this.type=0,this.length=this.buf.length}s.Varint=0,s.Fixed64=1,s.Bytes=2,s.Fixed32=5;var u=4294967296,p=1/u,v=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function m(ie){return ie.type===s.Bytes?ie.readVarint()+ie.pos:ie.pos+1}function _(ie,fe,xe){return xe?4294967296*fe+(ie>>>0):4294967296*(fe>>>0)+(ie>>>0)}function P(ie,fe,xe){var je=fe<=16383?1:fe<=2097151?2:fe<=268435455?3:Math.floor(Math.log(fe)/(7*Math.LN2));xe.realloc(je);for(var Fe=xe.pos-1;Fe>=ie;Fe--)xe.buf[Fe+je]=xe.buf[Fe]}function O(ie,fe){for(var xe=0;xe<ie.length;xe++)fe.writeVarint(ie[xe])}function B(ie,fe){for(var xe=0;xe<ie.length;xe++)fe.writeSVarint(ie[xe])}function k(ie,fe){for(var xe=0;xe<ie.length;xe++)fe.writeFloat(ie[xe])}function R(ie,fe){for(var xe=0;xe<ie.length;xe++)fe.writeDouble(ie[xe])}function z(ie,fe){for(var xe=0;xe<ie.length;xe++)fe.writeBoolean(ie[xe])}function M(ie,fe){for(var xe=0;xe<ie.length;xe++)fe.writeFixed32(ie[xe])}function L(ie,fe){for(var xe=0;xe<ie.length;xe++)fe.writeSFixed32(ie[xe])}function q(ie,fe){for(var xe=0;xe<ie.length;xe++)fe.writeFixed64(ie[xe])}function X(ie,fe){for(var xe=0;xe<ie.length;xe++)fe.writeSFixed64(ie[xe])}function te(ie,fe){return(ie[fe]|ie[fe+1]<<8|ie[fe+2]<<16)+16777216*ie[fe+3]}function le(ie,fe,xe){ie[xe]=fe,ie[xe+1]=fe>>>8,ie[xe+2]=fe>>>16,ie[xe+3]=fe>>>24}function ce(ie,fe){return(ie[fe]|ie[fe+1]<<8|ie[fe+2]<<16)+(ie[fe+3]<<24)}return s.prototype={destroy:function(){this.buf=null},readFields:function(ie,fe,xe){for(xe=xe||this.length;this.pos<xe;){var je=this.readVarint(),Fe=je>>3,De=this.pos;this.type=7&je,ie(Fe,fe,this),this.pos===De&&this.skip(je)}return fe},readMessage:function(ie,fe){return this.readFields(ie,fe,this.readVarint()+this.pos)},readFixed32:function(){var ie=te(this.buf,this.pos);return this.pos+=4,ie},readSFixed32:function(){var ie=ce(this.buf,this.pos);return this.pos+=4,ie},readFixed64:function(){var ie=te(this.buf,this.pos)+te(this.buf,this.pos+4)*u;return this.pos+=8,ie},readSFixed64:function(){var ie=te(this.buf,this.pos)+ce(this.buf,this.pos+4)*u;return this.pos+=8,ie},readFloat:function(){var ie=f.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ie},readDouble:function(){var ie=f.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ie},readVarint:function(ie){var fe,xe,je=this.buf;return fe=127&(xe=je[this.pos++]),xe<128?fe:(fe|=(127&(xe=je[this.pos++]))<<7,xe<128?fe:(fe|=(127&(xe=je[this.pos++]))<<14,xe<128?fe:(fe|=(127&(xe=je[this.pos++]))<<21,xe<128?fe:function(Fe,De,Ie){var et,Ve,rt=Ie.buf;if(et=(112&(Ve=rt[Ie.pos++]))>>4,Ve<128||(et|=(127&(Ve=rt[Ie.pos++]))<<3,Ve<128)||(et|=(127&(Ve=rt[Ie.pos++]))<<10,Ve<128)||(et|=(127&(Ve=rt[Ie.pos++]))<<17,Ve<128)||(et|=(127&(Ve=rt[Ie.pos++]))<<24,Ve<128)||(et|=(1&(Ve=rt[Ie.pos++]))<<31,Ve<128))return _(Fe,et,De);throw new Error("Expected varint not more than 10 bytes")}(fe|=(15&(xe=je[this.pos]))<<28,ie,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ie=this.readVarint();return ie%2==1?(ie+1)/-2:ie/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ie=this.readVarint()+this.pos,fe=this.pos;return this.pos=ie,ie-fe>=12&&v?function(xe,je,Fe){return v.decode(xe.subarray(je,Fe))}(this.buf,fe,ie):function(xe,je,Fe){for(var De="",Ie=je;Ie<Fe;){var et,Ve,rt,ot=xe[Ie],it=null,ct=ot>239?4:ot>223?3:ot>191?2:1;if(Ie+ct>Fe)break;ct===1?ot<128&&(it=ot):ct===2?(192&(et=xe[Ie+1]))==128&&(it=(31&ot)<<6|63&et)<=127&&(it=null):ct===3?(Ve=xe[Ie+2],(192&(et=xe[Ie+1]))==128&&(192&Ve)==128&&((it=(15&ot)<<12|(63&et)<<6|63&Ve)<=2047||it>=55296&&it<=57343)&&(it=null)):ct===4&&(Ve=xe[Ie+2],rt=xe[Ie+3],(192&(et=xe[Ie+1]))==128&&(192&Ve)==128&&(192&rt)==128&&((it=(15&ot)<<18|(63&et)<<12|(63&Ve)<<6|63&rt)<=65535||it>=1114112)&&(it=null)),it===null?(it=65533,ct=1):it>65535&&(it-=65536,De+=String.fromCharCode(it>>>10&1023|55296),it=56320|1023&it),De+=String.fromCharCode(it),Ie+=ct}return De}(this.buf,fe,ie)},readBytes:function(){var ie=this.readVarint()+this.pos,fe=this.buf.subarray(this.pos,ie);return this.pos=ie,fe},readPackedVarint:function(ie,fe){if(this.type!==s.Bytes)return ie.push(this.readVarint(fe));var xe=m(this);for(ie=ie||[];this.pos<xe;)ie.push(this.readVarint(fe));return ie},readPackedSVarint:function(ie){if(this.type!==s.Bytes)return ie.push(this.readSVarint());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readSVarint());return ie},readPackedBoolean:function(ie){if(this.type!==s.Bytes)return ie.push(this.readBoolean());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readBoolean());return ie},readPackedFloat:function(ie){if(this.type!==s.Bytes)return ie.push(this.readFloat());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readFloat());return ie},readPackedDouble:function(ie){if(this.type!==s.Bytes)return ie.push(this.readDouble());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readDouble());return ie},readPackedFixed32:function(ie){if(this.type!==s.Bytes)return ie.push(this.readFixed32());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readFixed32());return ie},readPackedSFixed32:function(ie){if(this.type!==s.Bytes)return ie.push(this.readSFixed32());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readSFixed32());return ie},readPackedFixed64:function(ie){if(this.type!==s.Bytes)return ie.push(this.readFixed64());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readFixed64());return ie},readPackedSFixed64:function(ie){if(this.type!==s.Bytes)return ie.push(this.readSFixed64());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readSFixed64());return ie},skip:function(ie){var fe=7&ie;if(fe===s.Varint)for(;this.buf[this.pos++]>127;);else if(fe===s.Bytes)this.pos=this.readVarint()+this.pos;else if(fe===s.Fixed32)this.pos+=4;else{if(fe!==s.Fixed64)throw new Error("Unimplemented type: "+fe);this.pos+=8}},writeTag:function(ie,fe){this.writeVarint(ie<<3|fe)},realloc:function(ie){for(var fe=this.length||16;fe<this.pos+ie;)fe*=2;if(fe!==this.length){var xe=new Uint8Array(fe);xe.set(this.buf),this.buf=xe,this.length=fe}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ie){this.realloc(4),le(this.buf,ie,this.pos),this.pos+=4},writeSFixed32:function(ie){this.realloc(4),le(this.buf,ie,this.pos),this.pos+=4},writeFixed64:function(ie){this.realloc(8),le(this.buf,-1&ie,this.pos),le(this.buf,Math.floor(ie*p),this.pos+4),this.pos+=8},writeSFixed64:function(ie){this.realloc(8),le(this.buf,-1&ie,this.pos),le(this.buf,Math.floor(ie*p),this.pos+4),this.pos+=8},writeVarint:function(ie){(ie=+ie||0)>268435455||ie<0?function(fe,xe){var je,Fe;if(fe>=0?(je=fe%4294967296|0,Fe=fe/4294967296|0):(Fe=~(-fe/4294967296),4294967295^(je=~(-fe%4294967296))?je=je+1|0:(je=0,Fe=Fe+1|0)),fe>=18446744073709552e3||fe<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");xe.realloc(10),function(De,Ie,et){et.buf[et.pos++]=127&De|128,De>>>=7,et.buf[et.pos++]=127&De|128,De>>>=7,et.buf[et.pos++]=127&De|128,De>>>=7,et.buf[et.pos++]=127&De|128,et.buf[et.pos]=127&(De>>>=7)}(je,0,xe),function(De,Ie){var et=(7&De)<<4;Ie.buf[Ie.pos++]|=et|((De>>>=3)?128:0),De&&(Ie.buf[Ie.pos++]=127&De|((De>>>=7)?128:0),De&&(Ie.buf[Ie.pos++]=127&De|((De>>>=7)?128:0),De&&(Ie.buf[Ie.pos++]=127&De|((De>>>=7)?128:0),De&&(Ie.buf[Ie.pos++]=127&De|((De>>>=7)?128:0),De&&(Ie.buf[Ie.pos++]=127&De)))))}(Fe,xe)}(ie,this):(this.realloc(4),this.buf[this.pos++]=127&ie|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=ie>>>7&127))))},writeSVarint:function(ie){this.writeVarint(ie<0?2*-ie-1:2*ie)},writeBoolean:function(ie){this.writeVarint(!!ie)},writeString:function(ie){ie=String(ie),this.realloc(4*ie.length),this.pos++;var fe=this.pos;this.pos=function(je,Fe,De){for(var Ie,et,Ve=0;Ve<Fe.length;Ve++){if((Ie=Fe.charCodeAt(Ve))>55295&&Ie<57344){if(!et){Ie>56319||Ve+1===Fe.length?(je[De++]=239,je[De++]=191,je[De++]=189):et=Ie;continue}if(Ie<56320){je[De++]=239,je[De++]=191,je[De++]=189,et=Ie;continue}Ie=et-55296<<10|Ie-56320|65536,et=null}else et&&(je[De++]=239,je[De++]=191,je[De++]=189,et=null);Ie<128?je[De++]=Ie:(Ie<2048?je[De++]=Ie>>6|192:(Ie<65536?je[De++]=Ie>>12|224:(je[De++]=Ie>>18|240,je[De++]=Ie>>12&63|128),je[De++]=Ie>>6&63|128),je[De++]=63&Ie|128)}return De}(this.buf,ie,this.pos);var xe=this.pos-fe;xe>=128&&P(fe,xe,this),this.pos=fe-1,this.writeVarint(xe),this.pos+=xe},writeFloat:function(ie){this.realloc(4),f.write(this.buf,ie,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ie){this.realloc(8),f.write(this.buf,ie,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ie){var fe=ie.length;this.writeVarint(fe),this.realloc(fe);for(var xe=0;xe<fe;xe++)this.buf[this.pos++]=ie[xe]},writeRawMessage:function(ie,fe){this.pos++;var xe=this.pos;ie(fe,this);var je=this.pos-xe;je>=128&&P(xe,je,this),this.pos=xe-1,this.writeVarint(je),this.pos+=je},writeMessage:function(ie,fe,xe){this.writeTag(ie,s.Bytes),this.writeRawMessage(fe,xe)},writePackedVarint:function(ie,fe){fe.length&&this.writeMessage(ie,O,fe)},writePackedSVarint:function(ie,fe){fe.length&&this.writeMessage(ie,B,fe)},writePackedBoolean:function(ie,fe){fe.length&&this.writeMessage(ie,z,fe)},writePackedFloat:function(ie,fe){fe.length&&this.writeMessage(ie,k,fe)},writePackedDouble:function(ie,fe){fe.length&&this.writeMessage(ie,R,fe)},writePackedFixed32:function(ie,fe){fe.length&&this.writeMessage(ie,M,fe)},writePackedSFixed32:function(ie,fe){fe.length&&this.writeMessage(ie,L,fe)},writePackedFixed64:function(ie,fe){fe.length&&this.writeMessage(ie,q,fe)},writePackedSFixed64:function(ie,fe){fe.length&&this.writeMessage(ie,X,fe)},writeBytesField:function(ie,fe){this.writeTag(ie,s.Bytes),this.writeBytes(fe)},writeFixed32Field:function(ie,fe){this.writeTag(ie,s.Fixed32),this.writeFixed32(fe)},writeSFixed32Field:function(ie,fe){this.writeTag(ie,s.Fixed32),this.writeSFixed32(fe)},writeFixed64Field:function(ie,fe){this.writeTag(ie,s.Fixed64),this.writeFixed64(fe)},writeSFixed64Field:function(ie,fe){this.writeTag(ie,s.Fixed64),this.writeSFixed64(fe)},writeVarintField:function(ie,fe){this.writeTag(ie,s.Varint),this.writeVarint(fe)},writeSVarintField:function(ie,fe){this.writeTag(ie,s.Varint),this.writeSVarint(fe)},writeStringField:function(ie,fe){this.writeTag(ie,s.Bytes),this.writeString(fe)},writeFloatField:function(ie,fe){this.writeTag(ie,s.Fixed32),this.writeFloat(fe)},writeDoubleField:function(ie,fe){this.writeTag(ie,s.Fixed64),this.writeDouble(fe)},writeBooleanField:function(ie,fe){this.writeVarintField(ie,!!fe)}},ik}var Q2=x(yF());const sk=3;function Pae(f,s,u){s.glyphs=[],f===1&&u.readMessage(Cae,s)}function Cae(f,s,u){if(f===3){const{id:p,bitmap:v,width:m,height:_,left:P,top:O,advance:B}=u.readMessage(Eae,{});s.glyphs.push({id:p,bitmap:new bd({width:m+2*sk,height:_+2*sk},v),metrics:{width:m,height:_,left:P,top:O,advance:B}})}else f===4?s.ascender=u.readSVarint():f===5&&(s.descender=u.readSVarint())}function Eae(f,s,u){f===1?s.id=u.readVarint():f===2?s.bitmap=u.readBytes():f===3?s.width=u.readVarint():f===4?s.height=u.readVarint():f===5?s.left=u.readSVarint():f===6?s.top=u.readSVarint():f===7&&(s.advance=u.readVarint())}const Mae=sk,Tu={horizontal:1,vertical:2,horizontalOnly:3};class db{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(s,u){const p=new db;return p.scale=s||1,p.fontStack=u,p}static forImage(s){const u=new db;return u.image=s,u}}class Lx{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,u){const p=new Lx;for(let v=0;v<s.sections.length;v++){const m=s.sections[v];m.image?p.addImageSection(m):p.addTextSection(m,u)}return p}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCodePoint(s){return this.text.codePointAt(s)}verticalizePunctuation(s){this.text=function(u,p){let v="";for(let m=0;m<u.length;m++){const _=u.charCodeAt(m+1)||null,P=u.charCodeAt(m-1)||null;v+=!p&&(_&&Sa(_)&&!ub[u[m+1]]||P&&Sa(P)&&!ub[u[m-1]])||!ub[u[m]]?u[m]:ub[u[m]]}return v}(this.text,s)}trim(){let s=0;for(let p=0;p<this.text.length&&eS[this.text.charCodeAt(p)];p++)s++;let u=this.text.length;for(let p=this.text.length-1;p>=0&&p>=s&&eS[this.text.charCodeAt(p)];p--)u--;this.text=this.text.substring(s,u),this.sectionIndex=this.sectionIndex.slice(s,u)}substring(s,u){const p=new Lx;return p.text=this.text.substring(s,u),p.sectionIndex=this.sectionIndex.slice(s,u),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,u)=>Math.max(s,this.sections[u].scale),0)}addTextSection(s,u){this.text+=s.text,this.sections.push(db.forText(s.scale,s.fontStack||u));const p=this.sections.length-1;for(let v=0;v<s.text.length;++v)this.sectionIndex.push(p)}addImageSection(s){const u=s.image&&s.image.namePrimary?s.image.getPrimary():null;if(!u)return void ln("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(db.forImage(u)),this.sectionIndex.push(this.sections.length-1)):ln("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ok(f,s,u,p,v,m,_,P,O,B,k,R,z,M,L){const q=Lx.fromFeature(f,v);R===Tu.vertical&&q.verticalizePunctuation(z);let X=[];const te=function(xe,je,Fe,De,Ie,et){if(!xe)return[];const Ve=[],rt=function(ft,xt,ut,Mt,qt,Et){let fr=0;for(let lr=0;lr<ft.length();lr++){const Qt=ft.getSection(lr);fr+=xF(ft.getCodePoint(lr),Qt,Mt,qt,xt,Et)}return fr/Math.max(1,Math.ceil(fr/ut))}(xe,je,Fe,De,Ie,et),ot=xe.text.indexOf("")>=0;let it=0;for(let ft=0;ft<xe.length();ft++){const xt=xe.getSection(ft),ut=xe.getCodePoint(ft);if(eS[ut]||(it+=xF(ut,xt,De,Ie,je,et)),ft<xe.length()-1){const Mt=!((ct=ut)<11904||!(Er["Bopomofo Extended"](ct)||Er.Bopomofo(ct)||Er["CJK Compatibility Forms"](ct)||Er["CJK Compatibility Ideographs"](ct)||Er["CJK Compatibility"](ct)||Er["CJK Radicals Supplement"](ct)||Er["CJK Strokes"](ct)||Er["CJK Symbols and Punctuation"](ct)||Er["CJK Unified Ideographs Extension A"](ct)||Er["CJK Unified Ideographs"](ct)||Er["Enclosed CJK Letters and Months"](ct)||Er["Halfwidth and Fullwidth Forms"](ct)||Er.Hiragana(ct)||Er["Ideographic Description Characters"](ct)||Er["Kangxi Radicals"](ct)||Er["Katakana Phonetic Extensions"](ct)||Er.Katakana(ct)||Er["Vertical Forms"](ct)||Er["Yi Radicals"](ct)||Er["Yi Syllables"](ct)));(Oae[ut]||Mt||xt.image)&&Ve.push(_F(ft+1,it,rt,Ve,Rae(ut,xe.getCodePoint(ft+1),Mt&&ot),!1))}}var ct;return bF(_F(xe.length(),it,rt,Ve,0,!0))}(q,B,m,s,p,M),{processBidirectionalText:le,processStyledBidirectionalText:ce}=tl;if(le&&q.sections.length===1){const xe=le(q.toString(),te);for(const je of xe){const Fe=new Lx;Fe.text=je,Fe.sections=q.sections;for(let De=0;De<je.length;De++)Fe.sectionIndex.push(0);X.push(Fe)}}else if(ce){const xe=ce(q.text,q.sectionIndex,te);for(const je of xe){const Fe=new Lx;Fe.text=je[0],Fe.sectionIndex=je[1],Fe.sections=q.sections,X.push(Fe)}}else X=function(xe,je){const Fe=[],De=xe.text;let Ie=0;for(const et of je)Fe.push(xe.substring(Ie,et)),Ie=et;return Ie<De.length&&Fe.push(xe.substring(Ie,De.length)),Fe}(q,te);const ie=[],fe={positionedLines:ie,text:q.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:R,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(xe,je,Fe,De,Ie,et,Ve,rt,ot,it,ct,ft){let xt=0,ut=0,Mt=0;const qt=rt==="right"?1:rt==="left"?0:.5;let Et=!1;for(const yr of Ie){const _r=yr.getSections();for(const rn of _r){if(rn.image)continue;const vn=je[rn.fontStack];if(vn&&(Et=vn.ascender!==void 0&&vn.descender!==void 0,!Et))break}if(!Et)break}let fr=0;for(const yr of Ie){yr.trim();const _r=yr.getMaxScale(),rn=(_r-1)*Uo,vn={positionedGlyphs:[],lineOffset:0};xe.positionedLines[fr]=vn;const Sn=vn.positionedGlyphs;let Nn=0;if(!yr.length()){ut+=et,++fr;continue}let Dn=0,Bn=0;for(let Ni=0;Ni<yr.length();Ni++){const fn=yr.getSection(Ni),yi=yr.getSectionIndex(Ni),bi=yr.getCodePoint(Ni);let Qi=fn.scale,Ua=null,fs=null,$a=null,Pa=Uo,Ya=0;const Ns=!(ot===Tu.horizontal||!ct&&!bo(bi)||ct&&(eS[bi]||(lr=bi,Er.Arabic(lr)||Er["Arabic Supplement"](lr)||Er["Arabic Extended-A"](lr)||Er["Arabic Presentation Forms-A"](lr)||Er["Arabic Presentation Forms-B"](lr))));if(fn.image){const $o=De[fn.image.serialize()];if(!$o)continue;$a=fn.image.id,xe.iconsInText=xe.iconsInText||!0,fs=$o.paddedRect;const Hi=$o.displaySize;Qi=Qi*Uo/ft,Ua={width:Hi[0],height:Hi[1],left:0,top:-3,advance:Ns?Hi[1]:Hi[0],localGlyph:!1},Ya=Et?-Ua.height*Qi:_r*Uo-17-Hi[1]*Qi,Pa=Ua.advance;const mc=(Ns?Hi[0]:Hi[1])*Qi-Uo*_r;mc>0&&mc>Nn&&(Nn=mc)}else{const $o=Fe[fn.fontStack];if(!$o)continue;$o[bi]&&(fs=$o[bi]);const Hi=je[fn.fontStack];if(!Hi)continue;const mc=Hi.glyphs[bi];if(!mc)continue;if(Ua=mc.metrics,Pa=bi!==8203?Uo:0,Et){const Oh=Hi.ascender!==void 0?Math.abs(Hi.ascender):0,Sd=Hi.descender!==void 0?Math.abs(Hi.descender):0,Nd=(Oh+Sd)*Qi;Dn<Nd&&(Dn=Nd,Bn=(Oh-Sd)/2*Qi),Ya=-Oh*Qi}else Ya=(_r-Qi)*Uo-17}Ns?(xe.verticalizable=!0,Sn.push({glyph:bi,imageName:$a,x:xt,y:ut+Ya,vertical:Ns,scale:Qi,localGlyph:Ua.localGlyph,fontStack:fn.fontStack,sectionIndex:yi,metrics:Ua,rect:fs}),xt+=Pa*Qi+it):(Sn.push({glyph:bi,imageName:$a,x:xt,y:ut+Ya,vertical:Ns,scale:Qi,localGlyph:Ua.localGlyph,fontStack:fn.fontStack,sectionIndex:yi,metrics:Ua,rect:fs}),xt+=Ua.advance*Qi+it)}Sn.length!==0&&(Mt=Math.max(xt-it,Mt),Et?wF(Sn,qt,Nn,Bn,et*_r/2):wF(Sn,qt,Nn,0,et/2)),xt=0;const Ii=et*_r+Nn;vn.lineOffset=Math.max(Nn,rn),ut+=Ii,++fr}var lr;const Qt=ut,{horizontalAlign:Gt,verticalAlign:kr}=lk(Ve);(function(yr,_r,rn,vn,Sn,Nn){const Dn=(_r-rn)*Sn,Bn=-Nn*vn;for(const Ii of yr)for(const Ni of Ii.positionedGlyphs)Ni.x+=Dn,Ni.y+=Bn})(xe.positionedLines,qt,Gt,kr,Mt,Qt),xe.top+=-kr*Qt,xe.bottom=xe.top+Qt,xe.left+=-Gt*Mt,xe.right=xe.left+Mt,xe.hasBaseline=Et}(fe,s,u,p,X,_,P,O,R,B,z,L),!function(xe){for(const je of xe)if(je.positionedGlyphs.length!==0)return!1;return!0}(ie)&&fe}const eS={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Oae={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function xF(f,s,u,p,v,m){if(s.image){const _=p[s.image.serialize()];return _?_.displaySize[0]*s.scale*Uo/m+v:0}{const _=u[s.fontStack],P=_&&_.glyphs[f];return P?P.metrics.advance*s.scale+v:0}}function vF(f,s,u,p){const v=Math.pow(f-s,2);return p?f<s?v/2:2*v:v+Math.abs(u)*u}function Rae(f,s,u){let p=0;return f===10&&(p-=1e4),u&&(p+=150),f!==40&&f!==65288||(p+=50),s!==41&&s!==65289||(p+=50),p}function _F(f,s,u,p,v,m){let _=null,P=vF(s,u,v,m);for(const O of p){const B=vF(s-O.x,u,v,m)+O.badness;B<=P&&(_=O,P=B)}return{index:f,x:s,priorBreak:_,badness:P}}function bF(f){return f?bF(f.priorBreak).concat(f.index):[]}function lk(f){let s=.5,u=.5;switch(f){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:s,verticalAlign:u}}function wF(f,s,u,p,v){if(!(s||u||p||v))return;const m=f.length-1,_=f[m],P=(_.x+_.metrics.advance*_.scale)*s;for(let O=0;O<=m;O++)f[O].x-=P,f[O].y+=u+p+v}function Iae(f,s,u,p){const{horizontalAlign:v,verticalAlign:m}=lk(p),_=u[0]-f.displaySize[0]*v,P=u[1]-f.displaySize[1]*m;return{imagePrimary:f,imageSecondary:s,top:P,bottom:P+f.displaySize[1],left:_,right:_+f.displaySize[0]}}function SF(f,s,u,p,v,m){const _=f.imagePrimary;let P;if(_.content){const X=_.content,te=_.pixelRatio||1;P=[X[0]/te,X[1]/te,_.displaySize[0]-X[2]/te,_.displaySize[1]-X[3]/te]}const O=s.left*m,B=s.right*m;let k,R,z,M;u==="width"||u==="both"?(M=v[0]+O-p[3],R=v[0]+B+p[1]):(M=v[0]+(O+B-_.displaySize[0])/2,R=M+_.displaySize[0]);const L=s.top*m,q=s.bottom*m;return u==="height"||u==="both"?(k=v[1]+L-p[0],z=v[1]+q+p[2]):(k=v[1]+(L+q-_.displaySize[1])/2,z=k+_.displaySize[1]),{imagePrimary:_,imageSecondary:void 0,top:k,right:R,bottom:z,left:M,collisionPadding:P}}class am extends Rt{constructor(s,u,p,v,m){super(s,u),this.angle=v,this.z=p,m!==void 0&&(this.segment=m)}clone(){return new am(this.x,this.y,this.z,this.angle,this.segment)}}function NF(f,s,u,p,v){if(s.segment===void 0)return!0;let m=s,_=s.segment+1,P=0;for(;P>-u/2;){if(_--,_<0)return!1;P-=f[_].dist(m),m=f[_]}P+=f[_].dist(f[_+1]),_++;const O=[];let B=0;for(;P<u/2;){const k=f[_],R=f[_+1];if(!R)return!1;let z=f[_-1].angleTo(k)-k.angleTo(R);for(z=Math.abs((z+3*Math.PI)%(2*Math.PI)-Math.PI),O.push({distance:P,angleDelta:z}),B+=z;P-O[0].distance>p;)B-=O.shift().angleDelta;if(B>v)return!1;_++,P+=k.dist(R)}return!0}function AF(f){let s=0;for(let u=0;u<f.length-1;u++)s+=f[u].dist(f[u+1]);return s}function TF(f,s,u){return f?.6*s*u:0}function jF(f,s){return Math.max(f?f.right-f.left:0,s?s.right-s.left:0)}function Lae(f,s,u,p,v,m){const _=TF(u,v,m),P=jF(u,p)*m;let O=0;const B=AF(f)/2;for(let k=0;k<f.length-1;k++){const R=f[k],z=f[k+1],M=R.dist(z);if(O+M>B){const L=(B-O)/M,q=Fr(R.x,z.x,L),X=Fr(R.y,z.y,L),te=new am(q,X,0,z.angleTo(R),k);return!_||NF(f,te,P,_,s)?te:void 0}O+=M}}function Dae(f,s,u,p,v,m,_,P,O){const B=TF(p,m,_),k=jF(p,v),R=k*_,z=f[0].x===0||f[0].x===O||f[0].y===0||f[0].y===O;return s-R<s/4&&(s=R+s/4),kF(f,z?s/2*P%s:(k/2+2*m)*_*P%s,s,B,u,R,z,!1,O)}function kF(f,s,u,p,v,m,_,P,O){const B=m/2,k=AF(f);let R=0,z=s-u,M=[];for(let L=0;L<f.length-1;L++){const q=f[L],X=f[L+1],te=q.dist(X),le=X.angleTo(q);for(;z+u<R+te;){z+=u;const ce=(z-R)/te,ie=Fr(q.x,X.x,ce),fe=Fr(q.y,X.y,ce);if(ie>=0&&ie<O&&fe>=0&&fe<O&&z-B>=0&&z+B<=k){const xe=new am(ie,fe,0,le,L);p&&!NF(f,xe,m,p,v)||M.push(xe)}}R+=te}return P||M.length||_||(M=kF(f,R/2,u,p,v,m,_,!0,O)),M}function PF(f,s,u,p,v){const m=[];for(let _=0;_<f.length;_++){const P=f[_];let O;for(let B=0;B<P.length-1;B++){let k=P[B],R=P[B+1];k.x<s&&R.x<s||(k.x<s?k=new Rt(s,k.y+(s-k.x)/(R.x-k.x)*(R.y-k.y))._round():R.x<s&&(R=new Rt(s,k.y+(s-k.x)/(R.x-k.x)*(R.y-k.y))._round()),k.y<u&&R.y<u||(k.y<u?k=new Rt(k.x+(u-k.y)/(R.y-k.y)*(R.x-k.x),u)._round():R.y<u&&(R=new Rt(k.x+(u-k.y)/(R.y-k.y)*(R.x-k.x),u)._round()),k.x>=p&&R.x>=p||(k.x>=p?k=new Rt(p,k.y+(p-k.x)/(R.x-k.x)*(R.y-k.y))._round():R.x>=p&&(R=new Rt(p,k.y+(p-k.x)/(R.x-k.x)*(R.y-k.y))._round()),k.y>=v&&R.y>=v||(k.y>=v?k=new Rt(k.x+(v-k.y)/(R.y-k.y)*(R.x-k.x),v)._round():R.y>=v&&(R=new Rt(k.x+(v-k.y)/(R.y-k.y)*(R.x-k.x),v)._round()),O&&k.equals(O[O.length-1])||(O=[k],m.push(O)),O.push(R)))))}}return m}function CF(f){let s=0,u=0;for(const _ of f)s+=_.w*_.h,u=Math.max(u,_.w);f.sort((_,P)=>P.h-_.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),u),h:1/0}];let v=0,m=0;for(const _ of f)for(let P=p.length-1;P>=0;P--){const O=p[P];if(!(_.w>O.w||_.h>O.h)){if(_.x=O.x,_.y=O.y,m=Math.max(m,_.y+_.h),v=Math.max(v,_.x+_.w),_.w===O.w&&_.h===O.h){const B=p.pop();P<p.length&&(p[P]=B)}else _.h===O.h?(O.x+=_.w,O.w-=_.w):_.w===O.w?(O.y+=_.h,O.h-=_.h):(p.push({x:O.x+_.w,y:O.y,w:O.w-_.w,h:_.h}),O.y+=_.h,O.h-=_.h);break}}return{w:v,h:m,fill:s/(v*m)||0}}mr(am,"Anchor");const hb=1;class fb{static getImagePositionScale(s,u,p){return u&&s&&s.options&&s.options.transform?{x:s.options.transform.a,y:s.options.transform.d}:{x:p,y:p}}constructor(s,{pixelRatio:u,version:p,stretchX:v,stretchY:m,content:_,sdf:P,usvg:O},B,k){this.paddedRect=s,this.pixelRatio=u,this.stretchX=v,this.stretchY=m,this.content=_,this.version=p,this.padding=B,this.sdf=P,this.scale=fb.getImagePositionScale(k,O,u)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}class EF{constructor(s,u,p){const v={},m={};this.haveRenderCallbacks=[];const _=[];this.addImages(s,v,hb,_),this.addImages(u,m,2,_);const{w:P,h:O}=CF(_),B=new Ks({width:P||1,height:O||1});for(const k in s){const R=s[k],z=v[k].paddedRect;Ks.copy(R.data,B,{x:0,y:0},{x:z.x+hb,y:z.y+hb},R.data,p,R.sdf)}for(const k in u){const R=u[k],z=m[k].paddedRect;let M=m[k].padding;const L=z.x+M,q=z.y+M,X=R.data.width,te=R.data.height;M=M>1?M-1:M,Ks.copy(R.data,B,{x:0,y:0},{x:L,y:q},R.data,p),Ks.copy(R.data,B,{x:0,y:te-M},{x:L,y:q-M},{width:X,height:M},p),Ks.copy(R.data,B,{x:0,y:0},{x:L,y:q+te},{width:X,height:M},p),Ks.copy(R.data,B,{x:X-M,y:0},{x:L-M,y:q},{width:M,height:te},p),Ks.copy(R.data,B,{x:0,y:0},{x:L+X,y:q},{width:M,height:te},p),Ks.copy(R.data,B,{x:X-M,y:te-M},{x:L-M,y:q-M},{width:M,height:M},p),Ks.copy(R.data,B,{x:0,y:te-M},{x:L+X,y:q-M},{width:M,height:M},p),Ks.copy(R.data,B,{x:0,y:0},{x:L+X,y:q+te},{width:M,height:M},p),Ks.copy(R.data,B,{x:X-M,y:0},{x:L-M,y:q+te},{width:M,height:M},p)}this.lut=p,this.image=B,this.iconPositions=v,this.patternPositions=m}addImages(s,u,p,v){for(const m in s){const _=s[m],P={x:0,y:0,w:_.data.width+2*p,h:_.data.height+2*p};v.push(P);const O=_l.deserializeFromString(m);u[m]=new fb(P,_,p,O),_.hasRenderCallback&&this.haveRenderCallbacks.push(O.id)}}patchUpdatedImages(s,u,p){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(v=>s.hasImage(v,p)),s.dispatchRenderCallbacks(this.haveRenderCallbacks,p);for(const v in s.getUpdatedImages(p)){for(const m of Object.keys(this.iconPositions))_l.deserializeId(m)===v&&this.patchUpdatedImage(this.iconPositions[m],s.getImage(v,p),u);for(const m of Object.keys(this.patternPositions))_l.deserializeId(m)===v&&this.patchUpdatedImage(this.patternPositions[m],s.getImage(v,p),u)}}patchUpdatedImage(s,u,p){if(!s||!u||s.version===u.version)return;s.version=u.version;const[v,m]=s.tl,_=s.sdf;if(this.lut||_){const P={width:u.data.width,height:u.data.height},O=new Ks(P);Ks.copy(u.data,O,{x:0,y:0},{x:0,y:0},P,this.lut,_),p.update(O,{position:{x:v,y:m}})}else p.update(u.data,{position:{x:v,y:m}})}}mr(fb,"ImagePosition"),mr(EF,"ImageAtlas");const tS=1e20;function MF(f,s,u,p,v,m,_,P,O){for(let B=s;B<s+p;B++)OF(f,u*m+B,m,v,_,P,O);for(let B=u;B<u+v;B++)OF(f,B*m+s,1,p,_,P,O)}function OF(f,s,u,p,v,m,_){m[0]=0,_[0]=-1e20,_[1]=tS,v[0]=f[s];for(let P=1,O=0,B=0;P<p;P++){v[P]=f[s+P*u];const k=P*P;do{const R=m[O];B=(v[P]-v[R]+k-R*R)/(P-R)/2}while(B<=_[O]&&--O>-1);O++,m[O]=P,_[O]=B,_[O+1]=tS}for(let P=0,O=0;P<p;P++){for(;_[O+1]<P;)O++;const B=m[O],k=P-B;f[s+P*u]=v[B]+k*k}}const Ph=2,ck={none:0,ideographs:1,all:2};class Dx{constructor(s,u,p){this.requestManager=s,this.localGlyphMode=u,this.localFontFamily=p,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s,u){this.urls[u]=s}getGlyphs(s,u,p){const v=[],m=this.urls[u]||$i.GLYPHS_URL;for(const _ in s)for(const P of s[_])v.push({stack:_,id:P});Vi(v,({stack:_,id:P},O)=>{let B=this.entries[_];B||(B=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let k=B.glyphs[P];if(k!==void 0)return void O(null,{stack:_,id:P,glyph:k});if(k=this._tinySDF(B,_,P),k)return B.glyphs[P]=k,void O(null,{stack:_,id:P,glyph:k});const R=Math.floor(P/256);if(256*R>65535)return ln("glyphs > 65535 not supported"),void O(null,{stack:_,id:P,glyph:k});if(B.ranges[R])return void O(null,{stack:_,id:P,glyph:k});let z=B.requests[R];z||(z=B.requests[R]=[],Dx.loadGlyphRange(_,R,m,this.requestManager,(M,L)=>{if(L){B.ascender=L.ascender,B.descender=L.descender;for(const q in L.glyphs)this._doesCharSupportLocalGlyph(+q)||(B.glyphs[+q]=L.glyphs[+q]);B.ranges[R]=!0}for(const q of z)q(M,L);delete B.requests[R]})),z.push((M,L)=>{M?O(M):L&&O(null,{stack:_,id:P,glyph:L.glyphs[P]||null})})},(_,P)=>{if(_)p(_);else if(P){const O={};for(const{stack:B,id:k,glyph:R}of P)O[B]===void 0&&(O[B]={}),O[B].glyphs===void 0&&(O[B].glyphs={}),O[B].glyphs[k]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics},O[B].ascender=this.entries[B].ascender,O[B].descender=this.entries[B].descender;p(null,O)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==ck.none&&(this.localGlyphMode===ck.all?!!this.localFontFamily:!!this.localFontFamily&&(Er["CJK Unified Ideographs"](s)||Er["Hangul Syllables"](s)||Er.Hiragana(s)||Er.Katakana(s)||Er["CJK Symbols and Punctuation"](s)||Er["CJK Unified Ideographs Extension A"](s)||Er["CJK Unified Ideographs Extension B"](s)||Er.Osage(s)))}_tinySDF(s,u,p){const v=this.localFontFamily;if(!v||!this._doesCharSupportLocalGlyph(p))return;let m=s.tinySDF;if(!m){let q="400";/bold/i.test(u)?q="900":/medium/i.test(u)?q="500":/light/i.test(u)&&(q="200"),m=s.tinySDF=new Dx.TinySDF({fontFamily:v,fontWeight:q,fontSize:24*Ph,buffer:3*Ph,radius:8*Ph}),m.fontWeight=q}if(this.localGlyphs[m.fontWeight][p])return this.localGlyphs[m.fontWeight][p];const _=String.fromCodePoint(p),{data:P,width:O,height:B,glyphWidth:k,glyphHeight:R,glyphLeft:z,glyphTop:M,glyphAdvance:L}=m.draw(_);return this.localGlyphs[m.fontWeight][p]={id:p,bitmap:new bd({width:O,height:B},P),metrics:{width:k/Ph,height:R/Ph,left:z/Ph,top:M/Ph-27,advance:L/Ph,localGlyph:!0}}}}Dx.loadGlyphRange=function(f,s,u,p,v){const m=256*s,_=m+255,P=p.transformRequest(p.normalizeGlyphsURL(u).replace("{fontstack}",f).replace("{range}",`${m}-${_}`),Rn.Glyphs);ls(P,(O,B)=>{if(O)v(O);else if(B){const k={},R=function(z){return new Q2(z).readFields(Pae,{})}(B);for(const z of R.glyphs)k[z.id]=z;v(null,{glyphs:k,ascender:R.ascender,descender:R.descender})}})},Dx.TinySDF=class{constructor({fontSize:f=24,buffer:s=3,radius:u=8,cutoff:p=.25,fontFamily:v="sans-serif",fontWeight:m="normal",fontStyle:_="normal"}={}){this.buffer=s,this.cutoff=p,this.radius=u;const P=this.size=f+4*s,O=this._createCanvas(P),B=this.ctx=O.getContext("2d",{willReadFrequently:!0});B.font=`${_} ${m} ${f}px ${v}`,B.textBaseline="alphabetic",B.textAlign="left",B.fillStyle="black",this.gridOuter=new Float64Array(P*P),this.gridInner=new Float64Array(P*P),this.f=new Float64Array(P),this.z=new Float64Array(P+1),this.v=new Uint16Array(P)}_createCanvas(f){const s=document.createElement("canvas");return s.width=s.height=f,s}draw(f){const{width:s,actualBoundingBoxAscent:u,actualBoundingBoxDescent:p,actualBoundingBoxLeft:v,actualBoundingBoxRight:m}=this.ctx.measureText(f),_=Math.ceil(u),P=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-v))),O=Math.min(this.size-this.buffer,_+Math.ceil(p)),B=P+2*this.buffer,k=O+2*this.buffer,R=Math.max(B*k,0),z=new Uint8ClampedArray(R),M={data:z,width:B,height:k,glyphWidth:P,glyphHeight:O,glyphTop:_,glyphLeft:0,glyphAdvance:s};if(P===0||O===0)return M;const{ctx:L,buffer:q,gridInner:X,gridOuter:te}=this;L.clearRect(q,q,P,O),L.fillText(f,q,q+_);const le=L.getImageData(q,q,P,O);te.fill(tS,0,R),X.fill(0,0,R);for(let ce=0;ce<O;ce++)for(let ie=0;ie<P;ie++){const fe=le.data[4*(ce*P+ie)+3]/255;if(fe===0)continue;const xe=(ce+q)*B+ie+q;if(fe===1)te[xe]=0,X[xe]=tS;else{const je=.5-fe;te[xe]=je>0?je*je:0,X[xe]=je<0?je*je:0}}MF(te,0,0,B,k,B,this.f,this.v,this.z),MF(X,q,q,P,O,B,this.f,this.v,this.z);for(let ce=0;ce<R;ce++){const ie=Math.sqrt(te[ce])-Math.sqrt(X[ce]);z[ce]=Math.round(255-255*(ie/this.radius+this.cutoff))}return M}};const t0=hb;function RF(f,s){return f+s[1]-s[0]}function IF(f,s,u,p,v=1){const m=[],_=f.imagePrimary,P=_.pixelRatio,O=_.paddedRect.w-2*t0,B=_.paddedRect.h-2*t0,k=(f.right-f.left)*v,R=(f.bottom-f.top)*v,z=_.stretchX||[[0,O]],M=_.stretchY||[[0,B]],L=z.reduce(RF,0),q=M.reduce(RF,0),X=O-L,te=B-q;let le=0,ce=L,ie=0,fe=q,xe=0,je=X,Fe=0,De=te;if(_.content&&p){const et=_.content;le=rS(z,0,et[0]),ie=rS(M,0,et[1]),ce=rS(z,et[0],et[2]),fe=rS(M,et[1],et[3]),xe=et[0]-le,Fe=et[1]-ie,je=et[2]-et[0]-ce,De=et[3]-et[1]-fe}const Ie=(et,Ve,rt,ot)=>{const it=nS(et.stretch-le,ce,k,f.left*v),ct=iS(et.fixed-xe,je,et.stretch,L),ft=nS(Ve.stretch-ie,fe,R,f.top*v),xt=iS(Ve.fixed-Fe,De,Ve.stretch,q),ut=nS(rt.stretch-le,ce,k,f.left*v),Mt=iS(rt.fixed-xe,je,rt.stretch,L),qt=nS(ot.stretch-ie,fe,R,f.top*v),Et=iS(ot.fixed-Fe,De,ot.stretch,q),fr=new Rt(it,ft),lr=new Rt(ut,ft),Qt=new Rt(ut,qt),Gt=new Rt(it,qt),kr=new Rt(ct/P,xt/P),yr=new Rt(Mt/P,Et/P),_r=s*Math.PI/180;if(_r){const Bn=Math.sin(_r),Ii=Math.cos(_r),Ni=[Ii,-Bn,Bn,Ii];fr._matMult(Ni),lr._matMult(Ni),Gt._matMult(Ni),Qt._matMult(Ni)}const rn=et.stretch+et.fixed,vn=rt.stretch+rt.fixed,Sn=Ve.stretch+Ve.fixed,Nn=ot.stretch+ot.fixed,Dn=f.imageSecondary;return{tl:fr,tr:lr,bl:Gt,br:Qt,texPrimary:{x:_.paddedRect.x+t0+rn,y:_.paddedRect.y+t0+Sn,w:vn-rn,h:Nn-Sn},texSecondary:Dn?{x:Dn.paddedRect.x+t0+rn,y:Dn.paddedRect.y+t0+Sn,w:vn-rn,h:Nn-Sn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:kr,pixelOffsetBR:yr,minFontScaleX:je/P/k,minFontScaleY:De/P/R,isSDF:u}};if(p&&(_.stretchX||_.stretchY)){const et=LF(z,X,L),Ve=LF(M,te,q);for(let rt=0;rt<et.length-1;rt++){const ot=et[rt],it=et[rt+1];for(let ct=0;ct<Ve.length-1;ct++)m.push(Ie(ot,Ve[ct],it,Ve[ct+1]))}}else m.push(Ie({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:O+1},{fixed:0,stretch:B+1}));return m}function rS(f,s,u){let p=0;for(const v of f)p+=Math.max(s,Math.min(u,v[1]))-Math.max(s,Math.min(u,v[0]));return p}function LF(f,s,u){const p=[{fixed:-1,stretch:0}];for(const[v,m]of f){const _=p[p.length-1];p.push({fixed:v-_.stretch,stretch:_.stretch}),p.push({fixed:v-_.stretch,stretch:_.stretch+(m-v)})}return p.push({fixed:s+t0,stretch:u}),p}function nS(f,s,u,p){return f/s*u+p}function iS(f,s,u,p){return f-s*u/p}function Fae(f,s,u,p){const v=s+f.positionedLines[p].lineOffset;return p===0?u+v/2:u+(v+(s+f.positionedLines[p-1].lineOffset))/2}function zae(f,s=1,u=!1){let p=1/0,v=1/0,m=-1/0,_=-1/0;const P=f[0];for(let M=0;M<P.length;M++){const L=P[M];(!M||L.x<p)&&(p=L.x),(!M||L.y<v)&&(v=L.y),(!M||L.x>m)&&(m=L.x),(!M||L.y>_)&&(_=L.y)}const O=Math.min(m-p,_-v);let B=O/2;const k=new Gs([],Bae);if(O===0)return new Rt(p,v);for(let M=p;M<m;M+=O)for(let L=v;L<_;L+=O)k.push(new Fx(M+B,L+B,B,f));let R=function(M){let L=0,q=0,X=0;const te=M[0];for(let le=0,ce=te.length,ie=ce-1;le<ce;ie=le++){const fe=te[le],xe=te[ie],je=fe.x*xe.y-xe.x*fe.y;q+=(fe.x+xe.x)*je,X+=(fe.y+xe.y)*je,L+=3*je}return new Fx(q/L,X/L,0,M)}(f),z=k.length;for(;k.length;){const M=k.pop();(M.d>R.d||!R.d)&&(R=M,u&&console.log("found best %d after %d probes",Math.round(1e4*M.d)/1e4,z)),M.max-R.d<=s||(B=M.h/2,k.push(new Fx(M.p.x-B,M.p.y-B,B,f)),k.push(new Fx(M.p.x+B,M.p.y-B,B,f)),k.push(new Fx(M.p.x-B,M.p.y+B,B,f)),k.push(new Fx(M.p.x+B,M.p.y+B,B,f)),z+=4)}return u&&(console.log(`num probes: ${z}`),console.log(`best distance: ${R.d}`)),R.p}function Bae(f,s){return s.max-f.max}class Fx{constructor(s,u,p,v){this.p=new Rt(s,u),this.h=p,this.d=function(m,_){let P=!1,O=1/0;for(let B=0;B<_.length;B++){const k=_[B];for(let R=0,z=k.length,M=z-1;R<z;M=R++){const L=k[R],q=k[M];L.y>m.y!=q.y>m.y&&m.x<(q.x-L.x)*(m.y-L.y)/(q.y-L.y)+L.x&&(P=!P),O=Math.min(O,Ke(m,L,q))}}return(P?1:-1)*Math.sqrt(O)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}}const uk=Number.POSITIVE_INFINITY,Vae=Math.sqrt(2);function DF(f,[s,u]){let p=0,v=0;if(u===uk){s<0&&(s=0);const m=s/Vae;switch(f){case"top-right":case"top-left":v=m-7;break;case"bottom-right":case"bottom-left":v=7-m;break;case"bottom":v=7-s;break;case"top":v=s-7}switch(f){case"top-right":case"bottom-right":p=-m;break;case"top-left":case"bottom-left":p=m;break;case"left":p=s;break;case"right":p=-s}}else{switch(s=Math.abs(s),u=Math.abs(u),f){case"top-right":case"top-left":case"top":v=u-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-u}switch(f){case"top-right":case"bottom-right":case"right":p=-s;break;case"top-left":case"bottom-left":case"left":p=s}}return[p,v]}function dk(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Uae(f,s,u,p,v,m,_,P,O,B,k,R,z,M,L){let q=m.textMaxSize.evaluate(s,{},R);q===void 0?q=_*m.textScaleFactor:q*=m.textScaleFactor;const X=f.layers[0].layout,te=X.get("icon-offset").evaluate(s,{},R),le=zF(u.horizontal)||u.vertical,ce=z.name==="globe",ie=Uo,fe=_*m.textScaleFactor/ie,xe=f.tilePixelRatio*q/ie,je=(it=f.overscaling,f.zoom>18&&it>2&&(it>>=1),Math.max(cr/(512*it),1)*X.get("symbol-spacing")),Fe=X.get("text-padding")*f.tilePixelRatio,De=X.get("icon-padding")*f.tilePixelRatio,Ie=dt(X.get("text-max-angle")),et=X.get("text-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",Ve=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",rt=X.get("symbol-placement"),ot=je/2;var it;const ct=X.get("icon-text-fit").evaluate(s,{},R),ft=X.get("icon-text-fit-padding").evaluate(s,{},R),xt=ct!=="none";let ut;f.hasAnyIconTextFit===!1&&xt&&(f.hasAnyIconTextFit=!0),p&&xt&&(f.allowVerticalPlacement&&u.vertical&&(ut=SF(p,u.vertical,ct,ft,te,fe)),le&&(p=SF(p,le,ct,ft,te,fe)));const Mt=(qt,Et,fr)=>{if(Et.x<0||Et.x>=cr||Et.y<0||Et.y>=cr)return;let lr=null;if(ce){const{x:Qt,y:Gt,z:kr}=z.projectTilePoint(Et.x,Et.y,fr);lr={anchor:new am(Qt,Gt,kr,0,void 0),up:z.upVector(fr,Et.x,Et.y)}}(function(Qt,Gt,kr,yr,_r,rn,vn,Sn,Nn,Dn,Bn,Ii,Ni,fn,yi,bi,Qi,Ua,fs,$a,Pa,Ya,Ns,$o,Hi,mc,Oh){const Sd=Qt.addToLineVertexArray(Gt,yr);let Nd,s0,Og,o0,Mb,vB,_B,bB=0,wB=0,SB=0,NB=0,Wk=-1,Hk=-1;const Bf={};let AB=vl("");const l0=kr?kr.anchor:Gt,Kk=Nn.layout.get("icon-text-fit").evaluate(Pa,{},Hi)!=="none";let Zk=0,Yk=0;if(Nn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Zk,Yk]=Nn.layout.get("text-offset").evaluate(Pa,{},Hi).map(ku=>ku*Uo):(Zk=Nn.layout.get("text-radial-offset").evaluate(Pa,{},Hi)*Uo,Yk=uk),Qt.allowVerticalPlacement&&_r.vertical){const ku=_r.vertical;if(yi)vB=hk(ku),Sn&&(_B=hk(Sn));else{const gc=Nn.layout.get("text-rotate").evaluate(Pa,{},Hi)+90;Og=aS(Dn,l0,Gt,Bn,Ii,Ni,ku,fn,gc,bi),Sn&&(o0=aS(Dn,l0,Gt,Bn,Ii,Ni,Sn,Ua,gc))}}if(rn){const ku=Qt.iconSizeData,gc=Nn.layout.get("icon-rotate").evaluate(Pa,{},Hi),Ob=IF(rn,gc,Ns,Kk,Ya.iconScaleFactor),Jk=Sn?IF(Sn,gc,Ns,Kk,Ya.iconScaleFactor):void 0;s0=aS(Dn,l0,Gt,Bn,Ii,Ni,rn,Ua,gc,null),bB=4*Ob.length;let c0=null;ku.kind==="source"?(c0=[kh*Nn.layout.get("icon-size").evaluate(Pa,{},Hi)*Ya.iconScaleFactor],c0[0]>Pg&&ln(`${Qt.layerIds[0]}: Value for "icon-size" is >= ${pb}. Reduce your "icon-size".`)):ku.kind==="composite"&&(c0=[kh*Ya.compositeIconSizes[0].evaluate(Pa,{},Hi)*Ya.iconScaleFactor,kh*Ya.compositeIconSizes[1].evaluate(Pa,{},Hi)*Ya.iconScaleFactor],(c0[0]>Pg||c0[1]>Pg)&&ln(`${Qt.layerIds[0]}: Value for "icon-size" is >= ${pb}. Reduce your "icon-size".`)),Qt.addSymbols(Qt.icon,Ob,c0,$a,fs,Pa,!1,kr,Gt,Sd.lineStartIndex,Sd.lineLength,-1,$o,Hi,mc,Oh),Wk=Qt.icon.placedSymbolArray.length-1,Jk&&(wB=4*Jk.length,Qt.addSymbols(Qt.icon,Jk,c0,$a,fs,Pa,Tu.vertical,kr,Gt,Sd.lineStartIndex,Sd.lineLength,-1,$o,Hi,mc,Oh),Hk=Qt.icon.placedSymbolArray.length-1)}for(const ku in _r.horizontal){const gc=_r.horizontal[ku];Nd||(AB=vl(gc.text),yi?Mb=hk(gc):Nd=aS(Dn,l0,Gt,Bn,Ii,Ni,gc,fn,Nn.layout.get("text-rotate").evaluate(Pa,{},Hi),bi));const Ob=gc.positionedLines.length===1;if(SB+=FF(Qt,kr,Gt,gc,vn,Nn,yi,Pa,bi,Sd,_r.vertical?Tu.horizontal:Tu.horizontalOnly,Ob?Object.keys(_r.horizontal):[ku],Bf,Wk,Ya,$o,Hi,mc),Ob)break}_r.vertical&&(NB+=FF(Qt,kr,Gt,_r.vertical,vn,Nn,yi,Pa,bi,Sd,Tu.vertical,["vertical"],Bf,Hk,Ya,$o,Hi,mc));let Rg=-1;const Xk=(ku,gc)=>ku?Math.max(ku,gc):gc;Rg=Xk(Mb,Rg),Rg=Xk(vB,Rg),Rg=Xk(_B,Rg);const boe=Rg>-1?1:0;Qt.glyphOffsetArray.length>=65535&&ln("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Pa.sortKey!==void 0&&Qt.addToSortKeyRanges(Qt.symbolInstances.length,Pa.sortKey),Qt.symbolInstances.emplaceBack(Gt.x,Gt.y,l0.x,l0.y,l0.z,Bf.right>=0?Bf.right:-1,Bf.center>=0?Bf.center:-1,Bf.left>=0?Bf.left:-1,Bf.vertical>=0?Bf.vertical:-1,Wk,Hk,AB,Nd!==void 0?Nd:Qt.collisionBoxArray.length,Nd!==void 0?Nd+1:Qt.collisionBoxArray.length,Og!==void 0?Og:Qt.collisionBoxArray.length,Og!==void 0?Og+1:Qt.collisionBoxArray.length,s0!==void 0?s0:Qt.collisionBoxArray.length,s0!==void 0?s0+1:Qt.collisionBoxArray.length,o0||Qt.collisionBoxArray.length,o0?o0+1:Qt.collisionBoxArray.length,Bn,SB,NB,bB,wB,boe,0,Zk,Yk,Rg,0,Kk?1:0)})(f,Et,lr,qt,u,p,v,ut,f.layers[0],f.collisionBoxArray,s.index,s.sourceLayerIndex,f.index,Fe,et,O,0,De,Ve,te,s,m,B,k,R,M,L)};if(rt==="line")for(const qt of PF(s.geometry,0,0,cr,cr)){const Et=Dae(qt,je,Ie,u.vertical||le,p,ie,xe,f.overscaling,cr);for(const fr of Et)le&&$ae(f,le.text,ot,fr)||Mt(qt,fr,R)}else if(rt==="line-center"){for(const qt of s.geometry)if(qt.length>1){const Et=Lae(qt,Ie,u.vertical||le,p,ie,xe);Et&&Mt(qt,Et,R)}}else if(s.type==="Polygon")for(const qt of Tr(s.geometry,0)){const Et=zae(qt,16);Mt(qt[0],new am(Et.x,Et.y,0,0,void 0),R)}else if(s.type==="LineString")for(const qt of s.geometry)Mt(qt,new am(qt[0].x,qt[0].y,0,0,void 0),R);else if(s.type==="Point")for(const qt of s.geometry)for(const Et of qt)Mt([Et],new am(Et.x,Et.y,0,0,void 0),R)}const pb=255,Pg=pb*kh;function FF(f,s,u,p,v,m,_,P,O,B,k,R,z,M,L,q,X,te){const le=function(fe,xe,je,Fe,De,Ie,et,Ve){const rt=[];if(xe.positionedLines.length===0)return rt;const ot=Fe.layout.get("text-rotate").evaluate(Ie,{})*Math.PI/180,it=function(Mt){const qt=Mt[0],Et=Mt[1],fr=qt*Et;return fr>0?[qt,-Et]:fr<0?[-qt,Et]:qt===0?[Et,qt]:[Et,-qt]}(je);let ct=Math.abs(xe.top-xe.bottom);for(const Mt of xe.positionedLines)ct-=Mt.lineOffset;const ft=xe.positionedLines.length,xt=ct/ft;let ut=xe.top-je[1];for(let Mt=0;Mt<ft;++Mt){const qt=xe.positionedLines[Mt];ut=Fae(xe,xt,ut,Mt);for(const Et of qt.positionedGlyphs){if(!Et.rect)continue;const fr=Et.rect||{};let lr=Mae+1,Qt=!0,Gt=1,kr=0;if(Et.imageName){const $a=et[Rs.build(Et.imageName).getSerializedPrimary()];if(!$a)continue;if($a.sdf){ln("SDF images are not supported in formatted text and will be ignored.");continue}Qt=!1,Gt=$a.pixelRatio,lr=hb/Gt}const yr=(De||Ve)&&Et.vertical,_r=Et.metrics.advance*Et.scale/2,rn=Et.metrics,vn=Et.rect;if(vn===null)continue;Ve&&xe.verticalizable&&(kr=Et.imageName?_r-Et.metrics.width*Et.scale/2:0);const Sn=De?[Et.x+_r,Et.y]:[0,0];let Nn=[0,0],Dn=[0,0],Bn=!1;De||(yr?(Dn=[Et.x+_r+it[0],Et.y+it[1]-kr],Bn=!0):Nn=[Et.x+_r+je[0],Et.y+je[1]-kr]);const Ii=vn.w*Et.scale/(Gt*(Et.localGlyph?Ph:1)),Ni=vn.h*Et.scale/(Gt*(Et.localGlyph?Ph:1));let fn,yi,bi,Qi;if(yr){const $a=Et.y-ut,Pa=new Rt(-_r,_r-$a),Ya=-Math.PI/2,Ns=new Rt(...Dn);fn=new Rt(-_r+Nn[0],Nn[1]),fn._rotateAround(Ya,Pa)._add(Ns),fn.x+=-$a+_r,fn.y-=(rn.left-lr)*Et.scale;const $o=Et.imageName?rn.advance*Et.scale:Uo*Et.scale,Hi=String.fromCodePoint(Et.glyph);Tae(Hi)?fn.x+=(1-lr)*Et.scale:jae(Hi)?fn.x+=$o-rn.height*Et.scale+(-lr-1)*Et.scale:fn.x+=Et.imageName||rn.width+2*lr===vn.w&&rn.height+2*lr===vn.h?($o-Ni)/2:($o-(rn.height+2*lr)*Et.scale)/2,yi=new Rt(fn.x,fn.y-Ii),bi=new Rt(fn.x+Ni,fn.y),Qi=new Rt(fn.x+Ni,fn.y-Ii)}else{const $a=(rn.left-lr)*Et.scale-_r+Nn[0],Pa=(-rn.top-lr)*Et.scale+Nn[1],Ya=$a+Ii,Ns=Pa+Ni;fn=new Rt($a,Pa),yi=new Rt(Ya,Pa),bi=new Rt($a,Ns),Qi=new Rt(Ya,Ns)}if(ot){let $a;$a=De?new Rt(0,0):Bn?new Rt(it[0],it[1]):new Rt(je[0],je[1]),fn._rotateAround(ot,$a),yi._rotateAround(ot,$a),bi._rotateAround(ot,$a),Qi._rotateAround(ot,$a)}const Ua=new Rt(0,0),fs=new Rt(0,0);rt.push({tl:fn,tr:yi,bl:bi,br:Qi,texPrimary:fr,texSecondary:void 0,writingMode:xe.writingMode,glyphOffset:Sn,sectionIndex:Et.sectionIndex,isSDF:Qt,pixelOffsetTL:Ua,pixelOffsetBR:fs,minFontScaleX:0,minFontScaleY:0})}}return rt}(0,p,O,m,_,P,v,f.allowVerticalPlacement),ce=f.textSizeData;let ie=null;ce.kind==="source"?(ie=[kh*m.layout.get("text-size").evaluate(P,{},X)*L.textScaleFactor],ie[0]>Pg&&ln(`${f.layerIds[0]}: Value for "text-size" is >= ${pb}. Reduce your "text-size".`)):ce.kind==="composite"&&(ie=[kh*L.compositeTextSizes[0].evaluate(P,{},X)*L.textScaleFactor,kh*L.compositeTextSizes[1].evaluate(P,{},X)*L.textScaleFactor],(ie[0]>Pg||ie[1]>Pg)&&ln(`${f.layerIds[0]}: Value for "text-size" is >= ${pb}. Reduce your "text-size".`)),f.addSymbols(f.text,le,ie,O,_,P,k,s,u,B.lineStartIndex,B.lineLength,M,q,X,te,!1);for(const fe of R)z[fe]=f.text.placedSymbolArray.length-1;return 4*le.length}function zF(f){for(const s in f)return f[s];return null}function aS(f,s,u,p,v,m,_,P,O,B){let k=_.top,R=_.bottom,z=_.left,M=_.right;const L=_.collisionPadding;if(L&&(z-=L[0],k-=L[1],M+=L[2],R+=L[3]),O){const q=new Rt(z,k),X=new Rt(M,k),te=new Rt(z,R),le=new Rt(M,R),ce=dt(O);let ie=new Rt(0,0);B&&(ie=new Rt(B[0],B[1])),q._rotateAround(ce,ie),X._rotateAround(ce,ie),te._rotateAround(ce,ie),le._rotateAround(ce,ie),z=Math.min(q.x,X.x,te.x,le.x),M=Math.max(q.x,X.x,te.x,le.x),k=Math.min(q.y,X.y,te.y,le.y),R=Math.max(q.y,X.y,te.y,le.y)}return f.emplaceBack(s.x,s.y,s.z,u.x,u.y,z,k,M,R,P,p,v,m),f.length-1}function hk(f){f.collisionPadding&&(f.top-=f.collisionPadding[1],f.bottom+=f.collisionPadding[3]);const s=f.bottom-f.top;return s>0?Math.max(10,s):null}function $ae(f,s,u,p){const v=f.compareText;if(s in v){const m=v[s];for(let _=m.length-1;_>=0;_--)if(p.dist(m[_])<u)return!0}else v[s]=[];return v[s].push(p),!1}function BF(f,s){const u=f.fovAboveCenter,p=f.elevation?f.elevation.getMinElevationBelowMSL()*s:0,v=(f._camera.position[2]*f.worldSize-p)/Math.cos(f._pitch),m=Math.sin(u)*v/Math.sin(Math.max(Math.PI/2-f._pitch-u,.01));let _=Math.sin(f._pitch)*m+v;const P=v*(1/f._horizonShift);if(!f.elevation||f.elevation.exaggeration()===0){let O=Math.max(f.zoom-17,0);f.isOrthographic&&(O/=10),_*=1+O}return Math.min(1.01*_,P)}function mb(f,s){if(!s.isReprojectedInTileSpace)return{scale:1<<f.z,x:f.x,y:f.y,x2:f.x+1,y2:f.y+1,projection:s};const u=Math.pow(2,-f.z),p=f.x*u,v=(f.x+1)*u,m=f.y*u,_=(f.y+1)*u,P=ol(p),O=ol(v),B=Br(m),k=Br(_),R=s.project(P,B),z=s.project(O,B),M=s.project(O,k),L=s.project(P,k);let q=Math.min(R.x,z.x,M.x,L.x),X=Math.min(R.y,z.y,M.y,L.y),te=Math.max(R.x,z.x,M.x,L.x),le=Math.max(R.y,z.y,M.y,L.y);const ce=u/16;function ie(xe,je,Fe,De,Ie,et){const Ve=(Fe+Ie)/2,rt=(De+et)/2,ot=s.project(ol(Ve),Br(rt)),it=Math.max(0,q-ot.x,X-ot.y,ot.x-te,ot.y-le);q=Math.min(q,ot.x),te=Math.max(te,ot.x),X=Math.min(X,ot.y),le=Math.max(le,ot.y),it>ce&&(ie(xe,ot,Fe,De,Ve,rt),ie(ot,je,Ve,rt,Ie,et))}ie(R,z,p,m,v,m),ie(z,M,v,m,v,_),ie(M,L,v,_,p,_),ie(L,R,p,_,p,m),q-=ce,X-=ce,te+=ce,le+=ce;const fe=1/Math.max(te-q,le-X);return{scale:fe,x:q*fe,y:X*fe,x2:te*fe,y2:le*fe,projection:s}}function VF(f,{x:s,y:u},p=0){return new Rt(((s-p)*f.scale-f.x)*cr,(u*f.scale-f.y)*cr)}const qae=ze.mat4.identity(new Float32Array(16));class Cg{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,u){return{x:0,y:0,z:0}}unproject(s,u){return new Kn(0,0)}projectTilePoint(s,u,p){return{x:s,y:u,z:0}}locationPoint(s,u,p=!0){return s._coordinatePoint(s.locationCoordinate(u),p)}pixelsPerMeter(s,u){return Gi(1,s)*u}pixelSpaceConversion(s,u,p){return 1}farthestPixelDistance(s){return BF(s,s.pixelsPerMeter)}pointCoordinate(s,u,p,v){const m=s.horizonLineFromTop(!1),_=new Rt(u,Math.max(m,p));return s.rayIntersectionCoordinate(s.pointRayIntersection(_,v))}pointCoordinate3D(s,u,p){const v=new Rt(u,p);if(s.elevation)return s.elevation.pointCoordinate(v);{const m=this.pointCoordinate(s,v.x,v.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(s,u){if(s.elevation&&s.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(s,u.x,u.y);const p=s.horizonLineFromTop();return u.y<p}createInversionMatrix(s,u){return qae}createTileMatrix(s,u,p){let v,m,_;const P=p.canonical,O=ze.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const B=mb(P,this);v=1,m=B.x+p.wrap*B.scale,_=B.y,ze.mat4.scale(O,O,[v/B.scale,v/B.scale,s.pixelsPerMeter/u])}else v=u/s.zoomScale(P.z),m=(P.x+Math.pow(2,P.z)*p.wrap)*v,_=P.y*v;return ze.mat4.translate(O,O,[m,_,0]),ze.mat4.scale(O,O,[v/cr,v/cr,1]),O}upVector(s,u,p){return[0,0,1]}upVectorScale(s,u,p){return{metersToTile:1}}}class Gae extends Cg{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[u,p]=this.parallels=s.parallels||[29.5,45.5],v=Math.sin(dt(u));this.n=(v+Math.sin(dt(p)))/2,this.c=1+v*(2*this.n-v),this.r0=Math.sqrt(this.c)/this.n}project(s,u){const{n:p,c:v,r0:m}=this,_=dt(s-this.center[0]),P=dt(u),O=Math.sqrt(v-2*p*Math.sin(P))/p;return{x:O*Math.sin(_*p),y:O*Math.cos(_*p)-m,z:0}}unproject(s,u){const{n:p,c:v,r0:m}=this,_=m+u;let P=Math.atan2(s,Math.abs(_))*Math.sign(_);_*p<0&&(P-=Math.PI*Math.sign(s)*Math.sign(_));const O=dt(this.center[0])*p;P=Ai(P,-Math.PI-O,Math.PI-O);const B=pr(Ot(P/p)+this.center[0],-180,180),k=Math.asin(pr((v-(s*s+_*_)*p*p)/(2*p),-1,1)),R=pr(Ot(k),-85.051129,oo);return new Kn(B,R)}}const gb=1.340264,yb=-.081106,xb=893e-6,vb=.003796,sS=Math.sqrt(3)/2;class Wae extends Cg{project(s,u){u=u/180*Math.PI,s=s/180*Math.PI;const p=Math.asin(sS*Math.sin(u)),v=p*p,m=v*v*v;return{x:.5*(s*Math.cos(p)/(sS*(gb+3*yb*v+m*(7*xb+9*vb*v)))/Math.PI+.5),y:1-.5*(p*(gb+yb*v+m*(xb+vb*v))/Math.PI+1),z:0}}unproject(s,u){s=(2*s-.5)*Math.PI;let p=u=(2*(1-u)-1)*Math.PI,v=p*p,m=v*v*v;for(let k,R,z,M=0;M<12&&(R=p*(gb+yb*v+m*(xb+vb*v))-u,z=gb+3*yb*v+m*(7*xb+9*vb*v),k=R/z,p=pr(p-k,-Math.PI/3,Math.PI/3),v=p*p,m=v*v*v,!(Math.abs(k)<1e-12));++M);const _=sS*s*(gb+3*yb*v+m*(7*xb+9*vb*v))/Math.cos(p),P=Math.asin(Math.sin(p)/sS),O=pr(180*_/Math.PI,-180,180),B=pr(180*P/Math.PI,-85.051129,oo);return new Kn(O,B)}}class Hae extends Cg{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,u){return{x:.5+s/360,y:.5-u/360,z:0}}unproject(s,u){const p=360*(s-.5),v=pr(360*(.5-u),-85.051129,oo);return new Kn(p,v)}}const zx=Math.PI/2;function oS(f){return Math.tan((zx+f)/2)}class Kae extends Cg{constructor(s){super(s),this.center=s.center||[0,30];const[u,p]=this.parallels=s.parallels||[30,30];let v=dt(u),m=dt(p);this.southernCenter=v+m<0,this.southernCenter&&(v=-v,m=-m);const _=Math.cos(v),P=oS(v);this.n=v===m?Math.sin(v):Math.log(_/Math.cos(m))/Math.log(oS(m)/P),this.f=_*Math.pow(oS(v),this.n)/this.n}project(s,u){u=dt(u),this.southernCenter&&(u=-u),s=dt(s-this.center[0]);const p=1e-6,{n:v,f:m}=this;m>0?u<-zx+p&&(u=-zx+p):u>zx-p&&(u=zx-p);const _=m/Math.pow(oS(u),v);let P=_*Math.sin(v*s),O=m-_*Math.cos(v*s);return P=.5*(P/Math.PI+.5),O=.5*(O/Math.PI+.5),{x:P,y:this.southernCenter?O:1-O,z:0}}unproject(s,u){s=(2*s-.5)*Math.PI,this.southernCenter&&(u=1-u),u=(2*(1-u)-.5)*Math.PI;const{n:p,f:v}=this,m=v-u,_=Math.sign(m),P=Math.sign(p)*Math.sqrt(s*s+m*m);let O=Math.atan2(s,Math.abs(m))*_;m*p<0&&(O-=Math.PI*Math.sign(s)*_);const B=pr(Ot(O/p)+this.center[0],-180,180),k=pr(Ot(2*Math.atan(Math.pow(v/P,1/p))-zx),-85.051129,oo);return new Kn(B,this.southernCenter?-k:k)}}class UF extends Cg{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,u){return{x:Gc(s),y:sl(u),z:0}}unproject(s,u){const p=ol(s),v=Br(u);return new Kn(p,v)}}const $F=dt(oo);class Zae extends Cg{project(s,u){const p=(u=dt(u))*u,v=p*p;return{x:.5*((s=dt(s))*(.8707-.131979*p+v*(v*(.003971*p-.001529*v)-.013791))/Math.PI+.5),y:1-.5*(u*(1.007226+p*(.015085+v*(.028874*p-.044475-.005916*v)))/Math.PI+1),z:0}}unproject(s,u){s=(2*s-.5)*Math.PI;let p=u=(2*(1-u)-1)*Math.PI,v=25,m=0,_=p*p;do{_=p*p;const B=_*_;m=(p*(1.007226+_*(.015085+B*(.028874*_-.044475-.005916*B)))-u)/(1.007226+_*(.045255+B*(.259866*_-.311325-.005916*11*B))),p=pr(p-m,-$F,$F)}while(Math.abs(m)>1e-6&&--v>0);_=p*p;const P=pr(Ot(s/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),O=Ot(p);return new Kn(P,O)}}const qF=dt(oo);class Yae extends Cg{project(s,u){u=dt(u),s=dt(s);const p=Math.cos(u),v=2/Math.PI,m=Math.acos(p*Math.cos(s/2)),_=Math.sin(m)/m,P=.5*(s*v+2*p*Math.sin(s/2)/_)||0,O=.5*(u+Math.sin(u)/_)||0;return{x:.5*(P/Math.PI+.5),y:1-.5*(O/Math.PI+1),z:0}}unproject(s,u){let p=s=(2*s-.5)*Math.PI,v=u=(2*(1-u)-1)*Math.PI,m=25;const _=1e-6;let P=0,O=0;do{const B=Math.cos(v),k=Math.sin(v),R=2*k*B,z=k*k,M=B*B,L=Math.cos(p/2),q=Math.sin(p/2),X=2*L*q,te=q*q,le=1-M*L*L,ce=le?1/le:0,ie=le?Math.acos(B*L)*Math.sqrt(1/le):0,fe=.5*(2*ie*B*q+2*p/Math.PI)-s,xe=.5*(ie*k+v)-u,je=.5*ce*(M*te+ie*B*L*z)+1/Math.PI,Fe=ce*(X*R/4-ie*k*q),De=.125*ce*(R*q-ie*k*M*X),Ie=.5*ce*(z*L+ie*te*B)+.5,et=Fe*De-Ie*je;P=(xe*Fe-fe*Ie)/et,O=(fe*De-xe*je)/et,p=pr(p-P,-Math.PI,Math.PI),v=pr(v-O,-qF,qF)}while((Math.abs(P)>_||Math.abs(O)>_)&&--m>0);return new Kn(Ot(p),Ot(v))}}class GF extends Cg{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(dt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,u){const{scale:p,cosPhi:v}=this;return{x:dt(s)*v*p+.5,y:-Math.sin(dt(u))/v*p+.5,z:0}}unproject(s,u){const{scale:p,cosPhi:v}=this,m=-(u-.5)/p,_=pr(Ot((s-.5)/p)/v,-180,180),P=Math.asin(pr(m*v,-1,1)),O=pr(Ot(P),-85.051129,oo);return new Kn(_,O)}}class Xae extends UF{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,u,p){const v=_i(s,u,p),m=ds(La(p));return ze.vec3.transformMat4(v,v,m),{x:v[0],y:v[1],z:v[2]}}locationPoint(s,u){const p=Sh(u.lat,u.lng),v=ze.vec3.normalize([],p),m=s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(u),s._centerAltitude):s._centerAltitude,_=Gi(1,0)*cr*m;ze.vec3.scaleAndAdd(p,p,v,_);const P=ze.mat4.identity(new Float64Array(16));return ze.mat4.multiply(P,s.pixelMatrix,s.globeMatrix),ze.vec3.transformMat4(p,p,P),new Rt(p[0],p[1])}pixelsPerMeter(s,u){return Gi(1,0)*u}pixelSpaceConversion(s,u,p){const v=Gi(1,s)*u,m=Fr(Gi(1,45)*u,v,p);return this.pixelsPerMeter(s,u)/m}createTileMatrix(s,u,p){const v=ji(La(p.canonical));return ze.mat4.multiply(new Float64Array(16),s.globeMatrix,v)}createInversionMatrix(s,u){const{center:p}=s,v=ds(La(u));return ze.mat4.rotateY(v,v,dt(p.lng)),ze.mat4.rotateX(v,v,dt(p.lat)),ze.mat4.scale(v,v,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(v)}pointCoordinate(s,u,p,v){return ai(s,u,p,!0)||new d(0,0)}pointCoordinate3D(s,u,p){const v=this.pointCoordinate(s,u,p,0);return[v.x,v.y,v.z]}isPointAboveHorizon(s,u){return!ai(s,u.x,u.y,!1)}farthestPixelDistance(s){const u=function(v,m){const _=v.cameraToCenterDistance,P=v._centerAltitude*m,O=v._camera,B=v._camera.forward(),k=ze.vec3.add([],ze.vec3.scale([],B,-_),[0,0,P]),R=v.worldSize/(2*Math.PI),z=[0,0,-R],M=v.width/v.height,L=Math.tan(v.fovAboveCenter),q=ze.vec3.scale([],O.up(),L),X=ze.vec3.scale([],O.right(),L*M),te=ze.vec3.normalize([],ze.vec3.add([],ze.vec3.add([],B,q),X)),le=[];let ce;if(new Zr(k,te).closestPointOnSphere(z,R,le)){const ie=ze.vec3.add([],le,z),fe=ze.vec3.sub([],ie,k);ce=Math.cos(v.fovAboveCenter)*ze.vec3.length(fe)}else{const ie=ze.vec3.sub([],k,z),fe=ze.vec3.sub([],z,k);ze.vec3.normalize(fe,fe);const xe=ze.vec3.length(ie)-R;ce=Math.sqrt(xe*(xe+2*R));const je=Math.acos(ce/(R+xe))-Math.acos(ze.vec3.dot(B,fe));ce*=Math.cos(je)}return 1.01*ce}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),p=Bo(s.zoom);if(p>0){const v=BF(s,Gi(1,s.center.lat)*s.worldSize),m=s.worldSize/(2*Math.PI),_=Math.max(s.width,s.height)/s.worldSize*Math.PI;return Fr(u,v+m*(1-Math.cos(_)),Math.pow(p,10))}return u}upVector(s,u,p){return _i(u,p,s,1)}upVectorScale(s){return{metersToTile:In(Fn(La(s)))}}}function WF(f){const s=f.parallels,u=!!s&&Math.abs(s[0]+s[1])<.01;switch(f.name){case"mercator":return new UF(f);case"equirectangular":return new Hae(f);case"naturalEarth":return new Zae(f);case"equalEarth":return new Wae(f);case"winkelTripel":return new Yae(f);case"albers":return u?new GF(f):new Gae(f);case"lambertConformalConic":return u?new GF(f):new Kae(f);case"globe":return new Xae(f)}throw new Error(`Invalid projection name: ${f.name}`)}const Jae=Rx.VectorTileFeature.types,Qae=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function lS(f,s,u,p,v,m,_,P,O,B,k,R,z){const M=P?Math.min(Pg,Math.round(P[0])):0,L=P?Math.min(Pg,Math.round(P[1])):0;f.emplaceBack(s,u,Math.round(32*p),Math.round(32*v),m,_,(M<<1)+(O?1:0),L,16*B,16*k,256*R,256*z)}function cS(f,s,u){f.emplaceBack(s,u)}function uS(f,s,u,p,v,m,_){f.emplaceBack(s,u,p,v,m,_)}function dS(f,s,u,p,v){f.emplaceBack(s,u,p,v),f.emplaceBack(s,u,p,v),f.emplaceBack(s,u,p,v),f.emplaceBack(s,u,p,v)}function ese(f){for(const s of f.sections)if(ag(s.text))return!0;return!1}class fk{constructor(s){this.layoutVertexArray=new Gp,this.indexArray=new bs,this.programConfigurations=s,this.segments=new Na,this.dynamicLayoutVertexArray=new _u,this.opacityVertexArray=new Hl,this.placedSymbolArray=new Uy,this.iconTransitioningVertexArray=new Ls,this.globeExtVertexArray=new Wp,this.zOffsetVertexArray=new Af}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(s,u,p,v,m){this.isEmpty()||(p&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,gae.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,xae.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,Qae,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=s.createVertexBuffer(this.iconTransitioningVertexArray,_ae.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,yae.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||m)&&(this.zOffsetVertexBuffer=s.createVertexBuffer(this.zOffsetVertexArray,vae.members,!0)),this.opacityVertexBuffer.itemSize=1),(p||v)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}mr(fk,"SymbolBuffers");class pk{constructor(s,u,p){this.layoutVertexArray=new s,this.layoutAttributes=u,this.indexArray=new p,this.segments=new Na,this.collisionVertexArray=new hg,this.collisionVertexArrayExt=new _u}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,bae.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,wae.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}mr(pk,"CollisionBuffers");class hS{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.lut=s.lut,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(_=>_.fqid),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ze.mat4.identity([]),this.placementViewportMatrix=ze.mat4.identity([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=nk(this.zoom,u["text-size"]),this.iconSizeData=nk(this.zoom,u["icon-size"]);const p=this.layers[0].layout,v=p.get("symbol-sort-key"),m=p.get("symbol-z-order");this.canOverlap=p.get("text-allow-overlap")||p.get("icon-allow-overlap")||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&v.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=p.get("text-writing-mode").map(_=>Tu[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=s.sourceID,this.projection=s.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=p.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new fk(new Nu(this.layers,{zoom:this.zoom,lut:this.lut},s=>s.startsWith("text")||s.startsWith("symbol"))),this.icon=new fk(new Nu(this.layers,{zoom:this.zoom,lut:this.lut},s=>s.startsWith("icon")||s.startsWith("symbol"))),this.glyphOffsetArray=new bx,this.lineVertexArray=new Gy,this.symbolInstances=new qy}calculateGlyphDependencies(s,u,p,v,m){for(const _ of s){const P=_.codePointAt(0);if(P===void 0)break;if(u[P]=!0,v&&m&&P<=65535){const O=ub[_];O&&(u[O.charCodeAt(0)]=!0)}}}updateFootprints(s,u){}updateReplacement(s,u){if(u.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=u.updateTime;const p=u.getReplacementRegionsForTile(s.toUnwrapped(),!0);return!Zj(this.activeReplacements,p)&&(this.activeReplacements=p,!0)}populate(s,u,p,v){const m=this.layers[0],_=m.layout,P=this.projection.name==="globe",O=_.get("text-font"),B=_.get("text-field"),k=_.get("icon-image"),[R,z]=_.get("icon-size-scale-range"),M=pr(u.scaleFactor||1,R,z),L=(B.value.kind!=="constant"||B.value.value instanceof Os&&!B.value.value.isEmpty()||B.value.value.toString().length>0)&&(O.value.kind!=="constant"||O.value.value.length>0),q=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,X=_.get("symbol-sort-key");if(this.features=[],!L&&!q)return;const te=u.iconDependencies,le=u.glyphDependencies,ce=u.availableImages,ie=new vi(this.zoom);for(const{feature:fe,id:xe,index:je,sourceLayerIndex:Fe}of s){const De=m._featureFilter.needGeometry,Ie=re(fe,De);if(!m._featureFilter.filter(ie,Ie,p))continue;if(De||(Ie.geometry=Y(fe,p,v)),P&&fe.type!==1&&p.z<=5){const it=Ie.geometry,ct=.98078528056,ft=(xt,ut)=>{const Mt=_i(xt.x,xt.y,p,1),qt=_i(ut.x,ut.y,p,1);return ze.vec3.dot(Mt,qt)<ct};for(let xt=0;xt<it.length;xt++)it[xt]=C(it[xt],ft)}let et,Ve;if(L){const it=m.getValueAndResolveTokens("text-field",Ie,p,ce),ct=Os.factory(it);ese(ct)&&(this.hasRTLText=!0),(!this.hasRTLText||hh()==="unavailable"||this.hasRTLText&&tl.isParsed())&&(et=Aae(ct,m,Ie))}if(q){const it=m.getValueAndResolveTokens("icon-image",Ie,p,ce);Ve=it instanceof Rs?it:Rs.build(it)}if(!et&&!Ve)continue;const rt=this.sortFeaturesByKey?X.evaluate(Ie,{},p):void 0,ot={id:xe,text:et,icon:Ve,index:je,sourceLayerIndex:Fe,geometry:Ie.geometry,properties:fe.properties,type:Jae[fe.type],sortKey:rt};if(this.features.push(ot),Ve){const it=rk(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],p,this.zoom,ot)*M*this.pixelRatio,ct=Ve.getPrimary().scaleSelf(it);if(te[ct.id]=te[ct.id]||[],te[ct.id].push(ct),Ve.nameSecondary){const ft=Ve.getSecondary().scaleSelf(it);te[ft.id]=te[ft.id]||[],te[ft.id].push(ft)}}if(et){const it=O.evaluate(Ie,{},p).join(","),ct=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Tu.vertical)>=0;for(const ft of et.sections)if(ft.image){const xt=ft.image.getPrimary().scaleSelf(this.pixelRatio);te[xt.id]=te[xt.id]||[],te[xt.id].push(xt)}else{const xt=Vp(et.toString()),ut=ft.fontStack||it,Mt=le[ut]=le[ut]||{};this.calculateGlyphDependencies(ft.text,Mt,ct,this.allowVerticalPlacement,xt)}}}_.get("symbol-placement")==="line"&&(this.features=function(fe){const xe={},je={},Fe=[];let De=0;function Ie(ot){Fe.push(fe[ot]),De++}function et(ot,it,ct){const ft=je[ot];return delete je[ot],je[it]=ft,Fe[ft].geometry[0].pop(),Fe[ft].geometry[0]=Fe[ft].geometry[0].concat(ct[0]),ft}function Ve(ot,it,ct){const ft=xe[it];return delete xe[it],xe[ot]=ft,Fe[ft].geometry[0].shift(),Fe[ft].geometry[0]=ct[0].concat(Fe[ft].geometry[0]),ft}function rt(ot,it,ct){const ft=ct?it[0][it[0].length-1]:it[0][0];return`${ot}:${ft.x}:${ft.y}`}for(let ot=0;ot<fe.length;ot++){const it=fe[ot],ct=it.geometry,ft=it.text?it.text.toString():null;if(!ft){Ie(ot);continue}const xt=rt(ft,ct),ut=rt(ft,ct,!0);if(xt in je&&ut in xe&&je[xt]!==xe[ut]){const Mt=Ve(xt,ut,ct),qt=et(xt,ut,Fe[Mt].geometry);delete xe[xt],delete je[ut],je[rt(ft,Fe[qt].geometry,!0)]=qt,Fe[Mt].geometry=null}else xt in je?et(xt,ut,ct):ut in xe?Ve(xt,ut,ct):(Ie(ot),xe[xt]=De-1,je[ut]=De-1)}return Fe.filter(ot=>ot.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((fe,xe)=>fe.sortKey-xe.sortKey)}update(s,u,p,v,m,_,P){this.text.programConfigurations.updatePaintArrays(s,u,m,p,v,_,P),this.icon.programConfigurations.updatePaintArrays(s,u,m,p,v,_,P)}updateZOffset(){const s=(m,_,P)=>{p+=_,p>m.length&&m.resize(p);for(let O=-_;O<0;O++)m.emplace(O+p,P)},u=(m,_,P)=>{v+=_,v>m.length&&m.resize(v);for(let O=-_;O<0;O++)m.emplace(O+v,P)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let p=0,v=0;for(let m=0;m<this.symbolInstances.length;m++){const _=this.symbolInstances.get(m),{numHorizontalGlyphVertices:P,numVerticalGlyphVertices:O,numIconVertices:B}=_,k=_.zOffset,R=B>0;if((P>0||O>0)&&(s(this.text.zOffsetVertexArray,P,k),s(this.text.zOffsetVertexArray,O,k)),R){const{placedIconSymbolIndex:z,verticalPlacedIconSymbolIndex:M}=_;z>=0&&u(this.icon.zOffsetVertexArray,B,k),M>=0&&u(this.icon.zOffsetVertexArray,_.numVerticalIconVertices,k)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=WF(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,u){const p=this.lineVertexArray.length;if(s.segment!==void 0)for(const{x:v,y:m}of u)this.lineVertexArray.emplaceBack(v,m);return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(s,u,p,v,m,_,P,O,B,k,R,z,M,L,q,X){const te=s.indexArray,le=s.layoutVertexArray,ce=s.globeExtVertexArray,ie=s.segments.prepareSegment(4*u.length,le,te,this.canOverlap?_.sortKey:void 0),fe=this.glyphOffsetArray.length,xe=ie.vertexLength,je=this.allowVerticalPlacement&&P===Tu.vertical?Math.PI/2:0,Fe=_.text&&_.text.sections;for(let Ie=0;Ie<u.length;Ie++){const{tl:et,tr:Ve,bl:rt,br:ot,texPrimary:it,texSecondary:ct,pixelOffsetTL:ft,pixelOffsetBR:xt,minFontScaleX:ut,minFontScaleY:Mt,glyphOffset:qt,isSDF:Et,sectionIndex:fr}=u[Ie],lr=ie.vertexLength,Qt=qt[1];if(lS(le,B.x,B.y,et.x,Qt+et.y,it.x,it.y,p,Et,ft.x,ft.y,ut,Mt),lS(le,B.x,B.y,Ve.x,Qt+Ve.y,it.x+it.w,it.y,p,Et,xt.x,ft.y,ut,Mt),lS(le,B.x,B.y,rt.x,Qt+rt.y,it.x,it.y+it.h,p,Et,ft.x,xt.y,ut,Mt),lS(le,B.x,B.y,ot.x,Qt+ot.y,it.x+it.w,it.y+it.h,p,Et,xt.x,xt.y,ut,Mt),O){const{x:Gt,y:kr,z:yr}=O.anchor,[_r,rn,vn]=O.up;uS(ce,Gt,kr,yr,_r,rn,vn),uS(ce,Gt,kr,yr,_r,rn,vn),uS(ce,Gt,kr,yr,_r,rn,vn),uS(ce,Gt,kr,yr,_r,rn,vn),dS(s.dynamicLayoutVertexArray,Gt,kr,yr,je)}else dS(s.dynamicLayoutVertexArray,B.x,B.y,B.z,je);if(X){const Gt=ct||it;cS(s.iconTransitioningVertexArray,Gt.x,Gt.y),cS(s.iconTransitioningVertexArray,Gt.x+Gt.w,Gt.y),cS(s.iconTransitioningVertexArray,Gt.x,Gt.y+Gt.h),cS(s.iconTransitioningVertexArray,Gt.x+Gt.w,Gt.y+Gt.h)}te.emplaceBack(lr,lr+1,lr+2),te.emplaceBack(lr+1,lr+2,lr+3),ie.vertexLength+=4,ie.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(qt[0]),Ie!==u.length-1&&fr===u[Ie+1].sectionIndex||s.programConfigurations.populatePaintArrays(le.length,_,_.index,{},M,L,q,Fe&&Fe[fr])}const De=O?O.anchor:B;s.placedSymbolArray.emplaceBack(De.x,De.y,De.z,B.x,B.y,fe,this.glyphOffsetArray.length-fe,xe,k,R,B.segment,p?p[0]:0,p?p[1]:0,v[0],v[1],P,0,!1,0,z,0)}_commitLayoutVertex(s,u,p,v,m,_,P){s.emplaceBack(u,p,v,m,_,Math.round(P.x),Math.round(P.y))}_addCollisionDebugVertices(s,u,p,v,m,_,P){const O=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),B=O.vertexLength,k=P.tileAnchorX,R=P.tileAnchorY;for(let M=0;M<4;M++)p.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(p.collisionVertexArrayExt,u,s.padding,P.zOffset),this._commitLayoutVertex(p.layoutVertexArray,v,m,_,k,R,new Rt(s.x1,s.y1)),this._commitLayoutVertex(p.layoutVertexArray,v,m,_,k,R,new Rt(s.x2,s.y1)),this._commitLayoutVertex(p.layoutVertexArray,v,m,_,k,R,new Rt(s.x2,s.y2)),this._commitLayoutVertex(p.layoutVertexArray,v,m,_,k,R,new Rt(s.x1,s.y2)),O.vertexLength+=4;const z=p.indexArray;z.emplaceBack(B,B+1),z.emplaceBack(B+1,B+2),z.emplaceBack(B+2,B+3),z.emplaceBack(B+3,B),O.primitiveLength+=4}_addTextDebugCollisionBoxes(s,u,p,v,m,_){for(let P=v;P<m;P++){const O=p.get(P),B=this.getSymbolInstanceTextSize(s,_,u,P);this._addCollisionDebugVertices(O,B,this.textCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(s,u,p,v,m,_){for(let P=v;P<m;P++){const O=p.get(P),B=this.getSymbolInstanceIconSize(s,u,_.placedIconSymbolIndex);this._addCollisionDebugVertices(O,B,this.iconCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,_)}}generateCollisionDebugBuffers(s,u,p){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pk(Nf,pF.members,Ls),this.iconCollisionBox=new pk(Nf,pF.members,Ls);const v=Ix(this.iconSizeData,s),m=Ix(this.textSizeData,s,p);for(let _=0;_<this.symbolInstances.length;_++){const P=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(m,s,u,P.textBoxStartIndex,P.textBoxEndIndex,P),this._addTextDebugCollisionBoxes(m,s,u,P.verticalTextBoxStartIndex,P.verticalTextBoxEndIndex,P),this._addIconDebugCollisionBoxes(v,s,u,P.iconBoxStartIndex,P.iconBoxEndIndex,P),this._addIconDebugCollisionBoxes(v,s,u,P.verticalIconBoxStartIndex,P.verticalIconBoxEndIndex,P)}}getSymbolInstanceTextSize(s,u,p,v){const m=this.text.placedSymbolArray.get(u.rightJustifiedTextSymbolIndex>=0?u.rightJustifiedTextSymbolIndex:u.centerJustifiedTextSymbolIndex>=0?u.centerJustifiedTextSymbolIndex:u.leftJustifiedTextSymbolIndex>=0?u.leftJustifiedTextSymbolIndex:u.verticalPlacedTextSymbolIndex>=0?u.verticalPlacedTextSymbolIndex:v),_=J2(this.textSizeData,s,m)/Uo;return this.tilePixelRatio*_}getSymbolInstanceIconSize(s,u,p){const v=this.icon.placedSymbolArray.get(p),m=J2(this.iconSizeData,s,v);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(s,u,p,v){s.emplaceBack(u,-p,-p,v),s.emplaceBack(u,p,-p,v),s.emplaceBack(u,p,p,v),s.emplaceBack(u,-p,p,v)}_updateTextDebugCollisionBoxes(s,u,p,v,m,_,P){for(let O=v;O<m;O++){const B=p.get(O),k=this.getSymbolInstanceTextSize(s,_,u,O);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,B.padding,_.zOffset)}}_updateIconDebugCollisionBoxes(s,u,p,v,m,_,P){for(let O=v;O<m;O++){const B=p.get(O),k=this.getSymbolInstanceIconSize(s,u,_.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,B.padding,_.zOffset)}}updateCollisionDebugBuffers(s,u,p,v){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const m=Ix(this.iconSizeData,s,v),_=Ix(this.textSizeData,s,p);for(let P=0;P<this.symbolInstances.length;P++){const O=this.symbolInstances.get(P);this._updateTextDebugCollisionBoxes(_,s,u,O.textBoxStartIndex,O.textBoxEndIndex,O,p),this._updateTextDebugCollisionBoxes(_,s,u,O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,p),this._updateIconDebugCollisionBoxes(m,s,u,O.iconBoxStartIndex,O.iconBoxEndIndex,O,v),this._updateIconDebugCollisionBoxes(m,s,u,O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,v)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,u,p,v,m,_,P,O,B){const k={};if(u<p){const{x1:R,y1:z,x2:M,y2:L,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:ie,featureIndex:fe}=s.get(u);k.textBox={x1:R,y1:z,x2:M,y2:L,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:ie},k.textFeatureIndex=fe}if(v<m){const{x1:R,y1:z,x2:M,y2:L,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:ie,featureIndex:fe}=s.get(v);k.verticalTextBox={x1:R,y1:z,x2:M,y2:L,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:ie},k.verticalTextFeatureIndex=fe}if(_<P){const{x1:R,y1:z,x2:M,y2:L,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:ie,featureIndex:fe}=s.get(_);k.iconBox={x1:R,y1:z,x2:M,y2:L,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:ie},k.iconFeatureIndex=fe}if(O<B){const{x1:R,y1:z,x2:M,y2:L,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:ie,featureIndex:fe}=s.get(O);k.verticalIconBox={x1:R,y1:z,x2:M,y2:L,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:ie},k.verticalIconFeatureIndex=fe}return k}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const p=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(s,u){const p=s.placedSymbolArray.get(u),v=p.vertexStartIndex+4*p.numGlyphs;for(let m=p.vertexStartIndex;m<v;m+=4)s.indexArray.emplaceBack(m,m+1,m+2),s.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(s),p=Math.cos(s),v=[],m=[],_=[];for(let P=0;P<this.symbolInstances.length;++P){_.push(P);const O=this.symbolInstances.get(P);v.push(0|Math.round(u*O.tileAnchorX+p*O.tileAnchorY)),m.push(O.featureIndex)}return _.sort((P,O)=>v[P]-v[O]||m[O]-m[P]),_}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let s=0;s<this.symbolInstances.length;++s)this.symbolInstanceIndexesSortedZOffset.push(s)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((s,u)=>this.symbolInstances.get(u).zOffset-this.symbolInstances.get(s).zOffset)}addToSortKeyRanges(s,u){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===u?p.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const p=this.symbolInstances.get(u);this.featureSortOrder.push(p.featureIndex);const{rightJustifiedTextSymbolIndex:v,centerJustifiedTextSymbolIndex:m,leftJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:P,placedIconSymbolIndex:O,verticalPlacedIconSymbolIndex:B}=p;v>=0&&this.addIndicesForPlacedSymbol(this.text,v),m>=0&&m!==v&&this.addIndicesForPlacedSymbol(this.text,m),_>=0&&_!==m&&_!==v&&this.addIndicesForPlacedSymbol(this.text,_),P>=0&&this.addIndicesForPlacedSymbol(this.text,P),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O),B>=0&&this.addIndicesForPlacedSymbol(this.icon,B)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let HF,KF,mk;mr(hS,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),hS.addDynamicAttributes=dS;class ZF{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:Zu,this.defaultValue=s}evaluate(s){if(s.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(s.formattedSection))return u.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}mr(ZF,"FormatSectionOverride",{omit:["defaultValue"]});const gk=()=>mk||(mk={layout:HF||(HF=new qi({"symbol-placement":new Jt(vt.layout_symbol["symbol-placement"]),"symbol-spacing":new Jt(vt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Jt(vt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new dr(vt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Jt(vt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Jt(vt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Jt(vt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Jt(vt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Jt(vt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Jt(vt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Jt(vt.layout_symbol["icon-rotation-alignment"]),"icon-size":new dr(vt.layout_symbol["icon-size"]),"icon-size-scale-range":new Jt(vt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new dr(vt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new dr(vt.layout_symbol["icon-text-fit-padding"]),"icon-image":new dr(vt.layout_symbol["icon-image"]),"icon-rotate":new dr(vt.layout_symbol["icon-rotate"]),"icon-padding":new Jt(vt.layout_symbol["icon-padding"]),"icon-keep-upright":new Jt(vt.layout_symbol["icon-keep-upright"]),"icon-offset":new dr(vt.layout_symbol["icon-offset"]),"icon-anchor":new dr(vt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Jt(vt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Jt(vt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Jt(vt.layout_symbol["text-rotation-alignment"]),"text-field":new dr(vt.layout_symbol["text-field"]),"text-font":new dr(vt.layout_symbol["text-font"]),"text-size":new dr(vt.layout_symbol["text-size"]),"text-size-scale-range":new Jt(vt.layout_symbol["text-size-scale-range"]),"text-max-width":new dr(vt.layout_symbol["text-max-width"]),"text-line-height":new dr(vt.layout_symbol["text-line-height"]),"text-letter-spacing":new dr(vt.layout_symbol["text-letter-spacing"]),"text-justify":new dr(vt.layout_symbol["text-justify"]),"text-radial-offset":new dr(vt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Jt(vt.layout_symbol["text-variable-anchor"]),"text-anchor":new dr(vt.layout_symbol["text-anchor"]),"text-max-angle":new Jt(vt.layout_symbol["text-max-angle"]),"text-writing-mode":new Jt(vt.layout_symbol["text-writing-mode"]),"text-rotate":new dr(vt.layout_symbol["text-rotate"]),"text-padding":new Jt(vt.layout_symbol["text-padding"]),"text-keep-upright":new Jt(vt.layout_symbol["text-keep-upright"]),"text-transform":new dr(vt.layout_symbol["text-transform"]),"text-offset":new dr(vt.layout_symbol["text-offset"]),"text-allow-overlap":new Jt(vt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Jt(vt.layout_symbol["text-ignore-placement"]),"text-optional":new Jt(vt.layout_symbol["text-optional"]),visibility:new Jt(vt.layout_symbol.visibility)})),paint:KF||(KF=new qi({"icon-opacity":new dr(vt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new dr(vt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new dr(vt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new dr(vt.paint_symbol["text-emissive-strength"]),"icon-color":new dr(vt.paint_symbol["icon-color"]),"icon-halo-color":new dr(vt.paint_symbol["icon-halo-color"]),"icon-halo-width":new dr(vt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new dr(vt.paint_symbol["icon-halo-blur"]),"icon-translate":new Jt(vt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Jt(vt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new dr(vt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new dr(vt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new dr(vt.paint_symbol["text-occlusion-opacity"]),"text-color":new dr(vt.paint_symbol["text-color"],{runtimeType:xs,getOverride:f=>f.textColor,hasOverride:f=>!!f.textColor}),"text-halo-color":new dr(vt.paint_symbol["text-halo-color"]),"text-halo-width":new dr(vt.paint_symbol["text-halo-width"]),"text-halo-blur":new dr(vt.paint_symbol["text-halo-blur"]),"text-translate":new Jt(vt.paint_symbol["text-translate"]),"text-translate-anchor":new Jt(vt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Jt(vt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Jt(vt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Jt(vt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Jt(vt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new dr(vt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"})}))},mk);class fS extends hi{constructor(s,u,p,v){super(s,gk(),u,p,v),this._colorAdjustmentMatrix=ze.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=s.paint!==void 0&&("icon-occlusion-opacity"in s.paint||"text-occlusion-opacity"in s.paint)}recalculate(s,u){super.recalculate(s,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const p=this.layout.get("text-writing-mode");if(p){const v=[];for(const m of p)v.indexOf(m)<0&&v.push(m);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(s,u,p,v){return this._saturation===s&&this._contrast===u&&this._brightnessMin===p&&this._brightnessMax===v||(this._colorAdjustmentMatrix=function(m,_,P,O){m=qs(m),_=Ma(_);const B=ze.mat4.create(),k=m/3,R=1-2*k,z=[R,k,k,0,k,R,k,0,k,k,R,0,0,0,0,1],M=.5-.5*_,L=O-P;return ze.mat4.multiply(B,[L,0,0,0,0,L,0,0,0,0,L,0,P,P,P,1],[_,0,0,0,0,_,0,0,0,0,_,0,M,M,M,1]),ze.mat4.multiply(B,B,z),B}(s,u,p,v),this._saturation=s,this._contrast=u,this._brightnessMin=p,this._brightnessMax=v),this._colorAdjustmentMatrix}getValueAndResolveTokens(s,u,p,v){const m=this.layout.get(s).evaluate(u,{},p,v),_=this._unevaluatedLayout._values[s];return _.isDataDriven()||oh(_.value)||!m?m:function(P,O){return O.replace(/{([^{}]+)}/g,(B,k)=>k in P?String(P[k]):"")}(u.properties,m)}createBucket(s){return new hS(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of gk().paint.overridableProperties){if(!fS.hasPaintOverride(this.layout,s))continue;const u=this.paint.get(s),p=new ZF(u),v=new sh(p,u.property.specification,this.scope,this.options);let m=null;m=u.value.kind==="constant"||u.value.kind==="source"?new lh("source",v):new ch("composite",v,u.value.zoomStops,u.value._interpolationType),this.paint._values[s]=new dd(u.property,m,u.parameters)}}_handleOverridablePaintPropertyUpdate(s,u,p){return!(!this.layout||u.isDataDriven()||p.isDataDriven())&&fS.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,u){const p=s.get("text-field"),v=gk().paint.properties[u];let m=!1;const _=P=>{for(const O of P)if(v.overrides&&v.overrides.hasOverride(O))return void(m=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Os)_(p.value.value.sections);else if(p.value.kind==="source"){const P=B=>{m||(B instanceof Ia&&oa(B.value)===Yo?_(B.value.sections):B instanceof cu?_(B.sections):B.eachChild(P))},O=p.value;O._styleExpression&&P(O._styleExpression.expression)}return m}getProgramIds(){return["symbol"]}getDefaultProgramParams(s,u,p){return{config:new Su(this,{zoom:u,lut:p}),overrideFog:!1}}}let YF,XF,JF,QF;var yk=Jn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function xk(f){switch(f){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function vk(f){switch(f){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class _k{constructor(s,u,p,v){this.context=s,this.format=p,this.useMipmap=v&&v.useMipmap,this.texture=s.gl.createTexture(),this.update(u,{premultiply:v&&v.premultiply})}update(s,u){const p=s&&s instanceof HTMLVideoElement&&s.width===0?s.videoWidth:s.width,v=s&&s instanceof HTMLVideoElement&&s.height===0?s.videoHeight:s.height,{context:m}=this,{gl:_}=m,{x:P,y:O}=u&&u.position?u.position:{x:0,y:0},B=P+p,k=O+v;!this.size||this.size[0]===B&&this.size[1]===k||(_.bindTexture(_.TEXTURE_2D,null),_.deleteTexture(this.texture),this.texture=_.createTexture(),this.size=null),_.bindTexture(_.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===_.RGBA8&&(!u||u.premultiply!==!1));const R=s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||ImageBitmap&&s instanceof ImageBitmap;if(!this.size&&B>0&&k>0){const z=this.useMipmap?Math.floor(Math.log2(Math.max(B,k)))+1:1;_.texStorage2D(_.TEXTURE_2D,z,this.format,B,k),this.size=[B,k]}if(this.size)if(R)_.texSubImage2D(_.TEXTURE_2D,0,P,O,xk(this.format),vk(this.format),s);else{const z=s.data;z&&_.texSubImage2D(_.TEXTURE_2D,0,P,O,p,v,xk(this.format),vk(this.format),z)}this.useMipmap&&_.generateMipmap(_.TEXTURE_2D)}bind(s,u,p=!1){const{context:v}=this,{gl:m}=v;m.bindTexture(m.TEXTURE_2D,this.texture),s!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap&&!p?s===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_LINEAR:s),this.minFilter=s),u!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,u),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,u),this.wrapS=u)}bindExtraParam(s,u,p,v){const{context:m}=this,{gl:_}=m;_.bindTexture(_.TEXTURE_2D,this.texture),u!==this.magFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,u),this.magFilter=u),s!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap?s===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR:s),this.minFilter=s),p!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,p),this.wrapS=p),v!==this.wrapT&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,v),this.wrapT=v)}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class pS{constructor(s,u){this.context=s,this.texture=u}bind(s,u){const{context:p}=this,{gl:v}=p;v.bindTexture(v.TEXTURE_2D,this.texture),s!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,s),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,s),this.minFilter=s),u!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,u),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,u),this.wrapS=u)}}function mS(f,s,u,p,v,m,_,P){const O=[f,s,1,u,p,1,v,m,1],B=[_,P,1],k=ze.mat3.adjoint([],O),[R,z,M]=ze.vec3.transformMat3(B,B,k);return ze.mat3.multiply(O,O,[R,0,0,0,z,0,0,0,M])}function ez(f,s,u,p,v,m,_,P){const O=function(B,k,R,z,M,L,q,X){const te=mS(0,0,1,0,1,1,0,1),le=mS(B,k,R,z,M,L,q,X),ce=ze.mat3.adjoint([],te);return ze.mat3.multiply(le,le,ce)}(f,s,u,p,v,m,_,P);return[O[2]/O[8]/cr,O[5]/O[8]/cr]}function gS(f){return[f[0],Math.min(Math.max(f[1],-85.051129),oo)]}class tz extends au{constructor(s,u,p,v){super(),this.id=s,this.dispatcher=p,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(v),this.options=u,this._dirty=!1}load(s,u){if(this._loaded=u||!1,this.fire(new xi("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return s&&(this.coordinates=s),this._loaded=!0,void this._finishLoading();this._imageRequest=sf(this.map._requestManager.transformRequest(this.url,Rn.Image),(p,v)=>{this._imageRequest=null,this._loaded=!0,p?this.fire(new bp(p)):v&&(this.image=v instanceof HTMLImageElement?Ye.getImageData(v):v,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,s&&(this.coordinates=s),this._finishLoading())})}loaded(){return this._loaded}updateImage(s){return s.url?(this._imageRequest&&s.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=s.url,this.load(s.coordinates,this._loaded),this):this}setTexture(s){if(!(s.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new pS(this.map.painter.context,s.handle),this.width=s.dimensions[0],this.height=s.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new xi("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(s){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof pS||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(s){if(this.coordinates=s,this._boundsArray=void 0,this._unsupportedCoords=!1,!s.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let u=s[0][1],p=s[0][1];for(const m of s)m[1]>p&&(p=m[1]),m[1]<u&&(u=m[1]);const v=(p+u)/2;if(v>oo?this.onNorthPole=!0:v<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const m=s.map(d.fromLngLat);this.tileID=function(_){let P=1/0,O=1/0,B=-1/0,k=-1/0;for(const q of _)P=Math.min(P,q.x),O=Math.min(O,q.y),B=Math.max(B,q.x),k=Math.max(k,q.y);const R=Math.max(B-P,k-O),z=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),M=Math.pow(2,z);let L=Math.floor((P+B)/2*M);return L>1&&(L-=1),new Vt(z,L,Math.floor((O+k)/2*M))}(m),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new xi("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(s){for(const te in this.tiles){const le=this.tiles[te];le.state!=="loaded"&&(le.state="loaded",le.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const u=mb(new Vt(0,0,0),this.map.transform.projection),p=[u.projection.project(this.coordinates[0][0],this.coordinates[0][1]),u.projection.project(this.coordinates[1][0],this.coordinates[1][1]),u.projection.project(this.coordinates[2][0],this.coordinates[2][1]),u.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(te){const le=te[1].x-te[0].x,ce=te[1].y-te[0].y,ie=te[2].x-te[1].x,fe=te[2].y-te[1].y,xe=te[3].x-te[2].x,je=te[3].y-te[2].y,Fe=te[0].x-te[3].x,De=te[0].y-te[3].y,Ie=le*fe-ie*ce,et=ie*je-xe*fe,Ve=xe*De-Fe*je,rt=Fe*ce-le*De;return Ie>0&&et>0&&Ve>0&&rt>0||Ie<0&&et<0&&Ve<0&&rt<0}(p))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const v=mb(this.tileID,this.map.transform.projection),[m,_,P,O]=this.coordinates.map(te=>{const le=v.projection.project(te[0],te[1]);return VF(v,le)._round()});this.perspectiveTransform=ez(m.x,m.y,_.x,_.y,P.x,P.y,O.x,O.y);const B=this._boundsArray=new pa;B.emplaceBack(m.x,m.y,0,0),B.emplaceBack(_.x,_.y,cr,0),B.emplaceBack(O.x,O.y,0,cr),B.emplaceBack(P.x,P.y,cr,cr),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=s.createVertexBuffer(B,yk.members),this.boundsSegments=Na.simpleSegment(0,0,4,2);const k=[],R=[gS((z=this.coordinates)[0]),gS(z[1]),gS(z[2]),gS(z[3])];var z;const[M,L,q,X]=function(te){let le=te[0][0],ce=le,ie=te[0][1],fe=ie;for(let xe=1;xe<te.length;xe++)te[xe][0]<le?le=te[xe][0]:te[xe][0]>ce&&(ce=te[xe][0]),te[xe][1]<ie?ie=te[xe][1]:te[xe][1]>fe&&(fe=te[xe][1]);return[le,ie,ce-le,fe-ie]}(R);{const te=new pa,[le,ce,ie,fe]=function(ft){let xt=ft[0].x,ut=xt,Mt=ft[0].y,qt=Mt;for(let Et=1;Et<ft.length;Et++)ft[Et].x<xt?xt=ft[Et].x:ft[Et].x>ut&&(ut=ft[Et].x),ft[Et].y<Mt?Mt=ft[Et].y:ft[Et].y>qt&&(qt=ft[Et].y);return[xt,Mt,ut-xt,qt-Mt]}(p),xe=ft=>[(ft.x-le)/ie,(ft.y-ce)/fe],[je,Fe,De,Ie]=p.map(xe),et=function(ft,xt,ut,Mt,qt,Et,fr,lr){const Qt=mS(0,0,1,0,1,1,0,1),Gt=mS(ft,xt,ut,Mt,qt,Et,fr,lr),kr=ze.mat3.adjoint([],Gt);return ze.mat3.multiply(Qt,Qt,kr)}(je[0],je[1],Fe[0],Fe[1],De[0],De[1],Ie[0],Ie[1]);this.elevatedGlobePerspectiveTransform=ez(je[0],je[1],Fe[0],Fe[1],De[0],De[1],Ie[0],Ie[1]);const Ve=(ft,xt)=>{k.push(ft.lng);const ut=Math.round((ft.lng-M)/q*cr),Mt=Math.round((ft.lat-L)/X*cr),qt=xe(xt),Et=ze.vec3.transformMat3([],[qt[0],qt[1],1],et),fr=Math.round(Et[0]/Et[2]*cr),lr=Math.round(Et[1]/Et[2]*cr);te.emplaceBack(ut,Mt,fr,lr)},rt=p[3].x-p[0].x,ot=p[3].y-p[0].y,it=p[2].x-p[1].x,ct=p[2].y-p[1].y;for(let ft=0;ft<65;ft++){const xt=ft/64,ut=[p[0].x+xt*rt,p[0].y+xt*ot],Mt=[p[1].x+xt*it,p[1].y+xt*ct],qt=Mt[0]-ut[0],Et=Mt[1]-ut[1];for(let fr=0;fr<65;fr++){const lr=fr/64,Qt={x:ut[0]+qt*lr,y:ut[1]+Et*lr};Ve(u.projection.unproject(Qt.x,Qt.y),Qt)}}this.elevatedGlobeVertexBuffer=s.createVertexBuffer(te,yk.members)}{this.maxLongitudeTriangleSize=0;let te=[],le=new bs;const ce=(ie,fe,xe)=>{le.emplaceBack(ie,fe,xe);const je=k[ie],Fe=k[fe],De=k[xe],Ie=Math.min(Math.min(je,Fe),De),et=Math.max(Math.max(je,Fe),De)-Ie;et>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=et),te.push(Ie+et/2)};for(let ie=0;ie<64;ie++)for(let fe=0;fe<64;fe++){const xe=65*ie+fe,je=xe+1,Fe=xe+65,De=Fe+1;ce(xe,Fe,je),ce(je,Fe,De)}[te,le]=function(ie,fe){const xe=Array.from({length:ie.length},(De,Ie)=>Ie);xe.sort((De,Ie)=>ie[De]-ie[Ie]);const je=[],Fe=new bs;for(let De=0;De<xe.length;De++){const Ie=xe[De];je.push(ie[Ie]);const et=3*Ie,Ve=et+1;Fe.emplaceBack(fe.uint16[et],fe.uint16[Ve],fe.uint16[Ve+1])}return[je,Fe]}(te,le),this.elevatedGlobeTrianglesCenterLongitudes=te,this.elevatedGlobeIndexBuffer=s.createIndexBuffer(le)}this.elevatedGlobeSegments=Na.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,q/cr,0,X/cr,0,0,L,M,0])}prepare(){const s=Object.keys(this.tiles).length!==0;if(this.tileID&&!s)return;const u=this.map.painter.context,p=u.gl;!this._dirty||this.texture instanceof pS||(this.texture?this.texture.update(this.image):(this.texture=new _k(u,this.image,p.RGBA8),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this._dirty=!1),s&&this._prepareData(u)}loadTile(s,u){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={},u(null)):(s.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(s){const u=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!u)return null;const p=this.elevatedGlobeTrianglesCenterLongitudes;let v=(m=s+180)+360*Math.round((p[0]-m)/360);var m;const _=new Na,P=(R,z)=>{_.segments.push({vertexOffset:0,primitiveOffset:R,vertexLength:u.segments[0].vertexLength,primitiveLength:z,sortKey:void 0,vaos:{}})},O=.51*this.maxLongitudeTriangleSize;if(Math.abs(p[0]-v)<=O){const R=Ll(p,0,p.length,v+O);return R===p.length||P(R,Es(p,R+1,p.length,v+360-O)-R),_}v<p[0]&&(v+=360);const B=Es(p,0,p.length,v-O);if(B===p.length)return P(0,p.length),_;P(0,B-0);const k=Ll(p,B+1,p.length,v+O);return k!==p.length&&P(k,p.length-k),_}}const tse=(Math.pow(256,2)-1)/16907520;class rz extends hi{constructor(s,u,p,v){super(s,{layout:JF||(JF=new qi({visibility:new Jt(vt.layout_raster.visibility)})),paint:QF||(QF=new qi({"raster-opacity":new Jt(vt.paint_raster["raster-opacity"]),"raster-color":new Wl(vt.paint_raster["raster-color"]),"raster-color-mix":new Jt(vt.paint_raster["raster-color-mix"]),"raster-color-range":new Jt(vt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Jt(vt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Jt(vt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Jt(vt.paint_raster["raster-brightness-max"]),"raster-saturation":new Jt(vt.paint_raster["raster-saturation"]),"raster-contrast":new Jt(vt.paint_raster["raster-contrast"]),"raster-resampling":new Jt(vt.paint_raster["raster-resampling"]),"raster-fade-duration":new Jt(vt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Jt(vt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Jt(vt.paint_raster["raster-array-band"]),"raster-elevation":new Jt(vt.paint_raster["raster-elevation"]),"raster-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"})}))},u,p,v),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(s){return!(s&&s._source instanceof tz&&(s._source.onNorthPole||s._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(s){s!=="raster-color"&&s!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(s){if(!this.hasColorMap()||!this._curRampRange)return;const u=this._transitionablePaint._values["raster-color"].value.expression,[p,v]=s||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(p)&&isNaN(v)||p===this._curRampRange[0]&&v===this._curRampRange[1]||(this.colorRamp=Ng({expression:u,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:p,end:v}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[p,v])}}let nz,iz,az,sz,oz;class lz extends hi{constructor(s,u,p,v){super(s,{layout:nz||(nz=new qi({visibility:new Jt(vt["layout_raster-particle"].visibility)})),paint:iz||(iz=new qi({"raster-particle-array-band":new Jt(vt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Jt(vt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Wl(vt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Jt(vt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Jt(vt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Jt(vt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Jt(vt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Jt(vt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"})}))},u,p,v),this._updateColorRamp(),this.lastInvalidatedAt=Ye.now()}onRemove(s){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(s){return!1}_handleSpecialPaintPropertyUpdate(s){s!=="raster-particle-color"&&s!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),s==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const s=this._transitionablePaint._values["raster-particle-color"].value.expression,u=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Ng({expression:s,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:u}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Ye.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class rse extends hi{constructor(s,u){super(s,{},u,null),this.implementation=s,s.slot&&(this.slot=s.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(s){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}function bk(f,s,u){const p=[0,0,1],v=ze.quat.identity([]);return ze.quat.rotateY(v,v,u?-dt(f)+Math.PI:dt(f)),ze.quat.rotateX(v,v,-dt(s)),ze.vec3.transformQuat(p,p,v),ze.vec3.normalize(p,p)}function cz(f,s){const u=yS(f.projection,f.zoom,f.width,f.height),p=function(m,_,P,O,B){const k=new Kn(P.lng-180*Eg,P.lat),R=new Kn(P.lng+180*Eg,P.lat),z=m.project(k.lng,k.lat),M=m.project(R.lng,R.lat),L=-Math.atan2(M.y-z.y,M.x-z.x),q=d.fromLngLat(P);q.y=pr(q.y,-1+Eg,1-Eg);const X=q.toLngLat(),te=m.project(X.lng,X.lat),le=d.fromLngLat(X);le.x+=Eg;const ce=le.toLngLat(),ie=m.project(ce.lng,ce.lat),fe=dz(ie.x-te.x,ie.y-te.y,L),xe=d.fromLngLat(X);xe.y+=Eg;const je=xe.toLngLat(),Fe=m.project(je.lng,je.lat),De=dz(Fe.x-te.x,Fe.y-te.y,L),Ie=Math.abs(fe.x)/Math.abs(De.y),et=ze.mat4.identity([]);ze.mat4.rotateZ(et,et,-L*(1-(B?0:O)));const Ve=ze.mat4.identity([]);return ze.mat4.scale(Ve,Ve,[1,1-(1-Ie)*O,1]),Ve[4]=-De.x/De.y*O,ze.mat4.rotateZ(Ve,Ve,L),ze.mat4.multiply(Ve,et,Ve),Ve}(f.projection,0,f.center,u,s),v=uz(f);return ze.mat4.scale(p,p,[v,v,1]),p}function uz(f){const s=f.projection,u=yS(f.projection,f.zoom,f.width,f.height),p=wk(s,f.center),v=wk(s,Kn.convert(s.center));return Math.pow(2,p*u+(1-u)*v)}function yS(f,s,u,p,v=1/0){const m=f.range;if(!m)return 0;const _=Math.min(v,Math.max(u,p)),P=Math.log(_/1024)/Math.LN2;return Mn(m[0]+P,m[1]+P,s)}const Eg=1/4e4;function wk(f,s){const u=pr(s.lat,-85.051129,oo),p=new Kn(s.lng-180*Eg,u),v=new Kn(s.lng+180*Eg,u),m=f.project(p.lng,u),_=f.project(v.lng,u),P=d.fromLngLat(p),O=d.fromLngLat(v),B=_.x-m.x,k=_.y-m.y,R=O.x-P.x,z=O.y-P.y,M=Math.sqrt((R*R+z*z)/(B*B+k*k));return Math.log(M)/Math.LN2}function dz(f,s,u){const p=Math.cos(u),v=Math.sin(u);return{x:f*p-s*v,y:f*v+s*p}}function hz(f,s,u){ze.mat4.identity(f),ze.mat4.rotateZ(f,f,dt(s[2])),ze.mat4.rotateX(f,f,dt(s[0])),ze.mat4.rotateY(f,f,dt(s[1])),ze.mat4.scale(f,f,u),ze.mat4.multiply(f,f,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function xS(f,s,u,p,v,m,_,P){const O=[u[0]-s[0],u[1]-s[1],0],B=[p[0]-s[0],p[1]-s[1],0];if(ze.vec3.length(O)<1e-12||ze.vec3.length(B)<1e-12)return ze.quat.identity(f);const k=ze.vec3.cross([],O,B);ze.vec3.normalize(k,k),ze.vec3.subtract(B,p,s),O[2]=(m-v)*P,B[2]=(_-v)*P;const R=O;return ze.vec3.cross(R,O,B),ze.vec3.normalize(R,R),ze.quat.rotationTo(f,k,R)}function Sk(f,s,u=!1){const p=Bo(s.zoom),v=function(m,_,P){const O=_.worldSize,B=[m[12],m[13],m[14]],k=Br(B[1]/O),R=ol(B[0]/O),z=ze.mat4.identity([]),M=Gi(1,k)*O,L=Gi(1,0)*O*Lf(k,_.zoom),q=1/Hs(O);let X=L*q;if(P){const ie=yS(_.projection,_.zoom,_.width,_.height,1024);X=q*_.projection.pixelSpaceConversion(_.center.lat,O,ie)}const te=Sh(k,R);ze.vec3.add(te,te,ze.vec3.scale([],ze.vec3.normalize([],te),M*X*B[2]));const le=function(ie){const fe=[ie[0],ie[1],ie[2]];let xe=[0,1,0];const je=ze.vec3.cross([],xe,fe);return ze.vec3.cross(xe,fe,je),ze.vec3.squaredLength(xe)===0&&(xe=[0,1,0],ze.vec3.cross(je,fe,xe)),ze.vec3.normalize(je,je),ze.vec3.normalize(xe,xe),ze.vec3.normalize(fe,fe),[je[0],je[1],je[2],0,xe[0],xe[1],xe[2],0,fe[0],fe[1],fe[2],0,ie[0],ie[1],ie[2],1]}(te);ze.mat4.scale(z,z,[X,X,X*M]),ze.mat4.translate(z,z,[-B[0],-B[1],-B[2]]);const ce=ze.mat4.multiply([],_.globeMatrix,le);return ze.mat4.multiply(ce,ce,z),ze.mat4.multiply(ce,ce,m),ce}(f,s,u);if(p>0){const m=function(_,P){const O=P.worldSize,B=Gi(1,0)*O*Lf(P.center.lat,P.zoom)/Hs(O),k=Gi(1,P.center.lat)*O,R=ze.mat4.identity([]);return ze.mat4.rotateY(R,R,dt(P.center.lng)),ze.mat4.rotateX(R,R,dt(P.center.lat)),ze.mat4.translate(R,R,[0,0,so]),ze.mat4.scale(R,R,[B,B,B*k]),ze.mat4.translate(R,R,[P.point.x-.5*O,P.point.y-.5*O,0]),ze.mat4.multiply(R,R,_),ze.mat4.multiply(R,P.globeMatrix,R)}(f,s);return function(_,P,O){const B=(L,q,X)=>{const te=ze.vec3.length(L),le=ze.vec3.length(q),ce=ka(L,q,X);return ze.vec3.scale(ce,ce,1/ze.vec3.length(ce)*Fr(te,le,X))},k=B([_[0],_[1],_[2]],[P[0],P[1],P[2]],O),R=B([_[4],_[5],_[6]],[P[4],P[5],P[6]],O),z=B([_[8],_[9],_[10]],[P[8],P[9],P[10]],O),M=ka([_[12],_[13],_[14]],[P[12],P[13],P[14]],O);return[k[0],k[1],k[2],0,R[0],R[1],R[2],0,z[0],z[1],z[2],0,M[0],M[1],M[2],1]}(v,m,p)}return v}function fz(f,s,u,p){const v=wr.projectAabbCorners(p,u);let m=Number.MAX_VALUE,_=-1;for(let B=0;B<v.length;++B){const k=v[B];k[0]=(.5*k[0]+.5)*s.width,k[1]=(.5-.5*k[1])*s.height,k[2]<m&&(_=B,m=k[2])}const P=B=>new Rt(v[B][0],v[B][1]);let O;switch(_){case 0:case 6:O=[P(1),P(5),P(4),P(7),P(3),P(2),P(1)];break;case 1:case 7:O=[P(0),P(4),P(5),P(6),P(2),P(3),P(0)];break;case 3:case 5:O=[P(1),P(0),P(4),P(7),P(6),P(2),P(1)];break;default:O=[P(1),P(5),P(6),P(7),P(3),P(0),P(1)]}if(ge(f,O))return m}const nse=Jn([{name:"a_pos_3f",components:3,type:"Float32"}]),ise=Jn([{name:"a_color_3f",components:3,type:"Float32"}]),ase=Jn([{name:"a_color_4f",components:4,type:"Float32"}]),sse=Jn([{name:"a_uv_2f",components:2,type:"Float32"}]),ose=Jn([{name:"a_normal_3f",components:3,type:"Float32"}]),lse=Jn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),cse=Jn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),pz={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class vS{constructor(s,u,p,v){this.message=(s?`${s}: `:"")+p,v&&(this.identifier=v),u!=null&&u.__line__&&(this.line=u.__line__)}}function mz(f,s){const u=f.indexOf("://")===-1;try{return new URL(f,u&&s?"http://example.com":void 0),!0}catch{return!1}}class gz{constructor(s,u){this.feature=s,this.instancedDataOffset=u,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class yz{constructor(){this.instancedDataArray=new kf,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Nk{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.fqid),this.projection=s.projection,this.index=s.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(s,u){}populate(s,u,p,v){this.tileToMeter=l(p);const m=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:_,id:P,index:O,sourceLayerIndex:B}of s){const k=P??(_.properties&&_.properties.hasOwnProperty("id")?_.properties.id:void 0),R=re(_,m);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),R,p))continue;const z={id:k,sourceLayerIndex:B,index:O,geometry:m?R.geometry:Y(_,p,v),properties:_.properties,type:_.type,patterns:{}},M=this.addFeature(z,z.geometry,R);M&&u.featureIndex.insert(_,z.geometry,O,B,this.index,this.instancesPerModel[M].instancedDataArray.length,cr/32)}this.lookup=null}update(s,u,p,v){for(const m in this.instancesPerModel){const _=this.instancesPerModel[m];for(const P in s)_.idToFeaturesIndex.hasOwnProperty(P)&&(this.evaluate(_.features[_.idToFeaturesIndex[P]],s[P],_,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let s=!1;for(const u in this.instancesPerModel){const p=this.instancesPerModel[u];for(const v of p.features){const m=this.layers[0],_=v.feature,P=this.canonical,O=m.paint.get("model-rotation").evaluate(_,{},P),B=m.paint.get("model-scale").evaluate(_,{},P),k=m.paint.get("model-translation").evaluate(_,{},P);ze.vec3.exactEquals(v.rotation,O)&&ze.vec3.exactEquals(v.scale,B)&&ze.vec3.exactEquals(v.translation,k)||(this.evaluate(v,v.featureStates,p,!0),s=!0)}}return s}updateReplacement(s,u,p,v){if(u.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=u.updateTime;const m=u.getReplacementRegionsForTile(s.toUnwrapped(),!0);if(Zj(this.activeReplacements,m))return!1;this.activeReplacements=m;let _=!1;for(const P in this.instancesPerModel){const O=this.instancesPerModel[P],B=O.instancedDataArray;for(const k of O.features){const R=k.instancedDataOffset,z=k.instancedDataCount;for(let M=0;M<z;M++){const L=16*(M+R);let q=B.float32[L+0];const X=q>cr;q=X?q-cr:q;const te=Math.floor(q),le=B.float32[L+1];let ce=!1;for(const ie of this.activeReplacements)if(!M5(ie,p,pz.Model,v)&&!(ie.min.x>te||te>ie.max.x||ie.min.y>le||le>ie.max.y)&&(ce=F5(D5(te,le,s.canonical,ie.footprintTileId.canonical),ie.footprint),ce))break;B.float32[L]=ce?q+cr:q,_=_||ce!==X}}}return _}isEmpty(){for(const s in this.instancesPerModel)if(this.instancesPerModel[s].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(s){if(!this.uploaded)for(const u in this.instancesPerModel){const p=this.instancesPerModel[u];p.instancedDataArray.length<0||p.instancedDataArray.length===0||(p.instancedDataBuffer?p.instancedDataBuffer.updateData(p.instancedDataArray):p.instancedDataBuffer=s.createVertexBuffer(p.instancedDataArray,lse.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const u in this.instancesPerModel){const p=this.instancesPerModel[u];p.instancedDataArray.length!==0&&p.instancedDataBuffer&&p.instancedDataBuffer.destroy()}const s=this.layers[0].modelManager;if(s&&this.modelUris)for(const u of this.modelUris)s.removeModel(u,"")}addFeature(s,u,p){const v=this.layers[0],m=v.layout.get("model-id").evaluate(p,{},this.canonical);if(!m)return ln(`modelId is not evaluated for layer ${v.id} and it is not going to get rendered.`),m;mz(m,!1)&&(this.modelUris.includes(m)||this.modelUris.push(m)),this.instancesPerModel[m]||(this.instancesPerModel[m]=new yz);const _=this.instancesPerModel[m],P=_.instancedDataArray,O=new gz(p,P.length);for(const B of u)for(const k of B){if(k.x<0||k.x>=cr||k.y<0||k.y>=cr)continue;const R=(this.lookupDim-1)/cr,z=this.lookupDim*(k.y*R|0)+k.x*R|0;if(this.lookup){if(this.lookup[z]!==0)continue;this.lookup[z]=1}this.instanceCount++;const M=P.length;P.resize(M+1),_.instancesEvaluatedElevation.push(0),P.float32[16*M]=k.x,P.float32[16*M+1]=k.y}return O.instancedDataCount=_.instancedDataArray.length-O.instancedDataOffset,O.instancedDataCount>0&&(s.id&&(_.idToFeaturesIndex[s.id]=_.features.length),_.features.push(O),this.evaluate(O,{},_,!1)),m}getModelUris(){return this.modelUris}evaluate(s,u,p,v){const m=this.layers[0],_=s.feature,P=this.canonical,O=s.rotation=m.paint.get("model-rotation").evaluate(_,u,P),B=s.scale=m.paint.get("model-scale").evaluate(_,u,P),k=s.translation=m.paint.get("model-translation").evaluate(_,u,P),R=m.paint.get("model-color").evaluate(_,u,P);R.a=m.paint.get("model-color-mix-intensity").evaluate(_,u,P);const z=[];this.maxVerticalOffset<k[2]&&(this.maxVerticalOffset=k[2]),this.maxScale=Math.max(Math.max(this.maxScale,B[0]),Math.max(B[1],B[2])),hz(z,O,B);const M=Math.round(100*R.a)+R.b/1.05;for(let L=0;L<s.instancedDataCount;++L){const q=s.instancedDataOffset+L,X=16*q,te=p.instancedDataArray.float32;let le=0;v&&(le=te[X+6]-p.instancesEvaluatedElevation[q]);const ce=0|te[X+1];te[X]=(0|te[X])+R.r/1.05,te[X+1]=ce+R.g/1.05,te[X+2]=M,te[X+3]=1/(P.z>10?this.tileToMeter:l(P,ce)),te[X+4]=k[0],te[X+5]=k[1],te[X+6]=k[2]+le,te[X+7]=z[0],te[X+8]=z[1],te[X+9]=z[2],te[X+10]=z[4],te[X+11]=z[5],te[X+12]=z[6],te[X+13]=z[8],te[X+14]=z[9],te[X+15]=z[10],p.instancesEvaluatedElevation[q]=k[2]}}}let xz,vz;mr(Nk,"ModelBucket",{omit:["layers"]}),mr(yz,"PerModelAttributes"),mr(gz,"ModelFeature");const r0=64,Bx={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function _z(f,s,u,p,v,m,_,P,O,B=!1){const k=u.zoom,R=u.project(p),z=Lf(p.lat,k),M=1/z;ze.mat4.identity(f),ze.mat4.translate(f,f,[R.x+_[0]*M,R.y+_[1]*M,_[2]]);let L=1,q=1;const X=u.worldSize;if(B){if(u.projection.name==="mercator"){let ie=0;u.elevation&&(ie=u.elevation.getAtPointOrZero(new d(R.x/X,R.y/X),0));const fe=ze.vec4.transformMat4([],[R.x,R.y,ie,1],u.projMatrix)[3]/u.cameraToCenterDistance;L=fe,q=fe*Lf(u.center.lat,k)}else if(u.projection.name==="globe"){const ie=Sk(f,u),fe=ze.mat4.multiply([],u.projMatrix,ie),xe=[0,0,0,1];ze.vec4.transformMat4(xe,xe,fe);const je=xe[3]/u.cameraToCenterDistance,Fe=Bo(k),De=u.projection.pixelsPerMeter(p.lat,X)*Lf(p.lat,k),Ie=u.projection.pixelsPerMeter(u.center.lat,X)*Lf(u.center.lat,k);L=je/Fr(De,wg(u.center.lat),Fe),q=je*z/De,L*=Ie,q*=Ie}}else L=M;ze.mat4.scale(f,f,[L,L,q]);const te=[...f],le=s.orientation,ce=[];if(hz(ce,[le[0]+v[0],le[1]+v[1],le[2]+v[2]],m),ze.mat4.multiply(f,te,ce),P&&u.elevation){let ie=0;const fe=[];if(O&&u.elevation){ie=function(Fe,De,Ie,et,Ve){const rt=De.elevation;if(!rt)return 0;const ot=wr.projectAabbCorners(Ie,et),it=Gi(1,Ve.lat)*De.worldSize,ct=function(kr,yr){const _r=[0,0,1],rn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const vn of rn){const Sn=kr[vn.corners[0]],Nn=kr[vn.corners[1]],Dn=kr[vn.corners[2]],Bn=[Nn[0]-Sn[0],Nn[1]-Sn[1],yr*(Nn[2]-Sn[2])],Ii=ze.vec3.cross(Bn,Bn,[Dn[0]-Sn[0],Dn[1]-Sn[1],yr*(Dn[2]-Sn[2])]);ze.vec3.normalize(Ii,Ii),vn.dotProductWithUp=ze.vec3.dot(Ii,_r)}return rn.sort((vn,Sn)=>vn.dotProductWithUp-Sn.dotProductWithUp),rn[0].corners}(ot,it),ft=ot[ct[0]],xt=ot[ct[1]],ut=ot[ct[2]],Mt=ot[ct[3]],qt=rt.getAtPointOrZero(new d(ft[0]/De.worldSize,ft[1]/De.worldSize),0),Et=rt.getAtPointOrZero(new d(xt[0]/De.worldSize,xt[1]/De.worldSize),0),fr=rt.getAtPointOrZero(new d(ut[0]/De.worldSize,ut[1]/De.worldSize),0),lr=rt.getAtPointOrZero(new d(Mt[0]/De.worldSize,Mt[1]/De.worldSize),0),Qt=(qt+lr)/2,Gt=(Et+fr)/2;return Qt>Gt?Et<fr?xS(Fe,xt,Mt,ft,Et,lr,qt,it):xS(Fe,ut,ft,Mt,fr,qt,lr,it):qt<lr?xS(Fe,ft,xt,ut,qt,Et,fr,it):xS(Fe,Mt,ut,xt,lr,fr,Et,it),Math.max(Qt,Gt)}(fe,u,s.aabb,f,p);const xe=ze.mat4.fromQuat([],fe),je=ze.mat4.multiply([],xe,ce);ze.mat4.multiply(f,te,je)}else ie=u.elevation.getAtPointOrZero(new d(R.x/X,R.y/X),0);ie!==0&&(f[14]+=ie)}}function _b(f,s,u=!1){f.uploaded||(f.gfxTexture=new _k(s,f.image,u?s.gl.R8:s.gl.RGBA8,{useMipmap:f.sampler.minFilter>=s.gl.NEAREST_MIPMAP_NEAREST}),f.uploaded=!0,f.image=null)}function use(f,s,u){f.indexBuffer=s.createIndexBuffer(f.indexArray,!1,!0),f.vertexBuffer=s.createVertexBuffer(f.vertexArray,nse.members,!1,!0),f.normalArray&&(f.normalBuffer=s.createVertexBuffer(f.normalArray,ose.members,!1,!0)),f.texcoordArray&&(f.texcoordBuffer=s.createVertexBuffer(f.texcoordArray,sse.members,!1,!0)),f.colorArray&&(f.colorBuffer=s.createVertexBuffer(f.colorArray,(f.colorArray.bytesPerElement===12?ise:ase).members,!1,!0)),f.featureArray&&(f.pbrBuffer=s.createVertexBuffer(f.featureArray,cse.members,!0)),f.segments=Na.simpleSegment(0,0,f.vertexArray.length,f.indexArray.length);const p=f.material;p.pbrMetallicRoughness.baseColorTexture&&_b(p.pbrMetallicRoughness.baseColorTexture,s),p.pbrMetallicRoughness.metallicRoughnessTexture&&_b(p.pbrMetallicRoughness.metallicRoughnessTexture,s),p.normalTexture&&_b(p.normalTexture,s),p.occlusionTexture&&_b(p.occlusionTexture,s,u),p.emissionTexture&&_b(p.emissionTexture,s)}function Ak(f,s,u){if(f.meshes)for(const p of f.meshes)use(p,s,u);if(f.children)for(const p of f.children)Ak(p,s,u)}function _S(f){if(f.meshes)for(const s of f.meshes)s.indexArray.destroy(),s.vertexArray.destroy(),s.colorArray&&s.colorArray.destroy(),s.normalArray&&s.normalArray.destroy(),s.texcoordArray&&s.texcoordArray.destroy(),s.featureArray&&s.featureArray.destroy();if(f.children)for(const s of f.children)_S(s)}function Tk(f){if(f.meshes)for(const u of f.meshes)u.vertexBuffer&&(u.vertexBuffer.destroy(),u.indexBuffer.destroy(),u.normalBuffer&&u.normalBuffer.destroy(),u.texcoordBuffer&&u.texcoordBuffer.destroy(),u.colorBuffer&&u.colorBuffer.destroy(),u.pbrBuffer&&u.pbrBuffer.destroy(),u.segments.destroy(),u.material&&((s=u.material).pbrMetallicRoughness.baseColorTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),s.pbrMetallicRoughness.metallicRoughnessTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),s.normalTexture&&s.normalTexture.gfxTexture&&s.normalTexture.gfxTexture.destroy(),s.emissionTexture&&s.emissionTexture.gfxTexture&&s.emissionTexture.gfxTexture.destroy(),s.occlusionTexture&&s.occlusionTexture.gfxTexture&&s.occlusionTexture.gfxTexture.destroy()));var s;if(f.children)for(const u of f.children)Tk(u)}class Vx{constructor(s,u,p){this._demTile=s,this._dem=this._demTile.dem,this._scale=u,this._offset=p}static create(s,u,p){const v=p||s.findDEMTileFor(u);if(!v||!v.dem)return;const m=v.dem,_=v.tileID,P=1<<u.canonical.z-_.canonical.z;return new Vx(v,m.dim/cr/P,[(u.canonical.x/P-_.canonical.x)*m.dim,(u.canonical.y/P-_.canonical.y)*m.dim])}tileCoordToPixel(s,u){const p=u*this._scale+this._offset[1],v=Math.floor(s*this._scale+this._offset[0]),m=Math.floor(p);return new Rt(v,m)}getElevationAt(s,u,p,v){const m=s*this._scale+this._offset[0],_=u*this._scale+this._offset[1],P=Math.floor(m),O=Math.floor(_),B=this._dem;return v=!!v,p?Fr(Fr(B.get(P,O,v),B.get(P,O+1,v),_-O),Fr(B.get(P+1,O,v),B.get(P+1,O+1,v),_-O),m-P):B.get(P,O,v)}getElevationAtPixel(s,u,p){return this._dem.get(s,u,!!p)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*Gi(1,s)*this._dem.stride}}const jk=new Float32Array(262144),n0=new Uint8Array(262144);function bz(f){let s=0;if(f.meshes)for(const u of f.meshes)s=Math.max(s,u.aabb.max[2]);if(f.children)for(const u of f.children)s=Math.max(s,bz(u));return s}function wz(f,s,u){if(f.meshes)for(const p of f.meshes){if(p.aabb.min[0]===1/0)continue;const v=wr.applyTransform(p.aabb,f.matrix);u.insert(s,v.min[0],v.min[1],v.max[0],v.max[1])}if(f.children)for(const p of f.children)wz(p,s,u)}const Sz=["","wall","door","roof","window","lamp","logo"];class Nz{constructor(s){this.node=s,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:s.id,geometry:[],properties:{height:bz(s)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new wr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let s=0;const u=new wr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const p of this.node.meshes)this.node.lightMeshIndex!==s&&(p.transformedAabb=wr.applyTransformFast(p.aabb,this.node.matrix),u.encapsulate(p.transformedAabb)),s++;this.aabb=u}return this.aabb}}class bS{constructor(s,u,p,v,m,_,P){this.id=p,this.layers=s,this.layerIds=this.layers.map(O=>O.fqid),this.stateDependentLayerIds=this.layers.filter(O=>O.isStateDependent()).map(O=>O.id),this.modelTraits|=Bx.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,v&&(this.modelTraits|=Bx.HasMapboxMeshFeatures),m&&(this.modelTraits|=Bx.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=_,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const O of u)this.nodesInfo.push(new Nz(O)),wz(O,P.featureIndexArray.length,P.grid),P.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,P.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(s,u){for(const p of this.getNodesInfo()){const v=p.node;v.footprint&&u.push({footprint:v.footprint,id:s})}}update(s){const u=Object.keys(s).length!==0;if(u&&!this.stateDependentLayers.length)return;const p=u?this.stateDependentLayers:this.layers;if(!En(s,this.states))for(const v of p)this.evaluate(v,s);this.states=structuredClone(s)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(s){if(!this.needsUpload)return;const u=this.getNodesInfo();for(const p of u){const v=p.node;this.uploaded?this.updatePbrBuffer(v):Ak(v,s,!0)}for(const p of u)_S(p.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(s){let u=!1;if(!s.meshes)return u;for(const p of s.meshes)p.pbrBuffer&&(p.pbrBuffer.updateData(p.featureArray),u=!0);return u}needsReEvaluation(s,u,p){const v=s.transform.projectionOptions,m=s.style.getBrightness(),_=this.brightness!==m;if(!this.uploaded||this.dirty||v.name!==this.projection.name||bb(p.paint.get("model-color").value,_)||bb(p.paint.get("model-color-mix-intensity").value,_)||bb(p.paint.get("model-roughness").value,_)||bb(p.paint.get("model-emissive-strength").value,_)||bb(p.paint.get("model-height-based-emissive-strength-multiplier").value,_)){this.projection=v,this.brightness=m;const P=this.getNodesInfo();for(const O of P)O.state=null;return!0}return!1}evaluateScale(s,u){if(s.transform.zoom===this.zoom)return;this.zoom=s.transform.zoom;const p=this.getNodesInfo(),v=this.id.canonical;for(const m of p){const _=m.feature;m.evaluatedScale=u.paint.get("model-scale").evaluate(_,{},v)}}evaluate(s,u){const p=this.getNodesInfo();for(const v of p){if(!v.node.meshes)continue;const m=v.feature,_=u&&u[m.id];if(En(_,v.state))continue;v.state=structuredClone(_);const P=v.node.meshes&&v.node.meshes[0].featureData,O=v.evaluatedColor[2],B=v.evaluatedRMEA[2],k=this.id.canonical;if(v.hasTranslucentParts=!1,P){for(let R=0;R<Sz.length;R++){const z=Sz[R];z.length&&(m.properties.part=z);const M=s.paint.get("model-color").evaluate(m,_,k).toRenderColor(null),L=s.paint.get("model-color-mix-intensity").evaluate(m,_,k);v.evaluatedColor[R]=[M.r,M.g,M.b,L],v.evaluatedRMEA[R][0]=s.paint.get("model-roughness").evaluate(m,_,k),v.evaluatedRMEA[R][2]=s.paint.get("model-emissive-strength").evaluate(m,_,k),v.evaluatedRMEA[R][3]=M.a,v.emissionHeightBasedParams[R]=s.paint.get("model-height-based-emissive-strength-multiplier").evaluate(m,_,k),!v.hasTranslucentParts&&M.a<1&&(v.hasTranslucentParts=!0)}delete m.properties.part,hse(v,O!==v.evaluatedColor[2]||B!==v.evaluatedRMEA[2],this.modelTraits)}else v.evaluatedRMEA[0][2]=s.paint.get("model-emissive-strength").evaluate(m,_,k);v.evaluatedScale=s.paint.get("model-scale").evaluate(m,_,k),this.updatePbrBuffer(v.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(s,u,p,v){const m=s.findDEMTileFor(p);if(m&&(m.tileID.canonical!==this.terrainTile||u!==this.terrainExaggeration)){if(m.dem&&m.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=m.tileID.overscaledZ;const _=Vx.create(s,p,m);if(!_)return;this.modelTraits&Bx.HasMapboxMeshFeatures&&this.updateDEM(s,_,p,v);for(const P of this.getNodesInfo()){const O=P.node;if(!O.footprint||!O.footprint.vertices||!O.footprint.vertices.length)continue;const B=O.footprint.vertices;let k=_.getElevationAt(B[0].x,B[0].y,!0,!0);for(let R=1;R<B.length;R++)k=Math.min(k,_.getElevationAt(B[R].x,B[R].y,!0,!0));O.elevation=k}}this.terrainTile=m.tileID.canonical,this.terrainExaggeration=u}}updateDEM(s,u,p,v){let m=u._dem._modifiedForSources[v];if(m===void 0&&(u._dem._modifiedForSources[v]=[],m=u._dem._modifiedForSources[v]),m.includes(p.canonical))return;const _=u._dem.dim;m.push(p.canonical);let P=!1;for(const O of this.getNodesInfo()){const B=O.node;if(!B.footprint||!B.footprint.grid)continue;const k=B.footprint.grid,R=u.tileCoordToPixel(k.min.x,k.min.y),z=u.tileCoordToPixel(k.max.x,k.max.y),M=Math.min(Math.min(_-z.y,R.x),Math.min(R.y,_-z.x));if(M<0)continue;const L=pr(M,2,5);let q=Math.max(0,R.x-L),X=Math.max(0,R.y-L),te=Math.min(z.x+L,_-1),le=Math.min(z.y+L,_-1);for(let xe=X;xe<=le;++xe)for(let je=q;je<=te;++je)n0[xe*_+je]=255;let ce=0,ie=0;for(let xe=0;xe<k.cellsY;++xe)for(let je=0;je<k.cellsX;++je){if(!k.cells[xe*k.cellsX+je])continue;const Fe=u.tileCoordToPixel(k.min.x+je/k.xScale,k.min.y+xe/k.yScale),De=u.tileCoordToPixel(k.min.x+(je+1)/k.xScale,k.min.y+(xe+1)/k.yScale);for(let Ie=Fe.y;Ie<=Math.min(De.y+1,_-1);++Ie)for(let et=Fe.x;et<=Math.min(De.x+1,_-1);++et)n0[Ie*_+et]===255&&(n0[Ie*_+et]=0,ce+=u.getElevationAtPixel(et,Ie),ie++)}const fe=ce/ie;q=Math.max(1,R.x-L),X=Math.max(1,R.y-L),te=Math.min(z.x+L,_-2),le=Math.min(z.y+L,_-2),P=!0;for(let xe=X;xe<=le;++xe)for(let je=q;je<=te;++je)n0[xe*_+je]===0&&(jk[xe*_+je]=u._dem.set(je,xe,fe));for(let xe=1;xe<L;++xe){q=Math.max(1,R.x-xe),X=Math.max(1,R.y-xe),te=Math.min(z.x+xe,_-2),le=Math.min(z.y+xe,_-2);for(let je=X;je<=le;++je)for(let Fe=q;Fe<=te;++Fe){const De=je*_+Fe;if(n0[De]===255){let Ie=0,et=0,Ve=-1,rt=-1;for(let ot=-1;ot<=1;++ot)for(let it=-1;it<=1;++it){const ct=(je+ot)*_+Fe+it;if(n0[ct]>=xe)continue;const ft=jk[ct],xt=Math.abs(ft);xt>et&&(Ie=ft,et=xt,Ve=it,rt=ot)}if(et>.1){const ot=1-(xe+.5*Math.abs(Ve*rt))/L;let it=u._dem.get(Fe,je)+Ie*ot;const ct=u._dem.get(Fe+Ve,je+rt),ft=u._dem.get(Fe-Ve,je-rt,!0);(it-ct)*(it-ft)>0&&(it=(ct+ft)/2),jk[De]=u._dem.set(Fe,je,it),n0[De]=xe}}}}}P&&(u._demTile.needsDEMTextureUpload=!0,u._dem._timestamp=Ye.now())}getNodesInfo(){return this.nodesInfo}destroy(){const s=this.getNodesInfo();for(const u of s)_S(u.node),Tk(u.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(s,u){if(u.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=u.updateTime;const p=u.getReplacementRegionsForTile(s.toUnwrapped()),v=this.getNodesInfo();for(let m=0;m<this.nodesInfo.length;m++){const _=v[m].node;v[m].hiddenByReplacement=!!_.footprint&&!p.find(P=>P.footprint===_.footprint)}}getHeightAtTileCoord(s,u){const p=this.getNodesInfo(),v=[],m=[0,0,0],_=ze.mat4.identity([]);for(let P=0;P<this.nodesInfo.length;P++){const O=p[P],B=O.node.meshes[0],k=B.transformedAabb;if(s<k.min[0]||u<k.min[1]||s>k.max[0]||u>k.max[1])continue;if(O.node.hidden===!0)return{height:1/0,maxHeight:O.feature.properties.height,hidden:!1,verticalScale:O.evaluatedScale[2]};ze.mat4.invert(_,O.node.matrix),m[0]=s,m[1]=u,ze.vec3.transformMat4(m,m,_);const R=(m[0]-B.aabb.min[0])/(B.aabb.max[0]-B.aabb.min[0])*r0|0,z=Math.min(63,(m[1]-B.aabb.min[1])/(B.aabb.max[1]-B.aabb.min[1])*r0|0)*r0+Math.min(63,R),M=B.heightmap[z];if(!(M<0&&O.node.footprint))return O.hiddenByReplacement?void 0:{height:M,maxHeight:O.feature.properties.height,hidden:!1,verticalScale:O.evaluatedScale[2]};if(O.node.footprint.grid.query(new Rt(s,u),new Rt(s,u),v),v.length>0)return{height:void 0,maxHeight:O.feature.properties.height,hidden:O.hiddenByReplacement,verticalScale:O.evaluatedScale[2]}}}}function bb(f,s){return!f.isLightConstant&&s}function dse(f,s,u,p,v,m,_,P){let O=(61440&s|(61440&s)>>4)>>8,B=(3840&s|(3840&s)>>4)>>4,k=240&s|(240&s)>>4;u[3]>0&&(O=Fr(O,255*u[0],u[3]),B=Fr(B,255*u[1],u[3]),k=Fr(k,255*u[2],u[3]));const R=O<<8|B,z=k<<8|Math.floor(255*p[3]),M=function(xe){const je=pr(xe,0,2);return Math.min(Math.round(.5*je*255),255)}(p[2])<<8|15*p[0]<<4|15*p[1],L=pr(v[0],0,1),q=pr(v[1],0,1),X=pr(v[2],0,1),te=pr(v[3],0,1);let le,ce,ie,fe;if(L!==q&&_!==m&&q!==L){const xe=_-m;ce=1/(xe*(q-L)),ie=-(m+xe*L)/(xe*(q-L));const je=pr(v[4],-1,1);fe=Math.pow(10,je),le=255*X<<8|255*te}else le=65535,ce=0,ie=1,fe=1;if(f.emplaceBack(R,z,M,le,ce,ie,fe),P){const xe=P.length;P.clear();for(let je=0;je<xe;je++)P.emplaceBack(R,z,M,le,ce,ie,fe)}}function hse(f,s,u){const p=f.node;let v=0;const m=u&Bx.HasMeshoptCompression;for(const _ of p.meshes){if(p.lights&&p.lightMeshIndex===v||!_.featureData)continue;_.featureArray=new _h,_.featureArray.reserve(_.featureData.length);let P=s;for(const O of _.featureData){const B=m?65535&O:O>>16&65535,k=m?O>>16&65535:65535&O,R=(15&k)<8?15&k:0,z=f.evaluatedRMEA[R],M=f.evaluatedColor[R],L=f.emissionHeightBasedParams[R];let q;if(P&&R===2&&p.lights&&(q=new _h,q.resize(10*p.lights.length)),dse(_.featureArray,B,M,z,L,_.aabb.min[2],_.aabb.max[2],q),q&&P){P=!1;const X=p.meshes[p.lightMeshIndex];X.featureArray=q,X.featureArray._trim()}}_.featureArray._trim(),v++}}function Az(f,s,u,p){const v=1<<f.z;s.lat=Br((p/cr+f.y)/v),s.lng=ol((u/cr+f.x)/v)}mr(bS,"Tiled3dModelBucket",{omit:["layers"]}),mr(Nz,"Tiled3dModelFeature");const fse={circle:class extends hi{constructor(f,s,u,p){super(f,{layout:$t||($t=new qi({"circle-sort-key":new dr(vt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Jt(vt.layout_circle["circle-elevation-reference"]),visibility:new Jt(vt.layout_circle.visibility)})),paint:pt||(pt=new qi({"circle-radius":new dr(vt.paint_circle["circle-radius"]),"circle-color":new dr(vt.paint_circle["circle-color"]),"circle-blur":new dr(vt.paint_circle["circle-blur"]),"circle-opacity":new dr(vt.paint_circle["circle-opacity"]),"circle-translate":new Jt(vt.paint_circle["circle-translate"]),"circle-translate-anchor":new Jt(vt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Jt(vt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Jt(vt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new dr(vt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new dr(vt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new dr(vt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Jt(vt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p)}createBucket(f){return new _e(f)}queryRadius(f){const s=f;return kt("circle-radius",this,s)+kt("circle-stroke-width",this,s)+Pt(this.paint.get("circle-translate"))}queryIntersectsFeature(f,s,u,p,v,m,_,P){const O=Tt(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,f.pixelToTileUnitsFactor),B=this.paint.get("circle-radius").evaluate(s,u)+this.paint.get("circle-stroke-width").evaluate(s,u);return nm(f,p,m,_,P,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",O,B)}getProgramIds(){return["circle"]}getDefaultProgramParams(f,s,u){const p=Df(this);return{config:new Su(this,{zoom:s,lut:u}),defines:p,overrideFog:!1}}},heatmap:class extends hi{createBucket(f){return new q2(f)}constructor(f,s,u,p){super(f,{layout:jh||(jh=new qi({visibility:new Jt(vt.layout_heatmap.visibility)})),paint:Xy||(Xy=new qi({"heatmap-radius":new dr(vt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new dr(vt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Jt(vt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Wl(vt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Jt(vt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(f){f==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ng({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(f){return kt("heatmap-radius",this,f)}queryIntersectsFeature(f,s,u,p,v,m,_,P){const O=this.paint.get("heatmap-radius").evaluate(s,u);return nm(f,p,m,_,P,!0,!0,new Rt(0,0),O)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(f,s,u){return f==="heatmap"?{config:new Su(this,{zoom:s,lut:u}),overrideFog:!1}:{}}},hillshade:class extends hi{constructor(f,s,u,p){super(f,{layout:Ff||(Ff=new qi({visibility:new Jt(vt.layout_hillshade.visibility)})),paint:Jy||(Jy=new qi({"hillshade-illumination-direction":new Jt(vt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Jt(vt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Jt(vt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Jt(vt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Jt(vt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Jt(vt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Jt(vt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(f,s,u){return{overrideFog:!1}}},fill:class extends hi{constructor(f,s,u,p){super(f,{layout:Ss||(Ss=new qi({"fill-sort-key":new dr(vt.layout_fill["fill-sort-key"]),visibility:new Jt(vt.layout_fill.visibility),"fill-elevation-reference":new Jt(vt.layout_fill["fill-elevation-reference"])})),paint:Ut||(Ut=new qi({"fill-antialias":new Jt(vt.paint_fill["fill-antialias"]),"fill-opacity":new dr(vt.paint_fill["fill-opacity"]),"fill-color":new dr(vt.paint_fill["fill-color"]),"fill-outline-color":new dr(vt.paint_fill["fill-outline-color"]),"fill-translate":new Jt(vt.paint_fill["fill-translate"]),"fill-translate-anchor":new Jt(vt.paint_fill["fill-translate-anchor"]),"fill-pattern":new dr(vt.paint_fill["fill-pattern"]),"fill-emissive-strength":new Jt(vt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new dr(vt.paint_fill["fill-z-offset"]),"fill-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p)}getProgramIds(){const f=this.paint.get("fill-pattern"),s=f&&f.constantOr(1),u=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&u.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),u}getDefaultProgramParams(f,s,u){return{config:new Su(this,{zoom:s,lut:u}),overrideFog:!1}}recalculate(f,s){super.recalculate(f,s);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(f){return new gn(f)}queryRadius(){return Pt(this.paint.get("fill-translate"))}queryIntersectsFeature(f,s,u,p,v,m){return!f.queryGeometry.isAboveHorizon&&Ae(ht(f.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,f.pixelToTileUnitsFactor),p)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends hi{constructor(f,s,u,p){super(f,{layout:Q5||(Q5=new qi({visibility:new Jt(vt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Jt(vt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:eF||(eF=new qi({"fill-extrusion-opacity":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new dr(vt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new dr(vt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new dr(vt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new dr(vt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new dr(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new dr(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new dr(vt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new dr(vt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Jt(vt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(f){return new X2(f)}queryRadius(){return Pt(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(f,s,u,p,v,m,_,P,O){const B=Tt(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,f.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(s,u),R=this.paint.get("fill-extrusion-base").evaluate(s,u),z=[0,0],M=P&&m.elevation,L=m.elevation?m.elevation.exaggeration():1,q=f.tile.getBucket(this);if(M&&q instanceof X2){const ie=q.centroidVertexArray,fe=O+1;fe<ie.length&&(z[0]=ie.geta_centroid_pos0(fe),z[1]=ie.geta_centroid_pos1(fe))}if(z[0]===0&&z[1]===1)return!1;m.projection.name==="globe"&&(p=J5([p],[new Rt(0,0),new Rt(cr,cr)],f.tileID.canonical).map(ie=>ie.polygon).flat());const X=M?P:null,[te,le]=function(ie,fe,xe,je,Fe,De,Ie,et,Ve,rt,ot){return ie.projection.name==="globe"?function(it,ct,ft,xt,ut,Mt,qt,Et,fr,lr,Qt){const Gt=[],kr=[],yr=it.projection.upVectorScale(Qt,it.center.lat,it.worldSize).metersToTile,_r=[0,0,0,1],rn=[0,0,0,1],vn=(Nn,Dn,Bn,Ii)=>{Nn[0]=Dn,Nn[1]=Bn,Nn[2]=Ii,Nn[3]=1},Sn=X5();ft>0&&(ft+=Sn),xt+=Sn;for(const Nn of ct){const Dn=[],Bn=[];for(const Ii of Nn){const Ni=Ii.x+ut.x,fn=Ii.y+ut.y,yi=it.projection.projectTilePoint(Ni,fn,Qt),bi=it.projection.upVector(Qt,Ii.x,Ii.y);let Qi=ft,Ua=xt;if(qt){const fs=rF(Ni,fn,ft,xt,qt,Et,fr,lr);Qi+=fs.base,Ua+=fs.top}ft!==0?vn(_r,yi.x+bi[0]*yr*Qi,yi.y+bi[1]*yr*Qi,yi.z+bi[2]*yr*Qi):vn(_r,yi.x,yi.y,yi.z),vn(rn,yi.x+bi[0]*yr*Ua,yi.y+bi[1]*yr*Ua,yi.z+bi[2]*yr*Ua),ze.vec3.transformMat4(_r,_r,Mt),ze.vec3.transformMat4(rn,rn,Mt),Dn.push(new e0(_r[0],_r[1],_r[2])),Bn.push(new e0(rn[0],rn[1],rn[2]))}Gt.push(Dn),kr.push(Bn)}return[Gt,kr]}(ie,fe,xe,je,Fe,De,Ie,et,Ve,rt,ot):Ie?function(it,ct,ft,xt,ut,Mt,qt,Et,fr){const lr=[],Qt=[],Gt=[0,0,0,1];for(const kr of it){const yr=[],_r=[];for(const rn of kr){const vn=rn.x+xt.x,Sn=rn.y+xt.y,Nn=rF(vn,Sn,ct,ft,Mt,qt,Et,fr);Gt[0]=vn,Gt[1]=Sn,Gt[2]=Nn.base,Gt[3]=1,ze.vec4.transformMat4(Gt,Gt,ut),Gt[3]=Math.max(Gt[3],1e-5);const Dn=new e0(Gt[0]/Gt[3],Gt[1]/Gt[3],Gt[2]/Gt[3]);Gt[0]=vn,Gt[1]=Sn,Gt[2]=Nn.top,Gt[3]=1,ze.vec4.transformMat4(Gt,Gt,ut),Gt[3]=Math.max(Gt[3],1e-5);const Bn=new e0(Gt[0]/Gt[3],Gt[1]/Gt[3],Gt[2]/Gt[3]);yr.push(Dn),_r.push(Bn)}lr.push(yr),Qt.push(_r)}return[lr,Qt]}(fe,xe,je,Fe,De,Ie,et,Ve,rt):function(it,ct,ft,xt,ut){const Mt=[],qt=[],Et=ut[8]*ct,fr=ut[9]*ct,lr=ut[10]*ct,Qt=ut[11]*ct,Gt=ut[8]*ft,kr=ut[9]*ft,yr=ut[10]*ft,_r=ut[11]*ft;for(const rn of it){const vn=[],Sn=[];for(const Nn of rn){const Dn=Nn.x+xt.x,Bn=Nn.y+xt.y,Ii=ut[0]*Dn+ut[4]*Bn+ut[12],Ni=ut[1]*Dn+ut[5]*Bn+ut[13],fn=ut[2]*Dn+ut[6]*Bn+ut[14],yi=ut[3]*Dn+ut[7]*Bn+ut[15],bi=Ii+Et,Qi=Ni+fr,Ua=fn+lr,fs=Math.max(yi+Qt,1e-5),$a=Ii+Gt,Pa=Ni+kr,Ya=fn+yr,Ns=Math.max(yi+_r,1e-5);vn.push(new e0(bi/fs,Qi/fs,Ua/fs)),Sn.push(new e0($a/Ns,Pa/Ns,Ya/Ns))}Mt.push(vn),qt.push(Sn)}return[Mt,qt]}(fe,xe,je,Fe,De)}(m,p,R,k,B,_,X,z,L,m.center.lat,f.tileID.canonical),ce=f.queryGeometry;return function(ie,fe,xe){let je=1/0;Ae(xe,fe)&&(je=tF(xe,fe[0]));for(let Fe=0;Fe<fe.length;Fe++){const De=fe[Fe],Ie=ie[Fe];for(let et=0;et<De.length-1;et++){const Ve=De[et],rt=[Ve,De[et+1],Ie[et+1],Ie[et],Ve];ge(xe,rt)&&(je=Math.min(je,tF(xe,rt)))}}return je!==1/0&&je}(te,le,ce.isPointQuery()?ce.screenBounds:ce.screenGeometry)}},line:class extends hi{constructor(f,s,u,p){const v=hF();super(f,v,s,u,p),v.layout&&(this.layout=new hd(v.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(f){if(f==="line-gradient"){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof eh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(f,s){super.recalculate(f,s),this.paint._values["line-floorwidth"]=(()=>{if(cb)return cb;const u=hF();return cb=new mae(u.paint.properties["line-width"].specification),cb.useIntegerZoom=!0,cb})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,f)}createBucket(f){return new Qj(f)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(f,s,u){const p=uF(this);return{config:new Su(this,{zoom:s,lut:u}),defines:p,overrideFog:!1}}queryRadius(f){const s=f,u=fF(kt("line-width",this,s),kt("line-gap-width",this,s)),p=kt("line-offset",this,s);return u/2+Math.abs(p)+Pt(this.paint.get("line-translate"))}queryIntersectsFeature(f,s,u,p,v,m){if(f.queryGeometry.isAboveHorizon)return!1;const _=ht(f.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,f.pixelToTileUnitsFactor),P=f.pixelToTileUnitsFactor/2*fF(this.paint.get("line-width").evaluate(s,u),this.paint.get("line-gap-width").evaluate(s,u)),O=this.paint.get("line-offset").evaluate(s,u);return O&&(p=function(B,k){const R=[],z=new Rt(0,0);for(let M=0;M<B.length;M++){const L=B[M],q=[];for(let X=0;X<L.length;X++){const te=L[X],le=L[X+1],ce=X===0?z:te.sub(L[X-1])._unit()._perp(),ie=X===L.length-1?z:le.sub(te)._unit()._perp(),fe=ce._add(ie)._unit();fe._mult(1/(fe.x*ie.x+fe.y*ie.y)),q.push(fe._mult(k)._add(te))}R.push(q)}return R}(p,O*f.pixelToTileUnitsFactor)),function(B,k,R){for(let z=0;z<k.length;z++){const M=k[z];if(B.length>=3){for(let L=0;L<M.length;L++)if(He(B,M[L]))return!0}if(Re(B,M,R))return!0}return!1}(_,p,P)}isTileClipped(){return!0}isDraped(f){return!this.hasElevatedBuckets}},symbol:fS,background:class extends hi{constructor(f,s,u,p){super(f,{layout:YF||(YF=new qi({visibility:new Jt(vt.layout_background.visibility)})),paint:XF||(XF=new qi({"background-pitch-alignment":new Jt(vt.paint_background["background-pitch-alignment"]),"background-color":new Jt(vt.paint_background["background-color"]),"background-pattern":new Jt(vt.paint_background["background-pattern"]),"background-opacity":new Jt(vt.paint_background["background-opacity"]),"background-emissive-strength":new Jt(vt.paint_background["background-emissive-strength"]),"background-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(f,s,u){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:rz,"raster-particle":lz,sky:class extends hi{constructor(f,s,u,p){super(f,{layout:az||(az=new qi({visibility:new Jt(vt.layout_sky.visibility)})),paint:sz||(sz=new qi({"sky-type":new Jt(vt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Jt(vt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Jt(vt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Jt(vt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Jt(vt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Wl(vt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Jt(vt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Jt(vt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Jt(vt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(f){f==="sky-gradient"?this._updateColorRamp():f!=="sky-atmosphere-sun"&&f!=="sky-atmosphere-halo-color"&&f!=="sky-atmosphere-color"&&f!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Ng({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(f){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=f.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(f,s){if(this.paint.get("sky-type")==="atmosphere"){const p=this.paint.get("sky-atmosphere-sun"),v=!p,m=f.style.light,_=m.properties.get("position");return v&&m.properties.get("anchor")==="viewport"&&ln("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),v?bk(_.azimuthal,90-_.polar,s):bk(p[0],90-p[1],s)}const u=this.paint.get("sky-gradient-center");return bk(u[0],90-u[1],s)}isSky(){return!0}markSkyboxValid(f){this._skyboxInvalidated=!1,this._lightPosition=f.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const f=this.paint.get("sky-type");return f==="atmosphere"?["skyboxCapture","skybox"]:f==="gradient"?["skyboxGradient"]:null}},slot:class extends hi{constructor(f,s,u,p){super(f,{paint:oz||(oz=new qi({}))},s,null)}},model:class extends hi{constructor(f,s,u,p){super(f,{layout:xz||(xz=new qi({visibility:new Jt(vt.layout_model.visibility),"model-id":new dr(vt.layout_model["model-id"])})),paint:vz||(vz=new qi({"model-opacity":new dr(vt.paint_model["model-opacity"]),"model-rotation":new dr(vt.paint_model["model-rotation"]),"model-scale":new dr(vt.paint_model["model-scale"]),"model-translation":new dr(vt.paint_model["model-translation"]),"model-color":new dr(vt.paint_model["model-color"]),"model-color-mix-intensity":new dr(vt.paint_model["model-color-mix-intensity"]),"model-type":new Jt(vt.paint_model["model-type"]),"model-cast-shadows":new Jt(vt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Jt(vt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Jt(vt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new dr(vt.paint_model["model-emissive-strength"]),"model-roughness":new dr(vt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new dr(vt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Jt(vt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Jt(vt.paint_model["model-front-cutoff"]),"model-color-use-theme":new dr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(f){return new Nk(f)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(f){return f instanceof bS?cr-1:0}queryIntersectsFeature(f,s,u,p,v,m){if(!this.modelManager)return!1;const _=this.modelManager,P=f.tile.getBucket(this);if(!(P&&P instanceof Nk))return!1;for(const O in P.instancesPerModel){const B=P.instancesPerModel[O],k=s.id!==void 0?s.id:s.properties&&s.properties.hasOwnProperty("id")?s.properties.id:void 0;if(B.idToFeaturesIndex.hasOwnProperty(k)){const R=B.features[B.idToFeaturesIndex[k]],z=_.getModel(O,this.scope);if(!z)return!1;let M=ze.mat4.create();const L=new Kn(0,0),q=P.canonical;let X=Number.MAX_VALUE;for(let te=0;te<R.instancedDataCount;++te){const le=16*(R.instancedDataOffset+te),ce=B.instancedDataArray.float32,ie=[ce[le+4],ce[le+5],ce[le+6]];Az(q,L,ce[le],0|ce[le+1]),_z(M,z,m,L,R.rotation,R.scale,ie,!1,!1,!1),m.projection.name==="globe"&&(M=Sk(M,m));const fe=ze.mat4.multiply([],m.projMatrix,M),xe=f.queryGeometry,je=fz(xe.isPointQuery()?xe.screenBounds:xe.screenGeometry,m,fe,z.aabb);je!=null&&(X=Math.min(je,X))}return X!==Number.MAX_VALUE&&X}}return!1}_handleOverridablePaintPropertyUpdate(f,s,u){return!(!this.layout||s.isDataDriven()||u.isDataDriven()||f!=="model-color"&&f!=="model-color-mix-intensity"&&f!=="model-rotation"&&f!=="model-scale"&&f!=="model-translation"&&f!=="model-emissive-strength")}_isPropertyZoomDependent(f){const s=this._transitionablePaint._values[f];return s!=null&&s.value!=null&&s.value.expression!=null&&s.value.expression instanceof ch}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends hi{constructor(f,s,u,p){super(f,{layout:Ct||(Ct=new qi({"clip-layer-types":new Jt(vt.layout_clip["clip-layer-types"]),"clip-layer-scope":new Jt(vt.layout_clip["clip-layer-scope"])})),paint:Wt||(Wt=new qi({}))},s,u,p)}recalculate(f,s){super.recalculate(f,s)}createBucket(f){return new zn(f)}isTileClipped(){return!0}is3D(){return!0}}};class pse{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class mse{constructor(){this.tasks={},this.taskQueue=[],Eo(["process"],this),this.invoker=new pse(this.process),this.nextId=0}add(s,u){const p=this.nextId++,v=function({type:m,isSymbolTile:_,zoom:P}){return P=P||0,m==="message"?0:m!=="maybePrepare"||_?m!=="parseTile"||_?m==="parseTile"&&_?300-P:m==="maybePrepare"&&_?400-P:500:200-P:100-P}(u);if(v===0){try{s()}finally{}return null}return this.tasks[p]={fn:s,metadata:u,priority:v,id:p},this.taskQueue.push(p),this.invoker.trigger(),{cancel:()=>{delete this.tasks[p]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(p=>!!this.tasks[p]),!this.taskQueue.length)return;const s=this.pick();if(s===null)return;const u=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!u)return;u.fn()}finally{}}pick(){let s=null,u=1/0;for(let v=0;v<this.taskQueue.length;v++){const m=this.tasks[this.taskQueue[v]];m.priority<u&&(u=m.priority,s=v)}if(s===null)return null;const p=this.taskQueue[s];return this.taskQueue.splice(s,1),p}remove(){this.invoker.remove()}}class Tz{constructor(s,u,p){this.target=s,this.parent=u,this.mapId=p,this.callbacks={},this.cancelCallbacks={},Eo(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new mse}send(s,u,p,v,m=!1,_){const P=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(p.metadata=_,this.callbacks[P]=p);const O=new Set;return this.target.postMessage({id:P,type:s,hasCallback:!!p,targetMapId:v,mustQueue:m,sourceMapId:this.mapId,data:_o(u,O)},O),{cancel:()=>{p&&delete this.callbacks[P],this.target.postMessage({id:P,type:"<cancel>",targetMapId:v,sourceMapId:this.mapId})}}}receive(s){const u=s.data,p=u.id;if(p&&(!u.targetMapId||this.mapId===u.targetMapId))if(u.type==="<cancel>"){const v=this.cancelCallbacks[p];delete this.cancelCallbacks[p],v&&v.cancel()}else if(u.mustQueue||eo()){const v=this.callbacks[p],m=this.scheduler.add(()=>this.processTask(p,u),v&&v.metadata||{type:"message"});m&&(this.cancelCallbacks[p]=m)}else this.processTask(p,u)}processTask(s,u){if(delete this.cancelCallbacks[s],u.type==="<response>"){const p=this.callbacks[s];delete this.callbacks[s],p&&(u.error?p(wl(u.error)):p(null,wl(u.data)))}else{const p=new Set,v=u.hasCallback?(_,P)=>{this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:_?_o(_):null,data:_o(P,p)},p)}:()=>{},m=wl(u.data);if(this.parent[u.type])this.parent[u.type](u.sourceMapId,m,v);else if(this.parent.getWorkerSource){const _=u.type.split(".");this.parent.getWorkerSource(u.sourceMapId,_[0],m.source,m.scope)[_[1]](m,v)}else v(new Error(`Could not find function ${u.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var wb={workerUrl:"",workerClass:null,workerParams:void 0};const kk="mapboxgl_preloaded_worker_pool";class i0{constructor(){this.active={}}acquire(s,u=i0.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<u;)this.workers.push(wb.workerClass!=null?new wb.workerClass:new self.Worker(wb.workerUrl,wb.workerParams));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.workers&&this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[kk]}numActive(){return Object.keys(this.active).length}}i0.workerCount=2;class Ux{constructor(s,u,p="Worker",v=i0.workerCount){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=Wa();const m=this.workerPool.acquire(this.id,v);for(let _=0;_<m.length;_++){const P=new Ux.Actor(m[_],u,this.id);P.name=`${p} ${_}`,this.actors.push(P)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(s,u,p){Vi(this.actors,(v,m)=>{v.send(s,u,m)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(s=>{s.remove()}),this.actors=[],this.workerPool.release(this.id)}}let Sb,Pk;function wS(){return Sb||(Sb=new i0),Sb}Ux.Actor=Tz;const Ck=new Xn(0,0,0);var Ek=(f=>(f[f.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",f[f.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",f[f.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",f))(Ek||{}),SS=(f=>(f[f.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",f[f.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",f[f.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",f[f.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",f))(SS||{}),Nb=(f=>(f[f.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",f[f.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",f[f.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",f[f.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",f[f.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",f))(Nb||{}),jz=(f=>(f[f.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",f[f.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",f[f.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",f))(jz||{}),$x=(f=>(f[f.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",f[f.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",f[f.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",f[f.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",f[f.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",f[f.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",f))($x||{}),kz=(f=>(f[f.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",f[f.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",f[f.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",f))(kz||{});function gse(f,s,u){f===1&&s.icons.push(function(p,v){return function(m){if(m.usvg_tree.height||(m.usvg_tree.height=m.usvg_tree.width),!m.metadata)return m;const{metadata:_}=m;if(_.content_area){const{content_area:P}=_;P.top==null&&(P.top=P.left),P.width==null&&(P.width=m.usvg_tree.width),P.height==null&&(P.height=P.width)}return _.stretch_x&&_.stretch_x.length&&Pz(_,"x"),_.stretch_y&&_.stretch_y.length&&Pz(_,"y"),m}(p.readFields(yse,{name:void 0},v))}(u,u.readVarint()+u.pos))}function Pz(f,s){const u=[],p=f[`stretch_${s}`];let v=null;for(let m=0;m<p.length;m++)v===null?v=u.length===0?p[0]:u[u.length-1][1]+p[m]:(u.push([v,v+p[m]]),v=null);f[`stretch_${s}_areas`]=u}function yse(f,s,u){f===1?s.name=u.readString():f===2?s.metadata=function(p,v){return p.readFields(xse,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},v)}(u,u.readVarint()+u.pos):f===3&&(s.usvg_tree=function(p,v){return p.readFields(bse,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},v)}(u,u.readVarint()+u.pos),s.data="usvg_tree")}function xse(f,s,u){f===1?s.stretch_x=u.readPackedVarint():f===2?s.stretch_y=u.readPackedVarint():f===3?s.content_area=function(p,v){return p.readFields(vse,{left:0},v)}(u,u.readVarint()+u.pos):f===4&&s.variables.push(function(p,v){return p.readFields(_se,{name:void 0},v)}(u,u.readVarint()+u.pos))}function vse(f,s,u){f===1?s.left=u.readVarint():f===2?s.width=u.readVarint():f===3?s.top=u.readVarint():f===4&&(s.height=u.readVarint())}function _se(f,s,u){f===1?s.name=u.readString():f===2&&(s.rgb_color=TS(u.readVarint()),s.value="rgb_color")}function bse(f,s,u){f===1?s.width=s.height=u.readVarint():f===2?s.height=u.readVarint():f===3?s.children.push(NS(u,u.readVarint()+u.pos)):f===4?s.linear_gradients.push(function(p,v){return p.readFields(kse,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},v)}(u,u.readVarint()+u.pos)):f===5?s.radial_gradients.push(function(p,v){return p.readFields(Cse,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},v)}(u,u.readVarint()+u.pos)):f===7?s.clip_paths.push(function(p,v){return p.readFields(Ese,{children:[]},v)}(u,u.readVarint()+u.pos)):f===8&&s.masks.push(function(p,v){const m=p.readFields(Mse,{left:0,width:20,mask_type:1,children:[]},v);return m.height==null&&(m.height=m.width),m.top==null&&(m.top=m.left),m}(u,u.readVarint()+u.pos))}function NS(f,s){return f.readFields(wse,{},s)}function wse(f,s,u){f===1?(s.group=function(p,v){return p.readFields(Sse,{opacity:255,children:[]},v)}(u,u.readVarint()+u.pos),s.node="group"):f===2&&(s.path=function(p,v){return p.readFields(Ase,{paint_order:1,commands:[],step:1,diffs:[],rule:1},v)}(u,u.readVarint()+u.pos),s.node="path")}function Sse(f,s,u){f===1?s.transform=AS(u,u.readVarint()+u.pos):f===2?s.opacity=u.readVarint():f===5?s.clip_path_idx=u.readVarint():f===6?s.mask_idx=u.readVarint():f===7&&s.children.push(NS(u,u.readVarint()+u.pos))}function AS(f,s){return f.readFields(Nse,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},s)}function Nse(f,s,u){f===1?s.sx=u.readFloat():f===2?s.ky=u.readFloat():f===3?s.kx=u.readFloat():f===4?s.sy=u.readFloat():f===5?s.tx=u.readFloat():f===6&&(s.ty=u.readFloat())}function Ase(f,s,u){f===1?s.fill=function(p,v){return p.readFields(Tse,{rgb_color:Ck,paint:"rgb_color",opacity:255},v)}(u,u.readVarint()+u.pos):f===2?s.stroke=function(p,v){return p.readFields(jse,{rgb_color:Ck,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},v)}(u,u.readVarint()+u.pos):f===3?s.paint_order=u.readVarint():f===5?u.readPackedVarint(s.commands):f===6?s.step=u.readFloat():f===7?u.readPackedSVarint(s.diffs):f===8&&(s.rule=u.readVarint())}function Tse(f,s,u){f===1?(s.rgb_color=TS(u.readVarint()),s.paint="rgb_color"):f===2?(s.linear_gradient_idx=u.readVarint(),s.paint="linear_gradient_idx"):f===3?(s.radial_gradient_idx=u.readVarint(),s.paint="radial_gradient_idx"):f===5&&(s.opacity=u.readVarint())}function TS(f){return new Xn((f>>16&255)/255,(f>>8&255)/255,(255&f)/255,1)}function jse(f,s,u){f===1?(s.rgb_color=TS(u.readVarint()),s.paint="rgb_color"):f===2?(s.linear_gradient_idx=u.readVarint(),s.paint="linear_gradient_idx"):f===3?(s.radial_gradient_idx=u.readVarint(),s.paint="radial_gradient_idx"):f===5?u.readPackedFloat(s.dasharray):f===6?s.dashoffset=u.readFloat():f===7?s.miterlimit=u.readFloat():f===8?s.opacity=u.readVarint():f===9?s.width=u.readFloat():f===10?s.linecap=u.readVarint():f===11&&(s.linejoin=u.readVarint())}function kse(f,s,u){f===1?s.transform=AS(u,u.readVarint()+u.pos):f===2?s.spread_method=u.readVarint():f===3?s.stops.push(Cz(u,u.readVarint()+u.pos)):f===4?s.x1=u.readFloat():f===5?s.y1=u.readFloat():f===6?s.x2=u.readFloat():f===7&&(s.y2=u.readFloat())}function Cz(f,s){return f.readFields(Pse,{offset:0,opacity:255,rgb_color:Ck},s)}function Pse(f,s,u){f===1?s.offset=u.readFloat():f===2?s.opacity=u.readVarint():f===3&&(s.rgb_color=TS(u.readVarint()))}function Cse(f,s,u){f===1?s.transform=AS(u,u.readVarint()+u.pos):f===2?s.spread_method=u.readVarint():f===3?s.stops.push(Cz(u,u.readVarint()+u.pos)):f===4?s.cx=u.readFloat():f===5?s.cy=u.readFloat():f===6?s.r=u.readFloat():f===7?s.fx=u.readFloat():f===8?s.fy=u.readFloat():f===9&&(s.fr=u.readFloat())}function Ese(f,s,u){f===1?s.transform=AS(u,u.readVarint()+u.pos):f===2?s.clip_path_idx=u.readVarint():f===3&&s.children.push(NS(u,u.readVarint()+u.pos))}function Mse(f,s,u){f===1?s.left=s.top=u.readFloat():f===2?s.width=s.height=u.readFloat():f===3?s.top=u.readFloat():f===4?s.height=u.readFloat():f===5?s.mask_type=u.readVarint():f===6?s.mask_idx=u.readVarint():f===7&&s.children.push(NS(u,u.readVarint()+u.pos))}class Ose{static calculate(s,u){const p=new Map,v=new Map;if(Object.keys(s).length===0)return p;u.forEach(m=>{v.set(m.name,m.rgb_color||new Xn(0,0,0))});for(const[m,_]of Object.entries(s))v.has(m)?p.set(v.get(m).toStringPremultipliedAlpha(),_):console.warn(`Ignoring unknown image variable "${m}"`);return p}}function qx(f,s=255,u){const p=s/255,v=f.toStringPremultipliedAlpha(),m=u.has(v)?u.get(v).clone():f.clone();return m.a=p,m.toString()}function Ab(f,s){if(!Oe()){const u=document.createElement("canvas");return u.width=f,u.height=s,u}return new OffscreenCanvas(f,s)}function Rse(f,s){const u=Ose.calculate(s.params,f.metadata?f.metadata.variables:[]),p=f.usvg_tree,v=p.width,m=p.height,_=s.transform?s.transform:new DOMMatrix,P=Math.max(1,Math.round(v*_.a)),O=Math.max(1,Math.round(m*_.d)),B=new DOMMatrix([P/v,0,0,O/m,0,0]),k=Ab(P,O).getContext("2d");return Mk(k,B,p,p,u),k.getImageData(0,0,P,O)}function Mk(f,s,u,p,v){for(const m of p.children)Ez(f,s,u,m,v)}function Ez(f,s,u,p,v){p.group?(f.save(),function(m,_,P,O,B){const k=O.mask_idx!=null?P.masks[O.mask_idx]:null,R=O.clip_path_idx!=null?P.clip_paths[O.clip_path_idx]:null;if(O.transform&&(_=jS(O.transform).preMultiplySelf(_)),!function(L,q,X){return L.opacity!==255||q||X}(O,R!=null,k!=null))return void Mk(m,_,P,O,B);const z=Ab(m.canvas.width,m.canvas.height),M=z.getContext("2d");Mk(M,_,P,O,B),R&&Fz(M,_,P,R),k&&zz(M,_,P,k,B),m.globalAlpha=O.opacity/255,m.drawImage(z,0,0)}(f,s,u,p.group,v),f.restore()):p.path&&(f.save(),function(m,_,P,O,B){const k=Bz(O);m.setTransform(_),O.paint_order===jz.PAINT_ORDER_FILL_AND_STROKE?(Mz(m,P,O,k,B),Rz(m,P,O,k,B)):(Rz(m,P,O,k,B),Mz(m,P,O,k,B))}(f,s,u,p.path,v),f.restore())}function Mz(f,s,u,p,v){const m=u.fill;if(!m)return;const _=m.opacity/255;switch(m.paint){case"rgb_color":f.fillStyle=qx(m.rgb_color,m.opacity,v);break;case"linear_gradient_idx":f.fillStyle=Iz(f,s.linear_gradients[m.linear_gradient_idx],_,v);break;case"radial_gradient_idx":f.fillStyle=Lz(f,s.radial_gradients[m.radial_gradient_idx],_,v)}f.fill(p,Oz(u))}function Oz(f){return f.rule===Ek.PATH_RULE_NON_ZERO?"nonzero":f.rule===Ek.PATH_RULE_EVEN_ODD?"evenodd":void 0}function Rz(f,s,u,p,v){const m=u.stroke;if(!m)return;f.lineWidth=m.width,f.miterLimit=m.miterlimit,f.setLineDash(m.dasharray),f.lineDashOffset=m.dashoffset;const _=m.opacity/255;switch(m.paint){case"rgb_color":f.strokeStyle=qx(m.rgb_color,m.opacity,v);break;case"linear_gradient_idx":f.strokeStyle=Iz(f,s.linear_gradients[m.linear_gradient_idx],_,v);break;case"radial_gradient_idx":f.strokeStyle=Lz(f,s.radial_gradients[m.radial_gradient_idx],_,v)}switch(m.linejoin){case Nb.LINE_JOIN_MITER_CLIP:case Nb.LINE_JOIN_MITER:f.lineJoin="miter";break;case Nb.LINE_JOIN_ROUND:f.lineJoin="round";break;case Nb.LINE_JOIN_BEVEL:f.lineJoin="bevel"}switch(m.linecap){case SS.LINE_CAP_BUTT:f.lineCap="butt";break;case SS.LINE_CAP_ROUND:f.lineCap="round";break;case SS.LINE_CAP_SQUARE:f.lineCap="square"}f.stroke(p)}function Iz(f,s,u,p){if(s.stops.length===1){const z=s.stops[0];return qx(z.rgb_color,z.opacity*u,p)}const v=jS(s.transform),{x1:m,y1:_,x2:P,y2:O}=s,B=v.transformPoint(new DOMPoint(m,_)),k=v.transformPoint(new DOMPoint(P,O)),R=f.createLinearGradient(B.x,B.y,k.x,k.y);for(const z of s.stops)R.addColorStop(z.offset,qx(z.rgb_color,z.opacity*u,p));return R}function Lz(f,s,u,p){if(s.stops.length===1){const z=s.stops[0];return qx(z.rgb_color,z.opacity*u,p)}const v=jS(s.transform),{fx:m,fy:_,cx:P,cy:O}=s,B=v.transformPoint(new DOMPoint(m,_)),k=v.transformPoint(new DOMPoint(P,O)),R=f.createRadialGradient(B.x,B.y,0,k.x,k.y,s.r*((v.a+v.d)/2));for(const z of s.stops)R.addColorStop(z.offset,qx(z.rgb_color,z.opacity*u,p));return R}function Dz(f,s,u,p){const v=p.transform?jS(p.transform).preMultiplySelf(s):s,m=Ab(f.canvas.width,f.canvas.height),_=m.getContext("2d");for(const O of p.children)if(O.group)Dz(_,v,u,O.group);else if(O.path){const B=O.path,k=new Path2D;k.addPath(Bz(B),v),_.fill(k,Oz(B))}const P=p.clip_path_idx!=null?u.clip_paths[p.clip_path_idx]:null;P&&Fz(_,v,u,P),f.globalCompositeOperation="source-over",f.drawImage(m,0,0)}function Fz(f,s,u,p){const v=Ab(f.canvas.width,f.canvas.height);Dz(v.getContext("2d"),s,u,p),f.globalCompositeOperation="destination-in",f.drawImage(v,0,0)}function zz(f,s,u,p,v){if(p.children.length===0)return;const m=p.mask_idx!=null?u.masks[p.mask_idx]:null;m&&zz(f,s,u,m,v);const _=f.canvas.width,P=f.canvas.height,O=Ab(_,P),B=O.getContext("2d"),k=p.width,R=p.height,z=p.left,M=p.top,L=new Path2D,q=new Path2D;q.rect(z,M,k,R),L.addPath(q,s),B.clip(L);for(const le of p.children)Ez(B,s,u,le,v);const X=B.getImageData(0,0,_,P),te=X.data;if(p.mask_type===kz.MASK_TYPE_LUMINANCE)for(let le=0;le<te.length;le+=4)te[le+3]=te[le+3]/255*(.2126*te[le]+.7152*te[le+1]+.0722*te[le+2]);B.putImageData(X,0,0),f.globalCompositeOperation="destination-in",f.drawImage(O,0,0)}function jS(f){return f?new DOMMatrix([f.sx,f.ky,f.kx,f.sy,f.tx,f.ty]):new DOMMatrix}function Bz(f){const s=new Path2D,u=f.step;let p=f.diffs[0]*u,v=f.diffs[1]*u;s.moveTo(p,v);for(let m=0,_=2;m<f.commands.length;m++)switch(f.commands[m]){case $x.PATH_COMMAND_MOVE:p+=f.diffs[_++]*u,v+=f.diffs[_++]*u,s.moveTo(p,v);break;case $x.PATH_COMMAND_LINE:p+=f.diffs[_++]*u,v+=f.diffs[_++]*u,s.lineTo(p,v);break;case $x.PATH_COMMAND_QUAD:{const P=p+f.diffs[_++]*u,O=v+f.diffs[_++]*u;p=P+f.diffs[_++]*u,v=O+f.diffs[_++]*u,s.quadraticCurveTo(P,O,p,v);break}case $x.PATH_COMMAND_CUBIC:{const P=p+f.diffs[_++]*u,O=v+f.diffs[_++]*u,B=P+f.diffs[_++]*u,k=O+f.diffs[_++]*u;p=B+f.diffs[_++]*u,v=k+f.diffs[_++]*u,s.bezierCurveTo(P,O,B,k,p,v);break}case $x.PATH_COMMAND_CLOSE:s.closePath()}return s}class Ok{constructor(s){this.capacity=s,this.cache=new Map}get(s){if(!this.cache.has(s))return;const u=this.cache.get(s);return this.cache.delete(s),this.cache.set(s,u),u}put(s,u){this.cache.has(s)?this.cache.delete(s):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(s,u)}delete(s){this.cache.delete(s)}}class Rk{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(s){return new Ks(s,s.data)}getFromCache(s,u,p){return this.cacheMap.has(p)||this.cacheMap.set(p,new Ok(150)),this.cacheMap.get(p).get(Do(s.serialize(),u))}setInCache(s,u,p,v){this.cacheDependenciesMap.has(v)||this.cacheDependenciesMap.set(v,new Map),this.cacheMap.has(v)||this.cacheMap.set(v,new Ok(150));const m=this.cacheDependenciesMap.get(v);m.get(Do(s.id,p))||m.set(Do(s.id,p),new Set);const _=this.cacheMap.get(v),P=s.serialize();m.get(Do(s.id,p)).add(P),_.put(Do(s.serialize(),p),u)}removeImagesFromCacheByIds(s,u,p=""){if(!this.cacheMap.has(p)||!this.cacheDependenciesMap.has(p))return;const v=this.cacheMap.get(p),m=this.cacheDependenciesMap.get(p);for(const _ of s)if(m.has(Do(_,u))){for(const P of m.get(Do(_,u)))v.delete(P);m.delete(Do(_,u))}}rasterize(s,u,p,v,m=Rse){const _=this.getFromCache(s,p,v);if(_)return _.clone();const P=m(u.icon,s.options),O=Rk._getImage(P);return this.setInCache(s,O,p,v),O.clone()}}class Vz{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,u){const p=this.toIdx(s,u);return{min:this.minimums[p],max:this.maximums[p]}}isLeaf(s,u){return this.leaves[this.toIdx(s,u)]}toIdx(s,u){return u*this.size+s}}function Uz(f,s,u,p){let v=0,m=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(p[_])<1e-15){if(u[_]<f[_]||u[_]>s[_])return null}else{const P=1/p[_];let O=(f[_]-u[_])*P,B=(s[_]-u[_])*P;if(O>B){const k=O;O=B,B=k}if(O>v&&(v=O),B<m&&(m=B),v>m)return null}return v}function $z(f,s,u,p,v,m,_,P,O,B,k){const R=p-f,z=v-s,M=m-u,L=_-f,q=P-s,X=O-u,te=k[1]*X-k[2]*q,le=k[2]*L-k[0]*X,ce=k[0]*q-k[1]*L,ie=R*te+z*le+M*ce;if(Math.abs(ie)<1e-15)return null;const fe=1/ie,xe=B[0]-f,je=B[1]-s,Fe=B[2]-u,De=(xe*te+je*le+Fe*ce)*fe;if(De<0||De>1)return null;const Ie=je*M-Fe*z,et=Fe*R-xe*M,Ve=xe*z-je*R,rt=(k[0]*Ie+k[1]*et+k[2]*Ve)*fe;return rt<0||De+rt>1?null:(L*Ie+q*et+X*Ve)*fe}function qz(f,s,u){return(f-s)/(u-s)}function Gz(f,s,u,p,v,m,_,P,O){const B=1<<u,k=m-p,R=_-v,z=(f+1)/B*k+p,M=(s+0)/B*R+v,L=(s+1)/B*R+v;P[0]=(f+0)/B*k+p,P[1]=M,O[0]=z,O[1]=L}class Wz{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const u=function(m){const _=Math.ceil(Math.log2(m.dim/8)),P=[];let O=Math.ceil(Math.pow(2,_));const B=1/O,k=(M,L,q,X,te)=>{const le=X?1:0,ce=(M+1)*q-le,ie=L*q,fe=(L+1)*q-le;te[0]=M*q,te[1]=ie,te[2]=ce,te[3]=fe};let R=new Vz(O);const z=[];for(let M=0;M<O*O;M++){k(M%O,Math.floor(M/O),B,!1,z);const L=Mg(z[0],z[1],m),q=Mg(z[2],z[1],m),X=Mg(z[2],z[3],m),te=Mg(z[0],z[3],m);R.minimums.push(Math.min(L,q,X,te)),R.maximums.push(Math.max(L,q,X,te)),R.leaves.push(1)}for(P.push(R),O/=2;O>=1;O/=2){const M=P[P.length-1];R=new Vz(O);for(let L=0;L<O*O;L++){k(L%O,Math.floor(L/O),2,!0,z);const q=M.getElevation(z[0],z[1]),X=M.getElevation(z[2],z[1]),te=M.getElevation(z[2],z[3]),le=M.getElevation(z[0],z[3]),ce=M.isLeaf(z[0],z[1]),ie=M.isLeaf(z[2],z[1]),fe=M.isLeaf(z[2],z[3]),xe=M.isLeaf(z[0],z[3]),je=Math.min(q.min,X.min,te.min,le.min),Fe=Math.max(q.max,X.max,te.max,le.max),De=ce&&ie&&fe&&xe;R.maximums.push(Fe),R.minimums.push(je),R.leaves.push(Fe-je<=5&&De?1:0)}P.push(R)}return P}(this.dem),p=u.length-1,v=u[p];this._addNode(v.minimums[0],v.maximums[0],v.leaves[0]),this._construct(u,0,0,p,0)}raycastRoot(s,u,p,v,m,_,P=1){return Uz([s,u,-100],[p,v,this.maximums[0]*P],m,_)}raycast(s,u,p,v,m,_,P=1){if(!this.nodeCount)return null;const O=this.raycastRoot(s,u,p,v,m,_,P);if(O==null)return null;const B=[],k=[],R=[],z=[],M=[{idx:0,t:O,nodex:0,nodey:0,depth:0}];for(;M.length>0;){const{idx:L,t:q,nodex:X,nodey:te,depth:le}=M.pop();if(this.leaves[L]){Gz(X,te,le,s,u,p,v,R,z);const ie=1<<le,fe=(X+0)/ie,xe=(X+1)/ie,je=(te+0)/ie,Fe=(te+1)/ie,De=Mg(fe,je,this.dem)*P,Ie=Mg(xe,je,this.dem)*P,et=Mg(xe,Fe,this.dem)*P,Ve=Mg(fe,Fe,this.dem)*P,rt=$z(R[0],R[1],De,z[0],R[1],Ie,z[0],z[1],et,m,_),ot=$z(z[0],z[1],et,R[0],z[1],Ve,R[0],R[1],De,m,_),it=Math.min(rt!==null?rt:Number.MAX_VALUE,ot!==null?ot:Number.MAX_VALUE);if(it!==Number.MAX_VALUE)return it;{const ct=ze.vec3.scaleAndAdd([],m,_,q);if(Hz(De,Ie,Ve,et,qz(ct[0],R[0],z[0]),qz(ct[1],R[1],z[1]))>=ct[2])return q}continue}let ce=0;for(let ie=0;ie<this._siblingOffset.length;ie++){Gz((X<<1)+this._siblingOffset[ie][0],(te<<1)+this._siblingOffset[ie][1],le+1,s,u,p,v,R,z),R[2]=-100,z[2]=this.maximums[this.childOffsets[L]+ie]*P;const fe=Uz(R,z,m,_);if(fe!=null){const xe=fe;B[ie]=xe;let je=!1;for(let Fe=0;Fe<ce&&!je;Fe++)xe>=B[k[Fe]]&&(k.splice(Fe,0,ie),je=!0);je||(k[ce]=ie),ce++}}for(let ie=0;ie<ce;ie++){const fe=k[ie];M.push({idx:this.childOffsets[L]+fe,t:B[fe],nodex:(X<<1)+this._siblingOffset[fe][0],nodey:(te<<1)+this._siblingOffset[fe][1],depth:le+1})}}return null}_addNode(s,u,p){return this.minimums.push(s),this.maximums.push(u),this.leaves.push(p),this.childOffsets.push(0),this.nodeCount++}_construct(s,u,p,v,m){if(s[v].isLeaf(u,p)===1)return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const _=v-1,P=s[_];let O=0,B=0;for(let k=0;k<this._siblingOffset.length;k++){const R=2*u+this._siblingOffset[k][0],z=2*p+this._siblingOffset[k][1],M=P.getElevation(R,z),L=P.isLeaf(R,z),q=this._addNode(M.min,M.max,L);L&&(O|=1<<k),B||(B=q)}for(let k=0;k<this._siblingOffset.length;k++)O&1<<k||this._construct(s,2*u+this._siblingOffset[k][0],2*p+this._siblingOffset[k][1],_,B+k)}}function Hz(f,s,u,p,v,m){return Fr(Fr(f,u,m),Fr(s,p,m),v)}function Mg(f,s,u){const p=u.dim,v=pr(f*p-.5,0,p-1),m=pr(s*p-.5,0,p-1),_=Math.floor(v),P=Math.floor(m),O=Math.min(_+1,p-1),B=Math.min(P+1,p-1);return Hz(u.get(_,P),u.get(O,P),u.get(_,B),u.get(O,B),v-_,m-P)}const Ise={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Lse(f,s,u){return(256*f*256+256*s+u)/10-1e4}function Dse(f,s,u){return 256*f+s+u/256-32768}class kS{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,u,p,v=!1){if(this.uid=s,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(p&&p!=="mapbox"&&p!=="terrarium")return void ln(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const m=this.dim=u.height-2,_=new Uint32Array(u.data.buffer);if(this.pixels=new Uint8Array(u.data.buffer),this.floatView=new Float32Array(u.data.buffer),this.borderReady=v,this._modifiedForSources={},!v){for(let O=0;O<m;O++)_[this._idx(-1,O)]=_[this._idx(0,O)],_[this._idx(m,O)]=_[this._idx(m-1,O)],_[this._idx(O,-1)]=_[this._idx(O,0)],_[this._idx(O,m)]=_[this._idx(O,m-1)];_[this._idx(-1,-1)]=_[this._idx(0,0)],_[this._idx(m,-1)]=_[this._idx(m-1,0)],_[this._idx(-1,m)]=_[this._idx(0,m-1)],_[this._idx(m,m)]=_[this._idx(m-1,m-1)]}const P=p==="terrarium"?Dse:Lse;for(let O=0;O<_.length;++O){const B=4*O;this.floatView[O]=P(this.pixels[B],this.pixels[B+1],this.pixels[B+2])}this._timestamp=Ye.now()}_buildQuadTree(){this._tree=new Wz(this)}get(s,u,p=!1){p&&(s=pr(s,-1,this.dim),u=pr(u,-1,this.dim));const v=this._idx(s,u);return this.floatView[v]}set(s,u,p){const v=this._idx(s,u),m=this.floatView[v];return this.floatView[v]=p,p-m}static getUnpackVector(s){return Ise[s]}_idx(s,u){if(s<-1||s>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(s+1)}static pack(s,u){const p=[0,0,0,0],v=kS.getUnpackVector(u);let m=Math.floor((s+v[3])/v[2]);return p[2]=m%256,m=Math.floor(m/256),p[1]=m%256,m=Math.floor(m/256),p[0]=m,p}getPixels(){return new tb({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,u,p){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let v=u*this.dim,m=u*this.dim+this.dim,_=p*this.dim,P=p*this.dim+this.dim;switch(u){case-1:v=m-1;break;case 1:m=v+1}switch(p){case-1:_=P-1;break;case 1:P=_+1}const O=-u*this.dim,B=-p*this.dim;for(let k=_;k<P;k++)for(let R=v;R<m;R++){const z=4*this._idx(R,k),M=4*this._idx(R+O,k+B);this.pixels[z+0]=s.pixels[M+0],this.pixels[z+1]=s.pixels[M+1],this.pixels[z+2]=s.pixels[M+2],this.pixels[z+3]=s.pixels[M+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function Fse(f,s,u){f===1?s.headerLength=u.readFixed32():f===2?s.x=u.readVarint():f===3?s.y=u.readVarint():f===4?s.z=u.readVarint():f===5&&s.layers.push(function(p,v){return p.readFields($se,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},v)}(u,u.readVarint()+u.pos))}function zse(f,s,u){f===1?(s.delta_filter=function(p,v){return p.readFields(Bse,{blockSize:0},v)}(u,u.readVarint()+u.pos),s.filter="delta_filter"):f===2?(u.readVarint(),s.filter="zigzag_filter"):f===3?(u.readVarint(),s.filter="bitshuffle_filter"):f===4&&(u.readVarint(),s.filter="byteshuffle_filter")}function Bse(f,s,u){f===1&&(s.blockSize=u.readVarint())}function Vse(f,s,u){f===1?(u.readVarint(),s.codec="gzip_data"):f===2?(u.readVarint(),s.codec="jpeg_image"):f===3?(u.readVarint(),s.codec="webp_image"):f===4&&(u.readVarint(),s.codec="png_image")}function Use(f,s,u){let p=0,v=0;f===1?s.firstByte=u.readFixed64():f===2?s.lastByte=u.readFixed64():f===3?s.filters.push(function(m,_){return m.readFields(zse,{},_)}(u,u.readVarint()+u.pos)):f===4?s.codec=function(m,_){return m.readFields(Vse,{},_)}(u,u.readVarint()+u.pos):f===5?v=u.readFloat():f===6?p=u.readFloat():f===7?s.bands.push(u.readString()):f===8?s.offset=u.readDouble():f===9&&(s.scale=u.readDouble()),s.offset===0&&(s.offset=v),s.scale===0&&(s.scale=p)}function $se(f,s,u){f===1?s.version=u.readVarint():f===2?s.name=u.readString():f===3?s.units=u.readString():f===4?s.tileSize=u.readVarint():f===5?s.buffer=u.readVarint():f===6?s.pixelFormat=u.readVarint():f===7&&s.dataIndex.push(function(p,v){return p.readFields(Use,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},v)}(u,u.readVarint()+u.pos))}function qse(f,s,u){if(f===2)(function(p,v,m){p.readFields(Gse,m,v)})(u,u.readVarint()+u.pos,s);else if(f===3)throw new Error("Not implemented")}function Gse(f,s,u){if(f===1){let p=0;const v=u.readVarint()+u.pos;for(;u.pos<v;)s[p++]=u.readVarint()}}function Wse(f,s){if(s.length!==4)throw new Error(`Expected data of dimension 4 but got ${s.length}.`);let u=s[3];for(let p=2;p>=1;p--){const v=p===1?1:0,m=p===2?1:0;for(let _=0;_<s[0];_++){const P=s[1]*_;for(let O=v;O<s[1];O++){const B=s[2]*(O+P);for(let k=m;k<s[2];k++){const R=s[3]*(k+B);for(let z=0;z<s[3];z++){const M=R+z;f[M]+=f[M-u]}}}}u*=s[p]}return f}function Hse(f){for(let s=0,u=f.length;s<u;s++)f[s]=f[s]>>>1^-(1&f[s]);return f}function Kse(f,s){switch(s){case"uint32":return f;case"uint16":for(let u=0;u<f.length;u+=2){const p=f[u],v=f[u+1];f[u]=(240&p)>>4|(61440&p)>>8|(240&v)<<4|61440&v,f[u+1]=15&p|(3840&p)>>4|(15&v)<<8|(3840&v)<<4}return f;case"uint8":for(let u=0;u<f.length;u+=4){const p=f[u],v=f[u+1],m=f[u+2],_=f[u+3];f[u+0]=(192&p)>>6|(192&v)>>4|(192&m)>>2|192&_,f[u+1]=(48&p)>>4|(48&v)>>2|48&m|(48&_)<<2,f[u+2]=(12&p)>>2|12&v|(12&m)<<2|(12&_)<<4,f[u+3]=3&p|(3&v)<<2|(3&m)<<4|(3&_)<<6}return f;default:throw new Error(`Invalid pixel format, "${s}"`)}}mr(kS,"DEMData"),mr(Wz,"DemMinMaxQuadTree",{omit:["dem"]});var ju=Uint8Array,Tb=Uint16Array,Zse=Int32Array,Kz=new ju([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Zz=new ju([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Yse=new ju([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Yz=function(f,s){for(var u=new Tb(31),p=0;p<31;++p)u[p]=s+=1<<f[p-1];var v=new Zse(u[30]);for(p=1;p<30;++p)for(var m=u[p];m<u[p+1];++m)v[m]=m-u[p]<<5|p;return{b:u,r:v}},Xz=Yz(Kz,2),Jz=Xz.b,Xse=Xz.r;Jz[28]=258,Xse[258]=28;for(var Jse=Yz(Zz,0).b,Qz=new Tb(32768),hs=0;hs<32768;++hs){var Gx=(43690&hs)>>1|(21845&hs)<<1;Qz[hs]=((65280&(Gx=(61680&(Gx=(52428&Gx)>>2|(13107&Gx)<<2))>>4|(3855&Gx)<<4))>>8|(255&Gx)<<8)>>1}var jb=function(f,s,u){for(var p=f.length,v=0,m=new Tb(s);v<p;++v)f[v]&&++m[f[v]-1];var _,P=new Tb(s);for(v=1;v<s;++v)P[v]=P[v-1]+m[v-1]<<1;_=new Tb(1<<s);var O=15-s;for(v=0;v<p;++v)if(f[v])for(var B=v<<4|f[v],k=s-f[v],R=P[f[v]-1]++<<k,z=R|(1<<k)-1;R<=z;++R)_[Qz[R]>>O]=B;return _},kb=new ju(288);for(hs=0;hs<144;++hs)kb[hs]=8;for(hs=144;hs<256;++hs)kb[hs]=9;for(hs=256;hs<280;++hs)kb[hs]=7;for(hs=280;hs<288;++hs)kb[hs]=8;var eB=new ju(32);for(hs=0;hs<32;++hs)eB[hs]=5;var Qse=jb(kb,9),eoe=jb(eB,5),Ik=function(f){for(var s=f[0],u=1;u<f.length;++u)f[u]>s&&(s=f[u]);return s},Ch=function(f,s,u){var p=s/8|0;return(f[p]|f[p+1]<<8)>>(7&s)&u},Lk=function(f,s){var u=s/8|0;return(f[u]|f[u+1]<<8|f[u+2]<<16)>>(7&s)},toe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Eh=function(f,s,u){var p=new Error(s||toe[f]);if(p.code=f,Error.captureStackTrace&&Error.captureStackTrace(p,Eh),!u)throw p;return p},roe=new ju(0),noe=typeof TextDecoder<"u"&&new TextDecoder;try{noe.decode(roe,{stream:!0})}catch{}const ioe={gzip_data:"gzip"};class wd extends Error{constructor(s){super(s),this.name="MRTError"}}const aoe={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},tB={uint32:1,uint16:2,uint8:4},soe={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let Dk;class Fk{constructor(s=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=s}getLayer(s){const u=this.layers[s];if(!u)throw new wd(`Layer '${s}' not found`);return u}getHeaderLength(s){const u=new Uint8Array(s),p=new DataView(s);if(u[0]!==13)throw new wd("File is not a valid MRT.");return p.getUint32(1,!0)}parseHeader(s){const u=new Uint8Array(s),p=this.getHeaderLength(s);if(u.length<p)throw new wd(`Expected header with length >= ${p} but got buffer of length ${u.length}`);const v=function(m,_){return m.readFields(Fse,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new Dk(u.subarray(0,p)));if(!isNaN(this.x)&&(this.x!==v.x||this.y!==v.y||this.z!==v.z))throw new wd(`Invalid attempt to parse header ${v.z}/${v.x}/${v.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=v.x,this.y=v.y,this.z=v.z;for(const m of v.layers)this.layers[m.name]=new ooe(m,{cacheSize:this._cacheSize});return this}createDecodingTask(s){const u=[],p=this.getLayer(s.layerName);for(let v of s.blockIndices){const m=p.dataIndex[v],_=m.firstByte-s.firstByte,P=m.lastByte-s.firstByte;if(p._blocksInProgress.has(v))continue;const O={layerName:p.name,firstByte:_,lastByte:P,pixelFormat:p.pixelFormat,blockIndex:v,blockShape:[m.bands.length].concat(p.bandShape),buffer:p.buffer,codec:m.codec.codec,filters:m.filters.map(B=>B.filter)};p._blocksInProgress.add(v),u.push(O)}return new rB(u,()=>{u.forEach(v=>p._blocksInProgress.delete(v.blockIndex))},(v,m)=>{if(u.forEach(_=>p._blocksInProgress.delete(_.blockIndex)),v)throw v;m.forEach(_=>{this.getLayer(_.layerName).processDecodedData(_)})})}}class ooe{constructor({version:s,name:u,units:p,tileSize:v,pixelFormat:m,buffer:_,dataIndex:P},O){if(this.version=s,this.version!==1)throw new wd(`Cannot parse raster layer encoded with MRT version ${s}`);this.name=u,this.units=p,this.tileSize=v,this.buffer=_,this.pixelFormat=aoe[m],this.dataIndex=P,this.bandShape=[v+2*_,v+2*_,tB[this.pixelFormat]],this._decodedBlocks=new Ok(O?O.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return tB[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:s})=>s).flat()}processDecodedData(s){const u=s.blockIndex.toString();this._decodedBlocks.get(u)||this._decodedBlocks.put(u,s.data)}getBlockForBand(s){let u=0;switch(typeof s){case"string":for(const[p,v]of this.dataIndex.entries()){for(const[m,_]of v.bands.entries())if(_===s)return{bandIndex:u+m,blockIndex:p,blockBandIndex:m};u+=v.bands.length}break;case"number":for(const[p,v]of this.dataIndex.entries()){if(s>=u&&s<u+v.bands.length)return{bandIndex:s,blockIndex:p,blockBandIndex:s-u};u+=v.bands.length}break;default:throw new wd(`Invalid band \`${JSON.stringify(s)}\`. Expected string or integer.`)}throw new wd(`Band not found: ${JSON.stringify(s)}`)}getDataRange(s){let u=1/0,p=-1/0;const v=[],m=new Set;for(const _ of s){const{blockIndex:P}=this.getBlockForBand(_);if(P<0)throw new wd(`Invalid band: ${JSON.stringify(_)}`);const O=this.dataIndex[P];v.includes(P)||v.push(P),m.add(P),u=Math.min(u,O.firstByte),p=Math.max(p,O.lastByte)}if(m.size>this.cacheSize)throw new wd(`Number of blocks to decode (${m.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:u,lastByte:p,blockIndices:v}}hasBand(s){const{blockIndex:u}=this.getBlockForBand(s);return u>=0}hasDataForBand(s){const{blockIndex:u}=this.getBlockForBand(s);return u>=0&&!!this._decodedBlocks.get(u.toString())}getBandView(s){const{blockIndex:u,blockBandIndex:p}=this.getBlockForBand(s),v=this._decodedBlocks.get(u.toString());if(!v)throw new wd(`Data for band ${JSON.stringify(s)} of layer "${this.name}" not decoded.`);const m=this.dataIndex[u],_=this.bandShape.reduce((B,k)=>B*k,1),P=p*_,O=v.subarray(P,P+_);return{data:O,bytes:new Uint8Array(O.buffer).subarray(O.byteOffset,O.byteOffset+O.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:m.offset,scale:m.scale}}}Fk.setPbf=function(f){Dk=f};class rB{constructor(s,u,p){this.tasks=s,this._onCancel=u,this._onComplete=p,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(s,u){this._finalized||(this._onComplete(s,u),this._finalized=!0)}}Fk.performDecoding=function(f,s){const u=new Uint8Array(f);return Promise.all(s.tasks.map(p=>{const{layerName:v,firstByte:m,lastByte:_,pixelFormat:P,blockShape:O,blockIndex:B,filters:k,codec:R}=p,z=u.subarray(m,_+1),M=new Uint32Array(O[0]*O[1]*O[2]);let L;if(R!=="gzip_data")throw new wd(`Unhandled codec: ${R}`);return L=function(q,X){if(!globalThis.DecompressionStream&&X==="gzip_data")return Promise.resolve(((ie=function(je){je[0]==31&&je[1]==139&&je[2]==8||Eh(6,"invalid gzip data");var Fe=je[3],De=10;4&Fe&&(De+=2+(je[10]|je[11]<<8));for(var Ie=(Fe>>3&1)+(Fe>>4&1);Ie>0;Ie-=!je[De++]);return De+(2&Fe)}(ce=q))+8>ce.length&&Eh(6,"invalid gzip data"),function(je,Fe,De,Ie){var et=je.length;if(!et||Fe.f&&!Fe.l)return De||new ju(0);var Ve=!De,rt=Ve||Fe.i!=2,ot=Fe.i;Ve&&(De=new ju(3*et));var it,ct,ft=function(Og){var o0=De.length;if(Og>o0){var Mb=new ju(Math.max(2*o0,Og));Mb.set(De),De=Mb}},xt=Fe.f||0,ut=Fe.p||0,Mt=Fe.b||0,qt=Fe.l,Et=Fe.d,fr=Fe.m,lr=Fe.n,Qt=8*et;do{if(!qt){xt=Ch(je,ut,1);var Gt=Ch(je,ut+1,3);if(ut+=3,!Gt){var kr=je[(fn=4+((ut+7)/8|0))-4]|je[fn-3]<<8,yr=fn+kr;if(yr>et){ot&&Eh(0);break}rt&&ft(Mt+kr),De.set(je.subarray(fn,yr),Mt),Fe.b=Mt+=kr,Fe.p=ut=8*yr,Fe.f=xt;continue}if(Gt==1)qt=Qse,Et=eoe,fr=9,lr=5;else if(Gt==2){var _r=Ch(je,ut,31)+257,rn=Ch(je,ut+10,15)+4,vn=_r+Ch(je,ut+5,31)+1;ut+=14;for(var Sn=new ju(vn),Nn=new ju(19),Dn=0;Dn<rn;++Dn)Nn[Yse[Dn]]=Ch(je,ut+3*Dn,7);ut+=3*rn;var Bn=Ik(Nn),Ii=(1<<Bn)-1,Ni=jb(Nn,Bn);for(Dn=0;Dn<vn;){var fn,yi=Ni[Ch(je,ut,Ii)];if(ut+=15&yi,(fn=yi>>4)<16)Sn[Dn++]=fn;else{var bi=0,Qi=0;for(fn==16?(Qi=3+Ch(je,ut,3),ut+=2,bi=Sn[Dn-1]):fn==17?(Qi=3+Ch(je,ut,7),ut+=3):fn==18&&(Qi=11+Ch(je,ut,127),ut+=7);Qi--;)Sn[Dn++]=bi}}var Ua=Sn.subarray(0,_r),fs=Sn.subarray(_r);fr=Ik(Ua),lr=Ik(fs),qt=jb(Ua,fr),Et=jb(fs,lr)}else Eh(1);if(ut>Qt){ot&&Eh(0);break}}rt&&ft(Mt+131072);for(var $a=(1<<fr)-1,Pa=(1<<lr)-1,Ya=ut;;Ya=ut){var Ns=(bi=qt[Lk(je,ut)&$a])>>4;if((ut+=15&bi)>Qt){ot&&Eh(0);break}if(bi||Eh(2),Ns<256)De[Mt++]=Ns;else{if(Ns==256){Ya=ut,qt=null;break}var $o=Ns-254;Ns>264&&($o=Ch(je,ut,(1<<(Oh=Kz[Dn=Ns-257]))-1)+Jz[Dn],ut+=Oh);var Hi=Et[Lk(je,ut)&Pa],mc=Hi>>4;if(Hi||Eh(3),ut+=15&Hi,fs=Jse[mc],mc>3){var Oh=Zz[mc];fs+=Lk(je,ut)&(1<<Oh)-1,ut+=Oh}if(ut>Qt){ot&&Eh(0);break}rt&&ft(Mt+131072);var Sd=Mt+$o;if(Mt<fs){var Nd=0-fs,s0=Math.min(fs,Sd);for(Nd+Mt<0&&Eh(3);Mt<s0;++Mt)De[Mt]=(void 0)[Nd+Mt]}for(;Mt<Sd;++Mt)De[Mt]=De[Mt-fs]}}Fe.l=qt,Fe.p=Ya,Fe.b=Mt,Fe.f=xt,qt&&(xt=1,Fe.m=fr,Fe.d=Et,Fe.n=lr)}while(!xt);return Mt!=De.length&&Ve?(it=De,((ct=Mt)==null||ct>it.length)&&(ct=it.length),new ju(it.subarray(0,ct))):De.subarray(0,Mt)}(ce.subarray(ie,-8),{i:2},new ju(((te=ce)[(le=te.length)-4]|te[le-3]<<8|te[le-2]<<16|te[le-1]<<24)>>>0))));var te,le,ce,ie;const fe=ioe[X];if(!fe)throw new Error(`Unhandled codec: ${X}`);const xe=new globalThis.DecompressionStream(fe);return new Response(new Blob([q]).stream().pipeThrough(xe)).arrayBuffer().then(je=>new Uint8Array(je))}(z,R).then(q=>(function(X,te){X.readFields(qse,te)}(new Dk(q),M),new soe[P](M.buffer))),L.then(q=>{for(let X=k.length-1;X>=0;X--)switch(k[X]){case"delta_filter":Wse(q,O);break;case"zigzag_filter":Hse(q);break;case"bitshuffle_filter":Kse(q,P);break;default:throw new wd(`Unhandled filter "${k[X]}"`)}return{layerName:v,blockIndex:B,data:q}}).catch(q=>{throw q})}))},mr(rB,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let Pb,zk,Mh,Wx,Bk,Hx=null;function nB(){return eo()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:zk||$i.DRACO_URL}function iB(){if(eo()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Wx)return Wx;const f=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Wx=WebAssembly.validate(f)?$i.MESHOPT_SIMD_URL:$i.MESHOPT_URL,Wx}const PS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},loe={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Cb={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function aB(f,s,u){const p=u.json.bufferViews.length,v=u.buffers.length;s.bufferView=p,u.json.bufferViews[p]={buffer:v,byteLength:f.byteLength},u.buffers[v]=f}const Vk="KHR_draco_mesh_compression";function coe(f,s){const u=f.extensions&&f.extensions[Vk];if(!u)return;const p=new Mh.Decoder,v=cB(s,u.bufferView),m=new Mh.Mesh;if(!p.DecodeArrayToMesh(v,v.byteLength,m))throw new Error("Failed to decode Draco mesh");const _=s.json.accessors[f.indices],P=PS[_.componentType],O=_.count*P.BYTES_PER_ELEMENT,B=Mh._malloc(O);P===Uint16Array?p.GetTrianglesUInt16Array(m,O,B):p.GetTrianglesUInt32Array(m,O,B),aB(Mh.memory.buffer.slice(B,B+O),_,s),Mh._free(B);for(const k of Object.keys(u.attributes)){const R=p.GetAttributeByUniqueId(m,u.attributes[k]),z=s.json.accessors[f.attributes[k]],M=loe[z.componentType],L=z.count*Cb[z.type]*PS[z.componentType].BYTES_PER_ELEMENT,q=Mh._malloc(L);p.GetAttributeDataArrayForAllPoints(m,R,Mh[M],L,q),aB(Mh.memory.buffer.slice(q,q+L),z,s),Mh._free(q)}p.destroy(),m.destroy(),delete f.extensions[Vk]}const CS="EXT_meshopt_compression";function uoe(f,s){if(!f.extensions||!f.extensions[CS])return;const u=f.extensions[CS],p=new Uint8Array(s.buffers[u.buffer],u.byteOffset||0,u.byteLength||0),v=new Uint8Array(u.count*u.byteStride);Bk.decodeGltfBuffer(v,u.count,u.byteStride,p,u.mode,u.filter),f.buffer=s.buffers.length,f.byteOffset=0,s.buffers[f.buffer]=v.buffer,delete f.extensions[CS]}const sB=1179937895,oB=new TextDecoder("utf8");function lB(f,s){return new URL(f,s).href}function doe(f,s,u,p){return fetch(lB(f.uri,p)).then(v=>v.arrayBuffer()).then(v=>{s.buffers[u]=v})}function cB(f,s){const u=f.json.bufferViews[s];return new Uint8Array(f.buffers[u.buffer],u.byteOffset||0,u.byteLength)}function hoe(f,s,u,p){if(f.uri){const v=lB(f.uri,p);return fetch(v).then(m=>m.blob()).then(m=>createImageBitmap(m)).then(m=>{s.images[u]=m})}if(f.bufferView!==void 0){const v=cB(s,f.bufferView),m=new Blob([v],{type:f.mimeType});return createImageBitmap(m).then(_=>{s.images[u]=_})}}function uB(f,s=0,u){const p={json:null,images:[],buffers:[]};if(new Uint32Array(f,s,1)[0]===sB){const k=new Uint32Array(f,s);let R=2;const z=(k[R++]>>2)-3,M=k[R++]>>2;if(R++,p.json=JSON.parse(oB.decode(k.subarray(R,R+M))),R+=M,R<z){const L=k[R++];R++;const q=s+(R<<2);p.buffers[0]=f.slice(q,q+L)}}else p.json=JSON.parse(oB.decode(new Uint8Array(f,s)));const{buffers:v,images:m,meshes:_,extensionsUsed:P,bufferViews:O}=p.json;let B=Promise.resolve();if(v){const k=[];for(let R=0;R<v.length;R++){const z=v[R];z.uri?k.push(doe(z,p,R,u)):p.buffers[R]||(p.buffers[R]=null)}B=Promise.all(k)}return B.then(()=>{const k=[],R=P&&P.includes(Vk),z=P&&P.includes(CS);if(R&&k.push(function(){if(!Mh)return Pb??(Pb=function(M){let L,q=null;function X(){L=new Uint8Array(q.buffer)}function te(){throw new Error("Unexpected Draco error.")}const le={a:{a:te,d:function(ce,ie,fe){return L.copyWithin(ce,ie,ie+fe)},c:function(ce){const ie=L.length,fe=Math.max(ce>>>0,Math.ceil(1.2*ie)),xe=Math.ceil((fe-ie)/65536);try{return q.grow(xe),X(),!0}catch{return!1}},b:te}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(M,le):M.then(ce=>ce.arrayBuffer()).then(ce=>WebAssembly.instantiate(ce,le))).then(ce=>{const{Rb:ie,Qb:fe,P:xe,T:je,X:Fe,Ja:De,La:Ie,Qa:et,Va:Ve,Wa:rt,eb:ot,jb:it,f:ct,e:ft,yb:xt,zb:ut,Ab:Mt,Bb:qt,Db:Et,Gb:fr}=ce.instance.exports;q=ft;const lr=(()=>{let Qt=0,Gt=0,kr=0,yr=0;return _r=>{kr&&(ie(yr),ie(Qt),Gt+=kr,kr=Qt=0),Qt||(Gt+=128,Qt=fe(Gt));const rn=_r.length+7&-8;let vn=Qt;rn>=Gt&&(kr=rn,vn=yr=fe(rn));for(let Sn=0;Sn<_r.length;Sn++)L[vn+Sn]=_r[Sn];return vn}})();return X(),ct(),{memory:ft,_free:ie,_malloc:fe,Mesh:class{constructor(){this.ptr=xe()}destroy(){je(this.ptr)}},Decoder:class{constructor(){this.ptr=De()}destroy(){it(this.ptr)}DecodeArrayToMesh(Qt,Gt,kr){const yr=lr(Qt),_r=Ie(this.ptr,yr,Gt,kr.ptr);return!!Fe(_r)}GetAttributeByUniqueId(Qt,Gt){return{ptr:et(this.ptr,Qt.ptr,Gt)}}GetTrianglesUInt16Array(Qt,Gt,kr){Ve(this.ptr,Qt.ptr,Gt,kr)}GetTrianglesUInt32Array(Qt,Gt,kr){rt(this.ptr,Qt.ptr,Gt,kr)}GetAttributeDataArrayForAllPoints(Qt,Gt,kr,yr,_r){ot(this.ptr,Qt.ptr,Gt.ptr,kr,yr,_r)}},DT_INT8:xt(),DT_UINT8:ut(),DT_INT16:Mt(),DT_UINT16:qt(),DT_UINT32:Et(),DT_FLOAT32:fr()}})}(fetch(nB())),Pb.then(M=>{Mh=M,Pb=void 0}))}()),z&&k.push(function(){if(Bk)return;const M=function(L){let q;const X=WebAssembly.instantiateStreaming(L,{}).then(ce=>{q=ce.instance,q.exports.__wasm_call_ctors()}),te={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},le={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:X,supported:!0,decodeGltfBuffer(ce,ie,fe,xe,je,Fe){(function(De,Ie,et,Ve,rt,ot,it){const ct=De.exports.sbrk,ft=Ve+3&-4,xt=ct(ft*rt),ut=ct(ot.length),Mt=new Uint8Array(De.exports.memory.buffer);Mt.set(ot,ut);const qt=Ie(xt,Ve,rt,ut,ot.length);if(qt===0&&it&&it(xt,ft,rt),et.set(Mt.subarray(xt,xt+Ve*rt)),ct(xt-ct(0)),qt!==0)throw new Error(`Malformed buffer data: ${qt}`)})(q,q.exports[le[je]],ce,ie,fe,xe,q.exports[te[Fe]])}}}(fetch(iB()));return M.ready.then(()=>{Bk=M})}()),m)for(let M=0;M<m.length;M++)k.push(hoe(m[M],p,M,u));return(k.length?Promise.all(k):Promise.resolve()).then(()=>{if(R&&_)for(const{primitives:M}of _)for(const L of M)coe(L,p);if(z&&_&&O)for(const M of O)uoe(M,p);return p})})}function a0(f,s){const u=f.json.bufferViews[s.bufferView],p=PS[s.componentType];return new p(f.buffers[u.buffer],(s.byteOffset||0)+(u.byteOffset||0),s.count*(u.byteStride&&u.byteStride!==Cb[s.type]*p.BYTES_PER_ELEMENT?u.byteStride/p.BYTES_PER_ELEMENT:Cb[s.type]))}function Uk(f,s,u,p){const v=PS[s.componentType],m=function(k){switch(k){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(v),_=f.json.bufferViews[s.bufferView],P=_.byteStride?_.byteStride/v.BYTES_PER_ELEMENT:Cb[s.type],O=u.float32,B=O.length/u.capacity;for(let k=0,R=0;k<s.count*P;k+=P,R+=B)for(let z=0;z<B;z++)O[R+z]=p[k+z]*m;u._trim()}function foe(f,s,u){const p=f.indices,v=f.attributes,m={};m.indexArray=new bs;const _=s.json.accessors[p],P=_.count/3;m.indexArray.reserve(P);const O=a0(s,_);for(let z=0;z<P;z++)m.indexArray.emplaceBack(O[3*z],O[3*z+1],O[3*z+2]);m.indexArray._trim(),m.vertexArray=new rl;const B=s.json.accessors[v.POSITION];m.vertexArray.reserve(B.count);const k=a0(s,B);for(let z=0;z<B.count;z++)m.vertexArray.emplaceBack(k[3*z],k[3*z+1],k[3*z+2]);if(m.vertexArray._trim(),m.aabb=new wr(B.min,B.max),m.centroid=function(z,M){const L=[0,0,0],q=z.length;if(q>0){for(let X=0;X<q;X++){const te=3*z[X];L[0]+=M[te],L[1]+=M[te+1],L[2]+=M[te+2]}L[0]/=q,L[1]/=q,L[2]/=q}return L}(O,k),v.COLOR_0!==void 0){const z=s.json.accessors[v.COLOR_0],M=Cb[z.type],L=a0(s,z);m.colorArray=M===3?new rl:new _u,m.colorArray.resize(z.count),Uk(s,z,m.colorArray,L)}if(v.NORMAL!==void 0){m.normalArray=new rl;const z=s.json.accessors[v.NORMAL];m.normalArray.resize(z.count);const M=a0(s,z);Uk(s,z,m.normalArray,M)}if(v.TEXCOORD_0!==void 0&&u.length>0){m.texcoordArray=new vh;const z=s.json.accessors[v.TEXCOORD_0];m.texcoordArray.resize(z.count);const M=a0(s,z);Uk(s,z,m.texcoordArray,M)}if(v._FEATURE_ID_RGBA4444!==void 0){const z=s.json.accessors[v._FEATURE_ID_RGBA4444];s.json.extensionsUsed&&s.json.extensionsUsed.includes("EXT_meshopt_compression")&&(m.featureData=a0(s,z))}v._FEATURE_RGBA4444!==void 0&&(m.featureData=new Uint32Array(a0(s,s.json.accessors[v._FEATURE_RGBA4444]).buffer));const R=f.material;return m.material=function(z,M){const{emissiveFactor:L=[0,0,0],alphaMode:q="OPAQUE",alphaCutoff:X=.5,normalTexture:te,occlusionTexture:le,emissiveTexture:ce,doubleSided:ie}=z,{baseColorFactor:fe=[1,1,1,1],metallicFactor:xe=1,roughnessFactor:je=1,baseColorTexture:Fe,metallicRoughnessTexture:De}=z.pbrMetallicRoughness||{},Ie=le?M[le.index]:void 0;if(le&&le.extensions&&le.extensions.KHR_texture_transform&&Ie){const et=le.extensions.KHR_texture_transform;Ie.offsetScale=[et.offset[0],et.offset[1],et.scale[0],et.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Xn(...fe),metallicFactor:xe,roughnessFactor:je,baseColorTexture:Fe?M[Fe.index]:void 0,metallicRoughnessTexture:De?M[De.index]:void 0},doubleSided:ie,emissiveFactor:L,alphaMode:q,alphaCutoff:X,normalTexture:te?M[te.index]:void 0,occlusionTexture:Ie,emissionTexture:ce?M[ce.index]:void 0,defined:z.defined===void 0}}(R!==void 0?s.json.materials[R]:{defined:!1},u),m}function dB(f,s,u){const{matrix:p,rotation:v,translation:m,scale:_,mesh:P,extras:O,children:B}=f,k={};if(k.matrix=p||ze.mat4.fromRotationTranslationScale([],v||[0,0,0,1],m||[0,0,0],_||[1,1,1]),P!==void 0){k.meshes=u[P];const R=k.anchor=[0,0];for(const z of k.meshes){const{min:M,max:L}=z.aabb;R[0]+=M[0]+L[0],R[1]+=M[1]+L[1]}R[0]=Math.floor(R[0]/k.meshes.length/2),R[1]=Math.floor(R[1]/k.meshes.length/2)}if(O&&(O.id&&(k.id=O.id),O.lights&&(k.lights=function(R){if(!R.length)return[];const z=function(te){const le=atob(te),ce=new Uint8Array(le.length);for(let ie=0;ie<le.length;ie++)ce[ie]=le.codePointAt(ie);return ce}(R),M=[],L=z.length/24,q=new Uint16Array(z.buffer),X=new Float32Array(z.buffer);for(let te=0;te<L;te++){const le=q[2*te*6]/30,ce=q[2*te*6+1]/30,ie=q[2*te*6+10]/100,fe=X[6*te+1],xe=X[6*te+2],je=X[6*te+3],Fe=X[6*te+4],De=je-fe,Ie=Fe-xe,et=Math.hypot(De,Ie);M.push({pos:[fe+.5*De,xe+.5*Ie,ce],normal:[Ie/et,-De/et,0],width:et,height:le,depth:ie,points:[fe,xe,je,Fe]})}return M}(O.lights))),B){const R=[];for(const z of B)R.push(dB(s.json.nodes[z],s,u));k.children=R}return k}function poe(f){if(f.vertices.length===0||f.indices.length===0)return null;const s=new Ir(f.vertices,f.indices,8,256),[u,p]=[s.min.clone(),s.max.clone()];return{vertices:f.vertices,indices:f.indices,grid:s,min:u,max:p}}function moe(f){if(!f.extras||!f.extras.ground)return null;const s=f.extras.ground;if(!s||!Array.isArray(s)||s.length===0)return null;const u=s[0];if(!u||!Array.isArray(u)||u.length===0)return null;const p=[];for(const _ of u){if(!Array.isArray(_)||_.length!==2)continue;const P=_[0],O=_[1];typeof P=="number"&&typeof O=="number"&&p.push(new Rt(P,O))}if(p.length<3)return null;p.length>1&&p[p.length-1].equals(p[0])&&p.pop();let v=0;for(let _=0;_<p.length;_++){const P=p[_],O=p[(_+1)%p.length],B=p[(_+2)%p.length];v+=(P.x-O.x)*(B.y-O.y)-(B.x-O.x)*(P.y-O.y)}v>0&&p.reverse();const m=Ag(p.flatMap(_=>[_.x,_.y]),[]);return m.length===0?null:{vertices:p,indices:m}}function goe(f,s){const u=[],p=[];let v=0;const m=[];for(const _ of f){v=u.length;const P=_.vertexArray.float32,O=_.indexArray.uint16;for(let B=0;B<_.vertexArray.length;B++)m[0]=P[3*B+0],m[1]=P[3*B+1],m[2]=P[3*B+2],ze.vec3.transformMat4(m,m,s),u.push(new Rt(m[0],m[1]));for(let B=0;B<3*_.indexArray.length;B++)p.push(O[B]+v)}if(p.length%3!=0)return null;for(let _=0;_<p.length;_+=3){const P=u[p[_+0]],O=u[p[_+1]],B=u[p[_+2]];(P.x-O.x)*(B.y-O.y)-(B.x-O.x)*(P.y-O.y)>0&&([p[_+1],p[_+2]]=[p[_+2],p[_+1]])}return{vertices:u,indices:p}}function hB(f){const s=function(O,B){const k=[],R=WebGL2RenderingContext;if(O.json.textures)for(const z of O.json.textures){const M={magFilter:R.LINEAR,minFilter:R.NEAREST,wrapS:R.REPEAT,wrapT:R.REPEAT};z.sampler!==void 0&&Object.assign(M,O.json.samplers[z.sampler]),k.push({image:B[z.source],sampler:M,uploaded:!1})}return k}(f,f.images),u=function(O,B){const k=[];for(const R of O.json.meshes){const z=[];for(const M of R.primitives)z.push(foe(M,O,B));k.push(z)}return k}(f,s),{scenes:p,scene:v,nodes:m}=f.json,_=p?p[v||0].nodes:m,P=[];for(const O of _)P.push(dB(m[O],f,u));return function(O,B,k){const R={},z=new Set;for(let M=0;M<O.length;M++){const L=k[B[M]];if(!L.extras)continue;const q=L.extras["mapbox:footprint:version"],X=L.extras["mapbox:footprint:id"];(q||X)&&z.add(M),q==="1.0.0"&&X&&(R[X]=M)}for(let M=0;M<O.length;M++){if(z.has(M))continue;const L=O[M],q=k[B[M]];if(!q.extras)continue;let X=null;L.id in R&&(X=goe(O[R[L.id]].meshes,L.matrix)),X||(X=moe(q)),X&&(L.footprint=poe(X))}if(z.size>0){const M=Array.from(z.values()).sort((L,q)=>L-q);for(let L=M.length-1;L>=0;L--)O.splice(M[L],1)}}(P,_,f.json.nodes),P}function yoe(f){f.heightmap=new Float32Array(4096),f.heightmap.fill(-1);const s=f.vertexArray.float32,u=f.aabb.min[0]-1,p=f.aabb.min[1]-1,v=r0/(f.aabb.max[0]-u+2),m=r0/(f.aabb.max[1]-p+2);for(let _=0;_<s.length;_+=3){const P=s[_+2],O=(s[_+0]-u)*v|0,B=(s[_+1]-p)*m|0;P>f.heightmap[B*r0+O]&&(f.heightmap[B*r0+O]=P)}}function xoe(f,s){const u={};u.indexArray=new bs,u.indexArray.reserve(4*f.length),u.vertexArray=new rl,u.vertexArray.reserve(10*f.length),u.colorArray=new _u,u.vertexArray.reserve(10*f.length);let p=0;for(const _ of f){const P=Math.min(10,Math.max(4,1.3*_.height))*s,O=[-_.normal[1],_.normal[0],0],B=Math.min(.29,.1*_.width/_.depth),k=_.width-2*_.depth*s*(B+.01),R=ze.vec3.scaleAndAdd([],_.pos,O,k/2),z=ze.vec3.scaleAndAdd([],_.pos,O,-k/2),M=[R[0],R[1],R[2]+_.height],L=[z[0],z[1],z[2]+_.height],q=ze.vec3.scaleAndAdd([],_.normal,O,B);ze.vec3.scale(q,q,P);const X=ze.vec3.scaleAndAdd([],_.normal,O,-B);ze.vec3.scale(X,X,P),ze.vec3.add(q,R,q),ze.vec3.add(X,z,X),R[2]+=.1,z[2]+=.1,u.vertexArray.emplaceBack(q[0],q[1],q[2]),u.vertexArray.emplaceBack(X[0],X[1],X[2]),u.vertexArray.emplaceBack(R[0],R[1],R[2]),u.vertexArray.emplaceBack(z[0],z[1],z[2]),u.vertexArray.emplaceBack(M[0],M[1],M[2]),u.vertexArray.emplaceBack(L[0],L[1],L[2]),u.vertexArray.emplaceBack(R[0],R[1],R[2]),u.vertexArray.emplaceBack(z[0],z[1],z[2]),u.vertexArray.emplaceBack(q[0],q[1],q[2]),u.vertexArray.emplaceBack(X[0],X[1],X[2]);const te=k/P/2;u.colorArray.emplaceBack(-te-B,-1,te,.8),u.colorArray.emplaceBack(te+B,-1,te,.8),u.colorArray.emplaceBack(-te,0,te,1.3),u.colorArray.emplaceBack(te,0,te,1.3),u.colorArray.emplaceBack(te+B,-.8,te,.7),u.colorArray.emplaceBack(te+B,-.8,te,.7),u.colorArray.emplaceBack(0,0,te,1.3),u.colorArray.emplaceBack(0,0,te,1.3),u.colorArray.emplaceBack(te+B,-1.2,te,.8),u.colorArray.emplaceBack(te+B,-1.2,te,.8),u.indexArray.emplaceBack(6+p,4+p,8+p),u.indexArray.emplaceBack(7+p,9+p,5+p),u.indexArray.emplaceBack(0+p,1+p,2+p),u.indexArray.emplaceBack(1+p,3+p,2+p),p+=10}const v={defined:!0,emissiveFactor:[0,0,0]},m={};return m.baseColorFactor=Xn.white,v.pbrMetallicRoughness=m,u.material=v,u.aabb=new wr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),u}class fB{constructor(s){this._stringToNumber={},this._numberToString=[];for(let u=0;u<s.length;u++){const p=s[u];this._stringToNumber[p]=u,this._numberToString[u]=p}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const voe=["id","tile","layer","source","sourceLayer","state"];class Kx{constructor(s,u,p,v,m){this.type="Feature",this._vectorTileFeature=s,this._z=u,this._x=p,this._y=v,this.properties=s.properties,this.id=m}clone(){const s=new Kx(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(s.state=Object.assign({},this.state)),this.layer&&(s.layer=Object.assign({},this.layer)),this.source&&(s.source=this.source),this.sourceLayer&&(s.sourceLayer=this.sourceLayer),s}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const u of voe)this[u]!==void 0&&(s[u]=this[u]);return s}}class pB{constructor(s,u){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Fc(cr,16,0),this.featureIndexArray=new Xp,this.promoteId=u,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(s,u,p,v,m,_=0,P=0){const O=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,v,m,_);const B=this.grid;for(let k=0;k<u.length;k++){const R=u[k],z=[1/0,1/0,-1/0,-1/0];for(let M=0;M<R.length;M++){const L=R[M];z[0]=Math.min(z[0],L.x),z[1]=Math.min(z[1],L.y),z[2]=Math.max(z[2],L.x),z[3]=Math.max(z[3],L.y)}P!==0&&(z[0]-=P,z[1]-=P,z[2]+=P,z[3]+=P),z[0]<cr&&z[1]<cr&&z[2]>=0&&z[3]>=0&&B.insert(O,z[0],z[1],z[2],z[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Rx.VectorTile(new Q2(this.rawTileData)).layers,this.sourceLayerCoder=new fB(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,u){const{tilespaceGeometry:p,transform:v,tileTransform:m,pixelPosMatrix:_,availableImages:P}=u;this.loadVTLayers(),this.serializedLayersCache.clear();const O=p.bufferedTilespaceBounds,B=this.grid.query(O.min.x,O.min.y,O.max.x,O.max.y,(M,L,q,X)=>Xe(p.bufferedTilespaceGeometry,M,L,q,X));B.sort(_oe);let k=null;v.elevation&&B.length>0&&(k=Vx.create(v.elevation,this.tileID));const R={};let z;for(let M=0;M<B.length;M++){const L=B[M];if(L===z)continue;z=L;const q=this.featureIndexArray.get(L);let X=null;this.is3DTile?this.loadMatchingModelFeature(R,q,s,p,v):this.loadMatchingFeature(R,q,s,P,(te,le,ce,ie=0)=>(X||(X=Y(te,this.tileID.canonical,m)),le.queryIntersectsFeature(p,te,ce,X,this.z,v,_,k,ie)))}return R}loadMatchingFeature(s,u,p,v,m){const{featureIndex:_,bucketIndex:P,sourceLayerIndex:O,layoutVertexArrayOffset:B}=u,k=this.bucketLayerIDs[P],R=p.layers,z=Object.keys(R);if(z.length&&!function(te,le){for(let ce=0;ce<te.length;ce++)if(le.indexOf(te[ce])>=0)return!0;return!1}(z,k))return;const M=p.sourceCache,L=this.sourceLayerCoder.decode(O),q=this.vtLayers[L].feature(_),X=this.getId(q,L);for(let te=0;te<k.length;te++){const le=k[te];if(!R[le])continue;const{styleLayer:ce,targets:ie}=R[le];let fe={};X!==void 0&&(fe=M.getFeatureState(ce.sourceLayer,X));const xe=!m||m(q,ce,fe,B);if(!xe)continue;const je=new Kx(q,this.z,this.x,this.y,X);je.tile=this.tileID.canonical,je.state=fe;let Fe=this.serializedLayersCache.get(le);Fe||(Fe=ce.serialize(),Fe.id=le,this.serializedLayersCache.set(le,Fe)),je.source=Fe.source,je.sourceLayer=Fe["source-layer"],je.layer=Ui({},Fe),je.layer.paint=mB(Fe.paint,ce.paint,q,fe,v),je.layer.layout=mB(Fe.layout,ce.layout,q,fe,v);let De=!1;for(const Ie of ie){this.updateFeatureProperties(je,Ie);const{filter:et}=Ie;if(et){if(q.properties=je.properties,et.needGeometry){const Ve=re(q,!0);if(!et.filter(new vi(this.tileID.overscaledZ),Ve,this.tileID.canonical))continue}else if(!et.filter(new vi(this.tileID.overscaledZ),q))continue}De=!0,Ie.targetId&&this.addFeatureVariant(je,Ie)}De&&this.appendToResult(s,le,_,je,xe)}}loadMatchingModelFeature(s,u,p,v,m){const _=this.bucketLayerIDs[0][0],P=p.layers;if(!P[_])return;const{styleLayer:O,targets:B}=P[_];if(O.type!=="model")return;const k=v.tile,R=u.featureIndex,z=k.getBucket(O);if(!(z&&z instanceof bS))return;const M=function(Fe,De,Ie,et){const Ve=Fe.getNodesInfo()[De];if(Ve.hiddenByReplacement||!Ve.node.meshes)return;let rt=Number.MAX_VALUE;const ot=Ve.node,it=Ie.tile,ct=et.calculatePosMatrix(it.tileID.toUnwrapped(),et.worldSize),ft=Ve.evaluatedScale;let xt=0;et.elevation&&ot.elevation&&(xt=ot.elevation*et.elevation.exaggeration()),ze.mat4.translate(ct,ct,[(ot.anchor?ot.anchor[0]:0)*(ft[0]-1),(ot.anchor?ot.anchor[1]:0)*(ft[1]-1),xt]),ze.mat4.scale(ct,ct,ft);const ut=Ie.queryGeometry,Mt=ut.isPointQuery()?ut.screenBounds:ut.screenGeometry,qt=function(fr){const lr=ze.mat4.multiply([],ct,fr.matrix);ze.mat4.multiply(lr,et.expandedFarZProjMatrix,lr);for(let Qt=0;Qt<fr.meshes.length;++Qt){const Gt=fr.meshes[Qt];if(Qt===fr.lightMeshIndex)continue;const kr=fz(Mt,et,lr,Gt.aabb);kr!=null&&(rt=Math.min(kr,rt))}if(fr.children)for(const Qt of fr.children)qt(Qt)};if(qt(ot),rt===Number.MAX_VALUE)return;const Et=new Kn(0,0);return Az(it.tileID.canonical,Et,Ve.node.anchor[0],Ve.node.anchor[1]),{intersectionZ:rt,position:Et,feature:Ve.feature}}(z,R,v,m);if(!M)return;const{z:L,x:q,y:X}=k.tileID.canonical,{feature:te,intersectionZ:le,position:ce}=M;let ie={};te.id!==void 0&&(ie=p.sourceCache.getFeatureState(O.sourceLayer,te.id));const fe=new Kx({},L,q,X,te.id);fe.tile=this.tileID.canonical,fe.state=ie,fe.properties=te.properties,fe.geometry={type:"Point",coordinates:[ce.lng,ce.lat]};let xe=this.serializedLayersCache.get(_);xe||(xe=O.serialize(),xe.id=_,this.serializedLayersCache.set(_,xe)),fe.source=xe.source,fe.sourceLayer=xe["source-layer"],fe.layer=Ui({},xe);let je=!1;for(const Fe of B){this.updateFeatureProperties(fe,Fe);const{filter:De}=Fe;if(De){if(te.properties=fe.properties,De.needGeometry){if(!De.filter(new vi(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!De.filter(new vi(this.tileID.overscaledZ),te))continue}je=!0,Fe.targetId&&this.addFeatureVariant(fe,Fe)}je&&this.appendToResult(s,_,R,fe,le)}updateFeatureProperties(s,u,p){if(u.properties){const v={};for(const m in u.properties){const _=u.properties[m].evaluate({zoom:this.z},s._vectorTileFeature,s.state,s.tile,p);_!=null&&(v[m]=_)}s.properties=v}}addFeatureVariant(s,u,p){const v={target:u.target,namespace:u.namespace,uniqueFeatureID:u.uniqueFeatureID};u.properties&&(v.properties=s.properties),s.variants=s.variants||{},s.variants[u.targetId]=s.variants[u.targetId]||[],s.variants[u.targetId].push(v)}appendToResult(s,u,p,v,m){let _=s[u];_===void 0&&(_=s[u]=[]),_.push({featureIndex:p,feature:v,intersectionZ:m})}lookupSymbolFeatures(s,u,p,v,m){const _={};this.loadVTLayers();for(const P of s)this.loadMatchingFeature(_,{bucketIndex:u,sourceLayerIndex:p,featureIndex:P,layoutVertexArrayOffset:0},v,m);return _}loadFeature(s){const{featureIndex:u,sourceLayerIndex:p}=s;this.loadVTLayers();const v=this.sourceLayerCoder.decode(p),m=this.vtFeatures[v];if(m[u])return m[u];const _=this.vtLayers[v].feature(u);return m[u]=_,_}hasLayer(s){for(const u of this.bucketLayerIDs)for(const p of u)if(s===p)return!0;return!1}getId(s,u){let p=s.id;if(this.promoteId){const v=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[u];if(v!=null)if(Array.isArray(v)){if(!this.promoteIdExpression){const m=el(v);if(m.result!=="success"){const _=m.value.map(P=>`${P.key}: ${P.message}`).join(", ");return void ln(`Failed to create expression for promoteId: ${_}`)}this.promoteIdExpression=m.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new wy),p=this.promoteIdExpression.evaluate({zoom:0},s)}else p=s.properties[v];typeof p=="boolean"&&(p=Number(p))}return p}}function mB(f,s,u,p,v){return ac(f,(m,_)=>{const P=s instanceof hd?s.get(_):null;return P&&P.evaluate?P.evaluate(u,p,v):P})}function _oe(f,s){return s-f}mr(pB,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const gB=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class $k{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[u,p]=new Uint8Array(s,0,2);if(u!==219)throw new Error("Data does not appear to be in a KDBush format.");const v=p>>4;if(v!==1)throw new Error(`Got v${v} data when expected v1.`);const m=gB[15&p];if(!m)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(s,2,1),[P]=new Uint32Array(s,4,1);return new $k(P,_,m,s)}constructor(s,u=64,p=Float64Array,v){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=p,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const m=gB.indexOf(this.ArrayType),_=2*s*this.ArrayType.BYTES_PER_ELEMENT,P=s*this.IndexArrayType.BYTES_PER_ELEMENT,O=(8-P%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${p}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+P+O,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+_+P+O),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+P+O,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=s)}add(s,u){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=s,this.coords[this._pos++]=u,p}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return qk(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,u,p,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:_,nodeSize:P}=this,O=[0,m.length-1,0],B=[];for(;O.length;){const k=O.pop()||0,R=O.pop()||0,z=O.pop()||0;if(R-z<=P){for(let X=z;X<=R;X++){const te=_[2*X],le=_[2*X+1];te>=s&&te<=p&&le>=u&&le<=v&&B.push(m[X])}continue}const M=z+R>>1,L=_[2*M],q=_[2*M+1];L>=s&&L<=p&&q>=u&&q<=v&&B.push(m[M]),(k===0?s<=L:u<=q)&&(O.push(z),O.push(M-1),O.push(1-k)),(k===0?p>=L:v>=q)&&(O.push(M+1),O.push(R),O.push(1-k))}return B}within(s,u,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:m,nodeSize:_}=this,P=[0,v.length-1,0],O=[],B=p*p;for(;P.length;){const k=P.pop()||0,R=P.pop()||0,z=P.pop()||0;if(R-z<=_){for(let X=z;X<=R;X++)xB(m[2*X],m[2*X+1],s,u)<=B&&O.push(v[X]);continue}const M=z+R>>1,L=m[2*M],q=m[2*M+1];xB(L,q,s,u)<=B&&O.push(v[M]),(k===0?s-p<=L:u-p<=q)&&(P.push(z),P.push(M-1),P.push(1-k)),(k===0?s+p>=L:u+p>=q)&&(P.push(M+1),P.push(R),P.push(1-k))}return O}}function qk(f,s,u,p,v,m){if(v-p<=u)return;const _=p+v>>1;yB(f,s,_,p,v,m),qk(f,s,u,p,_-1,1-m),qk(f,s,u,_+1,v,1-m)}function yB(f,s,u,p,v,m){for(;v>p;){if(v-p>600){const B=v-p+1,k=u-p+1,R=Math.log(B),z=.5*Math.exp(2*R/3),M=.5*Math.sqrt(R*z*(B-z)/B)*(k-B/2<0?-1:1);yB(f,s,u,Math.max(p,Math.floor(u-k*z/B+M)),Math.min(v,Math.floor(u+(B-k)*z/B+M)),m)}const _=s[2*u+m];let P=p,O=v;for(Eb(f,s,p,u),s[2*v+m]>_&&Eb(f,s,p,v);P<O;){for(Eb(f,s,P,O),P++,O--;s[2*P+m]<_;)P++;for(;s[2*O+m]>_;)O--}s[2*p+m]===_?Eb(f,s,p,O):(O++,Eb(f,s,O,v)),O<=u&&(p=O+1),u<=O&&(v=O-1)}}function Eb(f,s,u,p){Gk(f,u,p),Gk(s,2*u,2*p),Gk(s,2*u+1,2*p+1)}function Gk(f,s,u){const p=f[s];f[s]=f[u],f[u]=p}function xB(f,s,u,p){const v=f-u,m=s-p;return v*v+m*m}i.$=qp,i.A=Rs,i.B=2,i.C=fb,i.D=Ux,i.E=au,i.F=CF,i.G=class extends vS{},i.H=Mo,i.I=Rk,i.J=Ku,i.K=Bc,i.L=ql,i.M=$l,i.N=ra,i.O=oh,i.P=Rt,i.Q=dc,i.R=Rn,i.S=Iy,i.T=_k,i.U=el,i.V=vS,i.W=Lc,i.X=td,i.Y=fu,i.Z=Oo,i._=Zo,i.a=function(f){return $i.API_CDN_URL_REGEX.test(f)},i.a$=Kx,i.a0=Ws,i.a1=wa,i.a2=function(f){const s=f.value;let u=[];if(!s)return u;const p=Mo(s);return p!=="string"?(u=u.concat([new vS(f.key,s,`string expected, "${p}" found`)]),u):(mz(s,!0)||(u=u.concat([new vS(f.key,s,`invalid url "${s}"`)])),u)},i.a3=vt,i.a4=fh,i.a5=qi,i.a6=Jt,i.a7=class{constructor(f){this.specification=f}possiblyEvaluate(f,s){return Ha(f.expression.evaluate(s))}interpolate(f,s,u){return{x:Fr(f.x,s.x,u),y:Fr(f.y,s.y,u),z:Fr(f.z,s.z,u),azimuthal:Fr(f.azimuthal,s.azimuthal,u),polar:Fr(f.polar,s.polar,u)}}},i.a8=vi,i.a9=ch,i.aA=sl,i.aB=class{constructor(f){this.entries={},this.scheduler=f}request(f,s,u,p){const v=this.entries[f]=this.entries[f]||{callbacks:[]};if(v.result){const[m,_]=v.result;return this.scheduler?this.scheduler.add(()=>{p(m,_)},s):p(m,_),()=>{}}return v.callbacks.push(p),v.cancel||(v.cancel=u((m,_)=>{v.result=[m,_];for(const P of v.callbacks)this.scheduler?this.scheduler.add(()=>{P(m,_)},s):P(m,_);setTimeout(()=>delete this.entries[f],3e3)})),()=>{v.result||(v.callbacks=v.callbacks.filter(m=>m!==p),v.callbacks.length||(v.cancel(),delete this.entries[f]))}}},i.aC=Do,i.aD=function(f,s,u){const p=JSON.stringify(f.request);return f.data&&(this.deduped.entries[p]={result:[null,f.data]}),this.deduped.request(p,{type:"parseTile",isSymbolTile:f.isSymbolTile,zoom:f.tileZoom},v=>{const m=ls(f.request,(_,P,O,B)=>{_?v(_):P&&v(null,{vectorTile:u?void 0:new Rx.VectorTile(new Q2(P)),rawData:P,cacheControl:O,expires:B})});return()=>{m.cancel(),v()}},s)},i.aE=function(f){Nr++,Nr>wt&&(f.getActor().send("enforceCacheSizeLimit",lt),Nr=0)},i.aF=function(f){return f<=1?1:Math.pow(2,Math.floor(Math.log(f)/Math.LN2))},i.aG=Ht,i.aH=rz,i.aI=lz,i.aJ=tz,i.aK=function(f,s){const u=document.createElement("video");u.muted=!0,u.onloadstart=function(){s(null,u)};for(let p=0;p<f.length;p++){const v=document.createElement("source");vo(f[p])||(u.crossOrigin="Anonymous"),v.src=f[p],u.appendChild(v)}return{cancel:()=>{}}},i.aL=pS,i.aM=function(f){return fetch(f).then(s=>s.arrayBuffer()).then(s=>uB(s,0,f))},i.aN=hB,i.aO=class{constructor(f,s,u,p){this.id=f,this.position=s!=null?new Kn(s[0],s[1]):new Kn(0,0),this.orientation=u??[0,0,0],this.nodes=p,this.uploaded=!1,this.aabb=new wr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(f,s){if(ze.mat4.multiply(f.matrix,s,f.matrix),f.meshes)for(const u of f.meshes){const p=wr.applyTransformFast(u.aabb,f.matrix);this.aabb.encapsulate(p)}if(f.children)for(const u of f.children)this._applyTransformations(u,f.matrix)}computeBoundsAndApplyParent(){const f=ze.mat4.identity([]);for(const s of this.nodes)this._applyTransformations(s,f)}computeModelMatrix(f,s,u,p,v,m,_=!1){_z(this.matrix,this,f.transform,this.position,s,u,p,v,m,_)}upload(f){if(!this.uploaded){for(const s of this.nodes)Ak(s,f);for(const s of this.nodes)_S(s);this.uploaded=!0}}destroy(){for(const f of this.nodes)Tk(f)}},i.aP=Eo,i.aQ=mb,i.aR=ol,i.aS=Br,i.aT=pa,i.aU=bs,i.aV=Wa,i.aW=gg,i.aX=hS,i.aY=function(){tl.isLoading()||tl.isLoaded()||hh()!=="deferred"||wf()},i.aZ=zy,i.a_=re,i.aa=d,i.ab=ze,i.ac=Mn,i.ad=hd,i.ae=Bo,i.af=Fr,i.ag=cr,i.ah=su,i.ai=dt,i.aj=Xn,i.ak=class{constructor(f){this.specification=f}possiblyEvaluate(f,s){return function([u,p]){const v=Ha([1,u,p]);return{x:v.x,y:v.y,z:v.z}}(f.expression.evaluate(s))}interpolate(f,s,u){return{x:Fr(f.x,s.x,u),y:Fr(f.y,s.y,u),z:Fr(f.z,s.z,u)}}},i.al=function(f,s,u=0,p=!0){const v=new Rt(u,u),m=f.sub(v),_=s.add(v),P=[m,new Rt(_.x,m.y),_,new Rt(m.x,_.y)];return p&&P.push(m.clone()),P},i.am=function(f,s){const u=[];for(let p=0;p<f.length;p++){const v=Ai(p-1,-1,f.length-1),m=Ai(p+1,-1,f.length-1),_=f[p],P=f[m],O=f[v].sub(_).unit(),B=P.sub(_).unit(),k=B.angleWithSep(O.x,O.y),R=O.add(B).unit().mult(-1*s/Math.sin(k/2));u.push(_.add(R))}return u},i.an=VF,i.ao=Xe,i.ap=function(f,s,u=0){return ze.vec3.fromValues(((s.x-u)*f.scale-f.x)*cr,(s.y*f.scale-f.y)*cr,Nh(s.z,s.y))},i.aq=Zr,i.ar=sF,i.as=function(f){let s=1/0,u=1/0,p=-1/0,v=-1/0;for(const m of f)s=Math.min(s,m.x),u=Math.min(u,m.y),p=Math.max(p,m.x),v=Math.max(v,m.y);return{min:new Rt(s,u),max:new Rt(p,v)}},i.at=Gc,i.au=He,i.av=N,i.aw=pr,i.ax=so,i.ay=function(f,s){const u={};for(let p=0;p<s.length;p++){const v=s[p];v in f&&(u[v]=f[v])}return u},i.az=Au,i.b=function(f){return $i.API_FONTS_REGEX.test(f)},i.b$=yS,i.b0=Gn,i.b1=Qj,i.b2=gn,i.b3=Y,i.b4=Fo,i.b5=jf,i.b6=Lr,i.b7=Na,i.b8=Ag,i.b9=yk,i.bA=F5,i.bB=dk,i.bC=DF,i.bD=lk,i.bE=$k,i.bF=Ai,i.bG=Ea,i.bH=Gi,i.bI=function(f,s,u){f[4*s+0]=u[0],f[4*s+1]=u[1],f[4*s+2]=u[2],f[4*s+3]=u[3]},i.bJ=Of,i.bK=nl,i.bL=Ef,i.bM=ma,i.bN=$c,i.bO=Kn,i.bP=WF,i.bQ=It,i.bR=jn,i.bS=uz,i.bT=Vt,i.bU=Fs,i.bV=function(f,s,u,p,v,m,_,P,O){if(O.name==="globe")return Fs(f,s,new Vt(u,p,v),!1);const B=mb({z:u,x:p,y:v},O);return new wr([(m+B.x/B.scale)*s,s*(B.y/B.scale),_],[(m+B.x2/B.scale)*s,s*(B.y2/B.scale),P])},i.bW=function(f,s,u){let p=0;for(let v=0;v<2;++v)f[v]>0&&(p+=(f[v]-0)*(f[v]-0)),s[v]<0&&(p+=(0-s[v])*(0-s[v]));return p},i.bX=oo,i.bY=em,i.bZ=function(f){const s=ze.mat4.identity(new Float64Array(16));ze.mat4.multiply(s,f.pixelMatrix,f.globeMatrix);const u=[0,il,0],p=[0,So,0];return ze.vec3.transformMat4(u,u,s),ze.vec3.transformMat4(p,p,s),[u[0]>0&&u[0]<=f.width&&u[1]>0&&u[1]<=f.height&&!Pl(f,new Kn(f.center.lat,90)),p[0]>0&&p[0]<=f.width&&p[1]>0&&p[1]<=f.height&&!Pl(f,new Kn(f.center.lat,-90))]},i.b_=function(f,s){const{scale:u}=f.tileTransform,p=u*cr/(f.tileSize*Math.pow(2,s.zoom-f.tileID.overscaledZ+f.tileID.canonical.z));return ze.mat2.scale(new Float32Array(4),s.inverseAdjustmentMatrix,[p,p])},i.ba=function(f,s){const u=Bo(s.zoom);if(u===0)return La(f);const p=Ci(f),v=Ti(p),m=Gc(p.getWest())*s.worldSize,_=Gc(p.getEast())*s.worldSize,P=sl(p.getNorth())*s.worldSize,O=sl(p.getSouth())*s.worldSize,B=[m,P,0],k=[_,P,0],R=[m,O,0],z=[_,O,0],M=ze.mat4.invert([],s.globeMatrix);return ze.vec3.transformMat4(B,B,M),ze.vec3.transformMat4(k,k,M),ze.vec3.transformMat4(R,R,M),ze.vec3.transformMat4(z,z,M),v[0]=ka(v[0],R,u),v[1]=ka(v[1],z,u),v[2]=ka(v[2],k,u),v[3]=ka(v[3],B,u),wr.fromPoints(v)},i.bb=ds,i.bc=_i,i.bd=ka,i.be=la,i.bf=Or,i.bg=Fk,i.bh=Q2,i.bi=ls,i.bj=function(f){const s=[];for(const u in f)s.push(f[u]);return s},i.bk=function(f,s){const u=[];for(const p in f)p in s||u.push(p);return u},i.bl=Vi,i.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bn=En,i.bo=function(f,s){const{x:u,y:p}=f.point,v=ws(u,p,f.worldSize/f._pixelsPerMercatorPixel,0,0);return ze.mat4.multiply(v,v,ji(La(s)))},i.bp=Ix,i.bq=Tu,i.br=J2,i.bs=function(f,s,u,p,v){const m=5*s+2;f.float32[m+0]=u,f.float32[m+1]=p,f.float32[m+2]=v},i.bt=dS,i.bu=PF,i.bv=ge,i.bw=Uo,i.bx=M5,i.by=pz,i.bz=D5,i.c=gs,i.c$=(f,s,u,p,v,m,_,P)=>{const O=f.transform,B=O.pitch<15?oF(.07,.7,pr((14-O.zoom)/5,0,1)):.07,k=u.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:cF(f,s,u,p),u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:O.calculatePixelsToTileUnitsMatrix(s),u_device_pixel_ratio:v,u_width_scale:m,u_floor_width_scale:_,u_image:0,u_tile_units_to_pixels:lF(s,O),u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:P,u_trim_fade_range:u.paint.get("line-trim-fade-range"),u_trim_color:u.paint.get("line-trim-color").toRenderColor(k?null:u.lut).toArray01(),u_emissive_strength:u.paint.get("line-emissive-strength"),u_zbias_factor:B,u_tile_to_meter:l(s.tileID.canonical,0)}},i.c0=cz,i.c1=function(f){const s=cz(f,!0);return ze.mat2.invert([],[s[0],s[1],s[4],s[5]])},i.c2=Ln,i.c3=function(f){const{x:s,y:u}=f.point,{lng:p,lat:v}=f._center;return ws(s,u,f.worldSize,p,v)},i.c4=Ot,i.c5=tr,i.c6=vd,i.c7=function(f){const s=Math.round((f+45+360)%360/90)%4;return Zt[s]},i.c8=45,i.c9=bg,i.cA=class extends Kl{constructor(f){super(f),this.current=vg}set(f,s,u){if(this.fetchUniformLocation(f,s)){for(let p=0;p<9;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix3fv(this.location,!1,u);break}}}},i.cB=Cr,i.cC=function(f,s,u){const p=Bo(u.zoom),v=f.style.map._antialias,m=f.terrain&&f.terrain.exaggeration()>0;return p===0&&!v&&!m},i.cD=function(f){const s=f.pixelsPerMeter,u=s/Gi(1,f.center.lat),p=ze.mat4.identity(new Float64Array(16));return ze.mat4.translate(p,p,[f.point.x,f.point.y,0]),ze.mat4.scale(p,p,[u,u,s]),Float32Array.from(p)},i.cE=Ci,i.cF=function(f){const s=oo-5;f=pr(f,-80.051129,s)/s*90;const u=Math.pow(Math.abs(Math.sin(dt(f))),3);return Math.round(u*(If.length-1))},i.cG=function(f,s,u,p){const v=s.getNorth(),m=s.getSouth(),_=s.getWest(),P=s.getEast(),O=1<<f.z,B=P-_,k=v-m,R=B/wh,z=-k/If[u],M=[0,R,0,z,0,0,v,_,0];if(f.z>0){const L=180/p;ze.mat3.multiply(M,M,[L/B+1,0,0,0,L/k+1,0,-.5*L/R,.5*L/z,1])}return M[2]=O,M[5]=f.x,M[8]=f.y,M},i.cH=La,i.cI=function(f,s,u){const p=ze.mat4.identity(new Float64Array(16)),v=(s/(1<<f)-.5)*Math.PI*2;return ze.mat4.rotateY(p,u.globeMatrix,v),Float32Array.from(p)},i.cJ=class{isDataAvailableAtPoint(f){const s=this._source();if(this.isUsingMockSource()||!s||f.y<0||f.y>1)return!1;const u=s.getSource().maxzoom,p=1<<u,v=Math.floor(f.x),m=Math.floor((f.x-v)*p),_=Math.floor(f.y*p),P=this.findDEMTileFor(new Ht(u,v,u,m,_));return!(!P||!P.dem)}getAtPointOrZero(f,s=0){return this.getAtPoint(f,s)||0}getAtPoint(f,s,u=!0){if(this.isUsingMockSource())return null;s==null&&(s=null);const p=this._source();if(!p||f.y<0||f.y>1)return s;const v=p.getSource().maxzoom,m=1<<v,_=Math.floor(f.x),P=f.x-_,O=new Ht(v,_,v,Math.floor(P*m),Math.floor(f.y*m)),B=this.findDEMTileFor(O);if(!B||!B.dem)return s;const k=B.dem,R=1<<B.tileID.canonical.z,z=(P*R-B.tileID.canonical.x)*k.dim,M=(f.y*R-B.tileID.canonical.y)*k.dim,L=Math.floor(z),q=Math.floor(M);return(u?this.exaggeration():1)*Fr(Fr(k.get(L,q),k.get(L,q+1),M-q),Fr(k.get(L+1,q),k.get(L+1,q+1),M-q),z-L)}getAtTileOffset(f,s,u){const p=1<<f.canonical.z;return this.getAtPointOrZero(new d(f.wrap+(f.canonical.x+s/cr)/p,(f.canonical.y+u/cr)/p))}getAtTileOffsetFunc(f,s,u,p){return v=>{const m=this.getAtTileOffset(f,v.x,v.y),_=p.upVector(f.canonical,v.x,v.y),P=p.upVectorScale(f.canonical,s,u).metersToTile;return ze.vec3.scale(_,_,m*P),_}}getForTilePoints(f,s,u,p){if(this.isUsingMockSource())return!1;const v=Vx.create(this,f,p);return!!v&&(s.forEach(m=>{m[2]=this.exaggeration()*v.getElevationAt(m[0],m[1],u)}),!0)}getMinMaxForTile(f){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(f);if(!s||!s.dem)return null;const u=s.dem.tree,p=s.tileID,v=1<<f.canonical.z-p.canonical.z;let m=f.canonical.x/v-p.canonical.x,_=f.canonical.y/v-p.canonical.y,P=0;for(let O=0;O<f.canonical.z-p.canonical.z&&!u.leaves[P];O++){m*=2,_*=2;const B=2*Math.floor(_)+Math.floor(m);P=u.childOffsets[P]+B,m%=1,_%=1}return{min:this.exaggeration()*u.minimums[P],max:this.exaggeration()*u.maximums[P]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(f,s,u){throw new Error("Pure virtual method called.")}pointCoordinate(f){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(f){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const f=this.visibleDemTiles;if(f.length===0)return null;let s=!1,u=Number.MAX_VALUE,p=Number.MIN_VALUE;for(const v of f){const m=this.getMinMaxForTile(v.tileID);m&&(u=Math.min(u,m.min),p=Math.max(p,m.max),s=!0)}return s?{min:u,max:p}:null}},i.cK=tb,i.cL=In,i.cM=function(f,s){return[Math.pow(f[0],2.2)*s,Math.pow(f[1],2.2)*s,Math.pow(f[2],2.2)*s]},i.cN=kl,i.cO=qs,i.cP=Ma,i.cQ=256,i.cR=function(f,s){const u=[0,0,0],p=ds(La(s.canonical));return ze.vec3.transformMat4(u,u,p),ze.vec3.transformMat4(u,u,f),u},i.cS=f=>({u_camera_to_center_distance:new ma(f),u_extrude_scale:new wo(f),u_device_pixel_ratio:new ma(f),u_matrix:new Of(f),u_inv_rot_matrix:new Of(f),u_merc_center:new nl(f),u_tile_id:new Ef(f),u_zoom_transition:new ma(f),u_up_dir:new Ef(f),u_emissive_strength:new ma(f)}),i.cT=f=>({u_matrix:new Of(f),u_pixels_to_tile_units:new wo(f),u_device_pixel_ratio:new ma(f),u_width_scale:new ma(f),u_floor_width_scale:new ma(f),u_units_to_pixels:new nl(f),u_dash_image:new $c(f),u_gradient_image:new $c(f),u_image_height:new ma(f),u_texsize:new nl(f),u_tile_units_to_pixels:new ma(f),u_alpha_discard_threshold:new ma(f),u_trim_offset:new nl(f),u_trim_fade_range:new nl(f),u_trim_color:new Mf(f),u_emissive_strength:new ma(f),u_zbias_factor:new ma(f),u_tile_to_meter:new ma(f)}),i.cU=f=>({u_matrix:new Of(f),u_texsize:new nl(f),u_pixels_to_tile_units:new wo(f),u_device_pixel_ratio:new ma(f),u_width_scale:new ma(f),u_floor_width_scale:new ma(f),u_image:new $c(f),u_units_to_pixels:new nl(f),u_tile_units_to_pixels:new ma(f),u_alpha_discard_threshold:new ma(f),u_trim_offset:new nl(f),u_trim_fade_range:new nl(f),u_trim_color:new Mf(f),u_emissive_strength:new ma(f),u_zbias_factor:new ma(f),u_tile_to_meter:new ma(f)}),i.cV=Hp,i.cW=Sae,i.cX=Nae,i.cY=Df,i.cZ=(f,s,u,p,v,m)=>{const _=f.transform,P=_.projection.name==="globe";let O;if(m.paint.get("circle-pitch-alignment")==="map")if(P){const k=kl(_.zoom,s.canonical)*_._pixelsPerMercatorPixel;O=Float32Array.from([k,0,0,k])}else O=_.calculatePixelsToTileUnitsMatrix(u);else O=new Float32Array([_.pixelsToGLUnits[0],0,0,_.pixelsToGLUnits[1]]);const B={u_camera_to_center_distance:f.transform.getCameraToCenterDistance(_.projection),u_matrix:f.translatePosMatrix(s.projMatrix,u,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ye.devicePixelRatio,u_extrude_scale:O,u_inv_rot_matrix:Th,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:m.paint.get("circle-emissive-strength")};if(P){B.u_inv_rot_matrix=p,B.u_merc_center=v,B.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],B.u_zoom_transition=Bo(_.zoom);const k=v[0]*cr,R=v[1]*cr;B.u_up_dir=_.projection.upVector(new Vt(0,0,0),k,R)}return B},i.c_=uF,i.ca=Mf,i.cb=function(f,s,u){const p=Math.sqrt(f*f+s*s+u*u),v=p>0?Math.acos(u/p)*pi:0;let m=f!==0||s!==0?Math.atan2(-s,-f)*pi+90:0;return m<0&&(m+=360),[p,m,v]},i.cc=l,i.cd=wr,i.ce=Ha,i.cf=function(f){return[Math.pow(f[0],1/2.2),Math.pow(f[1],1/2.2),Math.pow(f[2],1/2.2)]},i.cg=function(f,s){return f.readFields(gse,{icons:[]},s)},i.ch=function(f){return f({pluginStatus:Lo,pluginURL:Tl}),zc.on("pluginStateChange",f),f},i.ci=wS,i.cj=Dx,i.ck=ck,i.cl=ys,i.cm=Up,i.cn=st,i.co=vl,i.cp=$s,i.cq=function(f){const s=f.indexOf(Sf);return s>=0?f.slice(0,s):f},i.cr=function(f){return f.indexOf(Sf)>=0},i.cs=function(f){const s=f.indexOf(Sf);return s>=0?f.slice(s+1):""},i.ct=function(f){const s=[],u=f.id;return u===void 0&&s.push({message:`layers.${u}: missing required property "id"`}),f.render===void 0&&s.push({message:`layers.${u}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&s.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),s},i.cu=function(f,s,u,p){return f.type==="custom"?new rse(f,s):new fse[f.type](f,s,u,p)},i.cv=Il,i.cw=class extends Kx{constructor(f,s){super(f._vectorTileFeature,f._z,f._x,f._y,f.id),f.state&&(this.state=Object.assign({},f.state)),this.target=s.target,this.namespace=s.namespace,s.properties&&(this.properties=s.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=f.source,this.sourceLayer=f.sourceLayer,this.layer=f.layer)}toJSON(){const f=super.toJSON();return f.target=this.target,f.namespace=this.namespace,f}},i.cx=zc,i.cy=Ka,i.cz=Ky,i.d=function(f){return $i.API_TILEJSON_REGEX.test(f)},i.d$=pB,i.d0=(f,s,u,p,v,m,_,P,O)=>{const B=f.transform,k=B.calculatePixelsToTileUnitsMatrix(s),R=u.paint.get("line-trim-color-use-theme").constantOr("default")==="none",z=B.pitch<15?oF(.07,.7,pr((14-B.zoom)/5,0,1)):.07;return{u_matrix:cF(f,s,u,p),u_pixels_to_tile_units:k,u_device_pixel_ratio:m,u_width_scale:_,u_floor_width_scale:P,u_units_to_pixels:[1/B.pixelsToGLUnits[0],1/B.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:v,u_texsize:dF(u)&&s.lineAtlasTexture?s.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:lF(s,f.transform),u_alpha_discard_threshold:0,u_trim_offset:O,u_trim_fade_range:u.paint.get("line-trim-fade-range"),u_trim_color:u.paint.get("line-trim-color").toRenderColor(R?null:u.lut).toArray01(),u_emissive_strength:u.paint.get("line-emissive-strength"),u_zbias_factor:z,u_tile_to_meter:l(s.tileID.canonical,0)}},i.d1=Qs,i.d2=Ng,i.d3=X5,i.d4=gr,i.d5=X2,i.d6=kg,i.d7=450,i.d8=7,i.d9=tse,i.dA=Sr,i.dB=g,i.dC=Sh,i.dD=function([f,s,u]){const p=Math.hypot(f,s,u),v=Math.atan2(f,u),m=.5*Math.PI-Math.acos(-s/p);return new Kn(Ot(v),Ot(m))},i.dE=wk,i.dF=function(f){const s=f.navigator?f.navigator.userAgent:null;return!!function(u){if(va==null){const p=u.navigator?u.navigator.userAgent:null;va=!!u.safari||!(!p||!(/\b(iPad|iPhone|iPod)\b/.test(p)||p.match("Safari")&&!p.match("Chrome")))}return va}(f)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dG=function(f,s){lt=f,wt=s},i.dH=Pl,i.dI=Vo,i.dJ=function(f){const s=[0,0,0],u=ze.mat4.identity(new Float64Array(16));return ze.mat4.multiply(u,f.pixelMatrix,f.globeMatrix),ze.vec3.transformMat4(s,s,u),new Rt(s[0],s[1])},i.dK=function(f,s,u=!1){if(Lo===dh||Lo===bf||Lo===sg)throw new Error("setRTLTextPlugin cannot be called multiple times.");Tl=Ye.resolveURL(f),Lo=dh,Al=s,Fy(),u||wf()},i.dL=hh,i.dM=function(){wS().acquire(kk)},i.dN=function(){const f=Sb;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(kk),Sb=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dO=i0,i.dP=function(f){const s=ar();if(!s)return;const u=s.delete(gt);f&&u.catch(f).then(()=>f())},i.dQ=wb,i.dR=nB,i.dS=function(f){zk=Ye.resolveURL(f),Hx||(Hx=new Ux(wS(),new au)),Hx.broadcast("setDracoUrl",zk)},i.dT=iB,i.dU=function(f){Wx=Ye.resolveURL(f),Hx||(Hx=new Ux(wS(),new au)),Hx.broadcast("setMeshoptUrl",Wx)},i.dV=mr,i.dW=bd,i.dX=Ph,i.dY=Rx,i.dZ=class{constructor(f,s){this.pos=f,this.dir=s}intersectsPlane(f,s,u){const p=ze.vec2.dot(s,this.dir);if(Math.abs(p)<1e-6)return!1;const v=((f[0]-this.pos[0])*s[0]+(f[1]-this.pos[1])*s[1])/p;return u[0]=this.pos[0]+this.dir[0]*v,u[1]=this.pos[1]+this.dir[1]*v,!0}},i.d_=fB,i.da=Jn,i.db=mg,i.dc=256,i.dd=ji,i.de=rl,i.df=bu,i.dg=Kp,i.dh=function(f,s,u,p,v){return pr((f-s)/(u-s)*(v-p)+p,p,v)},i.di=Ul,i.dj=Lf,i.dk=class{constructor(f,s,u,p){this.context=f,this.format=p,this.size=u,this.texture=f.gl.createTexture();const[v,m,_]=this.size,{gl:P}=f;P.bindTexture(P.TEXTURE_3D,this.texture),f.pixelStoreUnpackFlipY.set(!1),f.pixelStoreUnpack.set(1),f.pixelStoreUnpackPremultiplyAlpha.set(!1),P.texImage3D(P.TEXTURE_3D,0,this.format,v,m,_,0,xk(this.format),vk(this.format),s.data)}bind(f,s){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_3D,this.texture),f!==this.minFilter&&(p.texParameteri(p.TEXTURE_3D,p.TEXTURE_MAG_FILTER,f),p.texParameteri(p.TEXTURE_3D,p.TEXTURE_MIN_FILTER,f),this.minFilter=f),s!==this.wrapS&&(p.texParameteri(p.TEXTURE_3D,p.TEXTURE_WRAP_S,s),p.texParameteri(p.TEXTURE_3D,p.TEXTURE_WRAP_T,s),this.wrapS=s)}destroy(){const{gl:f}=this.context;f.deleteTexture(this.texture),this.texture=null}},i.dl=Sk,i.dm=[1,1,1],i.dn=Vx,i.dp=Bx,i.dq=Ls,i.dr=vh,i.ds=_d,i.dt=md,i.du=hc,i.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Rt(1/0,1/0),max:new Rt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(f,s=!1){const u=R5(new Rt(0,0),new Rt(cr,cr),f),p=[];if(s&&!Kj(u,this._globalClipBounds))return p;for(const v of this._activeRegions){if(v.hiddenByOverlap||!Kj(u,v))continue;const m=Yie(v.min,v.max,f);p.push({min:m.min,max:m.max,sourceId:this._sourceIds[v.priority],footprint:v.footprint,footprintTileId:v.tileId,order:v.order,clipMask:v.clipMask,clipScope:v.clipScope})}return p}setSources(f){this._setSources(f.map(s=>({getSourceId:()=>s.cache.id,getFootprints:()=>{const u=[];for(const p of s.cache.getVisibleCoordinates()){const v=s.cache.getTile(p).buckets[s.layer];v&&v.updateFootprints(p.toUnwrapped(),u)}return u},getOrder:()=>s.order,getClipMask:()=>s.clipMask,getClipScope:()=>s.clipScope})))}_addSource(f){const s=f.getFootprints();if(s.length===0)return;const u=f.getOrder(),p=f.getClipMask(),v=f.getClipScope();for(const m of s){if(!m.footprint)continue;const _=R5(m.footprint.min,m.footprint.max,m.id);this._activeRegions.push({min:_.min,max:_.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:m.id,footprint:m.footprint,order:u,clipMask:p,clipScope:v})}this._sourceIds.push(f.getSourceId())}_computeReplacement(){this._activeRegions.sort((s,u)=>s.priority-u.priority||Z2(s.min,u.min)||Z2(s.max,u.max)||s.order-u.order||s.clipMask-u.clipMask||function(p,v){const m=(_,P)=>_+P;return p.length-v.length||p.reduce(m,"").localeCompare(v.reduce(m,""))}(s.clipScope,u.clipScope));let f=this._activeRegions.length!==this._prevRegions.length;if(!f){let s=0;for(;!f&&s!==this._activeRegions.length;){const u=this._activeRegions[s],p=this._prevRegions[s];f=u.priority!==p.priority||!O5(u,p)||u.order!==p.order||u.clipMask!==p.clipMask||!En(u.clipScope,p.clipScope),++s}}if(f){++this._updateTime;for(const u of this._activeRegions)u.order!==K2&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,u.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,u.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,u.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,u.max.y));const s=u=>{const p=this._activeRegions;if(u>=p.length)return u;const v=p[u].priority;for(;u<p.length&&p[u].priority===v;)++u;return u};if(this._sourceIds.length>1){let u=0,p=s(u);for(;u!==p;){let v=u;const m=u;for(;v!==p;){const _=this._activeRegions[v];_.hiddenByOverlap=!1;for(let P=0;P<m;P++){const O=this._activeRegions[P];if(!O.hiddenByOverlap&&_.order===K2&&Kj(_,O)&&(_.hiddenByOverlap=L5(_.footprint,_.tileId,O.footprint,O.tileId),_.hiddenByOverlap))break}++v}u=p,p=s(u)}}}}_setSources(f){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let s=f.length-1;s>=0;s--)this._addSource(f[s]);this._computeReplacement()}},i.dw=class{constructor(f){this._createGrid(f),this._createPoles(f)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const f of this._poleSegments)f.destroy();for(const f of this._gridSegments)f.withSkirts.destroy(),f.withoutSkirts.destroy()}_fillGridMeshWithLods(f,s){const u=new Fo,p=new bs,v=[],m=f+1+2,_=s[0]+1,P=s[0]+1+(1+s.length),O=(B,k,R)=>{let z=B===m-1?B-2:B===0?B:B-1;return z+=R?24575:0,[z,k]};for(let B=0;B<m;++B)u.emplaceBack(...O(B,0,!0));for(let B=0;B<_;++B)for(let k=0;k<m;++k)u.emplaceBack(...O(k,B,(k===0||k===m-1)&&!0));for(let B=0;B<s.length;++B){const k=s[B];for(let R=0;R<m;++R)u.emplaceBack(...O(R,k,!0))}for(let B=0;B<s.length;++B){const k=p.length,R=s[B]+1+2,z=new bs;for(let q=0;q<R-1;q++){const X=q===R-2,te=X?m*(P-s.length+B-q):m;for(let le=0;le<m-1;le++){const ce=q*m+le;q===0||X||le===0||le===m-2?(z.emplaceBack(ce+1,ce,ce+te),z.emplaceBack(ce+te,ce+te+1,ce+1)):(p.emplaceBack(ce+1,ce,ce+te),p.emplaceBack(ce+te,ce+te+1,ce+1))}}const M=Na.simpleSegment(0,k,u.length,p.length-k);for(let q=0;q<z.uint16.length;q+=3)p.emplaceBack(z.uint16[q],z.uint16[q+1],z.uint16[q+2]);const L=Na.simpleSegment(0,k,u.length,p.length-k);v.push({withoutSkirts:M,withSkirts:L})}return{vertices:u,indices:p,segments:v}}_createGrid(f){const s=this._fillGridMeshWithLods(wh,If);this._gridSegments=s.segments,this._gridBuffer=f.createVertexBuffer(s.vertices,Lr.members),this._gridIndexBuffer=f.createIndexBuffer(s.indices,!0)}_createPoles(f){const s=new bs;for(let _=0;_<=wh;_++)s.emplaceBack(0,_+1,_+2);this._poleIndexBuffer=f.createIndexBuffer(s,!0);const u=new bu,p=new bu,v=new bu,m=new bu;this._poleSegments=[];for(let _=0,P=0;_<vd;_++){const O=360/(1<<_);u.emplaceBack(0,-so,0,.5,0),p.emplaceBack(0,-so,0,.5,1),v.emplaceBack(0,-so,0,.5,.5),m.emplaceBack(0,-so,0,.5,.5);for(let B=0;B<=wh;B++){let k=B/wh,R=0;const z=Fr(0,O,k),[M,L,q]=al(Ah,pc,z,so);u.emplaceBack(M,L,q,k,R),p.emplaceBack(M,L,q,k,1-R);const X=dt(z);k=.5+.5*Math.sin(X),R=.5+.5*Math.cos(X),v.emplaceBack(M,L,q,k,R),m.emplaceBack(M,L,q,k,1-R)}this._poleSegments.push(Na.simpleSegment(P,0,66,64)),P+=66}this._poleNorthVertexBuffer=f.createVertexBuffer(u,qr,!1),this._poleSouthVertexBuffer=f.createVertexBuffer(p,qr,!1),this._texturedPoleNorthVertexBuffer=f.createVertexBuffer(v,qr,!1),this._texturedPoleSouthVertexBuffer=f.createVertexBuffer(m,qr,!1)}getGridBuffers(f,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[f].withSkirts:this._gridSegments[f].withoutSkirts]}getPoleBuffers(f,s){return[s?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,s?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[f]]}},i.dx=K2,i.dy=vr,i.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.e=$i,i.e0=nF,i.e1=ac,i.e2=_l,i.e3=EF,i.e4=function(f,s,u,p,v,m,_,P,O,B,k=1,R,z){f.createArrays(),f.tilePixelRatio=cr/(512*f.overscaling),f.compareText={},f.iconsNeedLinear=!1;const M=f.layers[0].layout,L=f.layers[0]._unevaluatedLayout._values,q={};q.scaleFactor=k,q.textSizeScaleRange=M.get("text-size-scale-range"),q.iconSizeScaleRange=M.get("icon-size-scale-range");const[X,te]=q.textSizeScaleRange,[le,ce]=q.iconSizeScaleRange;if(q.textScaleFactor=pr(q.scaleFactor,X,te),q.iconScaleFactor=pr(q.scaleFactor,le,ce),f.textSizeData.kind==="composite"){const{minZoom:je,maxZoom:Fe}=f.textSizeData;q.compositeTextSizes=[L["text-size"].possiblyEvaluate(new vi(je),P),L["text-size"].possiblyEvaluate(new vi(Fe),P)]}if(f.iconSizeData.kind==="composite"){const{minZoom:je,maxZoom:Fe}=f.iconSizeData;q.compositeIconSizes=[L["icon-size"].possiblyEvaluate(new vi(je),P),L["icon-size"].possiblyEvaluate(new vi(Fe),P)]}q.layoutTextSize=L["text-size"].possiblyEvaluate(new vi(O+1),P),q.layoutIconSize=L["icon-size"].possiblyEvaluate(new vi(O+1),P),q.textMaxSize=L["text-size"].possiblyEvaluate(new vi(18),P);const ie=M.get("text-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point",fe=M.get("text-size");let xe=!1;for(const je of f.features)if(je.icon&&je.icon.nameSecondary){xe=!0;break}for(const je of f.features){const Fe=M.get("text-font").evaluate(je,{},P).join(","),De=fe.evaluate(je,{},P)*q.textScaleFactor,Ie=q.layoutTextSize.evaluate(je,{},P)*q.textScaleFactor,et=(q.layoutIconSize.evaluate(je,{},P),{horizontal:{},vertical:void 0}),Ve=je.text;let rt,ot=[0,0];if(Ve){const ft=Ve.toString(),xt=M.get("text-letter-spacing").evaluate(je,{},P)*Uo,ut=M.get("text-line-height").evaluate(je,{},P)*Uo,Mt=Ly(ft)?xt:0,qt=M.get("text-anchor").evaluate(je,{},P),Et=M.get("text-variable-anchor");if(!Et){const kr=M.get("text-radial-offset").evaluate(je,{},P);ot=kr?DF(qt,[kr*Uo,uk]):M.get("text-offset").evaluate(je,{},P).map(yr=>yr*Uo)}let fr=ie?"center":M.get("text-justify").evaluate(je,{},P);const lr=M.get("symbol-placement")==="point",Qt=lr?M.get("text-max-width").evaluate(je,{},P)*Uo:1/0,Gt=kr=>{f.allowVerticalPlacement&&Vp(ft)&&(et.vertical=ok(Ve,s,u,v,Fe,Qt,ut,qt,kr,Mt,ot,Tu.vertical,!0,Ie,De))};if(!ie&&Et){const kr=fr==="auto"?Et.map(_r=>dk(_r)):[fr];let yr=!1;for(let _r=0;_r<kr.length;_r++){const rn=kr[_r];if(!et.horizontal[rn])if(yr)et.horizontal[rn]=et.horizontal[0];else{const vn=ok(Ve,s,u,v,Fe,Qt,ut,"center",rn,Mt,ot,Tu.horizontal,!1,Ie,De);vn&&(et.horizontal[rn]=vn,yr=vn.positionedLines.length===1)}}Gt("left")}else{if(fr==="auto"&&(fr=dk(qt)),lr||M.get("text-writing-mode").indexOf("horizontal")>=0||!Vp(ft)){const kr=ok(Ve,s,u,v,Fe,Qt,ut,qt,fr,Mt,ot,Tu.horizontal,!1,Ie,De);kr&&(et.horizontal[fr]=kr)}Gt(lr?"left":fr)}}let it=!1;if(je.icon&&je.icon.namePrimary){const ft=rk(f.iconSizeData,L["icon-size"],P,f.zoom,je)*q.iconScaleFactor*R,xt=je.icon.getPrimary().scaleSelf(ft).serialize(),ut=p[xt];ut&&(rt=Iae(v[xt],je.icon.nameSecondary?v[je.icon.getSecondary().scaleSelf(ft).serialize()]:void 0,M.get("icon-offset").evaluate(je,{},P),M.get("icon-anchor").evaluate(je,{},P)),it=ut.sdf,f.sdfIcons===void 0?f.sdfIcons=ut.sdf:f.sdfIcons!==ut.sdf&&ln("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ut.pixelRatio!==f.pixelRatio||M.get("icon-rotate").constantOr(1)!==0)&&(f.iconsNeedLinear=!0))}const ct=zF(et.horizontal)||et.vertical;f.iconsInText||(f.iconsInText=!!ct&&ct.iconsInText),(ct||rt)&&Uae(f,je,et,rt,p,q,Ie,0,ot,it,_,P,B,z,xe)}m&&f.generateCollisionDebugBuffers(O,f.collisionBoxArray,q.textScaleFactor)},i.e5=kS,i.e6=on,i.e7=k5,i.e8=yF,i.e9=x,i.ea=function(f){let s=0;if(new Uint32Array(f,0,1)[0]!==sB){const u=new Uint32Array(f,0,7),[,,p,v,m,_]=u;s=u.byteLength+v+m+_+m,(p!==f.byteLength||s>=f.byteLength)&&ln("Invalid b3dm header information.")}return uB(f,s)},i.eb=function(f,s){const u=hB(f);for(const p of u){for(const v of p.meshes)yoe(v);p.lights&&(p.lightMeshIndex=p.meshes.length,p.meshes.push(xoe(p.lights,s)))}return u},i.ec=bS,i.ed=Tz,i.ee=tl,i.ef=function(f){sr(),Nt!=null&&Nt.then(s=>{s.keys().then(u=>{for(let p=0;p<u.length-f;p++)s.delete(u[p])})})},i.f=function(f){return f.indexOf("mapbox:")===0},i.g=function(f,s){return Ka(Ui(f,{method:"GET"}),s)},i.h=Ms,i.i=function(f){return $i.API_STYLE_REGEX.test(f)&&!gs(f)},i.j=function(f){return decodeURIComponent(atob(f).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(f){return btoa(encodeURIComponent(f).replace(/%([0-9A-F]{2})/g,(s,u)=>String.fromCharCode(+("0x"+u))))},i.l=Ui,i.m=$r,i.n=function(f,s){return Ka(Ui(f,{type:"json"}),s)},i.o=sf,i.p=function(f,s){return Ka(Ui(f,{method:"POST"}),s)},i.q=Ye,i.r=Ks,i.s=function(f){try{const s=self[f];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=Oe,i.u=function(){return function f(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,f)}()},i.v=function(f){return!!f&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(f)},i.w=ln,i.x=function(){return Pk||(Pk=new i0),Pk},i.y=bp,i.z=xi}),c(["./shared"],function(i){function x(St){const ve=St?St.url.toString():void 0;return ve?performance.getEntriesByName(ve):[]}function w(St){if(typeof St=="number"||typeof St=="boolean"||typeof St=="string"||St==null)return JSON.stringify(St);if(Array.isArray(St)){let ke="[";for(const Oe of St)ke+=`${w(Oe)},`;return`${ke}]`}let ve="{";for(const ke of Object.keys(St).sort())ve+=`${ke}:${w(St[ke])},`;return`${ve}}`}function S(St){let ve="";for(const ke of i.bm)(St.type!=="model"||ke!=="minzoom"&&ke!=="maxzoom")&&(ve+=`/${w(St[ke])}`);return ve}class T{constructor(ve){this.keyCache={},this._layers={},this._layerConfigs={},ve&&this.replace(ve)}replace(ve,ke){this._layerConfigs={},this._layers={},this.update(ve,[],ke)}update(ve,ke,Oe){this._options=Oe;for(const Je of ve)this._layerConfigs[Je.id]=Je,(this._layers[Je.id]=i.cu(Je,this.scope,null,this._options)).compileFilter(Oe),this.keyCache[Je.id]&&delete this.keyCache[Je.id];for(const Je of ke)delete this.keyCache[Je],delete this._layerConfigs[Je],delete this._layers[Je];this.familiesBySource={};const Ye=function(Je,st){const gt={};for(let wt=0;wt<Je.length;wt++){const bt=Je[wt];let Nt=st&&st[bt.id];!Nt&&(Nt=S(bt),bt.type==="line"&&bt.paint)&&function ar(sr){return typeof sr=="string"&&sr==="line-progress"||(Array.isArray(sr)?sr.some(ar):!(!sr||typeof sr!="object")&&Object.values(sr).some(ar))}(bt.paint["line-width"])&&(Nt+=`/${w(bt.paint["line-width"])}`),st&&(st[bt.id]=Nt);let Bt=gt[Nt];Bt||(Bt=gt[Nt]=[]),Bt.push(bt)}const lt=[];for(const wt in gt)lt.push(gt[wt]);return lt}(i.bj(this._layerConfigs),this.keyCache);for(const Je of Ye){const st=Je.map(Bt=>this._layers[Bt.id]),gt=st[0];if(gt.visibility==="none")continue;const lt=gt.source||"";let wt=this.familiesBySource[lt];wt||(wt=this.familiesBySource[lt]={});const bt=gt.sourceLayer||"_geojsonTileLayer";let Nt=wt[bt];Nt||(Nt=wt[bt]=[]),Nt.push(st)}}}const E=1*i.dX;class D{constructor(ve){const ke={},Oe=[];for(const gt in ve){const lt=ve[gt],wt=ke[gt]={};for(const bt in lt.glyphs){const Nt=lt.glyphs[+bt];if(!Nt||Nt.bitmap.width===0||Nt.bitmap.height===0)continue;const Bt=Nt.metrics.localGlyph?E:1,ar={x:0,y:0,w:Nt.bitmap.width+2*Bt,h:Nt.bitmap.height+2*Bt};Oe.push(ar),wt[bt]=ar}}const{w:Ye,h:Je}=i.F(Oe),st=new i.dW({width:Ye||1,height:Je||1});for(const gt in ve){const lt=ve[gt];for(const wt in lt.glyphs){const bt=lt.glyphs[+wt];if(!bt||bt.bitmap.width===0||bt.bitmap.height===0)continue;const Nt=ke[gt][wt],Bt=bt.metrics.localGlyph?E:1;i.dW.copy(bt.bitmap,st,{x:0,y:0},{x:Nt.x+Bt,y:Nt.y+Bt},bt.bitmap)}}this.image=st,this.positions=ke}}i.dV(D,"GlyphAtlas");const U="3d_elevation_id",I="hd_road_elevation";class V{constructor(){this._valid=!1}reset(ve){return this.feature=ve,this._valid=!0,this._geometry=ve.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(ve,ke){return this._valid&&ve(ke(this._geometry)),this}require(ve,ke,Oe){return this.get(ve,!0,ke,Oe)}optional(ve,ke,Oe){return this.get(ve,!1,ke,Oe)}success(){return this._valid}get(ve,ke,Oe,Ye){const Je=this.feature.properties.hasOwnProperty(ve)?+this.feature.properties[ve]:void 0;return this._valid&&Je!==void 0?Oe(Ye?Ye(Je):Je):ke&&(this._valid=!1),this}}class H{constructor(ve,ke){this.featureFunc=ve,this.vertexFunc=ke}parseFeature(ve,ke,Oe){return this.featureFunc(ve,ke,Oe)}parseVertex(ve,ke,Oe){return this.vertexFunc(ve,ke,Oe)}}const K=new H((St,ve,ke)=>St.reset(ve).require(U,Oe=>{ke.id=Oe}).optional("fixed_height_relative",Oe=>{ke.constantHeight=Oe},ae.decodeRelativeHeight).geometry(Oe=>{ke.bounds=Oe},ae.computeBounds).success(),(St,ve,ke)=>St.reset(ve).require(U,Oe=>{ke.id=Oe}).require("elevation_idx",Oe=>{ke.idx=Oe}).require("extent",Oe=>{ke.extent=Oe}).require("height_relative",Oe=>{ke.height=Oe},ae.decodeRelativeHeight).geometry(Oe=>{ke.position=Oe},ae.getPoint).success()),Q=new H((St,ve,ke)=>St.reset(ve).require(U,Oe=>{ke.id=Oe}).optional("fixed_height",Oe=>{ke.constantHeight=Oe},ae.decodeMetricHeight).geometry(Oe=>{ke.bounds=Oe},ae.computeBounds).success(),(St,ve,ke)=>St.reset(ve).require(U,Oe=>{ke.id=Oe}).require("elevation_idx",Oe=>{ke.idx=Oe}).require("extent",Oe=>{ke.extent=Oe}).require("height",Oe=>{ke.height=Oe},ae.decodeMetricHeight).geometry(Oe=>{ke.position=Oe},ae.getPoint).success());class ae{static computeBounds(ve){const ke=new i.P(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),Oe=new i.P(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const Ye of ve[0])ke.x>Ye.x&&(ke.x=Ye.x),ke.y>Ye.y&&(ke.y=Ye.y),Oe.x<Ye.x&&(Oe.x=Ye.x),Oe.y<Ye.y&&(Oe.y=Ye.y);return{min:ke,max:Oe}}static getPoint(ve){return i.ab.vec2.fromValues(ve[0][0].x,ve[0][0].y)}static decodeRelativeHeight(ve){return 1e-4*ve*5}static decodeMetricHeight(ve){return 1e-4*ve}static parse(ve){const ke=[],Oe=[],Ye=ve.length,Je=new V;for(let gt=0;gt<Ye;gt++){const lt=ve.feature(gt),wt=lt.properties.hasOwnProperty("version")?String(lt.properties.version):void 0,bt=(st=wt)?st==="1.0.1"?Q:void 0:K;if(bt===void 0){i.w(`Unknown elevation feature version number ${wt||"(unknown)"}`);continue}const Nt=lt.properties.hasOwnProperty("type")?lt.properties.type:void 0;if(Nt){if(i.dY.VectorTileFeature.types[lt.type]==="Point"&&Nt==="curve_point"){const Bt={};bt.parseVertex(Je,lt,Bt)&&ke.push(Bt)}else if(i.dY.VectorTileFeature.types[lt.type]==="Polygon"&&Nt==="curve_meta"){const Bt={};bt.parseFeature(Je,lt,Bt)&&Oe.push(Bt)}}}var st;return{vertices:ke,features:Oe}}}class ee{constructor(ve,ke,Oe,Ye,Je,st){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=ve,this.heightRange={min:Oe,max:Oe},this.safeArea=ke,this.constantHeight=Oe,this.constantHeight==null&&(this.constantHeight!=null||Ye.length!==0)){this.vertices=Ye,this.edges=Je,this.edges=this.edges.filter(gt=>gt.a<this.vertices.length&&gt.b<this.vertices.length&&!i.ab.vec2.exactEquals(this.vertices[gt.a].position,this.vertices[gt.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const gt of this.vertices)this.vertexProps.push({dir:i.ab.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,gt.height),this.heightRange.max=Math.max(this.heightRange.max,gt.height);for(const gt of this.edges){const lt=this.vertices[gt.a].position,wt=this.vertices[gt.b].position,bt=i.ab.vec2.subtract(i.ab.vec2.create(),wt,lt),Nt=i.ab.vec2.length(bt),Bt=i.ab.vec2.scale(i.ab.vec2.create(),bt,1/Nt);this.edgeProps.push({vec:bt,dir:Bt,len:Nt});const ar=this.vertexProps[gt.a].dir,sr=this.vertexProps[gt.b].dir;i.ab.vec2.add(ar,ar,Bt),i.ab.vec2.add(sr,sr,Bt)}for(const gt of this.vertexProps)gt.dir[0]===0&&gt.dir[1]===0||i.ab.vec2.normalize(gt.dir,gt.dir);this.tessellate(st)}}pointElevation(ve){if(this.constantHeight!=null)return this.constantHeight;const ke=this.getClosestEdge(ve);if(ke==null)return 0;const[Oe,Ye]=ke;return(1-(Je=Ye))*this.vertices[this.edges[Oe].a].height+Je*this.vertices[this.edges[Oe].b].height;var Je}getClosestEdge(ve){if(this.edges.length===0)return;let ke=0,Oe=Number.POSITIVE_INFINITY,Ye=0;const Je=i.ab.vec2.fromValues(ve.x,ve.y);for(let st=0;st<this.edges.length;st++){const gt=this.edges[st],lt=this.edgeProps[st].dir,wt=new i.dZ(Je,this.edgeProps[st].dir),bt=this.vertices[gt.a].position,Nt=this.vertices[gt.b].position,Bt=i.ab.vec2.create(),ar=i.ab.vec2.create(),sr=wt.intersectsPlane(bt,this.vertexProps[gt.a].dir,Bt),Nr=wt.intersectsPlane(Nt,this.vertexProps[gt.b].dir,ar);if(!sr||!Nr)continue;const $r=i.ab.vec2.subtract(i.ab.vec2.create(),ar,Bt),Ur=i.ab.vec2.subtract(i.ab.vec2.create(),Je,Bt),Vr=i.ab.vec2.dot($r,$r),On=Vr>0?i.ab.vec2.dot(Ur,$r)/Vr:0,Hn=i.aw(On,0,1),Tn=Math.abs((On-Hn)*this.edgeProps[st].len),$n=i.ab.vec2.subtract(i.ab.vec2.create(),Je,bt),Rn=Tn+Math.abs(i.ab.vec2.dot($n,i.ab.vec2.fromValues(lt[1],-lt[0])));Rn<Oe&&(ke=st,Oe=Rn,Ye=Hn)}return[ke,Ye]}tessellate(ve){for(let ke=this.edges.length-1;ke>=0;--ke){const Oe=this.edges[ke].a,Ye=this.edges[ke].b,{position:Je,height:st,extent:gt}=this.vertices[Oe],{position:lt,height:wt,extent:bt}=this.vertices[Ye],Nt=this.vertexProps[Oe].dir,Bt=this.vertexProps[Ye].dir,ar=i.ab.vec3.fromValues(Je[0]/ve,Je[1]/ve,st),sr=i.ab.vec3.fromValues(lt[0]/ve,lt[1]/ve,wt),Nr=i.ab.vec3.fromValues(Nt[1],-Nt[0],0);i.ab.vec3.scale(Nr,Nr,gt);const $r=i.ab.vec3.fromValues(Bt[1],-Bt[0],0);if(i.ab.vec3.scale($r,$r,bt),this.distSqLines(i.ab.vec3.fromValues(ar[0]+.5*Nr[0],ar[1]+.5*Nr[1],ar[2]+.5*Nr[2]),i.ab.vec3.fromValues(sr[0]-.5*$r[0],sr[1]-.5*$r[1],sr[2]-.5*$r[2]),i.ab.vec3.fromValues(ar[0]-.5*Nr[0],ar[1]-.5*Nr[1],ar[2]-.5*Nr[2]),i.ab.vec3.fromValues(sr[0]+.5*$r[0],sr[1]+.5*$r[1],sr[2]+.5*$r[2]))<=.05*.05)continue;const Ur=this.vertices.length,Vr=i.ab.vec2.add(i.ab.vec2.create(),Je,lt);this.vertices.push({position:i.ab.vec2.scale(Vr,Vr,.5),height:.5*(st+wt),extent:.5*(gt+bt)});const On=i.ab.vec2.add(i.ab.vec2.create(),Nt,Bt);this.vertexProps.push({dir:i.ab.vec2.normalize(On,On)}),this.edges.splice(ke,1),this.edgeProps.splice(ke,1),this.edges.push({a:Oe,b:Ur}),this.edges.push({a:Ur,b:Ye});const Hn=i.ab.vec2.subtract(i.ab.vec2.create(),this.vertices[Ur].position,Je),Tn=i.ab.vec2.length(Hn),$n={vec:Hn,dir:i.ab.vec2.scale(i.ab.vec2.create(),Hn,1/Tn),len:Tn};this.edgeProps.push($n),this.edgeProps.push($n)}}distSqLines(ve,ke,Oe,Ye){const Je=i.ab.vec3.subtract(i.ab.vec3.create(),ke,ve),st=i.ab.vec3.subtract(i.ab.vec3.create(),Ye,Oe),gt=i.ab.vec3.subtract(i.ab.vec3.create(),ve,Oe),lt=i.ab.vec3.dot(Je,Je),wt=i.ab.vec3.dot(Je,st),bt=i.ab.vec3.dot(Je,gt),Nt=i.ab.vec3.dot(st,st),Bt=i.ab.vec3.dot(st,gt),ar=lt*Nt-wt*wt;if(ar===0){const Vr=i.ab.vec3.dot(gt,st)/i.ab.vec3.dot(st,st),On=i.ab.vec3.lerp(i.ab.vec3.create(),Oe,Ye,Vr);return i.ab.vec3.squaredDistance(On,ve)}const sr=(wt*Bt-bt*Nt)/ar,Nr=(lt*Bt-wt*bt)/ar,$r=i.ab.vec3.lerp(i.ab.vec3.create(),ve,ke,sr),Ur=i.ab.vec3.lerp(i.ab.vec3.create(),Oe,Ye,Nr);return i.ab.vec3.squaredDistance($r,Ur)}}class se{static parseFrom(ve,ke){const Oe=ae.parse(ve);if(!Oe)return[];let{vertices:Ye,features:Je}=Oe;const st=1/i.cc(ke);Je.sort((bt,Nt)=>bt.id-Nt.id),Ye.sort((bt,Nt)=>bt.id-Nt.id||bt.idx-Nt.idx),Ye=Ye.filter((bt,Nt,Bt)=>Nt===Bt.findIndex(ar=>ar.id===bt.id&&ar.idx===bt.idx));const gt=new Array;let lt=0;const wt=Ye.length;for(const bt of Je){if(bt.constantHeight){gt.push(new ee(bt.id,bt.bounds,bt.constantHeight));continue}for(;lt!==wt&&Ye[lt].id<bt.id;)lt++;if(lt===wt||Ye[lt].id!==bt.id)continue;const Nt=new Array,Bt=new Array,ar=lt;for(;lt!==wt&&Ye[lt].id===bt.id;){const sr=Ye[lt];if(Nt.push({position:sr.position,height:sr.height,extent:sr.extent}),lt!==ar&&Ye[lt-1].idx===sr.idx-1){const Nr=lt-ar;Bt.push({a:Nr-1,b:Nr})}lt++}gt.push(new ee(bt.id,bt.bounds,void 0,Nt,Bt,st))}return gt}}i.dV(ee,"ElevationFeature");class ue{constructor(ve){this.tileID=new i.aG(ve.tileID.overscaledZ,ve.tileID.wrap,ve.tileID.canonical.z,ve.tileID.canonical.x,ve.tileID.canonical.y),this.tileZoom=ve.tileZoom,this.uid=ve.uid,this.zoom=ve.zoom,this.lut=ve.lut,this.canonical=ve.tileID.canonical,this.pixelRatio=ve.pixelRatio,this.tileSize=ve.tileSize,this.source=ve.source,this.scope=ve.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ve.showCollisionBoxes,this.collectResourceTiming=!!ve.request&&ve.request.collectResourceTiming,this.promoteId=ve.promoteId,this.isSymbolTile=ve.isSymbolTile,this.tileTransform=i.aQ(ve.tileID.canonical,ve.projection),this.projection=ve.projection,this.worldview=ve.worldview,this.localizableLayerIds=ve.localizableLayerIds,this.brightness=ve.brightness,this.extraShadowCaster=!!ve.extraShadowCaster,this.tessellationStep=ve.tessellationStep,this.scaleFactor=ve.scaleFactor}parse(ve,ke,Oe,Ye,Je){this.status="parsing",this.data=ve,this.collisionBoxArray=new i.aW;const st=new i.d_(Object.keys(ve.layers).sort()),gt=new i.d$(this.tileID,this.promoteId);gt.bucketLayerIDs=[];const lt={},wt=new i.e0(256,256),bt={featureIndex:gt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:wt,availableImages:Oe,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Nt=ke.familiesBySource[this.source];for(const Vr in Nt){const On=ve.layers[Vr];if(!On)continue;let Hn=!1,Tn=!1,$n=!1;for(const Ka of Nt[Vr])Ka[0].type==="symbol"?Hn=!0:Tn=!0,Ka[0].is3D()&&Ka[0].type!=="model"&&($n=!0);if(this.extraShadowCaster&&!$n||this.isSymbolTile===!0&&!Hn||this.isSymbolTile===!1&&!Tn)continue;On.version===1&&i.w(`Vector tile source "${this.source}" layer "${Vr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Rn=st.encode(Vr),Oa=[];let ys=!1;for(let Ka=0,ls=0;Ka<On.length;Ka++){const vo=On.feature(Ka),Wu=gt.getId(vo,Vr);if(this.localizableLayerIds&&this.localizableLayerIds.has(Vr)){const Dl=vo.properties?vo.properties.worldview:null;if(this.worldview&&typeof Dl=="string")if(Dl==="all")vo.properties.$localized=!0;else{if(!Dl.split(",").includes(this.worldview))continue;vo.properties.$localized=!0,vo.properties.worldview=this.worldview}}!ys&&vo.properties&&vo.properties.hasOwnProperty(U)&&(ys=!0),Oa.push({feature:vo,id:Wu,index:ls,sourceLayerIndex:Rn}),ls++}ys&&ve.layers.hasOwnProperty(I)&&(bt.elevationFeatures=se.parseFrom(ve.layers[I],this.canonical));for(const Ka of Nt[Vr]){const ls=Ka[0];(!this.extraShadowCaster||ls.is3D()&&ls.type!=="model")&&(this.isSymbolTile!==void 0&&ls.type==="symbol"!==this.isSymbolTile||ls.minzoom&&this.zoom<Math.floor(ls.minzoom)||ls.maxzoom&&this.zoom>=ls.maxzoom||ls.visibility!=="none"&&(he(Ka,this.zoom,bt.brightness,Oe),(lt[ls.id]=ls.createBucket({index:gt.bucketLayerIDs.length,layers:Ka,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Rn,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(Oa,bt,this.tileID.canonical,this.tileTransform),gt.bucketLayerIDs.push(Ka.map(vo=>i.aC(vo.id,vo.scope)))))}}let Bt,ar,sr,Nr;wt.trim();const $r={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Ur=()=>{if(Bt)return this.status="done",Je(Bt);if(this.extraShadowCaster)this.status="done",Je(null,{buckets:i.bj(lt).filter(Vr=>!Vr.isEmpty()),featureIndex:gt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:bt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(ar&&sr&&Nr){const Vr=new D(ar),On=new i.e3(sr,Nr,this.lut);for(const Hn in lt){const Tn=lt[Hn];Tn instanceof i.aX?(he(Tn.layers,this.zoom,bt.brightness,Oe),i.e4(Tn,ar,Vr.positions,sr,On.iconPositions,this.showCollisionBoxes,Oe,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):Tn.hasPattern&&(Tn instanceof i.b1||Tn instanceof i.b2||Tn instanceof i.d5)&&(he(Tn.layers,this.zoom,bt.brightness,Oe),Tn.addFeatures(bt,this.tileID.canonical,On.patternPositions,Oe,this.tileTransform,this.brightness))}this.status="done",Je(null,{buckets:i.bj(lt).filter(Hn=>!Hn.isEmpty()),featureIndex:gt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Vr.image,lineAtlas:wt,imageAtlas:On,brightness:bt.brightness})}};if(!this.extraShadowCaster){const Vr=i.e1(bt.glyphDependencies,Tn=>Object.keys(Tn).map(Number));Object.keys(Vr).length?Ye.send("getGlyphs",{uid:this.uid,stacks:Vr,scope:this.scope},(Tn,$n)=>{Bt||(Bt=Tn,ar=$n,Ur())},void 0,!1,$r):ar={};const On=Object.keys(bt.iconDependencies);On.length?Ye.send("getImages",{icons:On,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Tn,$n)=>{if(Bt)return;Bt=Tn;const Rn={};Object.values($n).some(Oa=>Oa.usvg)?this.rasterize(Ye,Rn,$n,bt.iconDependencies,()=>{sr=Rn,Ur()}):(this.fillImageMap(Rn,bt.iconDependencies,$n),sr=Rn,Ur())},void 0,!1,$r):sr={};const Hn=Object.keys(bt.patternDependencies);Hn.length?Ye.send("getImages",{icons:Hn,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Tn,$n)=>{if(!Bt){Bt=Tn;const Rn={};Object.values($n).some(Oa=>Oa.usvg)?this.rasterize(Ye,Rn,$n,bt.patternDependencies,()=>{Nr=Rn,Ur()}):(this.fillImageMap(Rn,bt.patternDependencies,$n),Nr=Rn,Ur())}},void 0,!1,$r):Nr={}}Ur()}fillImageMap(ve,ke,Oe){for(const Ye in Oe){const Je=ke[Ye]||[];for(const st of Je)Oe[st.id].usvg||(ve[st.serialize()]=Oe[st.id])}}getImageTaskQueue(ve,ke,Oe){const Ye={};for(const Je in ke){const st=Oe[Je]||[];for(const gt of st){const lt=gt.serialize();ke[gt.id].usvg?Ye[lt]||(Ye[lt]=gt):ve[lt]=ke[gt.id]}}return Ye}rasterize(ve,ke,Oe,Ye,Je){const st=this.getImageTaskQueue(ke,Oe,Ye);this.rasterizeTask=ve.send("rasterizeImages",{scope:this.scope,imageTasks:st},(gt,lt)=>{if(!gt)for(const wt in lt){const{id:bt}=i.e2.deserializeFromString(wt);ke[wt]=Object.assign({},Oe[bt],{data:lt[wt]})}Je()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function he(St,ve,ke,Oe){const Ye=new i.a8(ve,{brightness:ke});for(const Je of St)Je.recalculate(Ye,Oe)}class Ce extends i.E{constructor(ve,ke,Oe,Ye,Je,st){super(),this.actor=ve,this.layerIndex=ke,this.availableImages=Oe,this.loadVectorData=Je||i.aD,this.loading={},this.loaded={},this.deduped=new i.aB(ve.scheduler),this.isSpriteLoaded=Ye,this.scheduler=ve.scheduler,this.brightness=st}loadTile(ve,ke){const Oe=ve.uid,Ye=ve&&ve.request,Je=Ye&&Ye.collectResourceTiming,st=this.loading[Oe]=new ue(ve);st.abort=this.loadVectorData(ve,(gt,lt)=>{const wt=!this.loading[Oe];if(delete this.loading[Oe],st.cancelRasterize(),wt||gt||!lt)return st.status="done",wt||(this.loaded[Oe]=st),ke(gt);const bt=lt.rawData,Nt={};lt.expires&&(Nt.expires=lt.expires),lt.cacheControl&&(Nt.cacheControl=lt.cacheControl),st.vectorTile=lt.vectorTile||new i.dY.VectorTile(new i.bh(bt));const Bt=()=>{st.parse(st.vectorTile,this.layerIndex,this.availableImages,this.actor,(ar,sr)=>{if(ar||!sr)return ke(ar);const Nr={};if(Je){const $r=x(Ye);$r.length>0&&(Nr.resourceTiming=JSON.parse(JSON.stringify($r)))}ke(null,i.l({rawTileData:bt.slice(0)},sr,Nt,Nr))})};this.isSpriteLoaded?Bt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Bt,{type:"parseTile",isSymbolTile:ve.isSymbolTile,zoom:ve.tileZoom}):Bt()}),this.loaded=this.loaded||{},this.loaded[Oe]=st})}reloadTile(ve,ke){const Oe=this.loaded,Ye=ve.uid;if(Oe&&Oe[Ye]){const Je=Oe[Ye];Je.scaleFactor=ve.scaleFactor,Je.showCollisionBoxes=ve.showCollisionBoxes,Je.projection=ve.projection,Je.brightness=ve.brightness,Je.tileTransform=i.aQ(ve.tileID.canonical,ve.projection),Je.extraShadowCaster=ve.extraShadowCaster,Je.lut=ve.lut;const st=(gt,lt)=>{const wt=Je.reloadCallback;wt&&(delete Je.reloadCallback,Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,wt)),ke(gt,lt)};Je.status==="parsing"?Je.reloadCallback=st:Je.status==="done"&&(Je.vectorTile?Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,st):st())}else ke(null,void 0)}abortTile(ve,ke){const Oe=ve.uid,Ye=this.loading[Oe];Ye&&(Ye.abort&&Ye.abort(),delete this.loading[Oe]),ke()}removeTile(ve,ke){const Oe=this.loaded,Ye=ve.uid;Oe&&Oe[Ye]&&delete Oe[Ye],ke()}}class Ne{loadTile(ve,ke){const{uid:Oe,encoding:Ye,rawImageData:Je,padding:st}=ve,gt=ImageBitmap&&Je instanceof ImageBitmap?this.getImageData(Je,st):Je;ke(null,new i.e5(Oe,gt,Ye,st<1))}getImageData(ve,ke){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ve.width,ve.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ve.width,this.offscreenCanvas.height=ve.height,this.offscreenCanvasContext.drawImage(ve,0,0,ve.width,ve.height);const Oe=this.offscreenCanvasContext.getImageData(-ke,-ke,ve.width+2*ke,ve.height+2*ke);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Oe}}i.bg.setPbf(i.bh);class me{decodeRasterArray({task:ve,buffer:ke},Oe){i.bg.performDecoding(ke,ve).then(Ye=>{Oe(null,Ye)},Ye=>{Oe(Ye)})}}const be=i.dY.VectorTileFeature.prototype.toGeoJSON;class pe{constructor(ve){this._feature=ve,this.extent=i.ag,this.type=ve.type,this.properties=ve.tags,"id"in ve&&!isNaN(ve.id)&&(this.id=parseInt(ve.id,10))}loadGeometry(){if(this._feature.type===1){const ve=[];for(const ke of this._feature.geometry)ve.push([new i.P(ke[0],ke[1])]);return ve}{const ve=[];for(const ke of this._feature.geometry){const Oe=[];for(const Ye of ke)Oe.push(new i.P(Ye[0],Ye[1]));ve.push(Oe)}return ve}}toGeoJSON(ve,ke,Oe){return be.call(this,ve,ke,Oe)}}class Se{constructor(ve){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.ag,this.length=ve.length,this._features=ve}feature(ve){return new pe(this._features[ve])}}const Ee=64/4096,we=128;class Pe{constructor(){this.features=new Map}clear(){this.features.clear()}load(ve=[],ke){for(const Oe of ve){const Ye=Oe.id;if(Ye==null)continue;let Je=this.features.get(Ye);Je&&this.updateCache(Je,ke),Oe.geometry?(Je=Be(Oe),this.updateCache(Je,ke),this.features.set(Ye,Je)):this.features.delete(Ye),this.updateCache(Je,ke)}}updateCache(ve,ke){for(const{canonical:Oe,uid:Ye}of Object.values(ke)){const{z:Je,x:st,y:gt}=Oe;Me(ve,Math.pow(2,Je),st,gt)&&delete ke[Ye]}}getTile(ve,ke,Oe){const Ye=Math.pow(2,ve),Je=[];for(const st of this.features.values())Me(st,Ye,ke,Oe)&&Je.push(nt(st,Ye,ke,Oe));return{features:Je}}getFeatures(){return[...this.features.values()]}}function Me({minX:St,minY:ve,maxX:ke,maxY:Oe},Ye,Je,st){return St<(Je+1+Ee)/Ye&&ve<(st+1+Ee)/Ye&&ke>(Je-Ee)/Ye&&Oe>(st-Ee)/Ye}function Be(St){const{id:ve,geometry:ke,properties:Oe}=St;if(!ke)return;if(ke.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Ye,coordinates:Je}=ke,st={id:ve,type:1,geometry:[],tags:Oe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},gt=st.geometry;if(Ye==="Point")Ge(Je,gt,st);else if(Ye==="MultiPoint")for(const lt of Je)Ge(lt,gt,st);else if(Ye==="LineString")st.type=2,We(Je,gt,st);else if(Ye==="MultiLineString")st.type=2,tt(Je,gt,st);else if(Ye==="Polygon")st.type=3,tt(Je,gt,st,!0);else{if(Ye!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");st.type=3;for(const lt of Je)tt(lt,gt,st,!0)}return st}function Ge([St,ve],ke,Oe){const Ye=i.at(St);let Je=i.aA(ve);Je=Je<0?0:Je>1?1:Je,ke.push(Ye,Je),Oe.minX=Math.min(Oe.minX,Ye),Oe.minY=Math.min(Oe.minY,Je),Oe.maxX=Math.max(Oe.maxX,Ye),Oe.maxY=Math.max(Oe.maxY,Je)}function We(St,ve,ke,Oe=!1,Ye=!1){const Je=[];for(const st of St)Ge(st,Je,ke);ve.push(Je),Oe&&function(st,gt){let lt=0;for(let wt=0,bt=st.length,Nt=bt-2;wt<bt;Nt=wt,wt+=2)lt+=(st[wt]-st[Nt])*(st[wt+1]+st[Nt+1]);if(lt>0===gt)for(let wt=0,bt=st.length;wt<bt/2;wt+=2){const Nt=st[wt],Bt=st[wt+1];st[wt]=st[bt-2-wt],st[wt+1]=st[bt-1-wt],st[bt-2-wt]=Nt,st[bt-1-wt]=Bt}}(Je,Ye)}function tt(St,ve,ke,Oe=!1){for(let Ye=0;Ye<St.length;Ye++)We(St[Ye],ve,ke,Oe,Ye===0)}function nt(St,ve,ke,Oe){const{id:Ye,type:Je,geometry:st,tags:gt}=St,lt=[];if(Je===1)(function(wt,bt,Nt,Bt,ar){for(let sr=0;sr<wt.length;sr+=2){const Nr=Math.round(i.ag*(wt[sr+0]*bt-Nt)),$r=Math.round(i.ag*(wt[sr+1]*bt-Bt));ar.push([Nr,$r])}})(st,ve,ke,Oe,lt);else for(const wt of st)Dt(wt,ve,ke,Oe,lt);return{id:Ye,type:Je,geometry:lt,tags:gt}}function Dt(St,ve,ke,Oe,Ye){const st=i.ag+we;let gt;for(let lt=0;lt<St.length-2;lt+=2){let wt=Math.round(i.ag*(St[lt+0]*ve-ke)),bt=Math.round(i.ag*(St[lt+1]*ve-Oe)),Nt=Math.round(i.ag*(St[lt+2]*ve-ke)),Bt=Math.round(i.ag*(St[lt+3]*ve-Oe));const ar=Nt-wt,sr=Bt-bt;wt<-128&&Nt<-128||(wt<-128?(bt+=Math.round(sr*((-128-wt)/ar)),wt=-128):Nt<-128&&(Bt=bt+Math.round(sr*((-128-wt)/ar)),Nt=-128),bt<-128&&Bt<-128||(bt<-128?(wt+=Math.round(ar*((-128-bt)/sr)),bt=-128):Bt<-128&&(Nt=wt+Math.round(ar*((-128-bt)/sr)),Bt=-128),wt>=st&&Nt>=st||(wt>=st?(bt+=Math.round(sr*((st-wt)/ar)),wt=st):Nt>=st&&(Bt=bt+Math.round(sr*((st-wt)/ar)),Nt=st),bt>=st&&Bt>=st||(bt>=st?(wt+=Math.round(ar*((st-bt)/sr)),bt=st):Bt>=st&&(Nt=wt+Math.round(ar*((st-bt)/sr)),Bt=st),gt&&wt===gt[gt.length-1][0]&&bt===gt[gt.length-1][1]||(gt=[[wt,bt]],Ye.push(gt)),gt.push([Nt,Bt])))))}}var nr,ir,rr,or={exports:{}},Ft=function(){if(rr)return or.exports;rr=1;var St=i.e8(),ve=function(){if(ir)return nr;ir=1;var bt=i.e6(),Nt=i.e7().VectorTileFeature;function Bt(sr,Nr){this.options=Nr||{},this.features=sr,this.length=sr.length}function ar(sr,Nr){this.id=typeof sr.id=="number"?sr.id:void 0,this.type=sr.type,this.rawGeometry=sr.type===1?[sr.geometry]:sr.geometry,this.properties=sr.tags,this.extent=Nr||4096}return nr=Bt,Bt.prototype.feature=function(sr){return new ar(this.features[sr],this.options.extent)},ar.prototype.loadGeometry=function(){var sr=this.rawGeometry;this.geometry=[];for(var Nr=0;Nr<sr.length;Nr++){for(var $r=sr[Nr],Ur=[],Vr=0;Vr<$r.length;Vr++)Ur.push(new bt($r[Vr][0],$r[Vr][1]));this.geometry.push(Ur)}return this.geometry},ar.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var sr=this.geometry,Nr=1/0,$r=-1/0,Ur=1/0,Vr=-1/0,On=0;On<sr.length;On++)for(var Hn=sr[On],Tn=0;Tn<Hn.length;Tn++){var $n=Hn[Tn];Nr=Math.min(Nr,$n.x),$r=Math.max($r,$n.x),Ur=Math.min(Ur,$n.y),Vr=Math.max(Vr,$n.y)}return[Nr,Ur,$r,Vr]},ar.prototype.toGeoJSON=Nt.prototype.toGeoJSON,nr}();function ke(bt){var Nt=new St;return function(Bt,ar){for(var sr in Bt.layers)ar.writeMessage(3,Oe,Bt.layers[sr])}(bt,Nt),Nt.finish()}function Oe(bt,Nt){var Bt;Nt.writeVarintField(15,bt.version||1),Nt.writeStringField(1,bt.name||""),Nt.writeVarintField(5,bt.extent||4096);var ar={keys:[],values:[],keycache:{},valuecache:{}};for(Bt=0;Bt<bt.length;Bt++)ar.feature=bt.feature(Bt),Nt.writeMessage(2,Ye,ar);var sr=ar.keys;for(Bt=0;Bt<sr.length;Bt++)Nt.writeStringField(3,sr[Bt]);var Nr=ar.values;for(Bt=0;Bt<Nr.length;Bt++)Nt.writeMessage(4,wt,Nr[Bt])}function Ye(bt,Nt){var Bt=bt.feature;Bt.id!==void 0&&Nt.writeVarintField(1,Bt.id),Nt.writeMessage(2,Je,bt),Nt.writeVarintField(3,Bt.type),Nt.writeMessage(4,lt,Bt)}function Je(bt,Nt){var Bt=bt.feature,ar=bt.keys,sr=bt.values,Nr=bt.keycache,$r=bt.valuecache;for(var Ur in Bt.properties){var Vr=Bt.properties[Ur],On=Nr[Ur];if(Vr!==null){On===void 0&&(ar.push(Ur),Nr[Ur]=On=ar.length-1),Nt.writeVarint(On);var Hn=typeof Vr;Hn!=="string"&&Hn!=="boolean"&&Hn!=="number"&&(Vr=JSON.stringify(Vr));var Tn=Hn+":"+Vr,$n=$r[Tn];$n===void 0&&(sr.push(Vr),$r[Tn]=$n=sr.length-1),Nt.writeVarint($n)}}}function st(bt,Nt){return(Nt<<3)+(7&bt)}function gt(bt){return bt<<1^bt>>31}function lt(bt,Nt){for(var Bt=bt.loadGeometry(),ar=bt.type,sr=0,Nr=0,$r=Bt.length,Ur=0;Ur<$r;Ur++){var Vr=Bt[Ur],On=1;ar===1&&(On=Vr.length),Nt.writeVarint(st(1,On));for(var Hn=ar===3?Vr.length-1:Vr.length,Tn=0;Tn<Hn;Tn++){Tn===1&&ar!==1&&Nt.writeVarint(st(2,Hn-1));var $n=Vr[Tn].x-sr,Rn=Vr[Tn].y-Nr;Nt.writeVarint(gt($n)),Nt.writeVarint(gt(Rn)),sr+=$n,Nr+=Rn}ar===3&&Nt.writeVarint(st(7,1))}}function wt(bt,Nt){var Bt=typeof bt;Bt==="string"?Nt.writeStringField(1,bt):Bt==="boolean"?Nt.writeBooleanField(7,bt):Bt==="number"&&(bt%1!=0?Nt.writeDoubleField(3,bt):bt<0?Nt.writeSVarintField(6,bt):Nt.writeVarintField(5,bt))}return or.exports=ke,or.exports.fromVectorTileJs=ke,or.exports.fromGeojsonVt=function(bt,Nt){Nt=Nt||{};var Bt={};for(var ar in bt)Bt[ar]=new ve(bt[ar].features,Nt),Bt[ar].name=ar,Bt[ar].version=Nt.version,Bt[ar].extent=Nt.extent;return ke({layers:Bt})},or.exports.GeoJSONWrapper=ve,or.exports}(),ze=i.e9(Ft);const Pr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:St=>St},Kt=Math.fround||(on=new Float32Array(1),St=>(on[0]=+St,on[0]));var on;const Rt=3,En=5,Vn=6;class pi{constructor(ve){this.options=Object.assign(Object.create(Pr),ve),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ve){const{log:ke,minZoom:Oe,maxZoom:Ye}=this.options;ke&&console.time("total time");const Je=`prepare ${ve.length} points`;ke&&console.time(Je),this.points=ve;const st=[];for(let lt=0;lt<ve.length;lt++){const wt=ve[lt];if(!wt.geometry)continue;const[bt,Nt]=wt.geometry.coordinates,Bt=Kt(Zt(bt)),ar=Kt(Cr(Nt));st.push(Bt,ar,1/0,lt,-1,1),this.options.reduce&&st.push(0)}let gt=this.trees[Ye+1]=this._createTree(st);ke&&console.timeEnd(Je);for(let lt=Ye;lt>=Oe;lt--){const wt=+Date.now();gt=this.trees[lt]=this._createTree(this._cluster(gt,lt)),ke&&console.log("z%d: %d clusters in %dms",lt,gt.numItems,+Date.now()-wt)}return ke&&console.timeEnd("total time"),this}getClusters(ve,ke){let Oe=((ve[0]+180)%360+360)%360-180;const Ye=Math.max(-90,Math.min(90,ve[1]));let Je=ve[2]===180?180:((ve[2]+180)%360+360)%360-180;const st=Math.max(-90,Math.min(90,ve[3]));if(ve[2]-ve[0]>=360)Oe=-180,Je=180;else if(Oe>Je){const Nt=this.getClusters([Oe,Ye,180,st],ke),Bt=this.getClusters([-180,Ye,Je,st],ke);return Nt.concat(Bt)}const gt=this.trees[this._limitZoom(ke)],lt=gt.range(Zt(Oe),Cr(st),Zt(Je),Cr(Ye)),wt=gt.data,bt=[];for(const Nt of lt){const Bt=this.stride*Nt;bt.push(wt[Bt+En]>1?dt(wt,Bt,this.clusterProps):this.points[wt[Bt+Rt]])}return bt}getChildren(ve){const ke=this._getOriginId(ve),Oe=this._getOriginZoom(ve),Ye="No cluster with the specified id.",Je=this.trees[Oe];if(!Je)throw new Error(Ye);const st=Je.data;if(ke*this.stride>=st.length)throw new Error(Ye);const gt=this.options.radius/(this.options.extent*Math.pow(2,Oe-1)),lt=Je.within(st[ke*this.stride],st[ke*this.stride+1],gt),wt=[];for(const bt of lt){const Nt=bt*this.stride;st[Nt+4]===ve&&wt.push(st[Nt+En]>1?dt(st,Nt,this.clusterProps):this.points[st[Nt+Rt]])}if(wt.length===0)throw new Error(Ye);return wt}getLeaves(ve,ke,Oe){const Ye=[];return this._appendLeaves(Ye,ve,ke=ke||10,Oe=Oe||0,0),Ye}getTile(ve,ke,Oe){const Ye=this.trees[this._limitZoom(ve)],Je=Math.pow(2,ve),{extent:st,radius:gt}=this.options,lt=gt/st,wt=(Oe-lt)/Je,bt=(Oe+1+lt)/Je,Nt={features:[]};return this._addTileFeatures(Ye.range((ke-lt)/Je,wt,(ke+1+lt)/Je,bt),Ye.data,ke,Oe,Je,Nt),ke===0&&this._addTileFeatures(Ye.range(1-lt/Je,wt,1,bt),Ye.data,Je,Oe,Je,Nt),ke===Je-1&&this._addTileFeatures(Ye.range(0,wt,lt/Je,bt),Ye.data,-1,Oe,Je,Nt),Nt.features.length?Nt:null}getClusterExpansionZoom(ve){let ke=this._getOriginZoom(ve)-1;for(;ke<=this.options.maxZoom;){const Oe=this.getChildren(ve);if(ke++,Oe.length!==1)break;ve=Oe[0].properties.cluster_id}return ke}_appendLeaves(ve,ke,Oe,Ye,Je){const st=this.getChildren(ke);for(const gt of st){const lt=gt.properties;if(lt&&lt.cluster?Je+lt.point_count<=Ye?Je+=lt.point_count:Je=this._appendLeaves(ve,lt.cluster_id,Oe,Ye,Je):Je<Ye?Je++:ve.push(gt),ve.length===Oe)break}return Je}_createTree(ve){const ke=new i.bE(ve.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Oe=0;Oe<ve.length;Oe+=this.stride)ke.add(ve[Oe],ve[Oe+1]);return ke.finish(),ke.data=ve,ke}_addTileFeatures(ve,ke,Oe,Ye,Je,st){for(const gt of ve){const lt=gt*this.stride,wt=ke[lt+En]>1;let bt,Nt,Bt;if(wt)bt=Ot(ke,lt,this.clusterProps),Nt=ke[lt],Bt=ke[lt+1];else{const Nr=this.points[ke[lt+Rt]];bt=Nr.properties;const[$r,Ur]=Nr.geometry.coordinates;Nt=Zt($r),Bt=Cr(Ur)}const ar={type:1,geometry:[[Math.round(this.options.extent*(Nt*Je-Oe)),Math.round(this.options.extent*(Bt*Je-Ye))]],tags:bt};let sr;sr=wt||this.options.generateId?ke[lt+Rt]:this.points[ke[lt+Rt]].id,sr!==void 0&&(ar.id=sr),st.features.push(ar)}}_limitZoom(ve){return Math.max(this.options.minZoom,Math.min(Math.floor(+ve),this.options.maxZoom+1))}_cluster(ve,ke){const{radius:Oe,extent:Ye,reduce:Je,minPoints:st}=this.options,gt=Oe/(Ye*Math.pow(2,ke)),lt=ve.data,wt=[],bt=this.stride;for(let Nt=0;Nt<lt.length;Nt+=bt){if(lt[Nt+2]<=ke)continue;lt[Nt+2]=ke;const Bt=lt[Nt],ar=lt[Nt+1],sr=ve.within(lt[Nt],lt[Nt+1],gt),Nr=lt[Nt+En];let $r=Nr;for(const Ur of sr){const Vr=Ur*bt;lt[Vr+2]>ke&&($r+=lt[Vr+En])}if($r>Nr&&$r>=st){let Ur,Vr=Bt*Nr,On=ar*Nr,Hn=-1;const Tn=(Nt/bt<<5)+(ke+1)+this.points.length;for(const $n of sr){const Rn=$n*bt;if(lt[Rn+2]<=ke)continue;lt[Rn+2]=ke;const Oa=lt[Rn+En];Vr+=lt[Rn]*Oa,On+=lt[Rn+1]*Oa,lt[Rn+4]=Tn,Je&&(Ur||(Ur=this._map(lt,Nt,!0),Hn=this.clusterProps.length,this.clusterProps.push(Ur)),Je(Ur,this._map(lt,Rn)))}lt[Nt+4]=Tn,wt.push(Vr/$r,On/$r,1/0,Tn,-1,$r),Je&&wt.push(Hn)}else{for(let Ur=0;Ur<bt;Ur++)wt.push(lt[Nt+Ur]);if($r>1)for(const Ur of sr){const Vr=Ur*bt;if(!(lt[Vr+2]<=ke)){lt[Vr+2]=ke;for(let On=0;On<bt;On++)wt.push(lt[Vr+On])}}}}return wt}_getOriginId(ve){return ve-this.points.length>>5}_getOriginZoom(ve){return(ve-this.points.length)%32}_map(ve,ke,Oe){if(ve[ke+En]>1){const st=this.clusterProps[ve[ke+Vn]];return Oe?Object.assign({},st):st}const Ye=this.points[ve[ke+Rt]].properties,Je=this.options.map(Ye);return Oe&&Je===Ye?Object.assign({},Je):Je}}function dt(St,ve,ke){return{type:"Feature",id:St[ve+Rt],properties:Ot(St,ve,ke),geometry:{type:"Point",coordinates:[(Oe=St[ve],360*(Oe-.5)),vr(St[ve+1])]}};var Oe}function Ot(St,ve,ke){const Oe=St[ve+En],Ye=Oe>=1e4?`${Math.round(Oe/1e3)}k`:Oe>=1e3?Math.round(Oe/100)/10+"k":Oe,Je=St[ve+Vn],st=Je===-1?{}:Object.assign({},ke[Je]);return Object.assign(st,{cluster:!0,cluster_id:St[ve+Rt],point_count:Oe,point_count_abbreviated:Ye})}function Zt(St){return St/360+.5}function Cr(St){const ve=Math.sin(St*Math.PI/180),ke=.5-.25*Math.log((1+ve)/(1-ve))/Math.PI;return ke<0?0:ke>1?1:ke}function vr(St){const ve=(180-360*St)*Math.PI/180;return 360*Math.atan(Math.exp(ve))/Math.PI-90}function Sr(St,ve,ke,Oe){let Ye=Oe;const Je=ve+(ke-ve>>1);let st,gt=ke-ve;const lt=St[ve],wt=St[ve+1],bt=St[ke],Nt=St[ke+1];for(let Bt=ve+3;Bt<ke;Bt+=3){const ar=pr(St[Bt],St[Bt+1],lt,wt,bt,Nt);if(ar>Ye)st=Bt,Ye=ar;else if(ar===Ye){const sr=Math.abs(Bt-Je);sr<gt&&(st=Bt,gt=sr)}}Ye>Oe&&(st-ve>3&&Sr(St,ve,st,Oe),St[st+2]=Ye,ke-st>3&&Sr(St,st,ke,Oe))}function pr(St,ve,ke,Oe,Ye,Je){let st=Ye-ke,gt=Je-Oe;if(st!==0||gt!==0){const lt=((St-ke)*st+(ve-Oe)*gt)/(st*st+gt*gt);lt>1?(ke=Ye,Oe=Je):lt>0&&(ke+=st*lt,Oe+=gt*lt)}return st=St-ke,gt=ve-Oe,st*st+gt*gt}function Mn(St,ve,ke,Oe){const Ye={id:St??null,type:ve,geometry:ke,tags:Oe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ve==="Point"||ve==="MultiPoint"||ve==="LineString")Ai(Ye,ke);else if(ve==="Polygon")Ai(Ye,ke[0]);else if(ve==="MultiLineString")for(const Je of ke)Ai(Ye,Je);else if(ve==="MultiPolygon")for(const Je of ke)Ai(Ye,Je[0]);return Ye}function Ai(St,ve){for(let ke=0;ke<ve.length;ke+=3)St.minX=Math.min(St.minX,ve[ke]),St.minY=Math.min(St.minY,ve[ke+1]),St.maxX=Math.max(St.maxX,ve[ke]),St.maxY=Math.max(St.maxY,ve[ke+1])}function Vi(St,ve,ke,Oe){if(!ve.geometry)return;const Ye=ve.geometry.coordinates;if(Ye&&Ye.length===0)return;const Je=ve.geometry.type,st=Math.pow(ke.tolerance/((1<<ke.maxZoom)*ke.extent),2);let gt=[],lt=ve.id;if(ke.promoteId?lt=ve.properties[ke.promoteId]:ke.generateId&&(lt=Oe||0),Je==="Point")Ui(Ye,gt);else if(Je==="MultiPoint")for(const wt of Ye)Ui(wt,gt);else if(Je==="LineString")xo(Ye,gt,st,!1);else if(Je==="MultiLineString"){if(ke.lineMetrics){for(const wt of Ye)gt=[],xo(wt,gt,st,!1),St.push(Mn(lt,"LineString",gt,ve.properties));return}Wa(Ye,gt,st,!1)}else if(Je==="Polygon")Wa(Ye,gt,st,!0);else{if(Je!=="MultiPolygon"){if(Je==="GeometryCollection"){for(const wt of ve.geometry.geometries)Vi(St,{id:lt,geometry:wt,properties:ve.properties},ke,Oe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const wt of Ye){const bt=[];Wa(wt,bt,st,!0),gt.push(bt)}}St.push(Mn(lt,Je,gt,ve.properties))}function Ui(St,ve){ve.push(Qs(St[0]),Eo(St[1]),0)}function xo(St,ve,ke,Oe){let Ye,Je,st=0;for(let lt=0;lt<St.length;lt++){const wt=Qs(St[lt][0]),bt=Eo(St[lt][1]);ve.push(wt,bt,0),lt>0&&(st+=Oe?(Ye*bt-wt*Je)/2:Math.sqrt(Math.pow(wt-Ye,2)+Math.pow(bt-Je,2))),Ye=wt,Je=bt}const gt=ve.length-3;ve[2]=1,Sr(ve,0,gt,ke),ve[gt+2]=1,ve.size=Math.abs(st),ve.start=0,ve.end=ve.size}function Wa(St,ve,ke,Oe){for(let Ye=0;Ye<St.length;Ye++){const Je=[];xo(St[Ye],Je,ke,Oe),ve.push(Je)}}function Qs(St){return St/360+.5}function Eo(St){const ve=Math.sin(St*Math.PI/180),ke=.5-.25*Math.log((1+ve)/(1-ve))/Math.PI;return ke<0?0:ke>1?1:ke}function ss(St,ve,ke,Oe,Ye,Je,st,gt){if(Oe/=ve,Je>=(ke/=ve)&&st<Oe)return St;if(st<ke||Je>=Oe)return null;const lt=[];for(const wt of St){const bt=wt.geometry;let Nt=wt.type;const Bt=Ye===0?wt.minX:wt.minY,ar=Ye===0?wt.maxX:wt.maxY;if(Bt>=ke&&ar<Oe){lt.push(wt);continue}if(ar<ke||Bt>=Oe)continue;let sr=[];if(Nt==="Point"||Nt==="MultiPoint")ac(bt,sr,ke,Oe,Ye);else if(Nt==="LineString")Il(bt,sr,ke,Oe,Ye,!1,gt.lineMetrics);else if(Nt==="MultiLineString")sc(bt,sr,ke,Oe,Ye,!1);else if(Nt==="Polygon")sc(bt,sr,ke,Oe,Ye,!0);else if(Nt==="MultiPolygon")for(const Nr of bt){const $r=[];sc(Nr,$r,ke,Oe,Ye,!0),$r.length&&sr.push($r)}if(sr.length){if(gt.lineMetrics&&Nt==="LineString"){for(const Nr of sr)lt.push(Mn(wt.id,Nt,Nr,wt.tags));continue}Nt!=="LineString"&&Nt!=="MultiLineString"||(sr.length===1?(Nt="LineString",sr=sr[0]):Nt="MultiLineString"),Nt!=="Point"&&Nt!=="MultiPoint"||(Nt=sr.length===3?"Point":"MultiPoint"),lt.push(Mn(wt.id,Nt,sr,wt.tags))}}return lt.length?lt:null}function ac(St,ve,ke,Oe,Ye){for(let Je=0;Je<St.length;Je+=3){const st=St[Je+Ye];st>=ke&&st<=Oe&&ln(ve,St[Je],St[Je+1],St[Je+2])}}function Il(St,ve,ke,Oe,Ye,Je,st){let gt=$s(St);const lt=Ye===0?os:qu;let wt,bt,Nt=St.start;for(let $r=0;$r<St.length-3;$r+=3){const Ur=St[$r],Vr=St[$r+1],On=St[$r+2],Hn=St[$r+3],Tn=St[$r+4],$n=Ye===0?Ur:Vr,Rn=Ye===0?Hn:Tn;let Oa=!1;st&&(wt=Math.sqrt(Math.pow(Ur-Hn,2)+Math.pow(Vr-Tn,2))),$n<ke?Rn>ke&&(bt=lt(gt,Ur,Vr,Hn,Tn,ke),st&&(gt.start=Nt+wt*bt)):$n>Oe?Rn<Oe&&(bt=lt(gt,Ur,Vr,Hn,Tn,Oe),st&&(gt.start=Nt+wt*bt)):ln(gt,Ur,Vr,On),Rn<ke&&$n>=ke&&(bt=lt(gt,Ur,Vr,Hn,Tn,ke),Oa=!0),Rn>Oe&&$n<=Oe&&(bt=lt(gt,Ur,Vr,Hn,Tn,Oe),Oa=!0),!Je&&Oa&&(st&&(gt.end=Nt+wt*bt),ve.push(gt),gt=$s(St)),st&&(Nt+=wt)}let Bt=St.length-3;const ar=St[Bt],sr=St[Bt+1],Nr=Ye===0?ar:sr;Nr>=ke&&Nr<=Oe&&ln(gt,ar,sr,St[Bt+2]),Bt=gt.length-3,Je&&Bt>=3&&(gt[Bt]!==gt[0]||gt[Bt+1]!==gt[1])&&ln(gt,gt[0],gt[1],gt[2]),gt.length&&ve.push(gt)}function $s(St){const ve=[];return ve.size=St.size,ve.start=St.start,ve.end=St.end,ve}function sc(St,ve,ke,Oe,Ye,Je){for(const st of St)Il(st,ve,ke,Oe,Ye,Je,!1)}function ln(St,ve,ke,Oe){St.push(ve,ke,Oe)}function os(St,ve,ke,Oe,Ye,Je){const st=(Je-ve)/(Oe-ve);return ln(St,Je,ke+(Ye-ke)*st,1),st}function qu(St,ve,ke,Oe,Ye,Je){const st=(Je-ke)/(Ye-ke);return ln(St,ve+(Oe-ve)*st,Je,1),st}function Ha(St,ve){const ke=[];for(let Oe=0;Oe<St.length;Oe++){const Ye=St[Oe],Je=Ye.type;let st;if(Je==="Point"||Je==="MultiPoint"||Je==="LineString")st=eo(Ye.geometry,ve);else if(Je==="MultiLineString"||Je==="Polygon"){st=[];for(const gt of Ye.geometry)st.push(eo(gt,ve))}else if(Je==="MultiPolygon"){st=[];for(const gt of Ye.geometry){const lt=[];for(const wt of gt)lt.push(eo(wt,ve));st.push(lt)}}ke.push(Mn(Ye.id,Je,st,Ye.tags))}return ke}function eo(St,ve){const ke=[];ke.size=St.size,St.start!==void 0&&(ke.start=St.start,ke.end=St.end);for(let Oe=0;Oe<St.length;Oe+=3)ke.push(St[Oe]+ve,St[Oe+1],St[Oe+2]);return ke}function Gn(St,ve){if(St.transformed)return St;const ke=1<<St.z,Oe=St.x,Ye=St.y;for(const Je of St.features){const st=Je.geometry,gt=Je.type;if(Je.geometry=[],gt===1)for(let lt=0;lt<st.length;lt+=2)Je.geometry.push(va(st[lt],st[lt+1],ve,ke,Oe,Ye));else for(let lt=0;lt<st.length;lt++){const wt=[];for(let bt=0;bt<st[lt].length;bt+=2)wt.push(va(st[lt][bt],st[lt][bt+1],ve,ke,Oe,Ye));Je.geometry.push(wt)}}return St.transformed=!0,St}function va(St,ve,ke,Oe,Ye,Je){return[Math.round(ke*(St*Oe-Ye)),Math.round(ke*(ve*Oe-Je))]}function Ea(St,ve,ke,Oe,Ye){const Je=ve===Ye.maxZoom?0:Ye.tolerance/((1<<ve)*Ye.extent),st={features:[],numPoints:0,numSimplified:0,numFeatures:St.length,source:null,x:ke,y:Oe,z:ve,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const gt of St)Es(st,gt,Je,Ye);return st}function Es(St,ve,ke,Oe){const Ye=ve.geometry,Je=ve.type,st=[];if(St.minX=Math.min(St.minX,ve.minX),St.minY=Math.min(St.minY,ve.minY),St.maxX=Math.max(St.maxX,ve.maxX),St.maxY=Math.max(St.maxY,ve.maxY),Je==="Point"||Je==="MultiPoint")for(let gt=0;gt<Ye.length;gt+=3)st.push(Ye[gt],Ye[gt+1]),St.numPoints++,St.numSimplified++;else if(Je==="LineString")Ll(st,Ye,St,ke,!1,!1);else if(Je==="MultiLineString"||Je==="Polygon")for(let gt=0;gt<Ye.length;gt++)Ll(st,Ye[gt],St,ke,Je==="Polygon",gt===0);else if(Je==="MultiPolygon")for(let gt=0;gt<Ye.length;gt++){const lt=Ye[gt];for(let wt=0;wt<lt.length;wt++)Ll(st,lt[wt],St,ke,!0,wt===0)}if(st.length){let gt=ve.tags||null;if(Je==="LineString"&&Oe.lineMetrics){gt={};for(const wt in ve.tags)gt[wt]=ve.tags[wt];gt.mapbox_clip_start=Ye.start/Ye.size,gt.mapbox_clip_end=Ye.end/Ye.size}const lt={geometry:st,type:Je==="Polygon"||Je==="MultiPolygon"?3:Je==="LineString"||Je==="MultiLineString"?2:1,tags:gt};ve.id!==null&&(lt.id=ve.id),St.features.push(lt)}}function Ll(St,ve,ke,Oe,Ye,Je){const st=Oe*Oe;if(Oe>0&&ve.size<(Ye?st:Oe))return void(ke.numPoints+=ve.length/3);const gt=[];for(let lt=0;lt<ve.length;lt+=3)(Oe===0||ve[lt+2]>st)&&(ke.numSimplified++,gt.push(ve[lt],ve[lt+1])),ke.numPoints++;Ye&&function(lt,wt){let bt=0;for(let Nt=0,Bt=lt.length,ar=Bt-2;Nt<Bt;ar=Nt,Nt+=2)bt+=(lt[Nt]-lt[ar])*(lt[Nt+1]+lt[ar+1]);if(bt>0===wt)for(let Nt=0,Bt=lt.length;Nt<Bt/2;Nt+=2){const ar=lt[Nt],sr=lt[Nt+1];lt[Nt]=lt[Bt-2-Nt],lt[Nt+1]=lt[Bt-1-Nt],lt[Bt-2-Nt]=ar,lt[Bt-1-Nt]=sr}}(gt,Je),St.push(gt)}const Ma={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class qs{constructor(ve,ke){const Oe=(ke=this.options=function(Je,st){for(const gt in st)Je[gt]=st[gt];return Je}(Object.create(Ma),ke)).debug;if(Oe&&console.time("preprocess data"),ke.maxZoom<0||ke.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ke.promoteId&&ke.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ye=function(Je,st){const gt=[];if(Je.type==="FeatureCollection")for(let lt=0;lt<Je.features.length;lt++)Vi(gt,Je.features[lt],st,lt);else Vi(gt,Je.type==="Feature"?Je:{geometry:Je},st);return gt}(ve,ke);this.tiles={},this.tileCoords=[],Oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ke.indexMaxZoom,ke.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ye=function(Je,st){const gt=st.buffer/st.extent;let lt=Je;const wt=ss(Je,1,-1-gt,gt,0,-1,2,st),bt=ss(Je,1,1-gt,2+gt,0,-1,2,st);return(wt||bt)&&(lt=ss(Je,1,-gt,1+gt,0,-1,2,st)||[],wt&&(lt=Ha(wt,1).concat(lt)),bt&&(lt=lt.concat(Ha(bt,-1)))),lt}(Ye,ke),Ye.length&&this.splitTile(Ye,0,0,0),Oe&&(Ye.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ve,ke,Oe,Ye,Je,st,gt){const lt=[ve,ke,Oe,Ye],wt=this.options,bt=wt.debug;for(;lt.length;){Ye=lt.pop(),Oe=lt.pop(),ke=lt.pop(),ve=lt.pop();const Nt=1<<ke,Bt=$i(ke,Oe,Ye);let ar=this.tiles[Bt];if(!ar&&(bt>1&&console.time("creation"),ar=this.tiles[Bt]=Ea(ve,ke,Oe,Ye,wt),this.tileCoords.push({z:ke,x:Oe,y:Ye}),bt)){bt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ke,Oe,Ye,ar.numFeatures,ar.numPoints,ar.numSimplified),console.timeEnd("creation"));const Oa=`z${ke}`;this.stats[Oa]=(this.stats[Oa]||0)+1,this.total++}if(ar.source=ve,Je==null){if(ke===wt.indexMaxZoom||ar.numPoints<=wt.indexMaxPoints)continue}else{if(ke===wt.maxZoom||ke===Je)continue;if(Je!=null){const Oa=Je-ke;if(Oe!==st>>Oa||Ye!==gt>>Oa)continue}}if(ar.source=null,ve.length===0)continue;bt>1&&console.time("clipping");const sr=.5*wt.buffer/wt.extent,Nr=.5-sr,$r=.5+sr,Ur=1+sr;let Vr=null,On=null,Hn=null,Tn=null,$n=ss(ve,Nt,Oe-sr,Oe+$r,0,ar.minX,ar.maxX,wt),Rn=ss(ve,Nt,Oe+Nr,Oe+Ur,0,ar.minX,ar.maxX,wt);ve=null,$n&&(Vr=ss($n,Nt,Ye-sr,Ye+$r,1,ar.minY,ar.maxY,wt),On=ss($n,Nt,Ye+Nr,Ye+Ur,1,ar.minY,ar.maxY,wt),$n=null),Rn&&(Hn=ss(Rn,Nt,Ye-sr,Ye+$r,1,ar.minY,ar.maxY,wt),Tn=ss(Rn,Nt,Ye+Nr,Ye+Ur,1,ar.minY,ar.maxY,wt),Rn=null),bt>1&&console.timeEnd("clipping"),lt.push(Vr||[],ke+1,2*Oe,2*Ye),lt.push(On||[],ke+1,2*Oe,2*Ye+1),lt.push(Hn||[],ke+1,2*Oe+1,2*Ye),lt.push(Tn||[],ke+1,2*Oe+1,2*Ye+1)}}getTile(ve,ke,Oe){ve=+ve,ke=+ke,Oe=+Oe;const Ye=this.options,{extent:Je,debug:st}=Ye;if(ve<0||ve>24)return null;const gt=1<<ve,lt=$i(ve,ke=ke+gt&gt-1,Oe);if(this.tiles[lt])return Gn(this.tiles[lt],Je);st>1&&console.log("drilling down to z%d-%d-%d",ve,ke,Oe);let wt,bt=ve,Nt=ke,Bt=Oe;for(;!wt&&bt>0;)bt--,Nt>>=1,Bt>>=1,wt=this.tiles[$i(bt,Nt,Bt)];return wt&&wt.source?(st>1&&(console.log("found parent tile z%d-%d-%d",bt,Nt,Bt),console.time("drilling down")),this.splitTile(wt.source,bt,Nt,Bt,ve,ke,Oe),st>1&&console.timeEnd("drilling down"),this.tiles[lt]?Gn(this.tiles[lt],Je):null):null}}function $i(St,ve,ke){return 32*((1<<St)*ke+ve)+St}function Ms(St,ve){const ke=St.tileID.canonical;if(!this._geoJSONIndex)return void ve(null,null);const Oe=this._geoJSONIndex.getTile(ke.z,ke.x,ke.y);if(!Oe)return void ve(null,null);const Ye=new Se(Oe.features);let Je=ze(Ye);Je.byteOffset===0&&Je.byteLength===Je.buffer.byteLength||(Je=new Uint8Array(Je)),ve(null,{vectorTile:Ye,rawData:Je.buffer})}class gs extends Ce{constructor(ve,ke,Oe,Ye,Je,st){super(ve,ke,Oe,Ye,Ms,st),Je&&(this.loadGeoJSON=Je),this._dynamicIndex=new Pe}loadData(ve,ke){const Oe=ve&&ve.request,Ye=Oe&&Oe.collectResourceTiming;this.loadGeoJSON(ve,(Je,st)=>{if(Je||!st)return ke(Je);if(typeof st!="object")return ke(new Error(`Input data given to '${ve.source}' is not a valid GeoJSON object.`));{try{if(ve.filter){const lt=i.U(ve.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(lt.result==="error")throw new Error(lt.value.map(wt=>`${wt.key}: ${wt.message}`).join(", "));st.features=st.features.filter(wt=>lt.value.evaluate({zoom:0},wt))}ve.dynamic?(st.type==="Feature"&&(st={type:"FeatureCollection",features:[st]}),ve.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(st.features,this.loaded),ve.cluster&&(st.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ve.cluster?new pi(function({superclusterOptions:lt,clusterProperties:wt}){if(!wt||!lt)return lt;const bt={},Nt={},Bt={accumulated:null,zoom:0},ar={properties:null},sr=Object.keys(wt);for(const Nr of sr){const[$r,Ur]=wt[Nr],Vr=i.U(Ur),On=i.U(typeof $r=="string"?[$r,["accumulated"],["get",Nr]]:$r);bt[Nr]=Vr.value,Nt[Nr]=On.value}return lt.map=Nr=>{ar.properties=Nr;const $r={};for(const Ur of sr)$r[Ur]=bt[Ur].evaluate(Bt,ar);return $r},lt.reduce=(Nr,$r)=>{ar.properties=$r;for(const Ur of sr)Bt.accumulated=Nr[Ur],Nr[Ur]=Nt[Ur].evaluate(Bt,ar)},lt}(ve)).load(st.features):ve.dynamic?this._dynamicIndex:function(lt,wt){return new qs(lt,wt)}(st,ve.geojsonVtOptions)}catch(lt){return ke(lt)}const gt={};if(Ye){const lt=x(Oe);lt&&(gt.resourceTiming={},gt.resourceTiming[ve.source]=JSON.parse(JSON.stringify(lt)))}ke(null,gt)}})}reloadTile(ve,ke){const Oe=this.loaded;return Oe&&Oe[ve.uid]?ve.partial?ke(null,void 0):super.reloadTile(ve,ke):this.loadTile(ve,ke)}loadGeoJSON(ve,ke){if(ve.request)i.n(ve.request,ke);else{if(typeof ve.data!="string")return ke(new Error(`Input data given to '${ve.source}' is not a valid GeoJSON object.`));try{return ke(null,JSON.parse(ve.data))}catch{return ke(new Error(`Input data given to '${ve.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ve,ke){try{ke(null,this._geoJSONIndex.getClusterExpansionZoom(ve.clusterId))}catch(Oe){ke(Oe)}}getClusterChildren(ve,ke){try{ke(null,this._geoJSONIndex.getChildren(ve.clusterId))}catch(Oe){ke(Oe)}}getClusterLeaves(ve,ke){try{ke(null,this._geoJSONIndex.getLeaves(ve.clusterId,ve.limit,ve.offset))}catch(Oe){ke(Oe)}}}class Gu{constructor(ve,ke){this.tileID=new i.aG(ve.tileID.overscaledZ,ve.tileID.wrap,ve.tileID.canonical.z,ve.tileID.canonical.x,ve.tileID.canonical.y),this.tileZoom=ve.tileZoom,this.uid=ve.uid,this.zoom=ve.zoom,this.canonical=ve.tileID.canonical,this.pixelRatio=ve.pixelRatio,this.tileSize=ve.tileSize,this.source=ve.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ve.projection,this.brightness=ke}parse(ve,ke,Oe,Ye){this.status="parsing";const Je=new i.aG(Oe.tileID.overscaledZ,Oe.tileID.wrap,Oe.tileID.canonical.z,Oe.tileID.canonical.x,Oe.tileID.canonical.y),st=[],gt=ke.familiesBySource[Oe.source],lt=new i.d$(Je,Oe.promoteId);return lt.bucketLayerIDs=[],lt.is3DTile=!0,i.ea(ve).then(wt=>{if(!wt)return Ye(new Error("Could not parse tile"));const bt=i.eb(wt,1/i.cc(Oe.tileID.canonical)),Nt=wt.json.extensionsUsed&&wt.json.extensionsUsed.includes("MAPBOX_mesh_features")||wt.json.asset.extras&&wt.json.asset.extras.MAPBOX_mesh_features,Bt=wt.json.extensionsUsed&&wt.json.extensionsUsed.includes("EXT_meshopt_compression"),ar=new i.a8(this.zoom,{brightness:this.brightness});for(const sr in gt)for(const Nr of gt[sr]){const $r=Nr[0];lt.bucketLayerIDs.push(Nr.map(Vr=>i.aC(Vr.id,Vr.scope))),$r.recalculate(ar,[]);const Ur=new i.ec(Nr,bt,Je,Nt,Bt,this.brightness,lt);Nt||(Ur.needsUpload=!0),st.push(Ur),Ur.evaluate($r)}this.status="done",Ye(null,{buckets:st,featureIndex:lt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(wt=>Ye(new Error(wt.message)))}}class Xi{constructor(ve,ke,Oe,Ye,Je,st){this.actor=ve,this.layerIndex=ke,this.availableImages=Oe,this.brightness=st,this.loading={},this.loaded={}}loadTile(ve,ke){const Oe=ve.uid,Ye=this.loading[Oe]=new Gu(ve,this.brightness);i.bi(ve.request,(Je,st)=>{const gt=!this.loading[Oe];return delete this.loading[Oe],gt||Je?(Ye.status="done",gt||(this.loaded[Oe]=Ye),ke(Je)):st&&st.byteLength!==0?void Ye.parse(st,this.layerIndex,ve,(lt,wt)=>{Ye.status="done",this.loaded=this.loaded||{},this.loaded[Oe]=Ye,lt||!wt?ke(lt):ke(null,wt)}):(Ye.status="done",this.loaded[Oe]=Ye,ke())})}reloadTile(ve,ke){const Oe=this.loaded,Ye=ve.uid;if(Oe&&Oe[Ye]){const Je=Oe[Ye];Je.projection=ve.projection,Je.brightness=ve.brightness;const st=(gt,lt)=>{Je.reloadCallback&&(delete Je.reloadCallback,this.loadTile(ve,ke)),ke(gt,lt)};Je.status==="parsing"?Je.reloadCallback=st:Je.status==="done"&&this.loadTile(ve,ke)}}abortTile(ve,ke){const Oe=ve.uid;this.loading[Oe]&&delete this.loading[Oe],ke()}removeTile(ve,ke){const Oe=this.loaded,Ye=ve.uid;Oe&&Oe[Ye]&&delete Oe[Ye],ke()}}class Ko{constructor(ve){this.self=ve,this.actor=new i.ed(ve,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new i.I,this.projections={},this.defaultProjection=i.bP({name:"mercator"}),this.workerSourceTypes={vector:Ce,geojson:gs,"batched-model":Xi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ke,Oe)=>{if(this.workerSourceTypes[ke])throw new Error(`Worker source with name "${ke}" already registered.`);this.workerSourceTypes[ke]=Oe},this.self.registerRTLTextPlugin=ke=>{if(i.ee.isParsed())throw new Error("RTL text plugin already registered.");i.ee.applyArabicShaping=ke.applyArabicShaping,i.ee.processBidirectionalText=ke.processBidirectionalText,i.ee.processStyledBidirectionalText=ke.processStyledBidirectionalText}}clearCaches(ve,ke,Oe){delete this.layerIndexes[ve],delete this.availableImages[ve],delete this.workerSources[ve],delete this.demWorkerSources[ve],delete this.rasterArrayWorkerSource,Oe()}checkIfReady(ve,ke,Oe){Oe()}setReferrer(ve,ke){this.referrer=ke}spriteLoaded(ve,{scope:ke,isLoaded:Oe}){if(this.isSpriteLoaded[ve]||(this.isSpriteLoaded[ve]={}),this.isSpriteLoaded[ve][ke]=Oe,this.workerSources[ve]&&this.workerSources[ve][ke])for(const Ye in this.workerSources[ve][ke]){const Je=this.workerSources[ve][ke][Ye];for(const st in Je){const gt=Je[st];gt instanceof Ce&&(gt.isSpriteLoaded=Oe,gt.fire(new i.z("isSpriteLoaded")))}}}setImages(ve,{scope:ke,images:Oe},Ye){if(this.availableImages[ve]||(this.availableImages[ve]={}),this.availableImages[ve][ke]=Oe,this.workerSources[ve]&&this.workerSources[ve][ke]){for(const Je in this.workerSources[ve][ke]){const st=this.workerSources[ve][ke][Je];for(const gt in st)st[gt].availableImages=Oe}Ye()}else Ye()}setProjection(ve,ke){this.projections[ve]=i.bP(ke)}setBrightness(ve,ke,Oe){this.brightness=ke,Oe()}setLayers(ve,ke,Oe){this.getLayerIndex(ve,ke.scope).replace(ke.layers,ke.options),Oe()}updateLayers(ve,ke,Oe){this.getLayerIndex(ve,ke.scope).update(ke.layers,ke.removedIds,ke.options),Oe()}loadTile(ve,ke,Oe){ke.projection=this.projections[ve]||this.defaultProjection,this.getWorkerSource(ve,ke.type,ke.source,ke.scope).loadTile(ke,Oe)}loadDEMTile(ve,ke,Oe){this.getDEMWorkerSource(ve,ke.source,ke.scope).loadTile(ke,Oe)}decodeRasterArray(ve,ke,Oe){this.getRasterArrayWorkerSource().decodeRasterArray(ke,Oe)}reloadTile(ve,ke,Oe){ke.projection=this.projections[ve]||this.defaultProjection,this.getWorkerSource(ve,ke.type,ke.source,ke.scope).reloadTile(ke,Oe)}abortTile(ve,ke,Oe){this.getWorkerSource(ve,ke.type,ke.source,ke.scope).abortTile(ke,Oe)}removeTile(ve,ke,Oe){this.getWorkerSource(ve,ke.type,ke.source,ke.scope).removeTile(ke,Oe)}removeSource(ve,ke,Oe){if(!(this.workerSources[ve]&&this.workerSources[ve][ke.scope]&&this.workerSources[ve][ke.scope][ke.type]&&this.workerSources[ve][ke.scope][ke.type][ke.source]))return;const Ye=this.workerSources[ve][ke.scope][ke.type][ke.source];delete this.workerSources[ve][ke.scope][ke.type][ke.source],Ye.removeSource!==void 0?Ye.removeSource(ke,Oe):Oe()}loadWorkerSource(ve,ke,Oe){try{this.self.importScripts(ke.url),Oe()}catch(Ye){Oe(Ye.toString())}}syncRTLPluginState(ve,ke,Oe){try{i.ee.setState(ke);const Ye=i.ee.getPluginURL();if(i.ee.isLoaded()&&!i.ee.isParsed()&&Ye!=null){this.self.importScripts(Ye);const Je=i.ee.isParsed();Oe(Je?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ye}`),Je)}}catch(Ye){Oe(Ye.toString())}}setDracoUrl(ve,ke){this.dracoUrl=ke}getAvailableImages(ve,ke){this.availableImages[ve]||(this.availableImages[ve]={});let Oe=this.availableImages[ve][ke];return Oe||(Oe=[]),Oe}getLayerIndex(ve,ke){this.layerIndexes[ve]||(this.layerIndexes[ve]={});let Oe=this.layerIndexes[ve][ke];return Oe||(Oe=this.layerIndexes[ve][ke]=new T,Oe.scope=ke),Oe}getWorkerSource(ve,ke,Oe,Ye){return this.workerSources[ve]||(this.workerSources[ve]={}),this.workerSources[ve][Ye]||(this.workerSources[ve][Ye]={}),this.workerSources[ve][Ye][ke]||(this.workerSources[ve][Ye][ke]={}),this.isSpriteLoaded[ve]||(this.isSpriteLoaded[ve]={}),this.workerSources[ve][Ye][ke][Oe]||(this.workerSources[ve][Ye][ke][Oe]=new this.workerSourceTypes[ke]({send:(Je,st,gt,lt,wt,bt)=>{this.actor.send(Je,st,gt,ve,wt,bt)},scheduler:this.actor.scheduler},this.getLayerIndex(ve,Ye),this.getAvailableImages(ve,Ye),this.isSpriteLoaded[ve][Ye],void 0,this.brightness)),this.workerSources[ve][Ye][ke][Oe]}rasterizeImages(ve,ke,Oe){const{imageTasks:Ye,scope:Je}=ke,st={};for(const gt in Ye){const{image:lt,imageIdWithOptions:wt}=Ye[gt];st[gt]=this.imageRasterizer.rasterize(wt,lt,Je,ve)}Oe(void 0,st)}removeRasterizedImages(ve,ke,Oe){const{imageIds:Ye,scope:Je}=ke;this.imageRasterizer.removeImagesFromCacheByIds(Ye,Je,ve),Oe()}getDEMWorkerSource(ve,ke,Oe){return this.demWorkerSources[ve]||(this.demWorkerSources[ve]={}),this.demWorkerSources[ve][Oe]||(this.demWorkerSources[ve][Oe]={}),this.demWorkerSources[ve][Oe][ke]||(this.demWorkerSources[ve][Oe][ke]=new Ne),this.demWorkerSources[ve][Oe][ke]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new me),this.rasterArrayWorkerSource}enforceCacheSizeLimit(ve,ke){i.ef(ke)}getWorkerPerformanceMetrics(ve,ke,Oe){Oe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ko(self)),Ko}),c(["./shared"],function(i){var x="3.10.0";const w={create:"create",load:"load",fullLoad:"fullLoad"},S={mark(g){performance.mark(g)},measure(g,l,d){performance.measure(g,l,d)}};function T(g){const l=g.name.split("?")[0];return i.a(l)&&l.includes("mapbox-gl.js")?"javascript":i.a(l)&&l.includes("mapbox-gl.css")?"css":i.b(l)?"fontRange":i.c(l)?"sprite":i.i(l)?"style":i.d(l)?"tilejson":"other"}var E,D={},U=function(){if(E)return D;function g(y){return!l(y)}function l(y){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var j,C,F=new Blob([""],{type:"text/javascript"}),W=URL.createObjectURL(F);try{C=new Worker(W),j=!0}catch{j=!1}return C&&C.terminate(),URL.revokeObjectURL(W),j}()?function(){var j=document.createElement("canvas");j.width=j.height=1;var C=j.getContext("2d");if(!C)return!1;var F=C.getImageData(0,0,1,1);return F&&F.width===j.width}()?(d[N=y&&y.failIfMajorPerformanceCaveat]===void 0&&(d[N]=function(j){var C,F=function(W){var Z=document.createElement("canvas"),Y=Object.create(g.webGLContextAttributes);return Y.failIfMajorPerformanceCaveat=W,Z.getContext("webgl2",Y)}(j);if(!F)return!1;try{C=F.createShader(F.VERTEX_SHADER)}catch{return!1}return!(!C||F.isContextLost())&&(F.shaderSource(C,"void main() {}"),F.compileShader(C),F.getShaderParameter(C,F.COMPILE_STATUS)===!0)}(N)),d[N]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var N}E=1,D.supported=g,D.notSupportedReason=l;var d={};return g.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},D}();function I(g,l,d){const y=document.createElement(g);return l!=null&&(y.className=l),d&&d.appendChild(y),y}function V(g,l,d){const y=document.createElementNS("http://www.w3.org/2000/svg",g);for(const N of Object.keys(l))y.setAttributeNS(null,N,String(l[N]));return d&&d.appendChild(y),y}const H=typeof document<"u"?document.documentElement&&document.documentElement.style:null,K=H&&H.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Q;function ae(){H&&K&&(Q=H[K],H[K]="none")}function ee(){H&&K&&(H[K]=Q)}function se(g){g.preventDefault(),g.stopPropagation(),window.removeEventListener("click",se,!0)}function ue(){window.addEventListener("click",se,!0),window.setTimeout(()=>{window.removeEventListener("click",se,!0)},0)}function he(g,l){const d=g.getBoundingClientRect();return me(g,d,l)}function Ce(g,l){const d=g.getBoundingClientRect(),y=[];for(let N=0;N<l.length;N++)y.push(me(g,d,l[N]));return y}function Ne(g){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&g.button===2&&g.ctrlKey?0:g.button}function me(g,l,d){const y=g.offsetWidth===l.width?1:g.offsetWidth/l.width;return new i.P((d.clientX-l.left)*y,(d.clientY-l.top)*y)}const be="01",pe="NO_ACCESS_TOKEN";class Se{constructor(l,d,y){this._transformRequestFn=l,this._customAccessToken=d,this._silenceAuthErrors=!!y,this._createSkuToken()}_createSkuToken(){const l=function(){let d="";for(let y=0;y<10;y++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",be,d].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=l.token,this._skuTokenExpiresAt=l.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(l,d){return this._transformRequestFn&&this._transformRequestFn(l,d)||{url:l}}normalizeStyleURL(l,d){if(!i.f(l))return l;const y=we(l);return y.params.push(`sdk=js-${x}`),y.path=`/styles/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||d)}normalizeGlyphsURL(l,d){if(!i.f(l))return l;const y=we(l);return y.path=`/fonts/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||d)}normalizeModelURL(l,d){if(!i.f(l))return l;const y=we(l);return y.path=`/models/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||d)}normalizeSourceURL(l,d,y,N){if(!i.f(l))return l;const j=we(l);return j.path=`/v4/${j.authority}.json`,j.params.push("secure"),y&&j.params.push(`language=${y}`),N&&j.params.push(`worldview=${N}`),this._makeAPIURL(j,this._customAccessToken||d)}normalizeIconsetURL(l,d){const y=we(l);return i.f(l)?(y.path=`/styles/v1${y.path}/iconset.pbf`,this._makeAPIURL(y,this._customAccessToken||d)):Pe(y)}normalizeSpriteURL(l,d,y,N){const j=we(l);return i.f(l)?(j.path=`/styles/v1${j.path}/sprite${d}${y}`,this._makeAPIURL(j,this._customAccessToken||N)):(j.path+=`${d}${y}`,Pe(j))}normalizeTileURL(l,d,y){if(this._isSkuTokenExpired()&&this._createSkuToken(),l&&!i.f(l))return l;const N=we(l);N.path=N.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${d||y&&N.authority!=="raster"&&y===512?"@2x":""}${i.m.supported?".webp":"$1"}`),N.authority==="raster"?N.path=`/${i.e.RASTER_URL_PREFIX}${N.path}`:N.authority==="rasterarrays"?N.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${N.path}`:N.authority==="3dtiles"?N.path=`/${i.e.TILES3D_URL_PREFIX}${N.path}`:(N.path=N.path.replace(/^.+\/v4\//,"/"),N.path=`/${i.e.TILE_URL_VERSION}${N.path}`);const j=this._customAccessToken||function(C){for(const F of C){const W=F.match(/^access_token=(.*)$/);if(W)return W[1]}return null}(N.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&j&&this._skuToken&&N.params.push(`sku=${this._skuToken}`),this._makeAPIURL(N,j)}canonicalizeTileURL(l,d){const y=we(l);if(!y.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!y.path.match(/\.[\w]+$/))return l;let N="mapbox://";y.path.match(/^\/raster\/v1\//)?N+=`raster/${y.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:y.path.match(/^\/rasterarrays\/v1\//)?N+=`rasterarrays/${y.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:N+=`tiles/${y.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let j=y.params;return d&&(j=j.filter(C=>!C.match(/^access_token=/))),j.length&&(N+=`?${j.join("&")}`),N}canonicalizeTileset(l,d){const y=!!d&&i.f(d),N=[];for(const j of l.tiles||[])i.h(j)?N.push(this.canonicalizeTileURL(j,y)):N.push(j);return N}_makeAPIURL(l,d){const y="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",N=we(i.e.API_URL);if(l.protocol=N.protocol,l.authority=N.authority,l.protocol==="http"){const j=l.params.indexOf("secure");j>=0&&l.params.splice(j,1)}if(N.path!=="/"&&(l.path=`${N.path}${l.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return Pe(l);if(d=d||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!d)throw new Error(`An API access token is required to use Mapbox GL. ${y}`);if(d[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${y}`)}return l.params=l.params.filter(j=>j.indexOf("access_token")===-1),l.params.push(`access_token=${d||""}`),Pe(l)}}const Ee=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function we(g){const l=g.match(Ee);if(!l)throw new Error("Unable to parse URL object");return{protocol:l[1],authority:l[2],path:l[3]||"/",params:l[4]?l[4].split("&"):[]}}function Pe(g){const l=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${l}`}const Me="mapbox.eventData";function Be(g){if(!g)return null;const l=g.split(".");if(!l||l.length!==3)return null;try{return JSON.parse(i.j(l[1]))}catch{return null}}class Ge{constructor(l){this.type=l,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(l){const d=Be(i.e.ACCESS_TOKEN);let y="";return y=d&&d.u?i.k(d.u):i.e.ACCESS_TOKEN||"",l?`${Me}.${l}:${y}`:`${Me}:${y}`}fetchEventData(){const l=i.s("localStorage"),d=this.getStorageKey(),y=this.getStorageKey("uuid");if(l)try{const N=localStorage.getItem(d);N&&(this.eventData=JSON.parse(N));const j=localStorage.getItem(y);j&&(this.anonId=j)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const l=i.s("localStorage"),d=this.getStorageKey(),y=this.getStorageKey("uuid"),N=this.anonId;if(l&&N)try{localStorage.setItem(y,N),Object.keys(this.eventData).length>=1&&localStorage.setItem(d,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(l){}postEvent(l,d,y,N){if(!i.e.EVENTS_URL)return;const j=we(i.e.EVENTS_URL);j.params.push(`access_token=${N||i.e.ACCESS_TOKEN||""}`);const C={event:this.type,created:new Date(l).toISOString()},F=d?i.l(C,d):C,W={url:Pe(j),headers:{"Content-Type":"text/plain"},body:JSON.stringify([F])};this.pendingRequest=i.p(W,Z=>{this.pendingRequest=null,y(Z),this.saveEventData(),this.processRequests(N)})}queueRequest(l,d){this.queue.push(l),this.processRequests(d)}}const We=new class extends Ge{constructor(g){super("appUserTurnstile"),this._customAccessToken=g}postTurnstileEvent(g,l){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(g)&&g.some(d=>i.f(d)||i.h(d))&&this.queueRequest(Date.now(),l)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const l=Be(i.e.ACCESS_TOKEN),d=l?l.u:i.e.ACCESS_TOKEN;let y=d!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),y=!0);const N=this.queue.shift();if(this.eventData.lastSuccess){const j=new Date(this.eventData.lastSuccess),C=new Date(N),F=(N-this.eventData.lastSuccess)/864e5;y=y||F>=1||F<-1||j.getDate()!==C.getDate()}else y=!0;y?this.postEvent(N,{sdkIdentifier:"mapbox-gl-js",sdkVersion:x,skuId:be,"enabled.telemetry":!1,userId:this.anonId},j=>{j||(this.eventData.lastSuccess=N,this.eventData.tokenU=d)},g):this.processRequests()}},tt=We.postTurnstileEvent.bind(We),nt=new class extends Ge{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(g,l,d,y){this.skuToken=l,this.errorCb=y,i.e.EVENTS_URL&&(d||i.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},d):this.errorCb(new Error(pe)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:l,timestamp:d}=this.queue.shift();l&&this.success[l]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:x,skuId:be,skuToken:this.skuToken,userId:this.anonId},y=>{y?this.errorCb(y):l&&(this.success[l]=!0)},g))}remove(){this.errorCb=null}},Dt=nt.postMapLoadEvent.bind(nt),nr=new class extends Ge{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(g){let l=this.mapInstanceIdMap.get(g);return l||(l=i.u(),this.mapInstanceIdMap.set(g,l)),l}getEventId(g){const l=this.eventIdPerMapInstanceMap.get(g)||0;return this.eventIdPerMapInstanceMap.set(g,l+1),l}postStyleLoadEvent(g,l){const{map:d,style:y,importedStyles:N}=l;if(!i.e.EVENTS_URL||!g&&!i.e.ACCESS_TOKEN)return;const j=this.getMapInstanceId(d),C={mapInstanceId:j,eventId:this.getEventId(j),style:y};N.length&&(C.importedStyles=N),this.queueRequest({timestamp:Date.now(),payload:C},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:l,payload:d}=this.queue.shift();this.postEvent(l,d,()=>{},g)}},ir=nr.postStyleLoadEvent.bind(nr),rr=new class extends Ge{constructor(){super("gljs.performance")}postPerformanceEvent(g,l){i.e.EVENTS_URL&&(g||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:l},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:l,performanceData:d}=this.queue.shift(),y=function(N){const j=performance.getEntriesByType("resource"),C=performance.getEntriesByType("mark"),F=function(oe){const _e={};if(oe){for(const ge in oe)if(ge!=="other")for(const Te of oe[ge]){const Ae=`${ge}ResolveRangeMin`,Re=`${ge}ResolveRangeMax`,qe=`${ge}RequestCount`,Ue=`${ge}RequestCachedCount`;_e[Ae]=Math.min(_e[Ae]||1/0,Te.startTime),_e[Re]=Math.max(_e[Re]||-1/0,Te.responseEnd);const Qe=Ke=>{_e[Ke]===void 0&&(_e[Ke]=0),++_e[Ke]};Te.transferSize!==void 0&&Te.transferSize===0&&Qe(Ue),Qe(qe)}}return _e}(function(oe,_e){const ge={};if(oe)for(const Te of oe){const Ae=_e(Te);ge[Ae]===void 0&&(ge[Ae]=[]),ge[Ae].push(Te)}return ge}(j,T)),W=window.devicePixelRatio,Z=navigator.connection||navigator.mozConnection||navigator.webkitConnection,Y=Z?Z.effectiveType:void 0,re={counters:[],metadata:[],attributes:[]},ne=(oe,_e,ge)=>{ge!=null&&oe.push({name:_e,value:ge.toString()})};for(const oe in F)ne(re.counters,oe,F[oe]);if(N.interactionRange[0]!==1/0&&N.interactionRange[1]!==-1/0&&(ne(re.counters,"interactionRangeMin",N.interactionRange[0]),ne(re.counters,"interactionRangeMax",N.interactionRange[1])),C)for(const oe of Object.keys(w)){const _e=w[oe],ge=C.find(Te=>Te.name===_e);ge&&ne(re.counters,_e,ge.startTime)}return ne(re.counters,"visibilityHidden",N.visibilityHidden),ne(re.attributes,"style",function(oe){if(oe)for(const _e of oe){const ge=_e.name.split("?")[0];if(i.i(ge)){const Te=ge.split("/").slice(-2);if(Te.length===2)return`mapbox://styles/${Te[0]}/${Te[1]}`}}}(j)),ne(re.attributes,"terrainEnabled",N.terrainEnabled?"true":"false"),ne(re.attributes,"fogEnabled",N.fogEnabled?"true":"false"),ne(re.attributes,"projection",N.projection),ne(re.attributes,"zoom",N.zoom),ne(re.metadata,"devicePixelRatio",W),ne(re.metadata,"connectionEffectiveType",Y),ne(re.metadata,"navigatorUserAgent",navigator.userAgent),ne(re.metadata,"screenWidth",window.screen.width),ne(re.metadata,"screenHeight",window.screen.height),ne(re.metadata,"windowWidth",window.innerWidth),ne(re.metadata,"windowHeight",window.innerHeight),ne(re.metadata,"mapWidth",N.width/W),ne(re.metadata,"mapHeight",N.height/W),ne(re.metadata,"webglRenderer",N.renderer),ne(re.metadata,"webglVendor",N.vendor),ne(re.metadata,"sdkVersion",x),ne(re.metadata,"sdkIdentifier","mapbox-gl-js"),re}(d);for(const N of y.metadata);for(const N of y.counters);for(const N of y.attributes);this.postEvent(l,y,()=>{},g)}},or=rr.postPerformanceEvent.bind(rr),Ft=new class extends Ge{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(g,l,d,y){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const N=we(i.e.API_URL+i.e.SESSION_PATH);N.params.push(`sku=${l||""}`),N.params.push(`access_token=${y||i.e.ACCESS_TOKEN||""}`);const j={url:Pe(N),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(j,C=>{this.pendingRequest=null,d(C),this.saveEventData(),this.processRequests(y)})}getSessionAPI(g,l,d,y){this.skuToken=l,this.errorCb=y,i.e.SESSION_PATH&&i.e.API_URL&&(d||i.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},d):this.errorCb(new Error(pe)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:l,timestamp:d}=this.queue.shift();l&&this.success[l]||this.getSession(d,this.skuToken,y=>{y?this.errorCb(y):l&&(this.success[l]=!0)},g)}remove(){this.errorCb=null}},ze=Ft.getSessionAPI.bind(Ft),Pr=new Set;function Kt(g,l){l?Pr.add(g):Pr.delete(g)}class on{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(l,d){this._updatedSourceCaches[l]=d,this.setDirty()}discardSourceCacheUpdate(l){delete this._updatedSourceCaches[l]}updateLayer(l){const d=l.scope;this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._updatedLayers[d].add(l.id),this.setDirty()}removeLayer(l){const d=l.scope;this._removedLayers[d]=this._removedLayers[d]||{},this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._removedLayers[d][l.id]=l,this._updatedLayers[d].delete(l.id),this._updatedPaintProps.delete(l.fqid),this.setDirty()}getRemovedLayer(l){return this._removedLayers[l.scope]?this._removedLayers[l.scope][l.id]:null}discardLayerRemoval(l){this._removedLayers[l.scope]&&delete this._removedLayers[l.scope][l.id]}getLayerUpdatesByScope(){const l={};for(const d in this._updatedLayers)l[d]=l[d]||{},l[d].updatedIds=Array.from(this._updatedLayers[d].values());for(const d in this._removedLayers)l[d]=l[d]||{},l[d].removedIds=Object.keys(this._removedLayers[d]);return l}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(l){this._updatedPaintProps.add(l.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(l){this._updatedImages.add(l),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function Rt(g){const{userImage:l}=g;return!!(l&&l.render&&l.render())&&(g.data.replace(new Uint8Array(l.data.buffer)),!0)}class En extends i.E{constructor(l){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=l,l!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.I),this._imageRasterizer}createScope(l){this.images[l]={},this.loaded[l]=!1,this.updatedImages[l]={},this.patterns[l]={},this.callbackDispatchedThisFrame[l]={},this.atlasImage[l]=new i.r({width:1,height:1})}isLoaded(){for(const l in this.loaded)if(!this.loaded[l])return!1;return!0}setLoaded(l,d){if(this.loaded[d]!==l&&(this.loaded[d]=l,l)){for(const{ids:y,callback:N}of this.requestors)this._notify(y,d,N);this.requestors=[]}}hasImage(l,d){return!!this.getImage(l,d)}getImage(l,d){return this.images[d][l]}addImage(l,d,y){this._validate(l,y)&&(this.images[d][l]=y)}_validate(l,d){let y=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new i.y(new Error(`Image "${l}" has invalid "stretchX" value`))),y=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new i.y(new Error(`Image "${l}" has invalid "stretchY" value`))),y=!1),this._validateContent(d.content,d)||(this.fire(new i.y(new Error(`Image "${l}" has invalid "content" value`))),y=!1),y}_validateStretch(l,d){if(!l)return!0;let y=0;for(const N of l){if(N[0]<y||N[1]<N[0]||d<N[1])return!1;y=N[1]}return!0}_validateContent(l,d){return l?l.length!==4||!d.usvg&&(l[0]<0||d.data.width<l[0]||l[1]<0||d.data.height<l[1]||l[2]<0||d.data.width<l[2]||l[3]<0||d.data.height<l[3])?!1:!(l[2]<l[0]||l[3]<l[1]):!0}updateImage(l,d,y){y.version=this.images[d][l].version+1,this.images[d][l]=y,this.updatedImages[d][l]=!0,this.removeFromImageRasterizerCache(l,d)}removeFromImageRasterizerCache(l,d){this.spriteFormat!=="raster"&&(i.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[l],scope:d}):this.imageRasterizer.removeImagesFromCacheByIds([l],d))}removeImage(l,d){const y=this.images[d][l];delete this.images[d][l],delete this.patterns[d][l],this.removeFromImageRasterizerCache(l,d),y.userImage&&y.userImage.onRemove&&y.userImage.onRemove()}listImages(l){return Object.keys(this.images[l])}getImages(l,d,y){let N=!0;const j=!!this.loaded[d];if(!j)for(const C of l)this.images[d][C]||(N=!1);j||N?this._notify(l,d,y):this.requestors.push({ids:l,scope:d,callback:y})}rasterizeImages({scope:l,imageTasks:d},y){const N={};for(const j in d){const C=d[j],F=this.getImage(C.id,l);F&&(N[j]={image:F,imageIdWithOptions:C})}i.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:N,scope:l},y):this.rasterizeImagesInMainThread({imageTasks:N,scope:l},y)}rasterizeImagesInMainThread(l,d){const{imageTasks:y,scope:N}=l,j={};for(const C in y){const{image:F,imageIdWithOptions:W}=y[C];j[C]=this.imageRasterizer.rasterize(W,F,N,"")}d(void 0,j)}getUpdatedImages(l){return this.updatedImages[l]}_notify(l,d,y){const N={};for(const j of l){this.images[d][j]||this.fire(new i.z("styleimagemissing",{id:j}));const C=this.images[d][j];C?N[j]={data:C.usvg?null:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,usvg:C.usvg,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:i.w(`Image "${j}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}y(null,N)}getPixelSize(l){const{width:d,height:y}=this.atlasImage[l];return{width:d,height:y}}getPattern(l,d,y){const N=this.patterns[d][l],j=this.getImage(l,d);if(!j)return null;if(N&&N.position.version===j.version)return N.position;if(N)N.position.version=j.version;else{j.usvg&&!j.data&&(j.data=this.imageRasterizer.rasterize(i.A.from(l).getPrimary(),j,d,""));const C={w:j.data.width+2*i.B,h:j.data.height+2*i.B,x:0,y:0},F=new i.C(C,j,i.B);this.patterns[d][l]={bin:C,position:F}}return this._updatePatternAtlas(d,y),this.patterns[d][l].position}bind(l,d){const y=l.gl;let N=this.atlasTexture[d];N?this.dirty&&(N.update(this.atlasImage[d]),this.dirty=!1):(N=new i.T(l,this.atlasImage[d],y.RGBA8),this.atlasTexture[d]=N),N.bind(y.LINEAR,y.CLAMP_TO_EDGE)}_updatePatternAtlas(l,d){const y=[];for(const F in this.patterns[l])y.push(this.patterns[l][F].bin);const{w:N,h:j}=i.F(y),C=this.atlasImage[l];C.resize({width:N||1,height:j||1});for(const F in this.patterns[l]){const{bin:W,position:Z}=this.patterns[l][F];let Y=Z.padding;const re=W.x+Y,ne=W.y+Y,oe=this.images[l][F].data,_e=oe.width,ge=oe.height;Y=Y>1?Y-1:Y,i.r.copy(oe,C,{x:0,y:0},{x:re,y:ne},{width:_e,height:ge},d),i.r.copy(oe,C,{x:0,y:ge-Y},{x:re,y:ne-Y},{width:_e,height:Y},d),i.r.copy(oe,C,{x:0,y:0},{x:re,y:ne+ge},{width:_e,height:Y},d),i.r.copy(oe,C,{x:_e-Y,y:0},{x:re-Y,y:ne},{width:Y,height:ge},d),i.r.copy(oe,C,{x:0,y:0},{x:re+_e,y:ne},{width:Y,height:ge},d),i.r.copy(oe,C,{x:_e-Y,y:ge-Y},{x:re-Y,y:ne-Y},{width:Y,height:Y},d),i.r.copy(oe,C,{x:0,y:ge-Y},{x:re+_e,y:ne-Y},{width:Y,height:Y},d),i.r.copy(oe,C,{x:0,y:0},{x:re+_e,y:ne+ge},{width:Y,height:Y},d),i.r.copy(oe,C,{x:_e-Y,y:0},{x:re-Y,y:ne+ge},{width:Y,height:Y},d)}this.dirty=!0}beginFrame(){for(const l in this.images)this.callbackDispatchedThisFrame[l]={}}dispatchRenderCallbacks(l,d){for(const y of l){if(this.callbackDispatchedThisFrame[d][y])continue;this.callbackDispatchedThisFrame[d][y]=!0;const N=this.images[d][y];Rt(N)&&this.updateImage(y,d,N)}}}function Vn(g){const l=g.key,d=g.value,y=g.valueSpec||{},N=g.objectElementValidators||{},j=g.style,C=g.styleSpec;let F=[];const W=i.H(d);if(W!=="object")return[new i.V(l,d,`object expected, ${W} found`)];for(const Z in d){const Y=Z.split(".")[0];let re;N[Y]?re=N[Y]:y[Y]?re=ln:N["*"]?re=N["*"]:y["*"]&&(re=ln),re?F=F.concat(re({key:(l&&`${l}.`)+Z,value:d[Z],valueSpec:y[Y]||y["*"],style:j,styleSpec:C,object:d,objectKey:Z},d)):F.push(new i.G(l,d[Z],`unknown property "${Z}"`))}for(const Z in y)N[Z]||y[Z].required&&y[Z].default===void 0&&d[Z]===void 0&&F.push(new i.V(l,d,`missing required property "${Z}"`));return F}function pi(g){const l=g.value,d=g.valueSpec,y=g.style,N=g.styleSpec,j=g.key,C=g.arrayElementValidator||ln;if(i.H(l)!=="array")return[new i.V(j,l,`array expected, ${i.H(l)} found`)];if(d.length&&l.length!==d.length)return[new i.V(j,l,`array length ${d.length} expected, length ${l.length} found`)];if(d["min-length"]&&l.length<d["min-length"])return[new i.V(j,l,`array length at least ${d["min-length"]} expected, length ${l.length} found`)];let F={type:d.value,values:d.values,minimum:d.minimum,maximum:d.maximum,function:void 0};N.$version<7&&(F.function=d.function),i.H(d.value)==="object"&&(F=d.value);let W=[];for(let Z=0;Z<l.length;Z++)W=W.concat(C({array:l,arrayIndex:Z,value:l[Z],valueSpec:F,style:y,styleSpec:N,key:`${j}[${Z}]`},!0));return W}function dt(g){const l=g.key,d=g.value,y=g.valueSpec;let N=i.H(d);if(N==="number"&&d!=d&&(N="NaN"),N!=="number")return[new i.V(l,d,`number expected, ${N} found`)];if("minimum"in y){let j=y.minimum;if(i.H(y.minimum)==="array"&&(j=y.minimum[g.arrayIndex]),d<j)return[new i.V(l,d,`${d} is less than the minimum value ${j}`)]}if("maximum"in y){let j=y.maximum;if(i.H(y.maximum)==="array"&&(j=y.maximum[g.arrayIndex]),d>j)return[new i.V(l,d,`${d} is greater than the maximum value ${j}`)]}return[]}function Ot(g){const l=g.valueSpec,d=i.K(g.value.type);let y,N,j,C={};const F=d!=="categorical"&&g.value.property===void 0,W=!F,Z=i.H(g.value.stops)==="array"&&i.H(g.value.stops[0])==="array"&&i.H(g.value.stops[0][0])==="object",Y=Vn({key:g.key,value:g.value,valueSpec:g.styleSpec.function,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{stops:function(oe){if(d==="identity")return[new i.V(oe.key,oe.value,'identity function may not have a "stops" property')];let _e=[];const ge=oe.value;return _e=_e.concat(pi({key:oe.key,value:ge,valueSpec:oe.valueSpec,style:oe.style,styleSpec:oe.styleSpec,arrayElementValidator:re})),i.H(ge)==="array"&&ge.length===0&&_e.push(new i.V(oe.key,ge,"array must have at least one stop")),_e},default:function(oe){return ln({key:oe.key,value:oe.value,valueSpec:l,style:oe.style,styleSpec:oe.styleSpec})}}});return d==="identity"&&F&&Y.push(new i.V(g.key,g.value,'missing required property "property"')),d==="identity"||g.value.stops||Y.push(new i.V(g.key,g.value,'missing required property "stops"')),d==="exponential"&&g.valueSpec.expression&&!i.L(g.valueSpec)&&Y.push(new i.V(g.key,g.value,"exponential functions not supported")),g.styleSpec.$version>=8&&(W&&!i.M(g.valueSpec)?Y.push(new i.V(g.key,g.value,"property functions not supported")):F&&!i.N(g.valueSpec)&&Y.push(new i.V(g.key,g.value,"zoom functions not supported"))),d!=="categorical"&&!Z||g.value.property!==void 0||Y.push(new i.V(g.key,g.value,'"property" property is required')),Y;function re(oe){let _e=[];const ge=oe.value,Te=oe.key;if(i.H(ge)!=="array")return[new i.V(Te,ge,`array expected, ${i.H(ge)} found`)];if(ge.length!==2)return[new i.V(Te,ge,`array length 2 expected, length ${ge.length} found`)];if(Z){if(i.H(ge[0])!=="object")return[new i.V(Te,ge,`object expected, ${i.H(ge[0])} found`)];if(ge[0].zoom===void 0)return[new i.V(Te,ge,"object stop key must have zoom")];if(ge[0].value===void 0)return[new i.V(Te,ge,"object stop key must have value")];const Ae=i.K(ge[0].zoom);if(typeof Ae!="number")return[new i.V(Te,ge[0].zoom,"stop zoom values must be numbers")];if(j&&j>Ae)return[new i.V(Te,ge[0].zoom,"stop zoom values must appear in ascending order")];Ae!==j&&(j=Ae,N=void 0,C={}),_e=_e.concat(Vn({key:`${Te}[0]`,value:ge[0],valueSpec:{zoom:{}},style:oe.style,styleSpec:oe.styleSpec,objectElementValidators:{zoom:dt,value:ne}}))}else _e=_e.concat(ne({key:`${Te}[0]`,value:ge[0],style:oe.style,styleSpec:oe.styleSpec},ge));return i.O(i.Q(ge[1]))?_e.concat([new i.V(`${Te}[1]`,ge[1],"expressions are not allowed in function stops.")]):_e.concat(ln({key:`${Te}[1]`,value:ge[1],valueSpec:l,style:oe.style,styleSpec:oe.styleSpec}))}function ne(oe,_e){const ge=i.H(oe.value),Te=i.K(oe.value),Ae=oe.value!==null?oe.value:_e;if(y){if(ge!==y)return[new i.V(oe.key,Ae,`${ge} stop domain type must match previous stop domain type ${y}`)]}else y=ge;if(ge!=="number"&&ge!=="string"&&ge!=="boolean"&&typeof Te!="number"&&typeof Te!="string"&&typeof Te!="boolean")return[new i.V(oe.key,Ae,"stop domain value must be a number, string, or boolean")];if(ge!=="number"&&d!=="categorical"){let Re=`number expected, ${ge} found`;return i.M(l)&&d===void 0&&(Re+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(oe.key,Ae,Re)]}return d!=="categorical"||ge!=="number"||typeof Te=="number"&&isFinite(Te)&&Math.floor(Te)===Te?d!=="categorical"&&ge==="number"&&typeof Te=="number"&&typeof N=="number"&&N!==void 0&&Te<N?[new i.V(oe.key,Ae,"stop domain values must appear in ascending order")]:(N=Te,d==="categorical"&&Te in C?[new i.V(oe.key,Ae,"stop domain values must be unique")]:(C[Te]=!0,[])):[new i.V(oe.key,Ae,`integer expected, found ${String(Te)}`)]}}function Zt(g){const l=(g.expressionContext==="property"?i.S:i.U)(i.Q(g.value),g.valueSpec);if(l.result==="error")return l.value.map(y=>new i.V(`${g.key}${y.key}`,g.value,y.message));const d=l.value.expression||l.value._styleExpression.expression;if(g.expressionContext==="property"&&g.propertyKey==="text-font"&&!d.outputDefined())return[new i.V(g.key,g.value,`Invalid data expression for "${g.propertyKey}". Output values must be contained as literals within the expression.`)];if(g.expressionContext==="property"&&g.propertyType==="layout"&&!i.W(d))return[new i.V(g.key,g.value,'"feature-state" data expressions are not supported with layout properties.')];if(g.expressionContext==="filter")return Cr(d,g);if(g.expressionContext&&g.expressionContext.indexOf("cluster")===0){if(!i.X(d,["zoom","feature-state"]))return[new i.V(g.key,g.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(g.expressionContext==="cluster-initial"&&!i.Y(d))return[new i.V(g.key,g.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Cr(g,l){const d=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(l.valueSpec&&l.valueSpec.expression)for(const N of l.valueSpec.expression.parameters)d.delete(N);if(d.size===0)return[];const y=[];return g instanceof i.Z&&d.has(g.name)?[new i.V(l.key,l.value,`["${g.name}"] expression is not supported in a filter for a ${l.object.type} layer with id: ${l.object.id}`)]:(g.eachChild(N=>{y.push(...Cr(N,l))}),y)}function vr(g){const l=g.key,d=g.value,y=g.valueSpec,N=[];return Array.isArray(y.values)?y.values.indexOf(i.K(d))===-1&&N.push(new i.V(l,d,`expected one of [${y.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(y.values).indexOf(i.K(d))===-1&&N.push(new i.V(l,d,`expected one of [${Object.keys(y.values).join(", ")}], ${JSON.stringify(d)} found`)),N}function Sr(g){return i.$(i.Q(g.value))?Zt(i.J({},g,{expressionContext:"filter",valueSpec:g.styleSpec[`filter_${g.layerType||"fill"}`]})):pr(g)}function pr(g){const l=g.value,d=g.key;if(i.H(l)!=="array")return[new i.V(d,l,`array expected, ${i.H(l)} found`)];const y=g.styleSpec;let N,j=[];if(l.length<1)return[new i.V(d,l,"filter array must have at least 1 element")];switch(j=j.concat(vr({key:`${d}[0]`,value:l[0],valueSpec:y.filter_operator,style:g.style,styleSpec:g.styleSpec})),i.K(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&i.K(l[1])==="$type"&&j.push(new i.V(d,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&j.push(new i.V(d,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(N=i.H(l[1]),N!=="string"&&j.push(new i.V(`${d}[1]`,l[1],`string expected, ${N} found`)));for(let C=2;C<l.length;C++)N=i.H(l[C]),i.K(l[1])==="$type"?j=j.concat(vr({key:`${d}[${C}]`,value:l[C],valueSpec:y.geometry_type,style:g.style,styleSpec:g.styleSpec})):N!=="string"&&N!=="number"&&N!=="boolean"&&j.push(new i.V(`${d}[${C}]`,l[C],`string, number, or boolean expected, ${N} found`));break;case"any":case"all":case"none":for(let C=1;C<l.length;C++)j=j.concat(pr({key:`${d}[${C}]`,value:l[C],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":N=i.H(l[1]),l.length!==2?j.push(new i.V(d,l,`filter array for "${l[0]}" operator must have 2 elements`)):N!=="string"&&j.push(new i.V(`${d}[1]`,l[1],`string expected, ${N} found`))}return j}function Mn(g,l){const d=g.key,y=g.style,N=g.layer,j=g.styleSpec,C=g.value,F=g.objectKey,W=j[`${l}_${g.layerType}`];if(!W)return[];const Z=F.match(/^(.*)-use-theme$/);if(l==="paint"&&Z&&W[Z[1]])return i.O(C)?[].concat(ln({key:g.key,value:C,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:y,styleSpec:j,expressionContext:"property",propertyType:l,propertyKey:F})):ln({key:d,value:C,valueSpec:{type:"string"},style:y,styleSpec:j});const Y=F.match(/^(.*)-transition$/);if(l==="paint"&&Y&&W[Y[1]]&&W[Y[1]].transition)return ln({key:d,value:C,valueSpec:j.transition,style:y,styleSpec:j});const re=g.valueSpec||W[F];if(!re)return[new i.G(d,C,`unknown property "${F}"`)];let ne;if(i.H(C)==="string"&&i.M(re)&&!re.tokens&&(ne=/^{([^}]+)}$/.exec(C))){const _e=`\`{ "type": "identity", "property": ${ne?JSON.stringify(ne[1]):'"_"'} }\``;return[new i.V(d,C,`"${F}" does not support interpolation syntax
Use an identity property function instead: ${_e}.`)]}const oe=[];if(g.layerType==="symbol")F!=="text-field"||!y||y.glyphs||y.imports||oe.push(new i.V(d,C,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&i.a0(i.Q(C))&&i.K(C.type)==="identity"&&oe.push(new i.V(d,C,'"text-font" does not support identity functions'));else if(g.layerType==="model"&&l==="paint"&&N&&N.layout&&N.layout.hasOwnProperty("model-id")&&i.M(re)&&(i.a1(re)||i.N(re))){const _e=i.S(i.Q(C),re),ge=_e.value.expression||_e.value._styleExpression.expression;ge&&!i.X(ge,["measure-light"])&&(F==="model-emissive-strength"&&i.Y(ge)&&i.W(ge)||oe.push(new i.V(d,C,`${F} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return oe.concat(ln({key:g.key,value:C,valueSpec:re,style:y,styleSpec:j,expressionContext:"property",propertyType:l,propertyKey:F}))}function Ai(g){return Mn(g,"paint")}function Vi(g){return Mn(g,"layout")}function Ui(g){let l=[];const d=g.value,y=g.key,N=g.style,j=g.styleSpec;d.type||d.ref||l.push(new i.V(y,d,'either "type" or "ref" is required'));let C=i.K(d.type);const F=i.K(d.ref);if(d.id){const W=i.K(d.id);for(let Z=0;Z<g.arrayIndex;Z++){const Y=N.layers[Z];i.K(Y.id)===W&&l.push(new i.V(y,d.id,`duplicate layer id "${d.id}", previously used at line ${Y.id.__line__}`))}}if("ref"in d){let W;["type","source","source-layer","filter","layout"].forEach(Z=>{Z in d&&l.push(new i.V(y,d[Z],`"${Z}" is prohibited for ref layers`))}),N.layers.forEach(Z=>{i.K(Z.id)===F&&(W=Z)}),W?W.ref?l.push(new i.V(y,d.ref,"ref cannot reference another ref layer")):C=i.K(W.type):typeof F=="string"&&l.push(new i.V(y,d.ref,`ref layer "${F}" not found`))}else if(C!=="background"&&C!=="sky"&&C!=="slot")if(d.source){const W=N.sources&&N.sources[d.source],Z=W&&i.K(W.type);W?Z==="vector"&&C==="raster"?l.push(new i.V(y,d.source,`layer "${d.id}" requires a raster source`)):Z==="raster"&&C!=="raster"?l.push(new i.V(y,d.source,`layer "${d.id}" requires a vector source`)):Z!=="vector"||d["source-layer"]?Z==="raster-dem"&&C!=="hillshade"?l.push(new i.V(y,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):Z!=="raster-array"||["raster","raster-particle"].includes(C)?C!=="line"||!d.paint||!d.paint["line-gradient"]&&!d.paint["line-trim-offset"]||Z==="geojson"&&W.lineMetrics?C==="raster-particle"&&Z!=="raster-array"&&l.push(new i.V(y,d.source,`layer "${d.id}" requires a 'raster-array' source.`)):l.push(new i.V(y,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new i.V(y,d.source,"raster-array source can only be used with layer type 'raster'.")):l.push(new i.V(y,d,`layer "${d.id}" must specify a "source-layer"`)):l.push(new i.V(y,d.source,`source "${d.source}" not found`))}else l.push(new i.V(y,d,'missing required property "source"'));return l=l.concat(Vn({key:y,value:d,valueSpec:j.layer,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ln({key:`${y}.type`,value:d.type,valueSpec:j.layer.type,style:g.style,styleSpec:g.styleSpec,object:d,objectKey:"type"}),filter:W=>Sr(i.J({layerType:C},W)),layout:W=>Vn({layer:d,key:W.key,value:W.value,valueSpec:{},style:W.style,styleSpec:W.styleSpec,objectElementValidators:{"*":Z=>Vi(i.J({layerType:C},Z))}}),paint:W=>Vn({layer:d,key:W.key,value:W.value,valueSpec:{},style:W.style,styleSpec:W.styleSpec,objectElementValidators:{"*":Z=>Ai(i.J({layerType:C,layer:d},Z))}})}})),l}function xo(g){const l=g.value,d=g.key,y=i.H(l);return y!=="string"?[new i.V(d,l,`string expected, ${y} found`)]:[]}const Wa={promoteId:function g({key:l,value:d}){if(i.H(d)==="string")return xo({key:l,value:d});if(Array.isArray(d)){const y=[],N=i.Q(d),j=i.U(N);return j.result==="error"&&j.value.forEach(C=>{y.push(new i.V(`${l}${C.key}`,null,`${C.message}`))}),i.X(j.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||y.push(new i.V(`${l}`,null,"promoteId expression should be only feature dependent")),y}{const y=[];for(const N in d)y.push(...g({key:`${l}.${N}`,value:d[N]}));return y}}};function Qs(g){const l=g.value,d=g.key,y=g.styleSpec,N=g.style;if(!l.type)return[new i.V(d,l,'"type" is required')];const j=i.K(l.type);let C=[];switch(["vector","raster","raster-dem","raster-array"].includes(j)&&(l.url||l.tiles||C.push(new i.G(d,l,'Either "url" or "tiles" is required.'))),j){case"vector":case"raster":case"raster-dem":case"raster-array":return C=C.concat(Vn({key:d,value:l,valueSpec:y[`source_${j.replace("-","_")}`],style:g.style,styleSpec:y,objectElementValidators:Wa})),C;case"geojson":if(C=Vn({key:d,value:l,valueSpec:y.source_geojson,style:N,styleSpec:y,objectElementValidators:Wa}),l.cluster)for(const F in l.clusterProperties){const[W,Z]=l.clusterProperties[F],Y=typeof W=="string"?[W,["accumulated"],["get",F]]:W;C.push(...Zt({key:`${d}.${F}.map`,value:Z,expressionContext:"cluster-map"})),C.push(...Zt({key:`${d}.${F}.reduce`,value:Y,expressionContext:"cluster-reduce"}))}return C;case"video":return Vn({key:d,value:l,valueSpec:y.source_video,style:N,styleSpec:y});case"image":return Vn({key:d,value:l,valueSpec:y.source_image,style:N,styleSpec:y});case"canvas":return[new i.V(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vr({key:`${d}.type`,value:l.type,valueSpec:{values:Eo(y)}})}}function Eo(g){return g.source.reduce((l,d)=>{const y=g[d];return y.type.type==="enum"&&(l=l.concat(Object.keys(y.type.values))),l},[])}function ss(g){const l=g.value,d=g.styleSpec,y=d.light,N=g.style;let j=[];const C=i.H(l);if(l===void 0)return j;if(C!=="object")return j=j.concat([new i.V("light",l,`object expected, ${C} found`)]),j;for(const F in l){const W=F.match(/^(.*)-transition$/),Z=F.match(/^(.*)-use-theme$/);j=j.concat(Z&&y[Z[1]]?ln({key:F,value:l[F],valueSpec:{type:"string"},style:N,styleSpec:d}):W&&y[W[1]]&&y[W[1]].transition?ln({key:F,value:l[F],valueSpec:d.transition,style:N,styleSpec:d}):y[F]?ln({key:F,value:l[F],valueSpec:y[F],style:N,styleSpec:d}):[new i.V(F,l[F],`unknown property "${F}"`)])}return j}function ac(g){const l=g.value;let d=[];if(!l)return d;const y=i.H(l);if(y!=="object")return d=d.concat([new i.V("light-3d",l,`object expected, ${y} found`)]),d;const N=g.styleSpec,j=N["light-3d"],C=g.key,F=g.style,W=g.style.lights;for(const re of["type","id"])if(!(re in l))return d=d.concat([new i.V("light-3d",l,`missing property ${re} on light`)]),d;if(l.type&&W)for(let re=0;re<g.arrayIndex;re++){const ne=i.K(l.type),oe=W[re];i.K(oe.type)===ne&&d.push(new i.V(C,l.id,`duplicate light type "${l.type}", previously defined at line ${oe.id.__line__}`))}const Z=`properties_light_${l.type}`;if(!(Z in N))return d=d.concat([new i.V("light-3d",l,`Invalid light type ${l.type}`)]),d;const Y=N[Z];for(const re in l)if(re==="properties"){const ne=l[re],oe=i.H(ne);if(oe!=="object")return d=d.concat([new i.V("properties",ne,`object expected, ${oe} found`)]),d;for(const _e in ne)d=d.concat(Y[_e]?ln({key:_e,value:ne[_e],valueSpec:Y[_e],style:F,styleSpec:N}):[new i.G(g.key,ne[_e],`unknown property "${_e}"`)])}else{const ne=re.match(/^(.*)-transition$/),oe=re.match(/^(.*)-use-theme$/);d=d.concat(oe&&j[oe[1]]?ln({key:re,value:l[re],valueSpec:{type:"string"},style:F,styleSpec:N}):ne&&j[ne[1]]&&j[ne[1]].transition?ln({key:re,value:l[re],valueSpec:N.transition,style:F,styleSpec:N}):j[re]?ln({key:re,value:l[re],valueSpec:j[re],style:F,styleSpec:N}):[new i.G(re,l[re],`unknown property "${re}"`)])}return d}function Il(g){const l=g.value,d=g.key,y=g.style,N=g.styleSpec,j=N.terrain;let C=[];const F=i.H(l);if(l===void 0||F==="null")return C;if(F!=="object")return C=C.concat([new i.V("terrain",l,`object expected, ${F} found`)]),C;for(const W in l){const Z=W.match(/^(.*)-transition$/),Y=W.match(/^(.*)-use-theme$/);C=C.concat(Y&&j[Y[1]]?ln({key:W,value:l[W],valueSpec:{type:"string"},style:y,styleSpec:N}):Z&&j[Z[1]]&&j[Z[1]].transition?ln({key:W,value:l[W],valueSpec:N.transition,style:y,styleSpec:N}):j[W]?ln({key:W,value:l[W],valueSpec:j[W],style:y,styleSpec:N}):[new i.G(W,l[W],`unknown property "${W}"`)])}if(l.source){const W=y.sources&&y.sources[l.source],Z=W&&i.K(W.type);W?Z!=="raster-dem"&&C.push(new i.V(d,l.source,`terrain cannot be used with a source of type ${String(Z)}, it only be used with a "raster-dem" source type`)):C.push(new i.V(d,l.source,`source "${l.source}" not found`))}else C.push(new i.V(d,l,'terrain is missing required property "source"'));return C}function $s(g){const l=g.value,d=g.style,y=g.styleSpec,N=y.fog;let j=[];const C=i.H(l);if(l===void 0)return j;if(C!=="object")return j=j.concat([new i.V("fog",l,`object expected, ${C} found`)]),j;for(const F in l){const W=F.match(/^(.*)-transition$/),Z=F.match(/^(.*)-use-theme$/);j=j.concat(Z&&N[Z[1]]?ln({key:F,value:l[F],valueSpec:{type:"string"},style:d,styleSpec:y}):W&&N[W[1]]&&N[W[1]].transition?ln({key:F,value:l[F],valueSpec:y.transition,style:d,styleSpec:y}):N[F]?ln({key:F,value:l[F],valueSpec:N[F],style:d,styleSpec:y}):[new i.G(F,l[F],`unknown property "${F}"`)])}return j}const sc={"*":()=>[],array:pi,boolean:function(g){const l=g.value,d=g.key,y=i.H(l);return y!=="boolean"?[new i.V(d,l,`boolean expected, ${y} found`)]:[]},number:dt,color:function(g){const l=g.key,d=g.value,y=i.H(d);return y!=="string"?[new i.V(l,d,`color expected, ${y} found`)]:i._.parseCSSColor(d)===null?[new i.V(l,d,`color expected, "${d}" found`)]:[]},enum:vr,filter:Sr,function:Ot,layer:Ui,object:Vn,source:Qs,model:i.a2,light:ss,"light-3d":ac,terrain:Il,fog:$s,string:xo,formatted:function(g){return xo(g).length===0?[]:Zt(g)},resolvedImage:function(g){return xo(g).length===0?[]:Zt(g)},projection:function(g){const l=g.value,d=g.styleSpec,y=d.projection,N=g.style;let j=[];const C=i.H(l);if(C==="object")for(const F in l)j=j.concat(ln({key:F,value:l[F],valueSpec:y[F],style:N,styleSpec:d}));else C!=="string"&&(j=j.concat([new i.V("projection",l,`object or string expected, ${C} found`)]));return j},import:function(g){const{value:l,styleSpec:d}=g,{data:y,...N}=l;Object.defineProperty(N,"__line__",{value:l.__line__,enumerable:!1});let j=Vn(i.J({},g,{value:N,valueSpec:d.import}));return i.K(N.id)===""&&j.push(new i.V(`${g.key}.id`,N,"import id can't be an empty string")),y&&(j=j.concat(qu(y,d,{key:`${g.key}.data`}))),j}};function ln(g,l=!1){const d=g.value,y=g.valueSpec,N=g.styleSpec;if(y.expression&&i.a0(i.K(d)))return Ot(g);if(y.expression&&i.O(i.Q(d)))return Zt(g);if(y.type&&sc[y.type]){const j=sc[y.type](g);return l===!0&&j.length>0&&i.H(g.value)==="array"?Zt(g):j}return Vn(i.J({},g,{valueSpec:y.type?N[y.type]:y}))}function os(g){const l=g.value,d=g.key,y=xo(g);return y.length||(l.indexOf("{fontstack}")===-1&&y.push(new i.V(d,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&y.push(new i.V(d,l,'"glyphs" url must include a "{range}" token'))),y}function qu(g,l=i.a3,d={}){return ln({key:d.key||"",value:g,valueSpec:l.$root,styleSpec:l,style:g,objectElementValidators:{glyphs:os,"*":()=>[]}})}function Ha(g,l=i.a3){return Xi(qu(g,l))}const eo=g=>Xi(Qs(g)),Gn=g=>Xi(ss(g)),va=g=>Xi(ac(g)),Ea=g=>Xi(Il(g)),Es=g=>Xi($s(g)),Ll=g=>Xi(function(l){const d=l.value,y=l.style,N=l.styleSpec,j=N.snow;let C=[];const F=i.H(d);if(d===void 0)return C;if(F!=="object")return C=C.concat([new i.V("snow",d,`object expected, ${F} found`)]),C;for(const W in d){const Z=W.match(/^(.*)-transition$/);C=C.concat(Z&&j[Z[1]]&&j[Z[1]].transition?ln({key:W,value:d[W],valueSpec:N.transition,style:y,styleSpec:N}):j[W]?ln({key:W,value:d[W],valueSpec:j[W],style:y,styleSpec:N}):[new i.G(W,d[W],`unknown property "${W}"`)])}return C}(g)),Ma=g=>Xi(function(l){const d=l.value,y=l.style,N=l.styleSpec,j=N.rain;let C=[];const F=i.H(d);if(d===void 0)return C;if(F!=="object")return C=C.concat([new i.V("rain",d,`object expected, ${F} found`)]),C;for(const W in d){const Z=W.match(/^(.*)-transition$/);C=C.concat(Z&&j[Z[1]]&&j[Z[1]].transition?ln({key:W,value:d[W],valueSpec:N.transition,style:y,styleSpec:N}):j[W]?ln({key:W,value:d[W],valueSpec:j[W],style:y,styleSpec:N}):[new i.G(W,d[W],`unknown property "${W}"`)])}return C}(g)),qs=g=>Xi(Ui(g)),$i=g=>Xi(Sr(g)),Ms=g=>Xi(Ai(g)),gs=g=>Xi(Vi(g)),Gu=g=>Xi(i.a2(g));function Xi(g){return g.slice().sort((l,d)=>l.line&&d.line?l.line-d.line:0)}function Ko(g,l){let d=!1;if(l&&l.length)for(const y of l)y instanceof i.G?i.w(y.message):(g.fire(new i.y(new Error(y.message))),d=!0);return d}let St;class ve extends i.E{constructor(l,d="flat"){super(),this._transitionable=new i.a4(St||(St=new i.a5({anchor:new i.a6(i.a3.light.anchor),position:new i.a7(i.a3.light.position),color:new i.a6(i.a3.light.color),intensity:new i.a6(i.a3.light.intensity)}))),this.setLight(l,d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,d,y={}){this._validate(Gn,l,y)||(this._transitionable.setTransitionOrValue(l),this.id=d)}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,d,y){return(!y||y.validate!==!1)&&Ko(this,l.call(Ha,i.l({value:d,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let ke=class extends i.E{constructor(g,l,d,y){super(),this.scope=d,this._transitionable=new i.a4(new i.a5({source:new i.a6(i.a3.terrain.source),exaggeration:new i.a6(i.a3.terrain.exaggeration)}),d,y),this._transitionable.setTransitionOrValue(g,y),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=l}get(){return this._transitionable.serialize()}set(g,l){this._transitionable.setTransitionOrValue(g,l)}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}getExaggeration(g){return this._transitioning.possiblyEvaluate(new i.a8(g)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const g=this._transitionable._values.exaggeration;if(!g)return null;const l=g.value.expression;if(!l)return null;let d=-1,y=-1,N=1;for(const j of l.zoomStops)N=l.evaluate(new i.a8(j)),N>.01?(d=j,y=-1):y=j;return N<.01&&d>0&&y>d?[d,y]:null}isZoomDependent(){const g=this._transitionable._values.exaggeration;return g!=null&&g.value!=null&&g.value.expression!=null&&g.value.expression instanceof i.a9}};const Oe=45,Ye=65,Je=.05;function st(g,l,d,y){const N=i.ac(Oe,Ye,d),[j,C]=gt(g,y);let F=1-Math.min(1,Math.exp((l-j)/(C-j)*-6));return F*=F*F,F=Math.min(1,1.00747*F),F*N*g.alpha}function gt(g,l){const d=.5/Math.tan(.5*l);return[g.range[0]+d,g.range[1]+d]}function lt(g,l,d,y,N){const j=i.ab.vec3.transformMat4([],[l,d,y],N.mercatorFogMatrix);return st(g,i.ab.vec3.length(j),N.pitch,N._fov)}function wt(g,l,d,y,N,j,C){const F=[[d,y,0],[N,y,0],[N,j,0],[d,j,0]];let W=Number.MAX_VALUE,Z=-Number.MAX_VALUE;for(const Y of F){const re=i.ab.vec3.transformMat4([],Y,l),ne=i.ab.vec3.length(re);W=Math.min(W,ne),Z=Math.max(Z,ne)}return[st(g,W,C.pitch,C._fov),st(g,Z,C.pitch,C._fov)]}class bt extends i.E{constructor(l,d,y,N){super();const j=new i.a5({range:new i.a6(i.a3.fog.range),color:new i.a6(i.a3.fog.color),"color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a6(i.a3.fog["high-color"]),"high-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a6(i.a3.fog["space-color"]),"space-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a6(i.a3.fog["horizon-blend"]),"star-intensity":new i.a6(i.a3.fog["star-intensity"]),"vertical-range":new i.a6(i.a3.fog["vertical-range"])});this._transitionable=new i.a4(j,y,new Map(N)),this.set(l,N),this._transitioning=this._transitionable.untransitioned(),this._transform=d,this.properties=new i.ad(j),this.scope=y}get state(){const l=this._transform,d=l.projection.name==="globe",y=i.ae(l.zoom),N=this.properties.get("range"),j=[.5,3];return{range:d?[i.af(j[0],N[0],y),i.af(j[1],N[1],y)]:N,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(l,d,y={}){if(this._validate(Es,l,y))return;const N=i.l({},l);for(const j of Object.keys(i.a3.fog))N[j]===void 0&&(N[j]=i.a3.fog[j].default);this._options=N,this._transitionable.setTransitionOrValue(this._options,d)}getOpacity(l){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ac(Oe,Ye,l))*d.a}getOpacityAtLatLng(l,d){return this._transform.projection.supportsFog?function(y,N,j){const C=i.aa.fromLngLat(N),F=j.elevation?j.elevation.getAtPointOrZero(C):0;return lt(y,C.x,C.y,F,j)}(this.state,l,d):0}getOpacityForTile(l){if(!this._transform.projection.supportsFog)return[1,1];const d=this._transform.calculateFogTileMatrix(l.toUnwrapped());return wt(this.state,d,0,0,i.ag,i.ag,this._transform)}getOpacityForBounds(l,d,y,N,j){return this._transform.projection.supportsFog?wt(this.state,l,d,y,N,j,this._transform):[1,1]}getFovAdjustedRange(l){return this._transform.projection.supportsFog?gt(this.state,l):[0,1]}isVisibleOnFrustum(l){if(!this._transform.projection.supportsFog)return!1;const d=[4,5,6,7];for(const y of d){const N=l.points[y];let j;if(N[2]>=0)j=N;else{const C=l.points[y-4];j=i.ah(C,N,C[2]/(C[2]-N[2]))}if(lt(this.state,j[0],j[1],0,this._transform)>=Je)return!0}return!1}updateConfig(l){this._transitionable.setTransitionOrValue(this._options,new Map(l))}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,d,y){return(!y||y.validate!==!1)&&Ko(this,l.call(Ha,i.l({value:d,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let Nt,Bt,ar,sr,Nr=class extends i.E{constructor(g,l,d,y){super();const N=Nt||(Nt=new i.a5({density:new i.a6(i.a3.snow.density),intensity:new i.a6(i.a3.snow.intensity),color:new i.a6(i.a3.snow.color),opacity:new i.a6(i.a3.snow.opacity),vignette:new i.a6(i.a3.snow.vignette),"vignette-color":new i.a6(i.a3.snow["vignette-color"]),"center-thinning":new i.a6(i.a3.snow["center-thinning"]),direction:new i.a6(i.a3.snow.direction),"flake-size":new i.a6(i.a3.snow["flake-size"])}));this._transitionable=new i.a4(N,d,new Map(y)),this.set(g,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(N),this.scope=d}get state(){const g=this.properties.get("opacity"),l=this.properties.get("color"),d=this.properties.get("direction"),y=i.ai(d[0]),N=-Math.max(i.ai(d[1]),.01),j=[Math.cos(y)*Math.cos(N),Math.sin(y)*Math.cos(N),Math.sin(N)],C=this.properties.get("vignette"),F=this.properties.get("vignette-color");return F.a=C,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(l.r,l.g,l.b,l.a*g),direction:j,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:F}}get(){return this._transitionable.serialize()}set(g,l,d={}){if(this._validate(Ll,g,d))return;const y=i.l({},g);for(const N of Object.keys(i.a3.snow))y[N]===void 0&&(y[N]=i.a3.snow[N].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,l)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,l,d){return(!d||d.validate!==!1)&&Ko(this,g.call(Ha,i.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}},$r=class extends i.E{constructor(g,l,d,y){super();const N=Bt||(Bt=new i.a5({density:new i.a6(i.a3.rain.density),intensity:new i.a6(i.a3.rain.intensity),color:new i.a6(i.a3.rain.color),opacity:new i.a6(i.a3.rain.opacity),vignette:new i.a6(i.a3.rain.vignette),"vignette-color":new i.a6(i.a3.rain["vignette-color"]),"center-thinning":new i.a6(i.a3.rain["center-thinning"]),direction:new i.a6(i.a3.rain.direction),"droplet-size":new i.a6(i.a3.rain["droplet-size"]),"distortion-strength":new i.a6(i.a3.rain["distortion-strength"])}));this._transitionable=new i.a4(N,d,new Map(y)),this.set(g,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(N),this.scope=d}get state(){const g=this.properties.get("opacity"),l=this.properties.get("color"),d=this.properties.get("direction"),y=i.ai(d[0]),N=-Math.max(i.ai(d[1]),.01),j=[Math.cos(y)*Math.cos(N),Math.sin(y)*Math.cos(N),Math.sin(N)],C=this.properties.get("vignette-color");return C.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(l.r,l.g,l.b,l.a*g),direction:j,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:C}}get(){return this._transitionable.serialize()}set(g,l,d={}){if(this._validate(Ma,g,d))return;const y=i.l({},g);for(const N of Object.keys(i.a3.rain))y[N]===void 0&&(y[N]=i.a3.rain[N].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,l)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,l,d){return(!d||d.validate!==!1)&&Ko(this,g.call(Ha,i.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}};class Ur extends i.E{constructor(l,d,y,N){super(),this.scope=y,this._options=l,this.properties=new i.ad(d),this._transitionable=new i.a4(d,y,new Map(N)),this._transitionable.setTransitionOrValue(l.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(l){this._transitionable.setTransitionOrValue(this._options.properties,new Map(l))}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(l,d){this._options=l,this._transitionable.setTransitionOrValue(l.properties,d)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Vr{constructor(l,d,y,N){this.screenBounds=l,this.cameraPoint=d,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,N)}static createFromScreenPoints(l,d){let y,N;if(l instanceof i.P||typeof l[0]=="number"){const j=i.P.convert(l);y=[j],N=d.isPointAboveHorizon(j)}else{const j=i.P.convert(l[0]),C=i.P.convert(l[1]);y=[j,C],N=i.al(j,C).every(F=>d.isPointAboveHorizon(F))}return new Vr(y,d.getCameraPoint(),N,d)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(l){return i.al(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],l)}bufferedCameraGeometry(l){const d=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],N=i.al(d,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<y.x?N.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?N[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(N[3]=this.cameraPoint)),i.am(N,l)}bufferedCameraGeometryGlobe(l){const d=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],N=i.al(d,y,l),j=this.cameraPoint.clone();switch(3*((j.y>d.y)+(j.y>y.y))+((j.x>d.x)+(j.x>y.x))){case 0:N[0]=j,N[4]=j.clone();break;case 1:N.splice(1,0,j);break;case 2:N[1]=j;break;case 3:N.splice(4,0,j);break;case 5:N.splice(2,0,j);break;case 6:N[3]=j;break;case 7:N.splice(3,0,j);break;case 8:N[2]=j}return N}containsTile(l,d,y,N=0){const j=l.queryPadding/d._pixelsPerMercatorPixel+1,C=y?this._bufferedCameraMercator(j,d):this._bufferedScreenMercator(j,d);let F=l.tileID.wrap+(C.unwrapped?N:0);const W=C.polygon.map(Te=>i.an(l.tileTransform,Te,F));if(!i.ao(W,0,0,i.ag,i.ag))return;F=l.tileID.wrap+(this.screenGeometryMercator.unwrapped?N:0);const Z=this.screenGeometryMercator.polygon.map(Te=>i.ap(l.tileTransform,Te,F)),Y=Z.map(Te=>new i.P(Te[0],Te[1])),re=d.getFreeCameraOptions().position||new i.aa(0,0,0),ne=i.ap(l.tileTransform,re,F),oe=Z.map(Te=>{const Ae=i.ab.vec3.sub(Te,Te,ne);return i.ab.vec3.normalize(Ae,Ae),new i.aq(ne,Ae)}),_e=i.ar(l,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Y,tilespaceRays:oe,bufferedTilespaceGeometry:W,bufferedTilespaceBounds:(ge=i.as(W),ge.min.x=i.aw(ge.min.x,0,i.ag),ge.min.y=i.aw(ge.min.y,0,i.ag),ge.max.x=i.aw(ge.max.x,0,i.ag),ge.max.y=i.aw(ge.max.y,0,i.ag),ge),tile:l,tileID:l.tileID,pixelToTileUnitsFactor:_e};var ge}_bufferedScreenMercator(l,d){const y=Tn(l);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let N;return N=d.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(l),d):{polygon:this.bufferedScreenGeometry(l).map(j=>d.pointCoordinate3D(j)),unwrapped:!0},this._screenRaycastCache[y]=N,N}}_bufferedCameraMercator(l,d){const y=Tn(l);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let N;return N=d.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(l),d):{polygon:this.bufferedCameraGeometry(l).map(j=>d.pointCoordinate3D(j)),unwrapped:!0},this._cameraRaycastCache[y]=N,N}}_projectAndResample(l,d){const y=function(j,C){const F=i.ab.mat4.multiply([],C.pixelMatrix,C.globeMatrix),W=[0,-i.ax,0,1],Z=[0,i.ax,0,1],Y=[0,0,0,1];i.ab.vec4.transformMat4(W,W,F),i.ab.vec4.transformMat4(Z,Z,F),i.ab.vec4.transformMat4(Y,Y,F);const re=new i.P(W[0]/W[3],W[1]/W[3]),ne=new i.P(Z[0]/Z[3],Z[1]/Z[3]),oe=i.au(j,re)&&W[3]<Y[3],_e=i.au(j,ne)&&Z[3]<Y[3];if(!oe&&!_e)return null;const ge=function(Ze,He,Xe){for(let at=1;at<Ze.length;at++){const _t=Hn(He.pointCoordinate3D(Ze[at-1]).x),mt=Hn(He.pointCoordinate3D(Ze[at]).x);if(Xe<0){if(_t<mt)return{idx:at,t:-_t/(mt-1-_t)}}else if(mt<_t)return{idx:at,t:(1-_t)/(mt+1-_t)}}return null}(j,C,oe?-1:1);if(!ge)return null;const{idx:Te,t:Ae}=ge;let Re=Te>1?On(j.slice(0,Te),C):[],qe=Te<j.length?On(j.slice(Te),C):[];Re=Re.map(Ze=>new i.P(Hn(Ze.x),Ze.y)),qe=qe.map(Ze=>new i.P(Hn(Ze.x),Ze.y));const Ue=[...Re];Ue.length===0&&Ue.push(qe[qe.length-1]);const Qe=i.af(Ue[Ue.length-1].y,(qe.length===0?Re[0]:qe[0]).y,Ae);let Ke;return Ke=oe?[new i.P(0,Qe),new i.P(0,0),new i.P(1,0),new i.P(1,Qe)]:[new i.P(1,Qe),new i.P(1,1),new i.P(0,1),new i.P(0,Qe)],Ue.push(...Ke),qe.length===0?Ue.push(Re[0]):Ue.push(...qe),{polygon:Ue.map(Ze=>new i.aa(Ze.x,Ze.y)),unwrapped:!1}}(l,d);if(y)return y;const N=function(j,C){let F=!1,W=-1/0,Z=0;for(let re=0;re<j.length-1;re++)j[re].x>W&&(W=j[re].x,Z=re);for(let re=0;re<j.length-1;re++){const ne=(Z+re)%(j.length-1),oe=j[ne],_e=j[ne+1];Math.abs(oe.x-_e.x)>.5&&(oe.x<_e.x?(oe.x+=1,ne===0&&(j[j.length-1].x+=1)):(_e.x+=1,ne+1===j.length-1&&(j[0].x+=1)),F=!0)}const Y=i.at(C.center.lng);return F&&Y<Math.abs(Y-1)&&j.forEach(re=>{re.x-=1}),{polygon:j,unwrapped:F}}(On(l,d).map(j=>new i.P(Hn(j.x),j.y)),d);return{polygon:N.polygon.map(j=>new i.aa(j.x,j.y)),unwrapped:N.unwrapped}}}function On(g,l){return i.av(g,d=>{const y=l.pointCoordinate3D(d);d.x=y.x,d.y=y.y},1/256)}function Hn(g){return g<0?1+g%1:g%1}function Tn(g){return 100*g|0}function $n(g,l,d,y,N){const j=function(F,W){if(F)return N(F);if(W){if(g.url&&W.tiles&&g.tiles&&delete g.tiles,W.variants){if(!Array.isArray(W.variants))return N(new Error("variants must be an array"));for(const Y of W.variants){if(Y==null||typeof Y!="object"||Y.constructor!==Object)return N(new Error("variant must be an object"));if(!Array.isArray(Y.capabilities))return N(new Error("capabilities must be an array"));if(Y.capabilities.length===1&&Y.capabilities[0]==="meshopt"){W=i.l(W,Y);break}}}const Z=i.ay(i.l({},W,g),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);Z.tiles=l.canonicalizeTileset(Z,g.url),N(null,Z)}},C=function(F,W,Z){if(!F)return null;if(!W&&!Z)return F;Z=Z||F.worldview_default;const Y=Object.values(F.language||{});if(Y.length===0)return null;const re=Object.values(F.worldview||{});if(re.length===0)return null;const ne=Y.every(_e=>_e===W),oe=re.every(_e=>_e===Z);return ne&&oe?F:W in(F.language_options||{})||Z in(F.worldview_options||{})?null:F.language_options&&F.worldview_options?F:null}(g.data,d,y);return C?i.q.frame(()=>j(null,C)):g.url?i.n(l.transformRequest(l.normalizeSourceURL(g.url,null,d,y),i.R.Source),j):i.q.frame(()=>{const{data:F,...W}=g;j(null,W)})}class Rn{constructor(l,d,y){this.bounds=i.az.convert(this.validateBounds(l)),this.minzoom=d||0,this.maxzoom=y||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const d=Math.pow(2,l.z),y=Math.floor(i.at(this.bounds.getWest())*d),N=Math.floor(i.aA(this.bounds.getNorth())*d),j=Math.ceil(i.at(this.bounds.getEast())*d),C=Math.ceil(i.aA(this.bounds.getSouth())*d);return l.x>=y&&l.x<j&&l.y>=N&&l.y<C}}class Oa extends i.E{constructor(l,d,y,N){if(super(),this.id=l,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.ay(d,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},d),this._collectResourceTiming=!!d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(N),this._tileWorkers={},this._deduped=new i.aB}load(l){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const d=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map.getWorldview();this._tileJSONRequest=$n(this._options,this.map._requestManager,d,y,(N,j)=>{if(this._tileJSONRequest=null,this._loaded=!0,N)d&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${d}`),y&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new i.y(N));else if(j){if(i.l(this,j),this.hasWorldviews=!!j.worldview_options,j.worldview_default&&(this.worldviewDefault=j.worldview_default),j.vector_layers){this.vectorLayers=j.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const C of j.vector_layers)this.vectorLayerIds.push(C.id),j.worldview&&j.worldview[C.source]&&this.localizableLayerIds.add(C.id)}j.bounds&&(this.tileBounds=new Rn(j.bounds,this.minzoom,this.maxzoom)),tt(j.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}l&&l(N)})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest();const l=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(l))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(l){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(l,d){const y=l.tileID.canonical.url(this.tiles,this.scheme),N=this.map._requestManager.normalizeTileURL(y),j=this.map._requestManager.transformRequest(N,i.R.Tile),C=this.map.style?this.map.style.getLut(this.scope):null,F=C?{image:C.image.clone()}:null,W={request:j,data:void 0,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,lut:F,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:l.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:l.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(y)&&(W.worldview=this.map.getWorldview()||this.worldviewDefault,W.localizableLayerIds=this.localizableLayerIds),W.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired")l.state==="loading"?l.reloadCallback=d:l.request=l.actor.send("reloadTile",W,Z.bind(this));else if(l.actor=this._tileWorkers[N]=this._tileWorkers[N]||this.dispatcher.getActor(),this.dispatcher.ready)l.request=l.actor.send("loadTile",W,Z.bind(this),void 0,!0);else{const Y=i.aD.call({deduped:this._deduped},W,(re,ne)=>{re||!ne?Z.call(this,re):(W.data={cacheControl:ne.cacheControl,expires:ne.expires,rawData:ne.rawData.slice(0)},l.actor&&l.actor.send("loadTile",W,Z.bind(this),void 0,!0))},!0);l.request={cancel:Y}}function Z(Y,re){return delete l.request,l.aborted?d(null):Y&&Y.status!==404?d(Y):(re&&re.resourceTiming&&(l.resourceTiming=re.resourceTiming),this.map._refreshExpiredTiles&&re&&l.setExpiryData(re),l.loadVectorData(re,this.map.painter),i.aE(this.dispatcher),d(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(l,d){l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id,scope:this.scope}),l.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ys extends i.E{constructor(l,d,y,N){super(),this.id=l,this.dispatcher=y,this.setEventedParent(N),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},d),i.l(this,i.ay(d,["url","scheme","tileSize"]))}load(l){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._tileJSONRequest=$n(this._options,this.map._requestManager,null,null,(d,y)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new i.y(d)):y&&(i.l(this,y),y.raster_layers&&(this.rasterLayers=y.raster_layers,this.rasterLayerIds=this.rasterLayers.map(N=>N.id)),y.bounds&&(this.tileBounds=new Rn(y.bounds,this.minzoom,this.maxzoom)),tt(y.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),l&&l(d)})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest();const l=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(l))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(l){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,d){const y=i.q.devicePixelRatio>=2,N=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);l.request=i.o(this.map._requestManager.transformRequest(N,i.R.Tile),(j,C,F,W)=>(delete l.request,l.aborted?(l.state="unloaded",d(null)):j?(l.state="errored",d(j)):C?(this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:F,expires:W}),l.setTexture(C,this.map.painter),l.state="loaded",i.aE(this.dispatcher),void d(null)):d(null)))}abortTile(l,d){l.request&&(l.request.cancel(),delete l.request),d&&d()}unloadTile(l,d){l.texture&&l.texture instanceof i.T?(l.destroy(!0),l.texture&&l.texture instanceof i.T&&this.map.painter.saveTileTexture(l.texture)):l.destroy(),d&&d()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ka extends ys{constructor(l,d,y,N){super(l,d,y,N),this.type="raster-array",this.maxzoom=22,this._options=i.l({type:"raster-array"},d)}triggerRepaint(l){const d=this.map.painter._terrain,y=this.map.style.getSourceCache(this.id);d&&d.enabled&&y&&d._clearRenderCacheForTile(y.id,l.tileID),this.map.triggerRepaint()}loadTile(l,d){const y=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),N=this.map._requestManager.transformRequest(y,i.R.Tile);l.requestParams=N,l.actor||(l.actor=this.dispatcher.getActor()),l.request=l.fetchHeader(void 0,(j,C,F,W)=>{if(delete l.request,l.aborted)return l.state="unloaded",d(null);if(j)return j.code===20?void 0:(l.state="errored",d(j));this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:F,expires:W}),l.state="empty",d(null)})}unloadTile(l,d){const y=l.texture;y&&y instanceof i.T?(l.destroy(!0),this.map.painter.saveTileTexture(y)):(l.destroy(),l.flushQueues(),l._isHeaderLoaded=!1,delete l._mrt,delete l.textureDescriptor),l.fbo&&(l.fbo.destroy(),delete l.fbo),delete l.request,delete l.requestParams,delete l.neighboringTiles,l.state="unloaded"}prepareTile(l,d,y){l._isHeaderLoaded&&(l.state!=="empty"&&(l.state="reloading"),l.fetchBand(d,y,(N,j)=>{if(N)return l.state="errored",this.fire(new i.y(N)),void this.triggerRepaint(l);j&&(l.setTexture(j,this.map.painter),l.state="loaded",this.triggerRepaint(l))}))}getInitialBand(l){if(!this.rasterLayers)return 0;const d=this.rasterLayers.find(({id:j})=>j===l),y=d&&d.fields,N=y&&y.bands&&y.bands;return N?N[0]:0}getTextureDescriptor(l,d,y){if(!l)return;const N=d.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!N)return;let j=null;d instanceof i.aH?j=d.paint.get("raster-array-band"):d instanceof i.aI&&(j=d.paint.get("raster-particle-array-band"));const C=j||this.getInitialBand(N);if(C!=null)if(l.textureDescriptor){if(!l.updateNeeded(N,C)||y)return Object.assign({},l.textureDescriptor,{texture:l.texture})}else this.prepareTile(l,N,C)}}const ls={vector:Oa,raster:ys,"raster-dem":class extends ys{constructor(g,l,d,y){super(g,l,d,y),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}loadTile(g,l){const d=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(N,j){N&&(g.state="errored",l(N)),j&&(g.dem=j,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",l(null))}g.request=i.o(this.map._requestManager.transformRequest(d,i.R.Tile),(function(N,j,C,F){if(delete g.request,g.aborted)g.state="unloaded",l(null);else if(N)g.state="errored",l(N);else if(j){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:C,expires:F});const W=ImageBitmap&&j instanceof ImageBitmap&&i.t(),Z=1-(j.width-i.aF(j.width))/2;Z<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const Y=W?j:i.q.getImageData(j,Z),re={uid:g.uid,coord:g.tileID,source:this.id,scope:this.scope,rawImageData:Y,encoding:this.encoding,padding:Z};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",re,y.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(g){const l=g.canonical,d=Math.pow(2,l.z),y=(l.x-1+d)%d,N=l.x===0?g.wrap-1:g.wrap,j=(l.x+1+d)%d,C=l.x+1===d?g.wrap+1:g.wrap,F={};return F[new i.aG(g.overscaledZ,N,l.z,y,l.y).key]={backfilled:!1},F[new i.aG(g.overscaledZ,C,l.z,j,l.y).key]={backfilled:!1},l.y>0&&(F[new i.aG(g.overscaledZ,N,l.z,y,l.y-1).key]={backfilled:!1},F[new i.aG(g.overscaledZ,g.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},F[new i.aG(g.overscaledZ,C,l.z,j,l.y-1).key]={backfilled:!1}),l.y+1<d&&(F[new i.aG(g.overscaledZ,N,l.z,y,l.y+1).key]={backfilled:!1},F[new i.aG(g.overscaledZ,g.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},F[new i.aG(g.overscaledZ,C,l.z,j,l.y+1).key]={backfilled:!1}),F}},"raster-array":Ka,geojson:class extends i.E{constructor(g,l,d,y){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(y),this._data=l.data,this._options=i.l({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.minzoom!==void 0&&(this.minzoom=l.minzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const N=i.ag/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*N,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*N,extent:i.ag,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:i.ag,radius:(l.clusterRadius!==void 0?l.clusterRadius:50)*N,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter,dynamic:l.dynamic},l.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}updateData(g){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof g!="string"&&(g.type==="Feature"&&(g={type:"FeatureCollection",features:[g]}),g.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof g!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const l=new Map;for(const d of this._data.features)l.set(d.id,d);for(const d of g.features)l.set(d.id,d);this._data.features=[...l.values()]}else this._data=g;return this._updateWorkerData(!0),this}getClusterExpansionZoom(g,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id,scope:this.scope},l),this}getClusterChildren(g,l){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id,scope:this.scope},l),this}getClusterLeaves(g,l,d,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:g,limit:l,offset:d},y),this}_updateWorkerData(g=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const l=i.l({append:g},this.workerOptions);l.scope=this.scope;const d=this._data;typeof d=="string"?(l.request=this.map._requestManager.transformRequest(i.q.resolveURL(d),i.R.Source),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,l,(y,N)=>{if(this._loaded=!0,this._pendingLoad=null,y)this.fire(new i.y(y));else{const j={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&N&&N.resourceTiming&&N.resourceTiming[this.id]&&(j.resourceTiming=N.resourceTiming[this.id]),g&&(this._partialReload=!0),this.fire(new i.z("data",j)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(g),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const g=i.aC(this.id,this.scope);this.map.style.clearSource(g),this._updateWorkerData()}loadTile(g,l){const d=g.actor?"reloadTile":"loadTile";g.actor=this.actor;const y=this.map.style?this.map.style.getLut(this.scope):null,N=y?{image:y.image.clone()}:null,j=this._partialReload,C={type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:N,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:j};g.request=this.actor.send(d,C,(F,W)=>j&&!W?(g.state="loaded",l(null)):(delete g.request,g.destroy(),g.aborted?l(null):F?l(F):(g.loadVectorData(W,this.map.painter,d==="reloadTile"),l(null))),void 0,d==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g,l){this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id,scope:this.scope}),g.destroy()}onRemove(g){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aJ{constructor(g,l,d,y){super(g,l,d,y),this.roundZoom=!0,this.type="video",this.options=l}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const l of g.urls)this.urls.push(this.map._requestManager.transformRequest(l,i.R.Source).url);i.aK(this.urls,(l,d)=>{this._loaded=!0,l?this.fire(new i.y(l)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const l=this.video.seekable;g<l.start(0)||g>l.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,l=g.gl;this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(g,this.video,l.RGBA8),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aJ,model:class extends i.E{constructor(g,l,d,y){super(),this.id=g,this.type="model",this.models=[],this._loaded=!1,this._options=l}load(){const g=[];for(const l in this._options.models){const d=this._options.models[l],y=i.aM(this.map._requestManager.transformRequest(d.uri,i.R.Model).url).then(N=>{if(!N)return;const j=i.aN(N),C=new i.aO(l,d.position,d.orientation,j);C.computeBoundsAndApplyParent(),this.models.push(C)}).catch(N=>{this.fire(new i.y(new Error(`Could not load model ${l} from ${d.uri}: ${N.message}`)))});g.push(y)}return Promise.allSettled(g).then(()=>{this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(l=>{this.fire(new i.y(new Error(`Could not load models: ${l.message}`)))})}onAdd(g){this.map=g,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(g,l){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(g,l,d,y){super(),this.type="batched-model",this.id=g,this.tileSize=512,this._options=l,this.tiles=this._options.tiles,this.maxzoom=l.maxzoom||19,this.minzoom=l.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=d,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(y)}onAdd(g){this.map=g,this.load()}reload(){this.cancelTileJSONRequest();const g=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(g))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(g){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,d=this.map.getWorldview();this._tileJSONRequest=$n(this._options,this.map._requestManager,l,d,(y,N)=>{this._tileJSONRequest=null,this._loaded=!0,y?(l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),d&&d.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${d}`),this.fire(new i.y(y))):N&&(i.l(this,N),N.bounds&&(this.tileBounds=new Rn(N.bounds,this.minzoom,this.maxzoom)),tt(N.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),g&&g(y)})}hasTransition(){return!1}hasTile(g){return!this.tileBounds||this.tileBounds.contains(g.canonical)}loaded(){return this._loaded}loadTile(g,l){const d=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(d,i.R.Tile),data:void 0,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,tileSize:this.tileSize*g.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:g.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(g.actor&&g.state!=="expired")if(g.state==="loading")g.reloadCallback=l;else{if(g.buckets){const j=Object.values(g.buckets);for(const C of j)C.dirty=!0;return void(g.state="loaded")}g.request=g.actor.send("reloadTile",y,N.bind(this))}else g.actor=this.dispatcher.getActor(),g.request=g.actor.send("loadTile",y,N.bind(this),void 0,!0);function N(j,C){return g.aborted?l(null):j&&j.status!==404?l(j):(this.map._refreshExpiredTiles&&C&&g.setExpiryData(C),g.loadModelData(C,this.map.painter),g.state="loaded",void l(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aJ{constructor(g,l,d,y){super(g,l,d,y),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(N=>!Array.isArray(N)||N.length!==2||N.some(j=>typeof j!="number"))||this.fire(new i.y(new i.V(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${g}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${g}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(g){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const l=this.map.painter.context;this.texture?!g&&!this._playing||this.texture instanceof i.aL||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(l,this.canvas,l.gl.RGBA8,{premultiply:!0}),this._prepareData(l)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends i.E{constructor(g,l,d,y){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=l,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Rn(this._implementation.bounds,this.minzoom,this.maxzoom)),l.update=this._update.bind(this),l.clearTiles=this._clearTiles.bind(this),l.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.ay(l,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.ay(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this.map=g,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:l,y:d,z:y}=g.canonical;return this._implementation.hasTile({x:l,y:d,z:y})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,l){const{x:d,y,z:N}=g.tileID.canonical,j=new AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:d,y,z:N},{signal:j.signal})).then((function(C){return delete g.request,g.aborted?(g.state="unloaded",l(null)):C===void 0?(g.state="errored",l(null)):C===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",l(null)):function(F){return F instanceof ImageData||F instanceof HTMLCanvasElement||F instanceof ImageBitmap||F instanceof HTMLImageElement}(C)?(this.loadTileData(g,C),g.state="loaded",void l(null)):(g.state="errored",l(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(C=>{C.code!==20&&(g.state="errored",l(C))}),g.request.cancel=()=>j.abort()}loadTileData(g,l){g.setTexture(l,this.map.painter)}unloadTile(g,l){if(g.texture&&g.texture instanceof i.T?(g.destroy(!0),g.texture&&g.texture instanceof i.T&&this.map.painter.saveTileTexture(g.texture)):g.destroy(),this._implementation.unloadTile){const{x:d,y,z:N}=g.tileID.canonical;this._implementation.unloadTile({x:d,y,z:N})}l&&l()}abortTile(g,l){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),l&&l()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z}))}_clearTiles(){const g=i.aC(this.id,this.scope);this.map.style.clearSource(g)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},vo=function(g,l,d,y){const N=new ls[l.type](g,l,d,y);if(N.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${N.id}`);return i.aP(["load","abort","unload","serialize","prepare"],N),N};function Wu(g,l,d=""){return`${d}:${l.id||""}:${l.layer.id}:${function(y){if("layerId"in y)return`layer:${y.layerId}`;{const{featuresetId:N,importId:j}=y;return`featureset:${N}${j?`:import:${j}`:""}`}}(g.target)}`}function Dl(g,l,d,y=""){if(g.uniqueFeatureID){const N=Wu(g,l,y);if(d.has(N))return!0;d.add(N)}return!1}function iu(g,l,d,y,N=!1){const j=l.sourceCache.transform,C=l.sourceCache.tilesIn(g,l.has3DLayers,N);C.sort(vy);const F=[];for(const W of C){const Z=W.tile.queryRenderedFeatures(l,W,d,y,j,N);Object.keys(Z).length&&F.push({wrappedTileID:W.tile.tileID.wrapped().key,queryResults:Z})}return F.length===0?{}:function(W){const Z={},Y={};for(const re of W){const ne=re.queryResults,oe=re.wrappedTileID,_e=Y[oe]=Y[oe]||{};for(const ge in ne){const Te=ne[ge],Ae=_e[ge]=_e[ge]||{},Re=Z[ge]=Z[ge]||[];for(const qe of Te)Ae[qe.featureIndex]||(Ae[qe.featureIndex]=!0,Re.push(qe))}}return Z}(F)}function sf(g,l,d,y,N){const j={},C=y.queryRenderedSymbols(g),F=[];for(const W of Object.keys(C).map(Number))F.push(N[W]);F.sort(vy);for(const W of F){const Z=W.featureIndex.lookupSymbolFeatures(C[W.bucketInstanceId],W.bucketIndex,W.sourceLayerIndex,l,d);for(const Y in Z){const re=j[Y]=j[Y]||[],ne=Z[Y];ne.sort((oe,_e)=>{const ge=W.featureSortOrder;if(ge){const Te=ge.indexOf(oe.featureIndex);return ge.indexOf(_e.featureIndex)-Te}return _e.featureIndex-oe.featureIndex});for(const oe of ne)re.push(oe)}}return j}function ox(g,l){const d=g.getRenderableIds().map(j=>g.getTileByID(j)),y=[],N={};for(let j=0;j<d.length;j++){const C=d[j],F=C.tileID.canonical.key;N[F]||(N[F]=!0,C.querySourceFeatures(y,l))}return y}function vy(g,l){const d=g.tileID,y=l.tileID;return d.overscaledZ-y.overscaledZ||d.canonical.y-y.canonical.y||d.wrap-y.wrap||d.canonical.x-y.canonical.x}function _p(g,l){const d={};if(!l)return d;for(const y of g){const N=y.layerIds.map(j=>l.getLayer(j)).filter(Boolean);if(N.length!==0){y.layers=N,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(j=>N.filter(C=>C.id===j)[0]));for(const j of N)d[j.fqid]=y}}return d}const to=32,yl=33,xl=new Uint16Array(8184);for(let g=0;g<2046;g++){let l=g+2,d=0,y=0,N=0,j=0,C=0,F=0;for(1&l?N=j=C=to:d=y=F=to;(l>>=1)>1;){const Z=d+N>>1,Y=y+j>>1;1&l?(N=d,j=y,d=C,y=F):(d=N,y=j,N=C,j=F),C=Z,F=Y}const W=4*g;xl[W+0]=d,xl[W+1]=y,xl[W+2]=N,xl[W+3]=j}const kc=new Uint16Array(2178),vl=new Uint8Array(1089),xi=new Uint16Array(1089);function bp(g){return g===0?-.03125:g===32?.03125:0}const zm={type:2,extent:i.ag,loadGeometry:()=>[[new i.P(0,0),new i.P(i.ag+1,0),new i.P(i.ag+1,i.ag+1),new i.P(0,i.ag+1),new i.P(0,0)]]};class Pc{constructor(l,d,y,N,j){this.tileID=l,this.uid=i.aV(),this.uses=0,this.tileSize=d,this.tileZoom=y,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=j,N&&N.style&&(this._lastUpdatedBrightness=N.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",N&&N.transform&&(this.projection=N.transform.projection)}registerFadeDuration(l){const d=l+this.timeAdded;d<i.q.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aQ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(l,d,y){if(this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=_p(l.buckets,d.style),this.hasSymbolBuckets=!1;for(const N in this.buckets){const j=this.buckets[N];if(j instanceof i.aX){if(this.hasSymbolBuckets=!0,!y)break;j.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const N in this.buckets){const j=this.buckets[N];if(j instanceof i.aX&&j.hasRTLText){this.hasRTLText=!0,i.aY();break}}this.queryPadding=0;for(const N in this.buckets){const j=this.buckets[N],C=d.style.getOwnLayer(N);if(!C)continue;const F=C.queryRadius(j);this.queryPadding=Math.max(this.queryPadding,F)}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage),l.lineAtlas&&(this.lineAtlas=l.lineAtlas),this._lastUpdatedBrightness=l.brightness}else this.collisionBoxArray=new i.aW}unloadVectorData(){if(this.hasData()){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(l,d,y){l&&(l.resourceTiming&&(this.resourceTiming=l.resourceTiming),this.buckets=Object.assign({},this.buckets,_p(l.buckets,d.style)),l.featureIndex&&(this.latestFeatureIndex=l.featureIndex))}getBucket(l){return this.buckets[l.fqid]}upload(l){for(const N in this.buckets){const j=this.buckets[N];j.uploadPending()&&j.upload(l)}const d=l.gl,y=this.imageAtlas;if(y&&!y.uploaded){const N=!!Object.keys(y.patternPositions).length;this.imageAtlasTexture=new i.T(l,y.image,d.RGBA8,{useMipmap:N}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(l,this.glyphAtlasImage,d.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(l,this.lineAtlas.image,d.R8),this.lineAtlas.uploaded=!0)}prepare(l,d,y){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture,y),!d||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const N=d.style.getBrightness();(this._lastUpdatedBrightness||N)&&(this._lastUpdatedBrightness&&N&&Math.abs(this._lastUpdatedBrightness-N)<.001||(this.updateBuckets(d,this._lastUpdatedBrightness!==N),this._lastUpdatedBrightness=N))}queryRenderedFeatures(l,d,y,N,j,C){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const F=function(W,Z){const Y=i.ab.mat4.fromScaling([],[.5*W.width,.5*-W.height,1]);return i.ab.mat4.translate(Y,Y,[1,-1,0]),i.ab.mat4.multiply(Y,Y,W.calculateProjMatrix(Z.toUnwrapped())),Float32Array.from(Y)}(j,this.tileID);return this.latestFeatureIndex.query(l,{tilespaceGeometry:d,pixelPosMatrix:F,transform:N,availableImages:y,tileTransform:this.tileTransform})}querySourceFeatures(l,d){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const N=y.loadVTLayers(),j=d?d.sourceLayer:"",C=N._geojsonTileLayer||N[j];if(!C)return;const F=i.aZ(d&&d.filter),{z:W,x:Z,y:Y}=this.tileID.canonical,re={z:W,x:Z,y:Y};for(let ne=0;ne<C.length;ne++){const oe=C.feature(ne);if(F.needGeometry){const Te=i.a_(oe,!0);if(!F.filter(new i.a8(this.tileID.overscaledZ),Te,this.tileID.canonical))continue}else if(!F.filter(new i.a8(this.tileID.overscaledZ),oe))continue;const _e=y.getId(oe,j),ge=new i.a$(oe,W,Z,Y,_e);ge.tile=re,l.push(ge)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const d=this.expirationTime;if(l.cacheControl){const y=i.b0(l.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const y=Date.now();let N=!1;if(this.expirationTime>y)N=!1;else if(d)if(this.expirationTime<d)N=!0;else{const j=this.expirationTime-d;j?this.expirationTime=y+Math.max(j,3e4):N=!0}else N=!0;N?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(l){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&l&&this.updateBuckets(l)}updateBuckets(l,d){if(!this.latestFeatureIndex||!l.style)return;const y=this.latestFeatureIndex.loadVTLayers(),N=l.style.listImages(),j=l.style.getBrightness();for(const C in this.buckets){if(!l.style.hasLayer(C))continue;const F=this.buckets[C],W=F.layers[0],Z=W.sourceLayer||"_geojsonTileLayer",Y=y[Z],re=l.style.getLayerSourceCache(W);let ne={};re&&(ne=re._state.getState(Z,void 0));const oe=this.imageAtlas&&this.imageAtlas.patternPositions||{},_e=Object.keys(ne).length>0&&!d;_e&&!F.stateDependentLayers.length&&!d||F.update(ne,Y,N,oe,_e?F.stateDependentLayers:F.layers,d,j),(F instanceof i.b1||F instanceof i.b2)&&l._terrain&&l._terrain.enabled&&re&&F.programConfigurations.needsUpload&&l._terrain._clearRenderCacheForTile(re.id,this.tileID);const ge=l&&l.style&&l.style.getOwnLayer(C);ge&&(this.queryPadding=Math.max(this.queryPadding,ge.queryRadius(F)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=i.q.now()+l}setTexture(l,d){const y=d.context,N=y.gl;this.texture=this.texture||d.getTileTexture(l.width),this.texture&&this.texture instanceof i.T?this.texture.update(l):(this.texture=new i.T(y,l,N.RGBA8,{useMipmap:!0}),this.texture.bind(N.LINEAR,N.CLAMP_TO_EDGE))}setDependencies(l,d){const y={};for(const N of d)y[N]=!0;this.dependencies[l]=y}hasDependency(l,d){for(const y of l){const N=this.dependencies[y];if(N){for(const j of d)if(N[j])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(l,d){if(!d||d.name==="mercator"||this._tileDebugBuffer)return;const y=i.b3(zm,this.tileID.canonical,this.tileTransform)[0],N=new i.b4,j=new i.b5;for(let C=0;C<y.length;C++){const{x:F,y:W}=y[C];N.emplaceBack(F,W),j.emplaceBack(C)}j.emplaceBack(0),this._tileDebugIndexBuffer=l.createIndexBuffer(j),this._tileDebugBuffer=l.createVertexBuffer(N,i.b6.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,N.length,j.length)}_makeTileBoundsBuffers(l,d){if(this._tileBoundsBuffer||!d||d.name==="mercator")return;const y=i.b3(zm,this.tileID.canonical,this.tileTransform)[0];let N,j;if(this.isRaster){const C=function(F,W){const Z=i.aQ(F,W),Y=Math.pow(2,F.z);for(let Te=0;Te<yl;Te++)for(let Ae=0;Ae<yl;Ae++){const Re=i.aR((F.x+(Ae+bp(Ae))/to)/Y),qe=i.aS((F.y+(Te+bp(Te))/to)/Y),Ue=W.project(Re,qe),Qe=Te*yl+Ae;kc[2*Qe+0]=Math.round((Ue.x*Z.scale-Z.x)*i.ag),kc[2*Qe+1]=Math.round((Ue.y*Z.scale-Z.y)*i.ag)}vl.fill(0),xi.fill(0);for(let Te=2045;Te>=0;Te--){const Ae=4*Te,Re=xl[Ae+0],qe=xl[Ae+1],Ue=xl[Ae+2],Qe=xl[Ae+3],Ke=Re+Ue>>1,Ze=qe+Qe>>1,He=Ke+Ze-qe,Xe=Ze+Re-Ke,at=qe*yl+Re,_t=Qe*yl+Ue,mt=Ze*yl+Ke,kt=Math.hypot((kc[2*at+0]+kc[2*_t+0])/2-kc[2*mt+0],(kc[2*at+1]+kc[2*_t+1])/2-kc[2*mt+1])>=16;vl[mt]=vl[mt]||(kt?1:0),Te<1022&&(vl[mt]=vl[mt]||vl[(qe+Xe>>1)*yl+(Re+He>>1)]||vl[(Qe+Xe>>1)*yl+(Ue+He>>1)])}const re=new i.aT,ne=new i.aU;let oe=0;function _e(Te,Ae){const Re=Ae*yl+Te;return xi[Re]===0&&(re.emplaceBack(kc[2*Re+0],kc[2*Re+1],Te*i.ag/to,Ae*i.ag/to),xi[Re]=++oe),xi[Re]-1}function ge(Te,Ae,Re,qe,Ue,Qe){const Ke=Te+Re>>1,Ze=Ae+qe>>1;if(Math.abs(Te-Ue)+Math.abs(Ae-Qe)>1&&vl[Ze*yl+Ke])ge(Ue,Qe,Te,Ae,Ke,Ze),ge(Re,qe,Ue,Qe,Ke,Ze);else{const He=_e(Te,Ae),Xe=_e(Re,qe),at=_e(Ue,Qe);ne.emplaceBack(He,Xe,at)}}return ge(0,0,to,to,to,0),ge(to,to,0,0,0,to),{vertices:re,indices:ne}}(this.tileID.canonical,d);N=C.vertices,j=C.indices}else{N=new i.aT,j=new i.aU;for(const{x:F,y:W}of y)N.emplaceBack(F,W,0,0);const C=i.b8(N.int16,void 0,4);for(let F=0;F<C.length;F+=3)j.emplaceBack(C[F],C[F+1],C[F+2])}this._tileBoundsBuffer=l.createVertexBuffer(N,i.b9.members),this._tileBoundsIndexBuffer=l.createIndexBuffer(j),this._tileBoundsSegments=i.b7.simpleSegment(0,0,N.length,j.length)}_makeGlobeTileDebugBuffers(l,d){const y=d.projection;if(!y||y.name!=="globe"||d.freezeTileCoverage)return;const N=this.tileID.canonical,j=i.ba(N,d),C=i.bb(j),F=i.ae(d.zoom);let W;F>0&&(W=i.ab.mat4.invert(new Float64Array(16),d.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(l,N,d,C,W,F),this._makeGlobeTileDebugTextBuffer(l,N,d,C,W,F)}_globePoint(l,d,y,N,j,C,F){let W=i.bc(l,d,y);if(C){const Z=1<<y.z,Y=i.at(N.center.lng),re=i.aA(N.center.lat),ne=(y.x+.5)/Z-Y;let oe=0;ne>.5?oe=-1:ne<-.5&&(oe=1);let _e=(l/i.ag+y.x)/Z+oe,ge=(d/i.ag+y.y)/Z;_e=(_e-Y)*N._pixelsPerMercatorPixel+Y,ge=(ge-re)*N._pixelsPerMercatorPixel+re;const Te=[_e*N.worldSize,ge*N.worldSize,0];i.ab.vec3.transformMat4(Te,Te,C),W=i.bd(W,Te,F)}return i.ab.vec3.transformMat4(W,W,j)}_makeGlobeTileDebugBorderBuffer(l,d,y,N,j,C){const F=new i.b4,W=new i.b5,Z=new i.be,Y=(ne,oe,_e,ge,Te)=>{const Ae=(_e-ne)/(Te-1),Re=(ge-oe)/(Te-1),qe=F.length;for(let Ue=0;Ue<Te;Ue++){const Qe=ne+Ue*Ae,Ke=oe+Ue*Re;F.emplaceBack(Qe,Ke);const Ze=this._globePoint(Qe,Ke,d,y,N,j,C);Z.emplaceBack(Ze[0],Ze[1],Ze[2]),W.emplaceBack(qe+Ue)}},re=i.ag;Y(0,0,re,0,16),Y(re,0,re,re,16),Y(re,re,0,re,16),Y(0,re,0,0,16),this._tileDebugIndexBuffer=l.createIndexBuffer(W),this._tileDebugBuffer=l.createVertexBuffer(F,i.b6.members),this._globeTileDebugBorderBuffer=l.createVertexBuffer(Z,i.bf.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,F.length,W.length)}_makeGlobeTileDebugTextBuffer(l,d,y,N,j,C){const F=i.ag/4,W=new i.b4,Z=new i.aU,Y=new i.be,re=25;Z.reserve(32),W.reserve(re),Y.reserve(re);const ne=(oe,_e)=>re*oe+_e;for(let oe=0;oe<re;oe++){const _e=oe*F;for(let ge=0;ge<re;ge++){const Te=ge*F;W.emplaceBack(Te,_e);const Ae=this._globePoint(Te,_e,d,y,N,j,C);Y.emplaceBack(Ae[0],Ae[1],Ae[2])}}for(let oe=0;oe<4;oe++)for(let _e=0;_e<4;_e++){const ge=ne(oe,_e),Te=ne(oe,_e+1),Ae=ne(oe+1,_e),Re=ne(oe+1,_e+1);Z.emplaceBack(ge,Te,Ae),Z.emplaceBack(Ae,Te,Re)}this._tileDebugTextIndexBuffer=l.createIndexBuffer(Z),this._tileDebugTextBuffer=l.createVertexBuffer(W,i.b6.members),this._globeTileDebugTextBuffer=l.createVertexBuffer(Y,i.bf.members),this._tileDebugTextSegments=i.b7.simpleSegment(0,0,re,32)}destroy(l=!1){for(const d in this.buckets)this.buckets[d].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!l&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bg.setPbf(i.bh);class au extends Pc{constructor(l,d,y,N,j){super(l,d,y,N,j),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(l,d){const y=d.context,N=y.gl;this.texture=this.texture||d.getTileTexture(l.width),this.texture&&this.texture instanceof i.T?this.texture.update(l,{premultiply:!1}):this.texture=new i.T(y,l,N.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(l=16384,d){const y=this._mrt=new i.bg(30),N=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(l-1)}});return this.entireBuffer=null,this.request=i.bi(N,(j,C,F,W)=>{if(j)d(j);else try{const Z=y.getHeaderLength(C);if(Z>l)return void(this.request=this.fetchHeader(Z,d));y.parseHeader(C),this._isHeaderLoaded=!0;let Y=0;for(const re of Object.values(y.layers))Y=Math.max(Y,re.dataIndex[re.dataIndex.length-1].last_byte);C.byteLength>=Y&&(this.entireBuffer=C),d(null,this.entireBuffer||C,F,W)}catch(Z){d(Z)}}),this.request}fetchBand(l,d,y){const N=this._mrt;if(!this._isHeaderLoaded||!N)return void y(new Error("Tile header is not ready"));const j=this.actor;if(!j)return void y(new Error("Can't fetch tile band without an actor"));let C;const F=(re,ne)=>{C.complete(re,ne),re?y(re):(this.updateTextureDescriptor(l,d),y(null,this.textureDescriptor&&this.textureDescriptor.img))},W=(re,ne)=>{if(re)return y(re);const oe=j.send("decodeRasterArray",{buffer:ne,task:C},F,void 0,!0);this._workQueue.push(()=>{oe&&oe.cancel(),C.cancel()})},Z=N.getLayer(l);if(!Z)return void y(new Error(`Unknown sourceLayer "${l}"`));if(Z.hasDataForBand(d))return this.updateTextureDescriptor(l,d),void y(null,this.textureDescriptor?this.textureDescriptor.img:null);const Y=Z.getDataRange([d]);if(C=N.createDecodingTask(Y),!C||C.tasks.length)if(this.flushQueues(),this.entireBuffer)W(null,this.entireBuffer.slice(Y.firstByte,Y.lastByte+1));else{const re=Object.assign({},this.requestParams,{headers:{Range:`bytes=${Y.firstByte}-${Y.lastByte}`}}),ne=i.bi(re,W);this._fetchQueue.push(()=>{ne.cancel(),C.cancel()})}else y(null)}updateNeeded(l,d){return(!this.textureDescriptor||this.textureDescriptor.band!==d||this.textureDescriptor.layer!==l)&&this.state!=="errored"}updateTextureDescriptor(l,d){if(!this._mrt)return;const y=this._mrt.getLayer(l);if(!y||!y.hasBand(d)||!y.hasDataForBand(d))return;const{bytes:N,tileSize:j,buffer:C,offset:F,scale:W}=y.getBandView(d),Z=j+2*C,Y={data:N,width:Z,height:Z},re=this.texture;re&&re instanceof i.T&&re.update(Y,{premultiply:!1}),this.textureDescriptor={layer:l,band:d,img:Y,buffer:C,offset:F,tileSize:j,format:y.pixelFormat,mix:[W,256*W,65536*W,16777216*W]}}}class _y{constructor(l,d){this.max=l,this.onRemove=d,this.reset()}reset(){for(const l in this.data)for(const d of this.data[l])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(l,d,y){const N=l.wrapped().key;this.data[N]===void 0&&(this.data[N]=[]);const j={value:d,timeout:void 0};if(y!==void 0&&(j.timeout=setTimeout(()=>{this.remove(l,j)},y)),this.data[N].push(j),this.order.push(N),this.order.length>this.max){const C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const d=this.data[l].shift();return d.timeout&&clearTimeout(d.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),d.value}getByKey(l){const d=this.data[l];return d?d[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,d){if(!this.has(l))return this;const y=l.wrapped().key,N=d===void 0?0:this.data[y].indexOf(d),j=this.data[y][N];return this.data[y].splice(N,1),j.timeout&&clearTimeout(j.timeout),this.data[y].length===0&&delete this.data[y],this.onRemove(j.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(l){const d=[];for(const y in this.data)for(const N of this.data[y])l(N.value)||d.push(N);for(const y of d)this.remove(y.value.tileID,y)}}class Bm{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,d,y){const N=String(d);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][N]=this.stateChanges[l][N]||{},i.l(this.stateChanges[l][N],y),this.deletedStates[l]===null){this.deletedStates[l]={};for(const j in this.state[l])j!==N&&(this.deletedStates[l][j]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][N]===null){this.deletedStates[l][N]={};for(const j in this.state[l][N])y[j]||(this.deletedStates[l][N][j]=null)}else for(const j in y)this.deletedStates[l]&&this.deletedStates[l][N]&&this.deletedStates[l][N][j]===null&&delete this.deletedStates[l][N][j]}removeFeatureState(l,d,y){if(this.deletedStates[l]===null)return;const N=String(d);if(this.deletedStates[l]=this.deletedStates[l]||{},y&&d!==void 0)this.deletedStates[l][N]!==null&&(this.deletedStates[l][N]=this.deletedStates[l][N]||{},this.deletedStates[l][N][y]=null);else if(d!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][N])for(y in this.deletedStates[l][N]={},this.stateChanges[l][N])this.deletedStates[l][N][y]=null;else this.deletedStates[l][N]=null;else this.deletedStates[l]=null}getState(l,d){const y=this.state[l]||{},N=this.stateChanges[l]||{},j=this.deletedStates[l];if(j===null)return{};if(d!==void 0){const F=String(d),W=i.l({},y[F],N[F]);if(j){const Z=j[d];if(Z===null)return{};for(const Y in Z)delete W[Y]}return W}const C=i.l({},y,N);if(j)for(const F in j)delete C[F];return C}initializeTileState(l,d){l.refreshFeatureState(d)}coalesceChanges(l,d){const y={};for(const N in this.stateChanges){this.state[N]=this.state[N]||{};const j={};for(const C in this.stateChanges[N])this.state[N][C]||(this.state[N][C]={}),i.l(this.state[N][C],this.stateChanges[N][C]),j[C]=this.state[N][C];y[N]=j}for(const N in this.deletedStates){this.state[N]=this.state[N]||{};const j={};if(this.deletedStates[N]===null)for(const C in this.state[N])j[C]={},this.state[N][C]={};else for(const C in this.deletedStates[N]){if(this.deletedStates[N][C]===null)this.state[N][C]={};else if(this.state[N][C])for(const F of Object.keys(this.deletedStates[N][C]))delete this.state[N][C][F];j[C]=this.state[N][C]}y[N]=y[N]||{},i.l(y[N],j)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(const N in l)l[N].refreshFeatureState(d)}}class Zo extends i.E{constructor(l,d,y){super(),this.id=l,this._onlySymbols=y,d.on("data",N=>{N.dataType==="source"&&N.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&N.dataType==="source"&&N.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),d.on("error",()=>{this._sourceErrored=!0}),this._source=d,this._tiles={},this._cache=new _y(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Bm,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(l){this.map=l,this._minTileCacheSize=this._minTileCacheSize===void 0&&l?l._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&l?l._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const l in this._tiles){const d=this._tiles[l];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(l,d){return l.isSymbolTile=this._onlySymbols,l.isExtraShadowCaster=this._shadowCasterTiles[l.tileID.key],this._source.loadTile(l,d)}_unloadTile(l){if(this._source.unloadTile)return this._source.unloadTile(l)}_abortTile(l){if(this._source.abortTile)return this._source.abortTile(l)}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const y=this._tiles[d];y.upload(l),y.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return i.bj(this._tiles).map(l=>l.tileID).sort(Xn).map(l=>l.key)}getRenderableIds(l,d){const y=[];for(const N in this._tiles)this._isIdRenderable(+N,l,d)&&y.push(this._tiles[N]);return l?y.sort((N,j)=>{const C=N.tileID,F=j.tileID,W=new i.P(C.canonical.x,C.canonical.y)._rotate(this.transform.angle),Z=new i.P(F.canonical.x,F.canonical.y)._rotate(this.transform.angle);return C.overscaledZ-F.overscaledZ||Z.y-W.y||Z.x-W.x}).map(N=>N.tileID.key):y.map(N=>N.tileID).sort(Xn).map(N=>N.key)}hasRenderableParent(l){const d=this.findLoadedParent(l,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(l,d,y){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(d||!this._tiles[l].holdingForFade())&&(y||!this._shadowCasterTiles[l])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(+l,"reloading")}}_reloadTile(l,d){const y=this._tiles[l];y&&(y.state!=="loading"&&(y.state=d),this._loadTile(y,this._tileLoaded.bind(this,y,l,d)))}_tileLoaded(l,d,y,N){if(N)if(l.state="errored",N.status!==404)this._source.fire(new i.y(N,{tile:l}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:l})),!(l.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const j=this.map.painter.terrain;this.update(this.transform,j.getScaledDemTileSize(),!0),j.resetTileLookupCache(this.id)}else this.update(this.transform)}else l.timeAdded=i.q.now(),y==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(d,l),this._source.type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),this._source.fire(new i.z("data",{dataType:"source",tile:l,coord:l.tileID,sourceCacheId:this.id}))}_backfillDEM(l){const d=this.getRenderableIds();for(let N=0;N<d.length;N++){const j=d[N];if(l.neighboringTiles&&l.neighboringTiles[j]){const C=this.getTileByID(j);y(l,C),y(C,l)}}function y(N,j){if(!N.dem||N.dem.borderReady)return;N.needsHillshadePrepare=!0,N.needsDEMTextureUpload=!0;let C=j.tileID.canonical.x-N.tileID.canonical.x;const F=j.tileID.canonical.y-N.tileID.canonical.y,W=Math.pow(2,N.tileID.canonical.z),Z=j.tileID.key;C===0&&F===0||Math.abs(F)>1||(Math.abs(C)>1&&(Math.abs(C+W)===1?C+=W:Math.abs(C-W)===1&&(C-=W)),j.dem&&N.dem&&(N.dem.backfillBorder(j.dem,C,F),N.neighboringTiles&&N.neighboringTiles[Z]&&(N.neighboringTiles[Z].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,d,y,N){for(const j in this._tiles){let C=this._tiles[j];if(N[j]||!C.hasData()||C.tileID.overscaledZ<=d||C.tileID.overscaledZ>y)continue;let F=C.tileID;for(;C&&C.tileID.overscaledZ>d+1;){const Z=C.tileID.scaledTo(C.tileID.overscaledZ-1);C=this._tiles[Z.key],C&&C.hasData()&&(F=Z)}let W=F;for(;W.overscaledZ>d;)if(W=W.scaledTo(W.overscaledZ-1),l[W.key]){N[F.key]=F;break}}}findLoadedParent(l,d){if(l.key in this._loadedParentTiles){const y=this._loadedParentTiles[l.key];return y&&y.tileID.overscaledZ>=d?y:null}for(let y=l.overscaledZ-1;y>=d;y--){const N=l.scaledTo(y),j=this._getLoadedTile(N);if(j)return j}}_getLoadedTile(l){const d=this._tiles[l.key];return d&&d.hasData()?d:this._cache.getByKey(this._source.reparseOverscaled?l.wrapped().key:l.canonical.key)}updateCacheSize(l,d){d=d||this._source.tileSize;const y=Math.ceil(l.width/d)+1,N=Math.ceil(l.height/d)+1,j=Math.floor(y*N*5),C=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,j):j,F=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(F)}handleWrapJump(l){const d=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,d){const y={};for(const N in this._tiles){const j=this._tiles[N];j.tileID=j.tileID.unwrapTo(j.tileID.wrap+d),y[j.tileID.key]=j}this._tiles=y;for(const N in this._timers)clearTimeout(this._timers[N]),delete this._timers[N];for(const N in this._tiles)this._setTileReloadTimer(+N,this._tiles[N])}}update(l,d,y,N){if(this.transform=l,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!y)return;this.updateCacheSize(l,d),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const j=this._source.type==="batched-model";let C,F=this._source.maxzoom;const W=this.map&&this.map.painter?this.map.painter._terrain:null;if(W&&W.sourceCache===this&&W.attenuationRange()){const re=W.attenuationRange()[0],ne=Math.floor(re)-Math.log2(W.getDemUpscale());F>ne&&(F=ne)}if(this.used||this.usedForTerrain){if(this._source.tileID)C=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(re=>new i.aG(re.canonical.z,re.wrap,re.canonical.z,re.canonical.x,re.canonical.y));else if(this.tileCoverLift!==0){const re=l.clone();re.tileCoverLift=this.tileCoverLift,C=re.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:F,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:j}),this._source.minzoom<=1&&l.projection.name==="globe"&&(C.push(new i.aG(1,0,1,0,0)),C.push(new i.aG(1,0,1,1,0)),C.push(new i.aG(1,0,1,0,1)),C.push(new i.aG(1,0,1,1,1)))}else if(C=l.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:F,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:j}),this._source.hasTile){const re=this._source.hasTile.bind(this._source);C=C.filter(ne=>re(ne))}}else C=[];if(C.length>0&&this.castsShadows&&N&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Cc(this._source.type)){const re=l.coveringZoomLevel({tileSize:d||this._source.tileSize,roundZoom:this._source.roundZoom&&!y}),ne=Math.min(re,this._source.maxzoom);if(j){const oe=l.extendTileCover(C,ne);for(const _e of oe)C.push(_e)}else{const oe=l.extendTileCover(C,ne,N);for(const _e of oe)this._shadowCasterTiles[_e.key]=!0,C.push(_e)}}const Z=this._updateRetainedTiles(C);if(Cc(this._source.type)&&C.length!==0){const re={},ne={},oe=Object.keys(Z);for(const ge of oe){const Te=Z[ge],Ae=this._tiles[ge];if(!Ae||Ae.fadeEndTime&&Ae.fadeEndTime<=i.q.now())continue;const Re=this.findLoadedParent(Te,Math.max(Te.overscaledZ-Zo.maxOverzooming,this._source.minzoom));Re&&(this._addTile(Re.tileID),re[Re.tileID.key]=Re.tileID),ne[ge]=Te}const _e=C[C.length-1].overscaledZ;for(const ge in this._tiles){const Te=this._tiles[ge];if(Z[ge]||!Te.hasData())continue;let Ae=Te.tileID;for(;Ae.overscaledZ>_e;){Ae=Ae.scaledTo(Ae.overscaledZ-1);const Re=this._tiles[Ae.key];if(Re&&Re.hasData()&&ne[Ae.key]){Z[ge]=Te.tileID;break}}}for(const ge in re)Z[ge]||(this._coveredTiles[ge]=!0,Z[ge]=re[ge])}for(const re in Z)this._tiles[re].clearFadeHold();const Y=i.bk(this._tiles,Z);for(const re of Y){const ne=this._tiles[re];ne.hasSymbolBuckets&&!ne.holdingForFade()?ne.setHoldDuration(this.map._fadeDuration):ne.hasSymbolBuckets&&!ne.symbolFadeFinished()||this._removeTile(+re)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(+l)}_updateRetainedTiles(l){const d={};if(l.length===0)return d;const y={},N=l.reduce((Z,Y)=>Math.min(Z,Y.overscaledZ),1/0),j=l[0].overscaledZ,C=Math.max(j-Zo.maxOverzooming,this._source.minzoom),F=Math.max(j+Zo.maxUnderzooming,this._source.minzoom),W={};for(const Z of l){const Y=this._addTile(Z);d[Z.key]=Z,Y.hasData()||N<this._source.maxzoom&&(W[Z.key]=Z)}this._retainLoadedChildren(W,N,F,d);for(const Z of l){let Y=this._tiles[Z.key];if(Y.hasData())continue;if(Z.canonical.z>=this._source.maxzoom){const ne=Z.children(this._source.maxzoom)[0],oe=this.getTile(ne);if(oe&&oe.hasData()){d[ne.key]=ne;continue}}else{const ne=Z.children(this._source.maxzoom);if(d[ne[0].key]&&d[ne[1].key]&&d[ne[2].key]&&d[ne[3].key])continue}let re=Y.wasRequested();for(let ne=Z.overscaledZ-1;ne>=C;--ne){const oe=Z.scaledTo(ne);if(y[oe.key]||(y[oe.key]=!0,Y=this.getTile(oe),!Y&&re&&(Y=this._addTile(oe)),Y&&(d[oe.key]=oe,re=Y.wasRequested(),Y.hasData())))break}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const d=[];let y,N=this._tiles[l].tileID;for(;N.overscaledZ>0;){if(N.key in this._loadedParentTiles){y=this._loadedParentTiles[N.key];break}d.push(N.key);const j=N.scaledTo(N.overscaledZ-1);if(y=this._getLoadedTile(j),y)break;N=j}for(const j of d)this._loadedParentTiles[j]=y}}_addTile(l){let d=this._tiles[l.key];if(d)return d.isExtraShadowCaster!==!0||this._shadowCasterTiles[l.key]||this._reloadTile(l.key,"reloading"),d;d=this._cache.getAndRemove(l),d&&(this._setTileReloadTimer(l.key,d),d.tileID=l,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,d)));const y=!!d;if(!y){const N=this.map?this.map.painter:null,j=this._source.tileSize*l.overscaleFactor();d=this._source.type==="raster-array"?new au(l,j,this.transform.tileZoom,N,this._isRaster):new Pc(l,j,this.transform.tileZoom,N,this._isRaster),this._loadTile(d,this._tileLoaded.bind(this,d,l.key,d.state))}return d?(d.uses++,this._tiles[l.key]=d,y||this._source.fire(new i.z("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d):null}_setTileReloadTimer(l,d){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const y=d.getExpiryTimeout();y&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},y))}_removeTile(l){const d=this._tiles[l];d&&(d.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),d.uses>0||(d.hasData()&&d.state!=="reloading"||d.state==="empty"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(+l);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(l,d,y){const N=[],j=this.transform;if(!j)return N;const C=j.projection.name==="globe",F=i.at(j.center.lng);for(const W in this._tiles){const Z=this._tiles[W];if(y&&Z.clearQueryDebugViz(),Z.holdingForFade())continue;let Y;if(C){const re=Z.tileID.canonical;if(re.z===0){const ne=[Math.abs(i.aw(F,...Fr(re,-1))-F),Math.abs(i.aw(F,...Fr(re,1))-F)];Y=[0,2*ne.indexOf(Math.min(...ne))-1]}else{const ne=[Math.abs(i.aw(F,...Fr(re,-1))-F),Math.abs(i.aw(F,...Fr(re,0))-F),Math.abs(i.aw(F,...Fr(re,1))-F)];Y=[ne.indexOf(Math.min(...ne))-1]}}else Y=[0];for(const re of Y){const ne=l.containsTile(Z,j,d,re);ne&&N.push(ne)}}return N}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(l){return this._getRenderableCoordinates(l)}_getRenderableCoordinates(l,d){const y=this.getRenderableIds(l,d).map(j=>this._tiles[j].tileID),N=this.transform.projection.name==="globe";for(const j of y)j.projMatrix=this.transform.calculateProjMatrix(j.toUnwrapped()),j.expandedProjMatrix=N?this.transform.calculateProjMatrix(j.toUnwrapped(),!1,!0):j.projMatrix;return y}sortCoordinatesByDistance(l){const d=l.slice(),y=this.transform._camera.position,N=this.transform._camera.forward(),j={};for(const C of d){const F=1/(1<<C.canonical.z);j[C.key]=((C.canonical.x+.5)*F+C.wrap-y[0])*N[0]+((C.canonical.y+.5)*F-y[1])*N[1]-y[2]*N[2]}return d.sort((C,F)=>j[C.key]-j[F.key]),d}hasTransition(){if(this._source.hasTransition())return!0;if(Cc(this._source.type))for(const l in this._tiles){const d=this._tiles[l];if(d.fadeEndTime!==void 0&&d.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(l,d,y){this._state.updateState(l=l||"_geojsonTileLayer",d,y)}removeFeatureState(l,d,y){this._state.removeFeatureState(l=l||"_geojsonTileLayer",d,y)}getFeatureState(l,d){return this._state.getState(l=l||"_geojsonTileLayer",d)}setDependencies(l,d,y){const N=this._tiles[l];N&&N.setDependencies(d,y)}reloadTilesForDependencies(l,d){for(const y in this._tiles)this._tiles[y].hasDependency(l,d)&&this._reloadTile(+y,"reloading");this._cache.filter(y=>!y.hasDependency(l,d))}_preloadTiles(l,d){if(!this._sourceLoaded){const W=()=>{this._sourceLoaded&&(this._source.off("data",W),this._preloadTiles(l,d))};return void this._source.on("data",W)}const y=new Map,N=Array.isArray(l)?l:[l],j=this.map.painter.terrain,C=this.usedForTerrain&&j?j.getScaledDemTileSize():this._source.tileSize;for(const W of N){const Z=W.coveringTiles({tileSize:C,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const Y of Z)y.set(Y.key,Y);this.usedForTerrain&&W.updateElevation(!1)}const F=Array.from(y.values());i.bl(F,(W,Z)=>{const Y=new Pc(W,this._source.tileSize*W.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(Y,re=>{this._source.type==="raster-dem"&&Y.dem&&this._backfillDEM(Y),Z(re,Y)})},d)}}function Xn(g,l){const d=Math.abs(2*g.wrap)-+(g.wrap<0),y=Math.abs(2*l.wrap)-+(l.wrap<0);return g.overscaledZ-l.overscaledZ||y-d||l.canonical.y-g.canonical.y||l.canonical.x-g.canonical.x}function Cc(g){return g==="raster"||g==="image"||g==="video"||g==="custom"}function Fr(g,l){const d=1<<g.z;return[g.x/d+l,(g.x+1)/d+l]}Zo.maxOverzooming=10,Zo.maxUnderzooming=3;class su{constructor(l){this.style=l,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const l=!1,d=!1;for(const y in this.style._mergedLayers){const N=this.style._mergedLayers[y];if(N.type==="fill-extrusion")this.layers.push({layer:N,visible:l,visibilityChanged:d});else if(N.type==="model"){const j=this.style.getLayerSource(N);j&&j.type==="batched-model"&&this.layers.push({layer:N,visible:l,visibilityChanged:d})}}}onNewFrame(l){this.layersGotHidden=!1;for(const d of this.layers){const y=d.layer;let N=!1;y.type==="fill-extrusion"?N=!y.isHidden(l)&&y.paint.get("fill-extrusion-opacity")>0:y.type==="model"&&(N=!y.isHidden(l)&&y.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!N&&d.visible,d.visible=N}}updateZOffset(l,d){this.currentBuildingBuckets=[];for(const N of this.layers){const j=N.layer,C=this.style.getLayerSourceCache(j);let F=1;j.type==="fill-extrusion"&&(F=N.visible?j.paint.get("fill-extrusion-vertical-scale"):0);let W=C?C.getTile(d):null;if(!W&&C&&d.canonical.z>C.getSource().minzoom){let Z=d.scaledTo(Math.min(C.getSource().maxzoom,d.overscaledZ-1));for(;Z.overscaledZ>=C.getSource().minzoom&&(W=C.getTile(Z),!W&&Z.overscaledZ!==0);)Z=Z.scaledTo(Z.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:W?W.getBucket(j):null,tileID:W?W.tileID:d,verticalScale:F})}l.hasAnyZOffset=!1;let y=!1;for(let N=0;N<l.symbolInstances.length;N++){const j=l.symbolInstances.get(N),C=j.zOffset,F=this._getHeightAtTileOffset(d,j.tileAnchorX,j.tileAnchorY);j.zOffset=F!==Number.NEGATIVE_INFINITY?F:C,y||C===j.zOffset||(y=!0),l.hasAnyZOffset||j.zOffset===0||(l.hasAnyZOffset=!0)}y&&(l.zOffsetBuffersNeedUpload=!0,l.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(l,d,y,N){let j=d,C=y;if(l.canonical.z!==N.canonical.z){const F=N.canonical,W=1/(1<<l.canonical.z-F.z);j=(d+l.canonical.x*i.ag)*W-F.x*i.ag|0,C=(y+l.canonical.y*i.ag)*W-F.y*i.ag|0}return{tileX:j,tileY:C}}_getHeightAtTileOffset(l,d,y){let N,j;for(let C=0;C<this.layers.length;++C){if(this.layers[C].layer.type!=="fill-extrusion")continue;const{bucket:F,tileID:W,verticalScale:Z}=this.currentBuildingBuckets[C];if(!F)continue;const{tileX:Y,tileY:re}=this._mapCoordToOverlappingTile(l,d,y,W),ne=F.getHeightAtTileCoord(Y,re);ne&&ne.height!==void 0&&(ne.hidden?N=ne.height:j=Math.max(ne.height*Z,j||0))}if(j!==void 0)return j;for(let C=0;C<this.layers.length;++C){const F=this.layers[C];if(F.layer.type!=="model"||!F.visible)continue;const{bucket:W,tileID:Z}=this.currentBuildingBuckets[C];if(!W)continue;const{tileX:Y,tileY:re}=this._mapCoordToOverlappingTile(l,d,y,Z),ne=W.getHeightAtTileCoord(Y,re);if(ne&&!ne.hidden)return ne.height===void 0&&N!==void 0?Math.min(ne.maxHeight,N)*ne.verticalScale:ne.height?ne.height*ne.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Hu(g,l){const d={};for(const y in g)y!=="ref"&&(d[y]=g[y]);return i.bm.forEach(y=>{y in l&&(d[y]=l[y])}),d}function Ku(g){g=g.slice();const l=Object.create(null);for(let d=0;d<g.length;d++)l[g[d].id]=g[d];for(let d=0;d<g.length;d++)"ref"in g[d]&&(g[d]=Hu(g[d],l[g[d].ref]));return g}const xn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Vm(g,l,d){d.push({command:xn.addSource,args:[g,l[g]]})}function Zu(g,l,d){l.push({command:xn.removeSource,args:[g]}),d[g]=!0}function br(g,l,d,y){Zu(g,d,y),Vm(g,l,d)}function mi(g,l,d){let y;for(y in g[d])if(g[d].hasOwnProperty(y)&&y!=="data"&&!i.bn(g[d][y],l[d][y]))return!1;for(y in l[d])if(l[d].hasOwnProperty(y)&&y!=="data"&&!i.bn(g[d][y],l[d][y]))return!1;return!0}function Wn(g,l,d,y,N,j){let C;for(C in l=l||{},g=g||{})g.hasOwnProperty(C)&&(i.bn(g[C],l[C])||d.push({command:j,args:[y,C,l[C],N]}));for(C in l)l.hasOwnProperty(C)&&!g.hasOwnProperty(C)&&(i.bn(g[C],l[C])||d.push({command:j,args:[y,C,l[C],N]}))}function xs(g){return g.id}function Ec(g,l){return g[l.id]=l,g}class ii{constructor(l,d){this.reset(l,d)}reset(l,d){this.points=l||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=i.aw(l,0,1);let d=1,y=this._distances[d];const N=l*this.paddedLength+this.padding;for(;y<N&&d<this._distances.length;)y=this._distances[++d];const j=d-1,C=this._distances[j],F=y-C,W=F>0?(N-C)/F:0;return this.points[j].mult(1-W).add(this.points[d].mult(W))}}class ou{constructor(l,d,y){const N=this.boxCells=[],j=this.circleCells=[];this.xCellCount=Math.ceil(l/y),this.yCellCount=Math.ceil(d/y);for(let C=0;C<this.xCellCount*this.yCellCount;C++)N.push([]),j.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=d,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,d,y,N,j){this._forEachCell(d,y,N,j,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(d),this.bboxes.push(y),this.bboxes.push(N),this.bboxes.push(j)}insertCircle(l,d,y,N){this._forEachCell(d-N,y-N,d+N,y+N,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(d),this.circles.push(y),this.circles.push(N)}_insertBoxCell(l,d,y,N,j,C){this.boxCells[j].push(C)}_insertCircleCell(l,d,y,N,j,C){this.circleCells[j].push(C)}_query(l,d,y,N,j,C){if(y<0||l>this.width||N<0||d>this.height)return!j&&[];const F=[];if(l<=0&&d<=0&&this.width<=y&&this.height<=N){if(j)return!0;for(let W=0;W<this.boxKeys.length;W++)F.push({key:this.boxKeys[W],x1:this.bboxes[4*W],y1:this.bboxes[4*W+1],x2:this.bboxes[4*W+2],y2:this.bboxes[4*W+3]});for(let W=0;W<this.circleKeys.length;W++){const Z=this.circles[3*W],Y=this.circles[3*W+1],re=this.circles[3*W+2];F.push({key:this.circleKeys[W],x1:Z-re,y1:Y-re,x2:Z+re,y2:Y+re})}return C?F.filter(C):F}return this._forEachCell(l,d,y,N,this._queryCell,F,{hitTest:j,seenUids:{box:{},circle:{}}},C),j?F.length>0:F}_queryCircle(l,d,y,N,j){const C=l-y,F=l+y,W=d-y,Z=d+y;if(F<0||C>this.width||Z<0||W>this.height)return!N&&[];const Y=[];return this._forEachCell(C,W,F,Z,this._queryCellCircle,Y,{hitTest:N,circle:{x:l,y:d,radius:y},seenUids:{box:{},circle:{}}},j),N?Y.length>0:Y}query(l,d,y,N,j){return this._query(l,d,y,N,!1,j)}hitTest(l,d,y,N,j){return this._query(l,d,y,N,!0,j)}hitTestCircle(l,d,y,N){return this._queryCircle(l,d,y,!0,N)}_queryCell(l,d,y,N,j,C,F,W){const Z=F.seenUids,Y=this.boxCells[j];if(Y!==null){const ne=this.bboxes;for(const oe of Y)if(!Z.box[oe]){Z.box[oe]=!0;const _e=4*oe;if(l<=ne[_e+2]&&d<=ne[_e+3]&&y>=ne[_e+0]&&N>=ne[_e+1]&&(!W||W(this.boxKeys[oe]))){if(F.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[oe],x1:ne[_e],y1:ne[_e+1],x2:ne[_e+2],y2:ne[_e+3]})}}}const re=this.circleCells[j];if(re!==null){const ne=this.circles;for(const oe of re)if(!Z.circle[oe]){Z.circle[oe]=!0;const _e=3*oe;if(this._circleAndRectCollide(ne[_e],ne[_e+1],ne[_e+2],l,d,y,N)&&(!W||W(this.circleKeys[oe]))){if(F.hitTest)return C.push(!0),!0;{const ge=ne[_e],Te=ne[_e+1],Ae=ne[_e+2];C.push({key:this.circleKeys[oe],x1:ge-Ae,y1:Te-Ae,x2:ge+Ae,y2:Te+Ae})}}}}}_queryCellCircle(l,d,y,N,j,C,F,W){const Z=F.circle,Y=F.seenUids,re=this.boxCells[j];if(re!==null){const oe=this.bboxes;for(const _e of re)if(!Y.box[_e]){Y.box[_e]=!0;const ge=4*_e;if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,oe[ge+0],oe[ge+1],oe[ge+2],oe[ge+3])&&(!W||W(this.boxKeys[_e])))return C.push(!0),!0}}const ne=this.circleCells[j];if(ne!==null){const oe=this.circles;for(const _e of ne)if(!Y.circle[_e]){Y.circle[_e]=!0;const ge=3*_e;if(this._circlesCollide(oe[ge],oe[ge+1],oe[ge+2],Z.x,Z.y,Z.radius)&&(!W||W(this.circleKeys[_e])))return C.push(!0),!0}}}_forEachCell(l,d,y,N,j,C,F,W){const Z=this._convertToXCellCoord(l),Y=this._convertToYCellCoord(d),re=this._convertToXCellCoord(y),ne=this._convertToYCellCoord(N);for(let oe=Z;oe<=re;oe++)for(let _e=Y;_e<=ne;_e++)if(j.call(this,l,d,y,N,this.xCellCount*_e+oe,C,F,W))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,d,y,N,j,C){const F=N-l,W=j-d,Z=y+C;return Z*Z>F*F+W*W}_circleAndRectCollide(l,d,y,N,j,C,F){const W=(C-N)/2,Z=Math.abs(l-(N+W));if(Z>W+y)return!1;const Y=(F-j)/2,re=Math.abs(d-(j+Y));if(re>Y+y)return!1;if(Z<=W||re<=Y)return!0;const ne=Z-W,oe=re-Y;return ne*ne+oe*oe<=y*y}}const Yo={unknown:0,flipRequired:1,flipNotRequired:2},Mc=Math.tan(85*Math.PI/180);function Za(g,l,d,y,N,j,C){const F=i.ab.mat4.create();if(d)if(j.name==="globe"){const W=i.bo(N,l);i.ab.mat4.multiply(F,F,W)}else{const W=i.ab.mat2.invert([],C);F[0]=W[0],F[1]=W[1],F[4]=W[2],F[5]=W[3],y||i.ab.mat4.rotateZ(F,F,N.angle)}else i.ab.mat4.multiply(F,N.labelPlaneMatrix,g);return F}function _a(g,l,d,y,N,j,C){const F=Za(g,l,d,y,N,j,C);return j.name==="globe"&&d||(F[2]=F[6]=F[10]=F[14]=0),F}function by(g,l,d,y,N,j,C){if(d){if(j.name==="globe"){const F=Za(g,l,d,y,N,j,C);return i.ab.mat4.invert(F,F),i.ab.mat4.multiply(F,g,F),F}{const F=i.ab.mat4.clone(g),W=i.ab.mat4.identity([]);return W[0]=C[0],W[1]=C[1],W[4]=C[2],W[5]=C[3],i.ab.mat4.multiply(F,F,W),y||i.ab.mat4.rotateZ(F,F,-N.angle),F}}return N.glCoordMatrix}function ro(g,l,d,y){const N=[g,l,d,1];d?i.ab.vec4.transformMat4(N,N,y):Ra(N,N,y);const j=N[3];return N[0]/=j,N[1]/=j,N[2]/=j,N}function Wd(g,l){return Math.min(.5+g/l*.5,1.5)}function Hd(g,l){const d=g[0]/g[3],y=g[1]/g[3];return d>=-l[0]&&d<=l[0]&&y>=-l[1]&&y<=l[1]}function wp(g,l,d,y,N,j,C,F,W,Z){const Y=d.transform,re=y?g.textSizeData:g.iconSizeData,ne=i.bp(re,d.transform.zoom),oe=Y.projection.name==="globe",_e=[256/d.width*2+1,256/d.height*2+1],ge=y?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;ge.clear();let Te=null;oe&&(Te=y?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const Ae=g.lineVertexArray,Re=y?g.text.placedSymbolArray:g.icon.placedSymbolArray,qe=d.transform.width/d.transform.height;let Ue,Qe=!1;for(let Ke=0;Ke<Re.length;Ke++){const Ze=Re.get(Ke),{numGlyphs:He,writingMode:Xe}=Ze;if(Xe!==i.bq.vertical||Qe||Ue===i.bq.horizontal||(Qe=!0),Ue=Xe,(Ze.hidden||Xe===i.bq.vertical)&&!Qe){oa(He,ge);continue}Qe=!1;const at=new i.P(Ze.tileAnchorX,Ze.tileAnchorY);let{x:_t,y:mt,z:kt}=Y.projection.projectTilePoint(at.x,at.y,Z.canonical);if(W){const[It,Ht,tr]=W(at);_t+=It,mt+=Ht,kt+=tr}const Pt=[_t,mt,kt,1];if(i.ab.vec4.transformMat4(Pt,Pt,l),!Hd(Pt,_e)){oa(He,ge);continue}const ht=Pt[3],Tt=Wd(d.transform.getCameraToCenterDistance(Y.projection),ht),$t=i.br(re,ne,Ze),pt=C?$t/Tt:$t*Tt,Lt=ro(_t,mt,kt,N);if(Lt[3]<=0){oa(He,ge);continue}let jt={};const Xt=C?null:W,Vt=_l(Ze,pt,!1,F,l,N,j,g.glyphOffsetArray,Ae,ge,Te,Lt,at,jt,qe,Xt,Y.projection,Z,C);Qe=Vt.useVertical,Xt&&Vt.needsFlipping&&(jt={}),(Vt.notEnoughRoom||Qe||Vt.needsFlipping&&_l(Ze,pt,!0,F,l,N,j,g.glyphOffsetArray,Ae,ge,Te,Lt,at,jt,qe,Xt,Y.projection,Z,C).notEnoughRoom)&&oa(He,ge)}y?(g.text.dynamicLayoutVertexBuffer.updateData(ge),Te&&g.text.globeExtVertexBuffer&&g.text.globeExtVertexBuffer.updateData(Te)):(g.icon.dynamicLayoutVertexBuffer.updateData(ge),Te&&g.icon.globeExtVertexBuffer&&g.icon.globeExtVertexBuffer.updateData(Te))}function Fl(g,l,d,y,N,j,C,F,W,Z,Y,re,ne,oe,_e,ge){const{lineStartIndex:Te,glyphStartIndex:Ae,segment:Re}=F,qe=Ae+F.numGlyphs,Ue=Te+F.lineLength,Qe=l.getoffsetX(Ae),Ke=l.getoffsetX(qe-1),Ze=zl(g*Qe,d,y,N,j,C,Re,Te,Ue,W,Z,Y,re,ne,!0,oe,_e,ge);if(!Ze)return null;const He=zl(g*Ke,d,y,N,j,C,Re,Te,Ue,W,Z,Y,re,ne,!0,oe,_e,ge);return He?{first:Ze,last:He}:null}function Os(g,l,d,y){return g===i.bq.horizontal&&Math.abs(y)>Math.abs(d)?{useVertical:!0}:g===i.bq.vertical?y>0?{needsFlipping:!0}:null:l!==Yo.unknown&&function(N,j){return N===0||Math.abs(j/N)>Mc}(d,y)?l===Yo.flipRequired?{needsFlipping:!0}:null:d<0?{needsFlipping:!0}:null}function _l(g,l,d,y,N,j,C,F,W,Z,Y,re,ne,oe,_e,ge,Te,Ae,Re){const qe=l/24,Ue=g.lineOffsetX*qe,Qe=g.lineOffsetY*qe,{lineStartIndex:Ke,glyphStartIndex:Ze,numGlyphs:He,segment:Xe,writingMode:at,flipState:_t}=g,mt=Ke+g.lineLength,kt=Pt=>{if(Y){const[pt,Lt,jt]=Pt.up,Xt=Z.length;i.bs(Y,Xt+0,pt,Lt,jt),i.bs(Y,Xt+1,pt,Lt,jt),i.bs(Y,Xt+2,pt,Lt,jt),i.bs(Y,Xt+3,pt,Lt,jt)}const[ht,Tt,$t]=Pt.point;i.bt(Z,ht,Tt,$t,Pt.angle)};if(He>1){const Pt=Fl(qe,F,Ue,Qe,d,re,ne,g,W,j,oe,ge,!1,Te,Ae,Re);if(!Pt)return{notEnoughRoom:!0};if(y&&!d){let[ht,Tt,$t]=Pt.first.point,[pt,Lt,jt]=Pt.last.point;[ht,Tt]=ro(ht,Tt,$t,C),[pt,Lt]=ro(pt,Lt,jt,C);const Xt=Os(at,_t,(pt-ht)*_e,Lt-Tt);if(g.flipState=Xt&&Xt.needsFlipping?Yo.flipRequired:Yo.flipNotRequired,Xt)return Xt}kt(Pt.first);for(let ht=Ze+1;ht<Ze+He-1;ht++){const Tt=zl(qe*F.getoffsetX(ht),Ue,Qe,d,re,ne,Xe,Ke,mt,W,j,oe,ge,!1,!1,Te,Ae,Re);if(!Tt)return Z.length-=4*(ht-Ze),{notEnoughRoom:!0};kt(Tt)}kt(Pt.last)}else{if(y&&!d){const ht=ro(ne.x,ne.y,0,N),Tt=Ke+Xe+1,$t=new i.P(W.getx(Tt),W.gety(Tt)),pt=ro($t.x,$t.y,0,N),Lt=pt[3]>0?pt:of(ne,$t,ht,1,N,void 0,Te,Ae.canonical),jt=Os(at,_t,(Lt[0]-ht[0])*_e,Lt[1]-ht[1]);if(g.flipState=jt&&jt.needsFlipping?Yo.flipRequired:Yo.flipNotRequired,jt)return jt}const Pt=zl(qe*F.getoffsetX(Ze),Ue,Qe,d,re,ne,Xe,Ke,mt,W,j,oe,ge,!1,!1,Te,Ae,Re);if(!Pt)return{notEnoughRoom:!0};kt(Pt)}return{}}function Rs(g,l,d,y,N){const{x:j,y:C,z:F}=y.projectTilePoint(g.x,g.y,l);if(!N)return ro(j,C,F,d);const[W,Z,Y]=N(g);return ro(j+W,C+Z,F+Y,d)}function of(g,l,d,y,N,j,C,F){const W=Rs(g.sub(l)._unit()._add(g),F,N,C,j);return i.ab.vec3.sub(W,d,W),i.ab.vec3.normalize(W,W),i.ab.vec3.scaleAndAdd(W,d,W,y)}function zl(g,l,d,y,N,j,C,F,W,Z,Y,re,ne,oe,_e,ge,Te,Ae){const Re=y?g-l:g+l;let qe=Re>0?1:-1,Ue=0;y&&(qe*=-1,Ue=Math.PI),qe<0&&(Ue+=Math.PI);let Qe=F+C+(qe>0?0:1)|0,Ke=N,Ze=N,He=0,Xe=0;const at=Math.abs(Re),_t=[],mt=[];let kt=j,Pt=kt;const ht=()=>of(Pt,kt,Ze,at-He+1,Y,ne,ge,Te.canonical);for(;He+Xe<=at;){if(Qe+=qe,Qe<F||Qe>=W)return null;if(Ze=Ke,Pt=kt,_t.push(Ze),oe&&mt.push(Pt),kt=new i.P(Z.getx(Qe),Z.gety(Qe)),Ke=re[Qe],!Ke){const Ht=Rs(kt,Te.canonical,Y,ge,ne);Ke=Ht[3]>0?re[Qe]=Ht:ht()}He+=Xe,Xe=i.ab.vec3.distance(Ze,Ke)}_e&&ne&&(re[Qe]&&(Ke=ht(),Xe=i.ab.vec3.distance(Ze,Ke)),re[Qe]=Ke);const Tt=(at-He)/Xe,$t=kt.sub(Pt)._mult(Tt)._add(Pt),pt=i.ab.vec3.sub([],Ke,Ze),Lt=i.ab.vec3.scaleAndAdd([],Ze,pt,Tt);let jt=[0,0,1],Xt=pt[0],Vt=pt[1];if(Ae&&(jt=ge.upVector(Te.canonical,$t.x,$t.y),jt[0]!==0||jt[1]!==0||jt[2]!==1)){const Ht=[jt[2],0,-jt[0]],tr=i.ab.vec3.cross([],jt,Ht);i.ab.vec3.normalize(Ht,Ht),i.ab.vec3.normalize(tr,tr),Xt=i.ab.vec3.dot(pt,Ht),Vt=i.ab.vec3.dot(pt,tr)}if(d){const Ht=i.ab.vec3.cross([],jt,pt);i.ab.vec3.normalize(Ht,Ht),i.ab.vec3.scaleAndAdd(Lt,Lt,Ht,d*qe)}const It=Ue+Math.atan2(Vt,Xt);return _t.push(Lt),oe&&mt.push($t),{point:Lt,angle:It,path:_t,tilePath:mt,up:jt}}function oa(g,l){const d=l.length,y=d+4*g;l.resize(y),l.float32.fill(-1/0,4*d,4*y)}function Ra(g,l,d){const y=l[0],N=l[1];return g[0]=d[0]*y+d[4]*N+d[12],g[1]=d[1]*y+d[5]*N+d[13],g[3]=d[3]*y+d[7]*N+d[15],g}const Ia=100;class ba{constructor(l,d,y=new ou(l.width+200,l.height+200,25),N=new ou(l.width+200,l.height+200,25)){this.transform=l,this.grid=y,this.ignoredGrid=N,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Ia,this.screenBottomBoundary=l.height+Ia,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.fogState=d}placeCollisionBox(l,d,y,N,j,C,F,W){let Z=y.projectedAnchorX,Y=y.projectedAnchorY,re=y.projectedAnchorZ;const ne=y.elevation,oe=y.tileID,_e=l.getProjection();if(ne&&oe){const[Ke,Ze,He]=_e.upVector(oe.canonical,y.tileAnchorX,y.tileAnchorY),Xe=_e.upVectorScale(oe.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;Z+=Ke*ne*Xe,Y+=Ze*ne*Xe,re+=He*ne*Xe}const ge=this.projectAndGetPerspectiveRatio(F,Z,Y,re,y.tileID,_e.name==="globe"||!!ne||this.transform.pitch>0,_e),Te=C*ge.perspectiveRatio,Ae=(y.x1*d+N.x-y.padding)*Te+ge.point.x,Re=(y.y1*d+N.y-y.padding)*Te+ge.point.y,qe=(y.x2*d+N.x+y.padding)*Te+ge.point.x,Ue=(y.y2*d+N.y+y.padding)*Te+ge.point.y,Qe=ge.perspectiveRatio<=.55||ge.occluded;return!this.isInsideGrid(Ae,Re,qe,Ue)||!j&&this.grid.hitTest(Ae,Re,qe,Ue,W)||Qe?{box:[],offscreen:!1,occluded:ge.occluded}:{box:[Ae,Re,qe,Ue],offscreen:this.isOffscreen(Ae,Re,qe,Ue),occluded:!1}}placeCollisionCircles(l,d,y,N,j,C,F,W,Z,Y,re,ne,oe,_e,ge){const Te=[],Ae=this.transform.elevation,Re=l.getProjection(),qe=Ae?Ae.getAtTileOffsetFunc(ge,this.transform.center.lat,this.transform.worldSize,Re):null,Ue=new i.P(y.tileAnchorX,y.tileAnchorY);let{x:Qe,y:Ke,z:Ze}=Re.projectTilePoint(Ue.x,Ue.y,ge.canonical);if(qe){const[$t,pt,Lt]=qe(Ue);Qe+=$t,Ke+=pt,Ze+=Lt}const He=Re.name==="globe",Xe=this.projectAndGetPerspectiveRatio(F,Qe,Ke,Ze,ge,He||!!Ae||this.transform.pitch>0,Re),{perspectiveRatio:at}=Xe,_t=(re?C/at:C*at)/i.bw,mt=ro(Qe,Ke,Ze,W),kt=Xe.signedDistanceFromCamera>0?Fl(_t,j,y.lineOffsetX*_t,y.lineOffsetY*_t,!1,mt,Ue,y,N,W,{},Ae&&!re?qe:null,re&&!!Ae,Re,ge,re):null;let Pt=!1,ht=!1,Tt=!0;if(kt&&!Xe.occluded){const $t=.5*oe*at+_e,pt=new i.P(-100,-100),Lt=new i.P(this.screenRightBoundary,this.screenBottomBoundary),jt=new ii,{first:Xt,last:Vt}=kt,It=Xt.path.length;let Ht=[];for(let xr=It-1;xr>=1;xr--)Ht.push(Xt.path[xr]);for(let xr=1;xr<Vt.path.length;xr++)Ht.push(Vt.path[xr]);const tr=2.5*$t;Z&&(Ht=Ht.map(([xr,qr,Or],Lr)=>(qe&&!He&&(Or=qe(Lr<It-1?Xt.tilePath[It-1-Lr]:Vt.tilePath[Lr-It+2])[2]),ro(xr,qr,Or,Z))),Ht.some(xr=>xr[3]<=0)&&(Ht=[]));let gr=[];if(Ht.length>0){let xr=1/0,qr=-1/0,Or=1/0,Lr=-1/0;for(const Zr of Ht)xr=Math.min(xr,Zr[0]),Or=Math.min(Or,Zr[1]),qr=Math.max(qr,Zr[0]),Lr=Math.max(Lr,Zr[1]);qr>=pt.x&&xr<=Lt.x&&Lr>=pt.y&&Or<=Lt.y&&(gr=[Ht.map(Zr=>new i.P(Zr[0],Zr[1]))],(xr<pt.x||qr>Lt.x||Or<pt.y||Lr>Lt.y)&&(gr=i.bu(gr,pt.x,pt.y,Lt.x,Lt.y)))}for(const xr of gr){jt.reset(xr,.25*$t);let qr=0;qr=jt.length<=.5*$t?1:Math.ceil(jt.paddedLength/tr)+1;for(let Or=0;Or<qr;Or++){const Lr=Or/Math.max(qr-1,1),Zr=jt.lerp(Lr),Ln=Zr.x+Ia,ui=Zr.y+Ia;Te.push(Ln,ui,$t,0);const Wi=Ln-$t,Zn=ui-$t,Qr=Ln+$t,jn=ui+$t;if(Tt=Tt&&this.isOffscreen(Wi,Zn,Qr,jn),ht=ht||this.isInsideGrid(Wi,Zn,Qr,jn),!d&&this.grid.hitTestCircle(Ln,ui,$t,ne)&&(Pt=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:Pt,occluded:!1}}}}return{circles:!Y&&Pt||!ht?[]:Te,offscreen:Tt,collisionDetected:Pt,occluded:Xe.occluded}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let y=1/0,N=1/0,j=-1/0,C=-1/0;for(const Y of l){const re=new i.P(Y.x+Ia,Y.y+Ia);y=Math.min(y,re.x),N=Math.min(N,re.y),j=Math.max(j,re.x),C=Math.max(C,re.y),d.push(re)}const F=this.grid.query(y,N,j,C).concat(this.ignoredGrid.query(y,N,j,C)),W={},Z={};for(const Y of F){const re=Y.key;if(W[re.bucketInstanceId]===void 0&&(W[re.bucketInstanceId]={}),W[re.bucketInstanceId][re.featureIndex])continue;const ne=[new i.P(Y.x1,Y.y1),new i.P(Y.x2,Y.y1),new i.P(Y.x2,Y.y2),new i.P(Y.x1,Y.y2)];i.bv(d,ne)&&(W[re.bucketInstanceId][re.featureIndex]=!0,Z[re.bucketInstanceId]===void 0&&(Z[re.bucketInstanceId]=[]),Z[re.bucketInstanceId].push(re.featureIndex))}return Z}insertCollisionBox(l,d,y,N,j){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:N,collisionGroupID:j},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,d,y,N,j){const C=d?this.ignoredGrid:this.grid,F={bucketInstanceId:y,featureIndex:N,collisionGroupID:j};for(let W=0;W<l.length;W+=4)C.insertCircle(F,l[W],l[W+1],l[W+2])}projectAndGetPerspectiveRatio(l,d,y,N,j,C,F){const W=[d,y,N,1];let Z=!1;N||this.transform.pitch>0?(i.ab.vec4.transformMat4(W,W,l),this.fogState&&j&&F.name!=="globe"&&(Z=function(ne,oe,_e,ge,Te,Ae){const Re=Ae.calculateFogTileMatrix(Te),qe=[oe,_e,ge];return i.ab.vec3.transformMat4(qe,qe,Re),st(ne,i.ab.vec3.length(qe),Ae.pitch,Ae._fov)}(this.fogState,d,y,N,j.toUnwrapped(),this.transform)>.9)):Ra(W,W,l);const Y=W[3];return{point:new i.P((W[0]/Y+1)/2*this.transform.width+Ia,(-W[1]/Y+1)/2*this.transform.height+Ia),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(F)/Y*.5,1.5),signedDistanceFromCamera:Y,occluded:C&&W[2]>Y||Z}}isOffscreen(l,d,y,N){return y<Ia||l>=this.screenRightBoundary||N<Ia||d>this.screenBottomBoundary}isInsideGrid(l,d,y,N){return y>=0&&l<this.gridRightBoundary&&N>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const l=i.ab.mat4.identity([]);return i.ab.mat4.translate(l,l,[-100,-100,0]),l}}function lu(g,l,d){const y=l.createTileMatrix(g,g.worldSize,d.toUnwrapped());return i.ab.mat4.multiply(new Float32Array(16),g.projMatrix,y)}function oc(g,l,d){if(l.projection.name===d.projection.name)return g.projMatrix;const y=d.clone();return y.setProjection(l.projection),lu(y,l.getProjection(),g)}function cu(g,l,d){return l.name===d.projection.name?g.projMatrix:lu(d,l,g)}class Kd{constructor(l,d,y,N){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?d:-d))):N&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class Mo{constructor(l,d,y,N,j,C=!1){this.text=new Kd(l?l.text:null,d,y,j),this.icon=new Kd(l?l.icon:null,d,N,j),this.clipped=C}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class lf{constructor(l,d,y,N=!1){this.text=l,this.icon=d,this.skipFade=y,this.clipped=N}}class Oc{constructor(){this.invProjMatrix=i.ab.mat4.create(),this.viewportMatrix=i.ab.mat4.create(),this.circles=[]}}class U_{constructor(l,d,y,N,j){this.bucketInstanceId=l,this.featureIndex=d,this.sourceLayerIndex=y,this.bucketIndex=N,this.tileID=j}}class wy{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const d=++this.maxGroupID;this.collisionGroups[l]={ID:d,predicate:y=>y.collisionGroupID===d}}return this.collisionGroups[l]}}function Oo(g,l,d,y,N){const{horizontalAlign:j,verticalAlign:C}=i.bD(g),F=-(j-.5)*l,W=-(C-.5)*d,Z=i.bC(g,y);return new i.P(F+Z[0]*N,W+Z[1]*N)}function Sp(g,l,d,y,N){const j=new i.P(g,l);return d&&j._rotate(y?N:-N),j}class Um{constructor(l,d,y,N,j,C){this.transform=l.clone(),this.projection=l.projection.name,this.collisionIndex=new ba(this.transform,j),this.buildingIndex=C,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new wy(y),this.collisionCircleArrays={},this.prevPlacement=N,N&&(N.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,d,y,N,j=1){const C=y.getBucket(d),F=y.latestFeatureIndex;if(!C||!F||d.fqid!==C.layerIds[0])return;const W=C.layers[0].layout,Z=C.layers[0].paint,Y=y.collisionBoxArray,re=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),ne=y.tileSize/i.ag,oe=y.tileID.toUnwrapped();this.transform.setProjection(C.projection);const _e=(ge=y.tileID,Te=C.getProjection(),Ae=this.transform,Te.name===this.projection?Ae.calculateProjMatrix(ge.toUnwrapped()):lu(Ae,Te,ge));var ge,Te,Ae;const Re=W.get("text-pitch-alignment")==="map",qe=W.get("text-rotation-alignment")==="map";d.compileFilter(d.options);const Ue=d.dynamicFilter(),Qe=d.dynamicFilterNeedsFeature(),Ke=this.transform.calculatePixelsToTileUnitsMatrix(y),Ze=_a(_e,y.tileID.canonical,Re,qe,this.transform,C.getProjection(),Ke);let He=null;if(Re){const $t=by(_e,y.tileID.canonical,Re,qe,this.transform,C.getProjection(),Ke);He=i.ab.mat4.multiply([],this.transform.labelPlaneMatrix,$t)}let Xe=null;Ue&&y.latestFeatureIndex&&(Xe={unwrappedTileID:oe,dynamicFilter:Ue,dynamicFilterNeedsFeature:Qe}),this.retainedQueryData[C.bucketInstanceId]=new U_(C.bucketInstanceId,F,C.sourceLayerIndex,C.index,y.tileID);const[at,_t]=C.layers[0].layout.get("text-size-scale-range"),mt=i.aw(j,at,_t),[kt,Pt]=W.get("icon-size-scale-range"),ht=i.aw(j,kt,Pt),Tt={bucket:C,layout:W,paint:Z,posMatrix:_e,textLabelPlaneMatrix:Ze,labelToScreenMatrix:He,clippingData:Xe,scale:re,textPixelRatio:ne,holdingForFade:y.holdingForFade(),collisionBoxArray:Y,partiallyEvaluatedTextSize:i.bp(C.textSizeData,this.transform.zoom,mt),partiallyEvaluatedIconSize:i.bp(C.iconSizeData,this.transform.zoom,ht),collisionGroup:this.collisionGroups.get(C.sourceID),latestFeatureIndex:y.latestFeatureIndex};if(N)for(const $t of C.sortKeyRanges){const{sortKey:pt,symbolInstanceStart:Lt,symbolInstanceEnd:jt}=$t;l.push({sortKey:pt,symbolInstanceStart:Lt,symbolInstanceEnd:jt,parameters:Tt})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:Tt})}attemptAnchorPlacement(l,d,y,N,j,C,F,W,Z,Y,re,ne,oe,_e,ge,Te,Ae,Re){const{textOffset0:qe,textOffset1:Ue,crossTileID:Qe}=ne,Ke=[qe,Ue],Ze=Oo(l,y,N,Ke,j),He=this.collisionIndex.placeCollisionBox(_e,j,d,Sp(Ze.x,Ze.y,C,F,this.transform.angle),re,W,Z,Y.predicate);if(Te){const Xe=_e.getSymbolInstanceIconSize(Re,this.transform.zoom,ne.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(_e,Xe,Te,Sp(Ze.x,Ze.y,C,F,this.transform.angle),re,W,Z,Y.predicate).box.length===0)return}if(He.box.length>0){let Xe;return this.prevPlacement&&this.prevPlacement.variableOffsets[Qe]&&this.prevPlacement.placements[Qe]&&this.prevPlacement.placements[Qe].text&&(Xe=this.prevPlacement.variableOffsets[Qe].anchor),this.variableOffsets[Qe]={textOffset:Ke,width:y,height:N,anchor:l,textScale:j,prevAnchor:Xe},this.markUsedJustification(_e,l,ne,ge),_e.allowVerticalPlacement&&(this.markUsedOrientation(_e,ge,ne),this.placedOrientations[Qe]=ge),{shift:Ze,placedGlyphBoxes:He}}}placeLayerBucketPart(l,d,y,N,j=1){const{bucket:C,layout:F,paint:W,posMatrix:Z,textLabelPlaneMatrix:Y,labelToScreenMatrix:re,clippingData:ne,textPixelRatio:oe,holdingForFade:_e,collisionBoxArray:ge,partiallyEvaluatedTextSize:Te,partiallyEvaluatedIconSize:Ae,collisionGroup:Re,latestFeatureIndex:qe}=l.parameters,Ue=F.get("text-optional"),Qe=F.get("icon-optional"),Ke=F.get("text-allow-overlap"),Ze=F.get("icon-allow-overlap"),He=F.get("text-rotation-alignment")==="map",Xe=F.get("text-pitch-alignment")==="map",at=F.get("symbol-z-elevate"),_t=W.get("symbol-z-offset"),mt=F.get("symbol-elevation-reference")==="sea",[kt,Pt]=F.get("text-size-scale-range"),[ht,Tt]=F.get("icon-size-scale-range"),$t=i.aw(j,kt,Pt),pt=i.aw(j,ht,Tt);this.transform.setProjection(C.projection);let Lt=Ke&&(Ze||!C.hasIconData()||Qe),jt=Ze&&(Ke||!C.hasTextData()||Ue);const Xt=!_t.isConstant();!C.collisionArrays&&ge&&C.deserializeCollisionBoxes(ge),y&&N&&C.updateCollisionDebugBuffers(this.transform.zoom,ge,$t,pt);const Vt=(It,Ht,tr)=>{const{crossTileID:gr,numVerticalGlyphVertices:xr}=It;let qr=null;if(ne&&ne.dynamicFilterNeedsFeature||Xt){const Ti=this.retainedQueryData[C.bucketInstanceId];qr=qe.loadFeature({featureIndex:It.featureIndex,bucketIndex:Ti.bucketIndex,sourceLayerIndex:Ti.sourceLayerIndex,layoutVertexArrayOffset:0})}if(ne&&!(0,ne.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},qr,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new i.P(It.tileAnchorX,It.tileAnchorY),this.transform.calculateDistanceTileData(ne.unwrappedTileID)))return this.placements[gr]=new lf(!1,!1,!1,!0),void d.add(gr);const Or=_t.evaluate(qr,{});if(d.has(gr))return;if(_e)return void(this.placements[gr]=new lf(!1,!1,!1));let Lr=!1,Zr=!1,Ln=!0,ui=!1,Wi=!1,Zn=null,Qr={box:null,offscreen:null,occluded:null},jn={box:null},wr=null,In=null,Qn=null,ai=0,na=0,ca=0;tr.textFeatureIndex?ai=tr.textFeatureIndex:It.useRuntimeCollisionCircles&&(ai=It.featureIndex),tr.verticalTextFeatureIndex&&(na=tr.verticalTextFeatureIndex);const La=Ti=>{Ti.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const _i=this.transform.elevation;Ti.elevation=mt?Or:Or+(_i?_i.getAtTileOffset(Ti.tileID,Ti.tileAnchorX,Ti.tileAnchorY):0),Ti.elevation+=It.zOffset},ka=tr.textBox;if(ka){La(ka);const Ti=Fn=>{let ua=i.bq.horizontal;if(C.allowVerticalPlacement&&!Fn&&this.prevPlacement){const ds=this.prevPlacement.placedOrientations[gr];ds&&(this.placedOrientations[gr]=ds,ua=ds,this.markUsedOrientation(C,ua,It))}return ua},_i=(Fn,ua)=>{if(C.allowVerticalPlacement&&xr>0&&tr.verticalTextBox){for(const ds of C.writingModes)if(ds===i.bq.vertical?(Qr=ua(),jn=Qr):Qr=Fn(),Qr&&Qr.box&&Qr.box.length)break}else Qr=Fn()};if(F.get("text-variable-anchor")){let Fn=F.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[gr]){const ji=this.prevPlacement.variableOffsets[gr];Fn.indexOf(ji.anchor)>0&&(Fn=Fn.filter(Hs=>Hs!==ji.anchor),Fn.unshift(ji.anchor))}const ua=(ji,Hs,kl)=>{const ws=C.getSymbolInstanceTextSize(Te,It,this.transform.zoom,Ht),Bo=(ji.x2-ji.x1)*ws+2*ji.padding,Vo=(ji.y2-ji.y1)*ws+2*ji.padding,Pl=It.hasIconTextFit&&!Ze?Hs:null;Pl&&La(Pl);let Mi={box:[],offscreen:!1,occluded:!1};const Ah=Ke?2*Fn.length:Fn.length;for(let pc=0;pc<Ah;++pc){const Th=this.attemptAnchorPlacement(Fn[pc%Fn.length],ji,Bo,Vo,ws,He,Xe,oe,Z,Re,pc>=Fn.length,It,Ht,C,kl,Pl,Te,Ae);if(Th&&(Mi=Th.placedGlyphBoxes,Mi&&Mi.box&&Mi.box.length)){Lr=!0,Zn=Th.shift;break}}return Mi};_i(()=>ua(ka,tr.iconBox,i.bq.horizontal),()=>{const ji=tr.verticalTextBox;return ji&&La(ji),C.allowVerticalPlacement&&!(Qr&&Qr.box&&Qr.box.length)&&xr>0&&ji?ua(ji,tr.verticalIconBox,i.bq.vertical):{box:null,offscreen:null,occluded:null}}),Qr&&(Lr=Qr.box,Ln=Qr.offscreen,ui=Qr.occluded);const ds=Ti(!(!Qr||!Qr.box));if(!Lr&&this.prevPlacement){const ji=this.prevPlacement.variableOffsets[gr];ji&&(this.variableOffsets[gr]=ji,this.markUsedJustification(C,ji.anchor,It,ds))}}else{const Fn=(ua,ds)=>{const ji=C.getSymbolInstanceTextSize(Te,It,this.transform.zoom,Ht,j),Hs=this.collisionIndex.placeCollisionBox(C,ji,ua,new i.P(0,0),Ke,oe,Z,Re.predicate);return Hs&&Hs.box&&Hs.box.length&&(this.markUsedOrientation(C,ds,It),this.placedOrientations[gr]=ds),Hs};_i(()=>Fn(ka,i.bq.horizontal),()=>{const ua=tr.verticalTextBox;return C.allowVerticalPlacement&&xr>0&&ua?(La(ua),Fn(ua,i.bq.vertical)):{box:null,offscreen:null,occluded:null}}),Ti(!!(Qr&&Qr.box&&Qr.box.length))}}if(wr=Qr,Lr=wr&&wr.box&&wr.box.length>0,Ln=wr&&wr.offscreen,ui=wr&&wr.occluded,It.useRuntimeCollisionCircles){const Ti=C.text.placedSymbolArray.get(It.centerJustifiedTextSymbolIndex>=0?It.centerJustifiedTextSymbolIndex:It.verticalPlacedTextSymbolIndex),_i=i.br(C.textSizeData,Te,Ti),Fn=F.get("text-padding");In=this.collisionIndex.placeCollisionCircles(C,Ke,Ti,C.lineVertexArray,C.glyphOffsetArray,_i,Z,Y,re,y,Xe,Re.predicate,It.collisionCircleDiameter*_i/i.bw,Fn,this.retainedQueryData[C.bucketInstanceId].tileID),Lr=Ke||In.circles.length>0&&!In.collisionDetected,Ln=Ln&&In.offscreen,ui=In.occluded}if(tr.iconFeatureIndex&&(ca=tr.iconFeatureIndex),tr.iconBox){const Ti=_i=>{La(_i);const Fn=It.hasIconTextFit&&Zn?Sp(Zn.x,Zn.y,He,Xe,this.transform.angle):new i.P(0,0),ua=C.getSymbolInstanceIconSize(Ae,this.transform.zoom,It.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,ua,_i,Fn,Ze,oe,Z,Re.predicate)};jn&&jn.box&&jn.box.length&&tr.verticalIconBox?(Qn=Ti(tr.verticalIconBox),Zr=Qn.box.length>0):(Qn=Ti(tr.iconBox),Zr=Qn.box.length>0),Ln=Ln&&Qn.offscreen,Wi=Qn.occluded}const Ds=Ue||It.numHorizontalGlyphVertices===0&&xr===0,Fs=Qe||It.numIconVertices===0;if(Ds||Fs?Fs?Ds||(Zr=Zr&&Lr):Lr=Zr&&Lr:Zr=Lr=Zr&&Lr,Lr&&wr&&wr.box&&this.collisionIndex.insertCollisionBox(wr.box,F.get("text-ignore-placement"),C.bucketInstanceId,jn&&jn.box&&na?na:ai,Re.ID),Zr&&Qn&&this.collisionIndex.insertCollisionBox(Qn.box,F.get("icon-ignore-placement"),C.bucketInstanceId,ca,Re.ID),In&&(Lr&&this.collisionIndex.insertCollisionCircles(In.circles,F.get("text-ignore-placement"),C.bucketInstanceId,ai,Re.ID),y)){const Ti=C.bucketInstanceId;let _i=this.collisionCircleArrays[Ti];_i===void 0&&(_i=this.collisionCircleArrays[Ti]=new Oc);for(let Fn=0;Fn<In.circles.length;Fn+=4)_i.circles.push(In.circles[Fn+0]),_i.circles.push(In.circles[Fn+1]),_i.circles.push(In.circles[Fn+2]),_i.circles.push(In.collisionDetected?1:0)}const Ci=C.projection.name!=="globe";Lt=Lt&&(Ci||!ui),jt=jt&&(Ci||!Wi),this.placements[gr]=new lf(Lr||Lt,Zr||jt,Ln||C.justReloaded),d.add(gr)};if(at&&this.buildingIndex&&(this.buildingIndex.updateZOffset(C,this.retainedQueryData[C.bucketInstanceId].tileID),C.updateZOffset()),C.sortFeaturesByY){const It=C.getSortedSymbolIndexes(this.transform.angle);for(let Ht=It.length-1;Ht>=0;--Ht){const tr=It[Ht];Vt(C.symbolInstances.get(tr),tr,C.collisionArrays[tr])}C.hasAnyZOffset&&i.w(`${C.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(C.hasAnyZOffset){const It=C.getSortedIndexesByZOffset();for(let Ht=0;Ht<It.length;++Ht){const tr=It[Ht];Vt(C.symbolInstances.get(tr),tr,C.collisionArrays[tr])}}else for(let It=l.symbolInstanceStart;It<l.symbolInstanceEnd;It++)Vt(C.symbolInstances.get(It),It,C.collisionArrays[It]);if(y&&C.bucketInstanceId in this.collisionCircleArrays){const It=this.collisionCircleArrays[C.bucketInstanceId];i.ab.mat4.invert(It.invProjMatrix,Z),It.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(l,d,y,N){const{leftJustifiedTextSymbolIndex:j,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:F,verticalPlacedTextSymbolIndex:W,crossTileID:Z}=y,Y=i.bB(d),re=N===i.bq.vertical?W:Y==="left"?j:Y==="center"?C:Y==="right"?F:-1;j>=0&&(l.text.placedSymbolArray.get(j).crossTileID=re>=0&&j!==re?0:Z),C>=0&&(l.text.placedSymbolArray.get(C).crossTileID=re>=0&&C!==re?0:Z),F>=0&&(l.text.placedSymbolArray.get(F).crossTileID=re>=0&&F!==re?0:Z),W>=0&&(l.text.placedSymbolArray.get(W).crossTileID=re>=0&&W!==re?0:Z)}markUsedOrientation(l,d,y){const N=d===i.bq.horizontal||d===i.bq.horizontalOnly?d:0,j=d===i.bq.vertical?d:0,{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:F,rightJustifiedTextSymbolIndex:W,verticalPlacedTextSymbolIndex:Z}=y,Y=l.text.placedSymbolArray;C>=0&&(Y.get(C).placedOrientation=N),F>=0&&(Y.get(F).placedOrientation=N),W>=0&&(Y.get(W).placedOrientation=N),Z>=0&&(Y.get(Z).placedOrientation=j)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let y=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const N=d?d.symbolFadeChange(l):1,j=d?d.opacities:{},C=d?d.variableOffsets:{},F=d?d.placedOrientations:{};for(const W in this.placements){const Z=this.placements[W],Y=j[W];Y?(this.opacities[W]=new Mo(Y,N,Z.text,Z.icon,null,Z.clipped),y=y||Z.text!==Y.text.placed||Z.icon!==Y.icon.placed):(this.opacities[W]=new Mo(null,N,Z.text,Z.icon,Z.skipFade,Z.clipped),y=y||Z.text||Z.icon)}for(const W in j){const Z=j[W];if(!this.opacities[W]){const Y=new Mo(Z,N,!1,!1);Y.isHidden()||(this.opacities[W]=Y,y=y||Z.text.placed||Z.icon.placed)}}for(const W in C)this.variableOffsets[W]||!this.opacities[W]||this.opacities[W].isHidden()||(this.variableOffsets[W]=C[W]);for(const W in F)this.placedOrientations[W]||!this.opacities[W]||this.opacities[W].isHidden()||(this.placedOrientations[W]=F[W]);y?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:l)}updateLayerOpacities(l,d,y,N){const j=new Set;for(const C of d){const F=C.getBucket(l);F&&C.latestFeatureIndex&&l.fqid===F.layerIds[0]&&(this.updateBucketOpacities(F,j,C,C.collisionBoxArray,y,N,C.tileID,l.scope),F.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(F,C.tileID),F.updateZOffset()))}}updateBucketOpacities(l,d,y,N,j,C,F,W){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const Z=l.layers[0].layout,Y=l.layers[0].paint,re=!!l.layers[0].dynamicFilter(),ne=new Mo(null,0,!1,!1,!0),oe=Z.get("text-allow-overlap"),_e=Z.get("icon-allow-overlap"),ge=Z.get("text-variable-anchor"),Te=Z.get("text-rotation-alignment")==="map",Ae=Z.get("text-pitch-alignment")==="map",Re=Y.get("symbol-z-offset"),qe=Z.get("symbol-elevation-reference")==="sea",Ue=!Re.isConstant(),Qe=new Mo(null,0,oe&&(_e||!l.hasIconData()||Z.get("icon-optional")),_e&&(oe||!l.hasTextData()||Z.get("text-optional")),!0);!l.collisionArrays&&N&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(N);const Ke=(He,Xe,at)=>{for(let _t=0;_t<Xe/4;_t++)He.opacityVertexArray.emplaceBack(at)};let Ze=0;C&&l.updateReplacement(F,C);for(let He=0;He<l.symbolInstances.length;He++){const Xe=l.symbolInstances.get(He),{numHorizontalGlyphVertices:at,numVerticalGlyphVertices:_t,crossTileID:mt,numIconVertices:kt,tileAnchorX:Pt,tileAnchorY:ht}=Xe;let Tt=null;const $t=this.retainedQueryData[l.bucketInstanceId];Ue&&Xe&&$t&&(Tt=y.latestFeatureIndex.loadFeature({featureIndex:Xe.featureIndex,bucketIndex:$t.bucketIndex,sourceLayerIndex:$t.sourceLayerIndex,layoutVertexArrayOffset:0}));const pt=Re.evaluate(Tt,{}),Lt=d.has(mt);let jt=this.opacities[mt];Lt?jt=ne:jt||(jt=Qe,this.opacities[mt]=jt),d.add(mt);const Xt=at>0||_t>0,Vt=kt>0,It=this.placedOrientations[mt],Ht=It===i.bq.vertical,tr=It===i.bq.horizontal||It===i.bq.horizontalOnly;!Xt&&!Vt||jt.isHidden()||Ze++;let gr=!1;if((Xt||Vt)&&C)for(const xr of l.activeReplacements){if(i.bx(xr,j,i.by.Symbol,W)||xr.min.x>Pt||Pt>xr.max.x||xr.min.y>ht||ht>xr.max.y)continue;const qr=i.bz(Pt,ht,F.canonical,xr.footprintTileId.canonical);if(gr=i.bA(qr,xr.footprint),gr)break}if(Xt){const xr=gr?lc:Sy(jt.text);Ke(l.text,at,Ht?lc:xr),Ke(l.text,_t,tr?lc:xr);const qr=jt.text.isHidden(),{leftJustifiedTextSymbolIndex:Or,centerJustifiedTextSymbolIndex:Lr,rightJustifiedTextSymbolIndex:Zr,verticalPlacedTextSymbolIndex:Ln}=Xe,ui=l.text.placedSymbolArray,Wi=qr||Ht?1:0;Or>=0&&(ui.get(Or).hidden=Wi),Lr>=0&&(ui.get(Lr).hidden=Wi),Zr>=0&&(ui.get(Zr).hidden=Wi),Ln>=0&&(ui.get(Ln).hidden=qr||tr?1:0);const Zn=this.variableOffsets[mt];Zn&&this.markUsedJustification(l,Zn.anchor,Xe,It);const Qr=this.placedOrientations[mt];Qr&&(this.markUsedJustification(l,"left",Xe,Qr),this.markUsedOrientation(l,Qr,Xe))}if(Vt){const xr=gr?lc:Sy(jt.icon),{placedIconSymbolIndex:qr,verticalPlacedIconSymbolIndex:Or}=Xe,Lr=l.icon.placedSymbolArray,Zr=jt.icon.isHidden()?1:0;qr>=0&&(Ke(l.icon,kt,Ht?lc:xr),Lr.get(qr).hidden=Zr),Or>=0&&(Ke(l.icon,Xe.numVerticalIconVertices,tr?lc:xr),Lr.get(Or).hidden=Zr)}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const xr=l.collisionArrays[He];if(xr){let qr=new i.P(0,0),Or=!0;if(xr.textBox||xr.verticalTextBox){if(ge){const Zr=this.variableOffsets[mt];Zr?(qr=Oo(Zr.anchor,Zr.width,Zr.height,Zr.textOffset,Zr.textScale),Te&&qr._rotate(Ae?this.transform.angle:-this.transform.angle)):Or=!1}re&&(Or=!jt.clipped),xr.textBox&&Np(l.textCollisionBox.collisionVertexArray,jt.text.placed,!Or||Ht,pt,qe,qr.x,qr.y),xr.verticalTextBox&&Np(l.textCollisionBox.collisionVertexArray,jt.text.placed,!Or||tr,pt,qe,qr.x,qr.y)}const Lr=Or&&!!(!tr&&xr.verticalIconBox);xr.iconBox&&Np(l.iconCollisionBox.collisionVertexArray,jt.icon.placed,Lr,pt,qe,Xe.hasIconTextFit?qr.x:0,Xe.hasIconTextFit?qr.y:0),xr.verticalIconBox&&Np(l.iconCollisionBox.collisionVertexArray,jt.icon.placed,!Lr,pt,qe,Xe.hasIconTextFit?qr.x:0,Xe.hasIconTextFit?qr.y:0)}}}if(l.fullyClipped=Ze===0,l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){const He=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=He.invProjMatrix,l.placementViewportMatrix=He.viewportMatrix,l.collisionCircleArray=He.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,d){const y=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*y>l}setStale(){this.stale=!0}}function Np(g,l,d,y,N,j,C){g.emplaceBack(l?1:0,d?1:0,j||0,C||0,y,N?1:0),g.emplaceBack(l?1:0,d?1:0,j||0,C||0,y,N?1:0),g.emplaceBack(l?1:0,d?1:0,j||0,C||0,y,N?1:0),g.emplaceBack(l?1:0,d?1:0,j||0,C||0,y,N?1:0)}const Ap=Math.pow(2,25),$_=Math.pow(2,24),q_=Math.pow(2,17),cf=Math.pow(2,16),Tp=Math.pow(2,9),G_=Math.pow(2,8),uf=Math.pow(2,1);function Sy(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const l=g.placed?1:0,d=Math.floor(127*g.opacity);return d*Ap+l*$_+d*q_+l*cf+d*Tp+l*G_+d*uf+l}const lc=0;class Yu{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&l.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(l,d,y,N,j,C){const F=this._bucketParts;for(;this._currentTileIndex<l.length;)if(d.getBucketParts(F,N,l[this._currentTileIndex],this._sortAcrossTiles,C),this._currentTileIndex++,j())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,F.sort((W,Z)=>W.sortKey-Z.sortKey));this._currentPartIndex<F.length;){const W=F[this._currentPartIndex];if(d.placeLayerBucketPart(W,this._seenCrossTileIDs,y,W.symbolInstanceStart===0,C),this._currentPartIndex++,j())return!0}return!1}}class W_{constructor(l,d,y,N,j,C,F,W,Z){this.placement=new Um(l,j,C,F,W,Z),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=N,this._done=!1}isDone(){return this._done}continuePlacement(l,d,y,N,j){const C=i.q.now(),F=()=>{const W=i.q.now()-C;return!this._forceFullPlacement&&W>2};for(;this._currentPlacementIndex>=0;){const W=d[l[this._currentPlacementIndex]],Z=this.placement.collisionIndex.transform.zoom;if(W.type==="symbol"&&(!W.minzoom||W.minzoom<=Z)&&(!W.maxzoom||W.maxzoom>Z)){const Y=W,re=Y.layout.get("symbol-z-elevate"),ne=Y.layout.get("symbol-sort-key").constantOr(1)!==void 0,oe=Y.layout.get("symbol-z-order"),_e=oe==="viewport-y"||oe==="auto"&&!(oe!=="viewport-y"&&ne),ge=Y.layout.get("text-allow-overlap")||Y.layout.get("icon-allow-overlap")||Y.layout.get("text-ignore-placement")||Y.layout.get("icon-ignore-placement"),Te=_e&&ge,Ae=this._inProgressLayer=this._inProgressLayer||new Yu(Y),Re=i.aC(W.source,W.scope);if(Ae.continuePlacement(re||Te?N[Re]:y[Re],this.placement,this._showCollisionBoxes,W,F,j))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const Ny=512/i.ag/2;class lx{constructor(l,d,y){this.tileID=l,this.bucketInstanceId=y,this.index=new i.bE(d.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const N=l.canonical.x*i.ag,j=l.canonical.y*i.ag;for(let C=0;C<d.length;C++){const{key:F,crossTileID:W,tileAnchorX:Z,tileAnchorY:Y}=d.get(C),re=Math.floor((N+Z)*Ny),ne=Math.floor((j+Y)*Ny);this.index.add(re,ne),this.keys.push(F),this.crossTileIDs.push(W)}this.index.finish()}findMatches(l,d,y){const N=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z),j=Ny/Math.pow(2,d.canonical.z-this.tileID.canonical.z),C=d.canonical.x*i.ag,F=d.canonical.y*i.ag;for(let W=0;W<l.length;W++){const Z=l.get(W);if(Z.crossTileID)continue;const{key:Y,tileAnchorX:re,tileAnchorY:ne}=Z,oe=Math.floor((C+re)*j),_e=Math.floor((F+ne)*j),ge=this.index.range(oe-N,_e-N,oe+N,_e+N);for(const Te of ge){const Ae=this.crossTileIDs[Te];if(this.keys[Te]===Y&&!y.has(Ae)){y.add(Ae),Z.crossTileID=Ae;break}}}}}class cx{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class H_{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const d=Math.round((l-this.lng)/360);if(d!==0)for(const y in this.indexes){const N=this.indexes[y],j={};for(const C in N){const F=N[C];F.tileID=F.tileID.unwrapTo(F.tileID.wrap+d),j[F.tileID.key]=F}this.indexes[y]=j}this.lng=l}addBucket(l,d,y){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let j=0;j<d.symbolInstances.length;j++)d.symbolInstances.get(j).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]=new Set);const N=this.usedCrossTileIDs[l.overscaledZ];for(const j in this.indexes){const C=this.indexes[j];if(Number(j)>l.overscaledZ)for(const F in C){const W=C[F];W.tileID.isChildOf(l)&&W.findMatches(d.symbolInstances,l,N)}else{const F=C[l.scaledTo(Number(j)).key];F&&F.findMatches(d.symbolInstances,l,N)}}for(let j=0;j<d.symbolInstances.length;j++){const C=d.symbolInstances.get(j);C.crossTileID||(C.crossTileID=y.generate(),N.add(C.crossTileID))}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new lx(l,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(l,d){for(const y of d.crossTileIDs)this.usedCrossTileIDs[l].delete(y)}removeStaleBuckets(l){let d=!1;for(const y in this.indexes){const N=this.indexes[y];for(const j in N)l[N[j].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,N[j]),delete N[j],d=!0)}return d}}class Ay{constructor(){this.layerIndexes={},this.crossTileIDs=new cx,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,d,y,N){let j=this.layerIndexes[l.fqid];j===void 0&&(j=this.layerIndexes[l.fqid]=new H_);let C=!1;const F={};N.name!=="globe"&&j.handleWrapJump(y);for(const W of d){const Z=W.getBucket(l);Z&&l.fqid===Z.layerIds[0]&&(Z.bucketInstanceId||(Z.bucketInstanceId=++this.maxBucketInstanceId),j.addBucket(W.tileID,Z,this.crossTileIDs)&&(C=!0),F[Z.bucketInstanceId]=!0)}return j.removeStaleBuckets(F)&&(C=!0),C}pruneUnusedLayers(l){const d={};l.forEach(y=>{d[y]=!0});for(const y in this.layerIndexes)d[y]||delete this.layerIndexes[y]}}const Zd=771;class kn{constructor(l,d,y,N){this.blendFunction=l,this.blendColor=d,this.mask=y,this.blendEquation=N}}kn.Replace=[1,0,1,0],kn.disabled=new kn(kn.Replace,i.aj.transparent,[!1,!1,!1,!1]),kn.unblended=new kn(kn.Replace,i.aj.transparent,[!0,!0,!0,!0]),kn.alphaBlended=new kn([1,Zd,1,Zd],i.aj.transparent,[!0,!0,!0,!0]),kn.alphaBlendedNonPremultiplied=new kn([770,Zd,770,Zd],i.aj.transparent,[!0,!0,!0,!0]),kn.multiply=new kn([774,0,774,0],i.aj.transparent,[!0,!0,!0,!0]);class zr{constructor(l,d,y){this.func=l,this.mask=d,this.range=y}}zr.ReadOnly=!1,zr.ReadWrite=!0,zr.disabled=new zr(519,zr.ReadOnly,[0,1]);const $m=7680;class Wr{constructor(l,d,y,N,j,C){this.test=l,this.ref=d,this.mask=y,this.fail=N,this.depthFail=j,this.pass=C}}Wr.disabled=new Wr({func:519,mask:0},0,0,$m,$m,$m);const Rc=1029,qm=2305;class Jr{constructor(l,d,y){this.enable=l,this.mode=d,this.frontFace=y}}function Yd(g,l){const d=i.bG(g,3);i.ab.mat4.fromQuat(g,l),i.bI(g,3,d)}function Xu(g,l){const d=i.ab.quat.identity([]);return i.ab.quat.rotateZ(d,d,-l),i.ab.quat.rotateX(d,d,-g),d}function Gm(g,l){const d=[g[0],g[1],0],y=[l[0],l[1],0];if(i.ab.vec3.length(d)>=1e-15){const C=i.ab.vec3.normalize([],d);i.ab.vec3.scale(y,C,i.ab.vec3.dot(y,C)),l[0]=y[0],l[1]=y[1]}const N=i.ab.vec3.cross([],l,g);if(i.ab.vec3.len(N)<1e-15)return null;const j=Math.atan2(-N[1],N[0]);return Xu(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),j)}Jr.disabled=new Jr(!1,Rc,qm),Jr.backCCW=new Jr(!0,Rc,qm),Jr.backCW=new Jr(!0,Rc,2304),Jr.frontCW=new Jr(!0,1028,2304),Jr.frontCCW=new Jr(!0,1028,qm);class jp{constructor(l,d){this.position=l,this.orientation=d}get position(){return this._position}set position(l){if(l){const d=l instanceof i.aa?l:new i.aa(l[0],l[1],l[2]);this._renderWorldCopies&&(d.x=i.bF(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(l,d){if(this.orientation=null,!this.position)return;const y=this.position,N=this._elevation?this._elevation.getAtPointOrZero(i.aa.fromLngLat(l)):0,j=i.aa.fromLngLat(l,N),C=[j.x-y.x,j.y-y.y,j.z-y.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=Gm(C,d)}setPitchBearing(l,d){this.orientation=Xu(i.ai(l),i.ai(-d))}}class vs{constructor(l,d){this._transform=i.ab.mat4.identity([]),this.orientation=d,this.position=l}get mercatorPosition(){const l=this.position;return new i.aa(l[0],l[1],l[2])}get position(){const l=i.bG(this._transform,3);return[l[0],l[1],l[2]]}set position(l){var d;l&&i.bI(this._transform,3,[(d=l)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(l){this._orientation=l||i.ab.quat.identity([]),l&&Yd(this._transform,this._orientation)}getPitchBearing(){const l=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2])}}setPitchBearing(l,d){this._orientation=Xu(l,d),Yd(this._transform,this._orientation)}forward(){const l=i.bG(this._transform,2);return[-l[0],-l[1],-l[2]]}up(){const l=i.bG(this._transform,1);return[-l[0],-l[1],-l[2]]}right(){const l=i.bG(this._transform,0);return[l[0],l[1],l[2]]}getCameraToWorld(l,d){const y=new Float64Array(16);return i.ab.mat4.invert(y,this.getWorldToCamera(l,d)),y}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(l,d,y){const N=this.position;i.ab.vec3.scale(N,N,-l);const j=new Float64Array(16);return i.ab.mat4.fromScaling(j,[y,y,y]),i.ab.mat4.translate(j,j,N),j[10]*=d,j}getWorldToCamera(l,d){const y=new Float64Array(16),N=new Float64Array(4),j=this.position;return i.ab.quat.conjugate(N,this._orientation),i.ab.vec3.scale(j,j,-l),i.ab.mat4.fromQuat(y,N),i.ab.mat4.translate(y,y,j),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=d,y[9]*=d,y[10]*=d,y[11]*=d,y}getCameraToClipPerspective(l,d,y,N){const j=new Float64Array(16);return i.ab.mat4.perspective(j,l,d,y,N),j}getCameraToClipOrthographic(l,d,y,N,j,C){const F=new Float64Array(16);return i.ab.mat4.ortho(F,l,d,y,N,j,C),F}getDistanceToElevation(l,d=!1){const y=l===0?0:i.bH(l,d?i.aS(this.position[1]):this.position[1]),N=this.forward();return(y-this.position[2])/N[2]}clone(){return new vs([...this.position],[...this.orientation])}}const Gs={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class cr{constructor(l=0,d=0,y=0,N=0){if(isNaN(l)||l<0||isNaN(d)||d<0||isNaN(y)||y<0||isNaN(N)||N<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=d,this.left=y,this.right=N}interpolate(l,d,y){return d.top!=null&&l.top!=null&&(this.top=i.af(l.top,d.top,y)),d.bottom!=null&&l.bottom!=null&&(this.bottom=i.af(l.bottom,d.bottom,y)),d.left!=null&&l.left!=null&&(this.left=i.af(l.left,d.left,y)),d.right!=null&&l.right!=null&&(this.right=i.af(l.right,d.right,y)),this}getCenter(l,d){const y=i.aw((this.left+l-this.right)/2,0,l),N=i.aw((this.top+d-this.bottom)/2,0,d);return new i.P(y,N)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new cr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Ty=(g,l,d)=>(1-d)*g+d*l,kp=g=>g*g*g*g*g;class df{constructor(l,d,y,N,j,C,F){this.tileSize=512,this._renderWorldCopies=j===void 0||j,this._minZoom=l||0,this._maxZoom=d||22,this._minPitch=y??0,this._maxPitch=N??60,this.setProjection(C),this.setMaxBounds(F),this.width=0,this.height=0,this._center=new i.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new cr,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new vs,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const l=new df(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return l._elevation=this._elevation,l._centerAltitude=this._centerAltitude,l._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,l.tileSize=this.tileSize,l.mercatorFromTransition=this.mercatorFromTransition,l.width=this.width,l.height=this.height,l.cameraElevationReference=this.cameraElevationReference,l._center=this._center,l._setZoom(this.zoom),l._seaLevelZoom=this._seaLevelZoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._nearZ=this._nearZ,l._farZ=this._farZ,l._averageElevation=this._averageElevation,l._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._camera=this._camera.clone(),l._calcMatrices(),l.freezeTileCoverage=this.freezeTileCoverage,l.frustumCorners=this.frustumCorners,l}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(l){this._elevation!==l&&(this._elevation=l,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(l,d=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||y)&&this._updateCameraOnTerrain(),(l||y)&&this._constrainCamera(d),this._calcMatrices()}getProjection(){return i.ay(this.projection,["name","center","parallels"])}setProjection(l){this.projectionOptions=l||{name:"mercator"};const d=this.projection?this.getProjection():void 0;this.projection=i.bP(this.projectionOptions);const y=this.getProjection(),N=!i.bn(d,y);return N&&this._calcMatrices(),this.mercatorFromTransition=!1,N}setOrthographicProjectionAtLowPitch(l){return this._orthographicProjectionAtLowPitch!==l&&(this._orthographicProjectionAtLowPitch=l,this._calcMatrices(),!0)}setMercatorFromTransition(){const l=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bP({name:"mercator"});const d=l!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get cameraWorldSize(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bF(this.rotation,-180,180)}set bearing(l){this.rotation=l}get rotation(){return-this.angle/Math.PI*180}set rotation(l){const d=-l*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=i.ab.mat2.create(),i.ab.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const d=i.aw(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const l=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/l)}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=i.ai(l),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(l){this._averageElevation=l,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(l){const d=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(l){this._zoom=l,this.scale=this.zoomScale(l),this.tileZoom=Math.floor(l),this.zoomFraction=l-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(l){this._tileCoverLift!==l&&(this._tileCoverLift=l)}_updateCameraOnTerrain(){const l=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,d=this.elevation&&l===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||l===Number.NEGATIVE_INFINITY&&(!d||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const y=this._elevation;d||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&y.exaggeration()&&this._centerAltitudeValidForExaggeration!==y.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*y.exaggeration(),this._centerAltitudeValidForExaggeration=y.exaggeration()):(this._centerAltitude=l||0,this._centerAltitudeValidForExaggeration=y.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const l=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let N=0,j=0;for(let C=0;C<d.length;C++){const F=new i.P(d[C][0]*this.width,y+d[C][1]*(this.height-y)),W=l.pointCoordinate(F);if(!W)continue;const Z=1/Math.hypot(W[0]-this._camera.position[0],W[1]-this._camera.position[1]);N+=W[3]*Z,j+=Z}return j===0?NaN:N/j}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const l=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*d,N=this._mercatorZfromZoom(l),j=this._mercatorZfromZoom(this._maxZoom),C=Math.max(N-y,j);this._setZoom(this._zoomFromMercatorZ(C))}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}computeZoomRelativeTo(l){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,l.toAltitude()));let y;y=l.z<this._camera.position[2]?[d.x,d.y,d.z]:[l.x,l.y,l.z];const N=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,y));return i.aw(this._zoomFromMercatorZ(N),this._minZoom,this._maxZoom)}setFreeCameraOptions(l){if(!this.height||!l.position&&!l.orientation)return;this._updateCameraState();let d=!1;if(l.orientation&&!i.ab.quat.exactEquals(l.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(l.orientation)),l.position){const y=[l.position.x,l.position.y,l.position.z];i.ab.vec3.exactEquals(y,this._camera.position)||(this._setCameraPosition(y),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const l=this._camera.position,d=new jp;return d.position=new i.aa(l[0],l[1],l[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(l){if(!i.ab.quat.length(l))return!1;i.ab.quat.normalize(l,l);const d=i.ab.vec3.transformQuat([],[0,0,-1],l),y=i.ab.vec3.transformQuat([],[0,-1,0],l);if(y[2]<0)return!1;const N=Gm(d,y);return!!N&&(this._camera.orientation=N,!0)}_setCameraPosition(l){const d=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,N=this.cameraToCenterDistance;l[2]=i.aw(l[2],N/y,N/d),this._camera.position=l}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,d,y){this._unmodified=!1,this._edgeInsets.interpolate(l,d,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const d=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(l){const d=[new i.bQ(0,l)];if(this.renderWorldCopies){const y=this.pointCoordinate(new i.P(0,0)),N=this.pointCoordinate(new i.P(this.width,0)),j=this.pointCoordinate(new i.P(this.width,this.height)),C=this.pointCoordinate(new i.P(0,this.height)),F=Math.floor(Math.min(y.x,N.x,j.x,C.x)),W=Math.floor(Math.max(y.x,N.x,j.x,C.x)),Z=1;for(let Y=F-Z;Y<=W+Z;Y++)Y!==0&&d.push(new i.bQ(Y,l))}return d}isLODDisabled(l){return(!l||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(l,d,y){let N=[];const j=y!==void 0,C=!j;if(C&&this.zoom<d||j&&y[0]===0&&y[1]===0)return N;const F=new Set,W=(Y,re,ne,oe,_e)=>{const ge=i.c5(re,Y,ne,oe,_e);F.has(ge)||(N.push(new i.aG(Y,re,ne,oe,_e)),F.add(ge))};for(let Y=0;Y<l.length;Y++){const re=l[Y];if(C&&re.canonical.z!==d)continue;const ne=re.canonical,oe=re.overscaledZ,_e=re.wrap,ge=1<<ne.z,Te=ne.x+1<ge,Ae=ne.x>0,Re=ne.y+1<ge,qe=ne.y>0,Ue=re.wrap-(Ae?0:1),Qe=re.wrap+(Te?0:1),Ke=Ae?ne.x-1:ge-1,Ze=Te?ne.x+1:0;if(j)y[0]<0?(W(oe,Qe,ne.z,Ze,ne.y),y[1]<0&&Re&&(W(oe,_e,ne.z,ne.x,ne.y+1),W(oe,Qe,ne.z,Ze,ne.y+1)),y[1]>0&&qe&&(W(oe,_e,ne.z,ne.x,ne.y-1),W(oe,Qe,ne.z,Ze,ne.y-1))):y[0]>0?(W(oe,Ue,ne.z,Ke,ne.y),y[1]<0&&Re&&(W(oe,_e,ne.z,ne.x,ne.y+1),W(oe,Ue,ne.z,Ke,ne.y+1)),y[1]>0&&qe&&(W(oe,_e,ne.z,ne.x,ne.y-1),W(oe,Ue,ne.z,Ke,ne.y-1))):y[1]<0&&Re?W(oe,_e,ne.z,ne.x,ne.y+1):qe&&W(oe,_e,ne.z,ne.x,ne.y-1);else{const He=re.visibleQuadrants;1&He&&(W(oe,Ue,ne.z,Ke,ne.y),qe&&(W(oe,_e,ne.z,ne.x,ne.y-1),W(oe,Ue,ne.z,Ke,ne.y-1))),2&He&&(W(oe,Qe,ne.z,Ze,ne.y),qe&&(W(oe,_e,ne.z,ne.x,ne.y-1),W(oe,Qe,ne.z,Ze,ne.y-1))),4&He&&(W(oe,Ue,ne.z,Ke,ne.y),Re&&(W(oe,_e,ne.z,ne.x,ne.y+1),W(oe,Ue,ne.z,Ke,ne.y+1))),8&He&&(W(oe,Qe,ne.z,Ze,ne.y),Re&&(W(oe,_e,ne.z,ne.x,ne.y+1),W(oe,Qe,ne.z,Ze,ne.y+1)))}}const Z=[];for(const Y of N)N.some(re=>Y.isChildOf(re))||Z.push(Y);if(N=Z.filter(Y=>!l.some(re=>!!(Y.overscaledZ<d&&re.isChildOf(Y))||Y.equals(re)||Y.isChildOf(re))),C){const Y=1<<d,re=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ne=[Y*re.x,Y*re.y],oe=4,_e=oe*oe;N=N.filter(ge=>{const Te=ge.canonical.x+.5-ne[0],Ae=ge.canonical.y+.5-ne[1];return Te*Te+Ae*Ae<_e})}return N}coveringTiles(l){let d=this.coveringZoomLevel(l);const y=d,N=this.elevation&&this.elevation.exaggeration(),j=N&&!l.isTerrainDEM,C=this.projection.name==="mercator";if(l.minzoom!==void 0&&d<l.minzoom)return[];l.maxzoom!==void 0&&d>l.maxzoom&&(d=l.maxzoom);const F=this.locationCoordinate(this.center),W=this.center.lat,Z=1<<d,Y=[Z*F.x,Z*F.y,0],re=this.projection.name==="globe",ne=!re,oe=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,ne),_e=re?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ge=Z*i.bH(1,this.center.lat),Te=this._camera.position[2]/i.bH(1,this.center.lat),Ae=[Z*_e.x,Z*_e.y,Te*(ne?1:ge)],Re=re||N,qe=this.cameraToCenterDistance/l.tileSize*(l.roundZoom?1:.502),Ue=this.isLODDisabled(!0)?d:0;let Qe;if(this._elevation&&l.isTerrainDEM)Qe=1e4*this._elevation.exaggeration();else if(this._elevation){const pt=this._elevation.getMinMaxForVisibleTiles();Qe=pt?pt.max:this._centerAltitude}else Qe=this._centerAltitude;const Ke=l.isTerrainDEM?-Qe:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ze=this.projection.isReprojectedInTileSpace?i.bS(this):1,He=pt=>{const jt=new i.aa(pt.x+25e-6,pt.y,pt.z),Xt=new i.aa(pt.x,pt.y+25e-6,pt.z),Vt=pt.toLngLat(),It=jt.toLngLat(),Ht=Xt.toLngLat(),tr=this.locationCoordinate(Vt),gr=this.locationCoordinate(It),xr=this.locationCoordinate(Ht),qr=Math.hypot(gr.x-tr.x,gr.y-tr.y),Or=Math.hypot(xr.x-tr.x,xr.y-tr.y);return Math.sqrt(qr*Or)*Ze/25e-6},Xe=pt=>{const Lt=Qe,jt=Ke;return{aabb:i.bV(this,Z,0,0,0,pt,jt,Lt,this.projection),zoom:0,x:0,y:0,minZ:jt,maxZ:Lt,wrap:pt,fullyVisible:!1}},at=[];let _t=[];const mt=d,kt=l.reparseOverscaled?y:d,Pt=(Te-this._centerAltitude)*ge,ht=pt=>{if(!this._elevation||!pt.tileID||!C)return;const Lt=this._elevation.getMinMaxForTile(pt.tileID),jt=pt.aabb;Lt?(jt.min[2]=Lt.min,jt.max[2]=Lt.max,jt.center[2]=(jt.min[2]+jt.max[2])/2):(pt.shouldSplit=$t(pt),pt.shouldSplit||(jt.min[2]=jt.max[2]=jt.center[2]=this._centerAltitude))},Tt=(pt,Lt)=>{if(.707*Lt<pt)return 1;const jt=Lt/pt;return jt/(1.4144271570014144+(Math.pow(1.1,jt-1.4144271570014144+1)-1)/(1.1-1)-1)},$t=pt=>{if(pt.zoom<Ue)return!0;if(pt.zoom===mt)return!1;if(pt.shouldSplit!=null)return pt.shouldSplit;const Lt=pt.aabb.distanceX(Ae),jt=pt.aabb.distanceY(Ae);let Xt=Pt,Vt=1;if(re){Xt=pt.aabb.distanceZ(Ae);const Or=Math.pow(2,pt.zoom),Lr=i.aS((pt.y+1)/Or),Zr=i.aS(pt.y/Or),Ln=Math.min(Math.max(W,Lr),Zr),ui=i.c9(Ln)/i.c9(W);if(Vt=Ln===W?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,ui/this._mercatorScaleRatio),this.zoom<=i.c6&&pt.zoom===mt-1&&ui>=.9)return!0}else if(j&&(Xt=pt.aabb.distanceZ(Ae)*ge),this.projection.isReprojectedInTileSpace&&y<=5){const Or=Math.pow(2,pt.zoom),Lr=He(new i.aa((pt.x+.5)/Or,(pt.y+.5)/Or));Vt=Lr>.85?1:Lr}if(!C){const Or=Math.sqrt(Lt*Lt+jt*jt+Xt*Xt);let Lr=(1<<mt-pt.zoom)*qe*Vt;return Lr*=Tt(Math.max(Xt,Pt),Or),Or<Lr}let It=Number.MAX_VALUE,Ht=0;const tr=pt.aabb.getCorners(),gr=[];for(const Or of tr){i.ab.vec3.sub(gr,Or,Ae),re||(j?gr[2]*=ge:gr[2]=Pt);const Lr=i.ab.vec3.dot(gr,this._camera.forward());Lr<It&&(It=Lr,Ht=Math.abs(gr[2]))}let xr=(1<<mt-pt.zoom)*qe*Vt;if(xr*=Tt(Math.max(Ht,Pt),It),It<xr)return!0;const qr=pt.aabb.closestPoint(Y);return qr[0]===Y[0]&&qr[1]===Y[1]};if(this.renderWorldCopies)for(let pt=1;pt<=3;pt++)at.push(Xe(-pt)),at.push(Xe(pt));for(at.push(Xe(0));at.length>0;){const pt=at.pop(),Lt=pt.x,jt=pt.y;let Xt=pt.fullyVisible;const Vt=()=>this.projection.name==="globe"&&(pt.y===0||pt.y===(1<<pt.zoom)-1);if(!Xt){let It=Re?pt.aabb.intersects(oe):pt.aabb.intersectsFlat(oe);if(It===0&&Vt()){const Ht=new i.bT(pt.zoom,Lt,jt);It=i.bU(this,Z,Ht,!0).intersects(oe)}if(It===0)continue;Xt=It===2}if(pt.zoom!==mt&&$t(pt))for(let It=0;It<4;It++){const Ht=(Lt<<1)+It%2,tr=(jt<<1)+(It>>1),gr={aabb:C?pt.aabb.quadrant(It):i.bV(this,Z,pt.zoom+1,Ht,tr,pt.wrap,pt.minZ,pt.maxZ,this.projection),zoom:pt.zoom+1,x:Ht,y:tr,wrap:pt.wrap,fullyVisible:Xt,tileID:void 0,shouldSplit:void 0,minZ:pt.minZ,maxZ:pt.maxZ};j&&!re&&(gr.tileID=new i.aG(pt.zoom+1===mt?kt:pt.zoom+1,pt.wrap,pt.zoom+1,Ht,tr),ht(gr)),at.push(gr)}else{const It=pt.zoom===mt?kt:pt.zoom;if(l.minzoom&&l.minzoom>It)continue;let Ht=0;if(!Xt){let qr=Re?pt.aabb.intersectsPrecise(oe):pt.aabb.intersectsPreciseFlat(oe);if(qr===0&&Vt()){const Or=new i.bT(pt.zoom,Lt,jt);qr=i.bU(this,Z,Or,!0).intersectsPrecise(oe)}if(qr===0)continue;if(l.calculateQuadrantVisibility)if(oe.containsPoint(pt.aabb.center))Ht=15;else for(let Or=0;Or<4;Or++)pt.aabb.quadrant(Or).intersects(oe)!==0&&(Ht|=1<<Or)}const tr=Y[0]-(.5+Lt+(pt.wrap<<pt.zoom))*(1<<d-pt.zoom),gr=Y[1]-.5-jt,xr=pt.tileID?pt.tileID:new i.aG(It,pt.wrap,pt.zoom,Lt,jt);l.calculateQuadrantVisibility&&(xr.visibleQuadrants=Ht),_t.push({tileID:xr,distanceSq:tr*tr+gr*gr})}}if(this.fogCullDistSq){const pt=this.fogCullDistSq,Lt=this.horizonLineFromTop();_t=_t.filter(jt=>{const Xt=[0,0,0,1],Vt=[i.ag,i.ag,0,1],It=this.calculateFogTileMatrix(jt.tileID.toUnwrapped());i.ab.vec4.transformMat4(Xt,Xt,It),i.ab.vec4.transformMat4(Vt,Vt,It);const Ht=i.ab.vec4.min([],Xt,Vt),tr=i.ab.vec4.max([],Xt,Vt),gr=i.bW(Ht,tr);if(gr===0)return!0;let xr=!1;const qr=this._elevation;if(qr&&gr>pt&&Lt!==0){const Or=this.calculateProjMatrix(jt.tileID.toUnwrapped());let Lr;l.isTerrainDEM||(Lr=qr.getMinMaxForTile(jt.tileID)),Lr||(Lr={min:Ke,max:Qe});const Zr=i.c7(this.rotation),Ln=[Zr[0]*i.ag,Zr[1]*i.ag,Lr.max];i.ab.vec3.transformMat4(Ln,Ln,Or),xr=(1-Ln[1])*this.height*.5<Lt}return gr<pt||xr})}return _t.sort((pt,Lt)=>pt.distanceSq-Lt.distanceSq).map(pt=>pt.tileID)}resize(l,d){this.width=l,this.height=d,this.pixelsToGLUnits=[2/l,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const d=i.aw(l.lat,-i.bX,i.bX),y=this.projection.project(l.lng,d);return new i.P(y.x*this.worldSize,y.y*this.worldSize)}unproject(l){return this.projection.unproject(l.x/this.worldSize,l.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(l,d){let y,N;const j=this.centerPoint;if(this.projection.name==="globe"){const F=this.worldSize;y=(d.x-j.x)/F,N=(d.y-j.y)/F}else{const F=this.pointCoordinate(d),W=this.pointCoordinate(j);y=F.x-W.x,N=F.y-W.y}const C=this.locationCoordinate(l);this.setLocation(new i.aa(C.x-y,C.y-N))}setLocation(l){this.center=this.coordinateLocation(l),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(l){return this.projection.locationPoint(this,l)}locationPoint3D(l){return this.projection.locationPoint(this,l,!0)}pointLocation(l){return this.coordinateLocation(this.pointCoordinate(l))}pointLocation3D(l){return this.coordinateLocation(this.pointCoordinate3D(l))}locationCoordinate(l,d){const y=d?i.bH(d,l.lat):void 0,N=this.projection.project(l.lng,l.lat);return new i.aa(N.x,N.y,y)}coordinateLocation(l){return this.projection.unproject(l.x,l.y)}pointRayIntersection(l,d){const y=d??this._centerAltitude,N=[l.x,l.y,0,1],j=[l.x,l.y,1,1];i.ab.vec4.transformMat4(N,N,this.pixelMatrixInverse),i.ab.vec4.transformMat4(j,j,this.pixelMatrixInverse);const C=j[3];i.ab.vec4.scale(N,N,1/N[3]),i.ab.vec4.scale(j,j,1/C);const F=N[2],W=j[2];return{p0:N,p1:j,t:F===W?0:(y-F)/(W-F)}}screenPointToMercatorRay(l){const d=[l.x,l.y,0,1],y=[l.x,l.y,1,1];return i.ab.vec4.transformMat4(d,d,this.pixelMatrixInverse),i.ab.vec4.transformMat4(y,y,this.pixelMatrixInverse),i.ab.vec4.scale(d,d,1/d[3]),i.ab.vec4.scale(y,y,1/y[3]),d[2]=i.bH(d[2],this._center.lat)*this.worldSize,y[2]=i.bH(y[2],this._center.lat)*this.worldSize,i.ab.vec4.scale(d,d,1/this.worldSize),i.ab.vec4.scale(y,y,1/this.worldSize),new i.aq([d[0],d[1],d[2]],i.ab.vec3.normalize([],i.ab.vec3.sub([],y,d)))}rayIntersectionCoordinate(l){const{p0:d,p1:y,t:N}=l,j=i.bH(d[2],this._center.lat),C=i.bH(y[2],this._center.lat);return new i.aa(i.af(d[0],y[0],N)/this.worldSize,i.af(d[1],y[1],N)/this.worldSize,i.af(j,C,N))}pointCoordinate(l,d=this._centerAltitude){return this.projection.pointCoordinate(this,l.x,l.y,d)}pointCoordinate3D(l){if(!this.elevation)return this.pointCoordinate(l);let d=this.projection.pointCoordinate3D(this,l.x,l.y);if(d)return new i.aa(d[0],d[1],d[2]);let y=0,N=this.horizonLineFromTop();if(l.y>N)return this.pointCoordinate(l);const j=.02*N,C=l.clone();for(let F=0;F<10&&N-y>j;F++){C.y=i.af(y,N,.66);const W=this.projection.pointCoordinate3D(this,C.x,C.y);W?(N=C.y,d=W):y=C.y}return d?new i.aa(d[0],d[1],d[2]):this.pointCoordinate(l)}isPointAboveHorizon(l){return this.projection.isPointAboveHorizon(this,l)}isPointOnSurface(l){if(l.y<0||l.y>this.height||l.x<0||l.x>this.width)return!1;if(this.elevation||this.zoom>=i.bY)return!this.isPointAboveHorizon(l);const d=this.pointCoordinate(l);return d.y>=0&&d.y<=1}_coordinatePoint(l,d){const y=d&&this.elevation?this.elevation.getAtPointOrZero(l,this._centerAltitude):this._centerAltitude,N=[l.x*this.worldSize,l.y*this.worldSize,y+l.toAltitude(),1];return i.ab.vec4.transformMat4(N,N,this.pixelMatrix),N[3]>0?new i.P(N[0]/N[3],N[1]/N[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:l,left:d}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,N=this.width-this._edgeInsets.right,j=this.pointLocation3D(new i.P(d,l)),C=this.pointLocation3D(new i.P(N,l)),F=this.pointLocation3D(new i.P(N,y)),W=this.pointLocation3D(new i.P(d,y));let Z=Math.min(j.lng,C.lng,F.lng,W.lng),Y=Math.max(j.lng,C.lng,F.lng,W.lng),re=Math.min(j.lat,C.lat,F.lat,W.lat),ne=Math.max(j.lat,C.lat,F.lat,W.lat);const oe=Math.pow(2,-this.zoom)/16*270,_e=this.projection.name==="globe"?1:4,ge=(Te,Ae,Re,qe,Ue)=>{const Qe=(Te+Re)/2,Ke=(Ae+qe)/2,Ze=new i.P(Qe,Ke),{lng:He,lat:Xe}=this.pointLocation3D(Ze),at=Math.max(0,Z-He,re-Xe,He-Y,Xe-ne);Z=Math.min(Z,He),Y=Math.max(Y,He),re=Math.min(re,Xe),ne=Math.max(ne,Xe),(Ue<_e||at>oe)&&(ge(Te,Ae,Qe,Ke,Ue+1),ge(Qe,Ke,Re,qe,Ue+1))};if(ge(d,l,N,l,1),ge(N,l,N,y,1),ge(N,y,d,y,1),ge(d,y,d,l,1),this.projection.name==="globe"){const[Te,Ae]=i.bZ(this);Te?(ne=90,Y=180,Z=-180):Ae&&(re=-90,Y=180,Z=-180)}return new i.az(new i.bO(Z,re),new i.bO(Y,ne))}_getBoundsRectangular(l,d){const{top:y,left:N}=this._edgeInsets,j=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,F=new i.P(N,y),W=new i.P(C,y),Z=new i.P(C,j),Y=new i.P(N,j);let re=this.pointCoordinate(F,l),ne=this.pointCoordinate(W,l);const oe=this.pointCoordinate(Z,d),_e=this.pointCoordinate(Y,d),ge=(Te,Ae)=>(Ae.y-Te.y)/(Ae.x-Te.x);return re.y>1&&ne.y>=0?re=new i.aa((1-_e.y)/ge(_e,re)+_e.x,1):re.y<0&&ne.y<=1&&(re=new i.aa(-_e.y/ge(_e,re)+_e.x,0)),ne.y>1&&re.y>=0?ne=new i.aa((1-oe.y)/ge(oe,ne)+oe.x,1):ne.y<0&&re.y<=1&&(ne=new i.aa(-oe.y/ge(oe,ne)+oe.x,0)),new i.az().extend(this.coordinateLocation(re)).extend(this.coordinateLocation(ne)).extend(this.coordinateLocation(_e)).extend(this.coordinateLocation(oe))}_getBoundsRectangularTerrain(){const l=this.elevation;if(!l.visibleDemTiles.length||l.isUsingMockSource())return this._getBoundsRectangular(0,0);const d=l.visibleDemTiles.reduce((y,N)=>{if(N.dem){const j=N.dem.tree;y.min=Math.min(y.min,j.minimums[0]),y.max=Math.max(y.max,j.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(d.min*l.exaggeration(),d.max*l.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(l=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,y=this.height/2-d*(1-this._horizonShift);return l?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(l){this.maxBounds=l,this.minLat=-i.bX,this.maxLat=i.bX,this.minLng=-180,this.maxLng=180,l&&(this.minLat=l.getSouth(),this.maxLat=l.getNorth(),this.minLng=l.getWest(),this.maxLng=l.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.at(this.minLng)*this.tileSize,this.worldMaxX=i.at(this.maxLng)*this.tileSize,this.worldMinY=i.aA(this.maxLat)*this.tileSize,this.worldMaxY=i.aA(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(l,d){return this.projection.createTileMatrix(this,d,l)}calculateDistanceTileData(l){const d=l.key,y=this._distanceTileDataCache;if(y[d])return y[d];const N=l.canonical,j=1/this.height,C=this.cameraWorldSize,F=C/this.zoomScale(N.z),W=(N.x+Math.pow(2,N.z)*l.wrap)*F,Z=N.y*F,Y=this.point;Y.x*=C/this.worldSize,Y.y*=C/this.worldSize;const re=this.angle,ne=Math.sin(-re),oe=-Math.cos(-re);return y[d]={bearing:[ne,oe],center:[(Y.x-W)*j,(Y.y-Z)*j],scale:F/i.ag*j},y[d]}calculateFogTileMatrix(l){const d=l.key,y=this._fogTileMatrixCache;if(y[d])return y[d];const N=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,l);return i.ab.mat4.multiply(N,this.worldToFogMatrix,N),y[d]=new Float32Array(N),y[d]}calculateProjMatrix(l,d=!1,y=!1){const N=l.key;let j;if(j=y?this._expandedProjMatrixCache:d?this._alignedProjMatrixCache:this._projMatrixCache,j[N])return j[N];const C=this.calculatePosMatrix(l,this.worldSize);let F;return F=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:y?this.expandedFarZProjMatrix:d?this.alignedProjMatrix:this.projMatrix,i.ab.mat4.multiply(C,F,C),j[N]=new Float32Array(C),j[N]}calculatePixelsToTileUnitsMatrix(l){const d=l.tileID.key,y=this._pixelsToTileUnitsCache;if(y[d])return y[d];const N=i.b_(l,this);return y[d]=N,y[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const l=1/this.worldSize,d=i.ab.mat4.fromScaling([],[l,l,l]);return i.ab.mat4.multiply(d,d,this.globeMatrix),d}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const l=this._elevation;this._updateCameraState();const d=i.bH(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(d),N=this._camera.forward(),j=i.bH(1,this._center.lat);y[2]/=j,N[2]/=j,i.ab.vec3.normalize(N,N);const C=l.raycast(y,N,l.exaggeration());if(C){const F=i.ab.vec3.scaleAndAdd([],y,N,C),W=new i.aa(F[0],F[1],i.bH(F[2],i.aS(F[1]))),Z=(W.z+i.ab.vec3.length([W.x-y[0],W.y-y[1],W.z-y[2]*j]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(Z),this._centerAltitude=W.toAltitude(),this._center=this.coordinateLocation(W),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(l=!1){if(!this._elevation)return;const d=this._elevation,y=i.bH(1,this._center.lat)*this.worldSize,N=this._computeCameraPosition(y),j=d.getAtPointOrZero(new i.aa(...N)),C=this.pixelsPerMeter/this.worldSize*j,F=this._minimumHeightOverTerrain(),W=N[2]-C;if(W<=F)if(W<0||l){const Z=this.locationCoordinate(this._center,this._centerAltitude),Y=[N[0],N[1],Z.z-N[2]],re=i.ab.vec3.length(Y);Y[2]-=(F-W)/this._pixelsPerMercatorPixel;const ne=i.ab.vec3.length(Y);if(ne===0)return;i.ab.vec3.scale(Y,Y,re/ne*this._pixelsPerMercatorPixel),this._camera.position=[N[0],N[1],Z.z*this._pixelsPerMercatorPixel-Y[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||l){const ne=this.center;return ne.lat=i.aw(ne.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!l)&&(ne.lng=i.aw(ne.lng,this.minLng,this.maxLng)),this.center=ne,void(this._constraining=!1)}const d=this._unmodified,{x:y,y:N}=this.point;let j=0,C=y,F=N;const W=this.width/2,Z=this.height/2,Y=this.worldMinY*this.scale,re=this.worldMaxY*this.scale;if(N-Z<Y&&(F=Y+Z),N+Z>re&&(F=re-Z),re-Y<this.height&&(j=Math.max(j,this.height/(re-Y)),F=(re+Y)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ne=this.worldMinX*this.scale,oe=this.worldMaxX*this.scale,_e=this.worldSize/2-(ne+oe)/2;C=(y+_e+this.worldSize)%this.worldSize-_e,C-W<ne&&(C=ne+W),C+W>oe&&(C=oe-W),oe-ne<this.width&&(j=Math.max(j,this.width/(oe-ne)),C=(oe+ne)/2)}C===y&&F===N||(this.center=this.unproject(new i.P(C,F))),j&&(this.zoom+=this.scaleZoom(j)),this._constrainCamera(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let l=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(l=Math.max(l,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),l}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,d=this.projection.name==="globe",y=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bH(1,this.center.lat)/i.bH(1,i.c8));const N=i.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,N),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const j=this.projection.zAxisUnit==="meters"?y:1,C=this._camera.getWorldToCamera(this.worldSize,j);let F;const W=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(W[8]=2*-l.x/this.width,W[9]=2*l.y/this.height,this.isOrthographic){let Xe=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),at=Xe*this.aspect,_t=-at,mt=-Xe;at-=l.x,_t-=l.x,Xe+=l.y,mt+=l.y,F=this._camera.getCameraToClipOrthographic(_t,at,mt,Xe,this._nearZ,this._farZ),((kt,Pt,ht,Tt)=>{for(let $t=0;$t<16;$t++)kt[$t]=Ty(Pt[$t],ht[$t],Tt)})(F,F,W,kp(this.pitch>=15?1:this.pitch/15))}else F=W;const Z=i.ab.mat4.mul([],W,C);let Y=i.ab.mat4.mul([],F,C);if(this.projection.isReprojectedInTileSpace){const Xe=this.locationCoordinate(this.center),at=i.ab.mat4.identity([]);i.ab.mat4.translate(at,at,[Xe.x*this.worldSize,Xe.y*this.worldSize,0]),i.ab.mat4.multiply(at,at,i.c0(this)),i.ab.mat4.translate(at,at,[-Xe.x*this.worldSize,-Xe.y*this.worldSize,0]),i.ab.mat4.multiply(Y,Y,at),i.ab.mat4.multiply(Z,Z,at),this.inverseAdjustmentMatrix=i.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.ab.mat4.scale([],Y,[this.worldSize,this.worldSize,this.worldSize/j,1]),this.projMatrix=Y,this.invProjMatrix=i.ab.mat4.invert(new Float64Array(16),this.projMatrix),d){const Xe=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Xe[8]=2*-l.x/this.width,Xe[9]=2*l.y/this.height,this.expandedFarZProjMatrix=i.ab.mat4.mul([],Xe,C)}else this.expandedFarZProjMatrix=this.projMatrix;const re=i.ab.mat4.invert([],F);this.frustumCorners=i.c2.fromInvProjectionMatrix(re,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!d);const ne=new Float32Array(16);i.ab.mat4.identity(ne),i.ab.mat4.scale(ne,ne,[1,-1,1]),i.ab.mat4.rotateX(ne,ne,this._pitch),i.ab.mat4.rotateZ(ne,ne,this.angle);const oe=i.ab.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.ab.mat4.clone(oe);const _e=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;oe[8]=2*-l.x/this.width,oe[9]=2*(l.y+_e)/this.height,this.skyboxMatrix=i.ab.mat4.multiply(ne,oe,ne);const ge=this.point,Te=ge.x,Ae=ge.y,Re=this.width%2/2,qe=this.height%2/2,Ue=Math.cos(this.angle),Qe=Math.sin(this.angle),Ke=Te-Math.round(Te)+Ue*Re+Qe*qe,Ze=Ae-Math.round(Ae)+Ue*qe+Qe*Re,He=new Float64Array(Y);if(i.ab.mat4.translate(He,He,[Ke>.5?Ke-1:Ke,Ze>.5?Ze-1:Ze,0]),this.alignedProjMatrix=He,Y=i.ab.mat4.create(),i.ab.mat4.scale(Y,Y,[this.width/2,-this.height/2,1]),i.ab.mat4.translate(Y,Y,[1,-1,0]),this.labelPlaneMatrix=Y,Y=i.ab.mat4.create(),i.ab.mat4.scale(Y,Y,[1,-1,1]),i.ab.mat4.translate(Y,Y,[-1,-1,0]),i.ab.mat4.scale(Y,Y,[2/this.width,2/this.height,1]),this.glCoordMatrix=Y,this.pixelMatrix=i.ab.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,Z),this._calcFogMatrices(),this._distanceTileDataCache={},Y=i.ab.mat4.invert(new Float64Array(16),this.pixelMatrix),!Y)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=Y,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.c3(this);const Xe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ab.vec3.transformMat4(Xe,Xe,C),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=Y;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const l=this.cameraWorldSizeForFog,d=this.cameraPixelsPerMeter,y=this._camera.position,N=1/this.height/this._pixelsPerMercatorPixel,j=[l,l,d];i.ab.vec3.scale(j,j,N),i.ab.vec3.scale(y,y,-1),i.ab.vec3.multiply(y,y,j);const C=i.ab.mat4.create();i.ab.mat4.translate(C,C,y),i.ab.mat4.scale(C,C,j),this.mercatorFogMatrix=C,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(l,d,N)}_computeCameraPosition(l){const d=(l=l||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),N=this.point,j=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-l/this.worldSize*this._centerAltitude;return[N.x/this.worldSize-y[0]*j,N.y/this.worldSize-y[1]*j,l/this.worldSize*this._centerAltitude-y[2]*j]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(l){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],N=l[2];let j=1;this.projection.wrap&&(this.center=this.center.wrap()),N>0&&(j=Math.min((d-y)/N,1)),this._camera.position=i.ab.vec3.scaleAndAdd([],this._camera.position,l,j),this._updateStateFromCamera()}_updateStateFromCamera(){const l=this._camera.position,d=this._camera.forward(),{pitch:y,bearing:N}=this._camera.getPitchBearing(),j=i.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,C=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.ai(this._maxPitch)),F=Math.max((l[2]-j)/Math.cos(y),C),W=this._zoomFromMercatorZ(F);i.ab.vec3.scaleAndAdd(l,l,d,F),this._pitch=i.aw(y,i.ai(this.minPitch),i.ai(this.maxPitch)),this.angle=i.bF(N,-Math.PI,Math.PI),this._setZoom(i.aw(W,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.aa(l[0],l[1],l[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(l){return Math.pow(2,l)*this.tileSize}_mercatorZfromZoom(l){return this.cameraToCenterDistance/this._worldSizeFromZoom(l)}_minimumHeightOverTerrain(){const l=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(l)}_zoomFromMercatorZ(l){return this.scaleZoom(this.cameraToCenterDistance/(l*this.tileSize))}zoomFromMercatorZAdjusted(l){let d=0,y=i.bY,N=0,j=1/0;for(;y-d>1e-6&&y>d;){const C=d+.5*(y-d),F=this.tileSize*Math.pow(2,C),W=this.getCameraToCenterDistance(this.projection,C,F),Z=this.scaleZoom(W/(l*this.tileSize)),Y=Math.abs(C-Z);Y<j&&(j=Y,N=C),C<Z?d=C:y=C}return N}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(l,d){const y=Math.min(l.x,d.x),N=Math.max(l.x,d.x),j=Math.min(l.y,d.y),C=Math.max(l.y,d.y);if(j<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const F=[new i.P(y,j),new i.P(N,C),new i.P(y,C),new i.P(N,j)],W=this.renderWorldCopies?-3:0,Z=this.renderWorldCopies?4:1;for(const Y of F){const re=this.pointRayIntersection(Y);if(re.t<0)return!0;const ne=this.rayIntersectionCoordinate(re);if(ne.x<W||ne.y<0||ne.x>Z||ne.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(l,d){const y=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,l)),N=this._zoomFromMercatorZ(y)+d;return y-this._mercatorZfromZoom(N)}getCameraPoint(){if(this.projection.name==="globe"){const l=function([d,y,N],j){const C=[d,y,N,1];i.ab.vec4.transformMat4(C,C,j);const F=C[3]=Math.max(C[3],1e-6);return C[0]/=F,C[1]/=F,C[2]/=F,C}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(l[0],l[1])}{const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,l))}}getCameraToCenterDistance(l,d=this.zoom,y=this.worldSize){const N=i.b$(l,d,this.width,this.height,1024),j=l.pixelSpaceConversion(this.center.lat,y,N);let C=.5/Math.tan(.5*this._fov)*this.height*j;return this.isOrthographic&&(C=Ty(1,C,kp(this.pitch>=15?1:this.pitch/15))),C}getWorldToCameraMatrix(){const l=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.ab.mat4.multiply(l,l,this.globeMatrix),l}getFrustum(l){return i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,this.projection.zAxisUnit==="meters")}}const Bl=(g,l)=>{if(l>0&&g.terrain&&i.w("Cutoff is currently disabled on terrain"),l<=0||g.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const d=g.transform,y=Math.max(Math.abs(d._zoom-(g.minCutoffZoom-1)),1),N=d.isLODDisabled(!1)?i.ac(60,45,d.pitch):i.ac(30,15,d.pitch),j=d._farZ-d._nearZ,C=l*d.height,F=((1-(W=N))*d.cameraToCenterDistance+W*(d._farZ+C))*y;var W;return{shouldRenderCutoff:N<1,uniformValues:{u_cutoff_params:[d._nearZ,d._farZ,(F-d._nearZ)/j,(F-C-d._nearZ)/j]}}},Va={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class uu{constructor(l,d){this.aabb=l,this.lastCascade=d}}class hf{add(l,d){const y=this.receivers[l.key];y!==void 0?(y.aabb.min[0]=Math.min(y.aabb.min[0],d.min[0]),y.aabb.min[1]=Math.min(y.aabb.min[1],d.min[1]),y.aabb.min[2]=Math.min(y.aabb.min[2],d.min[2]),y.aabb.max[0]=Math.max(y.aabb.max[0],d.max[0]),y.aabb.max[1]=Math.max(y.aabb.max[1],d.max[1]),y.aabb.max[2]=Math.max(y.aabb.max[2],d.max[2])):this.receivers[l.key]=new uu(d,null)}clear(){this.receivers={}}get(l){return this.receivers[l.key]}computeRequiredCascades(l,d,y){const N=i.cd.fromPoints(l.points);let j=0;for(const C in this.receivers){const F=this.receivers[C];if(!F||!N.intersectsAabb(F.aabb))continue;F.aabb.min=N.closestPoint(F.aabb.min),F.aabb.max=N.closestPoint(F.aabb.max);const W=F.aabb.getCorners();for(let Z=0;Z<y.length;Z++){let Y=!0;for(const re of W){const ne=[re[0]*d,re[1]*d,re[2]];if(i.ab.vec3.transformMat4(ne,ne,y[Z].matrix),ne[0]<-1||ne[0]>1||ne[1]<-1||ne[1]>1){Y=!1;break}}if(F.lastCascade=Z,j=Math.max(j,Z),Y)break}}return j+1}}class Xd{constructor(l){this.painter=l,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new hf,this._depthMode=new zr(l.context.gl.LEQUAL,zr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,l.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),l.tp.registerParameter(Va,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),l.tp.registerParameter(Va,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),l.tp.registerParameter(Va,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),l.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const l of this._cascades)l.texture.destroy(),l.framebuffer.destroy();this._cascades=[]}updateShadowParameters(l,d){const y=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!d||!d.properties)return;const N=d.properties.get("shadow-intensity");if(!d.shadowsEnabled()||N<=0||(this._shadowLayerCount=y.style.order.reduce((_e,ge)=>{const Te=y.style._mergedLayers[ge];return _e+(Te.hasShadowPass()&&!Te.isHidden(l.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const j=y.context,C=Va.shadowMapResolution,F=Va.shadowMapResolution;if(this._cascades.length===0||Va.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let _e=0;_e<Va.cascadeCount;++_e){const ge=y._shadowMapDebug,Te=j.gl,Ae=j.createFramebuffer(C,F,ge,"texture"),Re=new i.T(j,{width:C,height:F,data:null},Te.DEPTH_COMPONENT16);if(Ae.depthAttachment.set(Re.texture),ge){const qe=new i.T(j,{width:C,height:F,data:null},Te.RGBA8);Ae.colorAttachment.set(qe.texture)}this._cascades.push({framebuffer:Ae,texture:Re,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bR,scale:0})}}this.shadowDirection=du(d);let W=0;if(l.elevation){const _e=l.elevation,ge=[1e4,-1e4];_e.visibleDemTiles.filter(Te=>Te.dem).forEach(Te=>{const Ae=Te.dem.tree;ge[0]=Math.min(ge[0],Ae.minimums[0]),ge[1]=Math.max(ge[1],Ae.maximums[0])}),ge[0]!==1e4&&(W=(ge[1]-ge[0])*_e.exaggeration())}const Z=1.5*l.cameraToCenterDistance,Y=3*Z,re=new Float64Array(16);for(let _e=0;_e<this._cascades.length;++_e){const ge=this._cascades[_e];let Te=l.height/50,Ae=1;Va.cascadeCount===1?Ae=Y:_e===0?Ae=Z:(Te=Z,Ae=Y);const[Re,qe]=ux(l,this.shadowDirection,Te,Ae,Va.shadowMapResolution,W);ge.scale=l.scale,ge.matrix=Re,ge.boundingSphereRadius=qe,i.ab.mat4.invert(re,ge.matrix),ge.frustum=i.bR.fromInvProjectionMatrix(re,1,0,!0),ge.far=Ae}const ne=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[ne].far,this._cascades[ne].far],this._uniformValues.u_shadow_intensity=N,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Va.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Va.shadowMapResolution,this._uniformValues.u_shadowmap_0=Gs.ShadowMap0,this._uniformValues.u_shadowmap_1=Gs.ShadowMap0+1,this._groundShadowTiles=y.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const oe=y.transform.elevation;for(const _e of this._groundShadowTiles){let ge={min:0,max:0};if(oe){const Te=oe.getMinMaxForTile(_e);Te&&(ge=Te)}this.addShadowReceiver(_e.toUnwrapped(),ge.min,ge.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(l){this._enabled=l}drawShadowPass(l,d){if(!this.enabled)return;const y=this.painter,N=y.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(y.transform.getFrustum(0),y.transform.worldSize,this._cascades),N.viewport.set([0,0,Va.shadowMapResolution,Va.shadowMapResolution]);for(let j=0;j<this._numCascadesToRender;++j){y.currentShadowCascade=j,N.bindFramebuffer.set(this._cascades[j].framebuffer.framebuffer),N.clear({color:i.aj.white,depth:1});for(const C of l.order){const F=l._mergedLayers[C];if(!F.hasShadowPass()||F.isHidden(y.transform.zoom))continue;const W=l.getLayerSourceCache(F),Z=W?d[W.id]:void 0;(F.type==="model"||Z&&Z.length)&&y.renderLayer(y,W,F,Z)}}y.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const l=this.painter,d=l.style,y=l.context,N=d.directionalLight,j=d.ambientLight;if(!N||!j)return;const C=[],F=Bl(l,l.longestCutoffRange);F.shouldRenderCutoff&&C.push("RENDER_CUTOFF"),C.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&C.push("NORMAL_OFFSET");const W=Pp(d,N,j),Z=new zr(y.gl.LEQUAL,zr.ReadOnly,l.depthRangeFor3D);for(const Y of this._groundShadowTiles){const re=Y.toUnwrapped(),ne=l.isTileAffectedByFog(Y),oe=l.getOrCreateProgram("groundShadow",{defines:C,overrideFog:ne});this.setupShadows(re,oe),l.uploadCommonUniforms(y,oe,re,null,F);const _e={u_matrix:l.transform.calculateProjMatrix(re),u_ground_shadow_factor:W};oe.draw(l,y.gl.TRIANGLES,Z,Wr.disabled,kn.multiply,Jr.disabled,_e,"ground_shadow",l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments,{},l.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?kn.unblended:kn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(l){const d=this.painter.transform,y=d.calculatePosMatrix(l,d.worldSize);return i.ab.mat4.multiply(y,this._cascades[this.painter.currentShadowCascade].matrix,y),Float32Array.from(y)}calculateShadowPassMatrixFromMatrix(l){return i.ab.mat4.multiply(l,this._cascades[this.painter.currentShadowCascade].matrix,l),Float32Array.from(l)}setupShadows(l,d,y,N=0){if(!this.enabled)return;const j=this.painter.transform,C=this.painter.context,F=C.gl,W=this._uniformValues,Z=new Float64Array(16),Y=j.calculatePosMatrix(l,j.worldSize);for(let re=0;re<this._cascades.length;re++)i.ab.mat4.multiply(Z,this._cascades[re].matrix,Y),W[re===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(Z),C.activeTexture.set(F.TEXTURE0+Gs.ShadowMap0+re),this._cascades[re].texture.bind(F.NEAREST,F.CLAMP_TO_EDGE);if(this.useNormalOffset=!!y,this.useNormalOffset){const re=i.cc(l.canonical),ne=2/j.tileSize*i.ag/Va.shadowMapResolution,oe=ne*this._cascades[0].boundingSphereRadius,_e=ne*this._cascades[this._cascades.length-1].boundingSphereRadius,ge=(y==="vector-tile"?1:3)/Math.pow(2,N-l.canonical.z-(1-j.zoom+Math.floor(j.zoom)));W.u_shadow_normal_offset=[re,oe*ge,_e*ge],W.u_shadow_bias=[6e-5,.0012,.012]}else W.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(C,W)}setupShadowsFromMatrix(l,d,y=!1){if(!this.enabled)return;const N=this.painter.context,j=N.gl,C=this._uniformValues,F=new Float64Array(16);for(let W=0;W<Va.cascadeCount;W++)i.ab.mat4.multiply(F,this._cascades[W].matrix,l),C[W===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(F),N.activeTexture.set(j.TEXTURE0+Gs.ShadowMap0+W),this._cascades[W].texture.bind(j.NEAREST,j.CLAMP_TO_EDGE);if(this.useNormalOffset=y,y){const W=Va.normalOffset;C.u_shadow_normal_offset=[1,W,W],C.u_shadow_bias=[6e-5,.0012,.012]}else C.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(N,C)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(l,d,y,N){if(N[2]>=0)return{};const j=function(W,Z,Y){const re=Y/(1<<W.canonical.z);return new i.cd([W.canonical.x*re+W.wrap*Y,W.canonical.y*re+W.wrap*Y,0],[(W.canonical.x+1)*re+W.wrap*Y,(W.canonical.y+1)*re+W.wrap*Y,Z])}(l,d,y).getCorners(),C=d/-N[2];N[0]<0?(i.ab.vec3.add(j[0],j[0],[N[0]*C,0,0]),i.ab.vec3.add(j[3],j[3],[N[0]*C,0,0])):N[0]>0&&(i.ab.vec3.add(j[1],j[1],[N[0]*C,0,0]),i.ab.vec3.add(j[2],j[2],[N[0]*C,0,0])),N[1]<0?(i.ab.vec3.add(j[0],j[0],[0,N[1]*C,0]),i.ab.vec3.add(j[1],j[1],[0,N[1]*C,0])):N[1]>0&&(i.ab.vec3.add(j[2],j[2],[0,N[1]*C,0]),i.ab.vec3.add(j[3],j[3],[0,N[1]*C,0]));const F={};return F.vertices=j,F.planes=[Ju(j[1],j[0],j[4]),Ju(j[2],j[1],j[5]),Ju(j[3],j[2],j[6]),Ju(j[0],j[3],j[7])],F}addShadowReceiver(l,d,y){this._receivers.add(l,i.cd.fromTileIdAndHeight(l,d,y))}getMaxCascadeForTile(l){const d=this._receivers.get(l);return d&&d.lastCascade?d.lastCascade:0}}function Ju(g,l,d){const y=i.ab.vec3.sub([],d,l),N=i.ab.vec3.sub([],g,l),j=i.ab.vec3.cross([],y,N),C=i.ab.vec3.length(j);return C===0?[0,0,1,0]:(i.ab.vec3.scale(j,j,1/C),[j[0],j[1],j[2],-i.ab.vec3.dot(j,l)])}function du(g){const l=g.properties.get("direction"),d=i.cb(l.x,l.y,l.z);d[2]=i.aw(d[2],0,75);const y=i.ce([d[0],d[1],d[2]]);return i.ab.vec3.fromValues(y.x,y.y,y.z)}function Pp(g,l,d){const y=l.properties.get("color-use-theme")==="none",N=l.properties.get("color"),j=l.properties.get("intensity"),C=l.properties.get("direction"),F=[C.x,C.y,C.z],W=d.properties.get("color-use-theme")==="none",Z=d.properties.get("color"),Y=d.properties.get("intensity"),re=Math.max(i.ab.vec3.dot([0,0,1],F),0),ne=[0,0,0];i.ab.vec3.scale(ne,Z.toRenderColor(W?null:g.getLut(l.scope)).toArray01Linear().slice(0,3),Y);const oe=[0,0,0];return i.ab.vec3.scale(oe,N.toRenderColor(y?null:g.getLut(d.scope)).toArray01Linear().slice(0,3),re*j),i.cf([ne[0]>0?ne[0]/(ne[0]+oe[0]):0,ne[1]>0?ne[1]/(ne[1]+oe[1]):0,ne[2]>0?ne[2]/(ne[2]+oe[2]):0])}function ux(g,l,d,y,N,j){const C=g.zoom,F=g.scale,W=g.worldSize,Z=1/W,Y=g.aspect,re=Math.sqrt(1+Y*Y)*Math.tan(.5*g.fovX),ne=re*re,oe=y-d,_e=y+d;let ge,Te;ne>oe/_e?(ge=y,Te=y*re):(ge=.5*_e*(1+ne),Te=.5*Math.sqrt(oe*oe+2*(y*y+d*d)*ne+_e*_e*ne*ne));const Ae=g.projection.pixelsPerMeter(g.center.lat,W),Re=g._camera.getCameraToWorldMercator(),qe=[0,0,-ge*Z];i.ab.vec3.transformMat4(qe,qe,Re);let Ue=Te*Z;const Qe=g._edgeInsets;if(!(Qe.left===0&&Qe.top===0&&Qe.right===0&&Qe.bottom===0||Qe.left===Qe.right&&Qe.top===Qe.bottom)){const Xt=g._camera.getWorldToCamera(g.worldSize,g.projection.zAxisUnit==="meters"?Ae:1),Vt=g._camera.getCameraToClipPerspective(g._fov,g.width/g.height,d,y);Vt[8]=2*-g.centerOffset.x/g.width,Vt[9]=2*g.centerOffset.y/g.height;const It=new Float64Array(16);i.ab.mat4.mul(It,Vt,Xt);const Ht=new Float64Array(16);i.ab.mat4.invert(Ht,It);const tr=i.bR.fromInvProjectionMatrix(Ht,W,C,!0);for(const gr of tr.points){const xr=((Ke=gr)[0]/=F,Ke[1]/=F,Ke[2]=i.bH(Ke[2],g._center.lat),Ke);Ue=Math.max(Ue,i.ab.vec3.len(i.ab.vec3.subtract([],qe,xr)))}}var Ke;Ue*=N/(N-1);const Ze=Math.acos(l[2]),He=Math.atan2(-l[0],-l[1]),Xe=new vs;Xe.position=qe,Xe.setPitchBearing(Ze,He);const at=Xe.getWorldToCamera(W,Ae),_t=Ue*W,mt=Math.min(g._mercatorZfromZoom(17)*W*-2,-2*_t),kt=Xe.getCameraToClipOrthographic(-_t,_t,-_t,_t,mt,(_t+j*Ae)/l[2]),Pt=new Float64Array(16);i.ab.mat4.multiply(Pt,kt,at);const ht=i.ab.vec3.fromValues(Math.floor(1e6*qe[0])/1e6*W,Math.floor(1e6*qe[1])/1e6*W,0),Tt=.5*N,$t=[0,0,0];i.ab.vec3.transformMat4($t,ht,Pt),i.ab.vec3.scale($t,$t,Tt);const pt=[Math.floor($t[0]),Math.floor($t[1]),Math.floor($t[2])],Lt=[0,0,0];i.ab.vec3.sub(Lt,$t,pt),i.ab.vec3.scale(Lt,Lt,-1/Tt);const jt=new Float64Array(16);return i.ab.mat4.identity(jt),i.ab.mat4.translate(jt,jt,Lt),i.ab.mat4.multiply(Pt,jt,Pt),[Pt,_t]}class Wm extends i.E{constructor(l){super(),this.requestManager=l,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(l,d){return i.aM(this.requestManager.transformRequest(d,i.R.Model).url).then(y=>{if(!y)return;const N=i.aN(y),j=new i.aO(l,void 0,void 0,N);return j.computeBoundsAndApplyParent(),j}).catch(y=>{if(y&&y.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${l} from ${d}: ${y.message}`)))})}load(l,d,y={keepNumReferences:!1}){this.models[d]||(this.models[d]={});const N=Object.keys(l);this.numModelsLoading[d]=(this.numModelsLoading[d]||0)+N.length;const j=[];for(const C of N)j.push(this.loadModel(C,l[C]));Promise.allSettled(j).then(C=>{for(let F=0;F<C.length;F++){const{status:W,value:Z}=C[F];if(W==="fulfilled"&&Z){const Y=this.models[d][N[F]];this.models[d][N[F]]={model:Z,numReferences:y.keepNumReferences&&Y?Y.numReferences:1}}}this.numModelsLoading[d]-=N.length,this.fire(new i.z("data",{dataType:"style"}))}).catch(C=>{this.fire(new i.y(new Error(`Could not load models: ${C.message}`)))})}isLoaded(){for(const l in this.numModelsLoading)if(this.numModelsLoading[l]>0)return!1;return!0}hasModel(l,d){return!!this.getModel(l,d)}getModel(l,d){return this.models[d]||(this.models[d]={}),this.models[d][l]?this.models[d][l].model:void 0}addModel(l,d,y){this.models[y]||(this.models[y]={}),this.modelUris[y]||(this.modelUris[y]={}),this.hasModel(l,y)&&this.models[y][l].numReferences++,this.modelUris[y][l]=this.requestManager.normalizeModelURL(d),this.load({[l]:this.modelUris[y][l]},y)}addModels(l,d){this.models[d]||(this.models[d]={}),this.modelUris[d]||(this.modelUris[d]={});const y=this.modelUris[d];for(const N in l)this.models[d][N]={},y[N]=this.requestManager.normalizeModelURL(l[N]);this.load(y,d,{keepNumReferences:!0})}reloadModels(l){this.load(this.modelUris[l],l)}addModelsFromBucket(l,d){this.models[d]||(this.models[d]={}),this.modelUris[d]||(this.modelUris[d]={});const y={};for(const N of l)this.hasModel(N,d)?this.models[d][N].numReferences++:(this.modelUris[d][N]=this.requestManager.normalizeModelURL(N),y[N]=this.modelUris[d][N]);this.load(y,d)}removeModel(l,d){if(this.models[d]&&this.models[d][l]&&(this.models[d][l].numReferences--,this.models[d][l].numReferences===0)){const y=this.models[d][l].model;delete this.models[d][l],delete this.modelUris[d][l],y.destroy()}}listModels(l){return this.models[l]||(this.models[l]={}),Object.keys(this.models[l])}upload(l,d){this.models[d]||(this.models[d]={});for(const y in this.models[d])this.models[d][y].model&&this.models[d][y].model.upload(l.context)}}const dx=new i.a5({data:new i.a6(i.a3.colorTheme.data)}),hx={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function jy(g){return g=g||{},Object.assign(g,hx)}class ky extends i.E{constructor(l){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aP(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=l,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(l=>{l.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=l.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=l.stylesheet.indoor.buildingFeaturesetId,this._scope=l.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:l=>(l.feature&&l.feature.properties.floorplan&&this.selectFloorplan(l.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(l){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(C,F){const[W,Z]=C,{center:Y,radius:re}=F,[ne,oe]=Y,_e=Math.abs(W-ne);return Math.sqrt((_e>180?360-_e:_e)**2+(Z-oe)**2)<=re}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.z("floorplangone")));const d={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},y=new i.P(this._map.transform.width/2,this._map.transform.height/2),N=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],j=this._map.queryRenderedFeatures(l?N:y,d);j.length>0&&(this._selectedFloorplan&&j[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=j[0],this._floorplanSelected(!1)))}_floorplanSelected(l){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(j){const[[C,F],[W,Z]]=j,Y=(W-C+360)%360,re=Y>180?360-Y:Y;return{center:[(C+re/2+360)%360,(F+Z)/2],radius:Math.sqrt(re**2+(Z-F)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const d=this._floorplanStates[this._indoorData.id].selectedBuilding,y=this._floorplanStates[this._indoorData.id].selectedLevel;let N;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const j of this._indoorData.levels)j.id===this._selectedLevel.id&&(N=j.id);if(this.fire(new i.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:N})),d){const j=this._indoorData.buildings.find(C=>C.id===d);this._buildingSelected(j,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(y){const j=this._indoorData.levels.find(C=>C.id===y);this._updateLevels(j,l)}else l&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(l,d){d&&l&&l.extent&&this._map.fitBounds(l.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=l?l.id:void 0;const y=this._indoorData.levels.filter(N=>l.levels.includes(N.id));this.fire(new i.z("buildingselected",{buildingId:l.id,levels:y}))}_levelSelected(l){if(l==="overview")this._updateLevels(void 0,!0);else{const d=this._indoorData.levels.find(y=>y.id===l);this._updateLevels(d,!0)}this.fire(new i.z("levelselected",{levelId:l==="overview"?void 0:l}))}_updateLevels(l,d){if(!l)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(d&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function y(Z){const Y=Z.indexOf("/floor/");if(Y===-1)return Z;const re=Y+7,ne=Z.indexOf("/",re);return ne===-1?Z.slice(re):Z.slice(re,ne)}this._selectedLevel=l,this._floorplanStates[this._indoorData.id].selectedLevel=l?l.id:void 0;const N=[],j={},C={},F={},W={};for(const Z of this._indoorData.levels)if(N.push(Z.id),j[Z.id]=Z.height,C[Z.id]=Z.base,l){if(this.mergeFloors){const Y=y(l.id),re=y(Z.id);F[Z.id]=re===Y?"true":"false"}else F[Z.id]=Z.id===l.id?"true":"false";W[Z.id]=Z.base<l.base?"true":"false"}else W[Z.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",N]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",j]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",C]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",F]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",W]),l&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!l.isUnderground),d&&l.extent)){const Z=this._map.cameraForBounds(l.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),Y=this._map.getZoom(),re=Z.zoom?Math.abs(Y-Z.zoom):0;this._map.fitBounds(l.extent,re>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:Y})}}selectFloorplan(l){const d={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},y=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],N=this._map.queryRenderedFeatures(y,d);if(N.length>0){for(const j of N)if(JSON.parse(j.properties["indoor-data"]).floorplanIDs.includes(l)){this._selectedFloorplan=j,this._floorplanSelected(!0);break}}}selectBuilding(l){const d=this._indoorData.buildings.find(y=>y.id===l);this._buildingSelected(d,!0)}selectLevel(l){this._levelSelected(l)}}function K_(g){if(!g.metadata||!g.metadata.content_area)return;const l=i.q.devicePixelRatio,{left:d,top:y,width:N,height:j}=g.metadata.content_area,C=d*l,F=y*l;return[C,F,C+N*l,F+j*l]}function fx(g){if(g)return g.map(([l,d])=>[l*i.q.devicePixelRatio,d*i.q.devicePixelRatio])}const no=(g,l)=>Ko(g,l&&l.filter(d=>d.identifier!=="source.canvas")),Cp=i.ay(xn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),Py=i.ay(xn,["setCenter","setZoom","setBearing","setPitch"]),Hm=new Set(["background","sky","slot","custom"]),ff={version:8,layers:[],sources:{}},Cy={duration:300,delay:0};class Xo extends i.E{constructor(l,d={}){super(),this.map=l,this.scope=d.scope||"",this.globalId=null,this.fragments=[],this.importDepth=d.importDepth||0,this.importsCache=d.importsCache||new Map,this.resolvedImports=d.resolvedImports||new Set,this.transition=i.l({},Cy),this._buildingIndex=new su(this),this.crossTileSymbolIndex=new Ay,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=d.styleChanges||new on,this.dispatcher=d.dispatcher?d.dispatcher:new i.D(i.ci(),this),d.imageManager?this.imageManager=d.imageManager:(this.imageManager=new En(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=d.glyphManager?d.glyphManager:new i.cj(l._requestManager,d.localFontFamily?i.ck.all:d.localIdeographFontFamily?i.ck.ideographs:i.ck.none,d.localFontFamily||d.localIdeographFontFamily),d.modelManager?this.modelManager=d.modelManager:(this.modelManager=new Wm(l._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=d.configOptions?d.configOptions:new Map,this._configDependentLayers=d.configDependentLayers?d.configDependentLayers:new Set,this._config=d.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:d.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=d.initialConfig,this.dispatcher.broadcast("setReferrer",i.cl());const y=this;this._rtlTextPluginCallback=Xo.registerForPluginStateChange(N=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:N.pluginStatus,pluginURL:N.pluginURL},(j,C)=>{if(i.cm(j),C&&C.every(F=>F))for(const F in y._sourceCaches){const W=y._sourceCaches[F],Z=W.getSource().type;Z!=="vector"&&Z!=="geojson"||W.reload()}})}),this.on("data",N=>{if(N.dataType!=="source"||N.sourceDataType!=="metadata")return;const j=this.getOwnSource(N.sourceId);if(j&&j.vectorLayerIds)for(const C in this._layers){const F=this._layers[C];F.source===j.id&&this._validateLayer(F)}})}load(l){return l?(typeof l=="string"?this.loadURL(l):this.loadJSON(l),this):this}_getGlobalId(l){if(!l)return null;if(typeof l=="string"){if(i.f(l))return l;const d=i.cn(l);if(!d.startsWith("http"))try{return new URL(d,location.href).toString()}catch{return d}return d}return`json://${i.co(JSON.stringify(l))}`}_diffStyle(l,d,y){this.globalId=this._getGlobalId(l);const N=(j,C)=>{try{C(null,this.setState(j,y))}catch(F){C(F,!1)}};if(typeof l=="string"){const j=this.map._requestManager.normalizeStyleURL(l),C=this.map._requestManager.transformRequest(j,i.R.Style);i.n(C,(F,W)=>{F?this.fire(new i.y(F)):W&&N(W,d)})}else typeof l=="object"&&N(l,d)}loadURL(l,d={}){this.fire(new i.z("dataloading",{dataType:"style"}));const y=typeof d.validate=="boolean"?d.validate:!i.f(l);this.globalId=this._getGlobalId(l),l=this.map._requestManager.normalizeStyleURL(l,d.accessToken),this.resolvedImports.add(l);const N=this.importsCache.get(l);if(N)return this._load(N,y);const j=this.map._requestManager.transformRequest(l,i.R.Style);this._request=i.n(j,(C,F)=>{if(this._request=null,C)this.fire(new i.y(C));else if(F)return this.importsCache.set(l,F),this._load(F,y)})}loadJSON(l,d={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(l),this._request=i.q.frame(()=>{this._request=null,this._load(l,d.validate!==!1)})}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(ff,!1)}_loadImports(l,d,y){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const N=[];for(const j of l){const C=this._createFragmentStyle(j),F=new Promise(Y=>{C.once("style.import.load",Y),C.once("error",Y)}).then(()=>this.mergeAll());if(N.push(F),this.resolvedImports.has(j.url)){C.loadEmpty();continue}const W=j.data||this.importsCache.get(j.url);W?(C.loadJSON(W,{validate:d}),this._isInternalStyle(W)&&(C.globalId=null)):j.url?C.loadURL(j.url,{validate:d}):C.loadEmpty();const Z={style:C,id:j.id,config:j.config};if(y){const Y=this.fragments.findIndex(({id:re})=>re===y);this.fragments=this.fragments.slice(0,Y).concat(Z).concat(this.fragments.slice(Y))}else this.fragments.push(Z)}return Promise.allSettled(N)}getImportGlobalIds(l=this,d=new Set){for(const y of l.fragments)y.style.globalId&&d.add(y.style.globalId),this.getImportGlobalIds(y.style,d);return[...d.values()]}_createFragmentStyle(l){const d=this.scope?i.aC(l.id,this.scope):l.id;let y;const N=this._initialConfig&&this._initialConfig[d];(l.config||N)&&(y=i.l({},l.config,N));const j=new Xo(this.map,{scope:d,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:y,configOptions:this.options,colorThemeOverride:l["color-theme"],configDependentLayers:this._configDependentLayers});return j.setEventedParent(this.map,{style:j}),j}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(l){return this.isRootStyle()&&(l.fragment||!!l.schema&&l.fragment!==!1)}_load(l,d){const y=l.indoor?jy(l.schema):l.schema;if(this._isInternalStyle(l)){const C=i.l({},ff,{imports:[{id:"basemap",data:l,url:""}]});return void this._load(C,d)}if(this.updateConfig(this._config,y),d&&no(this,Ha(l)))return;this._loaded=!0,this.stylesheet=i.cp(l);const N=()=>{for(const Z in l.sources)this.addSource(Z,l.sources[Z],{validate:!1,isInitialLoad:!0});l.sprite?this._loadIconset(l.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(l.glyphs,this.scope);const C=Ku(this.stylesheet.layers);if(this._order=C.map(Z=>Z.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const Z=this.stylesheet.lights[0];this.light=new ve(Z.properties,Z.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new ve(this.stylesheet.light)),this._layers={};for(const Z of C){const Y=i.cu(Z,this.scope,this._styleColorTheme.lut,this.options);Y.configDependencies.size!==0&&this._configDependentLayers.add(Y.fqid),Y.setEventedParent(this,{layer:{id:Y.id}}),this._layers[Y.id]=Y;const re=this.getOwnLayerSourceCache(Y),ne=!!this.directionalLight&&this.directionalLight.shadowsEnabled();re&&Y.canCastShadows()&&ne&&(re.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const F=this.stylesheet.terrain;F&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(F,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const W=this.isRootStyle();l.imports?this._loadImports(l.imports,d).then(()=>{this._reloadImports(),this.fire(new i.z(W?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.z(W?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const j=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(j){const C=this._evaluateColorThemeData(j);this._loadColorTheme(C).then(()=>{N()}).catch(F=>{i.w(`Couldn't load color theme from the stylesheet: ${F}`),N()})}else this._styleColorTheme.lut=null,N()}isRootStyle(){return this.importDepth===0}mergeAll(){let l,d,y,N,j,C,F,W,Z,Y;const re={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(ne=>{if(ne.stylesheet){if(ne.light!=null&&(l=ne.light),ne.stylesheet.lights)for(const oe of ne.stylesheet.lights)oe.type==="ambient"&&ne.ambientLight!=null&&(d=ne.ambientLight),oe.type==="directional"&&ne.directionalLight!=null&&(y=ne.directionalLight);N=this._prioritizeTerrain(N,ne.terrain,ne.stylesheet.terrain),ne.stylesheet.fog&&ne.fog!=null&&(j=ne.fog),ne.stylesheet.snow&&ne.snow!=null&&(C=ne.snow),ne.stylesheet.rain&&ne.rain!=null&&(F=ne.rain),ne.stylesheet.camera!=null&&(Y=ne.stylesheet.camera),ne.stylesheet.projection!=null&&(W=ne.stylesheet.projection),ne.stylesheet.transition!=null&&(Z=ne.stylesheet.transition),re[ne.scope]=ne._styleColorTheme}}),this.light=l,this.ambientLight=d,this.directionalLight=y,this.fog=j,this.snow=C,this.rain=F,this._styleColorThemeForScope=re,N===null?delete this.terrain:this.terrain=N,this.camera=Y||{"camera-projection":"perspective"},this.projection=W||{name:"mercator"},this.transition=i.l({},Cy,Z),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(l){const d=y=>{for(const N of y.fragments)d(N.style);l(y)};d(this)}_prioritizeTerrain(l,d,y){const N=l&&l.drapeRenderMode===0;return y===null?d&&d.drapeRenderMode===0?d:N?l:null:d!=null&&(!l||N||d&&d.drapeRenderMode===1)?d:l}mergeTerrain(){let l;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(d=>{l=this._prioritizeTerrain(l,d.terrain,d.stylesheet.terrain)}),l===null?delete this.terrain:this.terrain=l}mergeProjection(){let l;this.forEachFragmentStyle(d=>{d.stylesheet.projection!=null&&(l=d.stylesheet.projection)}),this.projection=l||{name:"mercator"}}mergeSources(){const l={},d={},y={};this.forEachFragmentStyle(N=>{for(const j in N._sourceCaches){const C=i.aC(j,N.scope);l[C]=N._sourceCaches[j]}for(const j in N._otherSourceCaches){const C=i.aC(j,N.scope);d[C]=N._otherSourceCaches[j]}for(const j in N._symbolSourceCaches){const C=i.aC(j,N.scope);y[C]=N._symbolSourceCaches[j]}}),this._mergedSourceCaches=l,this._mergedOtherSourceCaches=d,this._mergedSymbolSourceCaches=y}mergeLayers(){const l={},d=[],y={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(j=>{for(const C of j._order){const F=j._layers[C];if(F.type==="slot"){const W=i.cq(C);if(l[W])continue;l[W]=[]}F.slot&&l[F.slot]?l[F.slot].push(F):d.push(F)}}),this._mergedOrder=[];const N=(j=[])=>{for(const C of j)if(C.type==="slot"){const F=i.cq(C.id);l[F]&&N(l[F]),this._mergedSlots.push(F)}else{const F=i.aC(C.id,C.scope);this._mergedOrder.push(F),y[F]=C,C.is3D()&&(this._has3DLayers=!0),C.type==="circle"&&(this._hasCircleLayers=!0),C.type==="symbol"&&(this._hasSymbolLayers=!0),C.type==="clip"&&(this._clipLayerPresent=!0)}};N(d),this._mergedOrder.sort((j,C)=>{const F=y[j],W=y[C];return F.hasInitialOcclusionOpacityProperties?W.is3D()?1:0:F.is3D()&&W.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=y,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(l){return this.stylesheet.camera=i.l({},this.stylesheet.camera,l),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(l){return l.data?function(d,y,N){const j=i.l({},y);for(const F of Object.keys(i.a3.colorTheme))j[F]===void 0&&(j[F]=i.a3.colorTheme[F].default);const C=new i.a4(dx,d,new Map(N));return C.setTransitionOrValue(j,N),C.untransitioned().possiblyEvaluate(new i.a8(0))}(this.scope,l,this.options).get("data"):null}_loadColorTheme(l){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const d=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((y,N)=>{const j="data:image/png;base64,";if(!l||l.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void y();let C=l;C.startsWith(j)||(C=j+C);const F="mapbox-reserved-lut",W=new Image;W.src=C,W.onerror=()=>{this._styleColorTheme.lutLoading=!1,N(new Error("Failed to load image data"))},W.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==d)return void y();this._styleColorTheme.lutLoading=!1;const{width:Z,height:Y,data:re}=i.q.getImageData(W);if(Y>32)return void N(new Error("The height of the image must be less than or equal to 32 pixels."));if(Z!==Y*Y)return void N(new Error("The width of the image must be equal to the height squared."));this.getImage(F)&&this.removeImage(F),this.addImage(F,{data:new i.r({width:Z,height:Y},re),pixelRatio:1,sdf:!1,usvg:!1,version:0});const ne=this.imageManager.getImage(F,this.scope);ne?(this._styleColorTheme.lut={image:ne.data,data:l},y()):N(new Error("Missing LUT image."))}})}getLut(l){const d=this._styleColorThemeForScope[l];return d?d.lut:null}setProjection(l){l?this.stylesheet.projection=l:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(l){this._spriteRequest=function(d,y,N){let j,C,F;const W=i.q.devicePixelRatio>1?"@2x":"";let Z=i.n(y.transformRequest(y.normalizeSpriteURL(d,W,".json"),i.R.SpriteJSON),(ne,oe)=>{Z=null,F||(F=ne,j=oe,re())}),Y=i.o(y.transformRequest(y.normalizeSpriteURL(d,W,".png"),i.R.SpriteImage),(ne,oe)=>{Y=null,F||(F=ne,C=oe,re())});function re(){if(F)N(F);else if(j&&C){const ne=i.q.getImageData(C),oe={};for(const _e in j){const{width:ge,height:Te,x:Ae,y:Re,sdf:qe,pixelRatio:Ue,stretchX:Qe,stretchY:Ke,content:Ze}=j[_e],He=new i.r({width:ge,height:Te});i.r.copy(ne,He,{x:Ae,y:Re},{x:0,y:0},{width:ge,height:Te},null),oe[_e]={data:He,pixelRatio:Ue,sdf:qe,stretchX:Qe,stretchY:Ke,content:Ze,usvg:!1}}N(null,oe)}}return{cancel(){Z&&(Z.cancel(),Z=null),Y&&(Y.cancel(),Y=null)}}}(l,this.map._requestManager,(d,y)=>{if(this._spriteRequest=null,d)this.fire(new i.y(d));else if(y)for(const N in y)this.imageManager.addImage(N,this.scope,y[N]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))})}_loadIconset(l){if(!i.f(l)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(l);const d=this.map._spriteFormat==="auto";var y,N;this._spriteRequest=(N=(j,C)=>{if(this._spriteRequest=null,j)d?this._loadSprite(l):this.fire(new i.y(j));else if(C)for(const F in C)this.imageManager.addImage(F,this.scope,C[F]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bi((y=this.map._requestManager).transformRequest(y.normalizeIconsetURL(l),i.R.Iconset),(j,C)=>{if(j)return void N(j);const F={},W=i.cg(new i.bh(C));for(const Z of W.icons){const Y={version:1,pixelRatio:i.q.devicePixelRatio,content:K_(Z),stretchX:Z.metadata?fx(Z.metadata.stretch_x_areas):void 0,stretchY:Z.metadata?fx(Z.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:Z};F[Z.name]=Y}N(null,F)}))}_validateLayer(l){const d=this.getOwnSource(l.source);if(!d)return;const y=l.sourceLayer;y&&(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(y)===-1)&&this.fire(new i.y(new Error(`Source layer "${y}" does not exist on source "${d.id}" as specified by style layer "${l.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const l in this._sourceCaches)if(!this._sourceCaches[l].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:l}of this.fragments)if(!l.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((l,d)=>{const y=this.fragments[d];return y&&y.style&&(l.data=y.style.serialize()),l})}_serializeSources(){const l={};for(const d in this._sourceCaches){const y=this._sourceCaches[d].getSource();l[y.id]||(l[y.id]=y.serialize())}return l}_serializeLayers(l){const d=[];for(const y of l){const N=this._layers[y];N&&N.type!=="custom"&&d.push(N.serialize())}return d}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const l in this._sourceCaches)if(this._sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(l){return l?this.order:this._mergedOrder}isLayerDraped(l){return!!this.terrain&&l.isDraped(this.getLayerSourceCache(l))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(l){const d=this.getOwnLayer(l);if(d)return d;this.fire(new i.y(new Error(`The layer '${l}' does not exist in the map's style.`)))}_checkSource(l){const d=this.getOwnSource(l);if(d)return d;this.fire(new i.y(new Error(`The source '${l}' does not exist in the map's style.`)))}precompilePrograms(l,d){const y=this.map.painter;if(y)for(let N=l.minzoom||0;N<(l.maxzoom||25.5);N++){const j=l.getProgramIds();if(j)for(const C of j){const F=l.getDefaultProgramParams(C,d.zoom,this._styleColorTheme.lut);F&&(y.style=this,this.fog&&(y._fogVisible=!0,F.overrideFog=!0,y.getOrCreateProgram(C,F)),y._fogVisible=!1,F.overrideFog=!1,y.getOrCreateProgram(C,F),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(F.overrideRtt=!0,y.getOrCreateProgram(C,F)))}}}update(l){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(l),this.directionalLight&&this.directionalLight.recalculate(l);const d=this.calculateLightsBrightness();l.brightness=d||0,d!==this._brightness&&(this._brightness=d,this.dispatcher.broadcast("setBrightness",d));const y=this._changes.isDirty();let N=!1;if(this._changes.isDirty()){const C=this._changes.getLayerUpdatesByScope();for(const F in C){const{updatedIds:W,removedIds:Z}=C[F];(W||Z)&&(this._updateWorkerLayers(F,W,Z),N=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(l),this.light&&this.light.updateTransitions(l),this.ambientLight&&this.ambientLight.updateTransitions(l),this.directionalLight&&this.directionalLight.updateTransitions(l),this.fog&&this.fog.updateTransitions(l),this.snow&&this.snow.updateTransitions(l),this.rain&&this.rain.updateTransitions(l),this._changes.reset()}const j={};for(const C in this._mergedSourceCaches){const F=this._mergedSourceCaches[C];j[C]=F.used,F.used=!1,F.tileCoverLift=0}for(const C of this._mergedOrder){const F=this._mergedLayers[C];if(F.recalculate(l,this._availableImages),!F.isHidden(l.zoom)){const W=this.getLayerSourceCache(F);W&&(W.used=!0,W.tileCoverLift=Math.max(W.tileCoverLift,F.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(F,l)}):this.precompilePrograms(F,l))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&N&&this.mergeLayers();for(const C in j){const F=this._mergedSourceCaches[C];j[C]!==F.used&&F.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:F.getSource().id}))}this.light&&this.light.recalculate(l),this.terrain&&this.terrain.recalculate(l),this.fog&&this.fog.recalculate(l),this.snow&&this.snow.recalculate(l),this.rain&&this.rain.recalculate(l),this.z=l.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),y&&this.fire(new i.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=this._changes.getUpdatedImages();if(l.length){for(const d in this._sourceCaches)this._sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],l);this._changes.resetUpdatedImages()}}_updateWorkerLayers(l,d,y){const N=this.getFragmentStyle(l);N&&this.dispatcher.broadcast("updateLayers",{layers:d?N._serializeLayers(d):[],scope:l,removedIds:y||[],options:N.options})}setState(l,d){if(this._checkLoaded(),no(this,Ha(l)))return!1;(l=i.cp(l)).layers=Ku(l.layers);const y=function(C,F){if(!C)return[{command:xn.setStyle,args:[F]}];let W=[];try{if(!i.bn(C.version,F.version))return[{command:xn.setStyle,args:[F]}];if(i.bn(C.center,F.center)||W.push({command:xn.setCenter,args:[F.center]}),i.bn(C.zoom,F.zoom)||W.push({command:xn.setZoom,args:[F.zoom]}),i.bn(C.bearing,F.bearing)||W.push({command:xn.setBearing,args:[F.bearing]}),i.bn(C.pitch,F.pitch)||W.push({command:xn.setPitch,args:[F.pitch]}),i.bn(C.sprite,F.sprite)||W.push({command:xn.setSprite,args:[F.sprite]}),i.bn(C.glyphs,F.glyphs)||W.push({command:xn.setGlyphs,args:[F.glyphs]}),i.bn(C.imports,F.imports)||function(oe=[],_e=[],ge){_e=_e||[];const Te=(oe=oe||[]).map(xs),Ae=_e.map(xs),Re=oe.reduce(Ec,{}),qe=_e.reduce(Ec,{}),Ue=Te.slice();let Qe,Ke,Ze,He;for(Qe=0,Ke=0;Qe<Te.length;Qe++)Ze=Te[Qe],qe.hasOwnProperty(Ze)?Ke++:(ge.push({command:xn.removeImport,args:[Ze]}),Ue.splice(Ue.indexOf(Ze,Ke),1));for(Qe=0,Ke=0;Qe<Ae.length;Qe++)Ze=Ae[Ae.length-1-Qe],Ue[Ue.length-1-Qe]!==Ze&&(Re.hasOwnProperty(Ze)?(ge.push({command:xn.removeImport,args:[Ze]}),Ue.splice(Ue.lastIndexOf(Ze,Ue.length-Ke),1)):Ke++,He=Ue[Ue.length-Qe],ge.push({command:xn.addImport,args:[qe[Ze],He]}),Ue.splice(Ue.length-Qe,0,Ze));for(const Xe of _e){const at=Re[Xe.id];at&&!i.bn(at,Xe)&&ge.push({command:xn.updateImport,args:[Xe.id,Xe]})}}(C.imports,F.imports,W),i.bn(C.transition,F.transition)||W.push({command:xn.setTransition,args:[F.transition]}),i.bn(C.light,F.light)||W.push({command:xn.setLight,args:[F.light]}),i.bn(C.fog,F.fog)||W.push({command:xn.setFog,args:[F.fog]}),i.bn(C.snow,F.snow)||W.push({command:xn.setSnow,args:[F.snow]}),i.bn(C.rain,F.rain)||W.push({command:xn.setRain,args:[F.rain]}),i.bn(C.projection,F.projection)||W.push({command:xn.setProjection,args:[F.projection]}),i.bn(C.lights,F.lights)||W.push({command:xn.setLights,args:[F.lights]}),i.bn(C.camera,F.camera)||W.push({command:xn.setCamera,args:[F.camera]}),!i.bn(C["color-theme"],F["color-theme"]))return[{command:xn.setStyle,args:[F]}];const Z={},Y=[];(function(oe,_e,ge,Te){let Ae;for(Ae in _e=_e||{},oe=oe||{})oe.hasOwnProperty(Ae)&&(_e.hasOwnProperty(Ae)||Zu(Ae,ge,Te));for(Ae in _e){if(!_e.hasOwnProperty(Ae))continue;const Re=_e[Ae];oe.hasOwnProperty(Ae)?i.bn(oe[Ae],Re)||(oe[Ae].type==="geojson"&&Re.type==="geojson"&&mi(oe,_e,Ae)?ge.push({command:xn.setGeoJSONSourceData,args:[Ae,Re.data]}):br(Ae,_e,ge,Te)):Vm(Ae,_e,ge)}})(C.sources,F.sources,Y,Z);const re=[];C.layers&&C.layers.forEach(oe=>{oe.source&&Z[oe.source]?W.push({command:xn.removeLayer,args:[oe.id]}):re.push(oe)});let ne=C.terrain;ne&&Z[ne.source]&&(W.push({command:xn.setTerrain,args:[void 0]}),ne=void 0),W=W.concat(Y),i.bn(ne,F.terrain)||W.push({command:xn.setTerrain,args:[F.terrain]}),function(oe,_e,ge){_e=_e||[];const Te=(oe=oe||[]).map(xs),Ae=_e.map(xs),Re=oe.reduce(Ec,{}),qe=_e.reduce(Ec,{}),Ue=Te.slice(),Qe=Object.create(null);let Ke,Ze,He,Xe,at,_t,mt;for(Ke=0,Ze=0;Ke<Te.length;Ke++)He=Te[Ke],qe.hasOwnProperty(He)?Ze++:(ge.push({command:xn.removeLayer,args:[He]}),Ue.splice(Ue.indexOf(He,Ze),1));for(Ke=0,Ze=0;Ke<Ae.length;Ke++)He=Ae[Ae.length-1-Ke],Ue[Ue.length-1-Ke]!==He&&(Re.hasOwnProperty(He)?(ge.push({command:xn.removeLayer,args:[He]}),Ue.splice(Ue.lastIndexOf(He,Ue.length-Ze),1)):Ze++,_t=Ue[Ue.length-Ke],ge.push({command:xn.addLayer,args:[qe[He],_t]}),Ue.splice(Ue.length-Ke,0,He),Qe[He]=!0);for(Ke=0;Ke<Ae.length;Ke++)if(He=Ae[Ke],Xe=Re[He],at=qe[He],!Qe[He]&&!i.bn(Xe,at))if(i.bn(Xe.source,at.source)&&i.bn(Xe["source-layer"],at["source-layer"])&&i.bn(Xe.type,at.type)){for(mt in Wn(Xe.layout,at.layout,ge,He,null,xn.setLayoutProperty),Wn(Xe.paint,at.paint,ge,He,null,xn.setPaintProperty),i.bn(Xe.slot,at.slot)||ge.push({command:xn.setSlot,args:[He,at.slot]}),i.bn(Xe.filter,at.filter)||ge.push({command:xn.setFilter,args:[He,at.filter]}),i.bn(Xe.minzoom,at.minzoom)&&i.bn(Xe.maxzoom,at.maxzoom)||ge.push({command:xn.setLayerZoomRange,args:[He,at.minzoom,at.maxzoom]}),Xe)Xe.hasOwnProperty(mt)&&mt!=="layout"&&mt!=="paint"&&mt!=="filter"&&mt!=="metadata"&&mt!=="minzoom"&&mt!=="maxzoom"&&mt!=="slot"&&(mt.indexOf("paint.")===0?Wn(Xe[mt],at[mt],ge,He,mt.slice(6),xn.setPaintProperty):i.bn(Xe[mt],at[mt])||ge.push({command:xn.setLayerProperty,args:[He,mt,at[mt]]}));for(mt in at)at.hasOwnProperty(mt)&&!Xe.hasOwnProperty(mt)&&mt!=="layout"&&mt!=="paint"&&mt!=="filter"&&mt!=="metadata"&&mt!=="minzoom"&&mt!=="maxzoom"&&mt!=="slot"&&(mt.indexOf("paint.")===0?Wn(Xe[mt],at[mt],ge,He,mt.slice(6),xn.setPaintProperty):i.bn(Xe[mt],at[mt])||ge.push({command:xn.setLayerProperty,args:[He,mt,at[mt]]}))}else ge.push({command:xn.removeLayer,args:[He]}),_t=Ue[Ue.lastIndexOf(He)+1],ge.push({command:xn.addLayer,args:[at,_t]})}(re,F.layers,W)}catch(Z){console.warn("Unable to compute style diff:",Z),W=[{command:xn.setStyle,args:[F]}]}return W}(this.serialize(),l).filter(C=>!(C.command in Py));if(y.length===0)return!1;const N=y.filter(C=>!(C.command in Cp));if(N.length>0)throw new Error(`Unimplemented: ${N.map(C=>C.command).join(", ")}.`);const j=[];return y.forEach(C=>{j.push(this[C.command].apply(this,C.args))}),d&&Promise.all(j).then(d),this.stylesheet=l,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(l,d){return this.getImage(l)?this.fire(new i.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(l,this.scope,d),this._afterImageUpdated(l),this)}updateImage(l,d,y=!1){this.imageManager.updateImage(l,this.scope,d),y&&this._afterImageUpdated(l)}getImage(l){return this.imageManager.getImage(l,this.scope)}removeImage(l){return this.getImage(l)?(this.imageManager.removeImage(l,this.scope),this._afterImageUpdated(l),this):this.fire(new i.y(new Error("No image with this name exists.")))}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(l),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new i.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(l,d,y={}){return this._checkLoaded(),this._validate(Gu,`models.${l}`,d,null,y)||(this.modelManager.addModel(l,d,this.scope),this._changes.setDirty()),this}hasModel(l){return this.modelManager.hasModel(l,this.scope)}removeModel(l){return this.hasModel(l)?(this.modelManager.removeModel(l,this.scope),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(l,d,y={}){if(this._checkLoaded(),this.getOwnSource(l)!==void 0)throw new Error(`There is already a source with ID "${l}".`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(eo,`sources.${l}`,d,null,y))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const N=vo(l,d,this.dispatcher,this);N.scope=this.scope,N.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(N.id),source:N.serialize(),sourceId:N.id}));const j=C=>{const F=(C?"symbol:":"other:")+N.id,W=i.aC(F,this.scope),Z=this._sourceCaches[F]=new Zo(W,N,C);(C?this._symbolSourceCaches:this._otherSourceCaches)[N.id]=Z,Z.onAdd(this.map)};j(!1),d.type!=="vector"&&d.type!=="geojson"||j(!0),N.onAdd&&N.onAdd(this.map),y.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(l){this._checkLoaded();const d=this.getOwnSource(l);if(!d)throw new Error("There is no source with this ID");for(const N in this._layers)if(this._layers[N].source===l)return this.fire(new i.y(new Error(`Source "${l}" cannot be removed while layer "${N}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===l)return this.fire(new i.y(new Error(`Source "${l}" cannot be removed while terrain is using it.`)));const y=this.getOwnSourceCaches(l);for(const N of y){const j=i.cq(N.id);delete this._sourceCaches[j],this._changes.discardSourceCacheUpdate(N.id),N.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:N.getSource().id})),N.setEventedParent(null),N.clearTiles()}return delete this._otherSourceCaches[l],delete this._symbolSourceCaches[l],this.mergeSources(),d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(l,d){this._checkLoaded(),this.getOwnSource(l).setData(d),this._changes.setDirty()}getOwnSource(l){const d=this.getOwnSourceCache(l);return d&&d.getSource()}getOwnSources(){const l=[];for(const d in this._otherSourceCaches){const y=this.getOwnSourceCache(d);y&&l.push(y.getSource())}return l}areTilesLoaded(){const l=this._mergedSourceCaches;for(const d in l){const y=l[d]._tiles;for(const N in y){const j=y[N];if(j.state!=="loaded"&&j.state!=="errored")return!1}}return!0}setLights(l){if(this._checkLoaded(),!l)return delete this.ambientLight,void delete this.directionalLight;const d=this._getTransitionParameters();for(const N of l){if(this._validate(va,"lights",N))return;switch(N.type){case"ambient":if(this.ambientLight){const j=this.ambientLight;j.set(N),j.updateTransitions(d)}else this.ambientLight=new Ur(N,ar||(ar=new i.a5({color:new i.a6(i.a3.properties_light_ambient.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const j=this.directionalLight;j.set(N),j.updateTransitions(d)}else this.directionalLight=new Ur(N,sr||(sr=new i.a5({direction:new i.ak(i.a3.properties_light_directional.direction),color:new i.a6(i.a3.properties_light_directional.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_directional.intensity),"cast-shadows":new i.a6(i.a3.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a6(i.a3.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a6(i.a3.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const y=new i.a8(this.z||0,d);this.ambientLight&&this.ambientLight.recalculate(y),this.directionalLight&&this.directionalLight.recalculate(y),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const l=this.directionalLight,d=this.ambientLight;if(!l||!d)return;const y=ne=>.2126*(ne[0]<=.03928?ne[0]/12.92:Math.pow((ne[0]+.055)/1.055,2.4))+.7152*(ne[1]<=.03928?ne[1]/12.92:Math.pow((ne[1]+.055)/1.055,2.4))+.0722*(ne[2]<=.03928?ne[2]/12.92:Math.pow((ne[2]+.055)/1.055,2.4)),N=l.properties.get("color").toRenderColor(null).toArray01(),j=l.properties.get("intensity"),C=l.properties.get("direction"),F=1-i.cb(C.x,C.y,C.z)[2]/90,W=y(N)*j*F,Z=d.properties.get("color").toRenderColor(null).toArray01(),Y=d.properties.get("intensity"),re=y(Z)*Y;return Number(((W+re)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const l=[];return this.directionalLight&&l.push(this.directionalLight.get()),this.ambientLight&&l.push(this.ambientLight.get()),l}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(l){if(!l)return this;if(i.cr(l)){const d=i.cs(l),y=this.fragments.find(({id:j})=>j===d);if(!y)throw new Error(`Style import '${l}' not found`);const N=i.cq(l);return y.style.getFragmentStyle(N)}{const d=this.fragments.find(({id:y})=>y===l);return d?d.style:void 0}}setFeaturesetSelectors(l){if(!l)return;const d={},y=(N,j="")=>`${N}::${j}`;this._featuresetSelectors={};for(const N in l){const j=this._featuresetSelectors[N]=[];for(const C of l[N].selectors){if(C.featureNamespace){const W=this.getOwnLayer(C.layer);if(!W){i.w(`Layer is undefined for selector: ${C.layer}`);continue}const Z=y(W.source,W.sourceLayer);if(Z in d&&d[Z]!==C.featureNamespace){i.w(`"featureNamespace ${C.featureNamespace} of featureset ${N}'s selector is not associated to the same source, skip this selector`);continue}d[Z]=C.featureNamespace}let F;if(C.properties)for(const W in C.properties){const Z=i.U(C.properties[W]);Z.result==="success"&&(F=F||{},F[W]=Z.value)}j.push({layerId:C.layer,namespace:C.featureNamespace,properties:F,uniqueFeatureID:C._uniqueFeatureID})}}}getFeaturesetDescriptors(l){const d=this.getFragmentStyle(l);if(!d||!d.stylesheet.featuresets)return[];const y=[];for(const N in d.stylesheet.featuresets)y.push({featuresetId:N,importId:d.scope?d.scope:void 0});return y}getFeaturesetLayers(l,d){const y=this.getFragmentStyle(d),N=y.stylesheet.featuresets;if(!N||!N[l])return this.fire(new i.y(new Error(`The featureset '${l}' does not exist in the map's style and cannot be queried.`))),[];const j=[];for(const C of N[l].selectors){const F=y.getOwnLayer(C.layer);F&&j.push(F)}return j}getConfigProperty(l,d){const y=this.getFragmentStyle(l);if(!y)return null;const N=i.aC(d,y.scope),j=y.options.get(N),C=j?j.value||j.default:null;return C?C.serialize():null}setConfigProperty(l,d,y){const N=this.getFragmentStyle(l);if(!N)return;const j=N.stylesheet.indoor?jy(N.stylesheet.schema):N.stylesheet.schema;if(!j||!j[d])return;const C=i.U(y);if(C.result!=="success")return void no(this,C.value);const F=C.value.expression,W=i.aC(d,N.scope),Z=N.options.get(W);if(!Z)return;let Y;const{minValue:re,maxValue:ne,stepValue:oe,type:_e,values:ge}=j[d],Te=i.U(j[d].default);Te.result==="success"&&(Y=Te.value.expression),Y?(this.options.set(W,Object.assign({},Z,{value:F,default:Y,minValue:re,maxValue:ne,stepValue:oe,type:_e,values:ge})),this.updateConfigDependencies(d)):this.fire(new i.y(new Error(`No schema defined for the config option "${d}" in the "${l}" fragment.`)))}getConfig(l){const d=this.getFragmentStyle(l);if(!d)return null;const y=d.stylesheet.schema;if(!y)return null;const N={};for(const j in y){const C=i.aC(j,d.scope),F=d.options.get(C),W=F?F.value||F.default:null;N[j]=W?W.serialize():null}return N}setConfig(l,d){const y=this.getFragmentStyle(l);y&&(y.updateConfig(d,y.stylesheet.schema),this.updateConfigDependencies())}getSchema(l){const d=this.getFragmentStyle(l);return d?d.stylesheet.schema:null}setSchema(l,d){const y=this.getFragmentStyle(l);y&&(y.stylesheet.schema=d,y.updateConfig(y._config,d),this.updateConfigDependencies())}updateConfig(l,d){if(this._config=l,l||d)if(d)for(const y in d){let N,j;const C=i.U(d[y].default);if(C.result==="success"&&(N=C.value.expression),l&&l[y]!==void 0){const ne=i.U(l[y]);ne.result==="success"&&(j=ne.value.expression)}const{minValue:F,maxValue:W,stepValue:Z,type:Y,values:re}=d[y];if(N){const ne=i.aC(y,this.scope);this.options.set(ne,{default:N,value:j,minValue:F,maxValue:W,stepValue:Z,type:Y,values:re})}else this.fire(new i.y(new Error(`No schema defined for config option "${y}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(l){for(const d of this._configDependentLayers){const y=this.getLayer(d);if(y){if(l&&!y.configDependencies.has(l))continue;y.possiblyEvaluateVisibility(),this._updateLayer(y)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(d=>{const y=d._styleColorTheme.colorThemeOverride?d._styleColorTheme.colorThemeOverride:d._styleColorTheme.colorTheme;if(y){const N=d._evaluateColorThemeData(y);(!d._styleColorTheme.lut&&N!==""||d._styleColorTheme.lut&&N!==d._styleColorTheme.lut.data)&&d.setColorTheme(y)}}),this._changes.setDirty()}addLayer(l,d,y={}){this._checkLoaded();const N=l.id;if(this._layers[N])return void this.fire(new i.y(new Error(`Layer with id "${N}" already exists on this map`)));let j;if(l.type==="custom"){if(no(this,i.ct(l)))return;j=i.cu(l,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof l.source=="object"&&(this.addSource(N,l.source),l=i.cp(l),l=i.l(l,{source:N})),this._validate(qs,`layers.${N}`,l,{arrayIndex:-1},y))return;j=i.cu(l,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(j),j.setEventedParent(this,{layer:{id:N}})}j.configDependencies.size!==0&&this._configDependentLayers.add(j.fqid);let C=this._order.length;if(d){const Y=this._order.indexOf(d);if(Y===-1)return void this.fire(new i.y(new Error(`Layer with id "${d}" does not exist on this map.`)));j.slot===this._layers[d].slot?C=Y:i.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(C,0,N),this._layerOrderChanged=!0,this._layers[N]=j;const F=this.getOwnLayerSourceCache(j),W=!!this.directionalLight&&this.directionalLight.shadowsEnabled();F&&j.canCastShadows()&&W&&(F.castsShadows=!0);const Z=this._changes.getRemovedLayer(j);if(Z&&j.source&&F&&j.type!=="custom"){this._changes.discardLayerRemoval(j);const Y=i.aC(j.source,j.scope);Z.type!==j.type?this._changes.updateSourceCache(Y,"clear"):(this._changes.updateSourceCache(Y,"reload"),F.pause())}this._updateLayer(j),j.onAdd&&j.onAdd(this.map),j.scope=this.scope,this.mergeLayers()}moveLayer(l,d){this._checkLoaded();const y=this._checkLayer(l);if(!y||l===d)return;const N=this._order.indexOf(l);this._order.splice(N,1);let j=this._order.length;if(d){const C=this._order.indexOf(d);if(C===-1)return void this.fire(new i.y(new Error(`Layer with id "${d}" does not exist on this map.`)));y.slot===this._layers[d].slot?j=C:i.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(j,0,l),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(l){this._checkLoaded();const d=this._checkLayer(l);if(!d)return;d.setEventedParent(null);const y=this._order.indexOf(l);this._order.splice(y,1),delete this._layers[l],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(d.fqid),this._changes.removeLayer(d);const N=this.getOwnLayerSourceCache(d);if(N&&N.castsShadows){let j=!1;for(const C in this._layers)if(this._layers[C].source===d.source&&this._layers[C].canCastShadows()){j=!0;break}N.castsShadows=j}d.onRemove&&d.onRemove(this.map),this.mergeLayers()}getOwnLayer(l){return this._layers[l]}hasLayer(l){return l in this._mergedLayers}hasLayerType(l){for(const d in this._layers)if(this._layers[d].type===l)return!0;return!1}setLayerZoomRange(l,d,y){this._checkLoaded();const N=this._checkLayer(l);N&&(N.minzoom===d&&N.maxzoom===y||(d!=null&&(N.minzoom=d),y!=null&&(N.maxzoom=y),this._updateLayer(N)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(l,d){this._checkLoaded();const y=this._checkLayer(l);y&&y.slot!==d&&(y.slot=d,this._updateLayer(y))}setFilter(l,d,y={}){this._checkLoaded();const N=this._checkLayer(l);if(N&&!i.bn(N.filter,d))return d==null?(N.filter=void 0,void this._updateLayer(N)):void(this._validate($i,`layers.${N.id}.filter`,d,{layerType:N.type},y)||(N.filter=i.cp(d),this._updateLayer(N)))}getFilter(l){const d=this._checkLayer(l);if(d)return i.cp(d.filter)}setLayoutProperty(l,d,y,N={}){this._checkLoaded();const j=this._checkLayer(l);if(j&&!i.bn(j.getLayoutProperty(d),y)){if(y!=null&&(!N||N.validate!==!1)&&no(j,gs.call(Ha,{key:`layers.${l}.layout.${d}`,layerType:j.type,objectKey:d,value:y,styleSpec:i.a3,style:{glyphs:!0,sprite:!0}})))return;j.setLayoutProperty(d,y),j.configDependencies.size!==0&&this._configDependentLayers.add(j.fqid),this._updateLayer(j)}}getLayoutProperty(l,d){const y=this._checkLayer(l);if(y)return y.getLayoutProperty(d)}setPaintProperty(l,d,y,N={}){this._checkLoaded();const j=this._checkLayer(l);if(!j||i.bn(j.getPaintProperty(d),y)||y!=null&&(!N||N.validate!==!1)&&no(j,Ms.call(Ha,{key:`layers.${l}.paint.${d}`,layerType:j.type,objectKey:d,value:y,styleSpec:i.a3})))return;const C=j.setPaintProperty(d,y);j.configDependencies.size!==0&&this._configDependentLayers.add(j.fqid),C&&this._updateLayer(j),this._changes.updatePaintProperties(j)}getPaintProperty(l,d){const y=this._checkLayer(l);if(y)return y.getPaintProperty(d)}setFeatureState(l,d){if(this._checkLoaded(),"target"in l){if("featuresetId"in l.target){const{featuresetId:W,importId:Z}=l.target,Y=this.getFragmentStyle(Z),re=Y.getFeaturesetLayers(W);for(const{source:ne,sourceLayer:oe}of re)Y.setFeatureState({id:l.id,source:ne,sourceLayer:oe},d)}else if("layerId"in l.target){const{layerId:W}=l.target,Z=this.getLayer(W);this.setFeatureState({id:l.id,source:Z.source,sourceLayer:Z.sourceLayer},d)}return}const y=l.source,N=l.sourceLayer,j=this._checkSource(y);if(!j)return;const C=j.type;if(C==="geojson"&&N)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(C==="vector"&&!N)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));l.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const F=this.getOwnSourceCaches(y);for(const W of F)W.setFeatureState(N,l.id,d)}removeFeatureState(l,d){if(this._checkLoaded(),"target"in l){if("featuresetId"in l.target){const{featuresetId:W,importId:Z}=l.target,Y=this.getFragmentStyle(Z),re=Y.getFeaturesetLayers(W);for(const{source:ne,sourceLayer:oe}of re)Y.removeFeatureState({id:l.id,source:ne,sourceLayer:oe},d)}else if("layerId"in l.target){const{layerId:W}=l.target,Z=this.getLayer(W);this.removeFeatureState({id:l.id,source:Z.source,sourceLayer:Z.sourceLayer},d)}return}const y=l.source,N=this._checkSource(y);if(!N)return;const j=N.type,C=j==="vector"?l.sourceLayer:void 0;if(j==="vector"&&!C)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&typeof l.id!="string"&&typeof l.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const F=this.getOwnSourceCaches(y);for(const W of F)W.removeFeatureState(C,l.id,d)}getFeatureState(l){if(this._checkLoaded(),"target"in l){let j;if("featuresetId"in l.target){const{featuresetId:C,importId:F}=l.target,W=this.getFragmentStyle(F),Z=W.getFeaturesetLayers(C);for(const{source:Y,sourceLayer:re}of Z){const ne=W.getFeatureState({id:l.id,source:Y,sourceLayer:re});if(ne&&!j)j=ne;else if(!i.bn(j,ne))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in l.target){const{layerId:C}=l.target,F=this.getLayer(C);j=this.getFeatureState({id:l.id,source:F.source,sourceLayer:F.sourceLayer})}return j}const d=l.source,y=l.sourceLayer,N=this._checkSource(d);if(N){if(N.type!=="vector"||y)return l.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(d)[0].getFeatureState(y,l.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(l){return this.stylesheet.transition=i.l({},this.stylesheet.transition,l),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const l=this.getTerrain(),d=l&&this.terrain&&this.terrain.scope===this.scope?l:this.stylesheet.terrain;return i.cv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:d,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},y=>y!==void 0)}_updateFilteredLayers(l){for(const d of Object.values(this._mergedLayers))l(d)&&this._updateLayer(d)}_updateLayer(l){this._changes.updateLayer(l);const d=this.getLayerSourceCache(l),y=i.aC(l.source,l.scope),N=this._changes.getUpdatedSourceCaches();l.source&&!N[y]&&d&&d.getSource().type!=="raster"&&(this._changes.updateSourceCache(y,"reload"),d.pause()),l.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(l){const d=F=>this._mergedLayers[F].is3D(),y=this.order,N={},j=[];for(let F=y.length-1;F>=0;F--){const W=y[F];if(d(W)){N[W]=F;for(const Z of l){const Y=Z[W];if(Y)for(const re of Y)j.push(re)}}}j.sort((F,W)=>W.intersectionZ-F.intersectionZ);const C=[];for(let F=y.length-1;F>=0;F--){const W=y[F];if(d(W))for(let Z=j.length-1;Z>=0;Z--){const Y=j[Z].feature;if(Y.layer&&N[Y.layer.id]<F)break;C.push(Y),j.pop()}else for(const Z of l){const Y=Z[W];if(Y)for(const re of Y)C.push(re.feature)}}return C}queryRenderedFeatures(l,d,y){let N;d&&!Array.isArray(d)&&d.filter&&(this._validate($i,"queryRenderedFeatures.filter",d.filter,null,d),N=i.aZ(d.filter));const j={},C=Y=>{if(Hm.has(Y.type))return;const re=this.getOwnLayerSourceCache(Y),ne=j[re.id]=j[re.id]||{sourceCache:re,layers:{},has3DLayers:!1};Y.is3D()&&(ne.has3DLayers=!0),ne.layers[Y.fqid]=ne.layers[Y.fqid]||{styleLayer:Y,targets:[]},ne.layers[Y.fqid].targets.push({filter:N})};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const Y of d.layers){const re=this._layers[Y];if(!re)return this.fire(new i.y(new Error(`The layer '${Y}' does not exist in the map's style and cannot be queried for features.`))),[];C(re)}}else for(const Y in this._layers)C(this._layers[Y]);const F=this._queryRenderedFeatures(l,j,y),W=this._flattenAndSortRenderedFeatures(F),Z=[];for(const Y of W)i.cs(Y.layer.id)===this.scope&&Z.push(Y);return Z}queryRenderedFeatureset(l,d,y){let N;d&&!Array.isArray(d)&&d.filter&&(this._validate($i,"queryRenderedFeatures.filter",d.filter,null,d),N=i.aZ(d.filter));const j="mock",C=[];if(d&&d.target)C.push(Object.assign({},d,{targetId:j,filter:N}));else{const Y=this.getFeaturesetDescriptors();for(const re of Y)C.push({targetId:j,filter:N,target:re});for(const{style:re}of this.fragments){const ne=re.getFeaturesetDescriptors();for(const oe of ne)C.push({targetId:j,filter:N,target:oe})}}const F=this.queryRenderedTargets(l,C,y),W=[],Z=new Set;for(const Y of F)for(const re of Y.variants[j])Dl(re,Y,Z)||W.push(new i.cw(Y,re));return W}queryRenderedTargets(l,d,y){const N={},j=(F,W,Z,Y)=>{const re=N[W.id]=N[W.id]||{sourceCache:W,layers:{},has3DLayers:!1};if(re.layers[F.fqid]=re.layers[F.fqid]||{styleLayer:F,targets:[]},F.is3D()&&(re.has3DLayers=!0),!Y)return Z.uniqueFeatureID=!1,void re.layers[F.fqid].targets.push(Z);re.layers[F.fqid].targets.push(Object.assign({},Z,{namespace:Y.namespace,properties:Y.properties,uniqueFeatureID:Y.uniqueFeatureID}))};for(const F of d)if("featuresetId"in F.target){const{featuresetId:W,importId:Z}=F.target,Y=this.getFragmentStyle(Z);if(!Y||!Y._featuresetSelectors)continue;const re=Y._featuresetSelectors[W];if(!re){this.fire(new i.y(new Error(`The featureset '${W}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const ne of re){const oe=Y.getOwnLayer(ne.layerId);oe&&!Hm.has(oe.type)&&j(oe,Y.getOwnLayerSourceCache(oe),F,ne)}}else if("layerId"in F.target){const{layerId:W}=F.target,Z=this.getLayer(W);if(!Z||Hm.has(Z.type))continue;j(Z,this.getLayerSourceCache(Z),F)}const C=this._queryRenderedFeatures(l,N,y);return this._flattenAndSortRenderedFeatures(C)}_queryRenderedFeatures(l,d,y){const N=[],j=!!this.map._showQueryGeometry,C=Vr.createFromScreenPoints(l,y);for(const F in d){const W=iu(C,d[F],this._availableImages,y,j);Object.keys(W).length&&N.push(W)}if(this.placement)for(const F in d){if(!d[F].sourceCache._onlySymbols)continue;const W=sf(C.screenGeometry,d[F],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(W).length&&N.push(W)}return N}querySourceFeatures(l,d){const y=d&&d.filter;y&&this._validate($i,"querySourceFeatures.filter",y,null,d);let N=[];const j=this.getOwnSourceCaches(l);for(const C of j)N=N.concat(ox(C,d));return N}addSourceType(l,d,y){return Xo.getSourceType(l)?y(new Error(`A source type called "${l}" already exists.`)):(Xo.setSourceType(l,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:d.workerSourceURL},y):y(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(l,d,y={}){this._checkLoaded();const N=this.light.getLight();let j=!1;for(const F in l)if(!i.bn(l[F],N[F])){j=!0;break}if(!j)return;const C=this._getTransitionParameters();this.light.setLight(l,d,y),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(l,d=1){if(this._checkLoaded(),!l)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),d===0&&delete this.terrain,l===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let y=l;const N=l.source==null;if(d===1){if(this.disableElevatedTerrain)return;if(typeof y.source=="object"){const F="terrain-dem-src";this.addSource(F,y.source),y=i.cp(y),y=i.l(y,{source:F})}const j=i.l({},y),C={};if(this.terrain&&N){j.source=this.terrain.get().source;const F=this.terrain?this.getFragmentStyle(this.terrain.scope):null;F&&(C.style=F.serialize())}if(this._validate(Ea,"terrain",j,C))return}if(!this.terrain||this.terrain.scope!==this.scope&&!N||this.terrain&&d!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,d),this.fire(new i.z("data",{dataType:"style"}))}else{const j=this.terrain,C=j.get();for(const F of Object.keys(i.a3.terrain))!y.hasOwnProperty(F)&&i.a3.terrain[F].default&&(y[F]=i.a3.terrain[F].default);for(const F in l)if(!i.bn(l[F],C[F])){j.set(l,this.options),this.stylesheet.terrain=l;const W=this._getTransitionParameters({duration:0});j.updateTransitions(W),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(l){const d=this.fog=new bt(l,this.map.transform,this.scope,this.options);this.stylesheet.fog=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}_createSnow(l){const d=this.snow=new Nr(l,this.map.transform,this.scope,this.options);this.stylesheet.snow=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}_createRain(l){const d=this.rain=new $r(l,this.map.transform,this.scope,this.options);this.stylesheet.rain=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const l of this.map._markers)l._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(l){if(this._checkLoaded(),!l)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog;if(!i.bn(d.get(),l)){d.set(l,this.options),this.stylesheet.fog=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}}else this._createFog(l);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(l){if(this._checkLoaded(),!l)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const d=this.snow;if(!i.bn(d.get(),l)){d.set(l,this.options),this.stylesheet.snow=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}}else this._createSnow(l);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(l){if(this._checkLoaded(),!l)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const d=this.rain;if(!i.bn(d.get(),l)){d.set(l,this.options),this.stylesheet.rain=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}}else this._createRain(l);this._markersNeedUpdate=!0}_reloadColorTheme(){const l=()=>{for(const N in this._layers)this._layers[N].lut=this._styleColorTheme.lut;for(const N in this._sourceCaches)this._sourceCaches[N].clearTiles()},d=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!d)return this._styleColorTheme.lut=null,void l();const y=this._evaluateColorThemeData(d);this._loadColorTheme(y).then(()=>{this.fire(new i.z("colorthemeset")),l()}).catch(N=>{i.w(`Couldn't set color theme: ${N}`)})}setColorTheme(l){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=l,this._reloadColorTheme()}setImportColorTheme(l,d){const y=this.getFragmentStyle(l);y&&(y._styleColorTheme.colorThemeOverride=d,y._reloadColorTheme())}_getTransitionParameters(l){return{now:i.q.now(),transition:i.l(this.transition,l)}}updateDrapeFirstLayers(){if(!this.terrain)return;const l=[],d=[];for(const y of this._mergedOrder)this.isLayerDraped(this._mergedLayers[y])?l.push(y):d.push(y);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...l),this._drapedFirstOrder.push(...d)}_createTerrain(l,d){const y=this.terrain=new ke(l,d,this.scope,this.options);d===1&&(this.stylesheet.terrain=l),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const N=this._getTransitionParameters({duration:0});y.updateTransitions(N)}_force3DLayerUpdate(){for(const l in this._layers){const d=this._layers[l];d.type==="fill-extrusion"&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const l in this._layers){const d=this._layers[l];d.type==="symbol"&&this._updateLayer(d)}}_validate(l,d,y,N,j={}){if(j&&j.validate===!1)return!1;const C=i.l({},this.serialize());return no(this,l.call(Ha,i.l({key:d,style:C,value:y,styleSpec:i.a3},N)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.cx.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._mergedLayers)this._mergedLayers[l].setEventedParent(null);for(const l in this._mergedSourceCaches)this._mergedSourceCaches[l].clearTiles(),this._mergedSourceCaches[l].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(l){const d=this.getSourceCaches(l);for(const y of d)y.clearTiles()}clearSources(){for(const l in this._mergedSourceCaches)this._mergedSourceCaches[l].clearTiles()}reloadSource(l){const d=this.getSourceCaches(l);for(const y of d)y.resume(),y.reload()}reloadSources(){for(const l of this.getSources())l.reload&&l.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(l=>{l.modelManager.reloadModels(l.scope)})}updateSources(l){let d;this.directionalLight&&(d=du(this.directionalLight));for(const y in this._mergedSourceCaches)this._mergedSourceCaches[y].update(l,void 0,void 0,d)}_generateCollisionBoxes(){for(const l in this._sourceCaches){const d=this._sourceCaches[l];d.resume(),d.reload()}}_updatePlacement(l,d,y,N,j,C,F=!1){let W=!1,Z=!1;const Y={},re={};for(const ne of this._mergedOrder){const oe=this._mergedLayers[ne];if(oe.type!=="symbol")continue;const _e=i.aC(oe.source,oe.scope);let ge=Y[_e];if(!ge){const Ae=this.getLayerSourceCache(oe);if(!Ae)continue;const Re=Ae.getRenderableIds(!0).map(qe=>Ae.getTileByID(qe));re[_e]=Re.slice(),ge=Y[_e]=Re.sort((qe,Ue)=>Ue.tileID.overscaledZ-qe.tileID.overscaledZ||(qe.tileID.isLessThan(Ue.tileID)?-1:1))}const Te=this.crossTileSymbolIndex.addLayer(oe,ge,d.center.lng,d.projection);W=W||Te}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),F=F||this._layerOrderChanged||N===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(F||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),d.zoom))&&(this.pauseablePlacement=new W_(d,this._mergedOrder,F,y,N,j,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,Y,re,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),Z=!0),W&&this.pauseablePlacement.placement.setStale()),Z||W){this._buildingIndex.onNewFrame(d.zoom);for(let ne=0;ne<this._mergedOrder.length;ne++){const oe=this._mergedLayers[this._mergedOrder[ne]];if(oe.type!=="symbol")continue;const _e=this.isLayerClipped(oe);this.placement.updateLayerOpacities(oe,Y[i.aC(oe.source,oe.scope)],ne,_e?C:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const l in this._sourceCaches)this._sourceCaches[l].releaseSymbolFadeTiles()}addImport(l,d){this._checkLoaded();const y=this.stylesheet.imports=this.stylesheet.imports||[];if(y.findIndex(({id:j})=>j===l.id)!==-1)return void this.fire(new i.y(new Error(`Import with id '${l.id}' already exists in the map's style.`)));if(!d)return y.push(l),this._loadImports([l],!0);const N=y.findIndex(({id:j})=>j===d);return N===-1&&this.fire(new i.y(new Error(`Import with id "${d}" does not exist on this map.`))),this.stylesheet.imports=y.slice(0,N).concat(l).concat(y.slice(N)),this._loadImports([l],!0,d)}updateImport(l,d){this._checkLoaded();const y=this.stylesheet.imports||[],N=this.getImportIndex(l);return N===-1?this:typeof d=="string"?(this.setImportUrl(l,d),this):(d.url&&d.url!==y[N].url&&this.setImportUrl(l,d.url),i.bn(d.config,y[N].config)||this.setImportConfig(l,d.config,d.data.schema),i.bn(d.data,y[N].data)||this.setImportData(l,d.data),this)}moveImport(l,d){this._checkLoaded();let y=this.stylesheet.imports||[];const N=this.getImportIndex(l);if(N===-1)return this;const j=this.getImportIndex(d);if(j===-1)return this;const C=y[N],F=this.fragments[N];return y=y.filter(({id:W})=>W!==l),this.fragments=this.fragments.filter(({id:W})=>W!==l),this.stylesheet.imports=y.slice(0,j).concat(C).concat(y.slice(j)),this.fragments=this.fragments.slice(0,j).concat(F).concat(this.fragments.slice(j)),this.mergeLayers(),this}setImportUrl(l,d){this._checkLoaded();const y=this.stylesheet.imports||[],N=this.getImportIndex(l);if(N===-1)return this;y[N].url=d;const j=this.fragments[N];return j.style=this._createFragmentStyle(y[N]),j.style.on("style.import.load",()=>this.mergeAll()),j.style.loadURL(d),this}setImportData(l,d){this._checkLoaded();const y=this.getImportIndex(l),N=this.stylesheet.imports||[];return y===-1?this:d?(this.fragments[y].style.setState(d),this._reloadImports(),this):(delete N[y].data,this.setImportUrl(l,N[y].url))}setImportConfig(l,d,y){this._checkLoaded();const N=this.getImportIndex(l),j=this.stylesheet.imports||[];if(N===-1)return this;d?j[N].config=d:delete j[N].config;const C=this.fragments[N];y&&C.style.stylesheet&&(C.style.stylesheet.schema=y);const F=C.style.stylesheet&&C.style.stylesheet.schema;return C.config=d,C.style.updateConfig(d,F),this.updateConfigDependencies(),this}removeImport(l){this._checkLoaded();const d=this.stylesheet.imports||[],y=this.getImportIndex(l);y!==-1&&(d.splice(y,1),this.fragments[y].style._remove(),this.fragments.splice(y,1),this._reloadImports())}getImportIndex(l){const d=(this.stylesheet.imports||[]).findIndex(y=>y.id===l);return d===-1&&this.fire(new i.y(new Error(`Import '${l}' does not exist in the map's style and cannot be updated.`))),d}getLayer(l){return this._mergedLayers[l]}getSources(){const l=[];for(const d in this._mergedOtherSourceCaches){const y=this._mergedOtherSourceCaches[d];y&&l.push(y.getSource())}return l}getSource(l,d){const y=this.getSourceCache(l,d);return y&&y.getSource()}getLayerSource(l){const d=this.getLayerSourceCache(l);return d&&d.getSource()}getSourceCache(l,d){const y=i.aC(l,d);return this._mergedOtherSourceCaches[y]}getLayerSourceCache(l){const d=i.aC(l.source,l.scope);return l.type==="symbol"?this._mergedSymbolSourceCaches[d]:this._mergedOtherSourceCaches[d]}getSourceCaches(l){if(l==null)return Object.values(this._mergedSourceCaches);const d=[];return this._mergedOtherSourceCaches[l]&&d.push(this._mergedOtherSourceCaches[l]),this._mergedSymbolSourceCaches[l]&&d.push(this._mergedSymbolSourceCaches[l]),d}updateSourceCaches(){const l=this._changes.getUpdatedSourceCaches();for(const d in l){const y=l[d];y==="reload"?this.reloadSource(d):y==="clear"&&this.clearSource(d)}}updateLayers(l){const d=this._changes.getUpdatedPaintProperties();for(const y of d){const N=this.getLayer(y);N&&N.updateTransitions(l)}}getImages(l,d,y){this.imageManager.getImages(d.icons,d.scope,y),this._updateTilesForChangedImages();const N=j=>{j&&j.setDependencies(d.tileID.key,d.type,d.icons)};N(this._otherSourceCaches[d.source]),N(this._symbolSourceCaches[d.source])}rasterizeImages(l,d,y){this.imageManager.rasterizeImages(d,y)}getGlyphs(l,d,y){this.glyphManager.getGlyphs(d.stacks,d.scope,y)}getResource(l,d,y){return i.cy(d,y)}getOwnSourceCache(l){return this._otherSourceCaches[l]}getOwnLayerSourceCache(l){return l.type==="symbol"?this._symbolSourceCaches[l.source]:this._otherSourceCaches[l.source]}getOwnSourceCaches(l){const d=[];return this._otherSourceCaches[l]&&d.push(this._otherSourceCaches[l]),this._symbolSourceCaches[l]&&d.push(this._symbolSourceCaches[l]),d}_isSourceCacheLoaded(l){const d=this.getOwnSourceCaches(l);return d.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${l}'`))),!1):d.every(y=>y.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(l,d){if(!this._clipLayerPresent&&l.type!=="fill-extrusion")return!1;const y=l.type==="fill-extrusion"&&l.sourceLayer==="building";if(l.is3D()){if(y||d&&d.type==="batched-model"||l.type==="model")return!0}else if(l.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(l=>{l.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Xo.getSourceType=function(g){return ls[g]},Xo.setSourceType=function(g,l){ls[g]=l},Xo.registerForPluginStateChange=i.ch;var Km=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Ep=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,hu=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Ic="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Qu=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Mp=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,ed=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,fu=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Lc=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Jd=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,td=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Dc=[];rd(Km,Dc),rd(hu,Dc),rd(Ep,Dc);const Qd={"_prelude_fog.vertex.glsl":Mp,"_prelude_terrain.vertex.glsl":Qu,"_prelude_shadow.vertex.glsl":Jd,"_prelude_fog.fragment.glsl":ed,"_prelude_shadow.fragment.glsl":td,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":fu,"_prelude_raster_particle.glsl":Lc},pf={};Pn("",Qu),Pn(ed,Mp),Pn(td,Jd),Pn(fu,""),Pn(Lc,"");const Op=Pn(Ep,hu),mf=Km;var eh={background:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Pn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Pn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Pn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Pn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Pn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Pn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Pn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Pn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Pn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Pn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Pn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Pn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Pn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Pn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Pn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Pn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Ic),skyboxGradient:Pn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Ic),skyboxCapture:Pn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Pn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Pn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Pn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Pn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Pn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Pn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Pn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Pn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function rd(g,l){const d=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let y of d)if(y=y.trim(),y[0]==="#"&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const N=y.split(" ");for(const j of N)l.includes(j)||l.push(j)}}function Pn(g,l){const d=/#include\s+"([^"]+)"/g,y=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let N=l.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);N&&(N=N.map(Z=>{const Y=Z.split(" ");return Y[Y.length-1]}),N=[...new Set(N)]);const j={},C=[],F=[];if(g=g.replace(d,(Z,Y)=>(F.push(Y),"")),(l=l.replace(d,(Z,Y)=>(C.push(Y),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let W=[...Dc];rd(g,W),rd(l,W);for(const Z of[...C,...F])Qd[Z]||console.error(`Undefined include: ${Z}`),pf[Z]||(pf[Z]=[],rd(Qd[Z],pf[Z])),W=[...W,...pf[Z]];return{fragmentSource:g=g.replace(y,(Z,Y,re,ne,oe)=>(j[oe]=!0,Y==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
in ${re} ${ne} ${oe};
#else
uniform ${re} ${ne} u_${oe};
#endif
`:Y==="initialize"?`
#ifdef HAS_UNIFORM_u_${oe}
    ${re} ${ne} ${oe} = u_${oe};
#endif
`:Y==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    in ${re} ${ne} ${oe};
#endif
`:Y==="initialize-attribute"?"":void 0)),vertexSource:l=l.replace(y,(Z,Y,re,ne,oe)=>{const _e=ne==="float"?"vec2":ne,ge=oe.match(/color/)?"color":_e;return Y==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
in ${re} ${ne} a_${oe};
#endif
`:j[oe]?Y==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
uniform lowp float u_${oe}_t;
in ${re} ${_e} a_${oe};
out ${re} ${ne} ${oe};
#else
uniform ${re} ${ne} u_${oe};
#endif
`:Y==="initialize"?ge==="vec4"?`
#ifndef HAS_UNIFORM_u_${oe}
    ${oe} = a_${oe};
#else
    ${re} ${ne} ${oe} = u_${oe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${oe}
    ${oe} = unpack_mix_${ge}(a_${oe}, u_${oe}_t);
#else
    ${re} ${ne} ${oe} = u_${oe};
#endif
`:Y==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    in ${re} ${ne} a_${oe};
    out ${re} ${ne} ${oe};
#endif
`:Y==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    ${oe} = a_${oe};
#endif
`:void 0:Y==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
uniform lowp float u_${oe}_t;
in ${re} ${_e} a_${oe};
#else
uniform ${re} ${ne} u_${oe};
#endif
`:Y==="define-instanced"?ge==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${oe}0;
in vec4 a_${oe}1;
in vec4 a_${oe}2;
in vec4 a_${oe}3;
#else
uniform ${re} ${ne} u_${oe};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${re} ${_e} a_${oe};
#else
uniform ${re} ${ne} u_${oe};
#endif
`:Y==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    ${re} ${ne} ${oe} = a_${oe};
#endif
`:ge==="vec4"?`
#ifndef HAS_UNIFORM_u_${oe}
    ${re} ${ne} ${oe} = a_${oe};
#else
    ${re} ${ne} ${oe} = u_${oe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${oe}
    ${re} ${ne} ${oe} = unpack_mix_${ge}(a_${oe}, u_${oe}_t);
#else
    ${re} ${ne} ${oe} = u_${oe};
#endif
`}),staticAttributes:N,usedDefines:W,vertexIncludes:C,fragmentIncludes:F}}class Zm{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(l,d,y,N,j,C,F,W){this.context=l;let Z=this.boundPaintVertexBuffers.length!==N.length;for(let re=0;!Z&&re<N.length;re++)this.boundPaintVertexBuffers[re]!==N[re]&&(Z=!0);let Y=this.boundDynamicVertexBuffers.length!==F.length;for(let re=0;!Y&&re<F.length;re++)this.boundDynamicVertexBuffers[re]!==F[re]&&(Y=!0);if(!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==y||Z||Y||this.boundIndexBuffer!==j||this.boundVertexOffset!==C)this.freshBind(d,y,N,j,C,F,W);else{l.bindVertexArrayOES.set(this.vao);for(const re of F)re&&(re.bind(),W&&re.instanceCount&&re.setVertexAttribDivisor(l.gl,d,W));j&&j.dynamicDraw&&j.bind()}}freshBind(l,d,y,N,j,C,F){const W=l.numAttributes,Z=this.context,Y=Z.gl;this.vao&&this.destroy(),this.vao=Z.gl.createVertexArray(),Z.bindVertexArrayOES.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=N,this.boundVertexOffset=j,this.boundDynamicVertexBuffers=C,d.enableAttributes(Y,l),d.bind(),d.setVertexAttribPointers(Y,l,j);for(const re of y)re.enableAttributes(Y,l),re.bind(),re.setVertexAttribPointers(Y,l,j);for(const re of C)re&&(re.enableAttributes(Y,l),re.bind(),re.setVertexAttribPointers(Y,l,j),F&&re.instanceCount&&re.setVertexAttribDivisor(Y,l,F));N&&N.bind(),Z.currentNumAttributes=W}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function nd(g,l){const d=Math.pow(2,l.canonical.z),y=l.canonical.y;return[new i.aa(0,y/d).toLngLat().lat,new i.aa(0,(y+1)/d).toLngLat().lat]}function px(g,l,d,y,N,j,C){const F=g.context,W=F.gl,Z=d.hillshadeFBO;if(!Z)return;g.prepareDrawTile();const Y=g.isTileAffectedByFog(l),re=g.getOrCreateProgram("hillshade",{overrideFog:Y});F.activeTexture.set(W.TEXTURE0),W.bindTexture(W.TEXTURE_2D,Z.colorAttachment.get());const ne=((Te,Ae,Re,qe)=>{const Ue=Re.paint.get("hillshade-shadow-color"),Qe=Re.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Ke=Re.paint.get("hillshade-highlight-color"),Ze=Re.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",He=Re.paint.get("hillshade-accent-color"),Xe=Re.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",at=Re.paint.get("hillshade-emissive-strength");let _t=i.ai(Re.paint.get("hillshade-illumination-direction"));if(Re.paint.get("hillshade-illumination-anchor")==="viewport")_t-=Te.transform.angle;else if(Te.style&&Te.style.enable3dLights()&&Te.style.directionalLight){const kt=Te.style.directionalLight.properties.get("direction"),Pt=i.cb(kt.x,kt.y,kt.z);_t=i.ai(Pt[1])}const mt=!Te.options.moving;return{u_matrix:qe||Te.transform.calculateProjMatrix(Ae.tileID.toUnwrapped(),mt),u_image:0,u_latrange:nd(0,Ae.tileID),u_light:[Re.paint.get("hillshade-exaggeration"),_t],u_shadow:Ue.toRenderColor(Qe?null:Re.lut),u_highlight:Ke.toRenderColor(Ze?null:Re.lut),u_emissive_strength:at,u_accent:He.toRenderColor(Xe?null:Re.lut)}})(g,d,y,g.terrain?l.projMatrix:null);g.uploadCommonUniforms(F,re,l.toUnwrapped());const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:_e,tileBoundsSegments:ge}=g.getTileBoundsBuffers(d);re.draw(g,W.TRIANGLES,N,j,C,Jr.disabled,ne,y.id,oe,_e,ge)}function mx(g,l,d){if(!l.needsDEMTextureUpload)return;const y=g.context,N=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||g.getTileTexture(d.stride);const j=d.getPixels();l.demTexture?l.demTexture.update(j,{premultiply:!1}):l.demTexture=new i.T(y,j,N.R32F,{premultiply:!1}),l.needsDEMTextureUpload=!1}function Rp(g,l,d){const y=g.context,N=y.gl;if(!l.dem)return;const j=l.dem;if(y.activeTexture.set(N.TEXTURE1),mx(g,l,j),!l.demTexture)return;l.demTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE);const C=j.dim;y.activeTexture.set(N.TEXTURE0);let F=l.hillshadeFBO;if(!F){const ne=new i.T(y,{width:C,height:C,data:null},N.RGBA8);ne.bind(N.LINEAR,N.CLAMP_TO_EDGE),F=l.hillshadeFBO=y.createFramebuffer(C,C,!0,"renderbuffer"),F.colorAttachment.set(ne.texture)}y.bindFramebuffer.set(F.framebuffer),y.viewport.set([0,0,C,C]);const{tileBoundsBuffer:W,tileBoundsIndexBuffer:Z,tileBoundsSegments:Y}=g.getMercatorTileBoundsBuffers(),re=[];g.linearFloatFilteringSupported()&&re.push("TERRAIN_DEM_FLOAT_FORMAT"),g.getOrCreateProgram("hillshadePrepare",{defines:re}).draw(g,N.TRIANGLES,zr.disabled,Wr.disabled,kn.unblended,Jr.disabled,((ne,oe)=>{const _e=oe.stride,ge=i.ab.mat4.create();return i.ab.mat4.ortho(ge,0,i.ag,-i.ag,0,0,1),i.ab.mat4.translate(ge,ge,[0,-i.ag,0]),{u_matrix:ge,u_image:1,u_dimension:[_e,_e],u_zoom:ne.overscaledZ}})(l.tileID,j),d.id,W,Z,Y),l.needsHillshadePrepare=!1}class Li{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ym extends Li{getDefault(){return i.aj.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Xm extends Li{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class fa extends Li{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class Ip extends Li{getDefault(){return[!0,!0,!0,!0]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Lp extends Li{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class gf extends Li{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class gx extends Li{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const d=this.current;(l.func!==d.func||l.ref!==d.ref||l.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class th extends Li{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class pu extends Li{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=l,this.dirty=!1}}class Dp extends Li{getDefault(){return[0,1]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class Is extends Li{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=l,this.dirty=!1}}class Jm extends Li{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class Qm extends Li{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.BLEND):d.disable(d.BLEND),this.current=l,this.dirty=!1}}class eg extends Li{getDefault(){const l=this.gl;return[l.ONE,l.ZERO,l.ONE,l.ZERO]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.blendFuncSeparate(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class tg extends Li{getDefault(){return i.aj.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class yf extends Li{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(l,l),this.current=l,this.dirty=!1)}}class rh extends Li{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=l,this.dirty=!1}}class Fp extends Li{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class zp extends Li{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}let xf=class extends Li{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class rg extends Li{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class yx extends Li{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class nh extends Li{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class Z_ extends Li{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Y_ extends Li{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Ey extends Li{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class id extends Li{getDefault(){return null}set(l){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class xx extends Li{getDefault(){return null}set(l){this.gl&&(l!==this.current||this.dirty)&&(this.gl.bindVertexArray(l),this.current=l,this.dirty=!1)}}class vf extends Li{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class Vl extends Li{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class ih extends Li{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class Ul extends Li{constructor(l,d){super(l),this.context=l,this.parent=d}getDefault(){return null}}class ad extends Ul{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class My extends Ul{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class vx extends Ul{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,this.attachment(),d.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class sd extends My{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const ah=(g,l,d)=>({u_matrix:g,u_image0:0,u_skirt_height:l,u_ground_shadow_factor:d}),bl=(g,l,d,y,N,j,C,F,W,Z,Y,re,ne,oe,_e,ge)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:l,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:d,u_zoom_transition:N,u_merc_center:j,u_image0:0,u_frustum_tl:C,u_frustum_tr:F,u_frustum_br:W,u_frustum_bl:Z,u_globe_pos:Y,u_globe_radius:re,u_viewport:ne,u_grid_matrix:ge?Float32Array.from(ge):new Float32Array(9),u_skirt_height:oe,u_far_z_cutoff:_e});function _f(g,l){return g!=null&&l!=null&&!(!g.hasData()||!l.hasData())&&g.demTexture!=null&&l.demTexture!=null&&g.tileID.key!==l.tileID.key}const Ro=new class{constructor(){this.operations={}}newMorphing(g,l,d,y,N){if(g in this.operations){const j=this.operations[g];j.to.tileID.key!==d.tileID.key&&(j.queued=d)}else this.operations[g]={startTime:y,phase:0,duration:N,from:l,to:d,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const l=this.operations[g];return{from:l.from,to:l.to,phase:l.phase}}update(g){for(const l in this.operations){const d=this.operations[l];for(d.phase=(g-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,g)){delete this.operations[l];break}}}_nextOp(g,l){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=l,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},mu={0:null,1:"TERRAIN_VERTEX_MORPHING"};function $l(g,l,d){if(l===0)return 0;const y=l<1&&d===514?.25/l:1;return 6*Math.pow(1.5,22-g)*Math.max(l,1)*y}function wa(g,l){const d=1<<g.z;return!l&&(g.x===0||g.x===d-1)||g.y===0||g.y===d-1}const ra=g=>({u_matrix:g});function ql(g,l,d,y,N){if(N>0){const j=i.q.now(),C=(j-g.timeAdded)/N,F=l?(j-l.timeAdded)/N:-1,W=d.getSource(),Z=y.coveringZoomLevel({tileSize:W.tileSize,roundZoom:W.roundZoom}),Y=!l||Math.abs(l.tileID.overscaledZ-Z)>Math.abs(g.tileID.overscaledZ-Z),re=Y&&g.refreshedUponExpiration?1:i.aw(Y?C:1-F,0,1);return g.refreshedUponExpiration&&C>=1&&(g.refreshedUponExpiration=!1),l?{opacity:1,mix:1-re}:{opacity:re,mix:0}}return{opacity:1,mix:0}}class Ws extends Zo{constructor(l){const d={type:"raster-dem",maxzoom:l.transform.maxZoom},y=new i.D(i.ci(),null),N=vo("mock-dem",d,y,l.style);super("mock-dem",N,!1),N.setEventedParent(this),this._sourceLoaded=!0}_loadTile(l,d){l.state="loaded",d(null)}}class Jo extends Zo{constructor(l){const d=vo("proxy",{type:"geojson",maxzoom:l.transform.maxZoom},new i.D(i.ci(),null),l.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=l,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(l,d,y){if(l.freezeTileCoverage)return;this.transform=l;const N=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((j,C)=>{if(j[C.key]="",!this._tiles[C.key]){const F=new Pc(C,this._source.tileSize*C.overscaleFactor(),l.tileZoom);F.state="loaded",this._tiles[C.key]=F}return j},{});for(const j in this._tiles)j in N||(this.freeFBO(j),this._tiles[j].unloadVectorData(),delete this._tiles[j])}freeFBO(l){const d=this.proxyCachedFBO[l];if(d!==void 0){const y=Object.values(d);this.renderCachePool.push(...y),delete this.proxyCachedFBO[l]}}deallocRenderCache(){this.renderCache.forEach(l=>l.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class gu extends i.aG{constructor(l,d,y){super(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y),this.proxyTileKey=d,this.projMatrix=y}}class cc extends i.cJ{constructor(l,d){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},l.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),l.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),l.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=l,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,N,j]=function(W){const Z=new i.b4,Y=new i.aU,re=131;Z.reserve(17161),Y.reserve(33800);const ne=i.ag/128,oe=i.ag+ne/2,_e=oe+ne;for(let Te=-ne;Te<_e;Te+=ne)for(let Ae=-ne;Ae<_e;Ae+=ne){const Re=Ae<0||Ae>oe||Te<0||Te>oe?24575:0,qe=i.aw(Math.round(Ae),0,i.ag),Ue=i.aw(Math.round(Te),0,i.ag);Z.emplaceBack(qe+Re,Ue)}const ge=(Te,Ae)=>{const Re=Ae*re+Te;Y.emplaceBack(Re+1,Re,Re+re),Y.emplaceBack(Re+re,Re+re+1,Re+1)};for(let Te=1;Te<129;Te++)for(let Ae=1;Ae<129;Ae++)ge(Ae,Te);return[0,129].forEach(Te=>{for(let Ae=0;Ae<130;Ae++)ge(Ae,Te),ge(Te,Ae)}),[Z,Y,32768]}(),C=l.context;this.gridBuffer=C.createVertexBuffer(y,i.b6.members),this.gridIndexBuffer=C.createIndexBuffer(N),this.gridSegments=i.b7.simpleSegment(0,0,y.length,N.length),this.gridNoSkirtSegments=i.b7.simpleSegment(0,0,y.length,j),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Jo(d.map),this.orthoMatrix=i.ab.mat4.create(),i.ab.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.ag,0,i.ag,0,1);const F=C.gl;this._overlapStencilMode=new Wr({func:F.GEQUAL,mask:255},0,255,F.KEEP,F.KEEP,F.REPLACE),this._previousZoom=l.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ws(d.map),this._pendingGroundEffectLayers=[]}set style(l){l.on("data",this._onStyleDataEvent.bind(this)),this._style=l,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(l,d,y){if(l&&l.terrain){this._style!==l&&(this.style=l,this._evaluationZoom=void 0);const N=l.terrain.properties,j=l.terrain.drapeRenderMode===0,C=l.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const F=l.terrain&&l.terrain.scope,W=N.get("source"),Z=j?this._mockSourceCache:l.getSourceCache(W,F);if(!Z)return void i.w(`Couldn't find terrain source "${W}".`);if(this.sourceCache=Z,this._attenuationRange=l.terrain.getAttenuationRange(),this._exaggeration=C?this.calculateExaggeration(d):N.get("exaggeration"),!d.projection.requiresDraping&&C&&this._exaggeration===0)return void this._disable();this.enabled=!0;const Y=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const re=this.getScaledDemTileSize();this.sourceCache.update(d,re,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,Y(),this._initializing=!0),Y(),d.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0,this._previousZoom=d.zoom}else this._disable()}calculateExaggeration(l){if(this._attenuationRange&&l.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(l.zoom);const d=this._previousCameraAltitude,y=l.getFreeCameraOptions().position.z/l.pixelsPerMeter*l.worldSize;this._previousCameraAltitude=y;const N=d!=null?y-d:Number.MAX_VALUE;if(Math.abs(N)<2)return this._exaggeration;const j=l.zoom,C=this._style.terrain;if(!this._previousUpdateTimestamp)return C.getExaggeration(j);let F=j-this._previousZoom;const W=this._previousUpdateTimestamp;let Z=j;this._evaluationZoom!=null&&(Z=this._evaluationZoom,Math.abs(j-Z)>.5&&(F=.5*(j-Z+F)),F*N<0&&(Z+=F)),this._evaluationZoom=Z;const Y=C.getExaggeration(Z),re=Y===C.getExaggeration(Math.max(0,Z-.1));if(re&&Math.abs(Y-this._exaggeration)<.01)return Y;let ne=Math.min(.1,.00375*(this._updateTimestamp-W));return(re||Y<.1||Math.abs(F)<1e-4)&&(ne=Math.min(.2,4*ne)),i.af(this._exaggeration,Y,ne)}resetTileLookupCache(l){this._findCoveringTileCache[l]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(l){l.coord&&l.dataType==="source"?this._clearRenderCacheForTile(l.sourceCacheId,l.coord):l.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const l in this._style._mergedSourceCaches)this._style._mergedSourceCaches[l].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(l=>l.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const l=2*this.proxySourceCache.getSource().tileSize;return[l,l]}set useVertexMorphing(l){this._useVertexMorphing=l}updateTileBinding(l){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(i.aa.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const N=this.proxyCoords=d.getIds().map(W=>{const Z=d.getTileByID(W).tileID;return Z.projMatrix=y.calculateProjMatrix(Z.toUnwrapped()),Z});(function(W,Z){const Y=Z.transform.pointCoordinate(Z.transform.getCameraPoint()),re=new i.P(Y.x,Y.y);W.sort((ne,oe)=>{if(oe.overscaledZ-ne.overscaledZ)return oe.overscaledZ-ne.overscaledZ;const _e=new i.P(ne.canonical.x+(1<<ne.canonical.z)*ne.wrap,ne.canonical.y),ge=new i.P(oe.canonical.x+(1<<oe.canonical.z)*oe.wrap,oe.canonical.y),Te=re.mult(1<<ne.canonical.z);return Te.x-=.5,Te.y-=.5,Te.distSqr(_e)-Te.distSqr(ge)})})(N,this.painter);const j=this.proxyToSource||{};this.proxyToSource={},N.forEach(W=>{this.proxyToSource[W.key]={}}),this.terrainTileForTile={};const C=this._style._mergedSourceCaches;for(const W in C){const Z=C[W];if(!Z.used||(Z!==this.sourceCache&&this.resetTileLookupCache(Z.id),this._setupProxiedCoordsForOrtho(Z,l[W],j),Z.usedForTerrain))continue;const Y=l[W];Z.getSource().reparseOverscaled&&this._assignTerrainTiles(Y)}this.proxiedCoords[d.id]=N.map(W=>new gu(W,W.key,this.orthoMatrix)),this._assignTerrainTiles(N),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(j),this.renderingToTexture=!1;const F={};this._visibleDemTiles=[];for(const W of this.proxyCoords){const Z=this.terrainTileForTile[W.key];if(!Z)continue;const Y=Z.tileID.key;Y in F||(this._visibleDemTiles.push(Z),F[Y]=Y)}}_assignTerrainTiles(l){this._initializing||l.forEach(d=>{if(this.terrainTileForTile[d.key])return;const y=this._findTileCoveringTileID(d,this.sourceCache);y&&(this.terrainTileForTile[d.key]=y)})}_prepareDEMTextures(){const l=this.painter.context,d=l.gl;for(const y in this.terrainTileForTile){const N=this.terrainTileForTile[y],j=N.dem;!j||N.demTexture&&!N.needsDEMTextureUpload||(l.activeTexture.set(d.TEXTURE1),mx(this.painter,N,j))}}_prepareDemTileUniforms(l,d,y,N){if(!d||d.demTexture==null)return!1;const j=l.tileID.canonical,C=Math.pow(2,d.tileID.canonical.z-j.z),F=N||"";return y[`u_dem_tl${F}`]=[j.x*C%1,j.y*C%1],y[`u_dem_scale${F}`]=C,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let l=0;const d=this._visibleDemTiles.reduce((y,N)=>{if(!N.dem)return y;const j=N.dem.tree.minimums[0];return j>0&&l++,y+j},0);return l?d/l:0}_updateEmptyDEMTexture(){const l=this.painter.context,d=l.gl;l.activeTexture.set(d.TEXTURE2);const y=this._getLoadedAreaMinimum(),N=new i.cK({width:1,height:1},new Float32Array([y]));this._emptyDEMTextureDirty=!1;let j=this._emptyDEMTexture;return j?j.update(N,{premultiply:!1}):j=this._emptyDEMTexture=new i.T(l,N,d.R32F,{premultiply:!1}),j}setupElevationDraw(l,d,y){const N=this.painter.context,j=N.gl,C={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};C.u_exaggeration=this.exaggeration();let F=null,W=null,Z=1;if(y&&y.morphing&&this._useVertexMorphing){const oe=y.morphing.srcDemTile,_e=y.morphing.dstDemTile;Z=y.morphing.phase,oe&&_e&&(this._prepareDemTileUniforms(l,oe,C,"_prev")&&(W=oe),this._prepareDemTileUniforms(l,_e,C)&&(F=_e))}const Y=oe=>oe&&oe.demTexture&&this.painter.linearFloatFilteringSupported()?j.LINEAR:j.NEAREST;let re=null;var ne;if(this.enabled?W&&F?(re=F.demTexture,N.activeTexture.set(j.TEXTURE4),W.demTexture.bind(Y(W),j.CLAMP_TO_EDGE),C.u_dem_lerp=Z):(F=this.terrainTileForTile[l.tileID.key],re=this._prepareDemTileUniforms(l,F,C)?F.demTexture:this.emptyDEMTexture):re=this.emptyDEMTexture,N.activeTexture.set(j.TEXTURE2),re&&(C.u_dem_size=(ne=re).size[0]===1?1:ne.size[0]-2,re.bind(Y(F),j.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(y&&y.useDepthForOcclusion,d,C),y&&y.useMeterToDem&&F){const oe=(1<<F.tileID.canonical.z)*i.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;C.u_meter_to_dem=oe}if(y&&y.labelPlaneMatrixInv&&(C.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),d.setTerrainUniformValues(N,C),this.painter.transform.projection.name==="globe"){const oe=this.globeUniformValues(this.painter.transform,l.tileID.canonical,y&&y.useDenormalizedUpVectorScale);d.setGlobeUniformValues(N,oe)}}globeUniformValues(l,d,y){const N=l.projection;return{u_tile_tl_up:N.upVector(d,0,0),u_tile_tr_up:N.upVector(d,i.ag,0),u_tile_br_up:N.upVector(d,i.ag,i.ag),u_tile_bl_up:N.upVector(d,0,i.ag),u_tile_up_scale:y?i.cL(1):N.upVectorScale(d,l.center.lat,l.worldSize).metersToTile}}renderToBackBuffer(l){const d=this.painter,y=this.painter.context;l.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(N,j,C,F,W){if(N.transform.projection.name==="globe")(function(Z,Y,re,ne,oe){const _e=Z.context,ge=_e.gl;let Te,Ae;const Re=Z.transform,qe=i.cC(Z,_e,Re),Ue=(kt,Pt)=>{if(Ae===Pt)return;const ht=[mu[Pt],"PROJECTION_GLOBE_VIEW"];qe&&ht.push("CUSTOM_ANTIALIASING");const Tt=Z.isTileAffectedByFog(kt);Te=Z.getOrCreateProgram("globeRaster",{defines:ht,overrideFog:Tt}),Ae=Pt},Qe=Z.colorModeForRenderPass(),Ke=new zr(ge.LEQUAL,zr.ReadWrite,Z.depthRangeFor3D);Ro.update(oe);const Ze=i.cD(Re),He=[i.at(Re.center.lng),i.aA(Re.center.lat)],Xe=Z.globeSharedBuffers,at=[Re.width*i.q.devicePixelRatio,Re.height*i.q.devicePixelRatio],_t=Float32Array.from(Re.globeMatrix),mt={useDenormalizedUpVectorScale:!0};{const kt=Z.transform,Pt=$l(kt.zoom,Y.exaggeration(),Y.sourceCache._source.tileSize);Ae=-1;const ht=ge.TRIANGLES;for(const Tt of ne){const $t=re.getTile(Tt),pt=Wr.disabled,Lt=Y.prevTerrainTileForTile[Tt.key],jt=Y.terrainTileForTile[Tt.key];_f(Lt,jt)&&Ro.newMorphing(Tt.key,Lt,jt,oe,250),_e.activeTexture.set(ge.TEXTURE0),$t.texture&&$t.texture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE);const Xt=Ro.getMorphValuesForProxy(Tt.key),Vt=Xt?1:0;Xt&&i.J(mt,{morphing:{srcDemTile:Xt.from,dstDemTile:Xt.to,phase:i.cB(Xt.phase)}});const It=i.cE(Tt.canonical),Ht=i.cF(It.getCenter().lat),tr=i.cG(Tt.canonical,It,Ht,kt.worldSize/kt._pixelsPerMercatorPixel),gr=i.bb(i.cH(Tt.canonical)),xr=bl(kt.expandedFarZProjMatrix,_t,Ze,gr,i.ae(kt.zoom),He,kt.frustumCorners.TL,kt.frustumCorners.TR,kt.frustumCorners.BR,kt.frustumCorners.BL,kt.globeCenterInViewSpace,kt.globeRadius,at,Pt,kt._farZ,tr);if(Ue(Tt,Vt),Te&&(Y.setupElevationDraw($t,Te,mt),Z.uploadCommonUniforms(_e,Te,Tt.toUnwrapped()),Xe)){const[qr,Or,Lr]=Xe.getGridBuffers(Ht,Pt!==0);Te.draw(Z,ht,Ke,pt,Qe,Jr.backCCW,xr,"globe_raster",qr,Or,Lr)}}}if(Xe&&(Z.renderDefaultNorthPole||Z.renderDefaultSouthPole)){const kt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];qe&&kt.push("CUSTOM_ANTIALIASING"),Te=Z.getOrCreateProgram("globeRaster",{defines:kt});for(const Pt of ne){const{x:ht,y:Tt,z:$t}=Pt.canonical,pt=Tt===0,Lt=Tt===(1<<$t)-1,[jt,Xt,Vt,It]=Xe.getPoleBuffers($t,!1);if(It&&(pt||Lt)){const Ht=re.getTile(Pt);_e.activeTexture.set(ge.TEXTURE0),Ht.texture&&Ht.texture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE);let tr=i.cI($t,ht,Re);const gr=i.bb(i.cH(Pt.canonical)),xr=(qr,Or)=>qr.draw(Z,ge.TRIANGLES,Ke,Wr.disabled,Qe,Jr.disabled,bl(Re.expandedFarZProjMatrix,tr,tr,gr,0,He,Re.frustumCorners.TL,Re.frustumCorners.TR,Re.frustumCorners.BR,Re.frustumCorners.BL,Re.globeCenterInViewSpace,Re.globeRadius,at,0,Re._farZ),"globe_pole_raster",Or,Vt,It);Y.setupElevationDraw(Ht,Te,mt),Z.uploadCommonUniforms(_e,Te,Pt.toUnwrapped()),pt&&Z.renderDefaultNorthPole&&xr(Te,jt),Lt&&Z.renderDefaultSouthPole&&(tr=i.ab.mat4.scale(i.ab.mat4.create(),tr,[1,-1,1]),xr(Te,Xt))}}}})(N,j,C,F,W);else{const Z=N.context,Y=Z.gl;let re,ne;const oe=N.shadowRenderer,_e=Bl(N,N.longestCutoffRange),ge=Qe=>{if(ne===Qe)return;const Ke=[];Ke.push(mu[Qe]),_e.shouldRenderCutoff&&Ke.push("RENDER_CUTOFF"),oe&&(Ke.push("RENDER_SHADOWS","DEPTH_TEXTURE"),oe.useNormalOffset&&Ke.push("NORMAL_OFFSET")),re=N.getOrCreateProgram("terrainRaster",{defines:Ke}),ne=Qe},Te=N.colorModeForRenderPass(),Ae=new zr(Y.LEQUAL,zr.ReadWrite,N.depthRangeFor3D);Ro.update(W);const Re=N.transform,qe=$l(Re.zoom,j.exaggeration(),j.sourceCache._source.tileSize);let Ue=[0,0,0];if(oe){const Qe=N.style.directionalLight,Ke=N.style.ambientLight;Qe&&Ke&&(Ue=Pp(N.style,Qe,Ke))}{ne=-1;const Qe=Y.TRIANGLES,[Ke,Ze]=[j.gridIndexBuffer,j.gridSegments];for(const He of F){const Xe=C.getTile(He),at=Wr.disabled,_t=j.prevTerrainTileForTile[He.key],mt=j.terrainTileForTile[He.key];_f(_t,mt)&&Ro.newMorphing(He.key,_t,mt,W,250),Z.activeTexture.set(Y.TEXTURE0),Xe.texture&&Xe.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const kt=Ro.getMorphValuesForProxy(He.key),Pt=kt?1:0;let ht;kt&&(ht={morphing:{srcDemTile:kt.from,dstDemTile:kt.to,phase:i.cB(kt.phase)}});const Tt=ah(He.projMatrix,wa(He.canonical,Re.renderWorldCopies)?qe/10:qe,Ue);if(ge(Pt),!re)continue;j.setupElevationDraw(Xe,re,ht);const $t=He.toUnwrapped();oe&&oe.setupShadows($t,re),N.uploadCommonUniforms(Z,re,$t,null,_e),re.draw(N,Qe,Ae,at,Te,Jr.backCCW,Tt,"terrain_raster",j.gridBuffer,Ke,Ze)}}}}(d,this,this.proxySourceCache,l,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),l.splice(0,l.length))}renderBatch(l){if(this._drapedRenderBatches.length===0)return l+1;this.renderingToTexture=!0;const d=this.painter,y=this.painter.context,N=this.proxySourceCache,j=this.proxiedCoords[N.id],C=this._drapedRenderBatches.shift(),F=d.style.order,W=[];let Z=0;for(const Y of j){const re=N.getTileByID(Y.proxyTileKey),ne=N.proxyCachedFBO[Y.key]?N.proxyCachedFBO[Y.key][l]:void 0,oe=ne!==void 0?N.renderCache[ne]:this.pool[Z++],_e=ne!==void 0;if(re.texture=oe.tex,_e&&!oe.dirty){W.push(re.tileID);continue}let ge;y.bindFramebuffer.set(oe.fb.framebuffer),this.renderedToTile=!1,oe.dirty&&(y.clear({color:i.aj.transparent,stencil:0}),oe.dirty=!1);for(let Te=C.start;Te<=C.end;++Te){const Ae=d.style._mergedLayers[F[Te]];if(Ae.isHidden(d.transform.zoom))continue;const Re=d.style.getLayerSourceCache(Ae),qe=Re?this.proxyToSource[Y.key][Re.id]:[Y];if(!qe)continue;const Ue=qe;y.viewport.set([0,0,oe.fb.width,oe.fb.height]),ge!==(Re?Re.id:null)&&(this._setupStencil(oe,qe,Ae,Re),ge=Re?Re.id:null),d.renderLayer(d,Re,Ae,Ue)}if(this._drapedRenderBatches.length===0)for(const Te of this._pendingGroundEffectLayers){const Ae=d.style._mergedLayers[F[Te]];if(Ae.isHidden(d.transform.zoom))continue;const Re=d.style.getLayerSourceCache(Ae),qe=Re?this.proxyToSource[Y.key][Re.id]:[Y];if(!qe)continue;const Ue=qe;y.viewport.set([0,0,oe.fb.width,oe.fb.height]),ge!==(Re?Re.id:null)&&(this._setupStencil(oe,qe,Ae,Re),ge=Re?Re.id:null),d.renderLayer(d,Re,Ae,Ue)}this.renderedToTile?(oe.dirty=!0,W.push(re.tileID)):_e||--Z,Z===5&&(Z=0,this.renderToBackBuffer(W))}return this.renderToBackBuffer(W),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,d.width,d.height]),C.end+1}postRender(){}isLayerOrderingCorrect(l){const d=l.order.length;let y=-1,N=d;for(let j=0;j<d;++j)this._style.isLayerDraped(l._mergedLayers[l.order[j]])?y=Math.max(y,j):N=Math.min(N,j);return N>y}getMinElevationBelowMSL(){let l=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{l=Math.min(l,d.dem.tree.minimums[0])}),l===0?l:(l-30)*this._exaggeration}raycast(l,d,y){if(!this._visibleDemTiles)return null;const N=this._visibleDemTiles.filter(j=>j.dem).map(j=>{const C=j.tileID,F=1<<C.overscaledZ,{x:W,y:Z}=C.canonical,Y=W/F,re=(W+1)/F,ne=Z/F,oe=(Z+1)/F;return{minx:Y,miny:ne,maxx:re,maxy:oe,t:j.dem.tree.raycastRoot(Y,ne,re,oe,l,d,y),tile:j}});N.sort((j,C)=>(j.t!==null?j.t:Number.MAX_VALUE)-(C.t!==null?C.t:Number.MAX_VALUE));for(const j of N){if(j.t==null)return null;const C=j.tile.dem.tree.raycast(j.minx,j.miny,j.maxx,j.maxy,l,d,y);if(C!=null)return C}return null}_createFBO(){const l=this.painter.context,d=l.gl,y=this.drapeBufferSize;l.activeTexture.set(d.TEXTURE0);const N=new i.T(l,{width:y[0],height:y[1],data:null},d.RGBA8);N.bind(d.LINEAR,d.CLAMP_TO_EDGE);const j=l.createFramebuffer(y[0],y[1],!0,null);return j.colorAttachment.set(N.texture),j.depthAttachment=new sd(l,j.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=l.createRenderbuffer(l.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,j.depthAttachment.set(this._sharedDepthStencil),l.clear({stencil:0})):j.depthAttachment.set(this._sharedDepthStencil),l.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax),{fb:j,tex:N,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const l in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[l].hasTransition())return!0;return this._style.order.some(l=>{const d=this._style._mergedLayers[l],y=d.isHidden(this.painter.transform.zoom);return d.type==="hillshade"||d.type==="custom"?!y&&d.shouldRedrape():!y&&d.hasTransition()})}_clearLineLayersFromRenderCache(){let l=!1;for(const y of this._style.getSources())if(y instanceof Oa){l=!0;break}if(!l)return;const d={};for(let y=0;y<this._style.order.length;++y){const N=this._style._mergedLayers[this._style.order[y]],j=this._style.getLayerSourceCache(N);if(j&&!d[j.id]&&!N.isHidden(this.painter.transform.zoom)&&N.type==="line"&&N.widthExpression()instanceof i.a9){d[j.id]=!0;for(const C of this.proxyCoords){const F=this.proxyToSource[C.key][j.id];if(F)for(const W of F)this._clearRenderCacheForTile(j.id,W)}}}}_clearRasterLayersFromRenderCache(){let l=!1;for(const y in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[y]._source instanceof ys){l=!0;break}if(!l)return;const d={};for(let y=0;y<this._style.order.length;++y){const N=this._style._mergedLayers[this._style.order[y]],j=this._style.getLayerSourceCache(N);if(!j||d[j.id]||N.isHidden(this.painter.transform.zoom)||N.type!=="raster")continue;const C=N.paint.get("raster-fade-duration");for(const F of this.proxyCoords){const W=this.proxyToSource[F.key][j.id];if(W)for(const Z of W){const Y=ql(j.getTile(Z),j.findLoadedParent(Z,0),j,this.painter.transform,C);(Y.opacity!==1||Y.mix!==0)&&this._clearRenderCacheForTile(j.id,Z)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const l=this._style.order,d=l.length;if(d===0)return;const y=[];this._pendingGroundEffectLayers=[];let N,j=0,C=this._style._mergedLayers[l[j]];for(;!this._style.isLayerDraped(C)&&C.isHidden(this.painter.transform.zoom)&&++j<d;)C=this._style._mergedLayers[l[j]];for(;j<d;++j){const F=this._style._mergedLayers[l[j]];F.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(F)?N===void 0&&(N=j):(F.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(j),N!==void 0&&(y.push({start:N,end:j-1}),N=void 0)))}if(N!==void 0&&y.push({start:N,end:j-1}),y.length!==0){const F=y[y.length-1];this._pendingGroundEffectLayers.every(W=>W>F.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=y}_setupRenderCache(l){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const C=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let F=0;F<C.length;++F){const W=Object.values(C[F]);d.renderCachePool.push(...W)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,N=this._tilesDirty;for(let C=y.length-1;C>=0;C--){const F=y[C];if(d.getTileByID(F.key),d.proxyCachedFBO[F.key]!==void 0){const W=l[F.key],Z=this.proxyToSource[F.key];let Y=0;for(const re in Z){const ne=Z[re],oe=W[re];if(!oe||oe.length!==ne.length||ne.some((_e,ge)=>_e!==oe[ge]||N[re]&&N[re].hasOwnProperty(_e.key))){Y=-1;break}++Y}for(const re in d.proxyCachedFBO[F.key])d.renderCache[d.proxyCachedFBO[F.key][re]].dirty=Y<0||Y!==Object.values(W).length}}const j=[...this._drapedRenderBatches];j.sort((C,F)=>F.end-F.start-(C.end-C.start));for(const C of j)for(const F of y){if(d.proxyCachedFBO[F.key])continue;let W=d.renderCachePool.pop();W===void 0&&d.renderCache.length<50&&(W=d.renderCache.length,d.renderCache.push(this._createFBO())),W!==void 0&&(d.proxyCachedFBO[F.key]={},d.proxyCachedFBO[F.key][C.start]=W,d.renderCache[W].dirty=!0)}this._tilesDirty={}}_setupStencil(l,d,y,N){if(!N||!this._sourceTilesOverlap[N.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const j=this.painter.context,C=j.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let F;if(y.isTileClipped())F=d.length,this._overlapStencilMode.test={func:C.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);F=1,this._overlapStencilMode.test={func:C.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+F>255&&(j.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=F,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(l){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[l.key]),this._overlapStencilMode):Wr.disabled}_renderTileClippingMasks(l,d){const y=this.painter,N=this.painter.context,j=N.gl;y._tileClippingMaskIDs={},N.setColorMode(kn.disabled),N.setDepthMode(zr.disabled);const C=y.getOrCreateProgram("clippingMask");for(const F of l){const W=y._tileClippingMaskIDs[F.key]=--d;C.draw(y,j.TRIANGLES,zr.disabled,new Wr({func:j.ALWAYS,mask:0},W,255,j.KEEP,j.KEEP,j.REPLACE),kn.disabled,Jr.disabled,ra(F.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(l){const d=this.painter.transform;if(l.x<0||l.x>d.width||l.y<0||l.y>d.height)return null;const y=[l.x,l.y,1,1];i.ab.vec4.transformMat4(y,y,d.pixelMatrixInverse),i.ab.vec4.scale(y,y,1/y[3]),y[0]/=d.worldSize,y[1]/=d.worldSize;const N=d._camera.position,j=i.bH(1,d.center.lat),C=[N[0],N[1],N[2]/j,0],F=i.ab.vec3.subtract([],y.slice(0,3),C);i.ab.vec3.normalize(F,F);const W=this.raycast(C,F,this._exaggeration);return W!==null&&W?(i.ab.vec3.scaleAndAdd(C,C,F,W),C[3]=C[2],C[2]*=j,C):null}_setupProxiedCoordsForOrtho(l,d,y){if(l.getSource()instanceof i.aJ)return this._setupProxiedCoordsForImageSource(l,d,y);this._findCoveringTileCache[l.id]=this._findCoveringTileCache[l.id]||{};const N=this.proxiedCoords[l.id]=[],j=this.proxyCoords;for(let W=0;W<j.length;W++){const Z=j[W],Y=this._findTileCoveringTileID(Z,l);if(Y){const re=this._createProxiedId(Z,Y,y[Z.key]&&y[Z.key][l.id]);N.push(re),this.proxyToSource[Z.key][l.id]=[re]}}let C=!1;const F=new Set;for(let W=0;W<d.length;W++){const Z=l.getTile(d[W]);if(!Z||!Z.hasData())continue;const Y=this._findTileCoveringTileID(Z.tileID,this.proxySourceCache);if(Y&&Y.tileID.canonical.z!==Z.tileID.canonical.z){const re=this.proxyToSource[Y.tileID.key][l.id],ne=this._createProxiedId(Y.tileID,Z,y[Y.tileID.key]&&y[Y.tileID.key][l.id]);re?re.splice(re.length-1,0,ne):this.proxyToSource[Y.tileID.key][l.id]=[ne];const oe=this.proxyToSource[Y.tileID.key][l.id];F.has(oe)||F.add(oe),N.push(ne),C=!0}}if(this._sourceTilesOverlap[l.id]=C,C&&this._debugParams.sortTilesHiZFirst)for(const W of F)W.sort((Z,Y)=>Y.overscaledZ-Z.overscaledZ)}_setupProxiedCoordsForImageSource(l,d,y){if(!l.getSource().loaded())return;const N=this.proxiedCoords[l.id]=[],j=this.proxyCoords,C=l.getSource(),F=C.tileID;if(!F)return;const W=new i.P(F.x,F.y)._div(1<<F.z),Z=C.coordinates.map(i.aa.fromLngLat).reduce((re,ne)=>(re.min.x=Math.min(re.min.x,ne.x-W.x),re.min.y=Math.min(re.min.y,ne.y-W.y),re.max.x=Math.max(re.max.x,ne.x-W.x),re.max.y=Math.max(re.max.y,ne.y-W.y),re),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Y=(re,ne)=>{const oe=re.wrap+re.canonical.x/(1<<re.canonical.z),_e=re.canonical.y/(1<<re.canonical.z),ge=i.ag/(1<<re.canonical.z),Te=ne.wrap+ne.canonical.x/(1<<ne.canonical.z),Ae=ne.canonical.y/(1<<ne.canonical.z);return oe+ge<Te+Z.min.x||oe>Te+Z.max.x||_e+ge<Ae+Z.min.y||_e>Ae+Z.max.y};for(let re=0;re<j.length;re++){const ne=j[re];for(let oe=0;oe<d.length;oe++){const _e=l.getTile(d[oe]);if(!_e||!_e.hasData()||Y(ne,_e.tileID))continue;const ge=this._createProxiedId(ne,_e,y[ne.key]&&y[ne.key][l.id]),Te=this.proxyToSource[ne.key][l.id];Te?Te.push(ge):this.proxyToSource[ne.key][l.id]=[ge],N.push(ge)}}}_createProxiedId(l,d,y){let N=this.orthoMatrix;if(y){const j=y.find(C=>C.key===d.tileID.key);if(j)return j}if(d.tileID.key!==l.key){const j=l.canonical.z-d.tileID.canonical.z;let C,F,W;N=i.ab.mat4.create();const Z=d.tileID.wrap-l.wrap<<l.overscaledZ;j>0?(C=i.ag>>j,F=C*((d.tileID.canonical.x<<j)-l.canonical.x+Z),W=C*((d.tileID.canonical.y<<j)-l.canonical.y)):(C=i.ag<<-j,F=i.ag*(d.tileID.canonical.x-(l.canonical.x+Z<<-j)),W=i.ag*(d.tileID.canonical.y-(l.canonical.y<<-j))),i.ab.mat4.ortho(N,0,C,0,C,0,1),i.ab.mat4.translate(N,N,[F,W,0])}return new gu(d.tileID,l.key,N)}_findTileCoveringTileID(l,d){let y=d.getTile(l);if(y&&y.hasData())return y;const N=this._findCoveringTileCache[d.id],j=N[l.key];if(y=j?d.getTileByID(j):null,y&&y.hasData()||j===null)return y;let C=y?y.tileID:l,F=C.overscaledZ;const W=d.getSource().minzoom,Z=[];if(!j){const re=d.getSource().maxzoom;if(l.canonical.z>=re){const ne=l.canonical.z-re;d.getSource().reparseOverscaled?(F=Math.max(l.canonical.z+2,d.transform.tileZoom),C=new i.aG(F,l.wrap,re,l.canonical.x>>ne,l.canonical.y>>ne)):ne!==0&&(F=re,C=new i.aG(F,l.wrap,re,l.canonical.x>>ne,l.canonical.y>>ne))}C.key!==l.key&&(Z.push(C.key),y=d.getTile(C))}const Y=re=>{Z.forEach(ne=>{N[ne]=re}),Z.length=0};for(F-=1;F>=W&&(!y||!y.hasData());F--){y&&Y(y.tileID.key);const re=C.calculateScaledKey(F);if(y=d.getTileByID(re),y&&y.hasData())break;const ne=N[re];if(ne===null)break;ne===void 0?Z.push(re):y=d.getTileByID(ne)}return Y(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(l){return this.enabled?this._findTileCoveringTileID(l,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(l,d){let y=this._tilesDirty[l];y||(y=this._tilesDirty[l]={}),y[d.key]=!0}}function Qo(g,l,d){const y=function(F,W,Z){const Y=i.ab.vec3.dot(W,F),re=i.ab.vec3.dot(Z,[.2126,.7152,.0722]),ne=(_e,ge,Te)=>(1-Te)*_e+Te*ge,oe=ne(1-.3*Math.min(re,1),1,Math.min(Y+1,1));return ne(.92,1,Math.asin(i.aw(W[2],-1,1))/Math.PI+.5)*oe}(g,[0,0,1],l),N=[0,0,0];i.ab.vec3.scale(N,d.slice(0,3),y);const j=[0,0,0];i.ab.vec3.scale(j,l.slice(0,3),g[2]);const C=[0,0,0];return i.ab.vec3.add(C,N,j),i.cf(C)}const ng=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Oy=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class Ry{static cacheKey(l,d,y,N){let j=`${d}${N?N.cacheKey:""}`;for(const C of y)l.usedDefines.includes(C)&&(j+=`/${C}`);return j}constructor(l,d,y,N,j,C){const F=l.gl;this.program=F.createProgram(),this.configuration=N,this.name=d,this.fixedDefines=[...C];const W=N?N.getBinderAttributes():[],Z=(y.staticAttributes||[]).concat(W);let Y=N?N.defines():[];Y=Y.concat(C.map(Te=>`#define ${Te}`));const re=`#version 300 es
`;let ne=re+Y.concat("precision mediump float;",mf,Op.fragmentSource).join(`
`);for(const Te of y.fragmentIncludes)ne+=`
${Qd[Te]}`;ne+=`
${y.fragmentSource}`;let oe=re+Y.concat("precision highp float;",mf,Op.vertexSource).join(`
`);for(const Te of y.vertexIncludes)oe+=`
${Qd[Te]}`;this.forceManualRenderingForInstanceIDShaders=l.forceManualRenderingForInstanceIDShaders&&y.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(oe+=`
uniform int u_instanceID;
`),oe+=`
${y.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(oe=oe.replaceAll("gl_InstanceID","u_instanceID"));const _e=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);F.shaderSource(_e,ne),F.compileShader(_e),F.attachShader(this.program,_e);const ge=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())this.failedToCreate=!0;else{F.shaderSource(ge,oe),F.compileShader(ge),F.attachShader(this.program,ge),this.attributes={},this.numAttributes=Z.length;for(let Te=0;Te<this.numAttributes;Te++)if(Z[Te]){const Ae=Z[Te].startsWith("a_")?Z[Te]:`a_${Z[Te]}`;F.bindAttribLocation(this.program,Te,Ae),this.attributes[Ae]=Te}F.linkProgram(this.program),F.deleteShader(ge),F.deleteShader(_e),this.fixedUniforms=j(l),this.binderUniforms=N?N.getUniforms(l):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(Te=>({u_instanceID:new i.bN(Te)}))(l)),(C.includes("TERRAIN")||d.indexOf("symbol")!==-1||d.indexOf("circle")!==-1)&&(this.terrainUniforms=(Te=>({u_dem:new i.bN(Te),u_dem_prev:new i.bN(Te),u_dem_tl:new i.bK(Te),u_dem_scale:new i.bM(Te),u_dem_tl_prev:new i.bK(Te),u_dem_scale_prev:new i.bM(Te),u_dem_size:new i.bM(Te),u_dem_lerp:new i.bM(Te),u_exaggeration:new i.bM(Te),u_depth:new i.bN(Te),u_depth_size_inv:new i.bK(Te),u_depth_range_unpack:new i.bK(Te),u_occluder_half_size:new i.bM(Te),u_occlusion_depth_offset:new i.bM(Te),u_meter_to_dem:new i.bM(Te),u_label_plane_matrix_inv:new i.bJ(Te)}))(l)),C.includes("GLOBE")&&(this.globeUniforms=(Te=>({u_tile_tl_up:new i.bL(Te),u_tile_tr_up:new i.bL(Te),u_tile_br_up:new i.bL(Te),u_tile_bl_up:new i.bL(Te),u_tile_up_scale:new i.bM(Te)}))(l)),C.includes("FOG")&&(this.fogUniforms=(Te=>({u_fog_matrix:new i.bJ(Te),u_fog_range:new i.bK(Te),u_fog_color:new i.ca(Te),u_fog_horizon_blend:new i.bM(Te),u_fog_vertical_limit:new i.bK(Te),u_fog_temporal_offset:new i.bM(Te),u_frustum_tl:new i.bL(Te),u_frustum_tr:new i.bL(Te),u_frustum_br:new i.bL(Te),u_frustum_bl:new i.bL(Te),u_globe_pos:new i.bL(Te),u_globe_radius:new i.bM(Te),u_globe_transition:new i.bM(Te),u_is_globe:new i.bN(Te),u_viewport:new i.bK(Te)}))(l)),C.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Te=>({u_cutoff_params:new i.ca(Te)}))(l)),C.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Te=>({u_lighting_ambient_color:new i.bL(Te),u_lighting_directional_dir:new i.bL(Te),u_lighting_directional_color:new i.bL(Te),u_ground_radiance:new i.bL(Te)}))(l)),C.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Te=>({u_light_matrix_0:new i.bJ(Te),u_light_matrix_1:new i.bJ(Te),u_fade_range:new i.bK(Te),u_shadow_normal_offset:new i.bL(Te),u_shadow_intensity:new i.bM(Te),u_shadow_texel_size:new i.bM(Te),u_shadow_map_resolution:new i.bM(Te),u_shadow_direction:new i.bL(Te),u_shadow_bias:new i.bL(Te),u_shadowmap_0:new i.bN(Te),u_shadowmap_1:new i.bN(Te)}))(l))}}setTerrainUniformValues(l,d){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const N in d)y[N]&&y[N].set(this.program,N,d[N])}}setGlobeUniformValues(l,d){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const N in d)y[N]&&y[N].set(this.program,N,d[N])}}setFogUniformValues(l,d){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const N in d)y[N].set(this.program,N,d[N])}}setCutoffUniformValues(l,d){if(!this.cutoffUniforms)return;const y=this.cutoffUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const N in d)y[N].set(this.program,N,d[N])}}setLightsUniformValues(l,d){if(!this.lightsUniforms)return;const y=this.lightsUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const N in d)y[N].set(this.program,N,d[N])}}setShadowUniformValues(l,d){if(this.failedToCreate||!this.shadowUniforms)return;const y=this.shadowUniforms;l.program.set(this.program);for(const N in d)y[N].set(this.program,N,d[N])}_drawDebugWireframe(l,d,y,N,j,C,F,W,Z,Y){const re=l.options.wireframe;if(re.terrain===!1&&re.layers2D===!1&&re.layers3D===!1)return;const ne=l.context;if(!(!(!re.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!re.layers2D||l._terrain&&l._terrain.renderingToTexture||!ng.includes(this.name))||!(!re.layers3D||!Oy.includes(this.name))))return;const oe=ne.gl,_e=l.wireframeDebugCache.getLinesFromTrianglesBuffer(l.frameCounter,j,ne);if(!_e)return;const ge=[...this.fixedDefines];ge.push("DEBUG_WIREFRAME");const Te=l.getOrCreateProgram(this.name,{config:this.configuration,defines:ge});ne.program.set(Te.program);const Ae=(Ue,Qe,Ke)=>{if(Qe[Ue]&&Ke[Ue])for(const Ze in Qe[Ue])Ke[Ue][Ze]&&Ke[Ue][Ze].set(Ke.program,Ze,Qe[Ue][Ze].current)};Z&&Z.setUniforms(Te.program,ne,Te.binderUniforms,F,{zoom:W}),Ae("fixedUniforms",this,Te),Ae("terrainUniforms",this,Te),Ae("globeUniforms",this,Te),Ae("fogUniforms",this,Te),Ae("lightsUniforms",this,Te),Ae("shadowUniforms",this,Te),_e.bind(),ne.setColorMode(new kn([oe.ONE,oe.ONE_MINUS_SRC_ALPHA,oe.ZERO,oe.ONE],i.aj.transparent,[!0,!0,!0,!1])),ne.setDepthMode(new zr(d.func===oe.LESS?oe.LEQUAL:d.func,zr.ReadOnly,d.range)),ne.setStencilMode(Wr.disabled);const Re=3*C.primitiveLength*2,qe=3*C.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Ue=Y||1;for(let Qe=0;Qe<Ue;++Qe)Te.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Qe),oe.drawElements(oe.LINES,Re,oe.UNSIGNED_SHORT,qe)}else Y&&Y>1?oe.drawElementsInstanced(oe.LINES,Re,oe.UNSIGNED_SHORT,qe,Y):oe.drawElements(oe.LINES,Re,oe.UNSIGNED_SHORT,qe);j.bind(),ne.program.set(this.program),ne.setDepthMode(d),ne.setStencilMode(y),ne.setColorMode(N)}checkUniforms(l,d,y){if(this.fixedDefines.includes(d)){for(const N of Object.keys(y))if(!y[N].initialized)throw new Error(`Program '${this.name}', from draw '${l}': uniform ${N} not set but required by ${d} being defined`)}}draw(l,d,y,N,j,C,F,W,Z,Y,re,ne,oe,_e,ge,Te){const Ae=l.context,Re=Ae.gl;if(this.failedToCreate)return;Ae.program.set(this.program),Ae.setDepthMode(y),Ae.setStencilMode(N),Ae.setColorMode(j),Ae.setCullFace(C);for(const Qe of Object.keys(this.fixedUniforms))this.fixedUniforms[Qe].set(this.program,Qe,F[Qe]);_e&&_e.setUniforms(this.program,Ae,this.binderUniforms,ne,{zoom:oe});const qe={[Re.POINTS]:1,[Re.LINES]:2,[Re.TRIANGLES]:3,[Re.LINE_STRIP]:1}[d];this.checkUniforms(W,"RENDER_SHADOWS",this.shadowUniforms);const Ue=Te&&Te>0?1:void 0;for(const Qe of re.get()){const Ke=Qe.vaos||(Qe.vaos={});if((Ke[W]||(Ke[W]=new Zm)).bind(Ae,this,Z,_e?_e.getPaintVertexBuffers():[],Y,Qe.vertexOffset,ge||[],Ue),this.forceManualRenderingForInstanceIDShaders){const Ze=Te||1;for(let He=0;He<Ze;++He)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",He),Y?Re.drawElements(d,Qe.primitiveLength*qe,Re.UNSIGNED_SHORT,Qe.primitiveOffset*qe*2):Re.drawArrays(d,Qe.vertexOffset,Qe.vertexLength)}else Te&&Te>1?Re.drawElementsInstanced(d,Qe.primitiveLength*qe,Re.UNSIGNED_SHORT,Qe.primitiveOffset*qe*2,Te):Y?Re.drawElements(d,Qe.primitiveLength*qe,Re.UNSIGNED_SHORT,Qe.primitiveOffset*qe*2):Re.drawArrays(d,Qe.vertexOffset,Qe.vertexLength);d===Re.TRIANGLES&&Y&&this._drawDebugWireframe(l,y,N,j,Y,Qe,ne,oe,_e,Te)}}}function sh(g,l){const d=Math.pow(2,l.tileID.overscaledZ),y=l.tileSize*Math.pow(2,g.transform.tileZoom)/d,N=y*(l.tileID.canonical.x+l.tileID.wrap*d),j=y*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture?l.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ar(l,1,g.transform.tileZoom),u_pixel_coord_upper:[N>>16,j>>16],u_pixel_coord_lower:[65535&N,65535&j]}}const oh={terrain:0,flat:1},el=i.ab.mat4.create(),lh=(g,l,d,y,N,j,C,F,W,Z,Y,re,ne,oe,_e,ge,Te,Ae)=>{const Re=l.style.light,qe=Re.properties.get("position"),Ue=[qe.x,qe.y,qe.z],Qe=i.ab.mat3.create();Re.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Qe,-l.transform.angle),i.ab.vec3.transformMat3(Ue,Ue,Qe));const Ke=Re.properties.get("color"),Ze=l.transform,He={u_matrix:g,u_lightpos:Ue,u_lightintensity:Re.properties.get("intensity"),u_lightcolor:[Ke.r,Ke.g,Ke.b],u_vertical_gradient:+d,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:el,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:oh[Z],u_base_type:oh[Y],u_ao:N,u_edge_radius:j,u_width_scale:C,u_flood_light_color:_e,u_vertical_scale:ge,u_flood_light_intensity:Te,u_ground_shadow_factor:Ae};return Ze.projection.name==="globe"&&(He.u_tile_id=[F.canonical.x,F.canonical.y,1<<F.canonical.z],He.u_zoom_transition=re,He.u_inv_rot_matrix=oe,He.u_merc_center=ne,He.u_up_dir=Ze.projection.upVector(new i.bT(0,0,0),ne[0]*i.ag,ne[1]*i.ag),He.u_height_lift=W),He},ch=(g,l,d,y,N,j)=>({u_matrix:g,u_edge_radius:l,u_width_scale:d,u_vertical_scale:y,u_height_type:oh[N],u_base_type:oh[j]}),Iy=(g,l,d,y,N,j,C,F,W,Z,Y,re,ne,oe,_e,ge,Te)=>{const Ae=lh(g,l,d,y,N,j,C,F,Z,Y,re,ne,oe,_e,ge,Te,1,[0,0,0]),Re={u_height_factor:-Math.pow(2,F.overscaledZ)/W.tileSize/8};return i.l(Ae,sh(l,W),Re)},Bp=(g,l)=>({u_matrix:g,u_emissive_strength:l}),Gl=(g,l,d,y)=>i.l(Bp(g,l),sh(d,y)),od=(g,l,d)=>({u_matrix:g,u_world:d,u_emissive_strength:l}),uh=(g,l,d,y,N)=>i.l(Gl(g,l,d,y),{u_world:N}),ig=(g,l,d,y)=>{const N=i.ag/d.tileSize;return{u_matrix:g,u_camera_to_center_distance:l.getCameraToCenterDistance(y),u_extrude_scale:[l.pixelsToGLUnits[0]/N,l.pixelsToGLUnits[1]/N]}},Fc=(g,l,d=1)=>({u_matrix:g,u_color:l.toRenderColor(null),u_overlay:0,u_overlay_scale:d}),Io=i.ab.mat4.create(),mr=(g,l,d,y,N,j,C)=>{const F=g.transform,W=F.projection.name==="globe",Z=W?i.cN(F.zoom,l.canonical)*F._pixelsPerMercatorPixel:i.ar(d,1,j),Y={u_matrix:l.projMatrix,u_extrude_scale:Z,u_intensity:C,u_inv_rot_matrix:Io,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(W){Y.u_inv_rot_matrix=y,Y.u_merc_center=N,Y.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],Y.u_zoom_transition=i.ae(F.zoom);const re=N[0]*i.ag,ne=N[1]*i.ag;Y.u_up_dir=F.projection.upVector(new i.bT(0,0,0),re,ne)}return Y};function yu(g,[l,d,y,N],[j,C]){if(j===C)return[0,0,0,0];const F=255*(g-1)/(g*(C-j));return[l*F,d*F,y*F,N*F]}function uc(g,l,[d,y]){return d===y?0:.5/g+(l-d)*(g-1)/(g*(y-d))}const _o=(g,l,d,y,N,j,C,F,W,Z,Y,re,ne,oe,_e,ge,Te,Ae,Re,qe,Ue)=>({u_matrix:g,u_normalize_matrix:l,u_globe_matrix:d,u_merc_matrix:y,u_grid_matrix:N,u_tl_parent:j,u_scale_parent:Z,u_fade_t:Y.mix,u_opacity:Y.opacity*re.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:re.paint.get("raster-brightness-min"),u_brightness_high:re.paint.get("raster-brightness-max"),u_saturation_factor:i.cO(re.paint.get("raster-saturation")),u_contrast_factor:i.cP(re.paint.get("raster-contrast")),u_spin_weights:wl(re.paint.get("raster-hue-rotate")),u_perspective_transform:ne,u_raster_elevation:oe,u_zoom_transition:C,u_merc_center:F,u_cutoff_params:W,u_colorization_mix:yu(i.cQ,ge,Ae),u_colorization_offset:uc(i.cQ,Te,Ae),u_color_ramp:_e,u_texture_offset:[qe/(Re+2*qe),Re/(Re+2*qe)],u_texture_res:[Re+2*qe,Re+2*qe],u_emissive_strength:Ue});function wl(g){g*=Math.PI/180;const l=Math.sin(g),d=Math.cos(g);return[(2*d+1)/3,(-Math.sqrt(3)*l-d+1)/3,(Math.sqrt(3)*l-d+1)/3]}const Er=.05,Vp=(g,l,d,y,N,j,C,F,W,Z,Y,re)=>({u_matrix:g,u_normalize_matrix:l,u_globe_matrix:d,u_merc_matrix:y,u_grid_matrix:N,u_tl_parent:j,u_scale_parent:Z,u_fade_t:Y.mix,u_opacity:Y.opacity,u_image0:0,u_image1:1,u_raster_elevation:re,u_zoom_transition:C,u_merc_center:F,u_cutoff_params:W}),Ly=(g,l,d,y,N,j,C,F,W,Z)=>({u_particle_texture:g,u_particle_texture_side_len:l,u_tile_offset:d,u_velocity:y,u_color_ramp:j,u_velocity_res:N,u_max_speed:C,u_uv_offset:F,u_data_scale:[255*W[0],255*W[1]],u_data_offset:Z,u_particle_pos_scale:1.1,u_particle_pos_offset:[Er,Er]}),Sl=(g,l,d,y,N,j,C,F,W,Z)=>({u_particle_texture:g,u_particle_texture_side_len:l,u_velocity:d,u_velocity_res:y,u_max_speed:N,u_speed_factor:j,u_reset_rate:C,u_rand_seed:Math.random(),u_uv_offset:F,u_data_scale:[255*W[0],255*W[1]],u_data_offset:Z,u_particle_pos_scale:1.1,u_particle_pos_offset:[Er,Er]}),bo=i.ab.mat4.create(),Sa=(g,l,d,y,N,j,C,F,W,Z,Y,re,ne,oe,_e,ge,Te,Ae,Re,qe,Ue,Qe)=>{const Ke=N.transform,Ze={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:Ke.getCameraToCenterDistance(Re),u_rotate_symbol:+d,u_aspect_ratio:Ke.width/Ke.height,u_fade_change:N.options.fadeDuration?N.symbolFadeChange:1,u_matrix:j,u_label_plane_matrix:C,u_coord_matrix:F,u_is_text:+Z,u_elevation_from_sea:W?1:0,u_pitch_with_map:+y,u_texsize:Y,u_texsize_icon:re,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:bo,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:bo,u_up_vector:[0,-1,0],u_color_adj_mat:qe,u_icon_transition:Ue||0,u_gamma_scale:y?N.transform.getCameraToCenterDistance(Re)*Math.cos(N.terrain?0:N.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:1,u_scale_factor:Qe||1};return Re.name==="globe"&&(Ze.u_tile_id=[oe.canonical.x,oe.canonical.y,1<<oe.canonical.z],Ze.u_zoom_transition=_e,Ze.u_inv_rot_matrix=Te,Ze.u_merc_center=ge,Ze.u_camera_forward=Ke._camera.forward(),Ze.u_ecef_origin=i.cR(Ke.globeMatrix,oe.toUnwrapped()),Ze.u_tile_matrix=Float32Array.from(Ke.globeMatrix),Ze.u_up_vector=Ae),Ze},Nl=(g,l,d,y)=>({u_matrix:g,u_emissive_strength:l,u_opacity:d,u_color:y}),Dy=(g,l,d,y,N,j,C,F,W)=>i.l(function(Z,Y,re,ne,oe,_e){const{width:ge,height:Te}=ne.imageManager.getPixelSize(Y),Ae=Math.pow(2,_e.tileID.overscaledZ),Re=_e.tileSize*Math.pow(2,ne.transform.tileZoom)/Ae,qe=Re*(_e.tileID.canonical.x+_e.tileID.wrap*Ae),Ue=Re*_e.tileID.canonical.y;return{u_image:0,u_pattern_tl:re.tl,u_pattern_br:re.br,u_texsize:[ge,Te],u_pattern_size:re.displaySize,u_pattern_units_to_pixels:oe?[ne.transform.width,-1*ne.transform.height]:[1/i.ar(_e,1,ne.transform.tileZoom),1/i.ar(_e,1,ne.transform.tileZoom)],u_pixel_coord_upper:[qe>>16,Ue>>16],u_pixel_coord_lower:[65535&qe,65535&Ue]}}(0,j,C,y,F,W),{u_matrix:g,u_emissive_strength:l,u_opacity:d}),ag=new Float32Array(i.ab.mat4.identity([])),dh=(g,l,d,y,N,j,C,F,W,Z,Y,re,ne,oe=[0,0,0],_e)=>{const ge=N.style.light,Te=ge.properties.get("position"),Ae=[-Te.x,-Te.y,Te.z],Re=i.ab.mat3.create();ge.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Re,-N.transform.angle),i.ab.vec3.transformMat3(Ae,Ae,Re));const qe=Y.alphaMode==="MASK",Ue=ge.properties.get("color").toRenderColor(null),Qe=ne.paint.get("model-ambient-occlusion-intensity"),Ke=ne.paint.get("model-color").constantOr(i.aj.white).toRenderColor(null),Ze=ne.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:g,u_lighting_matrix:l,u_normal_matrix:d,u_node_matrix:y||ag,u_lightpos:Ae,u_lightintensity:ge.properties.get("intensity"),u_lightcolor:[Ue.r,Ue.g,Ue.b],u_camera_pos:oe,u_opacity:j,u_baseTextureIsAlpha:0,u_alphaMask:+qe,u_alphaCutoff:Y.alphaCutoff,u_baseColorFactor:[C.r,C.g,C.b,C.a],u_emissiveFactor:[F[0],F[1],F[2],1],u_metallicFactor:W,u_roughnessFactor:Z,u_baseColorTexture:Gs.BaseColor,u_metallicRoughnessTexture:Gs.MetallicRoughness,u_normalTexture:Gs.Normal,u_occlusionTexture:Gs.Occlusion,u_emissionTexture:Gs.Emission,u_lutTexture:Gs.LUT,u_color_mix:[Ke.r,Ke.g,Ke.b,Ze],u_aoIntensity:Qe,u_emissive_strength:re,u_occlusionTextureTransform:_e||[0,0,0,0]}},bf=(g,l=ag,d=ag)=>({u_matrix:g,u_instance:l,u_node_matrix:d}),sg={fillExtrusion:g=>({u_matrix:new i.bJ(g),u_lightpos:new i.bL(g),u_lightintensity:new i.bM(g),u_lightcolor:new i.bL(g),u_vertical_gradient:new i.bM(g),u_opacity:new i.bM(g),u_edge_radius:new i.bM(g),u_width_scale:new i.bM(g),u_ao:new i.bK(g),u_height_type:new i.bN(g),u_base_type:new i.bN(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_up_dir:new i.bL(g),u_height_lift:new i.bM(g),u_flood_light_color:new i.bL(g),u_vertical_scale:new i.bM(g),u_flood_light_intensity:new i.bM(g),u_ground_shadow_factor:new i.bL(g)}),fillExtrusionDepth:g=>({u_matrix:new i.bJ(g),u_edge_radius:new i.bM(g),u_width_scale:new i.bM(g),u_vertical_scale:new i.bM(g),u_height_type:new i.bN(g),u_base_type:new i.bN(g)}),fillExtrusionPattern:g=>({u_matrix:new i.bJ(g),u_lightpos:new i.bL(g),u_lightintensity:new i.bM(g),u_lightcolor:new i.bL(g),u_vertical_gradient:new i.bM(g),u_height_factor:new i.bM(g),u_edge_radius:new i.bM(g),u_width_scale:new i.bM(g),u_ao:new i.bK(g),u_height_type:new i.bN(g),u_base_type:new i.bN(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_up_dir:new i.bL(g),u_height_lift:new i.bM(g),u_image:new i.bN(g),u_texsize:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_tile_units_to_pixels:new i.bM(g),u_opacity:new i.bM(g)}),fillExtrusionGroundEffect:g=>({u_matrix:new i.bJ(g),u_opacity:new i.bM(g),u_ao_pass:new i.bM(g),u_meter_to_tile:new i.bM(g),u_ao:new i.bK(g),u_flood_light_intensity:new i.bM(g),u_flood_light_color:new i.bL(g),u_attenuation:new i.bM(g),u_edge_radius:new i.bM(g),u_fb:new i.bN(g),u_fb_size:new i.bM(g),u_dynamic_offset:new i.bM(g)}),fill:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g)}),fillPattern:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_image:new i.bN(g),u_texsize:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_tile_units_to_pixels:new i.bM(g)}),fillOutline:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_world:new i.bK(g)}),fillOutlinePattern:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_world:new i.bK(g),u_image:new i.bN(g),u_texsize:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_tile_units_to_pixels:new i.bM(g)}),circle:i.cS,collisionBox:g=>({u_matrix:new i.bJ(g),u_camera_to_center_distance:new i.bM(g),u_extrude_scale:new i.bK(g)}),collisionCircle:g=>({u_matrix:new i.bJ(g),u_inv_matrix:new i.bJ(g),u_camera_to_center_distance:new i.bM(g),u_viewport_size:new i.bK(g)}),debug:g=>({u_color:new i.cz(g),u_matrix:new i.bJ(g),u_overlay:new i.bN(g),u_overlay_scale:new i.bM(g)}),clippingMask:g=>({u_matrix:new i.bJ(g)}),heatmap:g=>({u_extrude_scale:new i.bM(g),u_intensity:new i.bM(g),u_matrix:new i.bJ(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_up_dir:new i.bL(g)}),heatmapTexture:g=>({u_image:new i.bN(g),u_color_ramp:new i.bN(g),u_opacity:new i.bM(g)}),hillshade:g=>({u_matrix:new i.bJ(g),u_image:new i.bN(g),u_latrange:new i.bK(g),u_light:new i.bK(g),u_shadow:new i.cz(g),u_highlight:new i.cz(g),u_emissive_strength:new i.bM(g),u_accent:new i.cz(g)}),hillshadePrepare:g=>({u_matrix:new i.bJ(g),u_image:new i.bN(g),u_dimension:new i.bK(g),u_zoom:new i.bM(g)}),line:i.cT,linePattern:i.cU,raster:g=>({u_matrix:new i.bJ(g),u_normalize_matrix:new i.bJ(g),u_globe_matrix:new i.bJ(g),u_merc_matrix:new i.bJ(g),u_grid_matrix:new i.cA(g),u_tl_parent:new i.bK(g),u_scale_parent:new i.bM(g),u_fade_t:new i.bM(g),u_opacity:new i.bM(g),u_image0:new i.bN(g),u_image1:new i.bN(g),u_brightness_low:new i.bM(g),u_brightness_high:new i.bM(g),u_saturation_factor:new i.bM(g),u_contrast_factor:new i.bM(g),u_spin_weights:new i.bL(g),u_perspective_transform:new i.bK(g),u_raster_elevation:new i.bM(g),u_zoom_transition:new i.bM(g),u_merc_center:new i.bK(g),u_cutoff_params:new i.ca(g),u_colorization_mix:new i.ca(g),u_colorization_offset:new i.bM(g),u_color_ramp:new i.bN(g),u_texture_offset:new i.bK(g),u_texture_res:new i.bK(g),u_emissive_strength:new i.bM(g)}),rasterParticle:g=>({u_matrix:new i.bJ(g),u_normalize_matrix:new i.bJ(g),u_globe_matrix:new i.bJ(g),u_merc_matrix:new i.bJ(g),u_grid_matrix:new i.cA(g),u_tl_parent:new i.bK(g),u_scale_parent:new i.bM(g),u_fade_t:new i.bM(g),u_opacity:new i.bM(g),u_image0:new i.bN(g),u_image1:new i.bN(g),u_raster_elevation:new i.bM(g),u_zoom_transition:new i.bM(g),u_merc_center:new i.bK(g),u_cutoff_params:new i.ca(g)}),rasterParticleTexture:g=>({u_texture:new i.bN(g),u_opacity:new i.bM(g)}),rasterParticleDraw:g=>({u_particle_texture:new i.bN(g),u_particle_texture_side_len:new i.bM(g),u_tile_offset:new i.bK(g),u_velocity:new i.bN(g),u_color_ramp:new i.bN(g),u_velocity_res:new i.bK(g),u_max_speed:new i.bM(g),u_uv_offset:new i.bK(g),u_data_scale:new i.bK(g),u_data_offset:new i.bM(g),u_particle_pos_scale:new i.bM(g),u_particle_pos_offset:new i.bK(g)}),rasterParticleUpdate:g=>({u_particle_texture:new i.bN(g),u_particle_texture_side_len:new i.bM(g),u_velocity:new i.bN(g),u_velocity_res:new i.bK(g),u_max_speed:new i.bM(g),u_speed_factor:new i.bM(g),u_reset_rate:new i.bM(g),u_rand_seed:new i.bM(g),u_uv_offset:new i.bK(g),u_data_scale:new i.bK(g),u_data_offset:new i.bM(g),u_particle_pos_scale:new i.bM(g),u_particle_pos_offset:new i.bK(g)}),symbol:g=>({u_is_size_zoom_constant:new i.bN(g),u_is_size_feature_constant:new i.bN(g),u_size_t:new i.bM(g),u_size:new i.bM(g),u_camera_to_center_distance:new i.bM(g),u_rotate_symbol:new i.bN(g),u_aspect_ratio:new i.bM(g),u_fade_change:new i.bM(g),u_matrix:new i.bJ(g),u_label_plane_matrix:new i.bJ(g),u_coord_matrix:new i.bJ(g),u_is_text:new i.bN(g),u_elevation_from_sea:new i.bN(g),u_pitch_with_map:new i.bN(g),u_texsize:new i.bK(g),u_texsize_icon:new i.bK(g),u_texture:new i.bN(g),u_texture_icon:new i.bN(g),u_gamma_scale:new i.bM(g),u_device_pixel_ratio:new i.bM(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_camera_forward:new i.bL(g),u_tile_matrix:new i.bJ(g),u_up_vector:new i.bL(g),u_ecef_origin:new i.bL(g),u_is_halo:new i.bN(g),u_icon_transition:new i.bM(g),u_color_adj_mat:new i.bJ(g),u_scale_factor:new i.bM(g)}),background:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_opacity:new i.bM(g),u_color:new i.cz(g)}),backgroundPattern:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_opacity:new i.bM(g),u_image:new i.bN(g),u_pattern_tl:new i.bK(g),u_pattern_br:new i.bK(g),u_texsize:new i.bK(g),u_pattern_size:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_pattern_units_to_pixels:new i.bK(g)}),terrainRaster:g=>({u_matrix:new i.bJ(g),u_image0:new i.bN(g),u_skirt_height:new i.bM(g),u_ground_shadow_factor:new i.bL(g)}),skybox:g=>({u_matrix:new i.bJ(g),u_sun_direction:new i.bL(g),u_cubemap:new i.bN(g),u_opacity:new i.bM(g),u_temporal_offset:new i.bM(g)}),skyboxGradient:g=>({u_matrix:new i.bJ(g),u_color_ramp:new i.bN(g),u_center_direction:new i.bL(g),u_radius:new i.bM(g),u_opacity:new i.bM(g),u_temporal_offset:new i.bM(g)}),skyboxCapture:g=>({u_matrix_3f:new i.cA(g),u_sun_direction:new i.bL(g),u_sun_intensity:new i.bM(g),u_color_tint_r:new i.ca(g),u_color_tint_m:new i.ca(g),u_luminance:new i.bM(g)}),globeRaster:g=>({u_proj_matrix:new i.bJ(g),u_globe_matrix:new i.bJ(g),u_normalize_matrix:new i.bJ(g),u_merc_matrix:new i.bJ(g),u_zoom_transition:new i.bM(g),u_merc_center:new i.bK(g),u_image0:new i.bN(g),u_grid_matrix:new i.cA(g),u_skirt_height:new i.bM(g),u_far_z_cutoff:new i.bM(g),u_frustum_tl:new i.bL(g),u_frustum_tr:new i.bL(g),u_frustum_br:new i.bL(g),u_frustum_bl:new i.bL(g),u_globe_pos:new i.bL(g),u_globe_radius:new i.bM(g),u_viewport:new i.bK(g)}),globeAtmosphere:g=>({u_frustum_tl:new i.bL(g),u_frustum_tr:new i.bL(g),u_frustum_br:new i.bL(g),u_frustum_bl:new i.bL(g),u_horizon:new i.bM(g),u_transition:new i.bM(g),u_fadeout_range:new i.bM(g),u_color:new i.ca(g),u_high_color:new i.ca(g),u_space_color:new i.ca(g),u_temporal_offset:new i.bM(g),u_horizon_angle:new i.bM(g)}),model:g=>({u_matrix:new i.bJ(g),u_lighting_matrix:new i.bJ(g),u_normal_matrix:new i.bJ(g),u_node_matrix:new i.bJ(g),u_lightpos:new i.bL(g),u_lightintensity:new i.bM(g),u_lightcolor:new i.bL(g),u_camera_pos:new i.bL(g),u_opacity:new i.bM(g),u_baseColorFactor:new i.ca(g),u_emissiveFactor:new i.ca(g),u_metallicFactor:new i.bM(g),u_roughnessFactor:new i.bM(g),u_baseTextureIsAlpha:new i.bN(g),u_alphaMask:new i.bN(g),u_alphaCutoff:new i.bM(g),u_baseColorTexture:new i.bN(g),u_metallicRoughnessTexture:new i.bN(g),u_normalTexture:new i.bN(g),u_occlusionTexture:new i.bN(g),u_emissionTexture:new i.bN(g),u_lutTexture:new i.bN(g),u_color_mix:new i.ca(g),u_aoIntensity:new i.bM(g),u_emissive_strength:new i.bM(g),u_occlusionTextureTransform:new i.ca(g)}),modelDepth:g=>({u_matrix:new i.bJ(g),u_instance:new i.bJ(g),u_node_matrix:new i.bJ(g)}),groundShadow:g=>({u_matrix:new i.bJ(g),u_ground_shadow_factor:new i.bL(g)}),stars:g=>({u_matrix:new i.bJ(g),u_up:new i.bL(g),u_right:new i.bL(g),u_intensity_multiplier:new i.bM(g)}),snowParticle:g=>({u_modelview:new i.bJ(g),u_projection:new i.bJ(g),u_time:new i.bM(g),u_cam_pos:new i.bL(g),u_velocityConeAperture:new i.bM(g),u_velocity:new i.bM(g),u_horizontalOscillationRadius:new i.bM(g),u_horizontalOscillationRate:new i.bM(g),u_boxSize:new i.bM(g),u_billboardSize:new i.bM(g),u_simpleShapeParameters:new i.bK(g),u_screenSize:new i.bK(g),u_thinningCenterPos:new i.bK(g),u_thinningShape:new i.bL(g),u_thinningAffectedRatio:new i.bM(g),u_thinningParticleOffset:new i.bM(g),u_particleColor:new i.ca(g),u_direction:new i.bL(g)}),rainParticle:g=>({u_modelview:new i.bJ(g),u_projection:new i.bJ(g),u_time:new i.bM(g),u_cam_pos:new i.bL(g),u_texScreen:new i.bN(g),u_velocityConeAperture:new i.bM(g),u_velocity:new i.bM(g),u_boxSize:new i.bM(g),u_rainDropletSize:new i.bK(g),u_distortionStrength:new i.bM(g),u_rainDirection:new i.bL(g),u_color:new i.ca(g),u_screenSize:new i.bK(g),u_thinningCenterPos:new i.bK(g),u_thinningShape:new i.bL(g),u_thinningAffectedRatio:new i.bM(g),u_thinningParticleOffset:new i.bM(g),u_shapeDirectionalPower:new i.bM(g),u_shapeNormalPower:new i.bM(g),u_mode:new i.bM(g)}),vignette:g=>({u_vignetteShape:new i.bL(g),u_vignetteColor:new i.ca(g)}),occlusion:g=>({u_matrix:new i.bJ(g),u_anchorPos:new i.bL(g),u_screenSizePx:new i.bK(g),u_occluderSizePx:new i.bK(g),u_color:new i.ca(g)})};class Al{constructor(l,d,y,N){this.id=Al.uniqueIdxCounter,Al.uniqueIdxCounter++,this.context=l;const j=l.gl;this.buffer=j.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),j.bufferData(j.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?j.DYNAMIC_DRAW:j.STATIC_DRAW),this.dynamicDraw||N||d.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){this.id=Al.uniqueIdxCounter,Al.uniqueIdxCounter++;const d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Al.uniqueIdxCounter=0;const Lo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Tl{constructor(l,d,y,N,j,C){this.length=d.length,this.attributes=y,this.itemSize=d.bytesPerElement,this.dynamicDraw=N,this.instanceCount=C,this.context=l;const F=l.gl;this.buffer=F.createBuffer(),l.bindVertexBuffer.set(this.buffer),F.bufferData(F.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?F.DYNAMIC_DRAW:F.STATIC_DRAW),this.dynamicDraw||j||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,d){for(let y=0;y<this.attributes.length;y++){const N=d.attributes[this.attributes[y].name];N!==void 0&&l.enableVertexAttribArray(N)}}setVertexAttribPointers(l,d,y){for(let N=0;N<this.attributes.length;N++){const j=this.attributes[N],C=d.attributes[j.name];C!==void 0&&l.vertexAttribPointer(C,j.components,l[Lo[j.type]],!1,this.itemSize,j.offset+this.itemSize*(y||0))}}setVertexAttribDivisor(l,d,y){for(let N=0;N<this.attributes.length;N++){const j=d.attributes[this.attributes[N].name];j!==void 0&&this.instanceCount&&this.instanceCount>0&&l.vertexAttribDivisor(j,y)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Up{constructor(l,d,y,N,j){this.context=l,this.width=d,this.height=y;const C=this.framebuffer=l.gl.createFramebuffer();N&&(this.colorAttachment=new ad(l,C)),j&&(this.depthAttachmentType=j,this.depthAttachment=j==="renderbuffer"?new My(l,C):new vx(l,C))}destroy(){const l=this.context.gl;if(this.colorAttachment){const d=this.colorAttachment.get();d&&l.deleteTexture(d)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const d=this.depthAttachment.get();d&&l.deleteRenderbuffer(d)}else{const d=this.depthAttachment.get();d&&l.deleteTexture(d)}l.deleteFramebuffer(this.framebuffer)}}class Fy{constructor(l,d){this.gl=l,this.clearColor=new Ym(this),this.clearDepth=new Xm(this),this.clearStencil=new fa(this),this.colorMask=new Ip(this),this.depthMask=new Lp(this),this.stencilMask=new gf(this),this.stencilFunc=new gx(this),this.stencilOp=new th(this),this.stencilTest=new pu(this),this.depthRange=new Dp(this),this.depthTest=new Is(this),this.depthFunc=new Jm(this),this.blend=new Qm(this),this.blendFunc=new eg(this),this.blendColor=new tg(this),this.blendEquation=new yf(this),this.cullFace=new rh(this),this.cullFaceSide=new Fp(this),this.frontFace=new zp(this),this.program=new xf(this),this.activeTexture=new rg(this),this.viewport=new yx(this),this.bindFramebuffer=new nh(this),this.bindRenderbuffer=new Z_(this),this.bindTexture=new Y_(this),this.bindVertexBuffer=new Ey(this),this.bindElementBuffer=new id(this),this.bindVertexArrayOES=new xx(this),this.pixelStoreUnpack=new vf(this),this.pixelStoreUnpackPremultiplyAlpha=new Vl(this),this.pixelStoreUnpackFlipY=new ih(this),this.options=d?Object.assign({},d):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=l.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=l.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=l.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=d&&!!d.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=l.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),this.maxPointSize=l.getParameter(l.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,d,y){return new Al(this,l,d,y)}createVertexBuffer(l,d,y,N,j){return new Tl(this,l,d,y,N,j)}createRenderbuffer(l,d,y){const N=this.gl,j=N.createRenderbuffer();return this.bindRenderbuffer.set(j),N.renderbufferStorage(N.RENDERBUFFER,l,d,y),this.bindRenderbuffer.set(null),j}createFramebuffer(l,d,y,N){return new Up(this,l,d,y,N)}clear({color:l,depth:d,stencil:y,colorMask:N}){const j=this.gl;let C=0;l&&(C|=j.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set(N||[!0,!0,!0,!0])),d!==void 0&&(C|=j.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),y!==void 0&&(C|=j.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),j.clear(C)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){i.bn(l.blendFunction,kn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor),l.blendEquation?this.blendEquation.set(l.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(l.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let zc;function hh(g,l,d,y,N,j,C){const F=g.context,W=F.gl,Z=g.transform,Y=g.getOrCreateProgram("collisionBox"),re=[];let ne=0,oe=0;for(let Ue=0;Ue<y.length;Ue++){const Qe=y[Ue],Ke=l.getTile(Qe),Ze=Ke.getBucket(d);if(!Ze)continue;const He=oc(Qe,Ze,Z);let Xe=He;N[0]===0&&N[1]===0||(Xe=g.translatePosMatrix(He,Ke,N,j));const at=C?Ze.textCollisionBox:Ze.iconCollisionBox,_t=Ze.collisionCircleArray;if(_t.length>0){const mt=i.ab.mat4.create(),kt=Xe;i.ab.mat4.mul(mt,Ze.placementInvProjMatrix,Z.glCoordMatrix),i.ab.mat4.mul(mt,mt,Ze.placementViewportMatrix),re.push({circleArray:_t,circleOffset:oe,transform:kt,invTransform:mt,projection:Ze.getProjection()}),ne+=_t.length/4,oe=ne}at&&(g.terrain&&g.terrain.setupElevationDraw(Ke,Y),Y.draw(g,W.LINES,zr.disabled,Wr.disabled,g.colorModeForRenderPass(),Jr.disabled,ig(Xe,Z,Ke,Ze.getProjection()),d.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,null,Z.zoom,null,[at.collisionVertexBuffer,at.collisionVertexBufferExt]))}if(!C||!re.length)return;const _e=g.getOrCreateProgram("collisionCircle"),ge=new i.cV;ge.resize(4*ne),ge._trim();let Te=0;for(const Ue of re)for(let Qe=0;Qe<Ue.circleArray.length/4;Qe++){const Ke=4*Qe,Ze=Ue.circleArray[Ke+0],He=Ue.circleArray[Ke+1],Xe=Ue.circleArray[Ke+2],at=Ue.circleArray[Ke+3];ge.emplace(Te++,Ze,He,Xe,at,0),ge.emplace(Te++,Ze,He,Xe,at,1),ge.emplace(Te++,Ze,He,Xe,at,2),ge.emplace(Te++,Ze,He,Xe,at,3)}(!zc||zc.length<2*ne)&&(zc=function(Ue){const Qe=2*Ue,Ke=new i.aU;Ke.resize(Qe),Ke._trim();for(let Ze=0;Ze<Qe;Ze++){const He=6*Ze;Ke.uint16[He+0]=4*Ze+0,Ke.uint16[He+1]=4*Ze+1,Ke.uint16[He+2]=4*Ze+2,Ke.uint16[He+3]=4*Ze+2,Ke.uint16[He+4]=4*Ze+3,Ke.uint16[He+5]=4*Ze+0}return Ke}(ne));const Ae=F.createIndexBuffer(zc,!0),Re=F.createVertexBuffer(ge,i.cW.members,!0);for(const Ue of re){const Qe={u_matrix:Ue.transform,u_inv_matrix:Ue.invTransform,u_camera_to_center_distance:(qe=Z).getCameraToCenterDistance(Ue.projection),u_viewport_size:[qe.width,qe.height]};_e.draw(g,W.TRIANGLES,zr.disabled,Wr.disabled,g.colorModeForRenderPass(),Jr.disabled,Qe,d.id,Re,Ae,i.b7.simpleSegment(0,2*Ue.circleOffset,Ue.circleArray.length,Ue.circleArray.length/2),null,Z.zoom)}var qe;Re.destroy(),Ae.destroy()}const wf=i.ab.mat4.create();function tl(g){const l=g._camera.getWorldToCamera(g.worldSize,1),d=i.ab.mat4.multiply([],l,g.globeMatrix);i.ab.mat4.invert(d,d);const y=[0,0,0],N=[0,1,0,0];return i.ab.vec4.transformMat4(N,N,d),y[0]=N[0],y[1]=N[1],y[2]=N[2],i.ab.vec3.normalize(y,y),y}function vi({width:g,height:l,anchor:d,textOffset:y,textScale:N},j){const{horizontalAlign:C,verticalAlign:F}=i.bD(d),W=-(C-.5)*g,Z=-(F-.5)*l,Y=i.bC(d,y);return new i.P((W/N+Y[0])*j,(Z/N+Y[1])*j)}function $p(g,l,d,y,N,j,C,F,W,Z,Y){const re=g.text.placedSymbolArray,ne=g.text.dynamicLayoutVertexArray,oe=g.icon.dynamicLayoutVertexArray,_e={},ge=g.getProjection(),Te=cu(F,ge,j),Ae=j.elevation,Re=ge.upVectorScale(F.canonical,j.center.lat,j.worldSize).metersToTile;ne.clear();for(let qe=0;qe<re.length;qe++){const Ue=re.get(qe),{tileAnchorX:Qe,tileAnchorY:Ke,numGlyphs:Ze}=Ue,He=Ue.hidden||!Ue.crossTileID||g.allowVerticalPlacement&&!Ue.placedOrientation?null:y[Ue.crossTileID];if(He){let Xe=0,at=0,_t=0;if(Ae){const jt=Ae?Ae.getAtTileOffset(F,Qe,Ke):0,[Xt,Vt,It]=ge.upVector(F.canonical,Qe,Ke);Xe=jt*Xt*Re,at=jt*Vt*Re,_t=jt*It*Re}let[mt,kt,Pt,ht]=ro(Ue.projectedAnchorX+Xe,Ue.projectedAnchorY+at,Ue.projectedAnchorZ+_t,d?Te:C);const Tt=Wd(j.getCameraToCenterDistance(ge),ht);let $t=N.evaluateSizeForFeature(g.textSizeData,Z,Ue)*Tt/i.bw;d&&($t*=g.tilePixelRatio/W);const pt=vi(He,$t);d?({x:mt,y:kt,z:Pt}=ge.projectTilePoint(Qe+pt.x,Ke+pt.y,F.canonical),[mt,kt,Pt]=ro(mt+Xe,kt+at,Pt+_t,C)):(l&&pt._rotate(-j.angle),mt+=pt.x,kt+=pt.y,Pt=0);const Lt=g.allowVerticalPlacement&&Ue.placedOrientation===i.bq.vertical?Math.PI/2:0;for(let jt=0;jt<Ze;jt++)i.bt(ne,mt,kt,Pt,Lt);Y&&Ue.associatedIconIndex>=0&&(_e[Ue.associatedIconIndex]={x:mt,y:kt,z:Pt,angle:Lt})}else oa(Ze,ne)}if(Y){oe.clear();const qe=g.icon.placedSymbolArray;for(let Ue=0;Ue<qe.length;Ue++){const Qe=qe.get(Ue),{numGlyphs:Ke}=Qe,Ze=_e[Ue];if(Qe.hidden||!Ze)oa(Ke,oe);else{const{x:He,y:Xe,z:at,angle:_t}=Ze;for(let mt=0;mt<Ke;mt++)i.bt(oe,He,Xe,at,_t)}}g.icon.dynamicLayoutVertexBuffer.updateData(oe)}g.text.dynamicLayoutVertexBuffer.updateData(ne)}function ld(g,l,d,y,N,j,C={}){const F=d.paint.get("icon-translate"),W=d.paint.get("text-translate"),Z=d.paint.get("icon-translate-anchor"),Y=d.paint.get("text-translate-anchor"),re=d.layout.get("icon-rotation-alignment"),ne=d.layout.get("text-rotation-alignment"),oe=d.layout.get("icon-pitch-alignment"),_e=d.layout.get("text-pitch-alignment"),ge=d.layout.get("icon-keep-upright"),Te=d.layout.get("text-keep-upright"),Ae=d.paint.get("icon-color-saturation"),Re=d.paint.get("icon-color-contrast"),qe=d.paint.get("icon-color-brightness-min"),Ue=d.paint.get("icon-color-brightness-max"),Qe=d.layout.get("symbol-elevation-reference")==="sea",Ke=g.context,Ze=Ke.gl,He=g.transform,Xe=re==="map",at=ne==="map",_t=oe==="map",mt=_e==="map",kt=d.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Pt=!1;const ht=g.depthModeForSublayer(0,zr.ReadOnly),Tt=[i.at(He.center.lng),i.aA(He.center.lat)],$t=d.layout.get("text-variable-anchor"),pt=He.projection.name==="globe",Lt=[],jt=[0,-1,0];for(const Xt of y){const Vt=l.getTile(Xt),It=Vt.getBucket(d);if(!It||It.projection.name==="mercator"&&pt||It.fullyClipped)continue;const Ht=It.projection.name==="globe",tr=Ht?i.ae(He.zoom):0,gr=cu(Xt,It.getProjection(),He),xr=He.calculatePixelsToTileUnitsMatrix(Vt),qr=$t&&It.hasTextData(),Or=It.hasIconTextFit()&&qr&&It.hasIconData(),Lr=It.getProjection().createInversionMatrix(He,Xt.canonical),Zr=Qn=>{He.depthOcclusionForSymbolsAndCircles&&(d.hasInitialOcclusionOpacityProperties||g.terrain)&&(Qn.push("DEPTH_D24"),Qn.push("DEPTH_OCCLUSION"))},Ln=()=>{const Qn=Xe&&d.layout.get("symbol-placement")!=="point",ai=[];Zr(ai);const na=Qn||Or,ca=d.paint.get("icon-image-cross-fade").constantOr(0);g.terrainRenderModeElevated()&&_t&&ai.push("PITCH_WITH_MAP_TERRAIN"),Ht&&(ai.push("PROJECTION_GLOBE_VIEW"),na&&ai.push("PROJECTED_POS_ON_VIEWPORT")),ca>0&&ai.push("ICON_TRANSITION"),It.icon.zOffsetVertexBuffer&&ai.push("Z_OFFSET"),Ae===0&&Re===0&&qe===0&&Ue===1||ai.push("COLOR_ADJUSTMENT"),It.sdfIcons&&ai.push("RENDER_SDF");const La=It.icon.programConfigurations.get(d.id),ka=g.getOrCreateProgram("symbol",{config:La,defines:ai}),Ds=Vt.imageAtlasTexture?Vt.imageAtlasTexture.size:[0,0],Fs=It.iconSizeData,Ci=i.bp(Fs,He.zoom),Ti=_t||He.pitch!==0,_i=Za(gr,Vt.tileID.canonical,_t,Xe,He,It.getProjection(),xr),Fn=by(gr,Vt.tileID.canonical,_t,Xe,He,It.getProjection(),xr),ua=g.translatePosMatrix(Fn,Vt,F,Z,!0),ds=g.translatePosMatrix(gr,Vt,F,Z),ji=na?wf:_i,Hs=Xe&&!_t&&!Qn;let kl=jt;!pt&&!He.mercatorFromTransition||Xe||(kl=tl(He));const ws=Ht?kl:jt,Bo=d.getColorAdjustmentMatrix(Ae,Re,qe,Ue),Vo=Sa(Fs.kind,Ci,Hs,_t,g,ds,ji,ua,Qe,!1,Ds,[0,0],!0,Xt,tr,Tt,Lr,ws,It.getProjection(),Bo,ca),Pl=Vt.imageAtlasTexture?Vt.imageAtlasTexture:null,Mi=d.layout.get("icon-size").constantOr(0)!==1||It.iconsNeedLinear,Ah=It.sdfIcons||g.options.rotating||g.options.zooming||Mi||Ti?Ze.LINEAR:Ze.NEAREST,pc=It.sdfIcons&&d.paint.get("icon-halo-width").constantOr(1)!==0,Th=g.terrain&&_t&&Qn?i.ab.mat4.invert(i.ab.mat4.create(),_i):wf;if(Qn&&It.icon){const Df=He.elevation,nm=Df?Df.getAtTileOffsetFunc(Xt,He.center.lat,He.worldSize,It.getProjection()):null,Sg=_a(gr,Vt.tileID.canonical,_t,Xe,He,It.getProjection(),xr);wp(It,gr,g,!1,Sg,Fn,_t,ge,nm,Xt)}return{program:ka,buffers:It.icon,uniformValues:Vo,atlasTexture:Pl,atlasTextureIcon:null,atlasInterpolation:Ah,atlasInterpolationIcon:null,isSDF:It.sdfIcons,hasHalo:pc,tile:Vt,labelPlaneMatrixInv:Th}},ui=()=>{const Qn=at&&d.layout.get("symbol-placement")!=="point",ai=[],na=Qn||$t||Or;g.terrainRenderModeElevated()&&mt&&ai.push("PITCH_WITH_MAP_TERRAIN"),Ht&&(ai.push("PROJECTION_GLOBE_VIEW"),na&&ai.push("PROJECTED_POS_ON_VIEWPORT")),It.text.zOffsetVertexBuffer&&ai.push("Z_OFFSET"),It.iconsInText&&ai.push("RENDER_TEXT_AND_SYMBOL"),ai.push("RENDER_SDF"),Zr(ai);const ca=It.text.programConfigurations.get(d.id),La=g.getOrCreateProgram("symbol",{config:ca,defines:ai});let ka,Ds=[0,0],Fs=null;const Ci=It.textSizeData;It.iconsInText&&(Ds=Vt.imageAtlasTexture?Vt.imageAtlasTexture.size:[0,0],Fs=Vt.imageAtlasTexture?Vt.imageAtlasTexture:null,ka=mt||He.pitch!==0||g.options.rotating||g.options.zooming||Ci.kind==="composite"||Ci.kind==="camera"?Ze.LINEAR:Ze.NEAREST);const Ti=Vt.glyphAtlasTexture?Vt.glyphAtlasTexture.size:[0,0],_i=d.layout.get("text-size-scale-range"),Fn=i.aw(g.scaleFactor,_i[0],_i[1]),ua=i.bp(Ci,He.zoom,Fn),ds=Za(gr,Vt.tileID.canonical,mt,at,He,It.getProjection(),xr),ji=by(gr,Vt.tileID.canonical,mt,at,He,It.getProjection(),xr),Hs=g.translatePosMatrix(ji,Vt,W,Y,!0),kl=g.translatePosMatrix(gr,Vt,W,Y),ws=na?wf:ds,Bo=at&&!mt&&!Qn;let Vo=jt;!pt&&!He.mercatorFromTransition||at||(Vo=tl(He));const Pl=Sa(Ci.kind,ua,Bo,mt,g,kl,ws,Hs,Qe,!0,Ti,Ds,!0,Xt,tr,Tt,Lr,Ht?Vo:jt,It.getProjection(),null,null,Fn),Mi=Vt.glyphAtlasTexture?Vt.glyphAtlasTexture:null,Ah=Ze.LINEAR,pc=d.paint.get("text-halo-width").constantOr(1)!==0,Th=g.terrain&&mt&&Qn?i.ab.mat4.invert(i.ab.mat4.create(),ds):wf;if(Qn&&It.text){const Df=He.elevation,nm=Df?Df.getAtTileOffsetFunc(Xt,He.center.lat,He.worldSize,It.getProjection()):null,Sg=_a(gr,Vt.tileID.canonical,mt,at,He,It.getProjection(),xr);wp(It,gr,g,!0,Sg,ji,mt,Te,nm,Xt)}return{program:La,buffers:It.text,uniformValues:Pl,atlasTexture:Mi,atlasTextureIcon:Fs,atlasInterpolation:Ah,atlasInterpolationIcon:ka,isSDF:!0,hasHalo:pc,tile:Vt,labelPlaneMatrixInv:Th}},Wi=It.icon.segments.get().length,Zn=It.text.segments.get().length,Qr=Wi&&!C.onlyText?Ln():null,jn=Zn&&!C.onlyIcons?ui():null,wr=d.paint.get("icon-opacity").constantOr(1),In=d.paint.get("text-opacity").constantOr(1);if(kt&&It.canOverlap){Pt=!0;const Qn=wr&&!C.onlyText?It.icon.segments.get():[],ai=In&&!C.onlyIcons?It.text.segments.get():[];for(const na of Qn)Lt.push({segments:new i.b7([na]),sortKey:na.sortKey,state:Qr});for(const na of ai)Lt.push({segments:new i.b7([na]),sortKey:na.sortKey,state:jn})}else C.onlyText||Lt.push({segments:wr?It.icon.segments:new i.b7([]),sortKey:0,state:Qr}),C.onlyIcons||Lt.push({segments:In?It.text.segments:new i.b7([]),sortKey:0,state:jn})}Pt&&Lt.sort((Xt,Vt)=>Xt.sortKey-Vt.sortKey);for(const Xt of Lt){const Vt=Xt.state;if(Vt)if(g.terrain?g.terrain.setupElevationDraw(Vt.tile,Vt.program,{useDepthForOcclusion:He.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Vt.labelPlaneMatrixInv}):g.setupDepthForOcclusion(He.depthOcclusionForSymbolsAndCircles,Vt.program),Ke.activeTexture.set(Ze.TEXTURE0),Vt.atlasTexture&&Vt.atlasTexture.bind(Vt.atlasInterpolation,Ze.CLAMP_TO_EDGE,!0),Vt.atlasTextureIcon&&(Ke.activeTexture.set(Ze.TEXTURE1),Vt.atlasTextureIcon&&Vt.atlasTextureIcon.bind(Vt.atlasInterpolationIcon,Ze.CLAMP_TO_EDGE,!0)),g.uploadCommonLightUniforms(g.context,Vt.program),Vt.hasHalo){const It=Vt.uniformValues;It.u_is_halo=1,fh(Vt.buffers,Xt.segments,d,g,Vt.program,ht,N,j,It,2),It.u_is_halo=0}else{if(Vt.isSDF){const It=Vt.uniformValues;Vt.hasHalo&&(It.u_is_halo=1,fh(Vt.buffers,Xt.segments,d,g,Vt.program,ht,N,j,It,1)),It.u_is_halo=0}fh(Vt.buffers,Xt.segments,d,g,Vt.program,ht,N,j,Vt.uniformValues,1)}}}function fh(g,l,d,y,N,j,C,F,W,Z){const Y=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.iconTransitioningVertexBuffer,g.globeExtVertexBuffer,g.zOffsetVertexBuffer];N.draw(y,y.context.gl.TRIANGLES,j,C,F,Jr.disabled,W,d.id,g.layoutVertexBuffer,g.indexBuffer,l,d.paint,y.transform.zoom,g.programConfigurations.get(d.id),Y,Z)}function cd(g,l,d,y,N,j,C){const F=g.context.gl,W=d.paint.get("fill-pattern"),Z=d.is3D(),Y=Z?g.stencilModeFor3D():Wr.disabled,re=W&&W.constantOr(1);let ne,oe,_e,ge,Te;C?(oe=re&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ne=F.LINES):(oe=re?"fillPattern":"fill",ne=F.TRIANGLES);for(const Ae of y){const Re=l.getTile(Ae);if(re&&!Re.patternsLoaded())continue;const qe=Re.getBucket(d);if(!qe)continue;g.prepareDrawTile();const Ue=qe.programConfigurations.get(d.id),Qe=g.isTileAffectedByFog(Ae),Ke=g.getOrCreateProgram(oe,{config:Ue,overrideFog:Qe});re&&(g.context.activeTexture.set(F.TEXTURE0),Re.imageAtlasTexture&&Re.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),Ue.updatePaintBuffers());const Ze=W.constantOr(null);if(Ze&&Re.imageAtlas){const at=Re.imageAtlas,_t=i.A.from(Ze).getPrimary().scaleSelf(i.q.devicePixelRatio).serialize(),mt=at.patternPositions[_t];mt&&Ue.setConstantPatternPositions(mt)}const He=g.translatePosMatrix(Ae.projMatrix,Re,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor")),Xe=d.paint.get("fill-emissive-strength");if(C){ge=qe.indexBuffer2,Te=qe.segments2;const at=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[F.drawingBufferWidth,F.drawingBufferHeight];_e=oe==="fillOutlinePattern"&&re?uh(He,Xe,g,Re,at):od(He,Xe,at)}else ge=qe.indexBuffer,Te=qe.segments,_e=re?Gl(He,Xe,g,Re):Bp(He,Xe);g.uploadCommonUniforms(g.context,Ke,Ae.toUnwrapped()),Ke.draw(g,ne,N,Z?Y:g.stencilModeForClipping(Ae),j,Jr.disabled,_e,d.id,qe.layoutVertexBuffer,ge,Te,d.paint,g.transform.zoom,Ue,void 0)}}function ph(g,l,d,y,N,j,C,F){d.resetLayerRenderingStats(g);const W=g.context,Z=W.gl,Y=g.transform,re=d.paint.get("fill-extrusion-pattern"),ne=re.constantOr(1),oe=d.paint.get("fill-extrusion-opacity"),_e=g.style.enable3dLights(),ge=d.paint.get(_e&&!ne?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Te=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),ge],Ae=d.layout.get("fill-extrusion-edge-radius"),Re=Ae>0&&!d.paint.get("fill-extrusion-rounded-roof"),qe=Re?0:Ae,Ue=Y.projection.name==="globe"?i.d3():0,Qe=Y.projection.name==="globe",Ke=Qe?i.ae(Y.zoom):0,Ze=[i.at(Y.center.lng),i.aA(Y.center.lat)],He=d.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Xe=d.paint.get("fill-extrusion-flood-light-color").toRenderColor(He?null:d.lut).toArray01().slice(0,3),at=d.paint.get("fill-extrusion-flood-light-intensity"),_t=d.paint.get("fill-extrusion-vertical-scale"),mt=d.paint.get("fill-extrusion-line-width").constantOr(1)!==0,kt=d.paint.get("fill-extrusion-height-alignment"),Pt=d.paint.get("fill-extrusion-base-alignment"),ht=Bl(g,d.paint.get("fill-extrusion-cutoff-fade-range")),Tt=[];let $t;Qe&&Tt.push("PROJECTION_GLOBE_VIEW"),Te[0]>0&&Tt.push("FAUX_AO"),Re&&Tt.push("ZERO_ROOF_RADIUS"),F&&Tt.push("HAS_CENTROID"),at>0&&Tt.push("FLOOD_LIGHT"),ht.shouldRenderCutoff&&Tt.push("RENDER_CUTOFF"),mt&&Tt.push("RENDER_WALL_MODE");const pt=g.renderPass==="shadow",Lt=g.shadowRenderer,jt=pt&&!!Lt;g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0);let Xt=[0,0,0];if(Lt){const Ht=g.style.directionalLight,tr=g.style.ambientLight;Ht&&tr&&(Xt=Pp(g.style,Ht,tr)),pt||(Tt.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Lt.useNormalOffset&&Tt.push("NORMAL_OFFSET")),$t=Tt.concat(["SHADOWS_SINGLE_CASCADE"])}const Vt=jt?"fillExtrusionDepth":ne?"fillExtrusionPattern":"fillExtrusion",It=d.getLayerRenderingStats();for(const Ht of y){const tr=l.getTile(Ht),gr=tr.getBucket(d);if(!gr||gr.projection.name!==Y.projection.name)continue;let xr=!1;Lt&&(xr=Lt.getMaxCascadeForTile(Ht.toUnwrapped())===0);const qr=g.isTileAffectedByFog(Ht),Or=gr.programConfigurations.get(d.id),Lr=g.getOrCreateProgram(Vt,{config:Or,defines:xr?$t:Tt,overrideFog:qr});if(g.terrain&&g.terrain.setupElevationDraw(tr,Lr,{useMeterToDem:!0}),!gr.centroidVertexBuffer){const jn=Lr.attributes.a_centroid_pos;jn!==void 0&&Z.vertexAttrib2f(jn,0,0)}!pt&&Lt&&Lt.setupShadows(tr.tileID.toUnwrapped(),Lr,"vector-tile",tr.tileID.overscaledZ),ne&&(g.context.activeTexture.set(Z.TEXTURE0),tr.imageAtlasTexture&&tr.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Or.updatePaintBuffers());const Zr=re.constantOr(null);if(Zr&&tr.imageAtlas){const jn=tr.imageAtlas,wr=i.A.from(Zr).getPrimary().scaleSelf(i.q.devicePixelRatio),In=jn.patternPositions[wr.serialize()];In&&Or.setConstantPatternPositions(In)}const Ln=d.paint.get("fill-extrusion-vertical-gradient"),ui=1/gr.tileToMeter;let Wi;if(pt&&Lt){if(Wl(tr.tileID,gr,g))continue;const jn=Lt.calculateShadowPassMatrixFromTile(tr.tileID.toUnwrapped());Wi=ch(jn,qe,ui,_t,kt,Pt)}else{const jn=g.translatePosMatrix(Ht.expandedProjMatrix,tr,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),wr=Y.projection.createInversionMatrix(Y,Ht.canonical);Wi=ne?Iy(jn,g,Ln,oe,Te,qe,ui,Ht,tr,Ue,kt,Pt,Ke,Ze,wr,Xe,_t):lh(jn,g,Ln,oe,Te,qe,ui,Ht,Ue,kt,Pt,Ke,Ze,wr,Xe,_t,at,Xt)}g.uploadCommonUniforms(W,Lr,Ht.toUnwrapped(),null,ht);let Zn=gr.segments;if(Y.projection.name==="mercator"&&!pt&&(Zn=gr.getVisibleSegments(tr.tileID,g.terrain,g.transform.getFrustum(0)),!Zn.get().length))continue;if(It)if(pt)for(const jn of Zn.get())It.numRenderedVerticesInShadowPass+=jn.primitiveLength;else for(const jn of Zn.get())It.numRenderedVerticesInTransparentPass+=jn.primitiveLength;const Qr=[];(g.terrain||F)&&Qr.push(gr.centroidVertexBuffer),Qe&&Qr.push(gr.layoutVertexExtBuffer),mt&&Qr.push(gr.wallVertexBuffer),Lr.draw(g,W.gl.TRIANGLES,N,j,C,Jr.backCCW,Wi,d.id,gr.layoutVertexBuffer,gr.indexBuffer,Zn,d.paint,g.transform.zoom,Or,Qr)}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1)}function ud(g,l,d,y,N,j,C,F,W,Z,Y,re,ne,oe,_e,ge,Te,Ae,Re){const qe=g.context,Ue=qe.gl,Qe=g.transform,Ke=g.transform.zoom,Ze=[],He=Bl(g,d.paint.get("fill-extrusion-cutoff-fade-range"));Z==="clear"?(Ze.push("CLEAR_SUBPASS"),Re&&(Ze.push("CLEAR_FROM_TEXTURE"),qe.activeTexture.set(Ue.TEXTURE0),Re.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE))):Z==="sdf"&&Ze.push("SDF_SUBPASS"),Te&&Ze.push("HAS_CENTROID"),He.shouldRenderCutoff&&Ze.push("RENDER_CUTOFF");const Xe=d.layout.get("fill-extrusion-edge-radius"),at=(_t,mt,kt,Pt,ht)=>{const Tt=mt.programConfigurations.get(d.id),$t=g.isTileAffectedByFog(_t),pt=g.getOrCreateProgram("fillExtrusionGroundEffect",{config:Tt,defines:Ze,overrideFog:$t}),Lt=((Xt,Vt,It,Ht,tr,gr,xr,qr,Or,Lr,Zr)=>({u_matrix:Vt,u_opacity:It,u_ao_pass:Ht?1:0,u_meter_to_tile:tr,u_ao:gr,u_flood_light_intensity:xr,u_flood_light_color:qr,u_attenuation:Or,u_edge_radius:Lr,u_fb:0,u_fb_size:Zr,u_dynamic_offset:1}))(0,Pt,Y,W,ht,[re,ne*ht],oe,_e,ge,Ke>=17?0:Xe*ht,Re?Re.size[0]:0),jt=[];Te&&jt.push(mt.hiddenByLandmarkVertexBuffer),g.uploadCommonUniforms(qe,pt,_t.toUnwrapped(),null,He),pt.draw(g,qe.gl.TRIANGLES,N,j,C,F,Lt,d.id,mt.vertexBuffer,mt.indexBuffer,kt,d.paint,Ke,Tt,jt)};for(const _t of y){const mt=l.getTile(_t),kt=mt.getBucket(d);if(!kt||kt.projection.name!==Qe.projection.name||!kt.groundEffect||kt.groundEffect&&!kt.groundEffect.hasData())continue;const Pt=kt.groundEffect,ht=1/kt.tileToMeter;{const Tt=g.translatePosMatrix(_t.projMatrix,mt,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),$t=Pt.getDefaultSegment();at(_t,Pt,$t,Tt,ht)}if(Ae)for(let Tt=0;Tt<4;Tt++){const $t=i.d4[Tt](_t),pt=l.getTile($t);if(!pt)continue;const Lt=pt.getBucket(d);if(!Lt||Lt.projection.name!==Qe.projection.name||!Lt.groundEffect||Lt.groundEffect&&!Lt.groundEffect.hasData())continue;const jt=Lt.groundEffect;let Xt,Vt;Tt===0?(Xt=[-i.ag,0,0],Vt=1):Tt===1?(Xt=[i.ag,0,0],Vt=0):Tt===2?(Xt=[0,-i.ag,0],Vt=3):(Xt=[0,i.ag,0],Vt=2);const It=jt.regionSegments[Vt];if(!It)continue;const Ht=new Float32Array(16);i.ab.mat4.translate(Ht,_t.projMatrix,Xt),at(_t,jt,It,g.translatePosMatrix(Ht,mt,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),ht)}}}function dd(g,l,d,y,N,j,C){y.centroidVertexArray.length===0&&y.createCentroidsBuffer();const F=j?j.findDEMTileFor(d):null;if(!(F&&F.dem||C))return;j&&F&&F.dem&&y.selfDEMTileTimestamp!==F.dem._timestamp&&(y.borderDoneWithNeighborZ=[-1,-1,-1,-1],y.selfDEMTileTimestamp=F.dem._timestamp);const W=Ae=>new i.P(Math.ceil((Ae+i.d7)*i.d8),0),Z=Ae=>{const Re=l.getSource().minzoom,qe=Qe=>{const Ke=l.getTileByID(Qe);if(Ke&&Ke.hasData())return Ke.getBucket(N)},Ue=[0,-1,1];for(const Qe of Ue){if(Ae.overscaledZ+Qe<Re)continue;const Ke=qe(Ae.calculateScaledKey(Ae.overscaledZ+Qe));if(Ke)return Ke}},Y=[0,0,0],re=(Ae,Re)=>(Y[0]=Math.min(Ae.min.y,Re.min.y),Y[1]=Math.max(Ae.max.y,Re.max.y),Y[2]=i.ag-Re.min.x>Ae.max.x?Re.min.x-i.ag:Ae.max.x,Y),ne=(Ae,Re)=>(Y[0]=Math.min(Ae.min.x,Re.min.x),Y[1]=Math.max(Ae.max.x,Re.max.x),Y[2]=i.ag-Re.min.y>Ae.max.y?Re.min.y-i.ag:Ae.max.y,Y),oe=[(Ae,Re)=>re(Ae,Re),(Ae,Re)=>re(Re,Ae),(Ae,Re)=>ne(Ae,Re),(Ae,Re)=>ne(Re,Ae)],_e=(Ae,Re,qe,Ue,Qe,Ke,Ze)=>{if(!j)return 0;const He=[[Ke?qe:Ae,Ke?Ae:qe,0],[Ke?qe:Re,Ke?Re:qe,0]],Xe=Ze<0?i.ag+Ze:Ze,at=[Ke?Xe:(Ae+Re)/2,Ke?(Ae+Re)/2:Xe,0];return qe===0&&Ze<0||qe!==0&&Ze>0?j.getForTilePoints(Qe,[at],!0,Ue):He.push(at),j.getForTilePoints(d,He,!0,F),Math.max(He[0][2],He[1][2],at[2])/j.exaggeration()};for(let Ae=0;Ae<4;Ae++){const Re=y.borderFeatureIndices[Ae];if(Re.length===0)continue;const qe=i.d4[Ae](d),Ue=Z(qe);if(!(Ue&&Ue instanceof i.d5))continue;const Qe=j?j.findDEMTileFor(qe):null;if(!(Qe&&Qe.dem||C)||(j&&Qe&&Qe.dem&&y.borderDEMTileTimestamp[Ae]!==Qe.dem._timestamp&&(y.borderDoneWithNeighborZ[Ae]=-1,y.borderDEMTileTimestamp[Ae]=Qe.dem._timestamp),y.borderDoneWithNeighborZ[Ae]===Ue.canonical.z))continue;Ue.centroidVertexArray.length===0&&Ue.createCentroidsBuffer();const Ke=(Ae<2?1:5)-Ae,Ze=Ue.borderDoneWithNeighborZ[Ke]!==y.canonical.z,He=Ue.borderFeatureIndices[Ke];let Xe=0;if(y.canonical.z!==Ue.canonical.z){for(const at of Re)y.showCentroid(y.featuresOnBorder[at]);if(Ze)for(const at of He)Ue.showCentroid(Ue.featuresOnBorder[at]);y.borderDoneWithNeighborZ[Ae]=Ue.canonical.z,Ue.borderDoneWithNeighborZ[Ke]=y.canonical.z}for(const at of Re){const _t=y.featuresOnBorder[at],mt=y.centroidData[_t.centroidDataIndex],kt=_t.borders[Ae];let Pt;for(;Xe<He.length;){Pt=Ue.featuresOnBorder[He[Xe]];const ht=Pt.borders[Ke];if(ht[1]>kt[0]+3||ht[0]>kt[0]-3)break;Ue.showCentroid(Pt),Xe++}if(Pt&&Xe<He.length){const ht=Xe;let Tt=0;for(;!(Pt.borders[Ke][0]>kt[1]-3)&&(Tt++,++Xe!==He.length);)Pt=Ue.featuresOnBorder[He[Xe]];Pt=Ue.featuresOnBorder[He[ht]];let $t=!1;if(Tt>=1){const jt=Pt.borders[Ke];Math.abs(kt[0]-jt[0])<3&&Math.abs(kt[1]-jt[1])<3&&(Tt=1,$t=!0,Xe=ht+1)}else if(Tt===0){y.showCentroid(_t);continue}const pt=Ue.centroidData[Pt.centroidDataIndex];C&&$t&&(((ge=mt).flags|(Te=pt).flags)&i.d6?(ge.flags|=i.d6,Te.flags|=i.d6):(ge.flags&=~i.d6,Te.flags&=~i.d6));const Lt=_t.intersectsCount()>1||Pt.intersectsCount()>1;if(Tt>1)Xe=ht,mt.centroidXY=pt.centroidXY=new i.P(0,0);else if(Qe&&Qe.dem&&!Lt){const jt=oe[Ae](mt,pt),Xt=Ae%2?i.ag-1:0,Vt=_e(jt[0],Math.min(i.ag-1,jt[1]),Xt,Qe,qe,Ae<2,jt[2]);mt.centroidXY=pt.centroidXY=W(Vt)}else Lt?mt.centroidXY=pt.centroidXY=new i.P(0,0):(mt.centroidXY=y.encodeBorderCentroid(_t),pt.centroidXY=Ue.encodeBorderCentroid(Pt));y.writeCentroidToBuffer(mt),Ue.writeCentroidToBuffer(pt)}else y.showCentroid(_t)}y.borderDoneWithNeighborZ[Ae]=Ue.canonical.z,Ue.borderDoneWithNeighborZ[Ke]=y.canonical.z}var ge,Te;(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(g)}const hd=[1,0,0],Jt=[0,1,0],dr=[0,0,1];function Wl(g,l,d){const y=d.transform,N=d.shadowRenderer;if(!N)return!0;const j=g.toUnwrapped(),C=y.tileSize*N._cascades[d.currentShadowCascade].scale;let F=l.maxHeight;if(y.elevation){const ge=y.elevation.getMinMaxForTile(g);ge&&(F+=ge.max)}const W=[...N.shadowDirection];W[2]=-W[2];const Z=N.computeSimplifiedTileShadowVolume(j,F,C,W);if(!Z)return!1;const Y=[hd,Jt,dr,W,[W[0],0,W[2]],[0,W[1],W[2]]],re=y.projection.name==="globe",ne=y.scaleZoom(C),oe=i.bR.fromInvProjectionMatrix(y.invProjMatrix,y.worldSize,ne,!re),_e=N.getCurrentCascadeFrustum();return oe.intersectsPrecise(Z.vertices,Z.planes,Y)===0||_e.intersectsPrecise(Z.vertices,Z.planes,Y)===0}function qi(g){return[g[0]*i.d9,g[1]*i.d9,g[2]*i.d9,0]}function vt(g,l,d,y,N,j,C,F,W){const Z=y.getSource(),Y=d.globeSharedBuffers;if(!Y)return;let re,ne,oe;if(l&&(re=y.getTile(l)),Z instanceof i.aJ?(ne=Z.texture,oe=i.cI(0,0,d.transform)):re&&l&&(ne=re.texture,oe=i.cI(l.canonical.z,l.canonical.x,d.transform)),!ne||!oe)return;g||(oe=i.ab.mat4.scale(i.ab.mat4.create(),oe,[1,-1,1]));const _e=d.context,ge=_e.gl,Te=N.paint.get("raster-resampling")==="nearest"?ge.NEAREST:ge.LINEAR,Ae=d.colorModeForDrapableLayerRenderPass(j),Re=C.defines;Re.push("GLOBE_POLES");const qe=new zr(ge.LEQUAL,zr.ReadWrite,d.depthRangeFor3D),Ue=Float32Array.from(d.transform.expandedFarZProjMatrix),Qe=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0))));d.terrain&&d.terrain.prepareDrawTile(),_e.activeTexture.set(ge.TEXTURE0),ne.bind(Te,ge.CLAMP_TO_EDGE),_e.activeTexture.set(ge.TEXTURE1),ne.bind(Te,ge.CLAMP_TO_EDGE),ne.useMipmap&&_e.extTextureFilterAnisotropic&&d.transform.pitch>20&&ge.texParameterf(ge.TEXTURE_2D,_e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,_e.extTextureFilterAnisotropicMax);const[Ke,Ze,He,Xe]=l?Y.getPoleBuffers(l.canonical.z,!1):Y.getPoleBuffers(0,!0),at=N.paint.get("raster-elevation");let _t;g?(_t=Ke,d.renderDefaultNorthPole=at!==0):(_t=Ze,d.renderDefaultSouthPole=at!==0);const mt=qi(C.mix),kt=((ht,Tt,$t,pt,Lt,jt,Xt,Vt,It,Ht,tr,gr,xr)=>_o(ht,Tt,$t,new Float32Array(16),new Float32Array(9),[0,0],pt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},jt,[0,0],Vt,2,Ht,tr,gr,1,0,xr))(Ue,Qe,oe,i.ae(d.transform.zoom),0,N,0,at,0,mt,C.offset,C.range,j),Pt=d.getOrCreateProgram("raster",{defines:Re});d.uploadCommonUniforms(_e,Pt,null),Pt.draw(d,ge.TRIANGLES,qe,W,Ae,F,kt,N.id,_t,He,Xe)}function Bc(g){const l=g._nearZ,d=g.projection.farthestPixelDistance(g),y=d-l,N=.2*g.height,j=l+N;return[l,d,(j-N-l)/y,(j-l)/y]}function dc(g,l,d,y){if(g)return l instanceof Ka&&g instanceof au?l.getTextureDescriptor(g,d,!0):{texture:g.texture,mix:qi(y.mix),offset:y.offset,buffer:0,tileSize:1}}var qp=i.da([{name:"a_index",type:"Int16",components:1}]);class zy{constructor(l,d,y,N){const j={width:y[0],height:y[1],data:null},C=l.gl;this.targetColorTexture=new i.T(l,j,C.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(l,j,C.RGBA8,{useMipmap:!1}),this.context=l,this.updateParticleTexture(d,N),this.lastInvalidatedAt=0}updateParticleTexture(l,d){if(this.particleTextureDimension===d.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const y=this.context.gl,N=d.width*d.height;this.particleTexture0=new i.T(this.context,d,y.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,d,y.RGBA8,{premultiply:!1,useMipmap:!1});const j=new i.db;j.reserve(N);for(let C=0;C<N;C++)j.emplaceBack(C);this.particleIndexBuffer=this.context.createVertexBuffer(j,qp.members,!0),this.particleSegment=i.b7.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=d.width}update(l){return!(this.lastInvalidatedAt<l&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Vc(g,l,d){if(!g)return null;const y=l.getTextureDescriptor(g,d,!0);if(!y)return null;let{texture:N,mix:j,offset:C,tileSize:F,buffer:W,format:Z}=y;if(!N||!Z)return null;let Y=!1;return Z==="uint32"&&(Y=!0,j[3]=0,j=yu(i.dc,j,[0,d.paint.get("raster-particle-max-speed")]),C=uc(i.dc,C,[0,d.paint.get("raster-particle-max-speed")])),{texture:N,textureOffset:[W/(F+2*W),F/(F+2*W)],tileSize:F,scalarData:Y,scale:j,offset:C,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[Z]]}}function xu(g){const l=g._nearZ,d=g.projection.farthestPixelDistance(g),y=d-l,N=.2*g.height,j=l+N;return[l,d,(j-N-l)/y,(j-l)/y]}const vu=new i.aj(1,0,0,1),_x=new i.aj(0,1,0,1),og=new i.aj(0,0,1,1),By=new i.aj(1,0,1,1),fd=new i.aj(0,1,1,1);function io(g,l,d,y,N,j,C){const F=g.context,W=g.transform,Z=F.gl,Y=W.projection.name==="globe",re=Y?["PROJECTION_GLOBE_VIEW"]:[];let ne=i.ab.mat4.clone(d.projMatrix);if(Y&&i.ae(W.zoom)>0){const mt=i.ba(d.canonical,W),kt=i.dd(mt);ne=i.ab.mat4.multiply(new Float32Array(16),W.globeMatrix,kt),i.ab.mat4.multiply(ne,W.projMatrix,ne)}const oe=i.ab.mat4.create();oe[12]+=2*N/(i.q.devicePixelRatio*W.width),oe[13]+=2*j/(i.q.devicePixelRatio*W.height),i.ab.mat4.multiply(ne,oe,ne);const _e=g.getOrCreateProgram("debug",{defines:re}),ge=l.getTileByID(d.key);g.terrain&&g.terrain.setupElevationDraw(ge,_e);const Te=zr.disabled,Ae=Wr.disabled,Re=g.colorModeForRenderPass(),qe="$debug";F.activeTexture.set(Z.TEXTURE0),g.emptyTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Y?ge._makeGlobeTileDebugBuffers(g.context,W):ge._makeDebugTileBoundsBuffers(g.context,W.projection);const Ue=ge._tileDebugBuffer||g.debugBuffer,Qe=ge._tileDebugIndexBuffer||g.debugIndexBuffer,Ke=ge._tileDebugSegments||g.debugSegments;if(_e.draw(g,Z.LINE_STRIP,Te,Ae,Re,Jr.disabled,Fc(ne,y),qe,Ue,Qe,Ke,null,null,null,[ge._globeTileDebugBorderBuffer]),C){const mt=ge.latestRawTileData,kt=Math.floor((mt&&mt.byteLength||0)/1024);let Pt=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(Pt+=` => ${d.overscaledZ}`),Pt+=` ${ge.state}`,Pt+=` ${kt}kb`,function(ht,Tt){ht.initDebugOverlayCanvas();const $t=ht.debugOverlayCanvas,pt=ht.context.gl,Lt=ht.debugOverlayCanvas.getContext("2d");Lt.clearRect(0,0,$t.width,$t.height),Lt.shadowColor="white",Lt.shadowBlur=2,Lt.lineWidth=1.5,Lt.strokeStyle="white",Lt.textBaseline="top",Lt.font="bold 36px Open Sans, sans-serif",Lt.fillText(Tt,5,5),Lt.strokeText(Tt,5,5),ht.debugOverlayTexture.update($t),ht.debugOverlayTexture.bind(pt.LINEAR,pt.CLAMP_TO_EDGE)}(g,Pt)}const Ze=l.getTile(d).tileSize,He=512/Math.min(Ze,512)*(d.overscaledZ/W.zoom)*.5,Xe=ge._tileDebugTextBuffer||g.debugBuffer,at=ge._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,_t=ge._tileDebugTextSegments||g.debugSegments;_e.draw(g,Z.TRIANGLES,Te,Ae,kn.alphaBlended,Jr.disabled,Fc(ne,i.aj.transparent,He),qe,Xe,at,_t,null,null,null,[ge._globeTileDebugTextBuffer])}function mh(g,l,d,y){jl(g,0,l+d/2,g.transform.width,d,y)}function gh(g,l,d,y){jl(g,l-d/2,0,d,g.transform.height,y)}function jl(g,l,d,y,N,j){const C=g.context,F=C.gl;F.enable(F.SCISSOR_TEST),F.scissor(l*i.q.devicePixelRatio,d*i.q.devicePixelRatio,y*i.q.devicePixelRatio,N*i.q.devicePixelRatio),C.clear({color:j}),F.disable(F.SCISSOR_TEST)}const Sf=i.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Do}=Sf;function Uc(g,l,d,y){g.emplaceBack(l,d,y)}class lg{constructor(l){this.vertexArray=new i.de,this.indices=new i.aU,Uc(this.vertexArray,-1,-1,1),Uc(this.vertexArray,1,-1,1),Uc(this.vertexArray,-1,1,1),Uc(this.vertexArray,1,1,1),Uc(this.vertexArray,-1,-1,-1),Uc(this.vertexArray,1,-1,-1),Uc(this.vertexArray,-1,1,-1),Uc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=l.createVertexBuffer(this.vertexArray,Do),this.indexBuffer=l.createIndexBuffer(this.indices),this.segment=i.b7.simpleSegment(0,0,36,12)}}function hi(g,l,d,y,N,j){const C=g.context.gl,F=l.paint.get("sky-atmosphere-color"),W=l.paint.get("sky-atmosphere-halo-color"),Z=l.paint.get("sky-atmosphere-sun-intensity"),Y=((re,ne,oe,_e,ge)=>({u_matrix_3f:re,u_sun_direction:ne,u_sun_intensity:oe,u_color_tint_r:[_e.r,_e.g,_e.b,_e.a],u_color_tint_m:[ge.r,ge.g,ge.b,ge.a],u_luminance:5e-5}))(i.ab.mat3.fromMat4(i.ab.mat3.create(),y),N,Z,F,W);C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+j,l.skyboxTexture,0),d.draw(g,C.TRIANGLES,zr.disabled,Wr.disabled,kn.unblended,Jr.frontCW,Y,"skyboxCapture",l.skyboxGeometry.vertexBuffer,l.skyboxGeometry.indexBuffer,l.skyboxGeometry.segment)}const cg=i.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class yh{constructor(l){const d=new i.df;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);const y=new i.aU;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=l.createVertexBuffer(d,cg.members),this.indexBuffer=l.createIndexBuffer(y),this.segments=i.b7.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Pi=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Jn{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class ug{constructor(l){this.colorModeAlphaBlendedWriteRGB=new kn([1,Zd,1,Zd],i.aj.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new kn([1,0,1,0],i.aj.transparent,[!1,!1,!1,!0]),this.params=new Jn,this.updateNeeded=!0,l.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),l.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),l.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),l.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(l){const d=l.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new yh(d);const y=this.params.sizeRange,N=this.params.intensityRange,j=function(Y){const re=i.di(30),ne=[];for(let oe=0;oe<Y;++oe){const _e=2*Math.PI*re(),ge=Math.acos(1-2*re())-.5*Math.PI;ne.push(i.ab.vec3.fromValues(Math.cos(ge)*Math.cos(_e),Math.cos(ge)*Math.sin(_e),Math.sin(ge)))}return ne}(this.params.starsCount),C=i.di(300),F=new i.dg,W=new i.aU;let Z=0;for(let Y=0;Y<j.length;++Y){const re=i.ab.vec3.scale([],j[Y],200),ne=Math.max(0,1+.01*y*(1*C()-.5)),oe=Math.max(0,1+.01*N*(1*C()-.5));F.emplaceBack(re[0],re[1],re[2],-1,-1,ne,oe),F.emplaceBack(re[0],re[1],re[2],1,-1,ne,oe),F.emplaceBack(re[0],re[1],re[2],1,1,ne,oe),F.emplaceBack(re[0],re[1],re[2],-1,1,ne,oe),W.emplaceBack(Z+0,Z+1,Z+2),W.emplaceBack(Z+0,Z+2,Z+3),Z+=4}this.starsVx=d.createVertexBuffer(F,Pi.members),this.starsIdx=d.createIndexBuffer(W),this.starsSegments=i.b7.simpleSegment(0,0,F.length,W.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(l,d){const y=l.context,N=y.gl,j=l.transform,C=new zr(N.LEQUAL,zr.ReadOnly,[0,1]),F=i.ae(j.zoom),W=l.style.getLut(d.scope),Z=d.properties.get("color-use-theme")==="none",Y=d.properties.get("color").toRenderColor(Z?null:W).toArray01(),re=d.properties.get("high-color-use-theme")==="none",ne=d.properties.get("high-color").toRenderColor(re?null:W).toArray01(),oe=d.properties.get("space-color-use-theme")==="none",_e=d.properties.get("space-color").toRenderColor(oe?null:W).toArray01PremultipliedAlpha(),ge=5e-4,Te=i.dh(d.properties.get("horizon-blend"),0,1,ge,.25),Ae=i.cC(l,y,j)&&Te===ge?j.worldSize/(2*Math.PI*1.025)-1:j.globeRadius,Re=l.frameCounter/1e3%1,qe=i.ab.vec3.length(j.globeCenterInViewSpace),Ue=Math.sqrt(Math.pow(qe,2)-Math.pow(Ae,2)),Qe=Math.acos(Ue/qe),Ke=Ze=>{const He=j.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ze&&He.push("ALPHA_PASS");const Xe=l.getOrCreateProgram("globeAtmosphere",{defines:He}),at=((mt,kt,Pt,ht,Tt,$t,pt,Lt,jt,Xt,Vt,It)=>({u_frustum_tl:mt,u_frustum_tr:kt,u_frustum_br:Pt,u_frustum_bl:ht,u_horizon:Tt,u_transition:$t,u_fadeout_range:pt,u_color:Lt,u_high_color:jt,u_space_color:Xt,u_temporal_offset:Vt,u_horizon_angle:It}))(j.frustumCorners.TL,j.frustumCorners.TR,j.frustumCorners.BR,j.frustumCorners.BL,j.frustumCorners.horizon,F,Te,Y,ne,_e,Re,Qe);l.uploadCommonUniforms(y,Xe);const _t=this.atmosphereBuffer;_t&&Xe.draw(l,N.TRIANGLES,C,Wr.disabled,Ze?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Jr.backCW,at,Ze?"atmosphere_glow_alpha":"atmosphere_glow",_t.vertexBuffer,_t.indexBuffer,_t.segments)};Ke(!1),Ke(!0)}drawStars(l,d){const y=i.aw(d.properties.get("star-intensity"),0,1);if(y===0)return;const N=l.context,j=N.gl,C=l.transform,F=l.getOrCreateProgram("stars"),W=i.ab.quat.identity([]);i.ab.quat.rotateX(W,W,-C._pitch),i.ab.quat.rotateZ(W,W,-C.angle),i.ab.quat.rotateX(W,W,i.ai(C._center.lat)),i.ab.quat.rotateY(W,W,-i.ai(C._center.lng));const Z=i.ab.mat4.fromQuat(new Float32Array(16),W),Y=i.ab.mat4.multiply([],C.starsProjMatrix,Z),re=i.ab.mat3.fromMat4([],Z),ne=i.ab.mat3.invert([],re),oe=[0,1,0];i.ab.vec3.transformMat3(oe,oe,ne),i.ab.vec3.scale(oe,oe,this.params.sizeMultiplier);const _e=[1,0,0];i.ab.vec3.transformMat3(_e,_e,ne),i.ab.vec3.scale(_e,_e,this.params.sizeMultiplier);const ge=(Te=oe,Ae=_e,Re=y,{u_matrix:Float32Array.from(Y),u_up:Te,u_right:Ae,u_intensity_multiplier:Re});var Te,Ae,Re;l.uploadCommonUniforms(N,F),this.starsVx&&this.starsIdx&&F.draw(l,j.TRIANGLES,zr.disabled,Wr.disabled,this.colorModeAlphaBlendedWriteRGB,Jr.disabled,ge,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Fo(g,l){const d=[...g],y=l.cameraWorldSizeForFog/l.worldSize,N=i.ab.mat4.identity([]);return i.ab.mat4.scale(N,N,[y,y,1]),i.ab.mat4.multiply(d,N,d),i.ab.mat4.multiply(d,l.worldToFogMatrix,d),d}function la(g,l,d,y,N){const j=d.material,C=y.context,{baseColorTexture:F,metallicRoughnessTexture:W}=j.pbrMetallicRoughness,{normalTexture:Z,occlusionTexture:Y,emissionTexture:re}=j;function ne(_e,ge,Te){if(_e&&(g.push(ge),C.activeTexture.set(C.gl.TEXTURE0+Te),_e.gfxTexture)){const{minFilter:Ae,magFilter:Re,wrapS:qe,wrapT:Ue}=_e.sampler;_e.gfxTexture.bindExtraParam(Ae,Re,qe,Ue)}}ne(F,"HAS_TEXTURE_u_baseColorTexture",Gs.BaseColor),ne(W,"HAS_TEXTURE_u_metallicRoughnessTexture",Gs.MetallicRoughness),ne(Z,"HAS_TEXTURE_u_normalTexture",Gs.Normal),ne(Y,"HAS_TEXTURE_u_occlusionTexture",Gs.Occlusion),ne(re,"HAS_TEXTURE_u_emissionTexture",Gs.Emission),N&&(N.texture||(N.texture=new i.dk(y.context,N.image,[N.image.height,N.image.height,N.image.height],C.gl.RGBA8)),C.activeTexture.set(C.gl.TEXTURE0+Gs.LUT),N.texture&&N.texture.bind(C.gl.LINEAR,C.gl.CLAMP_TO_EDGE),g.push("APPLY_LUT_ON_GPU")),d.texcoordBuffer&&(g.push("HAS_ATTRIBUTE_a_uv_2f"),l.push(d.texcoordBuffer)),d.colorBuffer&&(g.push(d.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),l.push(d.colorBuffer)),d.normalBuffer&&(g.push("HAS_ATTRIBUTE_a_normal_3f"),l.push(d.normalBuffer)),d.pbrBuffer&&(g.push("HAS_ATTRIBUTE_a_pbr"),g.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),l.push(d.pbrBuffer)),j.alphaMode!=="OPAQUE"&&j.alphaMode!=="MASK"||g.push("UNPREMULT_TEXTURE_IN_SHADER"),j.defined||g.push("DIFFUSE_SHADED");const oe=y.shadowRenderer;oe&&(g.push("RENDER_SHADOWS","DEPTH_TEXTURE"),oe.useNormalOffset&&g.push("NORMAL_OFFSET"))}function pa(g,l,d,y,N,j){const C=d.paint.get("model-opacity").constantOr(1),F=l.context,W=new zr(l.context.gl.LEQUAL,zr.ReadWrite,l.depthRangeFor3D),Z=l.transform,Y=g.mesh,re=Y.material,ne=re.pbrMetallicRoughness,oe=l.style.fog;let _e;_e=l.transform.projection.zAxisUnit==="pixels"?[...g.nodeModelMatrix]:i.ab.mat4.multiply([],y.zScaleMatrix,g.nodeModelMatrix),i.ab.mat4.multiply(_e,y.negCameraPosMatrix,_e);const ge=i.ab.mat4.invert([],_e);i.ab.mat4.transpose(ge,ge);const Te=d.paint.get("model-color-use-theme").constantOr("default")==="none",Ae=d.paint.get("model-emissive-strength").constantOr(0),Re=dh(new Float32Array(g.worldViewProjection),new Float32Array(_e),new Float32Array(ge),null,l,C,ne.baseColorFactor.toRenderColor(null),re.emissiveFactor,ne.metallicFactor,ne.roughnessFactor,re,Ae,d),qe={defines:[]},Ue=[],Qe=l.shadowRenderer;Qe&&(Qe.useNormalOffset=!1),la(qe.defines,Ue,Y,l,Te?null:d.lut);let Ke=null;if(oe){const Xe=Fo(g.nodeModelMatrix,l.transform);if(Ke=new Float32Array(Xe),Z.projection.name!=="globe"){const at=Y.aabb.min,_t=Y.aabb.max,[mt,kt]=oe.getOpacityForBounds(Xe,at[0],at[1],_t[0],_t[1]);qe.overrideFog=mt>=Je||kt>=Je}}const Ze=Bl(l,d.paint.get("model-cutoff-fade-range"));Ze.shouldRenderCutoff&&qe.defines.push("RENDER_CUTOFF");const He=l.getOrCreateProgram("model",qe);l.uploadCommonUniforms(F,He,null,Ke,Ze),l.renderPass!=="shadow"&&Qe&&Qe.setupShadowsFromMatrix(g.nodeModelMatrix,He),He.draw(l,F.gl.TRIANGLES,W,N,j,Y.material.doubleSided?Jr.disabled:Jr.backCCW,Re,d.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,d.paint,l.transform.zoom,void 0,Ue)}function cs(g,l,d,y,N,j,C){let F;F=g.projection.name==="globe"?i.dl(d,g):[...d],i.ab.mat4.multiply(F,F,l.matrix);const W=i.ab.mat4.multiply([],y,F);if(l.meshes)for(const Z of l.meshes){if(Z.material.alphaMode!=="BLEND"){C.push({mesh:Z,depth:0,modelIndex:N,worldViewProjection:W,nodeModelMatrix:F});continue}const Y=i.ab.vec3.transformMat4([],Z.centroid,W);!g.isOrthographic&&Y[2]<=0||j.push({mesh:Z,depth:Y[2],modelIndex:N,worldViewProjection:W,nodeModelMatrix:F})}if(l.children)for(const Z of l.children)cs(g,Z,d,y,N,j,C)}function pd(g,l,d,y){const N=d.shadowRenderer;if(!N)return;const j=N.getShadowPassDepthMode(),C=N.getShadowPassColorMode(),F=N.calculateShadowPassMatrixFromMatrix(l),W=bf(F);d.getOrCreateProgram("modelDepth",{defines:d._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(d,d.context.gl.TRIANGLES,j,Wr.disabled,C,Jr.backCCW,W,y.id,g.vertexBuffer,g.indexBuffer,g.segments,y.paint,d.transform.zoom,void 0,void 0)}function rl(g,l,d){const y=l.updateZoomBasedPaintProperties(),N=function(j,C,F){let W,Z,Y,re=j.terrain?j.terrain.exaggeration():0;if(j.terrain&&re>0){const ne=j.terrain,oe=ne.findDEMTileFor(F);oe&&oe.dem?W=i.dn.create(ne,F,oe):re=0}if(re===0&&(C.terrainElevationMin=0,C.terrainElevationMax=0),re===C.validForExaggeration&&(re===0||W&&W._demTile&&W._demTile.tileID===C.validForDEMTile.id&&W._dem._timestamp===C.validForDEMTile.timestamp))return!1;for(const ne in C.instancesPerModel){const oe=C.instancesPerModel[ne];for(let _e=0;_e<oe.instancedDataArray.length;++_e){const ge=(W?re*W.getElevationAt(0|oe.instancedDataArray.float32[16*_e],0|oe.instancedDataArray.float32[16*_e+1],!0,!0):0)+oe.instancesEvaluatedElevation[_e];oe.instancedDataArray.float32[16*_e+6]=ge,Z=Z?Math.min(C.terrainElevationMin,ge):ge,Y=Y?Math.max(C.terrainElevationMax,ge):ge}}return C.terrainElevationMin=Z||0,C.terrainElevationMax=Y||0,C.validForExaggeration=re,C.validForDEMTile=W&&W._demTile?{id:W._demTile.tileID,timestamp:W._dem._timestamp}:{id:void 0,timestamp:0},!0}(g,l,d);(y||N)&&(l.uploaded=!1,l.upload(g.context))}const us={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.cd([0,0,0],[i.ag,i.ag,0])};function dg(g,l){const d=1<<g.canonical.z,y=l.getFreeCameraOptions().position,N=l.elevation,j=g.canonical.x/d,C=(g.canonical.x+1)/d,F=g.canonical.y/d,W=(g.canonical.y+1)/d;let Z=l._centerAltitude;if(N){const oe=N.getMinMaxForTile(g);oe&&oe.max>Z&&(Z=oe.max)}const Y=i.aw(y.x,j,C)-y.x,re=i.aw(y.y,F,W)-y.y,ne=i.bH(Z,l.center.lat)-y.z;return l._zoomFromMercatorZ(Math.sqrt(Y*Y+re*re+ne*ne))}function _s(g,l,d,y,N,j,C){const F=g.context,W=g.renderPass==="shadow",Z=g.shadowRenderer,Y=W&&Z?Z.getShadowPassDepthMode():new zr(F.gl.LEQUAL,zr.ReadWrite,g.depthRangeFor3D),re=g.isTileAffectedByFog(j);if(d.meshes)for(const ne of d.meshes){const oe=["MODEL_POSITION_ON_GPU"],_e=[];let ge,Te,Ae;y.instancedDataArray.length>20&&oe.push("INSTANCED_ARRAYS");const Re=Bl(g,l.paint.get("model-cutoff-fade-range"));if(Re.shouldRenderCutoff&&oe.push("RENDER_CUTOFF"),W&&Z)ge=g.getOrCreateProgram("modelDepth",{defines:oe}),Te=bf(C.shadowTileMatrix,C.shadowTileMatrix,Float32Array.from(d.matrix)),Ae=Z.getShadowPassColorMode();else{la(oe,_e,ne,g,l.paint.get("model-color-use-theme").constantOr("default")==="none"?null:l.lut),ge=g.getOrCreateProgram("model",{defines:oe,overrideFog:re});const Ue=ne.material,Qe=Ue.pbrMetallicRoughness,Ke=l.paint.get("model-opacity").constantOr(1),Ze=l.paint.get("model-emissive-strength").constantOr(0);Te=dh(j.expandedProjMatrix,Float32Array.from(d.matrix),new Float32Array(16),null,g,Ke,Qe.baseColorFactor.toRenderColor(null),Ue.emissiveFactor,Qe.metallicFactor,Qe.roughnessFactor,Ue,Ze,l,N),Z&&(C.shadowUniformsInitialized?ge.setShadowUniformValues(F,Z.getShadowUniformValues()):(Z.setupShadows(j.toUnwrapped(),ge,"model-tile",j.overscaledZ),C.shadowUniformsInitialized=!0)),Ae=Re.shouldRenderCutoff||Ke<1||Ue.alphaMode!=="OPAQUE"?kn.alphaBlended:kn.unblended}g.uploadCommonUniforms(F,ge,j.toUnwrapped(),null,Re);const qe=ne.material.doubleSided?Jr.disabled:Jr.backCCW;if(y.instancedDataArray.length>20)_e.push(y.instancedDataBuffer),ge.draw(g,F.gl.TRIANGLES,Y,Wr.disabled,Ae,qe,Te,l.id,ne.vertexBuffer,ne.indexBuffer,ne.segments,l.paint,g.transform.zoom,void 0,_e,y.instancedDataArray.length);else{const Ue=W?"u_instance":"u_normal_matrix";for(let Qe=0;Qe<y.instancedDataArray.length;++Qe)Te[Ue]=new Float32Array(y.instancedDataArray.arrayBuffer,64*Qe,16),ge.draw(g,F.gl.TRIANGLES,Y,Wr.disabled,Ae,qe,Te,l.id,ne.vertexBuffer,ne.indexBuffer,ne.segments,l.paint,g.transform.zoom,void 0,_e)}}if(d.children)for(const ne of d.children)_s(g,l,ne,y,N,j,C)}const Gp=[1,-1,1];function Wp(g,l,d,y){if(!d.modelManager)return!0;const N=d.modelManager;if(!d.shadowRenderer)return!0;const j=d.shadowRenderer,C=l.aabb;let F=!0,W=g.maxHeight;if(W===0){let Y=0;for(const re in g.instancesPerModel){const ne=N.getModel(re,y);ne?Y=Math.max(Y,Math.max(Math.max(ne.aabb.max[0],ne.aabb.max[1]),ne.aabb.max[2])):F=!1}W=g.maxScale*Y*1.41+g.maxVerticalOffset,F&&(g.maxHeight=W)}C.max[2]=W,C.min[2]+=g.terrainElevationMin,C.max[2]+=g.terrainElevationMax,i.ab.vec3.transformMat4(C.min,C.min,l.tileMatrix),i.ab.vec3.transformMat4(C.max,C.max,l.tileMatrix);const Z=C.intersects(j.getCurrentCascadeFrustum());return d.currentShadowCascade===0&&(g.isInsideFirstShadowMapFrustum=Z===2),Z===0}function _u(g,l){const d=g.uniformValues.u_cutoff_params[0],y=g.uniformValues.u_cutoff_params[1],N=g.uniformValues.u_cutoff_params[2],j=g.uniformValues.u_cutoff_params[3];return y===d||j===N?1:i.aw(((l-d)/(y-d)-N)/(j-N),0,1)}function Hl(g,l,d,y){if(l.pitch<20)return 1;const N=l.getWorldToCameraMatrix();i.ab.mat4.multiply(N,N,g);const j=i.ab.vec4.fromValues(d.min[0],d.min[1],d.min[2],1);let C=i.ab.vec4.transformMat4(i.ab.vec4.create(),j,N),F=C,W=C;j[1]=d.max[1],C=i.ab.vec4.transformMat4(i.ab.vec4.create(),j,N),F=C[1]<F[1]?C:F,W=C[1]>W[1]?C:W,j[0]=d.max[0],C=i.ab.vec4.transformMat4(i.ab.vec4.create(),j,N),F=C[1]<F[1]?C:F,W=C[1]>W[1]?C:W,j[1]=d.min[1],C=i.ab.vec4.transformMat4(i.ab.vec4.create(),j,N),F=C[1]<F[1]?C:F,W=C[1]>W[1]?C:W;const Z=i.aw(y[0],0,1),Y=100*l.pixelsPerMeter*i.aw(y[1],0,1),re=i.aw(y[2],0,1),ne=i.ab.vec4.lerp(i.ab.vec4.create(),F,W,Z),oe=Math.tan(.5*l.fovX),_e=-ne[2]*oe;if(Y===0)return ne[1]<-Math.abs(_e)?re:1;const ge=(-Math.abs(_e)-ne[1])/Y,Te=(Re,qe,Ue)=>(1-Ue)*Re+Ue*qe,Ae=i.aw(Te(1,re,ge),re,1);return Te(1,Ae,i.aw((l.pitch-20)/20,0,1))}class Ls{}class xh{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(l,d,y){{const re=this._storage.get(d.id);if(re)return re.lastUsedFrameIdx=l,re.buf}const N=y.gl,j=N.getBufferParameter(N.ELEMENT_ARRAY_BUFFER,N.BUFFER_SIZE),C=new ArrayBuffer(j),F=new Int16Array(C);N.getBufferSubData(N.ELEMENT_ARRAY_BUFFER,0,new Int16Array(C));const W=new i.dq;for(let re=0;re<j/2;re+=3){const ne=F[re],oe=F[re+1],_e=F[re+2];W.emplaceBack(ne,oe),W.emplaceBack(oe,_e),W.emplaceBack(_e,ne)}const Z=y.bindVertexArrayOES.current,Y=new Ls;return Y.buf=new Al(y,W),Y.lastUsedFrameIdx=l,this._storage.set(d.id,Y),y.bindVertexArrayOES.set(Z),Y.buf}update(l){for(const[d,y]of this._storage)l-y.lastUsedFrameIdx>30&&(y.buf.destroy(),this._storage.delete(d))}destroy(){for(const[l,d]of this._storage)d.buf.destroy(),this._storage.delete(l)}}class Nf{constructor(l){this.occluderSize=30,this.depthOffset=-1e-4,l.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),l.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Hp=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class hg{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class bs{constructor(l,d){this.revealStart=11,this.revealRange=2,l.registerParameter(this,[...d,"Reveal"],"revealStart",{min:0,max:17,step:.05}),l.registerParameter(this,[...d,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const fg=i.da([{type:"Float32",name:"a_pos_2f",components:2}]);class pg{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(l,d){const y=l.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const C=new i.dr,F=new i.aU;C.emplaceBack(-1,-1),C.emplaceBack(1,-1),C.emplaceBack(1,1),C.emplaceBack(-1,1),F.emplaceBack(0,1,2),F.emplaceBack(0,2,3),this.vignetteVx=l.context.createVertexBuffer(C,fg.members),this.vignetteIdx=l.context.createIndexBuffer(F)}const N=i.b7.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){l.uploadCommonUniforms(l.context,y);const C={u_vignetteShape:(j={vignetteShape:[d.start,d.range,Math.pow(10,d.fadePower)],vignetteColor:[d.color.r,d.color.g,d.color.b,d.color.a*d.strength]}).vignetteShape,u_vignetteColor:j.vignetteColor};y.draw(l,l.context.gl.TRIANGLES,zr.disabled,Wr.disabled,kn.alphaBlended,Jr.disabled,C,"vignette",this.vignetteVx,this.vignetteIdx,N,{})}var j}}class Af{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(l,d){const y=l.getFreeCameraOptions().position,N=y.toAltitude(),j=y.toLngLat(),C=i.ai(j.lng),F=i.ai(j.lat),W=l.pixelsPerMeter/d,Z=C*i.ds,Y=i.ds*Math.log(Math.tan(Math.PI/4+F/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const re=-this._offsetYPrev+Y,ne=-this._elevationPrev+N;this._accumulatedOffsetX+=(-this._offsetXPrev+Z)*W,this._accumulatedOffsetY+=re*W,this._accumulatedElevation+=ne*W,this._offsetXPrev=Z,this._offsetYPrev=Y,this._elevationPrev=N}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function bu(g,l){return[-(g[0]-Math.floor(g[0]/l)*l),-(g[1]-Math.floor(g[1]/l)*l),-(g[2]-Math.floor(g[2]/l)*l)]}function Kp(g){const l=i.di(1323123451230),d=[];for(let y=0;y<g;++y){const N=2*l()-1,j=2*l()-1,C=2*l()-1;d.push(i.ab.vec3.fromValues(N,j,C))}return d}function hc(g,l,d,y,N){const j=i.aw((N-d)/(y-d),0,1);return(1-j)*g+j*l}class md{constructor(l){this._movement=new Af,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new pg,this._ppmScaleFactor=l}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(l,d){const y=l.transform;this._movement.update(y,this._ppmScaleFactor);const N=y.starsProjMatrix,j=i.ab.quat.identity([]);i.ab.quat.rotateX(j,j,i.ai(90)-y._pitch),i.ab.quat.rotateZ(j,j,-y.angle);const C=i.ab.mat4.fromQuat(new Float32Array(16),j),F=i.ab.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),W=i.ab.mat4.transpose([],F),Z=i.ab.mat4.multiply([],W,C),Y=Date.now()/1e3;return this._accumulatedTimeFromStart+=(Y-this._prevTime)*d,this._prevTime=Y,{projectionMatrix:N,modelviewMatrix:Z}}}class vh extends md{constructor(l){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new bs(l.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(l){const d=l.context;if(!this.particlesVx){const y=Kp(this.particlesCount),N=new i.dt,j=new i.aU;let C=0;const F=i.di(1323123451230);for(let W=0;W<y.length;++W){const Z=y[W],Y=[2*F()-1,F(),F(),F()];N.emplaceBack(Z[0],Z[1],Z[2],-1,-1,...Y),N.emplaceBack(Z[0],Z[1],Z[2],1,-1,...Y),N.emplaceBack(Z[0],Z[1],Z[2],1,1,...Y),N.emplaceBack(Z[0],Z[1],Z[2],-1,1,...Y),j.emplaceBack(C+0,C+1,C+2),j.emplaceBack(C+0,C+2,C+3),C+=4}this.particlesVx=d.createVertexBuffer(N,Hp.members),this.particlesIdx=d.createIndexBuffer(j)}}draw(l){if(!this._params.overrideStyleParameters&&!l.style.rain)return;const d=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},y=l.transform.zoom;if(d.revealStart>y)return;const N=hc(0,1,d.revealStart,d.revealStart+d.revealRange,y);if(!this.particlesVx||!this.particlesIdx)return;const j=structuredClone(this._params);let C=[-j.direction.x,j.direction.y,-100];i.ab.vec3.normalize(C,C);const F=structuredClone(this._vignetteParams);F.strength*=N,j.overrideStyleParameters||(j.intensity=l.style.rain.state.density,j.timeFactor=l.style.rain.state.intensity,j.color=structuredClone(l.style.rain.state.color),C=structuredClone(l.style.rain.state.direction),j.screenThinning.intensity=l.style.rain.state.centerThinning,j.dropletSizeX=l.style.rain.state.dropletSize[0],j.dropletSizeYScale=l.style.rain.state.dropletSize[1]/l.style.rain.state.dropletSize[0],j.distortionStrength=100*l.style.rain.state.distortionStrength,F.strength=1,F.color=structuredClone(l.style.rain.state.vignetteColor));const W=this.updateOnRender(l,j.timeFactor),Z=l.context,Y=Z.gl,re=l.transform;this.screenTexture&&this.screenTexture.size[0]===l.width&&this.screenTexture.size[1]===l.height||(this.screenTexture=new i.T(Z,{width:l.width,height:l.height,data:null},Y.RGBA8)),j.distortionStrength>0&&(Z.activeTexture.set(Y.TEXTURE0),this.screenTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Y.copyTexSubImage2D(Y.TEXTURE_2D,0,0,0,0,0,l.width,l.height));const ne=l.getOrCreateProgram("rainParticle");l.uploadCommonUniforms(Z,ne),Z.activeTexture.set(Y.TEXTURE0),this.screenTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const oe=[j.color.r,j.color.g,j.color.b,j.color.a],_e=(ge,Te)=>{const Ae=bu(this._movement.getPosition(),ge),Re=j.dropletSizeX,qe=j.dropletSizeX*j.dropletSizeYScale,Ue=l.width/2,Qe=l.height/2,Ke=hc(0,j.screenThinning.start,0,1,j.screenThinning.intensity),Ze=hc(.001,j.screenThinning.range,0,1,j.screenThinning.intensity),He=hc(0,j.screenThinning.particleOffset,0,1,j.screenThinning.intensity),Xe=(at={modelview:W.modelviewMatrix,projection:W.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:Ae,velocityConeAperture:j.velocityConeAperture,velocity:j.velocity,boxSize:ge,rainDropletSize:[Re,qe],distortionStrength:j.distortionStrength,rainDirection:C,color:oe,screenSize:[re.width,re.height],thinningCenterPos:[Ue,Qe],thinningShape:[Ke,Ze,Math.pow(10,j.screenThinning.fadePower)],thinningAffectedRatio:j.screenThinning.affectedRatio,thinningParticleOffset:He,shapeDirectionalPower:j.shapeDirPower,shapeNormalPower:j.shapeNormalPower,mode:Te?0:1},{u_modelview:Float32Array.from(at.modelview),u_projection:Float32Array.from(at.projection),u_time:at.time,u_cam_pos:at.camPos,u_texScreen:0,u_velocityConeAperture:at.velocityConeAperture,u_velocity:at.velocity,u_boxSize:at.boxSize,u_rainDropletSize:at.rainDropletSize,u_distortionStrength:at.distortionStrength,u_rainDirection:at.rainDirection,u_color:at.color,u_screenSize:at.screenSize,u_thinningCenterPos:at.thinningCenterPos,u_thinningShape:at.thinningShape,u_thinningAffectedRatio:at.thinningAffectedRatio,u_thinningParticleOffset:at.thinningParticleOffset,u_shapeDirectionalPower:at.shapeDirectionalPower,u_shapeNormalPower:at.shapeNormalPower,u_mode:at.mode});var at;const _t=Math.round(j.intensity*this.particlesCount),mt=i.b7.simpleSegment(0,0,4*_t,2*_t);ne.draw(l,Y.TRIANGLES,zr.disabled,Wr.disabled,kn.alphaBlended,Jr.disabled,Xe,"rain_particles",this.particlesVx,this.particlesIdx,mt,{})};j.distortionStrength>0&&_e(j.boxSize,!0),_e(j.boxSize,!1),this._vignette.draw(l,F)}}const Tf=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class jf extends md{constructor(l){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new bs(l.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(l){const d=l.context;if(!this.particlesVx){const y=Kp(this.particlesCount),N=new i.du,j=new i.aU;let C=0;const F=i.di(1323123451230);for(let W=0;W<y.length;++W){const Z=y[W],Y=F(),re=F(),ne=F(),oe=[W/y.length,Y,re,ne],_e=[F(),F()];N.emplaceBack(Z[0],Z[1],Z[2],-1,-1,...oe,..._e),N.emplaceBack(Z[0],Z[1],Z[2],1,-1,...oe,..._e),N.emplaceBack(Z[0],Z[1],Z[2],1,1,...oe,..._e),N.emplaceBack(Z[0],Z[1],Z[2],-1,1,...oe,..._e),j.emplaceBack(C+0,C+1,C+2),j.emplaceBack(C+0,C+2,C+3),C+=4}this.particlesVx=d.createVertexBuffer(N,Tf.members),this.particlesIdx=d.createIndexBuffer(j)}}draw(l){if(!this._params.overrideStyleParameters&&!l.style.snow)return;const d=structuredClone(this._params);let y=[-d.direction.x,d.direction.y,-100];i.ab.vec3.normalize(y,y);const N=structuredClone(this._vignetteParams),j=d.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},C=l.transform.zoom;if(j.revealStart>C)return;const F=hc(0,1,j.revealStart,j.revealStart+j.revealRange,C);N.strength*=F,d.overrideStyleParameters||(d.intensity=l.style.snow.state.density,d.timeFactor=l.style.snow.state.intensity,d.color=structuredClone(l.style.snow.state.color),y=structuredClone(l.style.snow.state.direction),d.screenThinning.intensity=l.style.snow.state.centerThinning,d.billboardSize=2.79*l.style.snow.state.flakeSize,N.strength=1,N.color=structuredClone(l.style.snow.state.vignetteColor));const W=this.updateOnRender(l,d.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const Z=l.context,Y=Z.gl,re=l.transform,ne=l.getOrCreateProgram("snowParticle");l.uploadCommonUniforms(Z,ne),((oe,_e,ge)=>{const Te=bu(this._movement.getPosition(),oe),Ae=re.width/2,Re=re.height/2,qe=hc(0,ge.screenThinning.start,0,1,ge.screenThinning.intensity),Ue=hc(.001,ge.screenThinning.range,0,1,ge.screenThinning.intensity),Qe=hc(0,ge.screenThinning.particleOffset,0,1,ge.screenThinning.intensity),Ke=(Ze={modelview:W.modelviewMatrix,projection:W.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:Te,velocityConeAperture:ge.velocityConeAperture,velocity:ge.velocity,horizontalOscillationRadius:ge.horizontalOscillationRadius,horizontalOscillationRate:ge.horizontalOscillationRate,boxSize:oe,billboardSize:1*ge.billboardSize,simpleShapeParameters:[ge.shapeFadeStart,ge.shapeFadePower],screenSize:[re.width,re.height],thinningCenterPos:[Ae,Re],thinningShape:[qe,Ue,Math.pow(10,ge.screenThinning.fadePower)],thinningAffectedRatio:ge.screenThinning.affectedRatio,thinningParticleOffset:Qe,color:[ge.color.r,ge.color.g,ge.color.b,ge.color.a],direction:y},{u_modelview:Float32Array.from(Ze.modelview),u_projection:Float32Array.from(Ze.projection),u_time:Ze.time,u_cam_pos:Ze.camPos,u_velocityConeAperture:Ze.velocityConeAperture,u_velocity:Ze.velocity,u_horizontalOscillationRadius:Ze.horizontalOscillationRadius,u_horizontalOscillationRate:Ze.horizontalOscillationRate,u_boxSize:Ze.boxSize,u_billboardSize:Ze.billboardSize,u_simpleShapeParameters:Ze.simpleShapeParameters,u_screenSize:Ze.screenSize,u_thinningCenterPos:Ze.thinningCenterPos,u_thinningShape:Ze.thinningShape,u_thinningAffectedRatio:Ze.thinningAffectedRatio,u_thinningParticleOffset:Ze.thinningParticleOffset,u_particleColor:Ze.color,u_direction:Ze.direction});var Ze;const He=Math.round(ge.intensity*this.particlesCount),Xe=i.b7.simpleSegment(0,0,4*He,2*He);this.particlesVx&&this.particlesIdx&&ne.draw(l,Y.TRIANGLES,zr.disabled,Wr.disabled,kn.alphaBlended,Jr.disabled,Ke,"snow_particles",this.particlesVx,this.particlesIdx,Xe,{})})(d.boxSize,0,d),this._vignette.draw(l,N)}}const kf={symbol:function(g,l,d,y,N){if(g.renderPass!=="translucent")return;const j=Wr.disabled,C=g.colorModeForRenderPass(),F=d.layout.get("text-variable-anchor"),W=d.layout.get("text-size-scale-range"),Z=i.aw(g.scaleFactor,W[0],W[1]);F&&function(ne,oe,_e,ge,Te,Ae,Re,qe){const Ue=oe.transform,Qe=Te==="map",Ke=Ae==="map";for(const Ze of ne){const He=ge.getTile(Ze),Xe=He.getBucket(_e);if(!Xe||!Xe.text||!Xe.text.segments.get().length)continue;const at=i.bp(Xe.textSizeData,Ue.zoom,qe),_t=cu(Ze,Xe.getProjection(),Ue),mt=Ue.calculatePixelsToTileUnitsMatrix(He),kt=Za(_t,He.tileID.canonical,Ke,Qe,Ue,Xe.getProjection(),mt),Pt=Xe.hasIconTextFit()&&Xe.hasIconData();if(at){const ht=Math.pow(2,Ue.zoom-He.tileID.overscaledZ);$p(Xe,Qe,Ke,Re,i.cX,Ue,kt,Ze,ht,at,Pt)}}}(y,g,d,l,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),N,Z);const Y=d.paint.get("icon-opacity").constantOr(1)!==0,re=d.paint.get("text-opacity").constantOr(1)!==0;d.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(Y||re)?ld(g,l,d,y,j,C):(Y&&ld(g,l,d,y,j,C,{onlyIcons:!0}),re&&ld(g,l,d,y,j,C,{onlyText:!0})),l.map.showCollisionBoxes&&(hh(g,l,d,y,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),hh(g,l,d,y,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(g,l,d,y){if(g.renderPass!=="translucent")return;const N=d.paint.get("circle-opacity"),j=d.paint.get("circle-stroke-width"),C=d.paint.get("circle-stroke-opacity"),F=d.layout.get("circle-sort-key").constantOr(1)!==void 0,W=d.paint.get("circle-emissive-strength");if(N.constantOr(1)===0&&(j.constantOr(1)===0||C.constantOr(1)===0))return;const Z=g.context,Y=Z.gl,re=g.transform,ne=g.depthModeForSublayer(0,zr.ReadOnly),oe=Wr.disabled,_e=g.colorModeForDrapableLayerRenderPass(W),ge=re.projection.name==="globe",Te=[i.at(re.center.lng),i.aA(re.center.lat)],Ae=[];for(let qe=0;qe<y.length;qe++){const Ue=y[qe],Qe=l.getTile(Ue),Ke=Qe.getBucket(d);if(!Ke||Ke.projection.name!==re.projection.name)continue;const Ze=Ke.programConfigurations.get(d.id),He=i.cY(d),Xe=g.isTileAffectedByFog(Ue);ge&&He.push("PROJECTION_GLOBE_VIEW"),He.push("DEPTH_D24"),g.terrain&&re.depthOcclusionForSymbolsAndCircles&&He.push("DEPTH_OCCLUSION");const at=g.getOrCreateProgram("circle",{config:Ze,defines:He,overrideFog:Xe}),_t=Ke.layoutVertexBuffer,mt=Ke.globeExtVertexBuffer,kt=Ke.indexBuffer,Pt=re.projection.createInversionMatrix(re,Ue.canonical),ht={programConfiguration:Ze,program:at,layoutVertexBuffer:_t,globeExtVertexBuffer:mt,indexBuffer:kt,uniformValues:i.cZ(g,Ue,Qe,Pt,Te,d),tile:Qe};if(F){const Tt=Ke.segments.get();for(const $t of Tt)Ae.push({segments:new i.b7([$t]),sortKey:$t.sortKey,state:ht})}else Ae.push({segments:Ke.segments,sortKey:0,state:ht})}F&&Ae.sort((qe,Ue)=>qe.sortKey-Ue.sortKey);const Re={useDepthForOcclusion:re.depthOcclusionForSymbolsAndCircles};for(const qe of Ae){const{programConfiguration:Ue,program:Qe,layoutVertexBuffer:Ke,globeExtVertexBuffer:Ze,indexBuffer:He,uniformValues:Xe,tile:at}=qe.state,_t=qe.segments;g.terrain&&g.terrain.setupElevationDraw(at,Qe,Re),g.uploadCommonUniforms(Z,Qe,at.tileID.toUnwrapped()),Qe.draw(g,Y.TRIANGLES,ne,oe,_e,Jr.disabled,Xe,d.id,Ke,He,_t,d.paint,re.zoom,Ue,[Ze])}},heatmap:function(g,l,d,y){if(d.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const N=g.context,j=N.gl,C=Wr.disabled,F=new kn([j.ONE,j.ONE,j.ONE,j.ONE],i.aj.transparent,[!0,!0,!0,!0]);(function(oe,_e,ge,Te){const Ae=oe.gl,Re=_e.width*Te,qe=_e.height*Te;oe.activeTexture.set(Ae.TEXTURE1),oe.viewport.set([0,0,Re,qe]);let Ue=ge.heatmapFbo;if(!Ue||Ue&&(Ue.width!==Re||Ue.height!==qe)){Ue&&Ue.destroy();const Qe=Ae.createTexture();Ae.bindTexture(Ae.TEXTURE_2D,Qe),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_WRAP_S,Ae.CLAMP_TO_EDGE),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_WRAP_T,Ae.CLAMP_TO_EDGE),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_MIN_FILTER,Ae.LINEAR),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_MAG_FILTER,Ae.LINEAR),Ue=ge.heatmapFbo=oe.createFramebuffer(Re,qe,!0,null),function(Ke,Ze,He,Xe,at,_t){const mt=Ke.gl;mt.texImage2D(mt.TEXTURE_2D,0,Ke.extRenderToTextureHalfFloat?mt.RGBA16F:mt.RGBA,at,_t,0,mt.RGBA,Ke.extRenderToTextureHalfFloat?mt.HALF_FLOAT:mt.UNSIGNED_BYTE,null),Xe.colorAttachment.set(He)}(oe,0,Qe,Ue,Re,qe)}else Ae.bindTexture(Ae.TEXTURE_2D,Ue.colorAttachment.get()),oe.bindFramebuffer.set(Ue.framebuffer)})(N,g,d,g.transform.projection.name==="globe"?.5:.25),N.clear({color:i.aj.transparent});const W=g.transform,Z=W.projection.name==="globe",Y=Z?["PROJECTION_GLOBE_VIEW"]:[],re=Z?Jr.frontCCW:Jr.disabled,ne=[i.at(W.center.lng),i.aA(W.center.lat)];for(let oe=0;oe<y.length;oe++){const _e=y[oe];if(l.hasRenderableParent(_e))continue;const ge=l.getTile(_e),Te=ge.getBucket(d);if(!Te||Te.projection.name!==W.projection.name)continue;const Ae=g.isTileAffectedByFog(_e),Re=Te.programConfigurations.get(d.id),qe=g.getOrCreateProgram("heatmap",{config:Re,defines:Y,overrideFog:Ae}),{zoom:Ue}=g.transform;g.terrain&&g.terrain.setupElevationDraw(ge,qe),g.uploadCommonUniforms(N,qe,_e.toUnwrapped());const Qe=W.projection.createInversionMatrix(W,_e.canonical);qe.draw(g,j.TRIANGLES,zr.disabled,C,F,re,mr(g,_e,ge,Qe,ne,Ue,d.paint.get("heatmap-intensity")),d.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,d.paint,g.transform.zoom,Re,Z?[Te.globeExtVertexBuffer]:null)}N.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(N,j){const C=N.context,F=C.gl,W=j.heatmapFbo;if(!W)return;C.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,W.colorAttachment.get()),C.activeTexture.set(F.TEXTURE1);let Z=j.colorRampTexture;Z||(Z=j.colorRampTexture=new i.T(C,j.colorRamp,F.RGBA8)),Z.bind(F.LINEAR,F.CLAMP_TO_EDGE),N.getOrCreateProgram("heatmapTexture").draw(N,F.TRIANGLES,zr.disabled,Wr.disabled,N.colorModeForRenderPass(),Jr.disabled,((Y,re,ne,oe)=>({u_image:0,u_color_ramp:1,u_opacity:re.paint.get("heatmap-opacity")}))(0,j),j.id,N.viewportBuffer,N.quadTriangleIndexBuffer,N.viewportSegments,j.paint,N.transform.zoom)}(g,d))},line:function(g,l,d,y){if(g.renderPass!=="translucent")return;const N=d.paint.get("line-opacity"),j=d.paint.get("line-width");if(N.constantOr(1)===0||j.constantOr(1)===0)return;const C=d.paint.get("line-emissive-strength"),F=d.paint.get("line-occlusion-opacity"),W=d.layout.get("line-elevation-reference"),Z=d.layout.get("line-width-unit")==="meters",Y=W==="sea",re=g.context,ne=re.gl;if(d.hasElevatedBuckets&&g.transform.projection.name==="globe")return;const oe=d.layout.get("line-cross-slope"),_e=oe!==void 0,ge=oe<1,Te=g.colorModeForDrapableLayerRenderPass(C),Ae=g.terrain&&g.terrain.renderingToTexture,Re=Ae?1:i.q.devicePixelRatio,qe=d.paint.get("line-dasharray"),Ue=qe.constantOr(1),Qe=d.layout.get("line-cap"),Ke=qe.constantOr(null),Ze=Qe.constantOr(null),He=d.paint.get("line-pattern"),Xe=He.constantOr(1),at=He.constantOr(null),_t=d.paint.get("line-opacity").constantOr(1);let mt=!Xe&&_t!==1||g.depthOcclusion&&F>0&&F<1;const kt=d.paint.get("line-gradient"),Pt=Xe?"linePattern":"line",ht=i.c_(d);let Tt;if(Ae&&g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(mt=!1),F!==0&&g.depthOcclusion){const pt=d.paint._values["line-opacity"];pt&&pt.value&&pt.value.kind==="constant"?Tt=pt.value:i.w(`Occlusion opacity for layer ${d.id} is supported only when line-opacity isn't data-driven.`)}j.value.kind!=="constant"&&j.value.isLineProgressConstant===!1&&ht.push("VARIABLE_LINE_WIDTH");const $t=(pt,Lt,jt,Xt,Vt)=>{for(const It of pt){const Ht=l.getTile(It);if(Xe&&!Ht.patternsLoaded())continue;const tr=Ht.getBucket(d);if(!tr||tr.hasZOffset&&!Vt||!tr.hasZOffset&&Vt)continue;g.prepareDrawTile();const gr=tr.programConfigurations.get(d.id),xr=g.isTileAffectedByFog(It),qr=g.getOrCreateProgram(Pt,{config:gr,defines:Lt,overrideFog:xr,overrideRtt:!Vt&&void 0});if(at&&Ht.imageAtlas){const Qr=i.A.from(at).getPrimary().scaleSelf(Re).serialize(),jn=Ht.imageAtlas.patternPositions[Qr];jn&&gr.setConstantPatternPositions(jn)}if(!Xe&&Ke&&Ze&&Ht.lineAtlas){const Qr=Ht.lineAtlas.getDash(Ke,Ze);Qr&&gr.setConstantPatternPositions(Qr)}let[Or,Lr]=d.paint.get("line-trim-offset");(Ze==="round"||Ze==="square")&&Or!==Lr&&(Or===0&&(Or-=1),Lr===1&&(Lr+=1));const Zr=Ae?It.projMatrix:null,Ln=Z?1/tr.tileToMeter/i.ar(Ht,1,g.transform.zoom):1,ui=Z?1/tr.tileToMeter/i.ar(Ht,1,Math.floor(g.transform.zoom)):1,Wi=Xe?i.c$(g,Ht,d,Zr,Re,Ln,ui,[Or,Lr]):i.d0(g,Ht,d,Zr,tr.lineClipsArray.length,Re,Ln,ui,[Or,Lr]);if(kt){const Qr=tr.gradients[d.id];let jn=Qr.texture;if(d.gradientVersion!==Qr.version){let wr=256;if(d.stepInterpolant){const In=l.getSource().maxzoom,Qn=It.canonical.z===In?Math.ceil(1<<g.transform.maxZoom-It.canonical.z):1;wr=i.aw(i.d1(tr.maxLineLength/i.ag*1024*Qn),256,re.maxTextureSize)}Qr.gradient=i.d2({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:wr,image:Qr.gradient||void 0,clips:tr.lineClipsArray}),Qr.texture?Qr.texture.update(Qr.gradient):Qr.texture=new i.T(re,Qr.gradient,ne.RGBA8),Qr.version=d.gradientVersion,jn=Qr.texture}re.activeTexture.set(ne.TEXTURE1),jn.bind(d.stepInterpolant?ne.NEAREST:ne.LINEAR,ne.CLAMP_TO_EDGE)}Ue&&(re.activeTexture.set(ne.TEXTURE0),Ht.lineAtlasTexture&&Ht.lineAtlasTexture.bind(ne.LINEAR,ne.REPEAT),gr.updatePaintBuffers()),Xe&&(re.activeTexture.set(ne.TEXTURE0),Ht.imageAtlasTexture&&Ht.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),gr.updatePaintBuffers()),Vt&&!Y&&g.terrain.setupElevationDraw(Ht,qr),g.uploadCommonUniforms(re,qr,It.toUnwrapped());const Zn=Qr=>{Tt!=null&&(Tt.value=_t*F),qr.draw(g,ne.TRIANGLES,jt,Qr,Te,Jr.disabled,Wi,d.id,tr.layoutVertexBuffer,tr.indexBuffer,tr.segments,d.paint,g.transform.zoom,gr,[tr.layoutVertexBuffer2,tr.patternVertexBuffer,tr.zOffsetVertexBuffer]),Tt!=null&&(Tt.value=_t)};if(mt&&!Vt){const Qr=g.stencilModeForClipping(It).ref;Qr===0&&Ae&&re.clear({stencil:0});const jn={func:ne.EQUAL,mask:255};Wi.u_alpha_discard_threshold=.8,Zn(new Wr(jn,Qr,255,ne.KEEP,ne.KEEP,ne.INVERT)),Wi.u_alpha_discard_threshold=0,Zn(new Wr(jn,Qr,255,ne.KEEP,ne.KEEP,ne.KEEP))}else mt&&Vt&&(Wi.u_alpha_discard_threshold=.001),Zn(Vt?Xt:g.stencilModeForClipping(It))}};if(d.hasNonElevatedBuckets){const pt=!Ae&&g.terrain;F!==0&&pt?i.w(`Occlusion opacity for layer ${d.id} is supported on terrain only if the layer has line-z-offset enabled.`):pt?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${d.id}.`):$t(y,ht,g.depthModeForSublayer(0,zr.ReadOnly),Wr.disabled,!1)}if(d.hasElevatedBuckets){ht.push("ELEVATED"),_e&&ht.push(ge?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),Y&&ht.push("ELEVATION_REFERENCE_SEA");const pt=mt?g.stencilModeFor3D():Wr.disabled,Lt=new zr(g.depthOcclusion?ne.GREATER:ne.LEQUAL,zr.ReadOnly,g.depthRangeFor3D);g.forceTerrainMode=!0,$t(y,ht,Lt,pt,!0),g.forceTerrainMode=!1}mt&&(g.resetStencilClippingMasks(),Ae&&re.clear({stencil:0})),F===0||g.depthOcclusion||Ae||g.layersWithOcclusionOpacity.push(g.currentLayer)},fill:function(g,l,d,y){const N=d.paint.get("fill-color"),j=d.paint.get("fill-opacity"),C=d.is3D(),F=new zr(g.context.gl.LEQUAL,zr.ReadWrite,g.depthRangeFor3D);if(j.constantOr(1)===0)return;const W=d.paint.get("fill-emissive-strength"),Z=g.colorModeForDrapableLayerRenderPass(W),Y=d.paint.get("fill-pattern"),re=g.opaquePassEnabledForLayer()&&!Y.constantOr(1)&&N.constantOr(i.aj.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===re){const ne=C?F:g.depthModeForSublayer(1,g.renderPass==="opaque"?zr.ReadWrite:zr.ReadOnly);cd(g,l,d,y,ne,Z,!1)}if(!C&&g.renderPass==="translucent"&&d.paint.get("fill-antialias")){const ne=C?F:g.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,zr.ReadOnly);cd(g,l,d,y,ne,Z,!0)}},"fill-extrusion":function(g,l,d,y){const N=d.paint.get("fill-extrusion-opacity"),j=g.context,C=j.gl,F=g.terrain,W=F&&F.renderingToTexture;if(N===0)return;const Z=g.conflationActive&&g.style.isLayerClipped(d,l.getSource()),Y=g.style.order.indexOf(d.fqid);if(Z&&function(re,ne,oe,_e,ge){for(const Te of _e){const Ae=ne.getTile(Te).getBucket(oe);Ae&&(Ae.updateReplacement(Te,re.replacementSource,ge),Ae.uploadCentroid(re.context))}}(g,l,d,y,Y),F||Z)for(const re of y){const ne=l.getTile(re).getBucket(d);ne&&dd(g.context,l,re,ne,d,F,Z)}if(g.renderPass==="shadow"&&g.shadowRenderer){const re=g.shadowRenderer;if(F&&N<.65&&d._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.a9)return;const ne=re.getShadowPassDepthMode(),oe=re.getShadowPassColorMode();ph(g,l,d,y,ne,Wr.disabled,oe,Z)}else if(g.renderPass==="translucent"){const re=!d.paint.get("fill-extrusion-pattern").constantOr(1),ne=d.paint.get("fill-extrusion-color").constantOr(i.aj.white);if(!W&&ne.a!==0){const oe=new zr(g.context.gl.LEQUAL,zr.ReadWrite,g.depthRangeFor3D);N===1&&re?ph(g,l,d,y,oe,Wr.disabled,kn.unblended,Z):(ph(g,l,d,y,oe,Wr.disabled,kn.disabled,Z),ph(g,l,d,y,oe,g.stencilModeFor3D(),g.colorModeForRenderPass(),Z),g.resetStencilClippingMasks())}if(g.style.enable3dLights()&&re&&(!F&&g.transform.projection.name!=="globe"||W)){const oe=d.paint.get("fill-extrusion-opacity"),_e=d.paint.get("fill-extrusion-ambient-occlusion-intensity"),ge=d.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),Te=d.paint.get("fill-extrusion-flood-light-intensity"),Ae=d.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Re=d.paint.get("fill-extrusion-flood-light-color").toRenderColor(Ae?null:d.lut).toArray01().slice(0,3),qe=_e>0&&ge>0,Ue=Te>0,Qe=(Ze,He,Xe)=>(1-Xe)*Ze+Xe*He,Ke=Ze=>{const He=g.depthModeForSublayer(1,zr.ReadOnly,C.LEQUAL,!0),Xe=d.paint.get(Ze?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),at=Qe(.1,3,Xe),_t=g._showOverdrawInspector;if(!_t){const mt=new Wr({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),kt=new kn([C.ONE,C.ONE,C.ONE,C.ONE],i.aj.transparent,[!1,!1,!1,!0],C.MIN);ud(g,l,d,y,He,mt,kt,Jr.disabled,Ze,"sdf",oe,_e,ge,Te,Re,at,Z,!1)}{const mt=_t?Wr.disabled:new Wr({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),kt=_t?g.colorModeForRenderPass():new kn([C.ONE_MINUS_DST_ALPHA,C.DST_ALPHA,C.ONE,C.ONE],i.aj.transparent,[!0,!0,!0,!0]);ud(g,l,d,y,He,mt,kt,Jr.disabled,Ze,"color",oe,_e,ge,Te,Re,at,Z,!1)}};if(W){const Ze=(He,Xe,at)=>{const _t=g.depthModeForSublayer(1,zr.ReadOnly,C.LEQUAL,!1),mt=d.paint.get(He?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),kt=Qe(.1,3,mt);{const Pt=new kn([C.ONE,C.ONE,C.ONE,C.ONE],i.aj.transparent,[!1,!1,!1,!0]);ud(g,l,d,y,_t,Wr.disabled,Pt,Jr.disabled,He,"clear",oe,_e,ge,Te,Re,kt,Z,Xe)}{const Pt=new Wr({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),ht=new kn([C.ONE,C.ONE,C.ONE,C.ONE],i.aj.transparent,[!1,!1,!1,!0],C.MIN);ud(g,l,d,y,_t,Pt,ht,Jr.disabled,He,"sdf",oe,_e,ge,Te,Re,kt,Z,Xe)}{const Pt=He?C.ZERO:C.ONE_MINUS_DST_ALPHA,ht=new Wr({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),Tt=new kn([Pt,C.DST_ALPHA,C.ONE_MINUS_DST_ALPHA,C.ZERO],i.aj.transparent,[!0,!0,!0,!0]);ud(g,l,d,y,_t,ht,Tt,Jr.disabled,He,"color",oe,_e,ge,Te,Re,kt,Z,Xe)}{const Pt=new kn([C.ONE,C.ONE,C.ONE,He?C.ZERO:C.ONE],i.aj.transparent,[!1,!1,!1,!0],He?C.FUNC_ADD:C.MAX);ud(g,l,d,y,_t,Wr.disabled,Pt,Jr.disabled,He,"clear",oe,_e,ge,Te,Re,kt,Z,Xe,at)}};if(qe||Ue){let He;if(g.prepareDrawTile(),F){const Xe=F.drapeBufferSize[0],at=F.drapeBufferSize[1];He=F.framebufferCopyTexture,He&&(!He||He.size[0]===Xe&&He.size[1]===at)||(He&&He.destroy(),He=F.framebufferCopyTexture=new i.T(j,new i.r({width:Xe,height:at}),C.RGBA8)),He.bind(C.LINEAR,C.CLAMP_TO_EDGE),C.copyTexSubImage2D(C.TEXTURE_2D,0,0,0,0,0,Xe,at)}qe&&Ze(!0,!1,He),Ue&&Ze(!1,!0,He)}}else qe&&Ke(!0),Ue&&Ke(!1),(qe||Ue)&&g.resetStencilClippingMasks()}}},hillshade:function(g,l,d,y){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent"||g.style.disableElevatedTerrain)return;const N=g.context,j=g.terrain&&g.terrain.renderingToTexture,[C,F]=g.renderPass!=="translucent"||j?[{},y]:g.stencilConfigForOverlap(y);for(const W of F){const Z=l.getTile(W);if(Z.needsHillshadePrepare&&g.renderPass==="offscreen")Rp(g,Z,d);else if(g.renderPass==="translucent"){const Y=g.depthModeForSublayer(0,zr.ReadOnly),re=d.paint.get("hillshade-emissive-strength"),ne=g.colorModeForDrapableLayerRenderPass(re),oe=j&&g.terrain?g.terrain.stencilModeForRTTOverlap(W):C[W.overscaledZ];px(g,W,Z,d,Y,oe,ne)}}N.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,l,d,y,N,j){if(g.renderPass!=="translucent"||d.paint.get("raster-opacity")===0)return;const C=g.transform.projection.name==="globe",F=d.paint.get("raster-elevation")!==0,W=F&&C;if(g.renderElevatedRasterBackface&&!W)return;const Z=g.context,Y=Z.gl,re=l.getSource(),ne=function(Ke,Ze,He,Xe){const at=Ze.paint.get("raster-color"),_t=Ke.type==="raster-array",mt=[],kt=Ze.paint.get("raster-resampling"),Pt=Ze.paint.get("raster-color-mix");let ht=Ze.paint.get("raster-color-range");const Tt=[Pt[0],Pt[1],Pt[2],0],$t=Pt[3];let pt=kt==="nearest"?Xe.NEAREST:Xe.LINEAR;if(_t&&(mt.push("RASTER_ARRAY"),at||mt.push("RASTER_COLOR"),kt==="linear"&&mt.push("RASTER_ARRAY_LINEAR"),pt=Xe.NEAREST,!ht&&Ke.rasterLayers)){const Lt=Ke.rasterLayers.find(({id:jt})=>jt===Ze.sourceLayer);Lt&&Lt.fields&&Lt.fields.range&&(ht=Lt.fields.range)}if(ht=ht||[0,1],at){mt.push("RASTER_COLOR"),He.activeTexture.set(Xe.TEXTURE2),Ze.updateColorRamp(ht);let Lt=Ze.colorRampTexture;Lt||(Lt=Ze.colorRampTexture=new i.T(He,Ze.colorRamp,Xe.RGBA8)),Lt.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE)}return{mix:Tt,range:ht,offset:$t,defines:mt,resampling:pt}}(re,d,Z,Y);if(re instanceof i.aJ&&!y.length&&!C)return;const oe=d.paint.get("raster-emissive-strength"),_e=g.colorModeForDrapableLayerRenderPass(oe),ge=g.terrain&&g.terrain.renderingToTexture,Te=!g.options.moving,Ae=d.paint.get("raster-resampling")==="nearest"?Y.NEAREST:Y.LINEAR;if(re instanceof i.aJ&&!y.length&&(re.onNorthPole||re.onSouthPole)){const Ke=F?g.stencilModeFor3D():Wr.disabled;return void vt(!!re.onNorthPole,null,g,l,d,oe,ne,Jr.disabled,Ke)}if(!y.length)return;const[Re,qe]=re instanceof i.aJ||ge?[{},y]:g.stencilConfigForOverlap(y),Ue=qe[qe.length-1].overscaledZ;W&&ne.defines.push("PROJECTION_GLOBE_VIEW"),F&&ne.defines.push("RENDER_CUTOFF");const Qe=(Ke,Ze,He)=>{for(const Xe of Ke){const at=Xe.toUnwrapped(),_t=l.getTile(Xe);if(ge&&(!_t||!_t.hasData()))continue;Z.activeTexture.set(Y.TEXTURE0);const mt=dc(_t,re,d,ne);if(!mt||!mt.texture)continue;const{texture:kt,mix:Pt,offset:ht,tileSize:Tt,buffer:$t}=mt;let pt,Lt;ge?(pt=zr.disabled,Lt=Xe.projMatrix):F?(pt=new zr(Y.LEQUAL,zr.ReadWrite,g.depthRangeFor3D),Lt=C?Float32Array.from(g.transform.expandedFarZProjMatrix):g.transform.calculateProjMatrix(at,Te)):(pt=g.depthModeForSublayer(Xe.overscaledZ-Ue,d.paint.get("raster-opacity")===1?zr.ReadWrite:zr.ReadOnly,Y.LESS),Lt=g.transform.calculateProjMatrix(at,Te));const jt=g.terrain&&ge?g.terrain.stencilModeForRTTOverlap(Xe):Re[Xe.overscaledZ],Xt=j?0:d.paint.get("raster-fade-duration");_t.registerFadeDuration(Xt);const Vt=l.findLoadedParent(Xe,0),It=ql(_t,Vt,l,g.transform,Xt);let Ht,tr;g.terrain&&g.terrain.prepareDrawTile(),Z.activeTexture.set(Y.TEXTURE0),kt.bind(Ae,Y.CLAMP_TO_EDGE),Z.activeTexture.set(Y.TEXTURE1),Vt?(Vt.texture&&Vt.texture.bind(Ae,Y.CLAMP_TO_EDGE),Ht=Math.pow(2,Vt.tileID.overscaledZ-_t.tileID.overscaledZ),tr=[_t.tileID.canonical.x*Ht%1,_t.tileID.canonical.y*Ht%1]):kt.bind(Ae,Y.CLAMP_TO_EDGE),kt.useMipmap&&Z.extTextureFilterAnisotropic&&g.transform.pitch>20&&Y.texParameterf(Y.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax);const gr=g.transform;let xr;const qr=F?Bc(gr):[0,0,0,0];let Or,Lr,Zr,Ln,ui,Wi=0;if(W&&re instanceof i.aJ&&re.coordinates.length>3)Or=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0)))),Lr=Float32Array.from(gr.globeMatrix),Zr=Float32Array.from(i.cD(gr)),Ln=[i.at(gr.center.lng),i.aA(gr.center.lat)],xr=re.elevatedGlobePerspectiveTransform,ui=re.elevatedGlobeGridMatrix||new Float32Array(9);else if(W){const wr=i.cE(Xe.canonical);Wi=i.cF(wr.getCenter().lat),Or=Float32Array.from(i.bb(i.cH(Xe.canonical))),Lr=Float32Array.from(gr.globeMatrix),Zr=Float32Array.from(i.cD(gr)),Ln=[i.at(gr.center.lng),i.aA(gr.center.lat)],xr=[0,0],ui=Float32Array.from(i.cG(Xe.canonical,wr,Wi,gr.worldSize/gr._pixelsPerMercatorPixel))}else xr=re instanceof i.aJ?re.perspectiveTransform:[0,0],Or=new Float32Array(16),Lr=new Float32Array(9),Zr=new Float32Array(16),Ln=[0,0],ui=new Float32Array(9);const Zn=_o(Lt,Or,Lr,Zr,ui,tr||[0,0],i.ae(g.transform.zoom),Ln,qr,Ht||1,It,d,xr,F?d.paint.get("raster-elevation"):0,2,Pt,ht,ne.range,Tt,$t,oe),Qr=g.isTileAffectedByFog(Xe),jn=g.getOrCreateProgram("raster",{defines:ne.defines,overrideFog:Qr});if(g.uploadCommonUniforms(Z,jn,at),re instanceof i.aJ){const wr=re.elevatedGlobeVertexBuffer,In=re.elevatedGlobeIndexBuffer;if(ge||!C)re.boundsBuffer&&re.boundsSegments&&jn.draw(g,Y.TRIANGLES,pt,Wr.disabled,_e,Jr.disabled,Zn,d.id,re.boundsBuffer,g.quadTriangleIndexBuffer,re.boundsSegments);else if(wr&&In){const Qn=gr.zoom<=i.c6?re.elevatedGlobeSegments:re.getSegmentsForLongitude(gr.center.lng);Qn&&jn.draw(g,Y.TRIANGLES,pt,Wr.disabled,_e,Ze,Zn,d.id,wr,In,Qn)}}else if(W){pt=new zr(Y.LEQUAL,zr.ReadOnly,g.depthRangeFor3D);const wr=g.globeSharedBuffers;if(wr){const[In,Qn,ai]=wr.getGridBuffers(Wi,!1);jn.draw(g,Y.TRIANGLES,pt,He||jt,g.colorModeForRenderPass(),Ze,Zn,d.id,In,Qn,ai)}}else{const{tileBoundsBuffer:wr,tileBoundsIndexBuffer:In,tileBoundsSegments:Qn}=g.getTileBoundsBuffers(_t);jn.draw(g,Y.TRIANGLES,pt,jt,_e,Jr.disabled,Zn,d.id,wr,In,Qn)}}if(!(re instanceof i.aJ)&&W)for(const Xe of Ke){const at=Xe.canonical.y===(1<<Xe.canonical.z)-1;Xe.canonical.y===0&&vt(!0,Xe,g,l,d,oe,ne,Ze,He||Wr.disabled),at&&vt(!1,Xe,g,l,d,oe,ne,Ze===Jr.frontCW?Jr.backCW:Jr.frontCW,He||Wr.disabled)}};W?Qe(qe,g.renderElevatedRasterBackface?Jr.backCW:Jr.frontCW,g.stencilModeFor3D()):Qe(qe,Jr.disabled,void 0),g.resetStencilClippingMasks()},"raster-particle":function(g,l,d,y,N,j){g.renderPass==="offscreen"&&function(C,F,W,Z){if(!Z.length)return;const Y=C.context,re=Y.gl,ne=F.getSource();if(!(ne instanceof Ka))return;const oe=Math.ceil(Math.sqrt(W.paint.get("raster-particle-count")));let _e=W.particlePositionRGBAImage;if(!_e||_e.width!==oe){const qe=function(Ue){const Qe=Ue*Ue,Ke=new Uint8Array(4*Qe),Ze=function(Xe){return Xe|=0,Xe=Math.imul(2747636419^Xe,2654435769),Xe=Math.imul(Xe^Xe>>>16,2654435769),((Xe=Math.imul(Xe^Xe>>>16,2654435769))>>>0)/4294967296},He=1/1.1;for(let Xe=0;Xe<Qe;Xe++){const at=He*(Ze(2*Xe+0)+Er),_t=He*(Ze(2*Xe+1)+Er),mt=255*at%1,kt=255*_t%1,Pt=mt,ht=_t-kt/255,Tt=kt;Ke[4*Xe+0]=255*(at-mt/255),Ke[4*Xe+1]=255*Pt,Ke[4*Xe+2]=255*ht,Ke[4*Xe+3]=255*Tt}return Ke}(oe);_e=W.particlePositionRGBAImage=new i.r({width:oe,height:oe},qe)}let ge=W.particleFramebuffer;ge?ge.width!==oe&&(ge.destroy(),ge=W.particleFramebuffer=Y.createFramebuffer(oe,oe,!0,null)):ge=W.particleFramebuffer=Y.createFramebuffer(oe,oe,!0,null);const Te=[];for(const qe of Z){const Ue=F.getTile(qe);if(!(Ue instanceof au))continue;const Qe=Vc(Ue,ne,W);if(!Qe)continue;const Ke=[Ue.tileSize,Ue.tileSize];let Ze=W.tileFramebuffer;Ze||(Ze=W.tileFramebuffer=Y.createFramebuffer(Ke[0],Ke[1],!0,null));let He=Ue.rasterParticleState;He||(He=Ue.rasterParticleState=new zy(Y,qe,Ke,_e));const Xe=He.update(W.lastInvalidatedAt);He.particleTextureDimension!==oe&&He.updateParticleTexture(qe,_e);const at=He.targetColorTexture;He.targetColorTexture=He.backgroundColorTexture,He.backgroundColorTexture=at;const _t=He.particleTexture0;He.particleTexture0=He.particleTexture1,He.particleTexture1=_t,Te.push([qe,Qe,He,Xe])}if(Te.length===0)return;const Ae=i.q.now(),Re=W.previousDrawTimestamp?.001*(Ae-W.previousDrawTimestamp):.0167;if(W.previousDrawTimestamp=Ae,W.hasColorMap()){Y.activeTexture.set(re.TEXTURE0+2);let qe=W.colorRampTexture;qe||(qe=W.colorRampTexture=new i.T(Y,W.colorRamp,re.RGBA8)),qe.bind(re.LINEAR,re.CLAMP_TO_EDGE)}Y.bindFramebuffer.set(W.tileFramebuffer.framebuffer),function(qe,Ue,Qe){const Ke=qe.context,Ze=Ke.gl,He=Ue.tileFramebuffer;Ke.activeTexture.set(Ze.TEXTURE0);const Xe={u_texture:0,u_opacity:1.05*(_t=Ue.paint.get("raster-particle-fade-opacity-factor"))/(_t+.05)},at=qe.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var _t;for(const mt of Qe){const[,,kt,Pt]=mt;He.colorAttachment.set(kt.targetColorTexture.texture),Ke.viewport.set([0,0,He.width,He.height]),Ke.clear({color:i.aj.transparent}),Pt&&(kt.backgroundColorTexture.bind(Ze.NEAREST,Ze.CLAMP_TO_EDGE),at.draw(qe,Ze.TRIANGLES,zr.disabled,Wr.disabled,kn.alphaBlended,Jr.disabled,Xe,Ue.id,qe.viewportBuffer,qe.quadTriangleIndexBuffer,qe.viewportSegments))}}(C,W,Te),function(qe,Ue,Qe,Ke){const Ze=qe.context,He=Ze.gl,Xe=Qe.tileFramebuffer,at=qe.transform.projection.name==="globe",_t=Qe.paint.get("raster-particle-max-speed");for(const mt of Ke){const[kt,Pt,ht]=mt;Ze.activeTexture.set(He.TEXTURE0+0),Pt.texture.bind(He.LINEAR,He.CLAMP_TO_EDGE),Xe.colorAttachment.set(ht.targetColorTexture.texture);const Tt=qe.getOrCreateProgram("rasterParticleDraw",{defines:Pt.defines,overrideFog:!1});Ze.activeTexture.set(He.TEXTURE0+1);const $t=Pt.scalarData?[]:[0,1,2,3].map(jt=>i.d4[jt](kt));$t.push(kt);const pt=kt.canonical.x,Lt=kt.canonical.y;for(const jt of $t){const Xt=Ue.getTile(at?jt.wrapped():jt);if(!Xt)continue;const Vt=Xt.rasterParticleState;if(!Vt)continue;const It=jt.canonical.x+(1<<jt.canonical.z)*(jt.wrap-kt.wrap),Ht=jt.canonical.y;Vt.particleTexture0.bind(He.NEAREST,He.CLAMP_TO_EDGE);const tr=Ly(1,Vt.particleTexture0.size[0],[It-pt,Ht-Lt],0,Pt.texture.size,2,_t,Pt.textureOffset,Pt.scale,Pt.offset);Tt.draw(qe,He.POINTS,zr.disabled,Wr.disabled,kn.alphaBlended,Jr.disabled,tr,Qe.id,Vt.particleIndexBuffer,void 0,Vt.particleSegment)}}}(C,F,W,Te),Y.bindFramebuffer.set(W.particleFramebuffer.framebuffer),function(qe,Ue,Qe,Ke){const Ze=qe.context,He=Ze.gl,Xe=Ue.paint.get("raster-particle-max-speed"),at=Ke*Ue.paint.get("raster-particle-speed-factor")*.15,_t=function(kt){return Math.pow(kt,6)}(.01+1*Ue.paint.get("raster-particle-reset-rate-factor")),mt=Ue.particleFramebuffer;Ze.viewport.set([0,0,mt.width,mt.height]);for(const kt of Qe){const[,Pt,ht]=kt;Ze.activeTexture.set(He.TEXTURE0+0),Pt.texture.bind(He.LINEAR,He.CLAMP_TO_EDGE),Ze.activeTexture.set(He.TEXTURE0+1);const Tt=ht.particleTexture0;Tt.bind(He.NEAREST,He.CLAMP_TO_EDGE);const $t=Sl(1,Tt.size[0],0,Pt.texture.size,Xe,at,_t,Pt.textureOffset,Pt.scale,Pt.offset);mt.colorAttachment.set(ht.particleTexture1.texture),Ze.clear({color:i.aj.transparent}),qe.getOrCreateProgram("rasterParticleUpdate",{defines:Pt.defines}).draw(qe,He.TRIANGLES,zr.disabled,Wr.disabled,kn.unblended,Jr.disabled,$t,Ue.id,qe.viewportBuffer,qe.quadTriangleIndexBuffer,qe.viewportSegments)}}(C,W,Te,Re)}(g,l,d,y),g.renderPass==="translucent"&&(function(C,F,W,Z,Y){const re=C.context,ne=re.gl,oe=F.getSource().tileSize,_e=5*(1-i.ac(i.bY,i.bY+1,C.transform.zoom))*oe+W.paint.get("raster-particle-elevation"),ge=!C.options.moving,Te=C.transform.projection.name==="globe";if(!Z.length)return;const[Ae,Re]=C.stencilConfigForOverlap(Z),qe=[];Te&&qe.push("PROJECTION_GLOBE_VIEW");const Ue=C.stencilModeFor3D();for(const Qe of Re){const Ke=Qe.toUnwrapped(),Ze=F.getTile(Qe);if(!Ze.rasterParticleState)continue;const He=Ze.rasterParticleState,Xe=100;Ze.registerFadeDuration(Xe);const at=F.findLoadedParent(Qe,0),_t=ql(Ze,at,F,C.transform,Xe);let mt,kt;C.terrain&&C.terrain.prepareDrawTile(),re.activeTexture.set(ne.TEXTURE0),He.targetColorTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),re.activeTexture.set(ne.TEXTURE1),at&&at.rasterParticleState?(at.rasterParticleState.targetColorTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),mt=Math.pow(2,at.tileID.overscaledZ-Ze.tileID.overscaledZ),kt=[Ze.tileID.canonical.x*mt%1,Ze.tileID.canonical.y*mt%1]):He.targetColorTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE);const Pt=Te?Float32Array.from(C.transform.expandedFarZProjMatrix):C.transform.calculateProjMatrix(Ke,ge),ht=C.transform,Tt=xu(ht),$t=i.cE(Qe.canonical),pt=i.cF($t.getCenter().lat);let Lt,jt,Xt,Vt,It;Te?(Lt=Float32Array.from(i.bb(i.cH(Qe.canonical))),jt=Float32Array.from(ht.globeMatrix),Xt=Float32Array.from(i.cD(ht)),Vt=[i.at(ht.center.lng),i.aA(ht.center.lat)],It=Float32Array.from(i.cG(Qe.canonical,$t,pt,ht.worldSize/ht._pixelsPerMercatorPixel))):(Lt=new Float32Array(16),jt=new Float32Array(9),Xt=new Float32Array(16),Vt=[0,0],It=new Float32Array(9));const Ht=Vp(Pt,Lt,jt,Xt,It,kt||[0,0],i.ae(C.transform.zoom),Vt,Tt,mt||1,_t,_e),tr=C.isTileAffectedByFog(Qe),gr=C.getOrCreateProgram("rasterParticle",{defines:qe,overrideFog:tr});if(C.uploadCommonUniforms(re,gr,Ke),Te){const xr=new zr(ne.LEQUAL,zr.ReadOnly,C.depthRangeFor3D),qr=0,Or=C.globeSharedBuffers;if(Or){const[Lr,Zr,Ln]=Or.getGridBuffers(pt,qr!==0);gr.draw(C,ne.TRIANGLES,xr,Ue,kn.alphaBlended,C.renderElevatedRasterBackface?Jr.frontCCW:Jr.backCCW,Ht,W.id,Lr,Zr,Ln)}}else{const xr=C.depthModeForSublayer(0,zr.ReadOnly),qr=Ae[Qe.overscaledZ],{tileBoundsBuffer:Or,tileBoundsIndexBuffer:Lr,tileBoundsSegments:Zr}=C.getTileBoundsBuffers(Ze);gr.draw(C,ne.TRIANGLES,xr,qr,kn.alphaBlended,Jr.disabled,Ht,W.id,Or,Lr,Zr)}}C.resetStencilClippingMasks()}(g,l,d,y),g.style.map.triggerRepaint())},background:function(g,l,d,y){const N=d.paint.get("background-color"),j=d.paint.get("background-color-use-theme").constantOr("default")==="none",C=d.paint.get("background-opacity"),F=d.paint.get("background-emissive-strength"),W=d.paint.get("background-pitch-alignment")==="viewport";if(C===0)return;const Z=g.context,Y=Z.gl,re=g.transform,ne=re.tileSize,oe=d.paint.get("background-pattern");let _e;if(oe!==void 0&&(oe===null||(_e=g.imageManager.getPattern(oe.toString(),d.scope,g.style.getLut(d.scope)),!_e)))return;const ge=!oe&&N.a===1&&C===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==ge)return;const Te=Wr.disabled,Ae=g.depthModeForSublayer(0,ge==="opaque"?zr.ReadWrite:zr.ReadOnly),Re=g.colorModeForDrapableLayerRenderPass(F),qe=oe?"backgroundPattern":"background";let Ue,Qe=y;if(Qe||(Ue=g.getBackgroundTiles(),Qe=Object.values(Ue).map(Ke=>Ke.tileID)),oe&&(Z.activeTexture.set(Y.TEXTURE0),g.imageManager.bind(g.context,d.scope)),W){const Ke=g.getOrCreateProgram(qe,{overrideFog:!1,overrideRtt:!0}),Ze=new Float32Array(i.ab.mat4.identity([])),He=new i.aG(0,0,0,0,0),Xe=oe?Dy(Ze,F,C,g,0,d.scope,_e,W,{tileID:He,tileSize:ne}):Nl(Ze,F,C,N.toRenderColor(j?null:d.lut));Ke.draw(g,Y.TRIANGLES,Ae,Te,Re,Jr.disabled,Xe,d.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments)}else for(const Ke of Qe){const Ze=g.isTileAffectedByFog(Ke),He=g.getOrCreateProgram(qe,{overrideFog:Ze}),Xe=Ke.toUnwrapped(),at=y?Ke.projMatrix:g.transform.calculateProjMatrix(Xe);g.prepareDrawTile();const _t=l?l.getTile(Ke):Ue?Ue[Ke.key]:new Pc(Ke,ne,re.zoom,g),mt=oe?Dy(at,F,C,g,0,d.scope,_e,W,{tileID:Ke,tileSize:ne}):Nl(at,F,C,N.toRenderColor(j?null:d.lut));g.uploadCommonUniforms(Z,He,Xe);const{tileBoundsBuffer:kt,tileBoundsIndexBuffer:Pt,tileBoundsSegments:ht}=g.getTileBoundsBuffers(_t);He.draw(g,Y.TRIANGLES,Ae,Te,Re,Jr.disabled,mt,d.id,kt,Pt,ht)}},sky:function(g,l,d){const y=g._atmosphere?i.ae(g.transform.zoom):1,N=d.paint.get("sky-opacity")*y;if(N===0)return;const j=g.context,C=d.paint.get("sky-type"),F=new zr(j.gl.LEQUAL,zr.ReadOnly,[0,1]),W=g.frameCounter/1e3%1;C==="atmosphere"?g.renderPass==="offscreen"?d.needsSkyboxCapture(g)&&(function(Z,Y,re,ne){const oe=Z.context,_e=oe.gl;let ge=Y.skyboxFbo;if(!ge){ge=Y.skyboxFbo=oe.createFramebuffer(32,32,!0,null),Y.skyboxGeometry=new lg(oe),Y.skyboxTexture=oe.gl.createTexture(),_e.bindTexture(_e.TEXTURE_CUBE_MAP,Y.skyboxTexture),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_WRAP_S,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_WRAP_T,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_MIN_FILTER,_e.LINEAR),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_MAG_FILTER,_e.LINEAR);for(let qe=0;qe<6;++qe)_e.texImage2D(_e.TEXTURE_CUBE_MAP_POSITIVE_X+qe,0,_e.RGBA,32,32,0,_e.RGBA,_e.UNSIGNED_BYTE,null)}oe.bindFramebuffer.set(ge.framebuffer),oe.viewport.set([0,0,32,32]);const Te=Y.getCenter(Z,!0),Ae=Z.getOrCreateProgram("skyboxCapture"),Re=new Float64Array(16);i.ab.mat4.identity(Re),i.ab.mat4.rotateY(Re,Re,.5*-Math.PI),hi(Z,Y,Ae,Re,Te,0),i.ab.mat4.identity(Re),i.ab.mat4.rotateY(Re,Re,.5*Math.PI),hi(Z,Y,Ae,Re,Te,1),i.ab.mat4.identity(Re),i.ab.mat4.rotateX(Re,Re,.5*-Math.PI),hi(Z,Y,Ae,Re,Te,2),i.ab.mat4.identity(Re),i.ab.mat4.rotateX(Re,Re,.5*Math.PI),hi(Z,Y,Ae,Re,Te,3),i.ab.mat4.identity(Re),hi(Z,Y,Ae,Re,Te,4),i.ab.mat4.identity(Re),i.ab.mat4.rotateY(Re,Re,Math.PI),hi(Z,Y,Ae,Re,Te,5),oe.viewport.set([0,0,Z.width,Z.height])}(g,d),d.markSkyboxValid(g)):g.renderPass==="sky"&&function(Z,Y,re,ne,oe){const _e=Z.context,ge=_e.gl,Te=Z.transform,Ae=Z.getOrCreateProgram("skybox");_e.activeTexture.set(ge.TEXTURE0),ge.bindTexture(ge.TEXTURE_CUBE_MAP,Y.skyboxTexture);const Re=((qe,Ue,Qe,Ke,Ze)=>({u_matrix:qe,u_sun_direction:Ue,u_cubemap:0,u_opacity:Ke,u_temporal_offset:Ze}))(Te.skyboxMatrix,Y.getCenter(Z,!1),0,ne,oe);Z.uploadCommonUniforms(_e,Ae),Ae.draw(Z,ge.TRIANGLES,re,Wr.disabled,Z.colorModeForRenderPass(),Jr.backCW,Re,"skybox",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(g,d,F,N,W):C==="gradient"&&g.renderPass==="sky"&&function(Z,Y,re,ne,oe){const _e=Z.context,ge=_e.gl,Te=Z.transform,Ae=Z.getOrCreateProgram("skyboxGradient");Y.skyboxGeometry||(Y.skyboxGeometry=new lg(_e)),_e.activeTexture.set(ge.TEXTURE0);let Re=Y.colorRampTexture;Re||(Re=Y.colorRampTexture=new i.T(_e,Y.colorRamp,ge.RGBA8)),Re.bind(ge.LINEAR,ge.CLAMP_TO_EDGE);const qe=((Ue,Qe,Ke,Ze,He)=>({u_matrix:Ue,u_color_ramp:0,u_center_direction:Qe,u_radius:i.ai(Ke),u_opacity:Ze,u_temporal_offset:He}))(Te.skyboxMatrix,Y.getCenter(Z,!1),Y.paint.get("sky-gradient-radius"),ne,oe);Z.uploadCommonUniforms(_e,Ae),Ae.draw(Z,ge.TRIANGLES,re,Wr.disabled,Z.colorModeForRenderPass(),Jr.backCW,qe,"skyboxGradient",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(g,d,F,N,W)},debug:function(g,l,d,y,N,j){for(let C=0;C<d.length;C++)if(N){const Z=new i.aj(y.r*.8,y.g*.8,y.b*.8,1);io(g,l,d[C],y,-1,-1,j),io(g,l,d[C],y,-1,1,j),io(g,l,d[C],y,1,1,j),io(g,l,d[C],y,1,-1,j),io(g,l,d[C],Z,0,0,j)}else io(g,l,d[C],y,0,0,j)},custom:function(g,l,d,y){const N=g.context,j=d.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&d.isDraped(l)){if(g.renderPass==="offscreen"){const C=j.prerender;if(C){if(g.setCustomLayerDefaults(),N.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const F=g.transform.pointMerc;C.call(j,N.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),i.ae(g.transform.zoom),[F.x,F.y],g.transform.pixelsPerMeterRatio)}else C.call(j,N.gl,g.transform.customLayerMatrix());N.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const F=j.renderToTile;if(F){const W=y[0].canonical,Z=new i.aa(W.x+y[0].wrap*(1<<W.z),W.y,W.z);N.setDepthMode(zr.disabled),N.setStencilMode(Wr.disabled),N.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),F.call(j,N.gl,Z),N.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),N.setColorMode(g.colorModeForRenderPass()),N.setStencilMode(Wr.disabled);const C=j.renderingMode==="3d"?new zr(g.context.gl.LEQUAL,zr.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,zr.ReadOnly);if(N.setDepthMode(C),g.transform.projection.name==="globe"){const F=g.transform.pointMerc;j.render(N.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),i.ae(g.transform.zoom),[F.x,F.y],g.transform.pixelsPerMeterRatio)}else j.render(N.gl,g.transform.customLayerMatrix());N.setDirty(),g.setBaseState(),N.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(g,l,d,y){if(g.renderPass==="opaque")return;const N=d.paint.get("model-opacity").constantOr(1);if(N===0)return;const j=d.paint.get("model-cast-shadows");if(g.renderPass==="shadow"&&(!j||g.terrain&&N<.65&&d._transitionablePaint._values["model-opacity"].value.expression instanceof i.a9))return;const C=g.shadowRenderer,F=d.paint.get("model-receive-shadows");C&&(C.useNormalOffset=!0,F||(C.enabled=!1));const W=()=>{C&&(C.useNormalOffset=!0,F||(C.enabled=!0))},Z=l.getSource();if(g.renderPass==="light-beam"&&Z.type!=="batched-model")return;if(Z.type==="vector"||Z.type==="geojson")return function(Ae,Re,qe,Ue,Qe){const Ke=Ae.transform;if(Ke.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Ke.projection.name} projection is not yet implemented`);const Ze=Ke.getFreeCameraOptions().position;if(!Ae.modelManager)return;const He=Ae.modelManager;qe.modelManager=He;const Xe=Ae.shadowRenderer;if(!qe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const at=qe._unevaluatedLayout._values["model-id"],_t=Object.assign({},qe.layout.get("model-id").parameters),mt=Ae.style.order.indexOf(qe.fqid);for(const kt of Ue){const Pt=Re.getTile(kt).getBucket(qe);if(!Pt||Pt.projection.name!==Ke.projection.name)continue;const ht=Pt.getModelUris();ht&&!Pt.modelsRequested&&(He.addModelsFromBucket(ht,Qe),Pt.modelsRequested=!0);const Tt=dg(kt,Ke);_t.zoom=Tt;const $t=at.possiblyEvaluate(_t);if(rl(Ae,Pt,kt),us.shadowUniformsInitialized=!1,us.useSingleShadowCascade=!!Xe&&Xe.getMaxCascadeForTile(kt.toUnwrapped())===0,Ae.renderPass==="shadow"&&Xe){if(Ae.currentShadowCascade===1&&Pt.isInsideFirstShadowMapFrustum)continue;const jt=Ke.calculatePosMatrix(kt.toUnwrapped(),Ke.worldSize);if(us.tileMatrix.set(jt),us.shadowTileMatrix=Float32Array.from(Xe.calculateShadowPassMatrixFromMatrix(jt)),us.aabb.min.fill(0),us.aabb.max[0]=us.aabb.max[1]=i.ag,us.aabb.max[2]=0,Wp(Pt,us,Ae,qe.scope))continue}const pt=1<<kt.canonical.z,Lt=[((Ze.x-kt.wrap)*pt-kt.canonical.x)*i.ag,(Ze.y*pt-kt.canonical.y)*i.ag,Ze.z*pt*i.ag];Ae.conflationActive&&Object.keys(Pt.instancesPerModel).length>0&&Ae.style.isLayerClipped(qe,Re.getSource())&&Pt.updateReplacement(kt,Ae.replacementSource,mt,Qe)&&(Pt.uploaded=!1,Pt.upload(Ae.context));for(let jt in Pt.instancesPerModel){const Xt=Pt.instancesPerModel[jt];Xt.features.length>0&&(jt=$t.evaluate(Xt.features[0].feature,{}));const Vt=He.getModel(jt,Qe);if(Vt&&Vt.uploaded)for(const It of Vt.nodes)_s(Ae,qe,It,Xt,Lt,kt,us)}}}(g,l,d,y,Z.type==="vector"?d.scope:""),void W();if(!Z.loaded())return;if(Z.type==="batched-model")return function(Ae,Re,qe,Ue){qe.resetLayerRenderingStats(Ae);const Qe=Ae.context,Ke=Ae.transform,Ze=Ae.style.fog,He=Ae.shadowRenderer;if(Ke.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Ke.projection.name} projection is not yet implemented`);const Xe=Ae.transform.getFreeCameraOptions().position,at=i.ab.vec3.scale([],[Xe.x,Xe.y,Xe.z],Ae.transform.worldSize),_t=i.ab.vec3.negate([],at),mt=i.ab.mat4.identity([]),kt=i.dj(Ke.center.lat,Ke.zoom),Pt=i.ab.mat4.fromScaling([],[1,1,1/kt]);i.ab.mat4.translate(mt,mt,_t);const ht=qe.paint.get("model-opacity").constantOr(1),Tt=new zr(Qe.gl.LEQUAL,zr.ReadWrite,Ae.depthRangeFor3D),$t=new zr(Qe.gl.LEQUAL,zr.ReadOnly,Ae.depthRangeFor3D),pt=new i.cd([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Lt=Ae.renderPass==="shadow",jt=Lt&&He?He.getCurrentCascadeFrustum():Ke.getFrustum(Ke.scaleZoom(Ke.worldSize)),Xt=qe.paint.get("model-front-cutoff"),Vt=Xt[2]<1,It=Bl(Ae,qe.paint.get("model-cutoff-fade-range")),Ht=qe.getLayerRenderingStats();(function(tr,gr,xr,qr){const Or=tr.terrain?tr.terrain.exaggeration():0,Lr=tr.transform.zoom;for(const Zr of qr){const Ln=gr.getTile(Zr).getBucket(xr);Ln&&(tr.conflationActive&&Ln.updateReplacement(Zr,tr.replacementSource),Ln.evaluateScale(tr,xr),tr.terrain&&Or>0&&Ln.elevationUpdate(tr.terrain,Or,Zr,xr.source),Ln.needsReEvaluation(tr,Lr,xr)&&Ln.evaluate(xr))}})(Ae,Re,qe,Ue),function(){let tr,gr,xr;Vt?(tr=Ue.length-1,gr=-1,xr=-1):(tr=0,gr=Ue.length,xr=1);const qr=new Float64Array(16),Or=i.ab.vec3.create(),Lr=new i.P(0,0);for(let Zr=tr;Zr!==gr;Zr+=xr){const Ln=Ue[Zr],ui=Re.getTile(Ln).getBucket(qe);if(!ui||!ui.uploaded)continue;let Wi=!1;He&&(Wi=He.getMaxCascadeForTile(Ln.toUnwrapped())===0);const Zn=Ke.calculatePosMatrix(Ln.toUnwrapped(),Ke.worldSize),Qr=ui.modelTraits;!Lt&&Vt&&(i.ab.mat4.invert(qr,Zn),i.ab.vec3.transformMat4(Or,at,qr),Lr.x=Or[0],Lr.y=Or[1]);const jn=[];for(const wr of ui.getNodesInfo()){if(wr.hiddenByReplacement||!wr.node.meshes)continue;const In=wr.node;let Qn=0;Ae.terrain&&In.elevation&&(Qn=In.elevation*Ae.terrain.exaggeration());const ai=(()=>{const Fn=wr.aabb;return pt.min=[...Fn.min],pt.max=[...Fn.max],pt.min[2]+=Qn,pt.max[2]+=Qn,i.ab.vec3.transformMat4(pt.min,pt.min,Zn),i.ab.vec3.transformMat4(pt.max,pt.max,Zn),pt})(),na=wr.evaluatedScale;if(na[0]<=1&&na[1]<=1&&na[2]<=1&&ai.intersects(jt)===0)continue;if(!Lt&&Vt){const Fn=.16666666666666666;wr.cameraCollisionOpacity=at[0]>ai.min[0]&&at[0]<ai.max[0]&&at[1]>ai.min[1]&&at[1]<ai.max[1]&&at[2]*kt<ai.max[2]&&In.footprint&&i.bA(Lr,In.footprint)?Math.max(wr.cameraCollisionOpacity-Fn,0):Math.min(1,wr.cameraCollisionOpacity+Fn)}const ca=[...Zn],La=In.anchor?In.anchor[0]:0,ka=In.anchor?In.anchor[1]:0;i.ab.mat4.translate(ca,ca,[La*(na[0]-1),ka*(na[1]-1),Qn]),i.ab.vec3.exactEquals(na,i.dm)||i.ab.mat4.scale(ca,ca,na);const Ds=i.ab.mat4.multiply([],ca,In.matrix),Fs=i.ab.mat4.multiply([],Ke.expandedFarZProjMatrix,Ds),Ci=i.ab.mat4.multiply([],Ke.expandedFarZProjMatrix,ca),Ti=i.ab.vec4.transformMat4([],[La,ka,Qn,1],Fs)[2];In.hidden=!1;let _i=ht;Lt||(Vt&&(_i*=wr.cameraCollisionOpacity,_i*=Hl(ca,Ke,wr.aabb,Xt)),_i*=_u(It,Ti)),_i!==0?jn.push({nodeInfo:wr,depth:Ti,opacity:_i,wvpForNode:Fs,wvpForTile:Ci,nodeModelMatrix:Ds,tileModelMatrix:ca}):In.hidden=!0}Lt||jn.sort((wr,In)=>!Vt||wr.opacity===1&&In.opacity===1?wr.depth<In.depth?-1:1:wr.opacity===1?-1:In.opacity===1?1:wr.depth>In.depth?-1:1);for(const wr of jn){const In=wr.nodeInfo,Qn=In.node;let ai=i.ab.mat4.multiply([],Pt,wr.tileModelMatrix);i.ab.mat4.multiply(ai,mt,ai);const na=i.ab.mat4.invert([],ai);i.ab.mat4.transpose(na,na),i.ab.mat4.scale(na,na,Gp),ai=i.ab.mat4.multiply(ai,ai,Qn.matrix);const ca=Ae.renderPass==="light-beam",La=qe.paint.get("model-color-use-theme").constantOr("default")==="none",ka=Qr&i.dp.HasMapboxMeshFeatures,Ds=ka?0:In.evaluatedRMEA[0][2];for(let Fs=0;Fs<Qn.meshes.length;++Fs){const Ci=Qn.meshes[Fs],Ti=Fs===Qn.lightMeshIndex;let _i=wr.wvpForNode;if(Ti){if(!ca&&!Ae.terrain&&Ae.shadowRenderer){Ae.currentLayer<Ae.firstLightBeamLayer&&(Ae.firstLightBeamLayer=Ae.currentLayer);continue}_i=wr.wvpForTile}else if(ca)continue;const Fn={defines:[]},ua=[];if(!Lt&&He&&(He.useNormalOffset=!!Ci.normalBuffer),la(Fn.defines,ua,Ci,Ae,La?null:qe.lut),ka||Fn.defines.push("DIFFUSE_SHADED"),Wi&&Fn.defines.push("SHADOWS_SINGLE_CASCADE"),Ht&&(Lt?Ht.numRenderedVerticesInShadowPass+=Ci.vertexArray.length:Ht.numRenderedVerticesInTransparentPass+=Ci.vertexArray.length),Lt){pd(Ci,wr.nodeModelMatrix,Ae,qe);continue}let ds=null;if(Ze){const Vo=Fo(wr.nodeModelMatrix,Ae.transform);if(ds=new Float32Array(Vo),Ke.projection.name!=="globe"){const Pl=Ci.aabb.min,Mi=Ci.aabb.max,[Ah,pc]=Ze.getOpacityForBounds(Vo,Pl[0],Pl[1],Mi[0],Mi[1]);Fn.overrideFog=Ah>=Je||pc>=Je}}const ji=Ci.material;let Hs;ji.occlusionTexture&&ji.occlusionTexture.offsetScale&&(Hs=ji.occlusionTexture.offsetScale,Fn.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const kl=Ae.getOrCreateProgram("model",Fn);!Lt&&He&&He.setupShadowsFromMatrix(wr.tileModelMatrix,kl,He.useNormalOffset),Ae.uploadCommonUniforms(Qe,kl,null,ds);const ws=ji.pbrMetallicRoughness;ws.metallicFactor=.9,ws.roughnessFactor=.5;const Bo=dh(new Float32Array(_i),new Float32Array(ai),new Float32Array(na),new Float32Array(Qn.matrix),Ae,wr.opacity,ws.baseColorFactor.toRenderColor(null),ji.emissiveFactor,ws.metallicFactor,ws.roughnessFactor,ji,Ds,qe,[0,0,0],Hs);!Ti&&(In.hasTranslucentParts||wr.opacity<1)&&kl.draw(Ae,Qe.gl.TRIANGLES,Tt,Wr.disabled,kn.disabled,Jr.backCCW,Bo,qe.id,Ci.vertexBuffer,Ci.indexBuffer,Ci.segments,qe.paint,Ae.transform.zoom,void 0,ua),kl.draw(Ae,Qe.gl.TRIANGLES,Ti?$t:Tt,Wr.disabled,Ti||wr.opacity<1||In.hasTranslucentParts?kn.alphaBlended:kn.unblended,Jr.backCCW,Bo,qe.id,Ci.vertexBuffer,Ci.indexBuffer,Ci.segments,qe.paint,Ae.transform.zoom,void 0,ua)}}}}()}(g,l,d,y),void W();if(Z.type!=="model")return;const Y=Z.getModels(),re=[],ne=g.transform.getFreeCameraOptions().position,oe=i.ab.vec3.scale([],[ne.x,ne.y,ne.z],g.transform.worldSize);i.ab.vec3.negate(oe,oe);const _e=[],ge=[];let Te=0;for(const Ae of Y){const Re=d.paint.get("model-rotation").constantOr(null),qe=d.paint.get("model-scale").constantOr(null),Ue=d.paint.get("model-translation").constantOr(null);Ae.computeModelMatrix(g,Re,qe,Ue,!0,!0,!1);const Qe=i.ab.mat4.identity([]),Ke=i.dj(Ae.position.lat,g.transform.zoom),Ze=i.ab.mat4.fromScaling([],[1,1,1/Ke]);i.ab.mat4.translate(Qe,Qe,oe),re.push({zScaleMatrix:Ze,negCameraPosMatrix:Qe});for(const He of Ae.nodes)cs(g.transform,He,Ae.matrix,g.transform.expandedFarZProjMatrix,Te,_e,ge);Te++}if(_e.sort((Ae,Re)=>Re.depth-Ae.depth),g.renderPass!=="shadow"){if(N===1)for(const Ae of ge)pa(Ae,g,d,re[Ae.modelIndex],Wr.disabled,g.colorModeForRenderPass());else{for(const Ae of ge)pa(Ae,g,d,re[Ae.modelIndex],Wr.disabled,kn.disabled);for(const Ae of ge)pa(Ae,g,d,re[Ae.modelIndex],g.stencilModeFor3D(),g.colorModeForRenderPass());g.resetStencilClippingMasks()}for(const Ae of _e)pa(Ae,g,d,re[Ae.modelIndex],Wr.disabled,g.colorModeForRenderPass());W()}else{for(const Ae of ge)pd(Ae.mesh,Ae.nodeModelMatrix,g,d);for(const Ae of _e)pd(Ae.mesh,Ae.nodeModelMatrix,g,d);W()}}},_h={line:function(g,l,d){if(g.hasElevatedBuckets=!1,g.hasNonElevatedBuckets=!1,g._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||g._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(l){const y=l.getVisibleCoordinates();for(const N of y){const j=l.getTile(N).getBucket(g);if(j&&(j.hasZOffset?g.hasElevatedBuckets=!0:g.hasNonElevatedBuckets=!0,g.hasElevatedBuckets&&g.hasNonElevatedBuckets))break}}}else g.hasNonElevatedBuckets=!0},model:function(g,l,d){const y=l.getSource();if(!y.loaded())return;if(y.type==="vector"||y.type==="geojson")return void(d.modelManager&&d.modelManager.upload(d,y.type==="vector"?g.scope:""));if(y.type==="batched-model"||y.type!=="model")return;const N=y.getModels();for(const j of N)j.upload(d.context)},raster:function(g,l,d){const y=l.getSource();if(!(y instanceof Ka&&y.loaded()))return;const N=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!N)return;const j=g.paint.get("raster-array-band")||y.getInitialBand(N);if(j==null)return;const C=l.getIds().map(F=>l.getTileByID(F));for(const F of C)F.updateNeeded(N,j)&&y.prepareTile(F,N,j)},"raster-particle":function(g,l,d){const y=l.getSource();if(!(y instanceof Ka&&y.loaded()))return;const N=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!N)return;const j=g.paint.get("raster-particle-array-band")||y.getInitialBand(N);if(j==null)return;const C=l.getIds().map(F=>l.getTileByID(F));for(const F of C)F.updateNeeded(N,j)&&y.prepareTile(F,N,j)}};class mg{constructor(l,d,y,N,j){this.context=new Fy(l,d),this.transform=y,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=j,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const C=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const W of C)this._debugParams.enabledLayers[W]=!0;j.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),j.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),j.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),j.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),j.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),j.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const W of C)j.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],W);this.occlusionParams=new Nf(j),this.setup(),this.numSublayers=Zo.maxUnderzooming+Zo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Xd(this),this._wireframeDebugCache=new xh,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const F=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,F,l.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=N}updateTerrain(l,d){const y=!!l&&!!l.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new cc(this,l));const N=this._terrain;this.transform.elevation=y?N:null,N.update(l,this.transform,d),this.transform.elevation&&!N.enabled&&(this.transform.elevation=null)}_updateFog(l){const d=l.fog;if(!d||this.transform.projection.name==="globe"||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,N]=d.getFovAdjustedRange(this.transform._fov);if(y>N)return void(this.transform.fogCullDistSq=null);const j=y+.78*(N-y);this.transform.fogCullDistSq=j*j}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(l){l&&!this._terrain&&(this._terrain=new cc(this,this.style)),this._forceTerrainMode=l}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(l,d){if(this.width=l*i.q.devicePixelRatio,this.height=d*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._mergedLayers[y].resize()}setup(){const l=this.context,d=new i.b4;d.emplaceBack(0,0),d.emplaceBack(i.ag,0),d.emplaceBack(0,i.ag),d.emplaceBack(i.ag,i.ag),this.tileExtentBuffer=l.createVertexBuffer(d,i.b6.members),this.tileExtentSegments=i.b7.simpleSegment(0,0,4,2);const y=new i.b4;y.emplaceBack(0,0),y.emplaceBack(i.ag,0),y.emplaceBack(0,i.ag),y.emplaceBack(i.ag,i.ag),this.debugBuffer=l.createVertexBuffer(y,i.b6.members),this.debugSegments=i.b7.simpleSegment(0,0,4,5);const N=new i.b4;N.emplaceBack(-1,-1),N.emplaceBack(1,-1),N.emplaceBack(-1,1),N.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(N,i.b6.members),this.viewportSegments=i.b7.simpleSegment(0,0,4,2);const j=new i.aT;j.emplaceBack(0,0,0,0),j.emplaceBack(i.ag,0,i.ag,0),j.emplaceBack(0,i.ag,0,i.ag),j.emplaceBack(i.ag,i.ag,i.ag,i.ag),this.mercatorBoundsBuffer=l.createVertexBuffer(j,i.b9.members),this.mercatorBoundsSegments=i.b7.simpleSegment(0,0,4,2);const C=new i.aU;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(C);const F=new i.b5;for(const Z of[0,1,3,2,0])F.emplaceBack(Z);this.debugIndexBuffer=l.createIndexBuffer(F),this.emptyTexture=new i.T(l,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),l.gl.RGBA8),this.identityMat=i.ab.mat4.create();const W=this.context.gl;this.stencilClearMode=new Wr({func:W.ALWAYS,mask:0},0,255,W.ZERO,W.ZERO,W.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(l){return l._makeTileBoundsBuffers(this.context,this.transform.projection),l._tileBoundsBuffer?{tileBoundsBuffer:l._tileBoundsBuffer,tileBoundsIndexBuffer:l._tileBoundsIndexBuffer,tileBoundsSegments:l._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const l=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,l.TRIANGLES,zr.disabled,this.stencilClearMode,kn.disabled,Jr.disabled,ra(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(l,d,y){if(!d||this.currentStencilSource===d.id||!l.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let F=!1;for(const W of y)if(this._tileClippingMaskIDs[W.key]===void 0){F=!0;break}if(!F)return}this.currentStencilSource=d.id;const N=this.context,j=N.gl;this.nextStencilID+y.length>256&&this.clearStencil(),N.setColorMode(kn.disabled),N.setDepthMode(zr.disabled);const C=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const F of y){const W=d.getTile(F),Z=this._tileClippingMaskIDs[F.key]=this.nextStencilID++,{tileBoundsBuffer:Y,tileBoundsIndexBuffer:re,tileBoundsSegments:ne}=this.getTileBoundsBuffers(W);C.draw(this,j.TRIANGLES,zr.disabled,new Wr({func:j.ALWAYS,mask:0},Z,255,j.KEEP,j.KEEP,j.REPLACE),kn.disabled,Jr.disabled,ra(F.projMatrix),"$clipping",Y,re,ne)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,d=this.context.gl;return new Wr({func:d.NOTEQUAL,mask:255},l,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(l){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(l);const d=this.context.gl;return new Wr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(l){const d=this.context.gl,y=l.sort((C,F)=>F.overscaledZ-C.overscaledZ),N=y[y.length-1].overscaledZ,j=y[0].overscaledZ-N+1;if(j>1){this.currentStencilSource=void 0,this.nextStencilID+j>256&&this.clearStencil();const C={};for(let F=0;F<j;F++)C[F+N]=new Wr({func:d.GEQUAL,mask:255},F+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=j,[C,y]}return[{[N]:Wr.disabled},y]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new kn([l.CONSTANT_COLOR,l.ONE,l.CONSTANT_COLOR,l.ONE],new i.aj(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?kn.unblended:kn.alphaBlended}colorModeForDrapableLayerRenderPass(l){const d=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new kn([d.ONE,d.ONE_MINUS_SRC_ALPHA,d.CONSTANT_ALPHA,d.ONE_MINUS_SRC_ALPHA],new i.aj(0,0,0,l===void 0?0:l),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(l,d,y,N=!1){if(this.depthOcclusion)return new zr(this.context.gl.GREATER,zr.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!N)return zr.disabled;const j=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new zr(y||this.context.gl.LEQUAL,d,[j,j])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const l=this.context.gl,d=Math.ceil(this.width),y=Math.ceil(this.height),N=this.context.bindFramebuffer.get(),j=l.getParameter(l.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===d&&this.depthFBO.height===y||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),d!==0&&y!==0&&(this.depthFBO=new Up(this.context,d,y,!1,"texture"),this.depthTexture=new i.T(this.context,{width:d,height:y,data:null},l.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(N),l.bindTexture(l.TEXTURE_2D,j),this.depthFBO&&(l.bindFramebuffer(l.READ_FRAMEBUFFER,null),l.bindFramebuffer(l.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),l.blitFramebuffer(0,0,d,y,0,0,d,y,l.DEPTH_BUFFER_BIT,l.NEAREST),l.bindFramebuffer(l.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((l,d)=>l+d/this._fpsHistory.length,0))}render(l,d){const y=i.q.now();this._dt=y-this._timeStamp,this._timeStamp=y,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=l.map.repaint,this.style=l,this.options=d;const N=this.style._mergedLayers,j=!(!this.terrain||!this.terrain.enabled),C=()=>this.style._getOrder(j).filter(ht=>{const Tt=N[ht];return!(Tt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Tt.type]});let F=C(),W=!1,Z=!1;for(const ht of F){const Tt=N[ht];Tt.type==="circle"&&(W=!0),Tt.type==="symbol"&&(Tt.hasInitialOcclusionOpacityProperties?Z=!0:W=!0)}let Y=F.map(ht=>N[ht]);const re=this.style._mergedSourceCaches;this.imageManager=l.imageManager,this.modelManager=l.modelManager,this.symbolFadeChange=l.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let ne=0,oe=!1;for(const ht in re){const Tt=re[ht];Tt.used&&(Tt.prepare(this.context),Tt.getSource().usedInConflation&&++ne)}let _e=!1;for(const ht of Y)ht.isHidden(this.transform.zoom)||(ht.type==="clip"&&(_e=!0),this.prepareLayer(ht));const ge={},Te={},Ae={},Re={},qe={};for(const ht in re){const Tt=re[ht];ge[ht]=Tt.getVisibleCoordinates(),Te[ht]=ge[ht].slice().reverse(),Ae[ht]=Tt.getVisibleCoordinates(!0).reverse(),Re[ht]=Tt.getShadowCasterCoordinates(),qe[ht]=Tt.sortCoordinatesByDistance(ge[ht])}const Ue=ht=>{const Tt=this.style.getLayerSourceCache(ht);return Tt&&Tt.used?Tt.getSource():null};if(ne||_e||this._clippingActiveLastFrame){const ht=[],Tt=[];let $t=0;for(const pt of Y)this.isSourceForClippingOrConflation(pt,Ue(pt))&&(ht.push(pt),Tt.push($t)),$t++;if(ht&&(_e||ht.length>1)||this._clippingActiveLastFrame){_e=!1;const pt=[];for(let Lt=0;Lt<ht.length;Lt++){const jt=ht[Lt],Xt=Tt[Lt],Vt=this.style.getLayerSourceCache(jt);if(!Vt||!Vt.used||!Vt.getSource().usedInConflation&&jt.type!=="clip")continue;let It=i.dx,Ht=i.by.None;const tr=[];let gr=!0;if(jt.type==="clip"){It=Xt;for(const xr of jt.layout.get("clip-layer-types"))Ht|=xr==="model"?i.by.Model:xr==="symbol"?i.by.Symbol:i.by.FillExtrusion;for(const xr of jt.layout.get("clip-layer-scope"))tr.push(xr);jt.isHidden(this.transform.zoom)?gr=!1:_e=!0}gr&&pt.push({layer:jt.fqid,cache:Vt,order:It,clipMask:Ht,clipScope:tr})}this.replacementSource.setSources(pt),oe=!0}}this._clippingActiveLastFrame=_e,oe||this.replacementSource.clear(),this.conflationActive=oe,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let ht=0;ht<Y.length;ht++){const Tt=Y[ht],$t=Tt.cutoffRange();if(this.longestCutoffRange=Math.max($t,this.longestCutoffRange),$t>0){const pt=Ue(Tt);pt&&(this.minCutoffZoom=Math.max(pt.minzoom,this.minCutoffZoom)),Tt.minzoom&&(this.minCutoffZoom=Math.max(Tt.minzoom,this.minCutoffZoom))}Tt.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=ht),this._lastOcclusionLayer=ht)}const Qe=this.style&&this.style.fog;Qe?(this._fogVisible=Qe.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Qe.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(Ae),this.opaquePassCutoff=0,F=C(),Y=F.map(ht=>N[ht]));const Ke=this._shadowRenderer;if(Ke){Ke.updateShadowParameters(this.transform,this.style.directionalLight);for(const ht in re)for(const Tt of ge[ht]){let $t={min:0,max:0};this.terrain&&($t=this.terrain.getMinMaxForTile(Tt)||$t),Ke.addShadowReceiver(Tt.toUnwrapped(),$t.min,$t.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new ug(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Ze=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),He=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Ze&&!this._snow&&(this._snow=new jf(this)),!Ze&&this._snow&&(this._snow.destroy(),delete this._snow),He&&!this._rain&&(this._rain=new vh(this)),!He&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Pr.has(this.context.gl))return;this.renderPass="offscreen";for(const ht of Y){const Tt=l.getLayerSourceCache(ht);if(!ht.hasOffscreenPass()||ht.isHidden(this.transform.zoom))continue;const $t=Tt?Te[Tt.id]:void 0;(ht.type==="custom"||ht.type==="raster"||ht.type==="raster-particle"||ht.isSky()||$t&&$t.length)&&this.renderLayer(this,Tt,ht,$t)}this.depthRangeFor3D=[0,1-(Y.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Re)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Xe=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),at=(()=>{if(d.showOverdrawInspector)return i.aj.black;const ht=this.style.fog;if(ht&&this.transform.projection.supportsFog){const Tt=this.style.getLut(ht.scope);if(!Xe){const $t=ht.properties.get("color-use-theme")==="none",pt=ht.properties.get("color").toRenderColor($t?null:Tt).toArray01();return new i.aj(...pt)}if(Xe){const $t=ht.properties.get("space-color-use-theme")==="none",pt=ht.properties.get("space-color").toRenderColor($t?null:Tt).toArray01();return new i.aj(...pt)}}return i.aj.transparent})();if(this.context.clear({color:at,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Xe&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=F.length-1;this.currentLayer>=0;this.currentLayer--){const ht=Y[this.currentLayer],Tt=l.getLayerSourceCache(ht);if(ht.isSky())continue;const $t=Tt?(ht.is3D()?qe:Te)[Tt.id]:void 0;this._renderTileClippingMasks(ht,Tt,$t),this.renderLayer(this,Tt,ht,$t)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Xe&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ae(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<F.length;this.currentLayer++){const ht=Y[this.currentLayer],Tt=l.getLayerSourceCache(ht);ht.isSky()&&this.renderLayer(this,Tt,ht,Tt?Te[Tt.id]:void 0)}function _t(ht,Tt){let $t;return Tt&&($t=(ht.type==="symbol"?Ae:ht.is3D()?qe:Te)[Tt.id]),$t}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<F.length;){const ht=Y[this.currentLayer];if(ht.type==="raster"||ht.type==="raster-particle"){const Tt=l.getLayerSourceCache(ht);this.renderLayer(this,Tt,ht,_t(ht,Tt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let mt=0;Ke&&(mt=Ke.getShadowCastingLayerCount());let kt=!1,Pt=-1;for(let ht=0;ht<F.length;++ht){const Tt=Y[ht];Tt.isHidden(this.transform.zoom)||Tt.is3D()&&(Pt=ht)}for(Z&&Pt===-1&&(W=!0);this.currentLayer<F.length;){const ht=Y[this.currentLayer],Tt=l.getLayerSourceCache(ht);if(ht.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(ht)){if(ht.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(W&&!kt&&this.terrain&&!this.transform.isOrthographic&&(kt=!0,this.blitDepth()),Z&&Pt!==-1&&this.currentLayer===Pt+1&&!this.transform.isOrthographic&&this.blitDepth(),ht.is3D()||this.terrain||this._renderTileClippingMasks(ht,Tt,Tt?ge[Tt.id]:void 0),this.renderLayer(this,Tt,ht,_t(ht,Tt)),!this.terrain&&Ke&&mt>0&&ht.hasShadowPass()&&--mt==0&&(Ke.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const $t=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=$t;this.currentLayer++){const pt=Y[this.currentLayer];if(!pt.hasLightBeamPass())continue;const Lt=l.getLayerSourceCache(pt);this.renderLayer(this,Lt,pt,Lt?Te[Lt.id]:void 0)}this.currentLayer=$t,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const $t=this.currentLayer;this.depthOcclusion=!0;for(const pt of this.layersWithOcclusionOpacity){this.currentLayer=pt;const Lt=Y[this.currentLayer],jt=l.getLayerSourceCache(Lt),Xt=jt?Te[jt.id]:void 0;Lt.is3D()||this.terrain||this._renderTileClippingMasks(Lt,jt,jt?ge[jt.id]:void 0),this.renderLayer(this,jt,Lt,Xt)}this.depthOcclusion=!1,this.currentLayer=$t,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ht=null;Y.forEach(Tt=>{const $t=l.getLayerSourceCache(Tt);$t&&!Tt.isHidden(this.transform.zoom)&&$t.getVisibleCoordinates().length&&(!ht||ht.getSource().maxzoom<$t.getSource().maxzoom)&&(ht=$t)}),ht&&this.options.showTileBoundaries&&kf.debug(this,ht,ht.getVisibleCoordinates(),i.aj.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&kf.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.aj(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(ht){const Tt=ht.transform.padding;mh(ht,ht.transform.height-(Tt.top||0),3,vu),mh(ht,Tt.bottom||0,3,_x),gh(ht,Tt.left||0,3,og),gh(ht,ht.transform.width-(Tt.right||0),3,By);const $t=ht.transform.centerPoint;(function(pt,Lt,jt,Xt){jl(pt,Lt-1,jt-10,2,20,Xt),jl(pt,Lt-10,jt-1,20,2,Xt)})(ht,$t.x,ht.transform.height-$t.y,fd)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),oe||(this.conflationActive=!1)}prepareLayer(l){this.gpuTimingStart(l);const{unsupportedLayers:d}=this.transform.projection,y=!d||!d.includes(l.type);if(_h[l.type]&&(y||this.terrain&&l.type==="custom")){const N=this.style.getLayerSourceCache(l);_h[l.type](l,N,this)}this.gpuTimingEnd()}renderLayer(l,d,y,N){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||y.type==="model"||y.type==="raster"||y.type==="raster-particle"||N&&N.length)&&(this.id=y.id,this.gpuTimingStart(y),l.transform.projection.unsupportedLayers&&l.transform.projection.unsupportedLayers.includes(y.type)&&(!l.terrain||y.type!=="custom")||y.type==="clip"||kf[y.type](l,d,y,N,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery,y=this.context.gl;let N=this.gpuTimers[l.id];N||(N=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:y.createQuery()}),N.calls++,y.beginQuery(d.TIME_ELAPSED_EXT,N.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const l=this.context.extTimerQuery,d=this.context.gl,y=d.createQuery();this.deferredRenderGpuTimeQueries.push(y),d.beginQuery(l.TIME_ELAPSED_EXT,y)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}collectDeferredRenderGpuQueries(){const l=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],l}queryGpuTimers(l){const d={};for(const y in l){const N=l[y],j=this.context.extTimerQuery,C=j.getQueryParameter(N.query,this.context.gl.QUERY_RESULT)/1e6;j.deleteQueryEXT(N.query),d[y]=C}return d}queryGpuTimeDeferredRender(l){if(!this.options.gpuTimingDeferredRender)return 0;const d=this.context.gl;let y=0;for(const N of l)y+=d.getQueryParameter(N,d.QUERY_RESULT)/1e6,d.deleteQuery(N);return y}translatePosMatrix(l,d,y,N,j){if(!y[0]&&!y[1])return l;const C=j?N==="map"?this.transform.angle:0:N==="viewport"?-this.transform.angle:0;if(C){const Z=Math.sin(C),Y=Math.cos(C);y=[y[0]*Y-y[1]*Z,y[0]*Z+y[1]*Y]}const F=[j?y[0]:i.ar(d,y[0],this.transform.zoom),j?y[1]:i.ar(d,y[1],this.transform.zoom),0],W=new Float32Array(16);return i.ab.mat4.translate(W,l,F),W}saveTileTexture(l){const d=l.size[0],y=this._tileTextures[d];y?y.push(l):this._tileTextures[d]=[l]}getTileTexture(l){const d=this._tileTextures[l];return d&&d.length>0?d.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(l,d,y){const N=y===void 0?this.terrain&&this.terrain.renderingToTexture:y,j=[];return this.style&&this.style.enable3dLights()&&(l==="globeRaster"||l==="terrainRaster"?(j.push("LIGHTING_3D_MODE"),j.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):N||j.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||j.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(j.push("TERRAIN"),this.linearFloatFilteringSupported()&&j.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&j.push("GLOBE"),!this._fogVisible||N||d!==void 0&&!d||j.push("FOG","FOG_DITHERING"),N&&j.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&j.push("OVERDRAW_INSPECTOR"),j}getOrCreateProgram(l,d){this.cache=this.cache||{};const y=d&&d.defines||[],N=d&&d.config,j=this.currentGlobalDefines(l,d&&d.overrideFog,d&&d.overrideRtt).concat(y),C=Ry.cacheKey(eh[l],l,j,N);return this.cache[C]||(this.cache[C]=new Ry(this.context,l,eh[l],N,sg[l],j)),this.cache[C]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(l,d){if(this.style.enable3dLights()){const y=this.style.directionalLight,N=this.style.ambientLight;if(y&&N){const j=((C,F,W)=>{const Z=C.properties.get("direction"),Y=C.properties.get("color-use-theme")==="none",re=C.properties.get("color").toRenderColor(Y?null:W.getLut(C.scope)).toArray01(),ne=C.properties.get("intensity"),oe=F.properties.get("color-use-theme")==="none",_e=F.properties.get("color").toRenderColor(oe?null:W.getLut(F.scope)).toArray01(),ge=F.properties.get("intensity"),Te=[Z.x,Z.y,Z.z],Ae=i.cM(_e,ge),Re=i.cM(re,ne);return{u_lighting_ambient_color:Ae,u_lighting_directional_dir:Te,u_lighting_directional_color:Re,u_ground_radiance:Qo(Te,Re,Ae)}})(y,N,this.style);d.setLightsUniformValues(l,j)}}}uploadCommonUniforms(l,d,y,N,j){if(this.uploadCommonLightUniforms(l,d),this.terrain&&this.terrain.renderingToTexture)return;const C=this.style.fog;if(C){const F=C.getOpacity(this.transform.pitch),W=((Z,Y,re,ne,oe,_e,ge,Te,Ae,Re,qe,Ue)=>{const Qe=Z.transform,Ke=Y.properties.get("color-use-theme")==="none",Ze=Y.properties.get("color").toRenderColor(Ke?null:Z.style.getLut(Y.scope)).toArray01();Ze[3]=ne;const He=Z.frameCounter/1e3%1,[Xe,at]=Y.properties.get("vertical-range");return{u_fog_matrix:re?Qe.calculateFogTileMatrix(re):Ue||Z.identityMat,u_fog_range:Y.getFovAdjustedRange(Qe._fov),u_fog_color:Ze,u_fog_horizon_blend:Y.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Xe,at),at],u_fog_temporal_offset:He,u_frustum_tl:oe,u_frustum_tr:_e,u_frustum_br:ge,u_frustum_bl:Te,u_globe_pos:Ae,u_globe_radius:Re,u_viewport:qe,u_globe_transition:i.ae(Qe.zoom),u_is_globe:+(Qe.projection.name==="globe")}})(this,C,y,F,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],N);d.setFogUniformValues(l,W)}j&&d.setCutoffUniformValues(l,j.uniformValues)}setTileLoadedFlag(l){this.tileLoaded=l}saveCanvasCopy(){const l=this.canvasCopy();l&&(this.frameCopies.push(l),this.tileLoaded=!1)}canvasCopy(){const l=this.context.gl,d=l.createTexture();return l.bindTexture(l.TEXTURE_2D,d),l.copyTexImage2D(l.TEXTURE_2D,0,l.RGBA,0,0,l.drawingBufferWidth,l.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const l=this.style&&this.style.fog;return!!l&&l.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const l=this._backgroundTiles,d=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const N of y)d[N.key]=l[N.key]||new Pc(N,512,this.transform.tileZoom,this);return d}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(l,d){return!(!l.is3D()||l.type!=="clip"&&(l.minzoom&&l.minzoom>this.transform.zoom||(this.style._clipLayerPresent||l.sourceLayer!=="building")&&(!d||d.type!=="batched-model")))}isTileAffectedByFog(l){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let d=this._cachedTileFogOpacities[l.key];return d||(this._cachedTileFogOpacities[l.key]=d=this.style.fog.getOpacityForTile(l)),d[0]>=Je||d[1]>=Je}setupDepthForOcclusion(l,d,y){const N=this.context,j=N.gl,C=!!y;var F;y||(y={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),N.activeTexture.set(j.TEXTURE3),l&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE),y.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],y.u_depth_range_unpack=[2/((F=this.depthRangeFor3D)[1]-F[0]),-1-2*F[0]/(F[1]-F[0])],y.u_occluder_half_size=.5*this.occlusionParams.occluderSize,y.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE),N.activeTexture.set(j.TEXTURE0),C||d.setTerrainUniformValues(N,y)}}function Zp(g,l){let d=!1,y=null;const N=()=>{y=null,d&&(g(),y=setTimeout(N,l),d=!1)};return()=>(d=!0,y||N(),y)}class Vy{constructor(l){this._hashName=l&&encodeURIComponent(l),i.aP(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Zp(this._updateHashUnthrottled.bind(this),300)}addTo(l){return this._map=l,window.addEventListener("hashchange",this._onHashChange,!1),l.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const l=this._map;if(!l)return"";const d=gg(l);if(this._hashName){const y=this._hashName;let N=!1;const j=location.hash.slice(1).split("&").map(C=>{const F=C.split("=")[0];return F===y?(N=!0,`${F}=${d}`):C}).filter(C=>C);return N||j.push(`${y}=${d}`),`#${j.join("&")}`}return`#${d}`}_getCurrentHash(){const l=location.hash.replace("#","");if(this._hashName){let d;return l.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(d=y)}),(d&&d[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._map;if(!l)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some(y=>isNaN(y))){const y=l.dragRotate.isEnabled()&&l.touchZoomRotate.isEnabled()?+(d[3]||0):l.getBearing();return l.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:y,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function gg(g,l){const d=g.getCenter(),y=Math.round(100*g.getZoom())/100,N=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),j=Math.pow(10,N),C=Math.round(d.lng*j)/j,F=Math.round(d.lat*j)/j,W=g.getBearing(),Z=g.getPitch();let Y=l?`/${C}/${F}/${y}`:`${y}/${F}/${C}`;return(W||Z)&&(Y+="/"+Math.round(10*W)/10),Z&&(Y+=`/${Math.round(Z)}`),Y}const bh={linearity:.3,easing:i.dy(0,0,.3,1)},Uy=i.l({deceleration:2500,maxSpeed:1400},bh),$y=i.l({deceleration:20,maxSpeed:1400},bh),qy=i.l({deceleration:1e3,maxSpeed:360},bh),bx=i.l({deceleration:1e3,maxSpeed:90},bh);class Gy{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,d=i.q.now();for(;l.length>0&&d-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const d={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:j}of this._inertiaBuffer)d.zoom+=j.zoomDelta||0,d.bearing+=j.bearingDelta||0,d.pitch+=j.pitchDelta||0,j.panDelta&&d.pan._add(j.panDelta),j.around&&(d.around=j.around),j.pinchAround&&(d.pinchAround=j.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,N={};if(d.pan.mag()){const j=Xp(d.pan.mag(),y,i.l({},Uy,l||{}));N.offset=d.pan.mult(j.amount/d.pan.mag()),N.center=this._map.transform.center,Yp(N,j)}if(d.zoom){const j=Xp(d.zoom,y,$y);N.zoom=this._map.transform.zoom+j.amount,Yp(N,j)}if(d.bearing){const j=Xp(d.bearing,y,qy);N.bearing=this._map.transform.bearing+i.aw(j.amount,-179,179),Yp(N,j)}if(d.pitch){const j=Xp(d.pitch,y,bx);N.pitch=this._map.transform.pitch+j.amount,Yp(N,j)}if(N.zoom||N.bearing){const j=d.pinchAround===void 0?d.around:d.pinchAround;N.around=j?this._map.unproject(j):this._map.getCenter()}return this.clear(),N.noMoveStart=!0,N}}function Yp(g,l){(!g.duration||g.duration<l.duration)&&(g.duration=l.duration,g.easing=l.easing)}function Xp(g,l,d){const{maxSpeed:y,linearity:N,deceleration:j}=d,C=i.aw(g*N/(l/1e3),-y,y),F=Math.abs(C)/(j*N);return{easing:d.easing,duration:1e3*F,amount:C*(F/2)}}class zo extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,y,N={}){const j=he(d.getCanvasContainer(),y),C=d.unproject(j);super(l,i.l({point:j,lngLat:C,originalEvent:y},N)),this._defaultPrevented=!1,this.target=d}}class Pf extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,y){const N=l==="touchend"?y.changedTouches:y.touches,j=Ce(d.getCanvasContainer(),N),C=j.map(W=>d.unproject(W)),F=j.reduce((W,Z,Y,re)=>W.add(Z.div(re.length)),new i.P(0,0));super(l,{points:j,point:F,lngLats:C,lngLat:d.unproject(F),originalEvent:y}),this._defaultPrevented=!1}}class Wy extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d){super("wheel",{originalEvent:d}),this._defaultPrevented=!1}}class yg{constructor(l,d){this._map=l,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(l){return this._firePreventable(new Wy(this._map,l))}mousedown(l,d){return this._mousedownPos=d,this._firePreventable(new zo(l.type,this._map,l))}mouseup(l){this._map.fire(new zo(l.type,this._map,l))}preclick(l){const d=i.l({},l);d.type="preclick",this._map.fire(new zo(d.type,this._map,d))}click(l,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(l),this._map.fire(new zo(l.type,this._map,l)))}dblclick(l){return this._firePreventable(new zo(l.type,this._map,l))}mouseover(l){this._map.fire(new zo(l.type,this._map,l))}mouseout(l){this._map.fire(new zo(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Pf(l.type,this._map,l))}touchmove(l){this._map.fire(new Pf(l.type,this._map,l))}touchend(l){this._map.fire(new Pf(l.type,this._map,l))}touchcancel(l){this._map.fire(new Pf(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class X_{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(l){this._map.fire(new zo(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new zo(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Na{constructor(l,d){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,d){this.isEnabled()&&l.shiftKey&&l.button===0&&(ae(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(l,d){if(!this._active)return;const y=d,N=this._startPos,j=this._lastPos;if(!N||!j||j.equals(y)||!this._box&&y.dist(N)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=I("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const C=Math.min(N.x,y.x),F=Math.max(N.x,y.x),W=Math.min(N.y,y.y),Z=Math.max(N.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${C}px,${W}px)`,this._box.style.width=F-C+"px",this._box.style.height=Z-W+"px")})}mouseupWindow(l,d){if(!this._active)return;const y=this._startPos,N=d;if(y&&l.button===0){if(this.reset(),ue(),y.x!==N.x||y.y!==N.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:l})),{cameraAnimation:j=>j.fitScreenCoordinates(y,N,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",l)}}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ee(),delete this._startPos,delete this._lastPos}_fireEvent(l,d){return this._map.fire(new i.z(l,{originalEvent:d}))}}function xg(g,l){const d={};for(let y=0;y<g.length;y++)d[g[y].identifier]=l[y];return d}class fc{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(l,d,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=l.timeStamp),y.length===this.numTouches&&(this.centroid=function(N){const j=new i.P(0,0);for(const C of N)j._add(C);return j.div(N.length)}(d),this.touches=xg(y,d)))}touchmove(l,d,y){if(this.aborted||!this.centroid)return;const N=xg(y,d);for(const j in this.touches){const C=N[j];(!C||C.dist(this.touches[j])>30)&&(this.aborted=!0)}}touchend(l,d,y){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const N=!this.aborted&&this.centroid;if(this.reset(),N)return N}}}class Jp{constructor(l){this.singleTap=new fc(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(l,d,y){this.singleTap.touchstart(l,d,y)}touchmove(l,d,y){this.singleTap.touchmove(l,d,y)}touchend(l,d,y){const N=this.singleTap.touchend(l,d,y);if(N){const j=l.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(N)<30;if(j&&C||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=N,this.count===this.numTaps)return this.reset(),N}}}class gd{constructor(){this._zoomIn=new Jp({numTouches:1,numTaps:2}),this._zoomOut=new Jp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,d,y){this._zoomIn.touchstart(l,d,y),this._zoomOut.touchstart(l,d,y)}touchmove(l,d,y){this._zoomIn.touchmove(l,d,y),this._zoomOut.touchmove(l,d,y)}touchend(l,d,y){const N=this._zoomIn.touchend(l,d,y),j=this._zoomOut.touchend(l,d,y);return N?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()+1,around:C.unproject(N)},{originalEvent:l})}):j?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()-1,around:C.unproject(j)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Hy={0:1,2:2};class Cf{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(l,d){return!1}_move(l,d){return{}}mousedown(l,d){if(this._lastPoint)return;const y=Ne(l);this._correctButton(l,y)&&(this._lastPoint=d,this._eventButton=y)}mousemoveWindow(l,d){const y=this._lastPoint;if(y){if(l.preventDefault(),this._eventButton!=null&&function(N,j){const C=Hy[j];return N.buttons===void 0||(N.buttons&C)!==C}(l,this._eventButton))this.reset();else if(this._moved||!(d.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(y,d)}}mouseupWindow(l){this._lastPoint&&Ne(l)===this._eventButton&&(this._moved&&ue(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qp extends Cf{mousedown(l,d){super.mousedown(l,d),this._lastPoint&&(this._active=!0)}_correctButton(l,d){return d===0&&!l.ctrlKey}_move(l,d){return{around:d,panDelta:d.sub(l)}}}class Kl extends Cf{_correctButton(l,d){return d===0&&l.ctrlKey||d===2}_move(l,d){const y=.8*(d.x-l.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(l){l.preventDefault()}}class $c extends Cf{_correctButton(l,d){return d===0&&l.ctrlKey||d===2}_move(l,d){const y=-.5*(d.y-l.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(l){l.preventDefault()}}class ma{constructor(l,d){this._map=l,this._el=l.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),i.aP(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(l,d,y){return this._calculateTransform(l,d,y)}touchmove(l,d,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1&&!i.dz())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return l.cancelable&&l.preventDefault(),this._calculateTransform(l,d,y)}}touchend(l,d,y){this._calculateTransform(l,d,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,d,y){y.length>0&&(this._active=!0);const N=xg(y,d),j=new i.P(0,0),C=new i.P(0,0);let F=0;for(const Z in N){const Y=N[Z],re=this._touches[Z];re&&(j._add(Y),C._add(Y.sub(re)),F++,N[Z]=Y)}if(this._touches=N,F<this._minTouches||!C.mag())return;const W=C.div(F);return this._sum._add(W),this._sum.mag()<this._clickTolerance?void 0:{around:j.div(F),panDelta:W}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=I("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class nl{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(l){}_move(l,d,y){return{}}touchstart(l,d,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([d[0],d[1]]))}touchmove(l,d,y){const N=this._firstTwoTouches;if(!N)return;l.preventDefault();const[j,C]=N,F=Ef(y,d,j),W=Ef(y,d,C);if(!F||!W)return;const Z=this._aroundCenter?null:F.add(W).div(2);return this._move([F,W],Z,l)}touchend(l,d,y){if(!this._firstTwoTouches)return;const[N,j]=this._firstTwoTouches,C=Ef(y,d,N),F=Ef(y,d,j);C&&F||(this._active&&ue(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ef(g,l,d){for(let y=0;y<g.length;y++)if(g[y].identifier===d)return l[y]}function Mf(g,l){return Math.log(g/l)/Math.LN2}class Ky extends nl{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,d){const y=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(Mf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Mf(this._distance,y),pinchAround:d}}}function Zy(g,l){return 180*g.angleWith(l)/Math.PI}class Of extends nl{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,d){const y=this._vector;if(this._vector=l[0].sub(l[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Zy(this._vector,y),pinchAround:d}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const d=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const N=Zy(l,y);return Math.abs(N)<d}}function vg(g){return Math.abs(g.y)>Math.abs(g.x)}class J_ extends nl{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(l){this._lastPoints=l,vg(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,d,y){const N=this._lastPoints;if(!N)return;const j=l[0].sub(N[0]),C=l[1].sub(N[1]);return this._map._cooperativeGestures&&!i.dz()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(j,C,y.timeStamp),!this._valid)?void 0:(this._lastPoints=l,this._active=!0,{pitchDelta:(j.y+C.y)/2*-.5})}gestureBeginsVertically(l,d,y){if(this._valid!==void 0)return this._valid;const N=l.mag()>=2,j=d.mag()>=2;if(!N&&!j)return;if(!N||!j)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const C=l.y>0==d.y>0;return vg(l)&&vg(d)&&C}}const wo={panStep:100,bearingStep:15,pitchStep:10};class ao{constructor(){const l=wo;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let d=0,y=0,N=0,j=0,C=0;switch(l.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:l.shiftKey?y=-1:(l.preventDefault(),j=-1);break;case 39:l.shiftKey?y=1:(l.preventDefault(),j=1);break;case 38:l.shiftKey?N=1:(l.preventDefault(),C=-1);break;case 40:l.shiftKey?N=-1:(l.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(y=0,N=0),{cameraAnimation:F=>{const W=F.getZoom();F.easeTo({duration:300,easeId:"keyboardHandler",easing:yd,zoom:d?Math.round(W)+d*(l.shiftKey?2:1):W,bearing:F.getBearing()+y*this._bearingStep,pitch:F.getPitch()+N*this._pitchStep,offset:[-j*this._panStep,-C*this._panStep],center:F.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function yd(g){return g*(2-g)}const xd=4.000244140625,qc=1/450;class Zl{constructor(l,d){this._map=l,this._el=l.getCanvasContainer(),this._handler=d,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=qc,i.aP(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(l.ctrlKey||l.metaKey||this.isZooming()||i.dz()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const y=i.q.now(),N=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,d!==0&&d%xd==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":N>400?(this._type=null,this._lastValue=d,this._timeout=window.setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(N*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),l.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=l,this._delta-=d,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=he(this._el,l);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform;this._type==="wheel"&&l.projection.wrap&&(l._center.lng>=180||l._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const d=()=>l._terrainEnabled()&&this._aroundCoord?l.computeZoomRelativeTo(this._aroundCoord):l.zoom;if(this._delta!==0){const Z=this._type==="wheel"&&Math.abs(this._delta)>xd?this._wheelZoomRate:this._defaultZoomRate;let Y=2/(1+Math.exp(-Math.abs(this._delta*Z)));this._delta<0&&Y!==0&&(Y=1/Y);const re=d(),ne=Math.pow(2,re),oe=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):ne;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(oe*Y))),this._type==="wheel"&&(this._startZoom=re,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:d(),N=this._startZoom,j=this._easing;let C,F=!1;if(this._type==="wheel"&&N&&j){const Z=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),Y=j(Z);C=i.af(N,y,Y),Z<1?this._frameId||(this._frameId=!0):F=!0}else C=y,F=!0;this._active=!0,F&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let W=C-d();return W*this._lastDelta<0&&(W=0),{noInertia:!0,needsRenderFrame:!F,zoomDelta:W,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let d=i.dA;if(this._prevEase){const y=this._prevEase,N=(i.q.now()-y.start)/y.duration,j=y.easing(N+.01)-y.easing(N),C=.27/Math.sqrt(j*j+1e-4)*.01,F=Math.sqrt(.0729-C*C);d=i.dy(C,F,.25,1)}return this._prevEase={start:i.q.now(),duration:l,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=I("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class wu{constructor(l,d){this._clickZoom=l,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Su{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(l,d){return l.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(l.shiftKey?-1:1),around:y.unproject(d)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nu{constructor(){this._tap=new Jp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(l,d,y){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=d[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(l,d,y))}touchmove(l,d,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const N=d[0],j=N.y-this._swipePoint.y;return this._swipePoint=N,l.preventDefault(),this._active=!0,{zoomDelta:j/128}}}else this._tap.touchmove(l,d,y)}touchend(l,d,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(l,d,y)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yy{constructor(l,d,y){this._el=l,this._mousePan=d,this._touchPan=y}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class wx{constructor(l,d,y){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=d,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Sx{constructor(l,d,y,N){this._el=l,this._touchZoom=d,this._touchRotate=y,this._tapDragZoom=N,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Rf=g=>g.zoom||g.drag||g.pitch||g.rotate;class _g extends i.z{}class so{constructor(){this.constants=[1,1,.01],this.radius=0}setup(l,d){const y=i.ab.vec3.sub([],d,l);this.radius=i.ab.vec3.length(y[2]<0?i.ab.vec3.div([],y,this.constants):[y[0],y[1],0])}projectRay(l){i.ab.vec3.div(l,l,this.constants),i.ab.vec3.normalize(l,l),i.ab.vec3.mul(l,l,this.constants);const d=i.ab.vec3.scale([],l,this.radius);if(d[2]>0){const y=i.ab.vec3.scale([],[0,0,1],i.ab.vec3.dot(d,[0,0,1])),N=i.ab.vec3.scale([],i.ab.vec3.normalize([],[d[0],d[1],0]),this.radius),j=i.ab.vec3.add([],d,i.ab.vec3.scale([],i.ab.vec3.sub([],i.ab.vec3.add([],N,y),d),2));d[0]=j[0],d[1]=j[1]}return d}}function vd(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class em{constructor(l,d){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Gy(l),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new so,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),i.aP(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[N,j,C]of this._listeners){const F=N===document?this.handleWindowEvent:this.handleEvent;N.addEventListener(j,F,C)}}destroy(){for(const[l,d,y]of this._listeners){const N=l===document?this.handleWindowEvent:this.handleEvent;l.removeEventListener(d,N,y)}}_addDefaultHandlers(l){const d=this._map,y=d.getCanvasContainer();this._add("mapEvent",new yg(d,l));const N=d.boxZoom=new Na(d,l);this._add("boxZoom",N);const j=new gd,C=new Su;d.doubleClickZoom=new wu(C,j),this._add("tapZoom",j),this._add("clickZoom",C);const F=new Nu;this._add("tapDragZoom",F);const W=d.touchPitch=new J_(d);this._add("touchPitch",W);const Z=new Kl(l),Y=new $c(l);d.dragRotate=new wx(l,Z,Y),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate"]);const re=new Qp(l),ne=new ma(d,l);d.dragPan=new Yy(y,re,ne),this._add("mousePan",re),this._add("touchPan",ne,["touchZoom","touchRotate"]);const oe=new Of,_e=new Ky;d.touchZoomRotate=new Sx(y,_e,oe,F),this._add("touchRotate",oe,["touchPan","touchZoom"]),this._add("touchZoom",_e,["touchPan","touchRotate"]),this._add("blockableMapEvent",new X_(d));const ge=d.scrollZoom=new Zl(d,this);this._add("scrollZoom",ge,["mousePan"]);const Te=d.keyboard=new ao;this._add("keyboard",Te);for(const Ae of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[Ae]&&d[Ae].enable(l[Ae])}_add(l,d,y){this._handlers.push({handlerName:l,handler:d,allowed:y}),this._handlersById[l]=d}stop(l){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Rf(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(l,d,y){for(const N in l)if(N!==y&&(!d||d.indexOf(N)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const d=[];for(const y of l)this._el.contains(y.target)&&d.push(y);return d}handleEvent(l,d){this._updatingCamera=!0;const y=l.type==="renderFrame",N=y?void 0:l,j={needsRenderFrame:!1},C={},F={},W=l.touches?this._getMapTouches(l.touches):void 0,Z=W?Ce(this._el,W):y?void 0:he(this._el,l);for(const{handlerName:ne,handler:oe,allowed:_e}of this._handlers){if(!oe.isEnabled())continue;let ge;this._blockedByActive(F,_e,ne)?oe.reset():oe[d||l.type]&&(ge=oe[d||l.type](l,Z,W),this.mergeHandlerResult(j,C,ge,ne,N),ge&&ge.needsRenderFrame&&this._triggerRenderFrame()),(ge||oe.isActive())&&(F[ne]=oe)}const Y={};for(const ne in this._previousActiveHandlers)F[ne]||(Y[ne]=N);this._previousActiveHandlers=F,(Object.keys(Y).length||vd(j))&&(this._changes.push([j,C,Y]),this._triggerRenderFrame()),(Object.keys(F).length||vd(j))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:re}=j;re&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],re(this._map))}mergeHandlerResult(l,d,y,N,j){if(!y)return;i.l(l,y);const C={handlerName:N,originalEvent:y.originalEvent||j};y.zoomDelta!==void 0&&(d.zoom=C),y.panDelta!==void 0&&(d.drag=C),y.pitchDelta!==void 0&&(d.pitch=C),y.bearingDelta!==void 0&&(d.rotate=C)}_applyChanges(){const l={},d={},y={};for(const[N,j,C]of this._changes)N.panDelta&&(l.panDelta=(l.panDelta||new i.P(0,0))._add(N.panDelta)),N.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+N.zoomDelta),N.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+N.bearingDelta),N.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+N.pitchDelta),N.around!==void 0&&(l.around=N.around),N.aroundCoord!==void 0&&(l.aroundCoord=N.aroundCoord),N.pinchAround!==void 0&&(l.pinchAround=N.pinchAround),N.noInertia&&(l.noInertia=N.noInertia),i.l(d,j),i.l(y,C);this._updateMapTransform(l,d,y),this._changes=[]}_updateMapTransform(l,d,y){const N=this._map,j=N.transform,C=Re=>[Re.x,Re.y,Re.z];if((Re=>{const qe=this._eventsInProgress.drag;return qe&&!this._handlersById[qe.handlerName].isActive()})()&&!vd(l)){const Re=j.zoom;j.cameraElevationReference="sea",this._originalZoom!=null&&j._orthographicProjectionAtLowPitch&&j.projection.name!=="globe"&&j.pitch===0?(j.cameraElevationReference="ground",j.zoom=this._originalZoom):(j.recenterOnTerrain(),j.cameraElevationReference="ground"),Re!==j.zoom&&this._map._update(!0)}if(j._isCameraConstrained&&N._stop(!0),!vd(l))return void this._fireEvents(d,y,!0);let{panDelta:F,zoomDelta:W,bearingDelta:Z,pitchDelta:Y,around:re,aroundCoord:ne,pinchAround:oe}=l;j._isCameraConstrained&&(W>0&&(W=0),j._isCameraConstrained=!1),oe!==void 0&&(re=oe),(W||(Re=>d[Re]&&!this._eventsInProgress[Re])("drag"))&&re&&(this._dragOrigin=C(j.pointCoordinate3D(re)),this._originalZoom=j.zoom,this._trackingEllipsoid.setup(j._camera.position,this._dragOrigin)),j.cameraElevationReference="sea",N._stop(!0),re=re||N.transform.centerPoint,Z&&(j.bearing+=Z),Y&&(j.pitch+=Y),j._updateCameraState();const _e=[0,0,0];if(F)if(j.projection.name==="mercator"){const Re=this._trackingEllipsoid.projectRay(j.screenPointToMercatorRay(re).dir),qe=this._trackingEllipsoid.projectRay(j.screenPointToMercatorRay(re.sub(F)).dir);_e[0]=qe[0]-Re[0],_e[1]=qe[1]-Re[1]}else{const Re=j.pointCoordinate(re);if(j.projection.name==="globe"){F=F.rotate(-j.angle);const qe=j._pixelsPerMercatorPixel/j.worldSize;_e[0]=-F.x*i.dB(i.aS(Re.y))*qe,_e[1]=-F.y*i.dB(j.center.lat)*qe}else{const qe=j.pointCoordinate(re.sub(F));Re&&qe&&(_e[0]=qe.x-Re.x,_e[1]=qe.y-Re.y)}}const ge=j.zoom,Te=[0,0,0];if(W){const Re=C(ne||j.pointCoordinate3D(re)),qe={dir:i.ab.vec3.normalize([],i.ab.vec3.sub([],Re,j._camera.position))};if(qe.dir[2]<0){const Ue=j.zoomDeltaToMovement(Re,W);i.ab.vec3.scale(Te,qe.dir,Ue)}}const Ae=i.ab.vec3.add(_e,_e,Te);j._translateCameraConstrained(Ae),W&&Math.abs(j.zoom-ge)>1e-4&&j.recenterOnTerrain(),j.cameraElevationReference="ground",this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(d,y,!0)}_fireEvents(l,d,y){const N=Rf(this._eventsInProgress),j=Rf(l),C={};for(const Y in l){const{originalEvent:re}=l[Y];this._eventsInProgress[Y]||(C[`${Y}start`]=re),this._eventsInProgress[Y]=l[Y]}!N&&j&&this._fireEvent("movestart",j.originalEvent);for(const Y in C)this._fireEvent(Y,C[Y]);j&&this._fireEvent("move",j.originalEvent);for(const Y in l){const{originalEvent:re}=l[Y];this._fireEvent(Y,re)}const F={};let W;for(const Y in this._eventsInProgress){const{handlerName:re,originalEvent:ne}=this._eventsInProgress[Y];this._handlersById[re].isActive()||(delete this._eventsInProgress[Y],W=d[re]||ne,F[`${Y}end`]=W)}for(const Y in F)this._fireEvent(Y,F[Y]);const Z=Rf(this._eventsInProgress);if(y&&(N||j)&&!Z){this._updatingCamera=!0;const Y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),re=ne=>ne!==0&&-this._bearingSnap<ne&&ne<this._bearingSnap;Y?(re(Y.bearing||this._map.getBearing())&&(Y.bearing=0),this._map.easeTo(Y,{originalEvent:W})):(this._map.fire(new i.z("moveend",{originalEvent:W})),re(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,d){this._map.fire(new i.z(l,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{this._frameId=void 0,this.handleEvent(new _g("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Nx="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class wh extends i.E{constructor(l,d){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=d.bearingSnap,this._respectPrefersReducedMotion=d.respectPrefersReducedMotion!==!1,i.aP(["_renderFrameCallback"],this)}getCenter(){return new i.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(l,d){return this.jumpTo({center:l},d)}panBy(l,d,y){return l=i.P.convert(l).mult(-1),this.panTo(this.transform.center,i.l({offset:l},d),y)}panTo(l,d,y){return this.easeTo(i.l({center:l},d),y)}getZoom(){return this.transform.zoom}setZoom(l,d){return this.jumpTo({zoom:l},d),this}zoomTo(l,d,y){return this.easeTo(i.l({zoom:l},d),y)}zoomIn(l,d){return this.zoomTo(this.getZoom()+1,l,d),this}zoomOut(l,d){return this.zoomTo(this.getZoom()-1,l,d),this}getBearing(){return this.transform.bearing}setBearing(l,d){return this.jumpTo({bearing:l},d),this}getPadding(){return this.transform.padding}setPadding(l,d){return this.jumpTo({padding:l},d),this}rotateTo(l,d,y){return this.easeTo(i.l({bearing:l},d),y)}resetNorth(l,d){return this.rotateTo(0,i.l({duration:1e3},l),d),this}resetNorthPitch(l,d){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},l),d),this}snapToNorth(l,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,d):this}getPitch(){return this.transform.pitch}setPitch(l,d){return this.jumpTo({pitch:l},d),this}cameraForBounds(l,d){l=i.az.convert(l);const y=d&&d.bearing||0,N=d&&d.pitch||0,j=l.getNorthWest(),C=l.getSouthEast();return this._cameraForBounds(this.transform,j,C,y,N,d)}_extendPadding(l){const d={top:0,right:0,bottom:0,left:0};return l==null?i.l({},d,this.transform.padding):typeof l=="number"?{top:l,bottom:l,right:l,left:l}:i.l({},d,l)}_extendCameraOptions(l){return(l=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding=this._extendPadding(l.padding),l}_minimumAABBFrustumDistance(l,d){const y=d.max[0]-d.min[0],N=d.max[1]-d.min[1];return y/N>l.aspect?y/(2*Math.tan(.5*l.fovX)*l.aspect):N/(2*Math.tan(.5*l.fovY)*l.aspect)}_cameraForBoundsOnGlobe(l,d,y,N,j,C){const F=l.clone(),W=this._extendCameraOptions(C);F.bearing=N,F.pitch=j;const Z=i.bO.convert(d),Y=i.bO.convert(y),re=.5*(Z.lat+Y.lat),ne=.5*(Z.lng+Y.lng),oe=i.dC(re,ne),_e=i.ab.vec3.normalize([],oe),ge=i.ab.vec3.normalize([],i.ab.vec3.cross([],_e,[0,1,0])),Te=i.ab.vec3.cross([],ge,_e),Ae=[ge[0],ge[1],ge[2],0,Te[0],Te[1],Te[2],0,_e[0],_e[1],_e[2],0,0,0,0,1],Re=[oe,i.dC(Z.lat,Z.lng),i.dC(Y.lat,Z.lng),i.dC(Y.lat,Y.lng),i.dC(Z.lat,Y.lng),i.dC(re,Z.lng),i.dC(re,Y.lng),i.dC(Z.lat,ne),i.dC(Y.lat,ne)];let qe=i.cd.fromPoints(Re.map(jt=>[i.ab.vec3.dot(ge,jt),i.ab.vec3.dot(Te,jt),i.ab.vec3.dot(_e,jt)]));const Ue=i.ab.vec3.transformMat4([],qe.center,Ae);i.ab.vec3.squaredLength(Ue)===0&&i.ab.vec3.set(Ue,0,0,1),i.ab.vec3.normalize(Ue,Ue),i.ab.vec3.scale(Ue,Ue,i.ax),F.center=i.dD(Ue);const Qe=F.getWorldToCameraMatrix(),Ke=i.ab.mat4.invert(new Float64Array(16),Qe);qe=i.cd.applyTransform(qe,i.ab.mat4.multiply([],Qe,Ae));const Ze=this._extendAABB(qe,F,W,N);if(!Ze)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");qe=Ze,i.ab.vec3.transformMat4(Ue,Ue,Qe);const He=.5*(qe.max[2]-qe.min[2]),Xe=this._minimumAABBFrustumDistance(F,qe),at=i.ab.vec3.scale([],[0,0,1],He),_t=i.ab.vec3.add(at,Ue,at),mt=Xe+(F.pitch===0?0:i.ab.vec3.distance(Ue,_t)),kt=F.globeCenterInViewSpace,Pt=i.ab.vec3.sub([],Ue,[kt[0],kt[1],kt[2]]);i.ab.vec3.normalize(Pt,Pt),i.ab.vec3.scale(Pt,Pt,mt);const ht=i.ab.vec3.add([],Ue,Pt);i.ab.vec3.transformMat4(ht,ht,Ke);const Tt=i.ds/i.ax,$t=i.ab.vec3.length(ht),pt=i.bH(Math.max($t*Tt-i.ds,Number.EPSILON),0),Lt=Math.min(F.zoomFromMercatorZAdjusted(pt),W.maxZoom);return Lt>.5*(i.c6+i.bY)?(F.setProjection({name:"mercator"}),F.zoom=Lt,this._cameraForBounds(F,d,y,N,j,C)):{center:F.center,zoom:Lt,bearing:N,pitch:j}}_extendAABB(l,d,y,N){const j=.5*((y.padding.left||0)+(y.padding.right||0)),C=.5*((y.padding.top||0)+(y.padding.bottom||0)),F=C,W=j,Z=j,Y=C,re=d.width-(W+Z),ne=d.height-(F+Y),oe=i.ab.vec3.sub([],l.max,l.min),_e=Math.min(re/oe[0],ne/oe[1]),ge=Math.min(d.scaleZoom(d.scale*_e),y.maxZoom);if(isNaN(ge))return null;const Te=d.scale/d.zoomScale(ge),Ae=new i.cd([l.min[0]-W*Te,l.min[1]-Y*Te,l.min[2]],[l.max[0]+Z*Te,l.max[1]+F*Te,l.max[2]]),Re=(typeof y.offset.x=="number"&&typeof y.offset.y=="number"?new i.P(y.offset.x,y.offset.y):i.P.convert(y.offset)).rotate(-i.ai(N));return Ae.center[0]-=Re.x*Te,Ae.center[1]+=Re.y*Te,Ae}queryTerrainElevation(l,d){const y=this.transform.elevation;return y?(d=i.l({},{exaggerated:!0},d),y.getAtPoint(i.aa.fromLngLat(l),null,d.exaggerated)):null}_cameraForBounds(l,d,y,N,j,C){if(l.projection.name==="globe")return this._cameraForBoundsOnGlobe(l,d,y,N,j,C);const F=l.clone(),W=this._extendCameraOptions(C);F.bearing=N,F.pitch=j;const Z=i.bO.convert(d),Y=i.bO.convert(y),re=new i.bO(Z.lng,Y.lat),ne=new i.bO(Y.lng,Z.lat),oe=F.project(Z),_e=F.project(Y),ge=this.queryTerrainElevation(Z),Te=this.queryTerrainElevation(Y),Ae=this.queryTerrainElevation(re),Re=this.queryTerrainElevation(ne),qe=[[oe.x,oe.y,Math.min(ge||0,Te||0,Ae||0,Re||0)],[_e.x,_e.y,Math.max(ge||0,Te||0,Ae||0,Re||0)]];let Ue=i.cd.fromPoints(qe);const Qe=F.getWorldToCameraMatrix(),Ke=i.ab.mat4.invert(new Float64Array(16),Qe);Ue=i.cd.applyTransform(Ue,Qe);const Ze=this._extendAABB(Ue,F,W,N);if(!Ze)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ue=Ze;const He=.5*i.ab.vec3.sub([],Ue.max,Ue.min)[2],Xe=this._minimumAABBFrustumDistance(F,Ue),at=[0,0,1,0];i.ab.vec4.transformMat4(at,at,Qe),i.ab.vec4.normalize(at,at);const _t=i.ab.vec3.scale([],at,Xe+He),mt=i.ab.vec3.add([],Ue.center,_t);i.ab.vec3.transformMat4(Ue.center,Ue.center,Ke),i.ab.vec3.transformMat4(mt,mt,Ke);const kt=F.unproject(new i.P(Ue.center[0],Ue.center[1])),Pt=i.dE(F.projection,kt),ht=Math.pow(2,Pt),Tt=Math.min(F._zoomFromMercatorZ(mt[2]*F.pixelsPerMeter*ht/F.worldSize),W.maxZoom);return F.mercatorFromTransition&&Tt<.5*(i.c6+i.bY)?(F.setProjection({name:"globe"}),F.zoom=Tt,this._cameraForBounds(F,d,y,N,j,C)):{center:kt,zoom:Tt,bearing:N,pitch:j}}fitBounds(l,d,y){const N=this.cameraForBounds(l,d);return this._fitInternal(N,d,y)}fitScreenCoordinates(l,d,y,N,j){const C=i.P.convert(l),F=i.P.convert(d),W=new i.P(Math.min(C.x,F.x),Math.min(C.y,F.y)),Z=new i.P(Math.max(C.x,F.x),Math.max(C.y,F.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(C,F))return this;const Y=this.transform.pointLocation3D(W),re=this.transform.pointLocation3D(Z),ne=this.transform.pointLocation3D(new i.P(W.x,Z.y)),oe=this.transform.pointLocation3D(new i.P(Z.x,W.y)),_e=[Math.min(Y.lng,re.lng,ne.lng,oe.lng),Math.min(Y.lat,re.lat,ne.lat,oe.lat)],ge=[Math.max(Y.lng,re.lng,ne.lng,oe.lng),Math.max(Y.lat,re.lat,ne.lat,oe.lat)],Te=N&&N.pitch?N.pitch:this.getPitch(),Ae=this._cameraForBounds(this.transform,_e,ge,y,Te,N);return this._fitInternal(Ae,N,j)}_fitInternal(l,d,y){return l?(d=i.l(l,d)).linear?this.easeTo(d,y):this.flyTo(d,y):this}jumpTo(l,d){this.stop();const y=l.preloadOnly?this.transform.clone():this.transform;let N=!1,j=!1,C=!1;"zoom"in l&&y.zoom!==+l.zoom&&(N=!0,y.zoom=+l.zoom),l.center!==void 0&&(y.center=i.bO.convert(l.center)),"bearing"in l&&y.bearing!==+l.bearing&&(j=!0,y.bearing=+l.bearing),"pitch"in l&&y.pitch!==+l.pitch&&(C=!0,y.pitch=+l.pitch);const F=typeof l.padding=="number"?this._extendPadding(l.padding):l.padding;if(l.padding!=null&&!y.isPaddingEqual(F))if(l.retainPadding===!1){const W=y.clone();W.padding=F,y.setLocationAtPoint(y.center,W.centerPoint)}else y.padding=F;return l.preloadOnly?(this._preloadTiles(y),this):(this.fire(new i.z("movestart",d)).fire(new i.z("move",d)),N&&this.fire(new i.z("zoomstart",d)).fire(new i.z("zoom",d)).fire(new i.z("zoomend",d)),j&&this.fire(new i.z("rotatestart",d)).fire(new i.z("rotate",d)).fire(new i.z("rotateend",d)),C&&this.fire(new i.z("pitchstart",d)).fire(new i.z("pitch",d)).fire(new i.z("pitchend",d)),this.fire(new i.z("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(Nx),this.transform.getFreeCameraOptions()}setFreeCameraOptions(l,d){const y=this.transform;if(!y.projection.supportsFreeCamera)return i.w(Nx),this;this.stop();const N=y.zoom,j=y.pitch,C=y.bearing;y.setFreeCameraOptions(l);const F=N!==y.zoom,W=j!==y.pitch,Z=C!==y.bearing;return this.fire(new i.z("movestart",d)).fire(new i.z("move",d)),F&&this.fire(new i.z("zoomstart",d)).fire(new i.z("zoom",d)).fire(new i.z("zoomend",d)),Z&&this.fire(new i.z("rotatestart",d)).fire(new i.z("rotate",d)).fire(new i.z("rotateend",d)),W&&this.fire(new i.z("pitchstart",d)).fire(new i.z("pitch",d)).fire(new i.z("pitchend",d)),this.fire(new i.z("moveend",d)),this}easeTo(l,d){this._stop(!1,l.easeId),((l=i.l({offset:[0,0],duration:500,easing:i.dA},l)).animate===!1||this._prefersReducedMotion(l))&&(l.duration=0);const y=this.transform,N=this.getZoom(),j=this.getBearing(),C=this.getPitch(),F=this.getPadding(),W="zoom"in l?+l.zoom:N,Z="bearing"in l?this._normalizeBearing(l.bearing,j):j,Y="pitch"in l?+l.pitch:C,re=this._extendPadding(l.padding),ne=i.P.convert(l.offset);let oe,_e,ge;if(y.projection.name==="globe"){const at=i.aa.fromLngLat(y.center),_t=ne.rotate(-y.angle);at.x+=_t.x/y.worldSize,at.y+=_t.y/y.worldSize;const mt=at.toLngLat(),kt=i.bO.convert(l.center||mt);this._normalizeCenter(kt),oe=y.centerPoint.add(_t),_e=new i.P(at.x,at.y).mult(y.worldSize),ge=new i.P(i.at(kt.lng),i.aA(kt.lat)).mult(y.worldSize).sub(_e)}else{oe=y.centerPoint.add(ne);const at=y.pointLocation(oe),_t=i.bO.convert(l.center||at);this._normalizeCenter(_t),_e=y.project(at),ge=y.project(_t).sub(_e)}const Te=y.zoomScale(W-N);let Ae,Re;l.around&&(Ae=i.bO.convert(l.around),Re=y.locationPoint(Ae));const qe=this._zooming||W!==N,Ue=this._rotating||j!==Z,Qe=this._pitching||Y!==C,Ke=!y.isPaddingEqual(re),Ze=l.retainPadding===!1?y.clone():y,He=at=>_t=>{if(qe&&(at.zoom=i.af(N,W,_t)),Ue&&(at.bearing=i.af(j,Z,_t)),Qe&&(at.pitch=i.af(C,Y,_t)),Ke&&(Ze.interpolatePadding(F,re,_t),oe=Ze.centerPoint.add(ne)),Ae)at.setLocationAtPoint(Ae,Re);else{const mt=at.zoomScale(at.zoom-N),kt=W>N?Math.min(2,Te):Math.max(.5,Te),Pt=Math.pow(kt,1-_t),ht=at.unproject(_e.add(ge.mult(_t*Pt)).mult(mt));at.setLocationAtPoint(at.renderWorldCopies?ht.wrap():ht,oe)}return l.preloadOnly||this._fireMoveEvents(d),at};if(l.preloadOnly){const at=this._emulate(He,l.duration,y);return this._preloadTiles(at),this}const Xe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=qe,this._rotating=Ue,this._pitching=Qe,this._padding=Ke,this._easeId=l.easeId,this._prepareEase(d,l.noMoveStart,Xe),this._ease(He(y),at=>{y.cameraElevationReference==="sea"&&y.recenterOnTerrain(),this._afterEase(d,at)},l),this}_prepareEase(l,d,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),d||y.moving||this.fire(new i.z("movestart",l)),this._zooming&&!y.zooming&&this.fire(new i.z("zoomstart",l)),this._rotating&&!y.rotating&&this.fire(new i.z("rotatestart",l)),this._pitching&&!y.pitching&&this.fire(new i.z("pitchstart",l))}_fireMoveEvents(l){this.fire(new i.z("move",l)),this._zooming&&this.fire(new i.z("zoom",l)),this._rotating&&this.fire(new i.z("rotate",l)),this._pitching&&this.fire(new i.z("pitch",l))}_afterEase(l,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,N=this._rotating,j=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new i.z("zoomend",l)),N&&this.fire(new i.z("rotateend",l)),j&&this.fire(new i.z("pitchend",l)),this.fire(new i.z("moveend",l))}flyTo(l,d){if(this._prefersReducedMotion(l)){const jt=i.ay(l,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(jt,d)}this.stop(),l=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.dA},l);const y=this.transform,N=this.getZoom(),j=this.getBearing(),C=this.getPitch(),F=this.getPadding(),W="zoom"in l?i.aw(+l.zoom,y.minZoom,y.maxZoom):N,Z="bearing"in l?this._normalizeBearing(l.bearing,j):j,Y="pitch"in l?+l.pitch:C,re=this._extendPadding(l.padding),ne=y.zoomScale(W-N),oe=i.P.convert(l.offset);let _e=y.centerPoint.add(oe);const ge=y.pointLocation(_e),Te=i.bO.convert(l.center||ge);this._normalizeCenter(Te);const Ae=y.project(ge),Re=y.project(Te).sub(Ae);let qe=l.curve;const Ue=Math.max(y.width,y.height),Qe=Ue/ne,Ke=Re.mag();if("minZoom"in l){const jt=i.aw(Math.min(l.minZoom,N,W),y.minZoom,y.maxZoom),Xt=Ue/y.zoomScale(jt-N);qe=Math.sqrt(Xt/Ke*2)}const Ze=qe*qe;function He(jt){const Xt=(Qe*Qe-Ue*Ue+(jt?-1:1)*Ze*Ze*Ke*Ke)/(2*(jt?Qe:Ue)*Ze*Ke);return Math.log(Math.sqrt(Xt*Xt+1)-Xt)}function Xe(jt){return(Math.exp(jt)-Math.exp(-jt))/2}function at(jt){return(Math.exp(jt)+Math.exp(-jt))/2}const _t=He(0);let mt=function(jt){return at(_t)/at(_t+qe*jt)},kt=function(jt){return Ue*((at(_t)*(Xe(Xt=_t+qe*jt)/at(Xt))-Xe(_t))/Ze)/Ke;var Xt},Pt=(He(1)-_t)/qe;if(Math.abs(Ke)<1e-6||!isFinite(Pt)){if(Math.abs(Ue-Qe)<1e-6)return this.easeTo(l,d);const jt=Qe<Ue?-1:1;Pt=Math.abs(Math.log(Qe/Ue))/qe,kt=function(){return 0},mt=function(Xt){return Math.exp(jt*qe*Xt)}}l.duration="duration"in l?+l.duration:1e3*Pt/("screenSpeed"in l?+l.screenSpeed/qe:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0);const ht=j!==Z,Tt=Y!==C,$t=!y.isPaddingEqual(re),pt=l.retainPadding===!1?y.clone():y,Lt=jt=>Xt=>{const Vt=Xt*Pt,It=1/mt(Vt);jt.zoom=Xt===1?W:N+jt.scaleZoom(It),ht&&(jt.bearing=i.af(j,Z,Xt)),Tt&&(jt.pitch=i.af(C,Y,Xt)),$t&&(pt.interpolatePadding(F,re,Xt),_e=pt.centerPoint.add(oe));const Ht=Xt===1?Te:jt.unproject(Ae.add(Re.mult(kt(Vt))).mult(It));return jt.setLocationAtPoint(jt.renderWorldCopies?Ht.wrap():Ht,_e),jt._updateCameraOnTerrain(),l.preloadOnly||this._fireMoveEvents(d),jt};if(l.preloadOnly){const jt=this._emulate(Lt,l.duration,y);return this._preloadTiles(jt),this}return this._zooming=!0,this._rotating=ht,this._pitching=Tt,this._padding=$t,this._prepareEase(d,!1),this._ease(Lt(y),()=>this._afterEase(d),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(l){}_cancelRenderFrame(l){}_stop(l,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,d)}if(!l){const y=this.handlers;y&&y.stop(!1)}return this}_ease(l,d,y){y.animate===!1||y.duration===0?(l(1),d()):(this._easeStart=i.q.now(),this._easeOptions=y,this._onEaseFrame=l,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,d){l=i.bF(l,-180,180);const y=Math.abs(l-d);return Math.abs(l-360-d)<y&&(l-=360),Math.abs(l+360-d)<y&&(l+=360),l}_normalizeCenter(l){const d=this.transform;if(d.maxBounds||d.projection.name!=="globe"&&!d.renderWorldCopies)return;const y=l.lng-d.center.lng;l.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(l){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(l&&l.essential)}_emulate(l,d,y){const N=Math.ceil(15*d/1e3),j=[],C=l(y.clone());for(let F=0;F<=N;F++){const W=C(F/N);j.push(W.clone())}return j}_preloadTiles(l,d){}}class If{constructor(l={}){this.options=l,i.aP(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){const d=this.options&&this.options.compact,y=l._getUIString("AttributionControl.ToggleAttribution");this._map=l,this._container=I("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=I("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",y);const N=I("span","mapboxgl-ctrl-icon",this._compactButton);return N.setAttribute("aria-hidden","true"),N.setAttribute("title",y),this._innerContainer=I("div","mapboxgl-ctrl-attrib-inner",this._container),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),d===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(l){const y=d.reduce((N,j,C)=>(j.value&&(N+=`${j.key}=${j.value}${C<d.length-1?"&":""}`),N),"?");l.href=`${i.e.FEEDBACK_URL}/${y}#${gg(this._map,!0)}`,l.rel="noopener nofollow"}}_updateData(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let l=[];if(this._map.style.stylesheet){const N=this._map.style.stylesheet;this.styleOwner=N.owner,this.styleId=N.id}const d=this._map.style._mergedSourceCaches;for(const N in d){const j=d[N];if(j.used){const C=j.getSource();C.attribution&&l.indexOf(C.attribution)<0&&l.push(C.attribution)}}l.sort((N,j)=>N.length-j.length),l=l.filter((N,j)=>{for(let C=j+1;C<l.length;C++)if(l[C].indexOf(N)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=[...this.options.customAttribution,...l]:l.unshift(this.options.customAttribution));const y=l.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,l.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class il{constructor(){i.aP(["_updateLogo","_updateCompact"],this)}onAdd(l){this._map=l,this._container=I("div","mapboxgl-ctrl");const d=I("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(l){l&&l.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const l=this._map.style._sourceCaches;if(Object.entries(l).length===0)return!0;for(const d in l){const y=l[d].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const l=this._container.children;if(l.length){const d=l[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class So{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const d=++this._id;return this._queue.push({callback:l,id:d,cancelled:!1}),d}remove(l){const d=this._currentlyRunning,y=d?this._queue.concat(d):this._queue;for(const N of y)if(N.id===l)return void(N.cancelled=!0)}run(l=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const y of d)if(!y.cancelled&&(y.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class al{constructor(l){this.jumpTo(l)}getValue(l){if(l<=this._startTime)return this._start;if(l>=this._endTime)return this._end;const d=i.cB((l-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(l){return l>=this._startTime&&l<=this._endTime}jumpTo(l){this._startTime=-1/0,this._endTime=-1/0,this._start=l,this._end=l}easeTo(l,d,y){this._start=this.getValue(d),this._end=l,this._startTime=d,this._endTime=d+y}}const Sh={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class _d extends i.z{constructor(l,d,y,N){const{point:j,lngLat:C,originalEvent:F,target:W}=l;super(l.type,{point:j,lngLat:C,originalEvent:F,target:W}),this.preventDefault=()=>{l.preventDefault()},this.id=d,this.interaction=y,this.feature=N}}class tm{constructor(l){this.map=l,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(l,d){if(this.typeById.has(l))throw new Error(`Interaction id "${l}" already exists.`);const y=d.filter;let N=d.type;y&&this.filters.set(l,i.aZ(y)),N==="mouseover"&&(N="mouseenter"),N==="mouseout"&&(N="mouseleave");const j=this.interactionsByType.get(N)||new Map;N==="mouseenter"||N==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(l,d)):j.size===0&&this.map.on(N,this.handleType),j.size===0&&this.interactionsByType.set(N,j),j.set(l,d),this.typeById.set(l,N)}get(l){const d=this.typeById.get(l);if(!d)return;const y=this.interactionsByType.get(d);return y?y.get(l):void 0}remove(l){const d=this.typeById.get(l);if(!d)return;this.typeById.delete(l),this.filters.delete(l);const y=this.interactionsByType.get(d);y&&(y.delete(l),d==="mouseenter"||d==="mouseleave"?(this.delegatedInteractions.delete(l),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):y.size===0&&this.map.off(d,this.handleType))}queryTargets(l,d){const y=[];for(const[N,j]of d)j.target&&y.push({targetId:N,target:j.target,filter:this.filters.get(N)});return this.map.style.queryRenderedTargets(l,y,this.map.transform)}handleMove(l){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const d=this.queryTargets(l.point,Array.from(this.delegatedInteractions).reverse());d.length&&(l.type="mouseenter",this.handleType(l,d));const y=new Map;for(const[N,{feature:j}]of this.prevHoveredFeatures)this.hoveredFeatures.has(N)||y.set(j.id,j);y.size&&(l.type="mouseleave",this.handleType(l,Array.from(y.values())))}handleOut(l){const d=Array.from(this.hoveredFeatures.values()).map(({feature:y})=>y);d.length&&(l.type="mouseleave",this.handleType(l,d)),this.hoveredFeatures.clear()}handleType(l,d){const y=Array.from(this.interactionsByType.get(l.type)).reverse(),N=!!d;d=d||this.queryTargets(l.point,y);const j=l.type==="mouseenter";let C=!1;const F=new Set;for(const W of d){for(const[Z,Y]of y){if(!Y.target)continue;const re=W.variants?W.variants[Z]:null;if(re){for(const ne of re){if(Dl(ne,W,F,Z))continue;const oe=new i.cw(W,ne),_e=Wu(ne,W,Z);N&&(oe.state=this.map.getFeatureState(oe));const ge=j?this.prevHoveredFeatures.get(_e):null,Te=new _d(l,Z,Y,oe),Ae=ge?ge.stop:Y.handler(Te);if(j&&this.hoveredFeatures.set(_e,{feature:W,stop:Ae}),Ae!==!1){C=!0;break}}if(C)break}}if(C)break}if(!C)for(const[W,Z]of y){const{handler:Y,target:re}=Z;if(!re&&Y(new _d(l,W,Z,null))!==!1)break}}}function Kn(g,l){if(Array.isArray(g)&&Array.isArray(l)){const d=new Set(g),y=new Set(l);return d.size===y.size&&g.every(N=>y.has(N))}return i.bn(g,l)}const Au={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},rm={showCompass:!0,showZoom:!0,visualizePitch:!1};class No{constructor(l,d,y=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new Kl({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,y&&(this.mousePitch=new $c({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),i.aP(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(l,d){this.mouseRotate.mousedown(l,d),this.mousePitch&&this.mousePitch.mousedown(l,d),ae()}move(l,d){const y=this.map,N=this.mouseRotate.mousemoveWindow(l,d),j=N&&N.bearingDelta;if(j&&y.setBearing(y.getBearing()+j),this.mousePitch){const C=this.mousePitch.mousemoveWindow(l,d),F=C&&C.pitchDelta;F&&y.setPitch(y.getPitch()+F)}}off(){const l=this.element;l.removeEventListener("mousedown",this.mousedown),l.removeEventListener("touchstart",this.touchstart,{passive:!1}),l.removeEventListener("touchmove",this.touchmove),l.removeEventListener("touchend",this.touchend),l.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ee(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(l){this.down(i.l({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),he(this.element,l)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(l){this.move(l,he(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ce(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){l.targetTouches.length!==1?this.reset():(this._lastPos=Ce(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function bg(g,l,d){if(g=new i.bO(g.lng,g.lat),l){const y=new i.bO(g.lng-360,g.lat),N=new i.bO(g.lng+360,g.lat),j=360*Math.ceil(Math.abs(g.lng-d.center.lng)/360),C=d.locationPoint(g).distSqr(l),F=l.x<0||l.y<0||l.x>d.width||l.y>d.height;d.locationPoint(y).distSqr(l)<C&&(F||Math.abs(y.lng-d.center.lng)<j)?g=y:d.locationPoint(N).distSqr(l)<C&&(F||Math.abs(N.lng-d.center.lng)<j)&&(g=N)}for(;Math.abs(g.lng-d.center.lng)>180;){const y=d.locationPoint(g);if(y.x>=0&&y.y>=0&&y.x<=d.width&&y.y<=d.height)break;g.lng>d.center.lng?g.lng-=360:g.lng+=360}return g}const Gc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class sl extends i.E{constructor(l,d){if(super(),(l instanceof HTMLElement||d)&&(l=i.l({element:l},d)),i.aP(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=l&&l.occludedOpacity||.2,l&&l.element)this._element=l.element,this._offset=i.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=I("div");const j=41,C=27,F=V("svg",{display:"block",height:j*this._scale+"px",width:C*this._scale+"px",viewBox:`0 0 ${C} ${j}`},this._element),W=V("radialGradient",{id:"shadowGradient"},V("defs",{},F));V("stop",{offset:"10%","stop-opacity":.4},W),V("stop",{offset:"100%","stop-opacity":.05},W),V("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},F),V("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},F),V("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},F),V("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},F),this._offset=i.P.convert(l&&l.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",j=>{j.preventDefault()}),this._element.addEventListener("mousedown",j=>{j.preventDefault()});const y=this._element.classList;for(const j in Gc)y.remove(`mapboxgl-marker-anchor-${j}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`);const N=l&&l.className?l.className.trim().split(/\s+/):[];y.add(...N),this._popup=null}addTo(l){return l===this._map||(this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._updateMoving),l.on("moveend",this._update),l.on("remove",this._clearFadeTimer),l._addMarker(this),this.setDraggable(this._draggable),this._update(),l.on("click",this._onMapClick)),this}remove(){const l=this._map;return l&&(l.off("click",this._onMapClick),l.off("move",this._updateMoving),l.off("moveend",this._update),l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler),l.off("mouseup",this._onUp),l.off("touchend",this._onUp),l.off("mousemove",this._onMove),l.off("touchmove",this._onMove),l.off("remove",this._clearFadeTimer),l._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=i.bO.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const N=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[N,-1*(38.1-13.5+N)],"bottom-right":[-N,-1*(38.1-13.5+N)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,l._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(l){const d=l.code,y=l.charCode||l.keyCode;d!=="Space"&&d!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(l){const d=l.originalEvent.target,y=this._element;this._popup&&(d===y||y.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?(l.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(l.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const l=this._map,d=this._pos;if(!l||!d)return!1;const y=l.unproject(d),N=l.getFreeCameraOptions();if(!N.position)return!1;const j=N.position.toLngLat();return j.distanceTo(y)<.9*j.distanceTo(this._lngLat)}_evaluateOpacity(){const l=this._map;if(!l)return;const d=this._pos;if(!d||d.x<0||d.x>l.transform.width||d.y<0||d.y>l.transform.height)return void this._clearFadeTimer();const y=l.unproject(d);let N;l._showingGlobe()&&i.dH(l.transform,this._lngLat)?N=0:(N=1-l._queryFogOpacity(y),l.transform._terrainEnabled()&&l.getTerrain()&&this._behindTerrain()&&(N*=this._occludedOpacity)),this._element.style.opacity=`${N}`,this._element.style.pointerEvents=N>0?"auto":"none",this._popup&&this._popup._setOpacity(N),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const l=this._pos;if(!l||!this._map)return;const d=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${l.x}px,${l.y}px)
            ${Gc[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${d.x}px,${d.y}px)
        `}_calculateXYTransform(){const l=this._pos,d=this._map,y=this.getPitchAlignment();if(!d||!l||y!=="map")return"";if(!d._showingGlobe()){const W=d.getPitch();return W?`rotateX(${W}deg)`:""}const N=i.c4(i.dI(d.transform,this._lngLat)),j=l.sub(i.dJ(d.transform)),C=Math.abs(j.x)+Math.abs(j.y);if(C===0)return"";const F=N/C;return`rotateX(${-j.y*F}deg) rotateY(${j.x*F}deg)`}_calculateZTransform(){const l=this._pos,d=this._map;if(!d||!l)return"";let y=0;const N=this.getRotationAlignment();if(N==="map")if(d._showingGlobe()){const j=d.project(new i.bO(this._lngLat.lng,this._lngLat.lat+.001)),C=d.project(new i.bO(this._lngLat.lng,this._lngLat.lat-.001)).sub(j);y=i.c4(Math.atan2(C.y,C.x))-90}else y=-d.getBearing();else if(N==="horizon"){const j=i.ac(4,6,d.getZoom()),C=i.dJ(d.transform);C.y+=j*d.transform.height;const F=l.sub(C),W=i.c4(Math.atan2(F.y,F.x));y=(W>90?W-270:W+90)*(1-j)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(l){cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=bg(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat),l===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(l){return this._offset=i.P.convert(l),this._update(),this}addClassName(l){return this._element.classList.add(l),this}removeClassName(l){return this._element.classList.remove(l),this}toggleClassName(l){return this._element.classList.toggle(l)}_onMove(l){const d=this._map;if(!d)return;const y=this._pointerdownPos,N=this._positionDelta;if(y&&N){if(!this._isDragging){const j=this._clickTolerance||d._clickTolerance;if(l.point.dist(y)<j)return;this._isDragging=!0}this._pos=l.point.sub(N),this._lngLat=d.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const l=this._map;l&&(l.off("mousemove",this._onMove),l.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(l){const d=this._map,y=this._pos;d&&y&&this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(y),this._pointerdownPos=l.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(l){this._draggable=!!l;const d=this._map;return d&&(l?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(l){return this._occludedOpacity=l||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Gi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},ol={maxWidth:100,unit:"metric"},Br={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Nh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},oo=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function wg(g=new i.P(0,0),l="bottom"){if(typeof g=="number"){const d=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(l){case"top":return new i.P(0,g);case"top-left":return new i.P(d,d);case"top-right":return new i.P(-d,d);case"bottom":return new i.P(0,-g);case"bottom-left":return new i.P(d,-d);case"bottom-right":return new i.P(-d,-d);case"left":return new i.P(g,0);case"right":return new i.P(-g,0)}return new i.P(0,0)}return g instanceof i.P||Array.isArray(g)?i.P.convert(g):i.P.convert(g[l]||[0,0])}return{version:x,supported:U.supported,setRTLTextPlugin:i.dK,getRTLTextPluginStatus:i.dL,Map:class extends wh{constructor(g){S.mark(w.create);const l=g;if((g=i.l({},Au,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&i.dF(window)&&(g.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new df(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._repaint=!!g.repaint,this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new So,this._domRenderTaskQueue=new So,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aV(),this._locale=i.l({},Sh,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._tessellationStep=g.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=g.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new al(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=g.scaleFactor,this._requestManager=new Se(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,this._contextCreateOptions=g.contextCreateOptions?Object.assign({},g.contextCreateOptions):{},typeof g.container=="string"){const d=document.getElementById(g.container);if(!d)throw new Error(`Container '${g.container.toString()}' not found.`);this._container=d}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),this._spriteFormat=g.spriteFormat,i.aP(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new hg),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new em(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,(g.style||!g.testMode)&&this.setStyle(g.style||i.e.DEFAULT_STYLE,{config:g.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this.indoor=new ky(this),g.hash&&(this._hash=new Vy(typeof g.hash=="string"&&g.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){l.center==null&&l.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch});const d=g.bounds;d&&(this.resize(),this.fitBounds(d,i.l({},g.fitBoundsOptions,{duration:0})))}this.resize(),g.attributionControl&&this.addControl(new If({customAttribution:g.customAttribution})),this._logoControl=new il,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",d=>{this._update(d.dataType==="style"),this.fire(new i.z(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new i.z(`${d.dataType}dataloading`,d))}),this._interactions=new tm(this)}_getMapId(){return this._mapId}addControl(g,l){if(l===void 0&&(l=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=g.onAdd(this);this._controls.push(g);const y=this._controlPositions[l];return l.indexOf("bottom")!==-1?y.insertBefore(d,y.firstChild):y.appendChild(d),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(g);return l>-1&&this._controls.splice(l,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const l=!this._moving;return l&&this.fire(new i.z("movestart",g)).fire(new i.z("move",g)),this.fire(new i.z("resize",g)),l&&this.fire(new i.z("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(i.az.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(g){return this._scaleFactor=g,this.painter.scaleFactor=g,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(l=>l.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?navigator.language:Array.isArray(g)?g.length===0?void 0:g.map(l=>l==="auto"?navigator.language:l):g}setLanguage(g){const l=this._parseLanguage(g);if(!this.style||l===this._language)return this;this._language=l,this.style.reloadSources();for(const d of this._controls)d._setLanguage&&d._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,l=g.projection.name;let d;l==="globe"&&g.zoom>=i.bY?(g.setMercatorFromTransition(),d=!0):l==="mercator"&&g.zoom<i.bY&&(g.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(g,l){return this._updateProjection(g||l||{name:"mercator"})}_updateProjection(g){let l;return l=g.name==="globe"&&this.transform.zoom>=i.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),l&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(g){return this.transform.locationPoint3D(i.bO.convert(g))}unproject(g){return this.transform.pointLocation3D(i.P.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,l,d){const y=N=>{let j=[];if(Array.isArray(l)){const C=l.filter(F=>this.getLayer(F));j=C.length?this.queryRenderedFeatures(N,{layers:C}):[]}else j=this.queryRenderedFeatures(N,{target:l});return j};if(g==="mouseenter"||g==="mouseover"){let N=!1;return{listener:d,targets:l,delegates:{mousemove:C=>{const F=y(C.point);F.length?N||(N=!0,d.call(this,new zo(g,this,C.originalEvent,{features:F}))):N=!1},mouseout:()=>{N=!1}}}}if(g==="mouseleave"||g==="mouseout"){let N=!1;return{listener:d,targets:l,delegates:{mousemove:F=>{y(F.point).length?N=!0:N&&(N=!1,d.call(this,new zo(g,this,F.originalEvent)))},mouseout:F=>{N&&(N=!1,d.call(this,new zo(g,this,F.originalEvent)))}}}}{const N=j=>{const C=y(j.point);C.length&&(j.features=C,d.call(this,j),delete j.features)};return{listener:d,targets:l,delegates:{[g]:N}}}}on(g,l,d){if(typeof l=="function"||d===void 0)return super.on(g,l);if(typeof l=="string"&&(l=[l]),!this._areTargetsValid(l))return this;const y=this._createDelegatedListener(g,l,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(y);for(const N in y.delegates)this.on(N,y.delegates[N]);return this}once(g,l,d){if(typeof l=="function"||d===void 0)return super.once(g,l);if(typeof l=="string"&&(l=[l]),!this._areTargetsValid(l))return this;const y=this._createDelegatedListener(g,l,d);for(const N in y.delegates)this.once(N,y.delegates[N]);return this}off(g,l,d){if(typeof l=="function"||d===void 0)return super.off(g,l);if(typeof l=="string"&&(l=[l]),!this._areTargetsValid(l))return this;const y=this._delegatedListeners?this._delegatedListeners[g]:void 0;return y&&(N=>{for(let j=0;j<N.length;j++){const C=N[j];if(C.listener===d&&Kn(C.targets,l)){for(const F in C.delegates)this.off(F,C.delegates[F]);return N.splice(j,1),this}}})(y),this}queryRenderedFeatures(g,l){if(!this.style)return[];if(g===void 0||g instanceof i.P||Array.isArray(g)||l!==void 0||(l=g,g=void 0),g=g||[[0,0],[this.transform.width,this.transform.height]],!l){const j=this.style.queryRenderedFeatures(g,void 0,this.transform),C=this.style.queryRenderedFeatureset(g,void 0,this.transform);return j.concat(C)}let d=!0;if(l.target&&(d=this._isTargetValid(l.target),d&&!l.layers))return this.style.queryRenderedFeatureset(g,l,this.transform);let y=!0;if(l.layers&&Array.isArray(l.layers)){for(const j of l.layers)if(!this._isValidId(j)){y=!1;break}if(y&&!l.target)return this.style.queryRenderedFeatures(g,l,this.transform)}let N=[];return y&&(N=N.concat(this.style.queryRenderedFeatures(g,l,this.transform))),d&&(N=N.concat(this.style.queryRenderedFeatureset(g,l,this.transform))),N}querySourceFeatures(g,l){return!g||typeof g=="string"&&!this._isValidId(g)?[]:this.style.querySourceFeatures(g,l)}isPointOnSurface(g){const{name:l}=this.transform.projection;return l!=="globe"&&l!=="mercator"&&i.w(`${l} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(g))}addInteraction(g,l){return this._interactions.add(g,l),this}removeInteraction(g){return this._interactions.remove(g),this}setStyle(g,l){return l=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},l),this.style&&g&&l.diff!==!1&&l.localFontFamily===this._localFontFamily&&l.localIdeographFontFamily===this._localIdeographFontFamily&&!l.config?(this.style._diffStyle(g,(d,y)=>{d?(i.w(`Unable to perform style diff: ${String(d.message||d.error||d)}. Rebuilding the style from scratch.`),this._updateStyle(g,l)):y&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._localFontFamily=l.localFontFamily,this._updateStyle(g,l))}_getUIString(g){const l=this._locale[g];if(l==null)throw new Error(`Missing UI string '${g}'`);return l}_updateStyle(g,l){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g){const d=i.l({},l);l&&l.config&&(d.initialConfig=l.config,delete d.config),this.style=new Xo(this,d).load(g),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Xo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(g){return g==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.cr(g)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${g}".`))),!1)}_isTargetValid(g){return"featuresetId"in g?this._isValidId("importId"in g?g.importId:g.featuresetId):"layerId"in g&&this._isValidId(g.layerId)}_areTargetsValid(g){if(Array.isArray(g)){for(const l of g)if(!this._isValidId(l))return!1;return!0}return this._isTargetValid(g)}addSource(g,l){return this._isValidId(g)?(this._lazyInitEmptyStyle(),this.style.addSource(g,l),this._update(!0)):this}isSourceLoaded(g){return!!this._isValidId(g)&&!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(g,l,d){this._lazyInitEmptyStyle(),this.style.addSourceType(g,l,d)}removeSource(g){return this._isValidId(g)?(this.style.removeSource(g),this._updateTerrain(),this._update(!0)):this}getSource(g){return this._isValidId(g)?this.style.getOwnSource(g):null}addImage(g,l,{pixelRatio:d=1,sdf:y=!1,stretchX:N,stretchY:j,content:C}={}){if(this._lazyInitEmptyStyle(),l instanceof HTMLImageElement||ImageBitmap&&l instanceof ImageBitmap){const{width:F,height:W,data:Z}=i.q.getImageData(l);this.style.addImage(g,{data:new i.r({width:F,height:W},Z),pixelRatio:d,stretchX:N,stretchY:j,content:C,sdf:y,version:0,usvg:!1})}else if(l.width===void 0||l.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:F,height:W}=l,Z=l;this.style.addImage(g,{data:new i.r({width:F,height:W},new Uint8Array(Z.data)),pixelRatio:d,stretchX:N,stretchY:j,content:C,sdf:y,usvg:!1,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,g)}}updateImage(g,l){this._lazyInitEmptyStyle();const d=this.style.getImage(g);if(!d)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=l instanceof HTMLImageElement||ImageBitmap&&l instanceof ImageBitmap?i.q.getImageData(l):l,{width:N,height:j,data:C}=y;if(N===void 0||j===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(N!==(d.usvg?d.icon.usvg_tree.width:d.data.width)||j!==(d.usvg?d.icon.usvg_tree.height:d.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${N}, ${j})
                must be that same as the previous version of the image
                (${d.data.width}, ${d.data.height})`)));const F=!(l instanceof HTMLImageElement||ImageBitmap&&l instanceof ImageBitmap);let W=!1;d.usvg?(d.data=new i.r({width:N,height:j},new Uint8Array(C)),d.usvg=!1,d.icon=void 0,W=!0):d.data.replace(C,F),this.style.updateImage(g,d,W)}hasImage(g){return g?!!this.style&&!!this.style.getImage(g):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,l){i.o(this._requestManager.transformRequest(g,i.R.Image),(d,y)=>{l(d,y instanceof HTMLImageElement?i.q.getImageData(y):y)})}listImages(){return this.style.listImages()}addModel(g,l){this._lazyInitEmptyStyle(),this.style.addModel(g,l)}hasModel(g){return g?this.style.hasModel(g):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(g){this.style.removeModel(g)}listModels(){return this.style.listModels()}addLayer(g,l){return this._isValidId(g.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(g,l),this._update(!0)):this}getSlot(g){const l=this.getLayer(g);return l&&l.slot||null}setSlot(g,l){return this.style.setSlot(g,l),this.style.mergeLayers(),this._update(!0)}addImport(g,l){return this.style.addImport(g,l),this}updateImport(g,l){return typeof l!="string"&&l.id!==g?(this.removeImport(g),this.addImport(l)):(this.style.updateImport(g,l),this._update(!0))}removeImport(g){return this.style.removeImport(g),this}moveImport(g,l){return this.style.moveImport(g,l),this._update(!0)}moveLayer(g,l){return this._isValidId(g)?(this.style.moveLayer(g,l),this._update(!0)):this}removeLayer(g){return this._isValidId(g)?(this.style.removeLayer(g),this._update(!0)):this}getLayer(g){if(!this._isValidId(g))return null;const l=this.style.getOwnLayer(g);return l?l.type==="custom"?l.implementation:l.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(g,l,d){return this._isValidId(g)?(this.style.setLayerZoomRange(g,l,d),this._update(!0)):this}setFilter(g,l,d={}){return this._isValidId(g)?(this.style.setFilter(g,l,d),this._update(!0)):this}getFilter(g){return this._isValidId(g)?this.style.getFilter(g):null}setPaintProperty(g,l,d,y={}){return this._isValidId(g)?(this.style.setPaintProperty(g,l,d,y),this._update(!0)):this}getPaintProperty(g,l){return this._isValidId(g)?this.style.getPaintProperty(g,l):null}setLayoutProperty(g,l,d,y={}){return this._isValidId(g)?(this.style.setLayoutProperty(g,l,d,y),this._update(!0)):this}getLayoutProperty(g,l){return this._isValidId(g)?this.style.getLayoutProperty(g,l):null}getSchema(g){return this.style.getSchema(g)}setSchema(g,l){return this.style.setSchema(g,l),this._update(!0)}getConfig(g){return this.style.getConfig(g)}setConfig(g,l){return this.style.setConfig(g,l),this._update(!0)}getConfigProperty(g,l){return this.style.getConfigProperty(g,l)}setConfigProperty(g,l,d){return this.style.setConfigProperty(g,l,d),this._update(!0)}getFeaturesetDescriptors(g){return this.style.getFeaturesetDescriptors(g)}setLights(g){if(this._lazyInitEmptyStyle(),g&&g.length===1&&g[0].type==="flat"){const l=g[0];l.properties?this.style.setFlatLight(l.properties,l.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(g),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const g=this.style.getLights()||[];return g.length===0&&g.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),g}setLight(g,l={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:g}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(g){return this._lazyInitEmptyStyle(),this.style.setSnow(g),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(g){return this._lazyInitEmptyStyle(),this.style.setRain(g),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(g){return this._lazyInitEmptyStyle(),this.style.setColorTheme(g),this._update(!0)}setImportColorTheme(g,l){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(g,l),this._update(!0)}setCamera(g){return this.style.setCamera(g),this._triggerCameraUpdate(g)}_triggerCameraUpdate(g){return this._update(this.transform.setOrthographicProjectionAtLowPitch(g["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bO.convert(g),this.transform):0}setFeatureState(g,l){return g.source&&!this._isValidId(g.source)?this:(this.style.setFeatureState(g,l),this._update())}removeFeatureState(g,l){return g.source&&!this._isValidId(g.source)?this:(this.style.removeFeatureState(g,l),this._update())}getFeatureState(g){return g.source&&!this._isValidId(g.source)?null:this.style.getFeatureState(g)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,l=this._container.getBoundingClientRect().height||300;let d,y,N,j=this._container;for(;j&&(!y||!N);){const C=window.getComputedStyle(j).transform;C&&C!=="none"&&(d=C.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&d[0]!=="0"&&d[0]!=="1"&&(y=d[0]),d[3]&&d[3]!=="0"&&d[3]!=="1"&&(N=d[3])),j=j.parentElement}this._containerWidth=y?Math.abs(g/y):g,this._containerHeight=N?Math.abs(l/N):l}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=I("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const l=this._canvasContainer=I("div","mapboxgl-canvas-container",g);this._canvas=I("canvas","mapboxgl-canvas",l),this._interactive&&(l.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=I("div","mapboxgl-control-container",g),y=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(N=>{y[N]=I("div",`mapboxgl-ctrl-${N}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,l){const d=i.q.devicePixelRatio||1;this._canvas.width=d*Math.ceil(g),this._canvas.height=d*Math.ceil(l),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${l}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const l=this._markers.indexOf(g);l!==-1&&this._markers.splice(l,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const l=this._popups.indexOf(g);l!==-1&&this._popups.splice(l,1)}_setupPainter(){const g=i.l({},U.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._canvas.getContext("webgl2",g);l?(Kt(l,!0),this.painter=new mg(l,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",d=>{d.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(l)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let l;this.fire(new i.z("renderstart")),++this._frameId;const d=this.painter.context.extTimerQuery,y=i.q.now(),N=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(l=N.createQuery(),N.beginQuery(d.TIME_ELAPSED_EXT,l)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const j=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const Z=this.transform.zoom,Y=this.transform.pitch,re=i.q.now(),ne=new i.a8(Z,{now:re,fadeDuration:j,pitch:Y,transition:this.style.transition});this.style.update(ne)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(y),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(y);const F=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,j,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),F&&(this._placementDirty=F.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:j,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,S.mark(w.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),l){const Z=i.q.now()-y;N.endQuery(d.TIME_ELAPSED_EXT),setTimeout(()=>{const Y=N.getQueryParameter(l,N.QUERY_RESULT)/1e6;N.deleteQuery(l),this.fire(new i.z("gpu-timing-frame",{cpuTime:Z,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){const Z=this.painter.collectGpuTimers();setTimeout(()=>{const Y=this.painter.queryGpuTimers(Z);this.fire(new i.z("gpu-timing-layer",{layerTimes:Y}))},50)}if(this.listens("gpu-timing-deferred-render")){const Z=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Y=this.painter.queryGpuTimeDeferredRender(Z);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:Y}))},50)}const W=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(W||this._repaint)this.triggerRepaint();else{const Z=this.idle();if(Z&&(C=this._updateAverageElevation(y,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),Z&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Y=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:Y})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||W||(this._fullyLoaded=!0,S.mark(w.fullLoad),this._performanceMetricsCollection&&or(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const l of this._markers)g&&!this.getRenderWorldCopies()&&(l._lngLat=l._lngLat.wrap()),l._update();for(const l of this._popups)!g||this.getRenderWorldCopies()||l._trackPointer||(l._lngLat=l._lngLat.wrap()),l._update()}_updateAverageElevation(g,l=!1){const d=N=>(this.transform.averageElevation=N,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&d(0);const y=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(y||(l||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const N=this.transform.averageElevation;let j=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(j)?j=0:this._averageElevationLastSampledAt=g;const C=Math.abs(N-j);if(C>1){if(this._isInitialLoad||y)return this._averageElevation.jumpTo(j),d(j);this._averageElevation.easeTo(j,g,300)}else if(C>1e-4)return this._averageElevation.jumpTo(j),d(j)}return!!this._averageElevation.isEasing(g)&&d(this._averageElevation.getValue(g))}_authenticate(){ze(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===pe||g.status===401)){const l=this.painter.context.gl;Kt(l,!1),this._logoControl instanceof il&&this._logoControl._updateLogo(),l&&l.clear(l.DEPTH_BUFFER_BIT|l.COLOR_BUFFER_BIT|l.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Dt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&ir(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),l=this.painter.getCanvasCopiesAndTimestamps();l.timeStamps.push(performance.now());const d=this.painter.context.gl,y=d.createFramebuffer();function N(j){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,j,0);const C=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,C),C}return d.bindFramebuffer(d.FRAMEBUFFER,y),this._canvasPixelComparison(N(g),l.canvasCopies.map(N),l.timeStamps)}_canvasPixelComparison(g,l,d){let y=d[1]-d[0];const N=g.length/4;for(let j=0;j<l.length;j++){const C=l[j];let F=0;for(let W=0;W<C.length;W+=4)C[W]===g[W]&&C[W+1]===g[W+1]&&C[W+2]===g[W+2]&&C[W+3]===g[W+3]&&(F+=1);y+=(d[j+2]-d[j+1])*(1-F/N)}return y}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Pr.delete(this.painter.context.gl),Ft.remove(),nt.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=i.q.frame(l=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(l)}))}_preloadTiles(g){const l=this.style?this.style.getSourceCaches():[];return i.bl(l,(d,y)=>d._preloadTiles(g,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(g){this._showParseStatus!==g&&(this._showParseStatus=g,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(g){this._showLayers2DWireframe!==g&&(this._showLayers2DWireframe=g,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(g){this._showLayers3DWireframe!==g&&(this._showLayers3DWireframe=g,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,this._tp.refreshUI(),g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,this._tp.refreshUI(),g&&this._update())}_setCacheLimits(g,l){i.dG(g,l)}get version(){return x}},NavigationControl:class{constructor(g={}){this.options=i.l({},rm,g),this._container=I("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(i.aP(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",l=>{this._map&&this._map.zoomIn({},{originalEvent:l})}),I("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",l=>{this._map&&this._map.zoomOut({},{originalEvent:l})}),I("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aP(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",l=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:l}):d.resetNorth({},{originalEvent:l}))}),this._compassIcon=I("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const l=g.getZoom(),d=l===g.getMaxZoom(),y=l===g.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=l)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new No(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,l){const d=I("button",g,this._container);return d.type="button",d.addEventListener("click",l),d}_setButtonTitle(g,l){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${l}`);g.setAttribute("aria-label",d),g.firstElementChild&&g.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends i.E{constructor(g={}){super();const l=navigator.geolocation;this.options=i.l({geolocation:l},Gi,g),i.aP(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Zp(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=I("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const l=(d=!!this.options.geolocation)=>{this._supportsGeolocation=d,g(d)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(d=>l(d.state!=="denied")).catch(()=>l()):l()}_isOutOfMapMaxBounds(g){const l=this._map.getMaxBounds(),d=g.coords;return!!l&&(d.longitude<l.getWest()||d.longitude>l.getEast()||d.latitude<l.getSouth()||d.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",g)),this._finish()}}_updateCamera(g){const l=new i.bO(g.coords.longitude,g.coords.latitude),d=g.coords.accuracy,y=this._map.getBearing(),N=i.l({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(d),N,{geolocateSource:!0})}_updateMarker(g){if(g){const l=new i.bO(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,l=i.bH(1,g._center.lat)*g.worldSize,d=Math.ceil(2*this._accuracy*l);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=I("button","mapboxgl-ctrl-geolocate",this._container),I("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=I("div","mapboxgl-user-location"),this._dotElement.appendChild(I("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(I("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new sl({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=I("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new sl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))})}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(l=>{l==="granted"&&g()}).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:If,ScaleControl:class{constructor(g={}){this.options=i.l({},ol,g),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aP(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,l=this._map,d=l._containerHeight/2,y=l._containerWidth/2-g/2,N=l.unproject([y,d]),j=l.unproject([y+g,d]),C=N.distanceTo(j);if(this.options.unit==="imperial"){const F=3.2808*C;F>5280?this._setScale(g,F/5280,"mile"):this._setScale(g,F,"foot")}else this.options.unit==="nautical"?this._setScale(g,C/1852,"nautical-mile"):C>=1e3?this._setScale(g,C/1e3,"kilometer"):this._setScale(g,C,"meter")}_setScale(g,l,d){this._map._requestDomTask(()=>{const y=function(j){const C=Math.pow(10,`${Math.floor(j)}`.length-1);let F=j/C;return F=F>=10?10:F>=5?5:F>=3?3:F>=2?2:F>=1?1:function(W){const Z=Math.pow(10,Math.ceil(-Math.log(W)/Math.LN10));return Math.round(W*Z)/Z}(F),C*F}(l),N=y/l;this._container.innerHTML=this._isNumberFormatSupported&&d!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:d}).format(y):`${y}&nbsp;${Br[d]}`,this._container.style.width=g*N+"px"})}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=I("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g={}){this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:i.w("Full screen control 'container' must be a DOM element.")),i.aP(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=I("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=I("button","mapboxgl-ctrl-fullscreen",this._controlContainer);I("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(g){super(),this.options=i.l(Object.create(Nh),g),i.aP(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=i.bO.convert(g),this._pos=null,this._trackPointer=!1,this._update();const l=this._map;return l&&(l.on("move",this._update),l.off("mousemove",this._onMouseEvent),l._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const l=document.createDocumentFragment(),d=document.createElement("body");let y;for(d.innerHTML=g;y=d.firstChild,y;)l.appendChild(y);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let l=this._content;if(l)for(;l.hasChildNodes();)l.firstChild&&l.removeChild(l.firstChild);else l=this._content=I("div","mapboxgl-popup-content",this._container||void 0);if(l.appendChild(g),this.options.closeButton){const d=this._closeButton=I("button","mapboxgl-popup-close-button",l);d.type="button",d.setAttribute("aria-label","Close popup"),d.innerHTML='<span aria-hidden="true">&#215;</span>',d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let l;return this._classList.delete(g)?l=!1:(this._classList.add(g),l=!0),this._updateClassList(),l}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const l=this._map,d=this._container,y=this._pos;if(!l||!d||!y)return"bottom";const N=d.offsetWidth,j=d.offsetHeight,C=y.x<N/2,F=y.x>l.transform.width-N/2;if(y.y+g<j)return C?"top-left":F?"top-right":"top";if(y.y>l.transform.height-j){if(C)return"bottom-left";if(F)return"bottom-right"}return C?"left":F?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const l=[...this._classList];l.push("mapboxgl-popup"),this._anchor&&l.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&l.push("mapboxgl-popup-track-pointer"),g.className=l.join(" ")}_update(g){const l=this._map,d=this._content;if(!l||!this._lngLat&&!this._trackPointer||!d)return;let y=this._container;if(y||(y=this._container=I("div","mapboxgl-popup",l.getContainer()),this._tip=I("div","mapboxgl-popup-tip",y),y.appendChild(d)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),l.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=bg(this._lngLat,this._pos,l.transform)),!this._trackPointer||g){const N=this._pos=this._trackPointer&&g instanceof i.P?g:l.project(this._lngLat),j=wg(this.options.offset),C=this._anchor=this._getAnchor(j.y),F=wg(this.options.offset,C),W=N.add(F).round();l._requestDomTask(()=>{this._container&&C&&(this._container.style.transform=`${Gc[C]} translate(${W.x}px,${W.y}px)`)})}if(!this._marker&&l._showingGlobe()){const N=i.dH(l.transform,this._lngLat)?0:1;this._setOpacity(N)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(oo);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:sl,Style:Xo,LngLat:i.bO,LngLatBounds:i.az,Point:i.P,MercatorCoordinate:i.aa,FreeCameraOptions:jp,Evented:i.E,config:i.e,prewarm:i.dM,clearPrewarmedResources:i.dN,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(g){i.e.ACCESS_TOKEN=g},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(g){i.e.API_URL=g},get workerCount(){return i.dO.workerCount},set workerCount(g){i.dO.workerCount=g},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){i.e.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){i.dP(g)},get workerUrl(){return i.dQ.workerUrl},set workerUrl(g){i.dQ.workerUrl=g},get workerClass(){return i.dQ.workerClass},set workerClass(g){i.dQ.workerClass=g},get workerParams(){return i.dQ.workerParams},set workerParams(g){i.dQ.workerParams=g},get dracoUrl(){return i.dR()},set dracoUrl(g){i.dS(g)},get meshoptUrl(){return i.dT()},set meshoptUrl(g){i.dU(g)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var h=a;return h})}(IN)),IN.exports}var u$e=c$e();const pN=ha(u$e),rR={Mati:{lat:6.90543,lng:126.198137},Baganga:{lat:7.138566,lng:126.19839},Banaybanay:{lat:7.052637,lng:126.271871},Caraga:{lat:7.040689,lng:126.405736},Cateel:{lat:7.03907,lng:126.073971},"Governor Generoso":{lat:7.023682,lng:126.135764},Lupon:{lat:6.996579,lng:126.157647},Manay:{lat:6.910817,lng:125.976873},"San Isidro":{lat:7.026718,lng:126.399461},Tarragona:{lat:7.090034,lng:126.217449},Boston:{lat:6.969014,lng:126.235561},Maco:{lat:7.036735,lng:126.414316},Mabini:{lat:7.012285,lng:125.970299},Pantukan:{lat:7.008709,lng:125.964125},Mawab:{lat:7.002258,lng:126.393666},Monkayo:{lat:6.950413,lng:126.203313},"New Bataan":{lat:7.037214,lng:125.949183},Compostela:{lat:7.0845,lng:126.9761},Laak:{lat:6.9046,lng:126.5307},Maragusan:{lat:7.1389,lng:126.2254}};function d$e(e,t="",r=""){if(!e)return null;const n=e.trim().replace(/\s+/g," ");if(rR[n])return rR[n];const a=n.toLowerCase();for(const[c,h]of Object.entries(rR))if(c.toLowerCase().includes(a)||a.includes(c.toLowerCase()))return h;return console.warn(`No coordinates found for municipality: ${e}`),null}const h$e=({analyticsData:e,className:t=""})=>{const[r,n]=G.useState(!1),[a,c]=G.useState("year-over-year"),[h,i]=G.useState(null),[x,w]=G.useState(!1);G.useEffect(()=>{const ae=()=>{const ue=document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches;n(ue)};ae();const ee=new MutationObserver(ae);ee.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});const se=window.matchMedia("(prefers-color-scheme: dark)");return se.addEventListener("change",ae),()=>{ee.disconnect(),se.removeEventListener("change",ae)}},[]),G.useEffect(()=>{if(!e)return;w(!0);const ae=S(e,a);i(ae),w(!1)},[e,a]);const S=(ae,ee)=>{if(!ae||!ae.trends||!ae.trends.monthly)return null;const se=ae.trends.monthly,ue=new Date().getFullYear();switch(ee){case"year-over-year":return T(se,ue);case"quarterly":return E(se);case"monthly-trend":return D(se);case"severity-comparison":return U(ae);default:return null}},T=(ae,ee)=>{const se=ae.filter(Ce=>Ce._id.year===ee),ue=ae.filter(Ce=>Ce._id.year===ee-1);return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((Ce,Ne)=>{const me=se.find(pe=>pe._id.month===Ne+1),be=ue.find(pe=>pe._id.month===Ne+1);return{month:Ce,current:(me==null?void 0:me.count)||0,previous:(be==null?void 0:be.count)||0,change:me&&be?(me.count-be.count)/be.count*100:0}})},E=ae=>{const ee=[{name:"Q1",months:[1,2,3]},{name:"Q2",months:[4,5,6]},{name:"Q3",months:[7,8,9]},{name:"Q4",months:[10,11,12]}],se=new Date().getFullYear(),ue=ae.filter(Ce=>Ce._id.year===se),he=ae.filter(Ce=>Ce._id.year===se-1);return ee.map(Ce=>{const Ne=ue.filter(be=>Ce.months.includes(be._id.month)).reduce((be,pe)=>be+pe.count,0),me=he.filter(be=>Ce.months.includes(be._id.month)).reduce((be,pe)=>be+pe.count,0);return{quarter:Ce.name,current:Ne,previous:me,change:me>0?(Ne-me)/me*100:0}})},D=ae=>{const ee=new Date().getFullYear(),se=ae.filter(ue=>ue._id.year===ee);return se.map(ue=>({month:new Date(ue._id.year,ue._id.month-1).toLocaleDateString("en-US",{month:"short"}),accidents:ue.count,cumulative:se.filter(he=>he._id.month<=ue._id.month).reduce((he,Ce)=>he+Ce.count,0)}))},U=ae=>{if(!ae.distributions||!ae.distributions.severity)return null;const ee=ae.distributions.severity,se=ee.reduce((ue,he)=>ue+he.count,0);return ee.map(ue=>({severity:ue._id.charAt(0).toUpperCase()+ue._id.slice(1),count:ue.count,percentage:(ue.count/se*100).toFixed(1),trend:Math.random()>.5?"up":"down"}))},I=()=>r?["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4"]:["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"],V=()=>{if(!h||x)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});switch(a){case"year-over-year":return o.jsx(uo,{width:"100%",height:300,children:o.jsxs(RD,{data:h,children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),o.jsx(ga,{dataKey:"month",stroke:r?"#9ca3af":"#6b7280"}),o.jsx(ya,{stroke:r?"#9ca3af":"#6b7280"}),o.jsx(zi,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"},formatter:(ae,ee)=>[ae,ee==="current"?"Current Year":"Previous Year"]}),o.jsx(Fu,{}),o.jsx(rs,{dataKey:"previous",fill:I()[1],fillOpacity:.6,name:"Previous Year"}),o.jsx(rs,{dataKey:"current",fill:I()[0],name:"Current Year"})]})});case"quarterly":return o.jsx(uo,{width:"100%",height:300,children:o.jsxs(Xc,{data:h,children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),o.jsx(ga,{dataKey:"quarter",stroke:r?"#9ca3af":"#6b7280"}),o.jsx(ya,{stroke:r?"#9ca3af":"#6b7280"}),o.jsx(zi,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"}}),o.jsx(rs,{dataKey:"current",fill:I()[0],name:"Current Year"}),o.jsx(rs,{dataKey:"previous",fill:I()[1],name:"Previous Year"})]})});case"monthly-trend":return o.jsx(uo,{width:"100%",height:300,children:o.jsxs(Fw,{data:h,children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),o.jsx(ga,{dataKey:"month",stroke:r?"#9ca3af":"#6b7280"}),o.jsx(ya,{yAxisId:"left",stroke:r?"#9ca3af":"#6b7280"}),o.jsx(ya,{yAxisId:"right",orientation:"right",stroke:r?"#9ca3af":"#6b7280"}),o.jsx(zi,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"}}),o.jsx(Fu,{}),o.jsx(Ud,{yAxisId:"left",type:"monotone",dataKey:"accidents",stroke:I()[0],strokeWidth:3,name:"Monthly Accidents"}),o.jsx(Ud,{yAxisId:"right",type:"monotone",dataKey:"cumulative",stroke:I()[1],strokeWidth:2,strokeDasharray:"5 5",name:"Cumulative Total"})]})});case"severity-comparison":return o.jsx(uo,{width:"100%",height:300,children:o.jsxs(Xc,{data:h,children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),o.jsx(ga,{dataKey:"severity",stroke:r?"#9ca3af":"#6b7280"}),o.jsx(ya,{stroke:r?"#9ca3af":"#6b7280"}),o.jsx(zi,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"},formatter:(ae,ee)=>[ee==="count"?`${ae} accidents`:`${ae}%`,ee==="count"?"Count":"Percentage"]}),o.jsx(rs,{dataKey:"count",fill:I()[2]})]})});default:return null}},H=()=>{switch(a){case"year-over-year":return"Year-over-Year Comparison";case"quarterly":return"Quarterly Analysis";case"monthly-trend":return"Monthly Trend Analysis";case"severity-comparison":return"Severity Distribution Comparison";default:return"Comparison Analysis"}},K=()=>{switch(a){case"year-over-year":return"Compare current year accident data with previous year";case"quarterly":return"Quarterly breakdown of accident trends";case"monthly-trend":return"Monthly accident patterns with cumulative totals";case"severity-comparison":return"Accident severity distribution analysis";default:return"Comparative analysis of accident data"}},Q=()=>{if(!h||h.length===0)return null;switch(a){case"year-over-year":const ae=h.reduce((ue,he)=>ue+he.current,0),ee=h.reduce((ue,he)=>ue+he.previous,0),se=ee>0?(ae-ee)/ee*100:0;return o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[o.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[o.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Current Year"}),o.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:ae}),o.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Total accidents"})]}),o.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[o.jsx("div",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Previous Year"}),o.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100",children:ee}),o.jsx("div",{className:"text-xs text-green-600 dark:text-green-400",children:"Total accidents"})]}),o.jsxs("div",{className:`p-3 rounded-lg ${se>=0?"bg-red-50 dark:bg-red-950/20":"bg-green-50 dark:bg-green-950/20"}`,children:[o.jsx("div",{className:`text-sm font-medium ${se>=0?"text-red-700 dark:text-red-300":"text-green-700 dark:text-green-300"}`,children:"Year-over-Year Change"}),o.jsxs("div",{className:`text-lg font-bold ${se>=0?"text-red-900 dark:text-red-100":"text-green-900 dark:text-green-100"}`,children:[se>=0?"+":"",se.toFixed(1),"%"]}),o.jsx("div",{className:`text-xs ${se>=0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:se>=0?"Increase":"Decrease"})]})]});default:return null}};return o.jsxs(Ri,{className:`group hover:shadow-lg transition-all duration-300 ${t}`,children:[o.jsx(Ki,{children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs(Zi,{className:"flex items-center gap-2",children:[o.jsx(i4,{className:"h-5 w-5 text-purple-500"}),H()]}),o.jsx(As,{children:K()})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs(Js,{value:a,onValueChange:c,children:[o.jsx(Vs,{className:"w-[180px]",children:o.jsx(yo,{})}),o.jsxs(Us,{children:[o.jsx(An,{value:"year-over-year",children:"Year-over-Year"}),o.jsx(An,{value:"quarterly",children:"Quarterly"}),o.jsx(An,{value:"monthly-trend",children:"Monthly Trend"}),o.jsx(An,{value:"severity-comparison",children:"Severity Comparison"})]})]})})]})}),o.jsxs(Fi,{children:[V(),Q()]})]})},f$e=({accidents:e,className:t=""})=>{const r=G.useRef(null),n=G.useRef(null),[a,c]=G.useState(!1),[h,i]=G.useState(!1),[x,w]=G.useState(!1),[S,T]=G.useState(!0),[E,D]=G.useState(!1),[U,I]=G.useState("all"),[V,H]=G.useState("streets"),[K,Q]=G.useState(!1);G.useEffect(()=>{const me=()=>{const Se=document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches;w(Se)};me();const be=new MutationObserver(me);be.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});const pe=window.matchMedia("(prefers-color-scheme: dark)");return pe.addEventListener("change",me),()=>{be.disconnect(),pe.removeEventListener("change",me)}},[]);const ae=me=>{const be={streets:"mapbox://styles/mapbox/streets-v12",satellite:"mapbox://styles/mapbox/satellite-v9",outdoors:"mapbox://styles/mapbox/outdoors-v12",light:"mapbox://styles/mapbox/light-v11",dark:"mapbox://styles/mapbox/dark-v11"};return be[me]||be.streets};G.useEffect(()=>{if(!e||e.length===0)return;const me="pk.eyJ1IjoiY2xhcmVuY2VqYXBpbmFuIiwiYSI6ImNtOGk1NGh3bjA5bWwya3B0a2lzMGk0eDkifQ.Px83G0Hg6bYtv9E9teOTpQ";if(pN.accessToken=me,!n.current)try{n.current=new pN.Map({container:r.current,style:ae(V),center:[125.971907,6.90543],zoom:9}),n.current.addControl(new pN.NavigationControl,"top-right"),n.current.on("load",()=>{c(!0),ee()}),n.current.on("error",be=>{console.error("Map error:",be),i(!0)})}catch(be){console.error("Map initialization error:",be),i(!0);return}return()=>{n.current&&(n.current.remove(),n.current=null)}},[e]),G.useEffect(()=>{if(n.current&&a&&!K){Q(!0);try{n.current.setStyle(ae(V)),n.current.once("styledata",()=>{ee(),Q(!1)}),setTimeout(()=>{Q(!1)},3e3)}catch(me){console.error("Style change error:",me),i(!0),Q(!1)}}},[V,a]),G.useEffect(()=>{a&&n.current&&ee()},[a,S,E,U]);const ee=()=>{if(!n.current||!a)return;const me=se();n.current.getLayer("clusters")&&n.current.removeLayer("clusters"),n.current.getLayer("cluster-count")&&n.current.removeLayer("cluster-count"),n.current.getLayer("unclustered-point")&&n.current.removeLayer("unclustered-point"),n.current.getLayer("heatmap")&&n.current.removeLayer("heatmap"),n.current.getSource("accidents")&&n.current.removeSource("accidents"),n.current.addSource("accidents",{type:"geojson",data:me,cluster:S,clusterMaxZoom:14,clusterRadius:50}),S&&(n.current.addLayer({id:"clusters",type:"circle",source:"accidents",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#51bbd6",10,"#f1f075",30,"#f28cb1"],"circle-radius":["step",["get","point_count"],15,10,20,30,25]}}),n.current.addLayer({id:"cluster-count",type:"symbol",source:"accidents",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}})),n.current.addLayer({id:"unclustered-point",type:"circle",source:"accidents",filter:["!",["has","point_count"]],paint:{"circle-color":["case",["==",["get","severity"],"fatal"],"#dc2626",["==",["get","severity"],"severe"],"#ea580c",["==",["get","severity"],"moderate"],"#f59e0b",["==",["get","severity"],"minor"],"#16a34a","#6b7280"],"circle-radius":8,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),E&&n.current.addLayer({id:"heatmap",type:"heatmap",source:"accidents",maxzoom:15,paint:{"heatmap-weight":["interpolate",["linear"],["case",["==",["get","severity"],"fatal"],4,["==",["get","severity"],"severe"],3,["==",["get","severity"],"moderate"],2,["==",["get","severity"],"minor"],1,0],0,0,1,1,2,2,3,3,4,4],"heatmap-intensity":["interpolate",["linear"],["zoom"],0,1,15,3],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(33,102,172,0)",.2,"rgb(103,169,207)",.4,"rgb(209,229,240)",.6,"rgb(253,219,199)",.8,"rgb(239,138,98)",1,"rgb(178,24,43)"],"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,15,20],"heatmap-opacity":["interpolate",["linear"],["zoom"],7,1,15,0]}}),n.current.on("click","clusters",be=>{const pe=n.current.queryRenderedFeatures(be.point,{layers:["clusters"]}),Se=pe[0].properties.cluster_id;n.current.getSource("accidents").getClusterExpansionZoom(Se,(Ee,we)=>{Ee||n.current.easeTo({center:pe[0].geometry.coordinates,zoom:we})})}),n.current.on("click","unclustered-point",be=>{const pe=be.features[0].geometry.coordinates.slice(),Se=be.features[0].properties;new pN.Popup().setLngLat(pe).setHTML(ue(Se)).addTo(n.current)}),n.current.on("mouseenter","clusters",()=>{n.current.getCanvas().style.cursor="pointer"}),n.current.on("mouseleave","clusters",()=>{n.current.getCanvas().style.cursor=""}),n.current.on("mouseenter","unclustered-point",()=>{n.current.getCanvas().style.cursor="pointer"}),n.current.on("mouseleave","unclustered-point",()=>{n.current.getCanvas().style.cursor=""})},se=()=>({type:"FeatureCollection",features:e.filter(be=>!(U!=="all"&&be.severity!==U)).map(be=>{let pe=null;if(be.municipality){const Se=d$e(be.municipality,be.barangay,be.street);Se&&(pe=[Se.lng,Se.lat])}return pe?{type:"Feature",properties:{id:be.accident_id,severity:be.severity||"unknown",plateNo:be.plateNo,vehicle_type:be.vehicle_type,municipality:be.municipality,barangay:be.barangay,street:be.street,accident_date:be.accident_date,notes:be.notes},geometry:{type:"Point",coordinates:pe}}:null}).filter(be=>be!==null)}),ue=me=>`
      <div style="padding: 12px; min-width: 220px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
        <h3 style="margin: 0 0 10px 0; font-size: 16px; font-weight: bold; color: #1f2937; border-bottom: 1px solid #e5e7eb; padding-bottom: 6px;">
          ${me.id||"Accident ID: N/A"}
        </h3>
        <div style="font-size: 13px; line-height: 1.5; color: #374151;">
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Plate:</strong> ${me.plateNo||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Severity:</strong> 
            <span style="color: ${he(me.severity)}; font-weight: bold; text-transform: uppercase;">
              ${me.severity||"Unknown"}
            </span>
          </p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Vehicle:</strong> ${me.vehicle_type||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Location:</strong> ${me.municipality||"N/A"}, ${me.barangay||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Street:</strong> ${me.street||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Date:</strong> ${me.accident_date?new Date(me.accident_date).toLocaleDateString():"N/A"}</p>
          ${me.notes?`<p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Notes:</strong> ${me.notes}</p>`:""}
        </div>
      </div>
    `,he=me=>{switch(me){case"fatal":return"#dc2626";case"severe":return"#ea580c";case"moderate":return"#f59e0b";case"minor":return"#16a34a";default:return"#6b7280"}},Ce=()=>{n.current&&n.current.flyTo({center:[125.971907,6.90543],zoom:9,duration:1e3})},Ne=()=>{const me=["streets","satellite","outdoors","light","dark"],pe=(me.indexOf(V)+1)%me.length;i(!1),H(me[pe])};return h?o.jsxs(Ri,{className:t,children:[o.jsx(Ki,{children:o.jsxs(Zi,{className:"flex items-center gap-2",children:[o.jsx(ko,{className:"h-5 w-5 text-red-500"}),"Map Error"]})}),o.jsx(Fi,{children:o.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded-lg",children:o.jsxs("div",{className:"text-center text-gray-500",children:[o.jsx("div",{className:"text-lg font-medium",children:"Map unavailable"}),o.jsx("div",{className:"text-sm mb-4",children:"Unable to load map. This might be due to:"}),o.jsxs("ul",{className:"text-xs text-left space-y-1 mb-4",children:[o.jsx("li",{children:" Internet connection issues"}),o.jsx("li",{children:" Mapbox token configuration"}),o.jsx("li",{children:" Style loading problems"})]}),o.jsx("button",{onClick:()=>{i(!1),c(!1),n.current&&(n.current.remove(),n.current=null)},className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors",children:"Retry"})]})})})]}):!e||e.length===0?o.jsxs(Ri,{className:t,children:[o.jsx(Ki,{children:o.jsxs(Zi,{className:"flex items-center gap-2",children:[o.jsx(Rd,{className:"h-5 w-5 text-blue-500"}),"Accident Map"]})}),o.jsx(Fi,{children:o.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded-lg",children:o.jsxs("div",{className:"text-center text-gray-500",children:[o.jsx("div",{className:"text-lg font-medium",children:"No location data available"}),o.jsx("div",{className:"text-sm",children:"Accidents in this period don't have coordinate information"})]})})})]}):o.jsxs(Ri,{className:`group hover:shadow-lg transition-all duration-300 ${t}`,children:[o.jsx(Ki,{children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs(Zi,{className:"flex items-center gap-2",children:[o.jsx(Rd,{className:"h-5 w-5 text-blue-500"}),"Accident Map"]}),o.jsx(As,{children:"Interactive map with clustering, heat layers, and advanced filtering"})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs(Qa,{variant:"outline",className:"text-xs",children:[e.length," Accidents"]})})]})}),o.jsx(Fi,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-3 bg-muted/30 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs(ur,{variant:S?"default":"outline",size:"sm",onClick:()=>T(!S),className:"flex items-center gap-1",children:[o.jsx(c4,{className:"h-4 w-4"}),"Clusters"]}),o.jsxs(ur,{variant:E?"default":"outline",size:"sm",onClick:()=>D(!E),className:"flex items-center gap-1",children:[o.jsx(XB,{className:"h-4 w-4"}),"Heatmap"]})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs("select",{value:U,onChange:me=>I(me.target.value),className:"px-2 py-1 text-sm border rounded-md bg-background",children:[o.jsx("option",{value:"all",children:"All Severities"}),o.jsx("option",{value:"fatal",children:"Fatal"}),o.jsx("option",{value:"severe",children:"Severe"}),o.jsx("option",{value:"moderate",children:"Moderate"}),o.jsx("option",{value:"minor",children:"Minor"})]})}),o.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[o.jsxs(ur,{variant:"outline",size:"sm",onClick:Ne,disabled:K,className:"flex items-center gap-1",children:[o.jsx(XB,{className:"h-4 w-4"}),K?"Loading...":"Style"]}),o.jsxs(ur,{variant:"outline",size:"sm",onClick:Ce,className:"flex items-center gap-1",children:[o.jsx(Bde,{className:"h-4 w-4"}),"Reset"]})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{ref:r,className:"w-full h-96 rounded-lg",style:{minHeight:"400px"}}),o.jsxs("div",{className:`absolute top-4 left-4 rounded-lg shadow-lg p-3 text-xs ${x?"bg-gray-800 border border-gray-700 text-gray-100":"bg-white border border-gray-200 text-gray-900"}`,children:[o.jsx("div",{className:"font-semibold mb-2",children:"Accident Severity"}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-red-600 border-2 border-white"}),o.jsx("span",{children:"Fatal"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-600 border-2 border-white"}),o.jsx("span",{children:"Severe"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-500 border-2 border-white"}),o.jsx("span",{children:"Moderate"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-green-600 border-2 border-white"}),o.jsx("span",{children:"Minor"})]})]}),S&&o.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-300",children:[o.jsx("div",{className:"font-semibold mb-1",children:"Clusters"}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-400"}),o.jsx("span",{children:"Small"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-4 h-4 rounded-full bg-yellow-400"}),o.jsx("span",{children:"Medium"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-5 h-5 rounded-full bg-pink-400"}),o.jsx("span",{children:"Large"})]})]})]})]})]})]})})]})},p$e=({analyticsData:e,riskData:t,timePeriod:r,selectedSeverity:n,selectedVehicleType:a,className:c=""})=>{const h=()=>{if(!e)return;const S=[];S.push(["Metric","Value","Change"]),S.push(["Total Accidents",e.summary.totalAccidents,e.summary.accidentChange]),S.push(["Fatal Accidents",e.summary.fatalities,e.summary.fatalitiesChange]),S.push(["High Risk Areas",e.distributions.municipality.length,""]),t&&S.push(["High Risk Predictions",t.riskPredictions.highRisk,t.riskPredictions.highRiskPercentage]),S.push(["","",""]),S.push(["Month","Accidents"]),e.trends.monthly.forEach(I=>{const V=new Date(I._id.year,I._id.month-1);S.push([V.toLocaleDateString("en-US",{month:"long",year:"numeric"}),I.count])}),S.push(["",""]),S.push(["Severity","Count"]),e.distributions.severity.forEach(I=>{S.push([I._id,I.count])}),S.push(["",""]),S.push(["Vehicle Type","Count"]),e.distributions.vehicleType.forEach(I=>{S.push([I._id,I.count])}),S.push(["",""]),S.push(["Municipality","Count"]),e.distributions.municipality.forEach(I=>{S.push([I._id,I.count])});const T=S.map(I=>I.map(V=>`"${V}"`).join(",")).join(`
`),E=new Blob([T],{type:"text/csv;charset=utf-8;"}),D=document.createElement("a"),U=URL.createObjectURL(E);D.setAttribute("href",U),D.setAttribute("download",`accident_analytics_${r}_${new Date().toISOString().split("T")[0]}.csv`),D.style.visibility="hidden",document.body.appendChild(D),D.click(),document.body.removeChild(D)},i=()=>{if(!e)return;const S={exportInfo:{timestamp:new Date().toISOString(),timePeriod:r,filters:{severity:n,vehicleType:a}},summary:e.summary,trends:e.trends,distributions:e.distributions,riskData:t,mapData:e.mapData},T=JSON.stringify(S,null,2),E=new Blob([T],{type:"application/json;charset=utf-8;"}),D=document.createElement("a"),U=URL.createObjectURL(E);D.setAttribute("href",U),D.setAttribute("download",`accident_analytics_${r}_${new Date().toISOString().split("T")[0]}.json`),D.style.visibility="hidden",document.body.appendChild(D),D.click(),document.body.removeChild(D)},x=S=>{alert(`Exporting ${S} chart as image... (Feature requires additional setup)`)},w=()=>{if(!e)return;const S=`
ACCIDENT ANALYTICS REPORT
Generated: ${new Date().toLocaleDateString()}
Time Period: ${r}
Filters: Severity=${n}, Vehicle Type=${a}

SUMMARY
========
Total Accidents: ${e.summary.totalAccidents}
Fatal Accidents: ${e.summary.fatalities}
High Risk Areas: ${e.distributions.municipality.length}
Accident Change: ${e.summary.accidentChange}%

${t?`
RISK ANALYSIS
=============
High Risk Predictions: ${t.riskPredictions.highRisk} (${t.riskPredictions.highRiskPercentage}%)
Medium Risk: ${t.riskPredictions.mediumRisk}
Low Risk: ${t.riskPredictions.lowRisk}
`:""}

MONTHLY TRENDS
==============
${e.trends.monthly.map(U=>`${new Date(U._id.year,U._id.month-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})}: ${U.count} accidents`).join(`
`)}

SEVERITY DISTRIBUTION
====================
${e.distributions.severity.map(U=>`${U._id}: ${U.count} accidents`).join(`
`)}

VEHICLE TYPE DISTRIBUTION
=========================
${e.distributions.vehicleType.map(U=>`${U._id}: ${U.count} accidents`).join(`
`)}

TOP MUNICIPALITIES
==================
${e.distributions.municipality.slice(0,10).map(U=>`${U._id}: ${U.count} accidents`).join(`
`)}
    `.trim(),T=new Blob([S],{type:"text/plain;charset=utf-8;"}),E=document.createElement("a"),D=URL.createObjectURL(T);E.setAttribute("href",D),E.setAttribute("download",`accident_report_${r}_${new Date().toISOString().split("T")[0]}.txt`),E.style.visibility="hidden",document.body.appendChild(E),E.click(),document.body.removeChild(E)};return o.jsx("div",{className:`flex items-center gap-2 ${c}`,children:o.jsxs(Yh,{children:[o.jsx(op,{asChild:!0,children:o.jsxs(ur,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[o.jsx(o4,{className:"h-4 w-4"}),"Export"]})}),o.jsxs(Bd,{align:"end",className:"w-48",children:[o.jsxs(es,{onClick:h,className:"flex items-center gap-2",children:[o.jsx(Qde,{className:"h-4 w-4"}),"Export as CSV"]}),o.jsxs(es,{onClick:i,className:"flex items-center gap-2",children:[o.jsx(ho,{className:"h-4 w-4"}),"Export as JSON"]}),o.jsxs(es,{onClick:w,className:"flex items-center gap-2",children:[o.jsx(ho,{className:"h-4 w-4"}),"Export Report"]}),o.jsx(Am,{}),o.jsxs(es,{onClick:()=>x("trends"),className:"flex items-center gap-2",children:[o.jsx(i4,{className:"h-4 w-4"}),"Export Trends Chart"]}),o.jsxs(es,{onClick:()=>x("severity"),className:"flex items-center gap-2",children:[o.jsx(YB,{className:"h-4 w-4"}),"Export Severity Chart"]}),o.jsxs(es,{onClick:()=>x("heatmap"),className:"flex items-center gap-2",children:[o.jsx(YB,{className:"h-4 w-4"}),"Export Heatmap"]})]})]})})},GW={light:["#DC2626","#EA580C","#059669","#2563EB"],dark:["#EF4444","#F97316","#10B981","#3B82F6"]},mN=({value:e,duration:t=2e3,className:r=""})=>{const[n,a]=G.useState(0),[c,h]=G.useState(!1),i=G.useRef(null);return G.useEffect(()=>{const x=new IntersectionObserver(([w])=>{w.isIntersecting&&h(!0)},{threshold:.1});return i.current&&x.observe(i.current),()=>x.disconnect()},[]),G.useEffect(()=>{if(c){let x;const w=S=>{x||(x=S);const T=Math.min((S-x)/t,1),E=1-Math.pow(1-T,4),D=Math.floor(e*E);a(D),T<1?requestAnimationFrame(w):a(e)};requestAnimationFrame(w)}},[e,t,c]),o.jsx("div",{ref:i,className:`${r} transition-all duration-500 ${c?"opacity-100 transform translate-y-0":"opacity-0 transform translate-y-4"}`,children:n.toLocaleString()})},gN=({percentage:e,color:t="bg-blue-500",delay:r=0})=>{const[n,a]=G.useState(0),[c,h]=G.useState(!1),i=G.useRef(null);return G.useEffect(()=>{const x=new IntersectionObserver(([w])=>{w.isIntersecting&&h(!0)},{threshold:.1});return i.current&&x.observe(i.current),()=>x.disconnect()},[]),G.useEffect(()=>{if(c){const x=setTimeout(()=>{a(e)},r);return()=>clearTimeout(x)}},[c,e,r]),o.jsx("div",{ref:i,className:"mt-2 w-full bg-gray-200 rounded-full h-1.5 overflow-hidden",children:o.jsx("div",{className:`${t} h-1.5 rounded-full transition-all duration-1000 ease-out`,style:{width:`${n}%`}})})};function m$e(){const[e,t]=G.useState("alltime"),[r,n]=G.useState(null),[a,c]=G.useState(null),[h,i]=G.useState(!0),[x,w]=G.useState(null),[S,T]=G.useState("area"),[E,D]=G.useState(!1),{token:U}=Ei(),[I,V]=G.useState(!1);G.useEffect(()=>{const pe=()=>{const we=document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches;V(we)};pe();const Se=new MutationObserver(pe);Se.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});const Ee=window.matchMedia("(prefers-color-scheme: dark)");return Ee.addEventListener("change",pe),()=>{Se.disconnect(),Ee.removeEventListener("change",pe)}},[]);const H=()=>I?GW.dark:GW.light;G.useEffect(()=>{K()},[e]);const K=async()=>{var pe;try{i(!0),w(null);const Se=Date.now();console.log(`Fetching analytics data for period: ${e} at ${new Date(Se).toISOString()}`);const[Ee,we]=await Promise.all([mn.get(`/accident/analytics/summary?period=${e}&_t=${Se}`,{headers:{Authorization:U}}),mn.get(`/accident/analytics/risk?period=${e}&_t=${Se}`,{headers:{Authorization:U}})]);Ee.data.success&&(console.log("Frontend received analytics data:",Ee.data.data),console.log("Municipality data:",(pe=Ee.data.data.distributions)==null?void 0:pe.municipality),n(Ee.data.data)),we.data.success&&c(we.data.data)}catch(Se){console.error("Error fetching accident analytics:",Se),w("Failed to load accident analytics data")}finally{i(!1)}},Q=pe=>{switch(pe){case"week":return"Last Week";case"month":return"Last Month";case"3months":return"Last 3 Months";case"6months":return"Last 6 Months";case"year":return"Last Year";case"alltime":return"All Time";default:return"Last 6 Months"}},ae=pe=>pe.map(Se=>({month:`${Se._id.year}-${String(Se._id.month).padStart(2,"0")}`,accidents:Se.count})),ee=pe=>pe.map(Se=>({name:Se._id.charAt(0).toUpperCase()+Se._id.slice(1),value:Se.count,severity:Se._id})),se=({active:pe,payload:Se,label:Ee})=>{if(pe&&Se&&Se.length){const we=Se[0];Ce(r.distributions.municipality).find(Be=>Be.name===we.name);const Me=H()[2];return o.jsxs("div",{className:"p-3 rounded-lg shadow-lg border transition-all duration-200 ease-in-out",style:{backgroundColor:I?"#1f2937":"#ffffff",border:I?"1px solid #374151":"1px solid #e5e7eb",color:I?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},children:[o.jsxs("p",{className:"font-semibold text-sm mb-1",children:["Municipality: ",Ee]}),o.jsxs("p",{className:"text-sm",style:{color:Me,fontWeight:"600"},children:["Accidents: ",we.value," accidents"]})]})}return null},ue=({active:pe,payload:Se,label:Ee})=>{if(pe&&Se&&Se.length){const we=Se[0],Pe=H();ee(r.distributions.severity);const Be={Fatal:Pe[0],Severe:Pe[1],Minor:Pe[2],Moderate:Pe[3]}[we.name]||Pe[0],Ge=I?"#1f2937":"#ffffff",We=Be,tt=Be,nt=I?"rgba(0, 0, 0, 0.4)":"rgba(0, 0, 0, 0.15)",Dt=I?`${Be}60`:`${Be}30`;return o.jsx("div",{className:"p-3 rounded-lg shadow-lg border transition-all duration-200 ease-in-out",style:{backgroundColor:Ge,border:`2px solid ${We}`,boxShadow:`${nt} 0 8px 25px, 0 0 0 1px ${Dt}`,fontWeight:"600",backdropFilter:I?"blur(8px)":"none"},children:o.jsx("p",{style:{color:tt,margin:0,fontSize:"14px",fontWeight:"700",textShadow:I?`0 0 12px ${Be}80, 0 0 4px ${Be}40`:`0 0 8px ${Be}60, 0 0 2px ${Be}30`,filter:I?"brightness(1.1)":"brightness(1)"},children:`${we.name} : ${we.value}`})})}return null},he=pe=>pe.map(Se=>({name:Se._id.charAt(0).toUpperCase()+Se._id.slice(1),value:Se.count,type:Se._id})),Ce=pe=>{console.log("formatMunicipalityData input:",pe);const Se=pe.map(Ee=>({name:Ee._id,accidents:Ee.count,percentage:pe.length>0?(Ee.count/pe.reduce((we,Pe)=>we+Pe.count,0)*100).toFixed(1):0})).sort((Ee,we)=>we.accidents-Ee.accidents);return console.log("formatMunicipalityData output:",Se),Se},Ne=pe=>{const Se=Array.from({length:24},(Ee,we)=>({hour:we,accidents:0}));return pe==null||pe.forEach(Ee=>{if(Ee.accident_date){const we=new Date(Ee.accident_date).getHours();Se[we].accidents++}}),Se.map(Ee=>({...Ee,timeLabel:`${Ee.hour}:00`,period:Ee.hour<6?"Night":Ee.hour<12?"Morning":Ee.hour<18?"Afternoon":"Evening"}))},me=pe=>{const Se=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ee=Array.from({length:7},(we,Pe)=>({day:Pe,dayName:Se[Pe],accidents:0}));return pe==null||pe.forEach(we=>{if(we.accident_date){const Pe=new Date(we.accident_date).getDay();Ee[Pe].accidents++}}),Ee},be=(pe,Se)=>!pe||!Se?[]:[{category:"High Risk",accidents:Se.riskPredictions.highRisk,percentage:Se.riskPredictions.highRiskPercentage},{category:"Medium Risk",accidents:Se.riskPredictions.mediumRisk,percentage:100-Se.riskPredictions.highRiskPercentage-Se.riskPredictions.lowRiskPercentage},{category:"Low Risk",accidents:Se.riskPredictions.lowRisk,percentage:Se.riskPredictions.lowRiskPercentage}];return h?o.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen space-y-6 rounded-lg",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-3xl font-bold tracking-tight flex items-center gap-2 animate-in slide-in-from-top-5 fade-in duration-700",children:[o.jsx(ko,{className:"h-8 w-8 text-red-500 animate-pulse"}),"Accident Analytics"]}),o.jsx("p",{className:"text-muted-foreground",children:"Comprehensive Analysis of Accident Data"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"animate-pulse",children:o.jsx("div",{className:"h-8 bg-muted rounded w-32"})}),o.jsx("div",{className:"animate-pulse",children:o.jsx("div",{className:"h-8 bg-muted rounded w-40"})})]})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-muted/50 rounded-lg",children:[o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),o.jsx("div",{className:"h-8 bg-muted rounded w-24"})]}),o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),o.jsx("div",{className:"h-8 bg-muted rounded w-24"})]}),o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),o.jsx("div",{className:"h-8 bg-muted rounded w-24"})]})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(pe=>o.jsx("div",{className:"bg-card border border-border rounded-xl p-6",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-4 bg-muted rounded w-24 mb-2"}),o.jsx("div",{className:"h-8 bg-muted rounded w-16 mb-2"}),o.jsx("div",{className:"h-3 bg-muted rounded w-20"})]})},pe))}),o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[1,2].map(pe=>o.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded w-48 mb-4"}),o.jsx("div",{className:"h-64 bg-muted rounded"})]})},pe))}),o.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-6 bg-muted rounded w-40 mb-4"}),o.jsx("div",{className:"h-96 bg-muted rounded"})]})})]}):x?o.jsx("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen rounded-lg",children:o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"text-red-500",children:x})})}):o.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen space-y-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-3xl font-bold tracking-tight flex items-center gap-2 animate-in slide-in-from-top-5 fade-in duration-700",children:[o.jsx(ko,{className:"h-8 w-8 text-red-500 animate-pulse"}),"Accident Analytics"]}),o.jsx("p",{className:"text-muted-foreground",children:"Comprehensive analysis of accident data"})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx(p$e,{analyticsData:r,riskData:a,timePeriod:e})})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-muted/50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(AH,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{className:"text-sm font-medium",children:"Filters:"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{className:"text-sm text-muted-foreground",children:"Advanced:"}),o.jsxs("button",{onClick:()=>D(!E),className:`px-3 py-2 text-sm font-medium rounded-md transition-colors flex items-center gap-2 ${E?"text-white bg-primary hover:bg-primary/90 dark:text-white dark:bg-primary dark:hover:bg-primary/90":"text-foreground bg-background border border-border hover:bg-muted dark:text-foreground dark:bg-background dark:border-border dark:hover:bg-muted"}`,children:[o.jsx(i4,{className:"h-4 w-4"}),E?"Hide Advanced":"Show Advanced"]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{className:"text-sm text-muted-foreground",children:"Date:"}),o.jsxs(Js,{value:e,onValueChange:t,children:[o.jsx(Vs,{className:"w-[140px]",children:o.jsx(yo,{placeholder:"Select time period"})}),o.jsxs(Us,{children:[o.jsx(An,{value:"week",children:"Last Week"}),o.jsx(An,{value:"month",children:"Last Month"}),o.jsx(An,{value:"3months",children:"Last 3 Months"}),o.jsx(An,{value:"6months",children:"Last 6 Months"}),o.jsx(An,{value:"year",children:"Last Year"}),o.jsx(An,{value:"alltime",children:"All Time"})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{className:"text-sm text-muted-foreground",children:"Chart Type:"}),o.jsxs(Js,{value:S,onValueChange:T,children:[o.jsx(Vs,{className:"w-[120px]",children:o.jsx(yo,{})}),o.jsxs(Us,{children:[o.jsx(An,{value:"area",children:"Area Chart"}),o.jsx(An,{value:"line",children:"Line Chart"}),o.jsx(An,{value:"bar",children:"Bar Chart"}),o.jsx(An,{value:"composed",children:"Composed"})]})]})]})]})]}),r&&o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 animate-in slide-in-from-bottom-5 fade-in duration-700",children:[o.jsxs(Ri,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[o.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-blue-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),o.jsxs(Ki,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[o.jsx(Zi,{className:"text-sm font-medium",children:"Total Accidents"}),o.jsx(fo,{className:"h-4 w-4 text-blue-500"})]}),o.jsxs(Fi,{className:"relative z-10",children:[o.jsx(mN,{value:r.summary.totalAccidents,className:"text-2xl font-bold",duration:1500}),o.jsxs("div",{className:"flex items-center text-xs text-muted-foreground mt-1",children:[r.summary.accidentChange>=0?o.jsx(P1,{className:"h-3 w-3 text-red-500 mr-1 animate-pulse"}):o.jsx(mR,{className:"h-3 w-3 text-green-500 mr-1 animate-pulse"}),Math.abs(r.summary.accidentChange),"% from previous period"]}),o.jsx(gN,{percentage:Math.min(r.summary.totalAccidents/100*100,100),color:"bg-blue-500",delay:200})]})]}),o.jsxs(Ri,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[o.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-red-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),o.jsxs(Ki,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[o.jsx(Zi,{className:"text-sm font-medium",children:"Fatal Accidents"}),o.jsx(ko,{className:"h-4 w-4 text-red-500"})]}),o.jsxs(Fi,{className:"relative z-10",children:[o.jsx(mN,{value:r.summary.fatalities,className:"text-2xl font-bold text-red-600",duration:1800}),o.jsxs("div",{className:"flex items-center text-xs text-muted-foreground mt-1",children:[r.summary.fatalitiesChange>=0?o.jsx(P1,{className:"h-3 w-3 text-red-500 mr-1 animate-pulse"}):o.jsx(mR,{className:"h-3 w-3 text-green-500 mr-1 animate-pulse"}),r.summary.fatalitiesChange," from previous period"]}),o.jsx(gN,{percentage:Math.min(r.summary.fatalities/10*100,100),color:"bg-red-500",delay:400})]})]}),o.jsxs(Ri,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[o.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-orange-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),o.jsxs(Ki,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[o.jsx(Zi,{className:"text-sm font-medium",children:"High Risk Areas"}),o.jsx(Rd,{className:"h-4 w-4 text-orange-500"})]}),o.jsxs(Fi,{className:"relative z-10",children:[o.jsx(mN,{value:r.distributions.municipality.length,className:"text-2xl font-bold",duration:1600}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Municipalities with accidents"}),o.jsx(gN,{percentage:Math.min(r.distributions.municipality.length/20*100,100),color:"bg-orange-500",delay:600})]})]}),o.jsxs(Ri,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[o.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-purple-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),o.jsxs(Ki,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[o.jsx(Zi,{className:"text-sm font-medium",children:"Risk Predictions"}),o.jsx(dR,{className:"h-4 w-4 text-purple-500"})]}),o.jsxs(Fi,{className:"relative z-10",children:[o.jsx(mN,{value:a?a.riskPredictions.highRiskPercentage:0,className:"text-2xl font-bold",duration:2e3}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"High risk predictions"}),o.jsx(gN,{percentage:a?a.riskPredictions.highRiskPercentage:0,color:"bg-purple-500",delay:800})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r&&r.trends.monthly.length>0&&o.jsxs(Ri,{className:"group hover:shadow-lg transition-all duration-300 animate-in slide-in-from-left-5 fade-in duration-700",children:[o.jsx(Ki,{children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs(Zi,{className:"flex items-center gap-2",children:[o.jsx(Xs,{className:"h-5 w-5 text-blue-500 animate-pulse"}),"Accident Trends Over Time"]}),o.jsxs(As,{children:["Monthly accident frequency for ",Q(e)]})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx(Qa,{variant:"outline",className:"text-xs",children:S.toUpperCase()})})]})}),o.jsx(Fi,{children:o.jsxs(uo,{width:"100%",height:300,children:[S==="area"&&o.jsxs(KDe,{data:ae(r.trends.monthly),children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:I?"#374151":"#e5e7eb"}),o.jsx(ga,{dataKey:"month",tickFormatter:pe=>new Date(pe).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:I?"#9ca3af":"#6b7280"}),o.jsx(ya,{stroke:I?"#9ca3af":"#6b7280"}),o.jsx(zi,{labelFormatter:pe=>new Date(pe).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:I?"#1f2937":"#ffffff",border:I?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:I?"#f9fafb":"#111827"}}),o.jsx(Sc,{type:"monotone",dataKey:"accidents",stroke:H()[0],fill:H()[0],fillOpacity:.3,strokeWidth:3,animationDuration:1500,animationEasing:"ease-out"})]}),S==="line"&&o.jsxs(Fw,{data:ae(r.trends.monthly),children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:I?"#374151":"#e5e7eb"}),o.jsx(ga,{dataKey:"month",tickFormatter:pe=>new Date(pe).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:I?"#9ca3af":"#6b7280"}),o.jsx(ya,{stroke:I?"#9ca3af":"#6b7280"}),o.jsx(zi,{labelFormatter:pe=>new Date(pe).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:I?"#1f2937":"#ffffff",border:I?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:I?"#f9fafb":"#111827"}}),o.jsx(Ud,{type:"monotone",dataKey:"accidents",stroke:H()[0],strokeWidth:3,dot:{fill:H()[0],strokeWidth:2,r:4},activeDot:{r:6,stroke:H()[0],strokeWidth:2},animationDuration:1500,animationEasing:"ease-out"})]}),S==="bar"&&o.jsxs(Xc,{data:ae(r.trends.monthly),children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:I?"#374151":"#e5e7eb"}),o.jsx(ga,{dataKey:"month",tickFormatter:pe=>new Date(pe).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:I?"#9ca3af":"#6b7280"}),o.jsx(ya,{stroke:I?"#9ca3af":"#6b7280"}),o.jsx(zi,{labelFormatter:pe=>new Date(pe).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:I?"#1f2937":"#ffffff",border:I?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:I?"#f9fafb":"#111827"}}),o.jsx(rs,{dataKey:"accidents",fill:H()[0],radius:[4,4,0,0],animationDuration:1500,animationEasing:"ease-out"})]}),S==="composed"&&o.jsxs(RD,{data:ae(r.trends.monthly),children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:I?"#374151":"#e5e7eb"}),o.jsx(ga,{dataKey:"month",tickFormatter:pe=>new Date(pe).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:I?"#9ca3af":"#6b7280"}),o.jsx(ya,{stroke:I?"#9ca3af":"#6b7280"}),o.jsx(zi,{labelFormatter:pe=>new Date(pe).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:I?"#1f2937":"#ffffff",border:I?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:I?"#f9fafb":"#111827"}}),o.jsx(rs,{dataKey:"accidents",fill:H()[0],fillOpacity:.6,radius:[4,4,0,0],animationDuration:1500,animationEasing:"ease-out"}),o.jsx(Ud,{type:"monotone",dataKey:"accidents",stroke:H()[1],strokeWidth:2,dot:!1,animationDuration:1500,animationEasing:"ease-out"})]})]})})]}),r&&r.distributions.severity.length>0&&o.jsxs(Ri,{className:"animate-in slide-in-from-right-5 fade-in duration-700",children:[o.jsxs(Ki,{children:[o.jsxs(Zi,{className:"flex items-center gap-2",children:[o.jsx(k1,{className:"h-5 w-5 text-orange-500 animate-pulse"}),"Accident Severity Distribution"]}),o.jsx(As,{children:"Breakdown of accidents by severity level"})]}),o.jsx(Fi,{children:o.jsx(uo,{width:"100%",height:300,children:o.jsxs(Xte,{children:[o.jsx(vp,{data:ee(r.distributions.severity),cx:"50%",cy:"50%",labelLine:!1,label:({name:pe,percent:Se})=>`${pe} ${(Se*100).toFixed(0)}%`,outerRadius:80,innerRadius:40,fill:"currentColor",dataKey:"value",animationDuration:1500,animationEasing:"ease-out",children:ee(r.distributions.severity).map((pe,Se)=>{const Ee=H(),we={Fatal:Ee[0],Severe:Ee[1],Minor:Ee[2],Moderate:Ee[3]};return o.jsx(Jh,{fill:we[pe.name]||Ee[0]},`cell-${Se}`)})}),o.jsx(zi,{content:o.jsx(ue,{})})]})})})]}),r&&r.distributions.vehicleType.length>0&&o.jsxs(Ri,{className:"group hover:shadow-lg transition-all duration-300",children:[o.jsxs(Ki,{children:[o.jsxs(Zi,{className:"flex items-center gap-2",children:[o.jsx(fo,{className:"h-5 w-5 text-green-500"}),"Vehicle Type Distribution"]}),o.jsx(As,{children:"Accidents by vehicle type with enhanced visualization"})]}),o.jsxs(Fi,{children:[o.jsx(uo,{width:"100%",height:300,children:o.jsxs(Xc,{data:he(r.distributions.vehicleType),children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:I?"#374151":"#e5e7eb"}),o.jsx(ga,{dataKey:"name",stroke:I?"#9ca3af":"#6b7280",fontSize:12,angle:-45,textAnchor:"end",height:80}),o.jsx(ya,{stroke:I?"#9ca3af":"#6b7280"}),o.jsx(zi,{contentStyle:{backgroundColor:I?"#1f2937":"#ffffff",border:I?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:I?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},formatter:(pe,Se)=>[`${pe} accidents`,"Count"],labelFormatter:pe=>`Vehicle Type: ${pe}`}),o.jsx(rs,{dataKey:"value",fill:H()[1],radius:[4,4,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})}),o.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:(()=>{const pe=he(r.distributions.vehicleType),Se=pe.reduce((we,Pe)=>we+Pe.value,0),Ee=pe.reduce((we,Pe)=>Pe.value>we.value?Pe:we);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[o.jsx("div",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Most Common"}),o.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100",children:Ee.name}),o.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:[Ee.value," accidents (",(Ee.value/Se*100).toFixed(1),"%)"]})]}),o.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[o.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Total Vehicles"}),o.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:pe.length}),o.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Vehicle types involved"})]})]})})()})]})]}),r&&r.distributions.municipality.length>0&&o.jsxs(Ri,{className:"group hover:shadow-lg transition-all duration-300",children:[o.jsxs(Ki,{children:[o.jsxs(Zi,{className:"flex items-center gap-2",children:[o.jsx(Rd,{className:"h-5 w-5 text-orange-500"}),"Top Municipalities by Accidents"]}),o.jsx(As,{children:"Municipalities with highest accident counts and risk analysis"})]}),o.jsxs(Fi,{children:[o.jsx(uo,{width:"100%",height:300,children:o.jsxs(Xc,{data:Ce(r.distributions.municipality),children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:I?"#374151":"#e5e7eb"}),o.jsx(ga,{dataKey:"name",stroke:I?"#9ca3af":"#6b7280",fontSize:11,angle:-45,textAnchor:"end",height:80}),o.jsx(ya,{stroke:I?"#9ca3af":"#6b7280"}),o.jsx(zi,{content:o.jsx(se,{})}),o.jsx(rs,{dataKey:"accidents",radius:[4,4,0,0],className:"hover:opacity-80 transition-opacity duration-200",children:Ce(r.distributions.municipality).map((pe,Se)=>o.jsx(Jh,{fill:H()[2]},`cell-${Se}`))})]})}),o.jsx("div",{className:"mt-4 grid grid-cols-3 gap-4",children:(()=>{const pe=Ce(r.distributions.municipality),Se=pe.reduce((Pe,Me)=>Pe+Me.accidents,0),Ee=pe.reduce((Pe,Me)=>Me.accidents>Pe.accidents?Me:Pe),we=Se/pe.length;return pe.find(Pe=>Pe.name==="Mati"),o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"p-3 rounded-lg bg-orange-50 dark:bg-orange-950/20",children:[o.jsx("div",{className:"text-sm font-medium text-orange-700 dark:text-orange-300",children:"Highest Risk"}),o.jsx("div",{className:"text-lg font-bold text-orange-900 dark:text-orange-100",children:Ee.name}),o.jsxs("div",{className:"text-xs text-orange-600 dark:text-orange-400",children:[Ee.accidents," accidents (",Ee.percentage,"%)"]})]}),o.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[o.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Total Areas"}),o.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:pe.length}),o.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Municipalities affected"})]}),o.jsxs("div",{className:"p-3 rounded-lg bg-purple-50 dark:bg-purple-950/20",children:[o.jsx("div",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Average"}),o.jsx("div",{className:"text-lg font-bold text-purple-900 dark:text-purple-100",children:we.toFixed(1)}),o.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:"Accidents per area"})]})]})})()})]})]})]}),a&&o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs(Ri,{children:[o.jsxs(Ki,{children:[o.jsx(Zi,{children:"Risk Level Distribution"}),o.jsx(As,{children:"ML-based risk predictions for accidents"})]}),o.jsx(Fi,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),o.jsx("span",{children:"High Risk"})]}),o.jsxs(Qa,{variant:"destructive",children:[a.riskPredictions.highRisk," (",a.riskPredictions.highRiskPercentage,"%)"]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),o.jsx("span",{children:"Medium Risk"})]}),o.jsx(Qa,{variant:"secondary",children:a.riskPredictions.mediumRisk})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),o.jsx("span",{children:"Low Risk"})]}),o.jsx(Qa,{variant:"outline",children:a.riskPredictions.lowRisk})]})]})})]}),o.jsxs(Ri,{children:[o.jsxs(Ki,{children:[o.jsx(Zi,{children:"Rule-Based Detection"}),o.jsx(As,{children:"Traditional rule-based risk assessment"})]}),o.jsx(Fi,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(ko,{className:"h-4 w-4 text-red-500"}),o.jsx("span",{children:"Flagged (High Risk)"})]}),o.jsxs(Qa,{variant:"destructive",children:[a.ruleBasedDetection.flagged," (",a.ruleBasedDetection.flaggedPercentage,"%)"]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(dR,{className:"h-4 w-4 text-green-500"}),o.jsx("span",{children:"Safe (Low Risk)"})]}),o.jsxs(Qa,{variant:"outline",children:[a.ruleBasedDetection.safe," (",a.ruleBasedDetection.safePercentage,"%)"]})]})]})})]})]}),E&&r&&o.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-5 fade-in duration-700",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o.jsx(mhe,{className:"h-5 w-5 text-yellow-500 animate-pulse"}),o.jsx("h3",{className:"text-xl font-semibold",children:"Advanced Analytics"}),o.jsx(Qa,{variant:"secondary",className:"ml-2 animate-pulse",children:"Enhanced Visualizations"})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs(Ri,{className:"group hover:shadow-lg transition-all duration-300 animate-in slide-in-from-left-5 fade-in duration-700",children:[o.jsxs(Ki,{children:[o.jsxs(Zi,{className:"flex items-center gap-2",children:[o.jsx(AT,{className:"h-5 w-5 text-green-500 animate-pulse"}),"Hourly Accident Distribution"]}),o.jsx(As,{children:"Accidents by hour of day showing peak times and patterns"})]}),o.jsxs(Fi,{children:[o.jsx(uo,{width:"100%",height:300,children:o.jsxs(Xc,{data:Ne(r.mapData),children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:I?"#374151":"#e5e7eb"}),o.jsx(ga,{dataKey:"timeLabel",stroke:I?"#9ca3af":"#6b7280",fontSize:11,interval:1}),o.jsx(ya,{stroke:I?"#9ca3af":"#6b7280"}),o.jsx(zi,{contentStyle:{backgroundColor:I?"#1f2937":"#ffffff",border:I?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:I?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},formatter:(pe,Se)=>[`${pe} accidents`,"Count"],labelFormatter:pe=>`Time: ${pe}`}),o.jsx(rs,{dataKey:"accidents",fill:H()[2],radius:[2,2,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})}),o.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:(()=>{const pe=Ne(r.mapData),Se=pe.reduce((we,Pe)=>Pe.accidents>we.accidents?Pe:we),Ee=pe.reduce((we,Pe)=>we+Pe.accidents,0);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[o.jsx("div",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Peak Hour"}),o.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100",children:Se.timeLabel}),o.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:[Se.accidents," accidents"]})]}),o.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[o.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Total Accidents"}),o.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:Ee}),o.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Across all hours"})]})]})})()})]})]}),o.jsxs(Ri,{className:"group hover:shadow-lg transition-all duration-300 animate-in slide-in-from-right-5 fade-in duration-700",children:[o.jsxs(Ki,{children:[o.jsxs(Zi,{className:"flex items-center gap-2",children:[o.jsx(Xs,{className:"h-5 w-5 text-purple-500 animate-pulse"}),"Day of Week Analysis"]}),o.jsx(As,{children:"Accident patterns by day of the week with risk assessment"})]}),o.jsxs(Fi,{children:[o.jsx(uo,{width:"100%",height:300,children:o.jsxs(Xc,{data:me(r.mapData),children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:I?"#374151":"#e5e7eb"}),o.jsx(ga,{dataKey:"dayName",stroke:I?"#9ca3af":"#6b7280",fontSize:12}),o.jsx(ya,{stroke:I?"#9ca3af":"#6b7280"}),o.jsx(zi,{contentStyle:{backgroundColor:I?"#1f2937":"#ffffff",border:I?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:I?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},formatter:(pe,Se)=>[`${pe} accidents`,"Count"],labelFormatter:pe=>`Day: ${pe}`}),o.jsx(rs,{dataKey:"accidents",fill:H()[3],radius:[2,2,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})}),o.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:(()=>{const pe=me(r.mapData),Se=pe.reduce((Pe,Me)=>Me.accidents>Pe.accidents?Me:Pe),we=pe.filter(Pe=>Pe.day===0||Pe.day===6).reduce((Pe,Me)=>Pe+Me.accidents,0);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-950/20 rounded-lg",children:[o.jsx("div",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Peak Day"}),o.jsx("div",{className:"text-lg font-bold text-purple-900 dark:text-purple-100",children:Se.dayName}),o.jsxs("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:[Se.accidents," accidents"]})]}),o.jsxs("div",{className:"p-3 bg-orange-50 dark:bg-orange-950/20 rounded-lg",children:[o.jsx("div",{className:"text-sm font-medium text-orange-700 dark:text-orange-300",children:"Weekend Total"}),o.jsx("div",{className:"text-lg font-bold text-orange-900 dark:text-orange-100",children:we}),o.jsx("div",{className:"text-xs text-orange-600 dark:text-orange-400",children:"Sat + Sun accidents"})]})]})})()})]})]}),a&&o.jsxs(Ri,{className:"group hover:shadow-lg transition-all duration-300",children:[o.jsxs(Ki,{children:[o.jsxs(Zi,{className:"flex items-center gap-2",children:[o.jsx(c4,{className:"h-5 w-5 text-red-500"}),"Risk Level Correlation"]}),o.jsx(As,{children:"Relationship between risk levels and accident counts"})]}),o.jsx(Fi,{children:o.jsx(uo,{width:"100%",height:300,children:o.jsxs(HDe,{data:be(r,a),children:[o.jsx(ms,{strokeDasharray:"3 3",stroke:I?"#374151":"#e5e7eb"}),o.jsx(ga,{dataKey:"category",stroke:I?"#9ca3af":"#6b7280",fontSize:12}),o.jsx(ya,{stroke:I?"#9ca3af":"#6b7280"}),o.jsx(zi,{contentStyle:{backgroundColor:I?"#1f2937":"#ffffff",border:I?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:I?"#f9fafb":"#111827"}}),o.jsx(F_,{dataKey:"accidents",fill:H()[4],r:8})]})})})]}),r&&r.distributions.severity.length>0&&o.jsxs(Ri,{className:"group hover:shadow-lg transition-all duration-300",children:[o.jsxs(Ki,{children:[o.jsxs(Zi,{className:"flex items-center gap-2",children:[o.jsx(k1,{className:"h-5 w-5 text-orange-500"}),"Severity Distribution (Radial)"]}),o.jsx(As,{children:"Circular view of accident severity breakdown"})]}),o.jsx(Fi,{children:o.jsx(uo,{width:"100%",height:300,children:o.jsxs(ZDe,{cx:"50%",cy:"50%",innerRadius:"20%",outerRadius:"80%",data:ee(r.distributions.severity),children:[o.jsx(A2,{dataKey:"value",cornerRadius:4,fill:H()[0]}),o.jsx(zi,{contentStyle:{backgroundColor:I?"#374151":"#ffffff",border:I?"1px solid #4b5563":"1px solid #e5e7eb",borderRadius:"8px",color:I?"#f9fafb":"#111827",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}})]})})})]})]}),o.jsx(h$e,{analyticsData:r,className:"w-full"})]}),r&&r.mapData&&r.mapData.length>0&&o.jsx(f$e,{accidents:r.mapData,className:"w-full"})]})}function g$e(){return o.jsx("div",{children:o.jsx(m$e,{})})}const y$e=[{value:"1",label:"Admin"},{value:"2",label:"Employee"}];function x$e(){const{userData:e}=Ei(),[t,r]=G.useState(!1),n=jc(Date.now()),a=G.useMemo(()=>Ar.object({firstName:Ar.string().min(1,"First name is required").trim(),middleName:Ar.string().optional(),lastName:Ar.string().min(1,"Last name is required").trim(),email:Ar.string().email("Invalid email address"),password:Ar.string().min(6,"Password must be at least 6 characters"),confirmPassword:Ar.string().min(1,"Confirm password is required"),role:(e==null?void 0:e.role)==="0"?Ar.enum(["0","1","2"],{required_error:"Role is required"}):Ar.enum(["0","1","2"]).optional()}).refine(i=>i.password===i.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),[e==null?void 0:e.role]),c=ml({resolver:Rl(a),defaultValues:{firstName:"",middleName:"",lastName:"",email:"",password:"",confirmPassword:"",role:void 0}}),h=async i=>{var x,w;try{r(!0);const{confirmPassword:S,...T}=i;(e==null?void 0:e.role)==="1"?T.role="2":(e==null?void 0:e.role)==="0"&&(T.role=i.role||"2"),(await mn.post("/auth/register",T)).data.success&&(Xr.success("Account has been registered successfully",{description:n}),c.reset({firstName:"",middleName:"",lastName:"",email:"",password:"",confirmPassword:"",role:void 0}))}catch(S){const T=((w=(x=S.response)==null?void 0:x.data)==null?void 0:w.message)||"Failed to register account";Xr.error(T,{description:n})}finally{r(!1)}};return o.jsx("div",{className:"h-full bg-white dark:bg-black",children:o.jsx("div",{className:"container mx-auto px-6 py-4 h-full flex items-center justify-center",children:o.jsx("div",{className:"max-w-2xl w-full",children:o.jsxs(Ri,{children:[o.jsxs(Ki,{className:"pb-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(zN,{className:"h-6 w-6"}),o.jsx(Zi,{children:"Register New Account"})]}),o.jsx(As,{children:(e==null?void 0:e.role)==="0"?"Create a new admin or employee account for the LTO system":"Create a new employee account for the LTO system"})]}),o.jsx(Fi,{className:"pb-4",children:o.jsx(up,{...c,children:o.jsxs("form",{onSubmit:c.handleSubmit(h),className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx(an,{control:c.control,name:"firstName",render:({field:i})=>o.jsxs(nn,{children:[o.jsx(pn,{className:"text-foreground",children:"First Name *"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter first name",...i})}),o.jsx(cn,{className:"text-xs"})]})}),o.jsx(an,{control:c.control,name:"middleName",render:({field:i})=>o.jsxs(nn,{children:[o.jsx(pn,{children:"Middle Name"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter middle name (optional)",...i})}),o.jsx(cn,{className:"text-xs"})]})}),o.jsx(an,{control:c.control,name:"lastName",render:({field:i})=>o.jsxs(nn,{children:[o.jsx(pn,{className:"text-foreground",children:"Last Name *"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter last name",...i})}),o.jsx(cn,{className:"text-xs"})]})})]}),o.jsx(an,{control:c.control,name:"email",render:({field:i,fieldState:x})=>o.jsxs(nn,{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(pn,{className:"text-foreground",children:"Email Address *"}),x.error&&o.jsx("span",{className:"text-xs text-red-500",children:x.error.message})]}),o.jsx(Hr,{children:o.jsx(Yr,{type:"email",placeholder:"Enter email address",...i})})]})}),o.jsx(an,{control:c.control,name:"password",render:({field:i,fieldState:x})=>o.jsxs(nn,{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(pn,{className:"text-foreground",children:"Password *"}),x.error&&o.jsx("span",{className:"text-xs text-red-500",children:x.error.message})]}),o.jsx(Hr,{children:o.jsx(Yr,{type:"password",placeholder:"Enter password",...i})})]})}),o.jsx(an,{control:c.control,name:"confirmPassword",render:({field:i,fieldState:x})=>o.jsxs(nn,{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(pn,{className:"text-foreground",children:"Confirm Password *"}),x.error&&o.jsx("span",{className:"text-xs text-red-500",children:x.error.message})]}),o.jsx(Hr,{children:o.jsx(Yr,{type:"password",placeholder:"Confirm password",...i})})]})}),(e==null?void 0:e.role)==="0"&&o.jsx(an,{control:c.control,name:"role",render:({field:i,fieldState:x})=>o.jsxs(nn,{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(pn,{className:"text-foreground",children:"Role *"}),x.error&&o.jsx("span",{className:"text-xs text-red-500",children:x.error.message})]}),o.jsxs(Js,{onValueChange:i.onChange,value:i.value,children:[o.jsx(Hr,{children:o.jsx(Vs,{children:o.jsx(yo,{placeholder:"Select a role"})})}),o.jsx(Us,{children:y$e.map(w=>o.jsx(An,{value:w.value,children:w.label},w.value))})]})]})}),o.jsxs("div",{className:"flex gap-4 pt-2",children:[o.jsx(ur,{type:"submit",disabled:t,className:"w-auto px-8",children:t?o.jsxs(o.Fragment,{children:[o.jsx(Nc,{className:"mr-2 h-4 w-4 animate-spin"}),"Registering..."]}):o.jsxs(o.Fragment,{children:[o.jsx(zN,{className:"mr-2 h-4 w-4"}),"Register Account"]})}),o.jsx(ur,{type:"button",variant:"outline",onClick:()=>{c.reset({firstName:"",middleName:"",lastName:"",email:"",password:"",confirmPassword:"",role:void 0})},disabled:t,className:"w-auto px-8",children:"Clear Form"})]})]})})})]})})})})}const v$e=Ar.object({userId:Ar.string().min(1,"User ID is required"),firstName:Ar.string().min(1,"First name is required").trim(),middleName:Ar.string().optional(),lastName:Ar.string().min(1,"Last name is required").trim(),email:Ar.string().email("Invalid email address"),role:Ar.enum(["0","1","2"],{required_error:"Please select a role"}),isPasswordChange:Ar.boolean().optional()}),_$e=[{value:"0",label:"Superadmin"},{value:"1",label:"Admin"},{value:"2",label:"Employee"}];function b$e(){const{userData:e}=Ei(),[t,r]=G.useState([]),[n,a]=G.useState(!1),[c,h]=G.useState(!1),[i,x]=G.useState(null),[w,S]=G.useState(!1),[T,E]=G.useState(!1),[D,U]=G.useState(null),I=ml({resolver:Rl(v$e),defaultValues:{userId:"",firstName:"",middleName:"",lastName:"",email:"",role:"",isPasswordChange:!1}}),V=async()=>{var he,Ce;try{a(!0);const Ne=await mn.get("/user/all");if(Ne.data.success){let me=Ne.data.users;(e==null?void 0:e.role)==="1"?me=me.filter(be=>be.role==="2"):(e==null?void 0:e.role)==="0"&&(me=me.filter(be=>be.role==="1"||be.role==="2")),r(me)}}catch(Ne){const me=((Ce=(he=Ne.response)==null?void 0:he.data)==null?void 0:Ce.message)||"Failed to fetch users";Xr.error(me)}finally{a(!1)}};G.useEffect(()=>{V()},[e]);const H=he=>{x(he),S(!0),I.reset({userId:he._id,firstName:he.firstName,middleName:he.middleName||"",lastName:he.lastName,email:he.email,role:he.role,isPasswordChange:he.isPasswordChange||!1})},K=he=>{U(he),E(!0)},Q=async()=>{var he,Ce;try{h(!0),(await mn.delete(`/user/${D._id}`)).data.success&&(Xr.success("User deleted successfully!"),V())}catch(Ne){const me=((Ce=(he=Ne.response)==null?void 0:he.data)==null?void 0:Ce.message)||"Failed to delete user";Xr.error(me)}finally{h(!1),E(!1),U(null)}},ae=async he=>{var Ce,Ne;try{h(!0),(await mn.put(`/user/${he.userId}`,he)).data.success&&(Xr.success("Account updated successfully!"),V(),S(!1),x(null))}catch(me){const be=((Ne=(Ce=me.response)==null?void 0:Ce.data)==null?void 0:Ne.message)||"Failed to update account";Xr.error(be)}finally{h(!1)}},ee=()=>{x(null),S(!1),I.reset()},se=he=>{switch(he){case"0":return"destructive";case"1":return"default";case"2":return"secondary";default:return"outline"}},ue=he=>{switch(he){case"0":return"Superadmin";case"1":return"Admin";case"2":return"Employee";default:return"Unknown"}};return o.jsx("div",{className:"h-full bg-white dark:bg-black overflow-hidden",children:o.jsx("div",{className:"container mx-auto px-6 py-4 h-full flex flex-col",children:o.jsxs("div",{className:"max-w-7xl mx-auto w-full h-full flex flex-col space-y-4",children:[o.jsx(Ri,{className:"flex-shrink-0",children:o.jsxs(Ki,{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(za,{className:"h-6 w-6"}),o.jsx(Zi,{children:"Manage User Accounts"})]}),o.jsx(As,{children:(e==null?void 0:e.role)==="0"?"View and manage admin and employee accounts":"View and manage employee accounts"})]})}),o.jsxs(Ri,{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:[o.jsx(Ki,{className:"flex-shrink-0",children:o.jsx(Zi,{children:"User Accounts"})}),o.jsx(Fi,{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:n?o.jsxs("div",{className:"flex items-center justify-center py-8",children:[o.jsx(Nc,{className:"h-8 w-8 animate-spin"}),o.jsx("span",{className:"ml-2",children:"Loading users..."})]}):t.length===0?o.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No users found"}):o.jsx("div",{className:"rounded-md border overflow-hidden flex-1 flex flex-col min-h-0",children:o.jsx("div",{className:"overflow-y-auto flex-1",style:{maxHeight:"24rem"},children:o.jsxs(Im,{children:[o.jsx(Lm,{className:"sticky top-0 bg-white dark:bg-gray-950 z-10",children:o.jsxs(Ps,{children:[o.jsx(Ts,{className:"bg-white dark:bg-gray-950",children:"Full Name"}),o.jsx(Ts,{className:"bg-white dark:bg-gray-950",children:"Email"}),o.jsx(Ts,{className:"bg-white dark:bg-gray-950",children:"Role"}),o.jsx(Ts,{className:"bg-white dark:bg-gray-950",children:"Created At"}),o.jsx(Ts,{className:"bg-white dark:bg-gray-950",children:"Last Updated"}),o.jsx(Ts,{className:"w-[50px] bg-white dark:bg-gray-950",children:"Actions"})]})}),o.jsx(Dm,{children:t.map(he=>o.jsxs(Ps,{children:[o.jsxs(xa,{className:"font-medium",children:[he.firstName," ",he.middleName," ",he.lastName]}),o.jsx(xa,{children:he.email}),o.jsx(xa,{children:o.jsx(Qa,{variant:se(he.role),children:ue(he.role)})}),o.jsx(xa,{children:new Date(he.createdAt).toLocaleDateString()}),o.jsx(xa,{children:new Date(he.updatedAt).toLocaleDateString()}),o.jsx(xa,{children:o.jsxs(Yh,{children:[o.jsx(op,{asChild:!0,children:o.jsxs(ur,{variant:"ghost",className:"h-8 w-8 p-0",children:[o.jsx("span",{className:"sr-only",children:"Open menu"}),o.jsx(hde,{className:"h-4 w-4"})]})}),o.jsxs(Bd,{align:"end",children:[o.jsxs(es,{onClick:()=>H(he),children:[o.jsx(za,{className:"mr-2 h-4 w-4"}),"Update"]}),(e==null?void 0:e.role)==="0"&&o.jsxs(es,{onClick:()=>K(he),className:"text-red-600",children:[o.jsx(ihe,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},he._id))})]})})})})]}),o.jsx(Yi,{open:w,onOpenChange:S,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[o.jsxs(ia,{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(za,{className:"h-6 w-6"}),o.jsx(aa,{children:"Update Account Information"})]}),o.jsx(js,{children:i&&`Modify the account information for ${i.firstName} ${i.lastName}`})]}),o.jsx(up,{...I,children:o.jsxs("form",{onSubmit:I.handleSubmit(ae),className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx(an,{control:I.control,name:"firstName",render:({field:he})=>o.jsxs(nn,{children:[o.jsx(pn,{children:"First Name *"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter first name",...he})}),o.jsx(cn,{})]})}),o.jsx(an,{control:I.control,name:"lastName",render:({field:he})=>o.jsxs(nn,{children:[o.jsx(pn,{children:"Last Name *"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter last name",...he})}),o.jsx(cn,{})]})})]}),o.jsx(an,{control:I.control,name:"middleName",render:({field:he})=>o.jsxs(nn,{children:[o.jsx(pn,{children:"Middle Name"}),o.jsx(Hr,{children:o.jsx(Yr,{placeholder:"Enter middle name (optional)",...he})}),o.jsx(cn,{})]})}),o.jsx(an,{control:I.control,name:"email",render:({field:he})=>o.jsxs(nn,{children:[o.jsx(pn,{children:"Email Address *"}),o.jsx(Hr,{children:o.jsx(Yr,{type:"email",placeholder:"Enter email address",...he})}),o.jsx(cn,{})]})}),o.jsx(an,{control:I.control,name:"role",render:({field:he})=>o.jsxs(nn,{children:[o.jsx(pn,{children:"Role *"}),o.jsxs(Js,{onValueChange:he.onChange,value:he.value,children:[o.jsx(Hr,{children:o.jsx(Vs,{children:o.jsx(yo,{placeholder:"Select a role"})})}),o.jsx(Us,{children:_$e.map(Ce=>o.jsx(An,{value:Ce.value,children:Ce.label},Ce.value))})]}),o.jsx(cn,{})]})}),o.jsxs("div",{className:"flex gap-4 pt-4",children:[o.jsx(ur,{type:"submit",disabled:c,className:"w-auto px-8",children:c?o.jsxs(o.Fragment,{children:[o.jsx(Nc,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(za,{className:"mr-2 h-4 w-4"}),"Update Account"]})}),o.jsx(ur,{type:"button",variant:"outline",onClick:ee,disabled:c,className:"w-auto px-8",children:"Cancel"})]})]})})]})}),o.jsx(uie,{open:T,onOpenChange:E,children:o.jsxs(XD,{children:[o.jsxs(JD,{children:[o.jsx(e5,{children:"Are you sure?"}),o.jsxs(t5,{children:["This action cannot be undone. This will permanently delete the account for"," ",o.jsxs("strong",{children:[D==null?void 0:D.firstName," ",D==null?void 0:D.lastName]}),"."]})]}),o.jsxs(QD,{children:[o.jsx(n5,{children:"Cancel"}),o.jsx(r5,{onClick:Q,disabled:c,className:"bg-red-600 hover:bg-red-700",children:c?o.jsxs(o.Fragment,{children:[o.jsx(Nc,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})})})}const nR=[{value:"0",label:"Superadmin"},{value:"1",label:"Admin"},{value:"2",label:"Employee"}],WW=[{value:"login",label:"Login"},{value:"logout",label:"Logout"},{value:"register",label:"Registration"},{value:"update",label:"Account Update"},{value:"delete",label:"Delete"},{value:"password_change",label:"Password Change"},{value:"otp_verified",label:"OTP Verification"},{value:"otp_sent",label:"OTP Sent"},{value:"otp_reset",label:"OTP Reset"},{value:"add_driver",label:"Add Driver"},{value:"add_vehicle",label:"Add Vehicle"},{value:"add_accident",label:"Add Accident"},{value:"add_violation",label:"Add Violation"},{value:"update_driver",label:"Update Driver"},{value:"update_vehicle",label:"Update Vehicle"},{value:"update_accident",label:"Update Accident"},{value:"update_violation",label:"Update Violation"},{value:"delete_driver",label:"Delete Driver"},{value:"delete_vehicle",label:"Delete Vehicle"},{value:"delete_accident",label:"Delete Accident"},{value:"delete_violation",label:"Delete Violation"}];function w$e(){const{userData:e}=Ei(),[t,r]=G.useState([]),[n,a]=G.useState(!1),[c,h]=G.useState(""),[i,x]=G.useState(""),[w,S]=G.useState(""),[T,E]=G.useState(null),[D,U]=G.useState(null),[I,V]=G.useState(1),[H,K]=G.useState(1),[Q,ae]=G.useState(0),ee=async(me=1)=>{var be,pe;try{a(!0);const Se=new URLSearchParams({page:me.toString(),limit:"10"});c&&Se.append("email",c),w&&w!=="all"&&Se.append("logType",w),T&&Se.append("dateFrom",T.toISOString().split("T")[0]),D&&Se.append("dateTo",D.toISOString().split("T")[0]),(e==null?void 0:e.role)==="1"?i&&i!=="all"?Se.append("role",i):Se.append("roles","1,2"):(e==null?void 0:e.role)==="0"&&(i&&i!=="all"?Se.append("role",i):Se.append("roles","0,1,2"));const Ee=await mn.get(`/user/logs?${Se}`);if(Ee.data.success){let we=Ee.data.logs;(e==null?void 0:e.role)==="1"?i&&i!=="all"?we=we.filter(Pe=>Pe.role===i):we=we.filter(Pe=>Pe.role==="1"||Pe.role==="2"):(e==null?void 0:e.role)==="0"&&(i&&i!=="all"?we=we.filter(Pe=>Pe.role===i):we=we.filter(Pe=>Pe.role==="0"||Pe.role==="1"||Pe.role==="2")),console.log("Raw logs from API:",Ee.data.logs),console.log("Filtered logs:",we),r(we),K(Ee.data.totalPages),ae(we.length),V(me)}}catch(Se){const Ee=((pe=(be=Se.response)==null?void 0:be.data)==null?void 0:pe.message)||"Failed to fetch logs";Xr.error(Ee)}finally{a(!1)}};G.useEffect(()=>{ee()},[e]);const se=()=>{V(1),ee(1)},ue=()=>{h(""),x(""),S(""),E(null),U(null),V(1),ee(1)},he=async()=>{try{const me=new URLSearchParams;c&&me.append("email",c),i&&me.append("role",i),w&&me.append("logType",w),T&&me.append("dateFrom",T.toISOString().split("T")[0]),D&&me.append("dateTo",D.toISOString().split("T")[0]);const be=await mn.get(`/user/logs/export?${me}`,{responseType:"blob"}),pe=window.URL.createObjectURL(new Blob([be.data])),Se=document.createElement("a");Se.href=pe,Se.setAttribute("download",`account-logs-${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(Se),Se.click(),Se.remove(),window.URL.revokeObjectURL(pe),Xr.success("Logs exported successfully!")}catch{Xr.error("Failed to export logs")}},Ce=me=>{switch(me){case"login":return"default";case"logout":return"secondary";case"register":return"outline";case"update":return"default";case"password_change":return"destructive";case"otp_verified":return"secondary";case"otp_sent":return"outline";case"otp_reset":return"destructive";case"add_driver":return"default";case"add_vehicle":return"default";case"add_accident":return"destructive";case"add_violation":return"destructive";case"update_driver":return"secondary";case"update_vehicle":return"secondary";case"update_accident":return"destructive";case"update_violation":return"destructive";case"delete_driver":return"destructive";case"delete_vehicle":return"destructive";case"delete_accident":return"destructive";case"delete_violation":return"destructive";default:return"outline"}},Ne=me=>{switch(me){case"0":return"destructive";case"1":return"default";case"2":return"secondary";default:return"outline"}};return o.jsx("div",{className:"container mx-auto p-4 md:p-6 bg-white dark:bg-black min-h-screen rounded-lg",children:o.jsxs("div",{className:"max-w-7xl mx-auto space-y-4 md:space-y-6",children:[o.jsx(Ri,{children:o.jsxs(Ki,{children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ho,{className:"h-5 w-5 md:h-6 md:w-6"}),o.jsx(Zi,{className:"text-lg md:text-xl",children:"Account Logs"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[o.jsxs(ur,{onClick:he,variant:"outline",size:"sm",className:"w-full sm:w-auto",children:[o.jsx(o4,{className:"mr-2 h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Export Excel"}),o.jsx("span",{className:"sm:hidden",children:"Export"})]}),o.jsxs(ur,{onClick:se,size:"sm",className:"w-full sm:w-auto",children:[o.jsx(Kw,{className:"mr-2 h-4 w-4"}),"Search"]})]})]}),o.jsx(As,{children:(e==null?void 0:e.role)==="0"?"View and monitor all account activities and system logs (Superadmin, Admin, and Employee)":"View and monitor admin and employee account activities and system logs"})]})}),o.jsxs(Ri,{children:[o.jsx(Ki,{children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(AH,{className:"h-5 w-5"}),o.jsx(Zi,{className:"text-lg",children:"Filters"})]})}),o.jsx(Fi,{children:o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3 md:gap-4",children:[o.jsx(Yr,{placeholder:"Search by email",value:c,onChange:me=>h(me.target.value),onKeyPress:me=>me.key==="Enter"&&se()}),o.jsxs(Js,{value:i,onValueChange:x,children:[o.jsx(Vs,{children:o.jsx(yo,{placeholder:"Filter by role"})}),o.jsxs(Us,{children:[o.jsx(An,{value:"all",children:"All Roles"}),nR.filter(me=>(e==null?void 0:e.role)==="1"?me.value==="1"||me.value==="2":(e==null?void 0:e.role)==="0"?me.value==="0"||me.value==="1"||me.value==="2":!1).map(me=>o.jsx(An,{value:me.value,children:me.label},me.value))]})]}),o.jsxs(Js,{value:w,onValueChange:S,children:[o.jsx(Vs,{children:o.jsx(yo,{placeholder:"Filter by log type"})}),o.jsxs(Us,{children:[o.jsx(An,{value:"all",children:"All Types"}),WW.map(me=>o.jsx(An,{value:me.value,children:me.label},me.value))]})]}),o.jsxs(ip,{children:[o.jsx(ap,{asChild:!0,children:o.jsxs(ur,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[o.jsx(Xs,{className:"mr-2 h-4 w-4"}),T?Ol(T,"MM/dd/yyyy"):"From date"]})}),o.jsx(Wh,{className:"w-auto p-0",align:"start",children:o.jsx(bT,{mode:"single",selected:T,onSelect:E,initialFocus:!0})})]}),o.jsxs(ip,{children:[o.jsx(ap,{asChild:!0,children:o.jsxs(ur,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[o.jsx(Xs,{className:"mr-2 h-4 w-4"}),D?Ol(D,"MM/dd/yyyy"):"To date"]})}),o.jsx(Wh,{className:"w-auto p-0",align:"start",children:o.jsx(bT,{mode:"single",selected:D,onSelect:U,initialFocus:!0})})]}),o.jsx(ur,{onClick:ue,variant:"outline",children:"Clear Filters"})]})})]}),o.jsxs(Ri,{children:[o.jsx(Ki,{children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(Zi,{children:"Account Activity Logs"}),o.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total: ",Q," logs"]})]})}),o.jsx(Fi,{children:n?o.jsxs("div",{className:"flex items-center justify-center py-8",children:[o.jsx(Nc,{className:"h-8 w-8 animate-spin"}),o.jsx("span",{className:"ml-2",children:"Loading logs..."})]}):t.length===0?o.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No logs found matching your criteria"}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"rounded-md border",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs(Im,{children:[o.jsx(Lm,{children:o.jsxs(Ps,{children:[o.jsx(Ts,{className:"min-w-[120px]",children:"Performed By"}),o.jsx(Ts,{className:"min-w-[150px]",children:"Timestamp"}),o.jsx(Ts,{className:"min-w-[100px]",children:"User"}),o.jsx(Ts,{className:"min-w-[150px]",children:"Email"}),o.jsx(Ts,{className:"min-w-[80px]",children:"Role"}),o.jsx(Ts,{className:"min-w-[100px]",children:"Activity"}),o.jsx(Ts,{className:"min-w-[150px]",children:"Details"}),o.jsx(Ts,{className:"min-w-[100px]",children:"IP Address"}),o.jsx(Ts,{className:"min-w-[80px]",children:"Status"})]})}),o.jsx(Dm,{children:t.map((me,be)=>{var pe,Se,Ee;return o.jsxs(Ps,{children:[o.jsx(xa,{children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"font-medium text-sm",children:me.actorName||"N/A"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:me.actorEmail||""}),me.actorRole&&o.jsx(Qa,{variant:"outline",className:"w-fit mt-1",children:((pe=nR.find(we=>we.value===me.actorRole))==null?void 0:pe.label)||"Unknown"})]})}),o.jsx(xa,{children:new Date(me.timestamp).toLocaleString()}),o.jsx(xa,{children:me.userName||"N/A"}),o.jsx(xa,{children:me.email}),o.jsx(xa,{children:o.jsx(Qa,{variant:Ne(me.role),children:((Se=nR.find(we=>we.value===me.role))==null?void 0:Se.label)||"Unknown"})}),o.jsx(xa,{children:o.jsx(Qa,{variant:Ce(me.logType),children:((Ee=WW.find(we=>we.value===me.logType))==null?void 0:Ee.label)||me.logType})}),o.jsx(xa,{children:o.jsx("span",{className:"text-sm text-muted-foreground",children:me.details||"N/A"})}),o.jsx(xa,{children:o.jsx("span",{className:"font-mono text-sm",children:me.ipAddress==="::1"||me.ipAddress==="::ffff:127.0.0.1"?"127.0.0.1":me.ipAddress||"N/A"})}),o.jsx(xa,{children:o.jsx(Qa,{variant:me.status==="success"?"default":"destructive",children:me.status})})]},be)})})]})})}),H>1&&o.jsxs("div",{className:"flex items-center justify-between mt-4",children:[o.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",I," of ",H]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(ur,{variant:"outline",size:"sm",onClick:()=>ee(I-1),disabled:I===1||n,children:"Previous"}),o.jsx(ur,{variant:"outline",size:"sm",onClick:()=>ee(I+1),disabled:I===H||n,children:"Next"})]})]})]})})]})]})})}const S$e=Ar.object({email:Ar.string().email("Please enter a valid email address")}),N$e=Ar.object({otp:Ar.string().min(6,"OTP must be 6 digits").max(6,"OTP must be 6 digits")});function A$e(){const[e,t]=G.useState(1),[r,n]=G.useState(""),[a,c]=G.useState(!1),[h,i]=G.useState(""),x=Ba(),w=ml({resolver:Rl(S$e),defaultValues:{email:""}}),S=ml({resolver:Rl(N$e),defaultValues:{otp:""}});G.useEffect(()=>{e===2&&S.reset({otp:""})},[e,S]);const T=async I=>{var V,H;try{c(!0),n(I.email);const{data:K}=await mn.post("/auth/forgot-password",{email:I.email});K.success&&(Xr.success(K.message),S.reset({otp:""}),t(2))}catch(K){console.error("Forgot password error:",K),Xr.error(((H=(V=K.response)==null?void 0:V.data)==null?void 0:H.message)||"Failed to send reset email")}finally{c(!1)}},E=async I=>{var V,H;try{c(!0);const{data:K}=await mn.post("/auth/verify-password-reset-otp",{email:r,otp:I.otp});K.success&&(i(K.resetToken),Xr.success("OTP verified successfully"),x("/reset-password",{state:{resetToken:K.resetToken,email:r}}))}catch(K){console.error("OTP verification error:",K),Xr.error(((H=(V=K.response)==null?void 0:V.data)==null?void 0:H.message)||"Invalid OTP")}finally{c(!1)}},D=()=>{x("/login")},U=()=>{x("/login")};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4 md:p-6",children:o.jsxs("div",{className:"w-full max-w-md",children:[o.jsxs("div",{className:"text-center mb-6 md:mb-8",children:[o.jsx("img",{src:H1,alt:"LTO Logo",className:"h-16 w-16 md:h-20 md:w-20 mx-auto mb-3 md:mb-4"}),o.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-[#1e3a8a] mb-2",children:"LTO SYSTEM"}),o.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Land Transportation Management System"})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 md:p-8",children:[e===1?o.jsx(up,{...w,children:o.jsx("form",{onSubmit:w.handleSubmit(T),children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-gray-900 mb-2",children:"Forgot Password?"}),o.jsx("p",{className:"text-sm md:text-base text-gray-600",children:"Enter your email address and we'll send you an OTP to reset your password."})]}),o.jsx(an,{control:w.control,name:"email",render:({field:I})=>o.jsxs(nn,{children:[o.jsx(Hr,{children:o.jsxs("div",{className:"relative",children:[o.jsx(fl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),o.jsx(Yr,{...I,type:"email",placeholder:"Enter your email address",className:zt("pl-10 h-11 border-gray-300 focus:ring-0 focus:border-[#1e3a8a] rounded-md bg-white text-gray-900 placeholder:text-gray-500",w.formState.errors.email&&"border-red-500")})]})}),o.jsx(cn,{})]})}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:U,className:"flex-1 h-11 border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),o.jsx(ur,{type:"submit",disabled:a,className:"flex-1 h-11 bg-[#1e3a8a] hover:bg-[#1e40af] text-white font-semibold",children:a?o.jsx(Nc,{className:"w-4 h-4 animate-spin"}):"Send OTP"})]})]})})}):G.createElement(up,{...S,key:"otp-form"},o.jsx("form",{onSubmit:S.handleSubmit(E),children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-gray-900 mb-2",children:"Verify OTP"}),o.jsxs("p",{className:"text-sm md:text-base text-gray-600 break-words",children:["We've sent a 6-digit OTP to ",o.jsx("strong",{children:r})]}),o.jsx("p",{className:"text-xs md:text-sm text-gray-500 mt-1",children:"Please check your email and enter the OTP below."})]}),o.jsx(an,{control:S.control,name:"otp",render:({field:I})=>o.jsxs(nn,{children:[o.jsx(Hr,{children:o.jsx(Yr,{...I,type:"text",placeholder:"Enter 6-digit OTP",maxLength:6,className:zt("h-11 border-gray-300 focus:ring-0 focus:border-[#1e3a8a] rounded-md bg-white text-gray-900 placeholder:text-gray-500 text-center text-lg tracking-widest",S.formState.errors.otp&&"border-red-500")})}),o.jsx(cn,{})]})}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs(ur,{type:"button",variant:"outline",onClick:()=>t(1),className:"flex-1 h-11 border-gray-300 text-gray-700 hover:bg-gray-50",children:[o.jsx(n4,{className:"w-4 h-4 mr-2"}),"Back"]}),o.jsx(ur,{type:"submit",disabled:a,className:"flex-1 h-11 bg-[#1e3a8a] hover:bg-[#1e40af] text-white font-semibold",children:a?o.jsx(Nc,{className:"w-4 h-4 animate-spin"}):"Verify OTP"})]})]})})),o.jsx("div",{className:"mt-6 text-center",children:o.jsx("button",{onClick:D,className:"text-sm text-[#1e3a8a] hover:underline",children:"Back to Login"})})]})]})})}const T$e=Ar.object({newPassword:Ar.string().min(8,"Password must be at least 8 characters").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Password must contain at least one uppercase letter, one lowercase letter, and one number"),confirmPassword:Ar.string()}).refine(e=>e.newPassword===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function j$e(){const[e,t]=G.useState(!1),[r,n]=G.useState(!1),[a,c]=G.useState(!1),[h,i]=G.useState(!1),x=Ba(),w=Co(),S=ml({resolver:Rl(T$e),defaultValues:{newPassword:"",confirmPassword:""}});G.useEffect(()=>{var I;(I=w.state)!=null&&I.resetToken||(Xr.error("Invalid reset link. Please request a new password reset."),x("/forgot-password"))},[w.state,x]);const T=()=>{t(!e)},E=()=>{n(!r)},D=async I=>{var V,H;try{c(!0);const{data:K}=await mn.post("/auth/reset-password",{resetToken:w.state.resetToken,newPassword:I.newPassword});K.success&&(i(!0),Xr.success("Password reset successfully!"),setTimeout(()=>{x("/login")},3e3))}catch(K){console.error("Reset password error:",K),Xr.error(((H=(V=K.response)==null?void 0:V.data)==null?void 0:H.message)||"Failed to reset password")}finally{c(!1)}},U=()=>{x("/login")};return h?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4 md:p-6",children:o.jsxs("div",{className:"w-full max-w-md",children:[o.jsxs("div",{className:"text-center mb-6 md:mb-8",children:[o.jsx("img",{src:H1,alt:"LTO Logo",className:"h-16 w-16 md:h-20 md:w-20 mx-auto mb-3 md:mb-4"}),o.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-[#1e3a8a] mb-2",children:"LTO SYSTEM"}),o.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Land Transportation Management System"})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 md:p-8 text-center",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx(NH,{className:"w-12 h-12 md:w-16 md:h-16 text-green-500 mx-auto mb-3 md:mb-4"}),o.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-gray-900 mb-2",children:"Password Reset Successful!"}),o.jsx("p",{className:"text-sm md:text-base text-gray-600",children:"Your password has been successfully reset. You will be redirected to the login page shortly."})]}),o.jsx(ur,{onClick:U,className:"w-full h-11 bg-[#1e3a8a] hover:bg-[#1e40af] text-white font-semibold",children:"Go to Login"})]})]})}):o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4 md:p-6",children:o.jsxs("div",{className:"w-full max-w-md",children:[o.jsxs("div",{className:"text-center mb-6 md:mb-8",children:[o.jsx("img",{src:H1,alt:"LTO Logo",className:"h-16 w-16 md:h-20 md:w-20 mx-auto mb-3 md:mb-4"}),o.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-[#1e3a8a] mb-2",children:"LTO SYSTEM"}),o.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Land Transportation Management System"})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 md:p-8",children:[o.jsx(up,{...S,children:o.jsx("form",{onSubmit:S.handleSubmit(D),children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-gray-900 mb-2",children:"Reset Password"}),o.jsx("p",{className:"text-sm md:text-base text-gray-600",children:"Enter your new password below."})]}),o.jsx(an,{control:S.control,name:"newPassword",render:({field:I})=>o.jsxs(nn,{children:[o.jsx(Hr,{children:o.jsxs("div",{className:"relative",children:[o.jsx(fR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),o.jsx(Yr,{...I,type:e?"text":"password",placeholder:"New Password",className:zt("pl-10 pr-10 h-11 border-gray-300 focus:ring-0 focus:border-[#1e3a8a] rounded-md bg-white text-gray-900 placeholder:text-gray-500",S.formState.errors.newPassword&&"border-red-500")}),o.jsx(ur,{type:"button",size:"icon",variant:"ghost",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-8 w-8 hover:bg-transparent",onClick:T,"aria-label":e?"Hide Password":"Show Password",children:e?o.jsx(FN,{className:"text-gray-400 h-4 w-4"}):o.jsx(DN,{className:"text-gray-400 h-4 w-4"})})]})}),o.jsx(cn,{})]})}),o.jsx(an,{control:S.control,name:"confirmPassword",render:({field:I})=>o.jsxs(nn,{children:[o.jsx(Hr,{children:o.jsxs("div",{className:"relative",children:[o.jsx(fR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),o.jsx(Yr,{...I,type:r?"text":"password",placeholder:"Confirm New Password",className:zt("pl-10 pr-10 h-11 border-gray-300 focus:ring-0 focus:border-[#1e3a8a] rounded-md bg-white text-gray-900 placeholder:text-gray-500",S.formState.errors.confirmPassword&&"border-red-500")}),o.jsx(ur,{type:"button",size:"icon",variant:"ghost",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-8 w-8 hover:bg-transparent",onClick:E,"aria-label":r?"Hide Password":"Show Password",children:r?o.jsx(FN,{className:"text-gray-400 h-4 w-4"}):o.jsx(DN,{className:"text-gray-400 h-4 w-4"})})]})}),o.jsx(cn,{})]})}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx(ur,{type:"button",variant:"outline",onClick:U,className:"flex-1 h-11 border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),o.jsx(ur,{type:"submit",disabled:a,className:"flex-1 h-11 bg-[#1e3a8a] hover:bg-[#1e40af] text-white font-semibold",children:a?o.jsx(Nc,{className:"w-4 h-4 animate-spin"}):"Reset Password"})]})]})})}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx("button",{onClick:U,className:"text-sm text-[#1e3a8a] hover:underline",children:"Back to Login"})})]})]})})}const k$e=()=>{var K,Q,ae,ee;const{userData:e,setUserData:t}=Ei(),[r,n]=G.useState(!0),[a,c]=G.useState(!1),[h,i]=G.useState(!1),[x,w]=G.useState({firstName:"",middleName:"",lastName:"",email:"",avatar:""}),[S,T]=G.useState(""),E=G.useRef(null);G.useEffect(()=>{setTimeout(()=>{n(!1)},500),e&&(console.log("AccountPage - Current userData.avatar:",e.avatar),console.log("AccountPage - Full userData:",e),w({firstName:e.firstName||"",middleName:e.middleName||"",lastName:e.lastName||"",email:e.email||"",avatar:e.avatar||""}),T(e.avatar||""))},[e]);const D=()=>c(!0),U=()=>{c(!1),w({firstName:(e==null?void 0:e.firstName)||"",middleName:(e==null?void 0:e.middleName)||"",lastName:(e==null?void 0:e.lastName)||"",email:(e==null?void 0:e.email)||"",avatar:(e==null?void 0:e.avatar)||""}),T((e==null?void 0:e.avatar)||"")},I=async()=>{var se,ue;try{i(!0);const he=new FormData;if(he.append("firstName",x.firstName),he.append("middleName",x.middleName),he.append("lastName",x.lastName),he.append("email",x.email),S&&S!==(e==null?void 0:e.avatar)&&S.startsWith("data:")){const me=await(await fetch(S)).blob(),be=new File([me],"avatar.jpg",{type:me.type});he.append("avatar",be)}const Ce=await mn.put("/account/profile",he,{headers:{"Content-Type":"multipart/form-data"}});if(Ce.data.success){const me="http://localhost:5000/api".replace("/api",""),be=Ce.data.user.avatar?`${me}/${Ce.data.user.avatar}?t=${Date.now()}`:"";console.log("Backend response avatar:",Ce.data.user.avatar),console.log("Constructed avatar URL with cache-busting:",be);const pe={...e,firstName:Ce.data.user.firstName,middleName:Ce.data.user.middleName,lastName:Ce.data.user.lastName,email:Ce.data.user.email,avatar:be};t(pe),console.log("Saving to localStorage:",pe),localStorage.setItem("userData",JSON.stringify(pe)),T(be),c(!1),Xr.success("Profile updated successfully!",{description:new Date().toLocaleString()})}}catch(he){console.error("Error updating profile:",he);const Ce=((ue=(se=he.response)==null?void 0:se.data)==null?void 0:ue.message)||"Failed to update profile. Please try again.";Xr.error(Ce,{description:new Date().toLocaleString()})}finally{i(!1)}},V=se=>{const ue=se.target.files[0];if(ue){if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(ue.type)){Xr.error("Please select a valid image file (JPEG, PNG, GIF, or WebP)",{description:new Date().toLocaleString()});return}const Ce=5*1024*1024;if(ue.size>Ce){Xr.error("File size must be less than 5MB",{description:new Date().toLocaleString()});return}const Ne=new FileReader;Ne.onload=me=>{T(me.target.result),w(be=>({...be,avatar:me.target.result}))},Ne.readAsDataURL(ue)}},H=()=>{var se;a&&((se=E.current)==null||se.click())};return r?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):o.jsx("div",{className:"h-full bg-white dark:bg-black overflow-hidden",children:o.jsx("div",{className:"container mx-auto px-6 py-3 h-full flex flex-col",children:o.jsxs("div",{className:"max-w-7xl mx-auto w-full h-full flex flex-col space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between flex-shrink-0 pb-2",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Account"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your account information and settings"})]}),o.jsxs(ur,{onClick:D,variant:"outline",className:"gap-2",children:[o.jsx(za,{className:"h-4 w-4"})," Edit Profile"]})]}),o.jsxs("div",{className:"grid gap-4 md:grid-cols-1 flex-1 min-h-0",children:[o.jsxs(Ri,{className:"flex-shrink-0",children:[o.jsxs(Ki,{className:"pb-3",children:[o.jsxs(Zi,{className:"flex items-center gap-2 text-lg",children:[o.jsx(fl,{className:"h-5 w-5"})," Profile Information"]}),o.jsx(As,{children:"Your personal account details"})]}),o.jsxs(Fi,{className:"space-y-4 pb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"relative",children:o.jsxs(zw,{className:"h-14 w-14",children:[o.jsx(Bw,{src:(e==null?void 0:e.avatar)||"",alt:e==null?void 0:e.email,onError:se=>{console.error("Avatar image failed to load:",se.target.src)},onLoad:()=>{console.log("Avatar image loaded successfully:",e==null?void 0:e.avatar)}},(e==null?void 0:e.avatar)||"default-img"),o.jsx(Vw,{className:"text-lg font-bold",children:((Q=(K=(e==null?void 0:e.firstName)||(e==null?void 0:e.email))==null?void 0:K.charAt(0))==null?void 0:Q.toUpperCase())||"U"})]},(e==null?void 0:e.avatar)||"default")}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold",children:e!=null&&e.firstName&&(e!=null&&e.lastName)?`${e.firstName}${e.middleName?` ${e.middleName}`:""} ${e.lastName}`.trim():(e==null?void 0:e.email)||"User"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:(e==null?void 0:e.role)==="1"?"Admin":(e==null?void 0:e.role)==="2"?"Employee":(e==null?void 0:e.role)==="0"?"Super Admin":(e==null?void 0:e.role)||"Employee"})]})]}),o.jsx(B_,{}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(fl,{className:"h-4 w-4 text-muted-foreground"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium",children:"Full Name"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:e!=null&&e.firstName&&(e!=null&&e.lastName)?`${e.firstName}${e.middleName?` ${e.middleName}`:""} ${e.lastName}`.trim():"N/A"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Hw,{className:"h-4 w-4 text-muted-foreground"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium",children:"Email"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:(e==null?void 0:e.email)||"N/A"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Xg,{className:"h-4 w-4 text-muted-foreground"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium",children:"Role"}),o.jsx(Qa,{variant:"secondary",className:"mt-1",children:(e==null?void 0:e.role)==="1"?"Admin":(e==null?void 0:e.role)==="2"?"Employee":(e==null?void 0:e.role)==="0"?"Super Admin":(e==null?void 0:e.role)||"Employee"})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Xs,{className:"h-4 w-4 text-muted-foreground"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium",children:"Account Created"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:e!=null&&e.createdAt?new Date(e.createdAt).toLocaleDateString():e!=null&&e.dateCreated?new Date(e.dateCreated).toLocaleDateString():new Date().toLocaleDateString()})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(AT,{className:"h-4 w-4 text-muted-foreground"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium",children:"Last Login"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:e!=null&&e.lastLogin?new Date(e.lastLogin).toLocaleString():e!=null&&e.lastLoginDate?new Date(e.lastLoginDate).toLocaleString():"Currently Active"})]})]})]})]})]}),o.jsxs(Ri,{className:"flex-shrink-0",children:[o.jsxs(Ki,{className:"pb-3",children:[o.jsx(Zi,{className:"text-lg",children:"System Information"}),o.jsx(As,{children:"Your account status and system details"})]}),o.jsx(Fi,{className:"pb-4",children:o.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-sm font-medium",children:"Account Status"}),o.jsx(Qa,{variant:"default",className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"Active"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-sm font-medium",children:"Permissions"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:(e==null?void 0:e.role)==="0"||(e==null?void 0:e.role)==="superadmin"?"Full Access":(e==null?void 0:e.role)==="1"||(e==null?void 0:e.role)==="admin"?"Administrative Access":"Standard Access"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-sm font-medium",children:"Session"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:e!=null&&e.sessionId?"Active Session":"No Active Session"})]})]})})]})]}),o.jsx(Yi,{open:a,onOpenChange:c,children:o.jsxs(Bi,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[o.jsxs(ia,{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(za,{className:"h-6 w-6"}),o.jsx(aa,{children:"Edit Profile"})]}),o.jsx(js,{children:"Update your account information and profile picture"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"relative",children:[o.jsxs(zw,{className:"h-20 w-20",children:[o.jsx(Bw,{src:S||(e==null?void 0:e.avatar)||"",alt:x.email||(e==null?void 0:e.email),onError:se=>{console.error("Avatar preview failed to load:",se.target.src)},onLoad:()=>{console.log("Avatar preview loaded:",S||(e==null?void 0:e.avatar))}},`preview-${S||(e==null?void 0:e.avatar)||"default-img"}`),o.jsx(Vw,{className:"text-lg font-bold",children:((ee=(ae=x.firstName||(e==null?void 0:e.firstName)||x.email||(e==null?void 0:e.email))==null?void 0:ae.charAt(0))==null?void 0:ee.toUpperCase())||"U"})]},S||(e==null?void 0:e.avatar)||"default"),o.jsxs("div",{className:"absolute -bottom-1 -right-1",children:[o.jsx(ur,{size:"sm",variant:"secondary",className:"h-8 w-8 rounded-full p-0",onClick:H,children:o.jsx(Lue,{className:"h-4 w-4"})}),o.jsx("input",{ref:E,type:"file",accept:"image/*",onChange:V,className:"hidden"})]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium",children:"Profile Picture"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Click the camera icon to change"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx(Ml,{htmlFor:"modalFirstName",children:"First Name"}),o.jsx(Yr,{id:"modalFirstName",value:x.firstName,onChange:se=>w(ue=>({...ue,firstName:se.target.value})),placeholder:"Enter first name"})]}),o.jsxs("div",{children:[o.jsx(Ml,{htmlFor:"modalMiddleName",children:"Middle Name"}),o.jsx(Yr,{id:"modalMiddleName",value:x.middleName,onChange:se=>w(ue=>({...ue,middleName:se.target.value})),placeholder:"Enter middle name"})]}),o.jsxs("div",{children:[o.jsx(Ml,{htmlFor:"modalLastName",children:"Last Name"}),o.jsx(Yr,{id:"modalLastName",value:x.lastName,onChange:se=>w(ue=>({...ue,lastName:se.target.value})),placeholder:"Enter last name"})]})]}),o.jsxs("div",{children:[o.jsx(Ml,{htmlFor:"modalEmail",children:"Email"}),o.jsx(Yr,{id:"modalEmail",type:"email",value:x.email,onChange:se=>w(ue=>({...ue,email:se.target.value})),placeholder:"Enter your email"})]})]}),o.jsxs("div",{className:"flex gap-4 pt-4",children:[o.jsxs(ur,{onClick:I,className:"gap-2",disabled:h,children:[o.jsx(jH,{className:"h-4 w-4"}),h?"Saving...":"Save Changes"]}),o.jsxs(ur,{onClick:U,variant:"outline",className:"gap-2",disabled:h,children:[o.jsx(zd,{className:"h-4 w-4"}),"Cancel"]})]})]})]})})]})})})};function P$e(){return o.jsxs(o.Fragment,{children:[o.jsx(sle,{closeButton:!0}),o.jsxs(Jle,{children:[o.jsx(Da,{path:"/login",element:o.jsx(eve,{})}),o.jsx(Da,{path:"/forgot-password",element:o.jsx(A$e,{})}),o.jsx(Da,{path:"/reset-password",element:o.jsx(j$e,{})}),o.jsx(Da,{path:"/404",element:o.jsx(cUe,{})}),o.jsx(Da,{path:"/",element:o.jsx(K5e,{allowedRoles:["superadmin","admin","employee"]}),children:o.jsxs(Da,{element:o.jsx(HFe,{}),children:[o.jsx(Da,{index:!0,element:o.jsx(kW,{})}),o.jsx(Da,{path:"dashboard",element:o.jsx(kW,{})}),o.jsx(Da,{path:"account",element:o.jsx(k$e,{})}),o.jsx(Da,{path:"analytics/registration",element:o.jsx(YUe,{})}),o.jsx(Da,{path:"analytics/violation",element:o.jsx(o$e,{})}),o.jsx(Da,{path:"analytics/accident",element:o.jsx(g$e,{})}),o.jsx(Da,{path:"driver",element:o.jsx(oUe,{})}),o.jsx(Da,{path:"driver/inactive",element:o.jsx(hUe,{})}),o.jsx(Da,{path:"driver/:id",element:o.jsx(lUe,{})}),o.jsx(Da,{path:"driver/:id/edit",element:o.jsx(uUe,{})}),o.jsx(Da,{path:"vehicle",element:o.jsx(_Ue,{})}),o.jsx(Da,{path:"vehicle/:id",element:o.jsx(wUe,{})}),o.jsx(Da,{path:"vehicle/:id/edit",element:o.jsx(SUe,{})}),o.jsx(Da,{path:"violation",element:o.jsx(kUe,{})}),o.jsx(Da,{path:"violation/:id/edit",element:o.jsx(IUe,{})}),o.jsx(Da,{path:"accident",element:o.jsx(OUe,{})}),o.jsx(Da,{path:"accident/:id/edit",element:o.jsx(RUe,{})}),o.jsx(Da,{path:"account/register",element:o.jsx(BO,{allowedRoles:["admin","superadmin"],children:o.jsx(x$e,{})})}),o.jsx(Da,{path:"account/update",element:o.jsx(BO,{allowedRoles:["admin","superadmin"],children:o.jsx(b$e,{})})}),o.jsx(Da,{path:"account/logs",element:o.jsx(BO,{allowedRoles:["admin","superadmin"],children:o.jsx(w$e,{})})})]})}),o.jsx(Da,{path:"*",element:o.jsx(X3,{to:"/404"})})]})]})}var yN={},HW;function C$e(){if(HW)return yN;HW=1;var e=ZW();return yN.createRoot=e.createRoot,yN.hydrateRoot=e.hydrateRoot,yN}var E$e=C$e();const M$e=ha(E$e);M$e.createRoot(document.getElementById("root")).render(o.jsx(Le.StrictMode,{children:o.jsx(bce,{children:o.jsx(Yxe,{children:o.jsx(nge,{defaultTheme:"dark",storageKey:"vite-ui-theme",children:o.jsx(P$e,{})})})})}));
